/*! For license information please see main.b2a4601e.js.LICENSE.txt */
(()=>{var __webpack_modules__={464:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});const r=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"===typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!==typeof i||null===i)?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(r,i,o);return o},i=e=>e?r(e):r;var o=n(791),s=n(327);const{useDebugValue:a}=o,{useSyncExternalStoreWithSelector:l}=s;let c=!1;const u=e=>e;const h=e=>{"function"!==typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"===typeof e?i(e):e,n=(e,n)=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=arguments.length>2?arguments[2]:void 0;n&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);const r=l(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a(r),r}(t,e,n);return Object.assign(n,t),n},d=e=>e?h(e):h;const p=d((e=>({ip:"",blocks:{},setIp:t=>e({ip:t}),addBlock:(t,n)=>e((e=>({blocks:{...e.blocks,[t]:n}}))),removeBlock:t=>e((e=>({blocks:Object.keys(e.blocks).reduce(((n,r)=>(r!==t&&(n[r]=e.blocks[r]),n)),{})})))})))},222:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});var r=n(30);r.Blocks.ChangeLED={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Change the LED color to").appendField(new r.FieldColour("#FF0000"),"FIELD_ChangeLED"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setOutput(!1),this.setTooltip("Changes Misty's LED to a specified color")}},r.Blocks.DisplayImage={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Change face expression to: ").appendField(new r.FieldTextInput("default"),"FIELD_DisplayImage_Filename"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Displays an image on Misty's screen, Alpha specifies transparency (0 is completely transparent, 1 is completely opaque) ***WARNING: MUST connect with ListFilesAvailable to select the image file to display***")}},r.Blocks.MoveHead={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move head").appendField(new r.FieldDropdown([["Up","U"],["Down","D"]]),"FIELD_MoveHead_Pitch"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head Up or Down"),this.setHelpUrl("MoveHead")}},r.Blocks.MoveHead2={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move head").appendField("Pitch (-40 to 25):").appendField(new r.FieldNumber(0,-40,25,1),"FIELD_MoveHead_Pitch").appendField("Roll (-42 to 42):").appendField(new r.FieldNumber(0,-42,42,1),"FIELD_MoveHead_Roll").appendField("Yaw (-90 to 90):").appendField(new r.FieldNumber(0,-90,90,1),"FIELD_MoveHead_Yaw"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head a specified amount of degrees with roll, pitch, and/or yaw"),this.setHelpUrl("MoveHead")}},r.Blocks.MoveArm={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move ").appendField(new r.FieldDropdown([["Right","Right"],["Left","Left"]]),"FIELD_MoveArm_Arm").appendField("arm to position").appendField(new r.FieldNumber(0,0,10,1),"FIELD_MoveArm_Position").appendField("at a speed of (0 to 100)").appendField(new r.FieldNumber(50,0,100,1),"FIELD_MoveArm_Velocity"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves one of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArm")}},r.Blocks.MoveArm2={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move both arms to position").appendField(new r.FieldNumber(0),"FIELD_MoveArm2_Position").appendField("at a speed of (0 to 100)").appendField(new r.FieldNumber(50,0,100,1),"FIELD_MoveArm2_Velocity"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves both of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArm2")}},r.Blocks.MoveArms={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move left arm to position").appendField(new r.FieldNumber(0,-29,90,1),"FIELD_MoveArm_LeftPosition").appendField("at a speed of (0 to 100)").appendField(new r.FieldNumber(50,0,100,1),"FIELD_MoveArm_LeftVelocity").appendField("and move right arm to position").appendField(new r.FieldNumber(0,-29,90,1),"FIELD_MoveArm_RightPosition").appendField("at a speed of (0 to 100)").appendField(new r.FieldNumber(50,0,100,1),"FIELD_MoveArm_RightVelocity"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves both of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArms")}},r.Blocks.DriveTime={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move ").appendField(new r.FieldDropdown([["Forward","F"],["Backward","B"]]),"FIELD_DriveTime_Direction").appendField("at a speed of (0 to 100)").appendField(new r.FieldNumber(25,0,100,1),"FIELD_DriveTime_Velocity").appendField("for a duration of").appendField(new r.FieldNumber(1500,100,1e4,100),"FIELD_DriveTime_TimeMs").appendField("ms"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Drives Misty straight in a specified direction at a specified speed for a specified amount of time (1000ms = 1 second)"),this.setHelpUrl("DriveTime")}},r.Blocks.MoveHead3={init:function(){var e=this.workspace.newBlock("math_number");e.setShadow(!0),e.initSvg(),e.render();var t=e.outputConnection,n=this.workspace.newBlock("math_number");n.setShadow(!0),n.initSvg(),n.render();var r=n.outputConnection,i=this.workspace.newBlock("math_number");i.setShadow(!0),i.initSvg(),i.render();var o=i.outputConnection;this.setColour("#ff0000"),this.appendValueInput("FIELD_MoveHead_Pitch").setCheck("Number").appendField("Move head").appendField("Pitch (-40 to 25):"),this.getInput("FIELD_MoveHead_Pitch").connection.connect(t),this.appendValueInput("FIELD_MoveHead_Roll").setCheck("Number").appendField("Roll (-42 to 42):"),this.getInput("FIELD_MoveHead_Roll").connection.connect(r),this.appendValueInput("FIELD_MoveHead_Yaw").setCheck("Number").appendField("Yaw (-90 to 90):"),this.getInput("FIELD_MoveHead_Yaw").connection.connect(o),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head a specified amount of degrees with roll, pitch, and/or yaw"),this.setHelpUrl("MoveHead")}},r.Blocks.DriveTime2={init:function(){var e=this.workspace.newBlock("math_number");e.setShadow(!0),e.initSvg(),e.render();var t=e.outputConnection,n=this.workspace.newBlock("math_number");n.setShadow(!0),n.initSvg(),n.render();var r=n.outputConnection,i=this.workspace.newBlock("math_number");i.setShadow(!0),i.initSvg(),i.render();var o=i.outputConnection;this.setColour("#ff0000"),this.appendValueInput("FIELD_DriveTime_Velocity").setCheck("Number").appendField("Move at a speed of (-100 to 100)"),this.getInput("FIELD_DriveTime_Velocity").connection.connect(t),this.appendValueInput("FIELD_DriveTime_Angular").setCheck("Number").appendField("with angular velocity of (-100 CW to 100 CCW)"),this.getInput("FIELD_DriveTime_Angular").connection.connect(r),this.appendValueInput("FIELD_DriveTime_TimeMs").setCheck("Number").appendField("for a duration of (ms)"),this.getInput("FIELD_DriveTime_TimeMs").connection.connect(o),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Drives Misty forward (positive speed) or backward (negative speed) with possible turning using angular velocity (0 for straight) for the specified duration (1000 ms = 1 second)"),this.setHelpUrl("DriveTime")}},r.Blocks.Turn={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Turn").appendField(new r.FieldDropdown([["Left","L"],["Right","R"]]),"FIELD_Turn_Direction").appendField("for time of").appendField(new r.FieldNumber(4500),"FIELD_Turn_Duration").appendField("milliseconds"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Turns Misty in the specified direction (1000ms = 1 second and 4500ms is approximately 90 degrees)"),this.setHelpUrl("Turn")}};const i=r.common.createBlockDefinitionsFromJsonArray([{type:"add_text",message0:"Add text %1 with color %2",args0:[{type:"input_value",name:"TEXT",check:"String"},{type:"input_value",name:"COLOR",check:"Colour"}],previousStatement:null,nextStatement:null,colour:160,tooltip:"",helpUrl:""}])},959:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>BlocklyInterface});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(791),blockly__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(271),blockly__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_1__),_blocks_text__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(222),_generators_javascript__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(691),blockly_javascript__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(505),blockly_javascript__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(blockly_javascript__WEBPACK_IMPORTED_MODULE_4__),_serialization__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(636),_toolbox__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25),_index_css__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(174),_Store__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(464),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(184);function BlocklyInterface(props){const addBlock=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.addBlock)),blocks=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.blocks)),removeBlock=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.removeBlock));return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{console.log(blocks)}),[blocks]),blockly__WEBPACK_IMPORTED_MODULE_1__.common.defineBlocks(blocks),Object.assign(blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.forBlock,_generators_javascript__WEBPACK_IMPORTED_MODULE_3__.Z),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!document.querySelector(".blocklySvg")){var blocklyArea=document.getElementById("pageContainer"),blocklyDiv=document.getElementById("blocklyDiv");const ws=blockly__WEBPACK_IMPORTED_MODULE_1__.inject(blocklyDiv,{toolbox:_toolbox__WEBPACK_IMPORTED_MODULE_6__.k}),initialBlock=ws.newBlock("Start");initialBlock.moveBy(50,50),(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.a)(ws),(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.z)(ws),blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.addReservedWords("code");const runCode=()=>{console.log("runcode clicked");const code=blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.workspaceToCode(ws);eval(code)};document.getElementById("runButton").addEventListener("click",runCode);const onresize=function(e){let t=blocklyArea,n=0,r=0;do{n+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent}while(t);blocklyDiv.style.left=n+"px",blocklyDiv.style.top=r+"px",blocklyDiv.style.width=blocklyArea.offsetWidth+"px",blocklyDiv.style.height=blocklyArea.offsetHeight+"px",blockly__WEBPACK_IMPORTED_MODULE_1__.svgResize(ws)};window.addEventListener("resize",onresize,!1),onresize(),ws.addChangeListener((e=>{if(!e.isUiEvent){if("create"===e.type){let t={id:e.json.id,type:e.json.type};e.json.fields&&(t.fields=e.json.fields),e.json.inputs&&(t.inputs=e.json.inputs),addBlock(e.json.id,t)}if("move"===e.type){ws.getBlockById(e.blockId)||removeBlock(e.blockId)}(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.a)(ws)}}))}}),[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{id:"pageContainer",style:{width:"100%",height:"100%"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{id:"blocklyDiv",style:{width:"100%",height:"100%",minHeight:"480px",minWidth:"480px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("xml",{id:"toolbox",style:{display:"none"}})]})}blockly__WEBPACK_IMPORTED_MODULE_1__.Blocks.Start={init:function(){this.appendDummyInput().appendField("Program starts here"),this.setColour(345),this.setTooltip("This is the starting block"),this.setNextStatement(!0,null),this.setHelpUrl(""),this.setDeletable(!1)}}},691:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(505);const i=Object.create(null);i.add_text=function(e,t){const n=t.valueToCode(e,"TEXT",r.Order.NONE)||"''",i=t.valueToCode(e,"COLOR",r.Order.ATOMIC)||"'#ffffff'",o=t.provideFunction_("addText","function ".concat(t.FUNCTION_NAME_PLACEHOLDER_,"(text, color) {\n\n  // Add text to the output area.\n  const outputDiv = document.getElementById('output');\n  const textEl = document.createElement('p');\n  textEl.innerText = text;\n  textEl.style.color = color;\n  outputDiv.appendChild(textEl);\n}"));return"".concat(o,"(").concat(n,", ").concat(i,");\n")},i.ChangeLED=function(e){var t=function(e){e=e.replace(/^#/,"");var t=parseInt(e,16);return{red:t>>16&255,green:t>>8&255,blue:255&t}}(e.getFieldValue("FIELD_ChangeLED"));return'sendPostRequestToRobot("led",'+JSON.stringify(t)+");"},i.DisplayImage=function(e){var t={FileName:e.getFieldValue("FIELD_DisplayImage_Filename"),Alpha:1};return'sendPostRequestToRobot("images/display",'+JSON.stringify(t)+");"},i.MoveHead=function(e){var t,n="D"===e.getFieldValue("FIELD_MoveHead_Pitch")?5:-5;parseInt(e.getFieldValue("FIELD_MoveHead_Velocity"));return t={Pitch:n,Yaw:0,Roll:0,Units:"position"},'sendPostRequestToRobot("head",'+JSON.stringify(t)+");"},i.MoveHead2=function(e){var t,n;t=e.getFieldValue("FIELD_MoveHead_Pitch"),n=e.getFieldValue("FIELD_MoveHead_Roll");return'sendPostRequestToRobot("head",'+('{"Pitch":'+t+',"Yaw":'+e.getFieldValue("FIELD_MoveHead_Yaw")+',"Roll":'+n+',"Units": "degrees"}')+");"},i.MoveArm=function(e){return'sendPostRequestToRobot("arms",'+('{"Arm":"'+("Right"===e.getFieldValue("FIELD_MoveArm_Arm")?"Right":"Left")+'","Position":'+parseInt(e.getFieldValue("FIELD_MoveArm_Position"))+',"Velocity":'+parseInt(e.getFieldValue("FIELD_MoveArm_Velocity"))+',"Units":"Position"}')+");"},i.MoveArm2=function(e){return'sendPostRequestToRobot("arms",'+('{"Arm": "both", "Position":'+parseInt(e.getFieldValue("FIELD_MoveArm2_Position"))+',"Velocity":'+parseInt(e.getFieldValue("FIELD_MoveArm2_Velocity"))+',"Units":"Position"}')+");"},i.MoveArms=function(e){var t=parseInt(e.getFieldValue("FIELD_MoveArm_LeftPosition")),n=parseInt(e.getFieldValue("FIELD_MoveArm_LeftVelocity"));return'sendPostRequestToRobot("arms/set",'+('{"LeftArmPosition":'+t+',"RightArmPosition":'+parseInt(e.getFieldValue("FIELD_MoveArm_RightPosition"))+',"LeftArmVelocity":'+n+',"RightArmVelocity":'+parseInt(e.getFieldValue("FIELD_MoveArm_RightVelocity"))+"}")+");"},i.DriveTime=function(e){var t=e.getFieldValue("FIELD_DriveTime_Direction"),n=parseInt(e.getFieldValue("FIELD_DriveTime_Velocity"));return'sendPostRequestToRobot("drive/time",'+('{"LinearVelocity":'+("F"===t?n:-n)+',"AngularVelocity":0,"TimeMs":'+parseInt(e.getFieldValue("FIELD_DriveTime_TimeMs"))+"}")+");"},i.Turn=function(e){var t=e.getFieldValue("FIELD_Turn_Direction");return'sendPostRequestToRobot("drive/time",'+('{"LinearVelocity":0,"AngularVelocity":100,"TimeMs":'+parseInt(e.getFieldValue("FIELD_Turn_Duration"))+',"Degree":'+("L"===t?90:-90)+"}")+");"},i.Start=function(e){return""}},636:(e,t,n)=>{"use strict";n.d(t,{a:()=>o,z:()=>s});var r=n(30);const i="mainWorkspace",o=function(e){var t;const n=r.serialization.workspaces.save(e);null===(t=window.localStorage)||void 0===t||t.setItem(i,JSON.stringify(n))},s=function(e){var t;const n=null===(t=window.localStorage)||void 0===t?void 0:t.getItem(i);n&&(r.Events.disable(),r.serialization.workspaces.load(JSON.parse(n),e,!1),r.Events.enable())}},25:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r={kind:"categoryToolbox",contents:[{kind:"category",name:"Logic",categorystyle:"logic_category",contents:[{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_negate"},{kind:"block",type:"logic_boolean"},{kind:"block",type:"logic_null"},{kind:"block",type:"logic_ternary"}]},{kind:"category",name:"Loops",categorystyle:"loop_category",contents:[{kind:"block",type:"controls_repeat_ext",inputs:{TIMES:{shadow:{type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"controls_whileUntil"},{kind:"block",type:"controls_for",inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:10}}},BY:{shadow:{type:"math_number",fields:{NUM:1}}}}},{kind:"block",type:"controls_forEach"},{kind:"block",type:"controls_flow_statements"}]},{kind:"category",name:"Math",categorystyle:"math_category",contents:[{kind:"block",type:"math_number",fields:{NUM:123}},{kind:"block",type:"math_arithmetic",inputs:{A:{shadow:{type:"math_number",fields:{NUM:1}}},B:{shadow:{type:"math_number",fields:{NUM:1}}}}},{kind:"block",type:"math_single",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:9}}}}},{kind:"block",type:"math_trig",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:45}}}}},{kind:"block",type:"math_constant"},{kind:"block",type:"math_number_property",inputs:{NUMBER_TO_CHECK:{shadow:{type:"math_number",fields:{NUM:0}}}}},{kind:"block",type:"math_round",fields:{OP:"ROUND"},inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:3.1}}}}},{kind:"block",type:"math_on_list",fields:{OP:"SUM"}},{kind:"block",type:"math_modulo",inputs:{DIVIDEND:{shadow:{type:"math_number",fields:{NUM:64}}},DIVISOR:{shadow:{type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"math_constrain",inputs:{VALUE:{shadow:{type:"math_number",fields:{NUM:50}}},LOW:{shadow:{type:"math_number",fields:{NUM:1}}},HIGH:{shadow:{type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_int",inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_float"},{kind:"block",type:"math_atan2",inputs:{X:{shadow:{type:"math_number",fields:{NUM:1}}},Y:{shadow:{type:"math_number",fields:{NUM:1}}}}}]},{kind:"category",name:"Text",categorystyle:"text_category",contents:[{kind:"block",type:"text"},{kind:"block",type:"text_multiline"},{kind:"block",type:"text_join"},{kind:"block",type:"text_append",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{kind:"block",type:"text_length",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_isEmpty",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:""}}}}},{kind:"block",type:"text_indexOf",inputs:{VALUE:{block:{type:"variables_get"}},FIND:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_charAt",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"text_getSubstring",inputs:{STRING:{block:{type:"variables_get"}}}},{kind:"block",type:"text_changeCase",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_trim",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_count",inputs:{SUB:{shadow:{type:"text"}},TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"text_replace",inputs:{FROM:{shadow:{type:"text"}},TO:{shadow:{type:"text"}},TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"text_reverse",inputs:{TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"add_text",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}},COLOR:{shadow:{type:"colour_picker",fields:{COLOUR:"#aa00cc"}}}}}]},{kind:"category",name:"Color",categorystyle:"colour_category",contents:[{kind:"block",type:"colour_picker"},{kind:"block",type:"colour_random"},{kind:"block",type:"colour_rgb",inputs:{RED:{shadow:{type:"math_number",fields:{NUM:100}}},GREEN:{shadow:{type:"math_number",fields:{NUM:50}}},BLUE:{shadow:{type:"math_number",fields:{NUM:0}}}}},{kind:"block",type:"colour_blend",inputs:{COLOUR1:{shadow:{type:"colour_picker",fields:{COLOUR:"#ff0000"}}},COLOUR2:{shadow:{type:"colour_picker",fields:{COLOUR:"#3333ff"}}},RATIO:{shadow:{type:"math_number",fields:{NUM:.5}}}}}]},{kind:"sep"},{kind:"category",name:"Variables",categorystyle:"variable_category",custom:"VARIABLE"},{kind:"category",name:"Functions",categorystyle:"procedure_category",custom:"PROCEDURE"},{kind:"category",name:"Misty",categorystyle:"list_category",contents:[{kind:"block",type:"lists_length"},{kind:"block",type:"ChangeLED"},{kind:"block",type:"DisplayImage"},{kind:"block",type:"MoveArm"},{kind:"block",type:"MoveArm2"},{kind:"block",type:"MoveArms"},{kind:"block",type:"MoveHead"},{kind:"block",type:"MoveHead2"},{kind:"block",type:"MoveHead3"},{kind:"block",type:"DriveTime"},{kind:"block",type:"DriveTime2"},{kind:"block",type:"Turn"},{kind:"block",type:"lists_indexOf",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_getIndex",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_setIndex",inputs:{LIST:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_getSublist",inputs:{LIST:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_split",inputs:{DELIM:{shadow:{type:"text",fields:{TEXT:","}}}}}]}]}},532:(e,t)=>{"use strict";var n,r=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function v(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case o:case a:case s:case d:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case h:case m:case f:case l:return e;default:return t}}case i:return t}}}n=Symbol.for("react.module.reference")},457:(e,t,n)=>{"use strict";n(532)},478:function(e,t,n){var r,i,o;i=[n(363)],void 0===(o="function"===typeof(r=function(e){return e})?r.apply(t,i):r)||(e.exports=o)},363:function(e,t,n){var r,i,o;i=[],r=function(){var e,t,r,i,o,s,a,l,c,u,h,d,p,f,m,g,v,_,b,y,T,E,S,w,x,M,C,I,k,R,A,L,O,N,P,D,$,B,F,U,z,H,G,V,W,j,X,Y,K,q,J,Z,Q,ee,te,ne,re,ie,oe,se,ae,le,ce,ue,he,de,pe,fe,me,ge,ve,_e,be,ye,Te,Ee,Se,we,xe,Me,Ce,Ie,ke,Re,Ae,Le,Oe,Ne,Pe,De,$e,Be,Fe,Ue,ze,He,Ge,Ve,We,je,Xe,Ye,Ke,qe,Je,Ze,Qe,et,tt,nt,rt,it,ot,st,at,lt,ct,ut,ht,dt,pt,ft,mt,gt,vt,_t,bt,yt,Tt,Et,St,wt,xt,Mt,Ct,It,kt,Rt,At,Lt,Ot,Nt,Pt,Dt,$t,Bt,Ft,Ut,zt,Ht,Gt,Vt,Wt,jt,Xt,Yt,Kt,qt,Jt,Zt,Qt,en,tn,nn,rn,on,sn,an,ln,cn,un,hn,dn,pn,fn,mn,gn,vn,_n,bn,yn,Tn,En,Sn,wn,xn,Mn,Cn,In,kn,Rn,An,Ln,On,Nn,Pn,Dn,$n,Bn,Fn,Un,zn,Hn,Gn,Vn,Wn,jn,Xn,Yn,Kn,qn,Jn,Zn,Qn,er,tr,nr,rr,ir,or,sr,ar,lr,cr,ur,hr,dr,pr,fr,mr,gr,vr,_r,br,yr,Tr,Er,Sr,wr,xr,Mr,Cr,Ir,kr,Rr,Ar,Lr,Or,Nr,Pr,Dr,$r,Br,Fr,Ur,zr,Hr,Gr,Vr,Wr,jr,Xr,Yr,Kr,qr,Jr,Zr,Qr,ei,ti,ni,ri,ii,oi,si,ai,li,ci,ui,hi,di,pi,fi,mi,gi,vi,_i,bi,yi,Ti,Ei,Si,wi,xi,Mi,Ci,Ii,ki,Ri,Ai,Li,Oi,Ni,Pi,Di,$i,Bi,Fi,Ui,zi,Hi,Gi,Vi,Wi,ji,Xi,Yi,Ki,qi,Ji,Zi,Qi,eo,to,no,ro,io,oo,so,ao,lo,co,uo,ho,po,fo,mo,go,vo,_o,bo,yo,To,Eo,So,wo,xo,Mo,Co,Io,ko,Ro,Ao,Lo,Oo,No,Po,Do,$o,Bo,Fo,Uo,zo,Ho,Go,Vo,Wo,jo,Xo,Yo,Ko,qo,Jo,Zo,Qo,es,ts,ns,rs,is,os,ss,as,ls,cs,us,hs,ds,ps,fs,ms,gs,vs,_s,bs,ys,Ts,Es,Ss,ws,xs,Ms,Cs,Is,ks,Rs,As,Ls,Os={};e=function(e,n,r,i){if(!(e instanceof Bs)&&"string"!==typeof e||""==="".concat(e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e="".concat(e).toLowerCase(),"string"!==typeof n||""===n.trim())throw Error('Invalid name "'+n+'". The name must be a non-empty string.');const o=n.toLowerCase();if(!r)throw Error("Can not register a null value");let s=Ns[e],a=Ds[e];if(s||(s=Ns[e]=Object.create(null),a=Ds[e]=Object.create(null)),t(e,r),!i&&s[o])throw Error('Name "'+o+'" with type "'+e+'" already registered.');s[o]=r,a[o]=n},t=function(e,t){if(e===String(Bs.FIELD)&&"function"!==typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},r=function(e,t){e="".concat(e).toLowerCase(),t=t.toLowerCase();const n=Ns[e];n&&n[t]?(delete Ns[e][t],delete Ds[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},i=function(e,t,n){e="".concat(e).toLowerCase(),t=t.toLowerCase();const r=Ns[e];if(!r||!r[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",n)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return r[t]},o=function(e,t){return e="".concat(e).toLowerCase(),t=t.toLowerCase(),!!(e=Ns[e])&&!!e[t]},s=function(e,t,n){return i(e,t,n)},a=function(e,t,n){return i(e,t,n)},l=function(e,t,n){e="".concat(e).toLowerCase();var r=Ns[e];if(!r){if(r="Unable to find [".concat(e,"] in the registry."),n)throw Error("".concat(r," You must require or register a ").concat(e," plugin."));return console.warn(r),null}if(!t)return r;e=Ds[e],n=Object.create(null);for(const i of Object.keys(r))n[e[i]]=r[i];return n},c=function(e,t,n){return"function"===typeof(t=t.plugins[String(e)]||$s)?t:s(e,t,n)},u=function(e){return Gs[e]||null},h=function(){const e=[];for(const t in Gs)e.push(Gs[t]);return e},d=function(e){Gs[e.id]=e},p=function(e){delete Gs[e.id]},f=function(){return Us},m=function(e){Us=e},g=function(){return Vs},v=function(e){Vs=e},_=function(){return zs},b=function(e){zs=e},y=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),n=e.getCachedParentSvgSize();var r=t.parentElement;if(r instanceof HTMLElement){var i=r.offsetWidth;r=r.offsetHeight,n.width!==i&&(t.setAttribute("width",i+"px"),e.setCachedParentSvgSize(i,null)),n.height!==r&&(t.setAttribute("height",r+"px"),e.setCachedParentSvgSize(null,r)),e.resize()}},T=function(e,t){const n=Object.create(null),r=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=r.indexOf(e),r.splice(e,r.length-e));for(let i,o=0;i=r[o];o++)n[i.type]?n[i.type]++:n[i.type]=1;return n},E=function(e){return function(){this.jsonInit(e)}},S=function(e){js.defineBlocksWithJsonArrayInternal(e)},w=function(e){Os.defineBlocks$$module$build$src$core$common(Os.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},Os.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let n=0;n<e.length;n++){const r=e[n];if(!r){console.warn("Block definition #".concat(n," in JSON array is ").concat(r,". Skipping"));continue}const i=r.type;i?t[i]={init:E(r)}:console.warn("Block definition #".concat(n," in JSON array is missing a type attribute. ")+"Skipping.")}return t},Os.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const n=e[t];t in Hs&&console.warn('Block definiton "'.concat(t,'" overwrites previous definition.')),Hs[t]=n}},x=function(){return"blockly-"+(Ea++).toString(36)},M=function(){return Ta.genUid()},C=function(e){Ks=e},I=function(){return Ks},k=function(e){_a.fireInternal(e)},R=function(e){if(N()){if(!va.length)try{requestAnimationFrame((()=>{setTimeout(A,0)}))}catch(t){setTimeout(A,0)}va.push(e)}},A=function(){var e=L(va,!0);va.length=0;for(let n,r=0;n=e[r];r++)if(n.workspaceId){var t=u(n.workspaceId);t&&t.fireChangeListener(n)}e=new Set(e.map((e=>e.workspaceId)));for(const n of e){if(!n)continue;if(!(e=u(n)))continue;let r;for(t=(e=e.getUndoStack()).length;0<t;t--){const n=e[t-1];if(""===n.group)break;if(void 0===r)r=n.group;else if(n.group!==r)break}r&&t!=e.length-1&&(t=e.splice(t,e.length-t),t=L(t,!0),e.push(...t))}},L=function(e,t){e=e.slice(),t||e.reverse();const n=[],r=Object.create(null);for(let s,a=0;s=e[a];a++)if(!s.isNull()){var i=[s.isUiEvent?ta:s.type,s.blockId,s.workspaceId].join(" "),o=r[i];const e=o?o.event:null;o?s.type===Os.MOVE$$module$build$src$core$events$utils&&o.index===a-1?(i=s,e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,i.reason&&(e.reason?(i=new Set(i.reason.concat(e.reason)),e.reason=Array.from(i)):e.reason=i.reason),o.index=a):s.type===Os.CHANGE$$module$build$src$core$events$utils&&s.element===e.element&&s.name===e.name?e.newValue=s.newValue:s.type===ua?(o=s,e.viewTop=o.viewTop,e.viewLeft=o.viewLeft,e.scale=o.scale,e.oldScale=o.oldScale):s.type===ia&&e.type===sa||(r[i]={event:s,index:a},n.push(s)):(r[i]={event:s,index:a},n.push(s))}e=n.filter((function(e){return!e.isNull()})),t||e.reverse();for(let s,a=1;s=e[a];a++)s.type===Os.CHANGE$$module$build$src$core$events$utils&&"mutation"===s.element&&e.unshift(e.splice(a,1)[0]);return e},O=function(){for(let e,t=0;e=va[t];t++)e.recordUndo=!1},Os.disable$$module$build$src$core$events$utils=function(){qs++},Os.enable$$module$build$src$core$events$utils=function(){qs--},N=function(){return 0===qs},Os.getGroup$$module$build$src$core$events$utils=function(){return Ys},Os.setGroup$$module$build$src$core$events$utils=function(e){_a.setGroupInternal(e)},P=function(e){Ys="boolean"===typeof e?e?M():"":e},D=function(e){const t=[];e=e.getDescendants(!1);for(let n,r=0;n=e[r];r++)t[r]=n.id;return t},$=function(e,t){const n=B(e.type);if(!n)throw Error("Unknown event type.");return n.fromJson(e,t)},B=function(e){const t=s(Bs.EVENT,e);if(!t)throw Error("Event type ".concat(e," not found in registry."));return t},F=function(e){if((e.type===Os.MOVE$$module$build$src$core$events$utils||e.type===Os.CREATE$$module$build$src$core$events$utils)&&e.workspaceId){var t=u(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const n=Ks;try{Ks=!1;const n=e.getParent();if(n&&n.isEnabled()){const t=e.getDescendants(!1);for(let e,n=0;e=t[n];n++)e.setEnabled(!0)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setEnabled(!1),e=e.getNextBlock()}while(e)}finally{Ks=n}}}},U=function(e,t){z(),Va=setTimeout((function(){t&&t.handleRightClick(e)}),Ua)},z=function(){Va&&(clearTimeout(Va),Va=0)},H=function(){Ha=null},G=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&W(e)},V=function(e){return"".concat(e.pointerId)},W=function(e){const t=V(e);return Ha?Ha===t:"pointerdown"===e.type&&(Ha=t,!0)},j=function(e,t,n,r,i){function o(e){(i||G(e))&&(n?r.call(n,e):r(e))}const s=[];if(t in Ga)for(let a=0;a<Ga[t].length;a++){const n=Ga[t][a];e.addEventListener(n,o,!1),s.push([e,n,o])}else e.addEventListener(t,o,!1),s.push([e,t,o]);return s},X=function(e,t,n,r){function i(e){n?r.call(n,e):r(e)}const o=[];if(t in Ga)for(let s=0;s<Ga[t].length;s++){const n=Ga[t][s];e.addEventListener(n,i,!1),o.push([e,n,i])}else e.addEventListener(t,i,!1),o.push([e,t,i]);return o},Y=function(e){const t=e[e.length-1][2];for(;e.length;){const[t,n,r]=e.pop();t.removeEventListener(n,r,!1)}return t},K=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},q=function(e){return!(!e.ctrlKey||!Ja)||2===e.button},J=function(e,t,n){const r=t.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,n||(n=t.getScreenCTM().inverse()),r.matrixTransform(n)},Z=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*el,y:e.deltaY*el};case 2:return{x:e.deltaX*tl,y:e.deltaY*tl}}},Q=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},ee=function(e){if(sl)throw Error("CSS already injected");al+="\n"+e},te=function(e,t){sl||(sl=!0,e&&(e=t.replace(/[\\/]$/,""),t=al.replace(/<<<PATH>>>/g,e),al="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},ne=function(e,t,n,r){e=e+" was deprecated in "+t+" and will be deleted in "+n+".",r&&(e+="\nUse "+r+" instead."),console.warn(e)},re=function(e,t,n){e=document.createElementNS(dl,"".concat(e));for(const r in t)e.setAttribute(r,"".concat(t[r]));return n&&n.appendChild(e),e},ie=function(e,t){return!(t=t.split(" ")).every((t=>e.classList.contains(t)))&&(e.classList.add(...t),!0)},oe=function(e,t){e.classList.remove(...t.split(" "))},se=function(e,t){return!(t=t.split(" ")).every((t=>!e.classList.contains(t)))&&(e.classList.remove(...t),!0)},ae=function(e,t){return e.classList.contains(t)},le=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},ce=function(e,t){const n=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");n?t.insertBefore(e,n):t.appendChild(e)},ue=function(e,t){return ne("Blockly.utils.dom.containsNode","version 10","version 11",'Use native "contains" DOM method'),e.contains(t)},he=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},de=function(){gl++,ml||(ml=Object.create(null))},pe=function(){--gl||(ml=null)},fe=function(e){const t=e.textContent+"\n"+e.className.baseVal;let n;if(ml&&(n=ml[t]))return n;try{n=e.getComputedTextLength()}catch(r){return 8*e.textContent.length}return ml&&(ml[t]=n),n},me=function(e,t,n,r){return ge(e,t+"pt",n,r)},ge=function(e,t,n,r){const i=e.textContent;var o;return e=i+"\n"+e.className.baseVal,ml&&(o=ml[e])||(vl||((o=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(o),vl=o.getContext("2d")),vl.font=n+" "+t+" "+r,o=i?vl.measureText(i).width:0,ml&&(ml[e]=o)),o},ve=function(e,t,n,r){const i=document.createElement("span");i.style.font=n+" "+t+" "+r,i.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(i),t.appendChild(e),document.body.appendChild(t),n={height:0,baseline:0};try{t.style.alignItems="baseline",n.baseline=e.offsetTop-i.offsetTop,t.style.alignItems="flex-end",n.height=e.offsetTop-i.offsetTop}finally{document.body.removeChild(t)}return n},_e=function(e){return El.getSizeInternal(e)},be=function(e){if("none"!==Te(e,"display"))return ye(e);const t=e.style,n=t.display,r=t.visibility,i=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const o=e.offsetWidth;return e=e.offsetHeight,t.display=n,t.position=i,t.visibility=r,new Tl(o,e)},ye=function(e){return new Tl(e.offsetWidth,e.offsetHeight)},Te=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},Ee=function(e){const t=new cl(0,0);e=e.getBoundingClientRect();var n=document.documentElement;return n=new cl(window.pageXOffset||n.scrollLeft,window.pageYOffset||n.scrollTop),t.x=e.left+n.x,t.y=e.top+n.y,t},Se=function(){const e=document.body,t=document.documentElement;return new cl(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},we=function(e){const t=parseFloat(Te(e,"borderLeftWidth")),n=parseFloat(Te(e,"borderRightWidth")),r=parseFloat(Te(e,"borderTopWidth"));return e=parseFloat(Te(e,"borderBottomWidth")),new yl(r,e,t,n)},xe=function(e,t,n){e=Me(e,t,n),t.scrollLeft=e.x,t.scrollTop=e.y},Me=function(e,t,n){var r=Ee(e),i=Ee(t),o=we(t);const s=r.x-i.x-o.left;return r=r.y-i.y-o.top,i=ye(e),e=t.clientWidth-i.width,i=t.clientHeight-i.height,o=t.scrollLeft,t=t.scrollTop,n?(o+=s-e/2,t+=r-i/2):(o+=Math.min(s,Math.max(s-e,0)),t+=Math.min(r,Math.max(r-i,0))),new cl(o,t)},Ce=function(e){const t=new cl(0,0);var n=e.x&&e.getAttribute("x");const r=e.y&&e.getAttribute("y");return n&&(t.x=parseInt(n)),r&&(t.y=parseInt(r)),(n=(n=e.getAttribute("transform"))&&n.match(wl))&&(t.x+=Number(n[1]),n[3]&&(t.y+=Number(n[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(xl))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Ie=function(e){let t=0,n=0;for(;e;){const r=Ce(e);if(t+=r.x,n+=r.y,-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new cl(t,n)},ke=function(){const e=Se();return new yl(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Re=function(){const e=document.documentElement,t=window;return new cl(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Ae=function(e,t){var n=t.x;t=t.y;const r=e.getInjectionDiv().getBoundingClientRect();return n=new cl(n-r.left,t-r.top),t=e.getOriginOffsetInPixels(),cl.difference(n,t).scale(1/e.scale)},Le=function(e,t){var n=t.scale(e.scale);t=n.x,n=n.y;const r=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new cl(t+r.left+e.x,n+r.top+e.y)},Oe=function(e){({document:Rl=Rl,DOMParser:Al=Al,XMLSerializer:Ll=Ll}=e),Il=new Al,kl=new Ll},Os.createElement$$module$build$src$core$utils$xml=function(e){return Rl.createElementNS(Ol,e)},Os.createTextNode$$module$build$src$core$utils$xml=function(e){return Rl.createTextNode(e)},Os.textToDom$$module$build$src$core$utils$xml=function(e){let t=Il.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=Il.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error("DOMParser was unable to parse: ".concat(e))},Ne=function(e){return Pe(kl.serializeToString(e))},Pe=function(e){return e.replace(Nl,(e=>"&#".concat(e.charCodeAt(0),";")))},De=function(e){return e?((e instanceof Element||"string"===typeof e)&&(e=We(e),e=He(e)),$e(e),e):null},$e=function(e){const t=e.kind;if(e=e.contents,t&&t!==Bl&&t!==$l)throw Error("Invalid toolbox kind "+t+". Please supply either "+Bl+" or "+$l);if(!e)throw Error("Toolbox must have a contents attribute.")},Be=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Ge(e):[]},Fe=function(e){return Hl.hasCategoriesInternal(e)},Ue=function(e){if(!e)return!1;const t=e.kind;return t?t===$l:!!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length},ze=function(e){return!(!e||!e.contents)&&!!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length},He=function(e){const t={contents:Ge(e)};return e instanceof Node&&Ve(e,t),t},Ge=function(e){const t=[];let n=e.childNodes;n||(n=e);for(let r,i=0;r=n[i];i++){if(!r.tagName)continue;e={};const n=r.tagName.toUpperCase();e.kind=n,"BLOCK"===n?e.blockxml=r:r.childNodes&&0<r.childNodes.length&&(e.contents=Ge(r)),Ve(r,e),t.push(e)}return t},Ve=function(e,t){for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n];-1<r.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[r.nodeName.replace("css-","")]=r.value):t[r.nodeName]=r.value}},We=function(e){let t=null;if(e)if("string"===typeof e){if(t=Os.textToDom$$module$build$src$core$utils$xml(e),"xml"!==t.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},je=function(e,t,n,r,i,o){const s=o.scrollbar&&o.scrollbar.canScrollVertically();return e.horizontal===Ul.LEFT?(n=i.absoluteMetrics.left+n,s&&o.RTL&&(n+=Cl.scrollbarThickness)):(n=i.absoluteMetrics.left+i.viewMetrics.width-t.width-n,s&&!o.RTL&&(n-=Cl.scrollbarThickness)),e.vertical===Fl.TOP?e=i.absoluteMetrics.top+r:(e=i.absoluteMetrics.top+i.viewMetrics.height-t.height-r,o.scrollbar&&o.scrollbar.canScrollHorizontally()&&(e-=Cl.scrollbarThickness)),new yl(e,e+t.height,n,n+t.width)},Xe=function(e,t){return{horizontal:t.toolboxMetrics.position===Dl.LEFT||e.horizontalLayout&&!e.RTL?Ul.RIGHT:Ul.LEFT,vertical:t.toolboxMetrics.position===Dl.BOTTOM?Fl.TOP:Fl.BOTTOM}},Ye=function(e,t,n,r){const i=e.left,o=e.right-e.left,s=e.bottom-e.top;for(let a=0;a<r.length;a++){const l=r[a];e.intersects(l)&&(e=n===zl.UP?l.top-s-t:l.bottom+t,e=new yl(e,e+s,i,i+o),a=-1)}return e},Ke=function(e,t){ql(e,t)},qe=function(e){ql=e},Je=function(e,t){Ql.confirmInternal(e,t)},Ze=function(e,t){Jl(e,t)},Qe=function(e){Jl=e},et=function(e,t,n){Zl(e,t,n)},tt=function(e){Zl=e},nt=function(e){return void 0!==e.getVariableModel},rt=function(e){return void 0!==e.getProcedureDef},it=function(e){return void 0!==e.getProcedureCall&&void 0!==e.renameProcedure},Os.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n=0;n<e.length;n++){const r=e[n].getVarModels();if(r)for(let e=0;e<r.length;e++){const n=r[e];n.getId()&&t.add(n)}}return Array.from(t.values())},Os.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let r,i=0;r=e[i];i++){var n=r.getDeveloperVariables;if(n){n=n();for(let e=0;e<n.length;e++)t.add(n[e])}}return Array.from(t.values())},ot=function(e){let t=[];const n=document.createElement("button");return n.setAttribute("text","%{BKY_NEW_VARIABLE}"),n.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",(function(e){ut(e.getTargetWorkspace())})),t.push(n),e=st(e),t.concat(e)},st=function(e){const t=[];if(0<(e=e.getVariablesOfType("")).length){var n=e[e.length-1];if(Hs.variables_set){var r=Os.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","variables_set"),r.setAttribute("gap",Hs.math_change?"8":"24"),r.appendChild(vt(n)),t.push(r)}if(Hs.math_change&&((r=Os.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),r.setAttribute("gap",Hs.variables_get?"20":"8"),r.appendChild(vt(n)),n=Os.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),r.appendChild(n),t.push(r)),Hs.variables_get){e.sort(ic.compareByName);for(let r,i=0;r=e[i];i++)(n=Os.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),n.setAttribute("gap","8"),n.appendChild(vt(r)),t.push(n)}}return t},at=function(e){return ac.generateUniqueNameInternal(e)},lt=function(e){return ct(sc.charAt(0),e.getAllVariableNames())},ct=function(e,t){if(!t.length)return e;const n=sc;let r="",i=n.indexOf(e);for(;;){let o=!1;for(let n=0;n<t.length;n++)if(t[n].toLowerCase()===e){o=!0;break}if(!o)break;i++,i===n.length&&(i=0,r="".concat(Number(r)+1)),e=n.charAt(i)+r}return e},ut=function(e,t,n){function r(n){ht(Os.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,n,(function(n){if(n){var o=pt(n,e);if(o){if(o.type===i)var s=Os.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",o.name);else s=(s=Os.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",o.name).replace("%2",o.type);Ke(s,(function(){r(n)}))}else e.createVariable(n,i),t&&t(n)}else t&&t(null)}))}const i=n||"";r("")},Os.renameVariable$$module$build$src$core$variables=function(e,t,n){function r(i){const o=Os.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);ht(o,i,(function(i){if(i){var o=dt(i,t.type,e),s=ft(t.name,i,e);if(o||s){var a="";o?a=Os.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",o.name).replace("%2",o.type):s&&(a=Os.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",i).replace("%2",s)),Ke(a,(function(){r(i)}))}else e.renameVariableById(t.getId(),i),n&&n(i)}else n&&n(null)}))}r("")},ht=function(e,t,n){et(e,t,(function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").trim())===Os.Msg$$module$build$src$core$msg.RENAME_VARIABLE||e===Os.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(e=null),n(e)}))},dt=function(e,t,n){n=n.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r,i=0;r=n[i];i++)if(r.name.toLowerCase()===e&&r.type!==t)return r;return null},pt=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,r=0;n=t[r];r++)if(n.name.toLowerCase()===e)return n;return null},ft=function(e,t,n){return n.getProcedureMap().getProcedures().length?mt(e,t,n):gt(e,t,n)},mt=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getProcedureMap().getProcedures();for(const i of n){var r=i.getParameters().filter(nt).map((e=>e.getVariableModel().name));if(r&&(n=r.some((t=>t.toLowerCase()===e)),r=r.some((e=>e.toLowerCase()===t)),n&&r))return i.getName()}return null},gt=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getAllBlocks(!1);for(const i of n){if(!rt(i))continue;var r=(n=i.getProcedureDef())[1];const o=r.some((t=>t.toLowerCase()===e));if(r=r.some((e=>e.toLowerCase()===t)),o&&r)return n[0]}return null},vt=function(e){const t=Os.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=Os.createTextNode$$module$build$src$core$utils$xml(e.name),t.appendChild(e),t},Os.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,n,r){let i=Os.getVariable$$module$build$src$core$variables(e,t,n,r);return i||(i=_t(e,t,n,r)),i},Os.getVariable$$module$build$src$core$variables=function(e,t,n,r){const i=e.getPotentialVariableMap();let o=null;if(t&&(o=e.getVariableById(t),!o&&i&&(o=i.getVariableById(t)),o))return o;if(n){if(void 0===r)throw Error("Tried to look up a variable by name without a type");o=e.getVariable(n,r),!o&&i&&(o=i.getVariable(n,r))}return o},_t=function(e,t,n,r){const i=e.getPotentialVariableMap();return n||(n=at(e.isFlyout?e.targetWorkspace:e)),i?i.createVariable(n,r,t):e.createVariable(n,r,t)},bt=function(e,t){e=e.getAllVariables();const n=[];if(t.length!==e.length)for(let r=0;r<e.length;r++){const i=e[r];-1===t.indexOf(i)&&n.push(i)}return n},yt=function(t,n){e(Bs.PASTER,t,n)},Tt=function(e){r(Bs.PASTER,e)},Et=function(e){return Mt(e),xt()?(Ct(),Promise.resolve()):(bc||(bc=new Promise((e=>{yc=e,Tc=window.requestAnimationFrame((()=>{Ct(),e()}))}))),bc)},St=function(){return bc||Promise.resolve()},wt=function(e){e||window.cancelAnimationFrame(Tc),Ct(e),!e&&yc&&yc()},xt=function(){return ja},Mt=function(e){_c.add(e);const t=e.getParent();t?Mt(t):vc.add(e)},Ct=function(e){const t=e?new Set([e]):new Set([...vc].map((e=>e.workspace))),n=[...vc].filter(kt).filter((e=>t.has(e.workspace)));for(var r of n)Rt(r);for(const i of t)i.resizeContents();for(const i of n)r=i.getRelativeToSurfaceXY(),i.updateComponentLocations(r);for(const i of n)It(i);e||(bc=null)},It=function(e){vc.delete(e),_c.delete(e);for(const t of e.getChildren(!1))It(t)},kt=function(e){return!e.isDisposed()&&!e.getParent()},Rt=function(e){if(_c.has(e)){for(const t of e.getChildren(!1))Rt(t);e.renderEfficiently()}},At=function(e,t){const n=Os.createElement$$module$build$src$core$utils$xml("xml");var r=Lt(Os.allUsedVarModels$$module$build$src$core$variables(e));r.hasChildNodes()&&n.appendChild(r),r=e.getTopComments(!0);for(let i=0;i<r.length;i++)n.appendChild(r[i].toXmlWithXY(t));for(e=e.getTopBlocks(!0),r=0;r<e.length;r++)n.appendChild(Ot(e[r],t));return n},Lt=function(e){const t=Os.createElement$$module$build$src$core$utils$xml("variables");for(let n=0;n<e.length;n++){const r=e[n],i=Os.createElement$$module$build$src$core$utils$xml("variable");i.appendChild(Os.createTextNode$$module$build$src$core$utils$xml(r.name)),r.type&&i.setAttribute("type",r.type),i.id=r.getId(),t.appendChild(i)}return t},Ot=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let n=0;if(e.workspace.RTL&&(n=e.workspace.getWidth()),t=Dt(e,t),tn(t)){const r=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?n-r.x:r.x))),t.setAttribute("y",String(Math.round(r.y)))}return t},Nt=function(e){if(e.isSerializable()){const t=Os.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},Pt=function(e,t){for(let n=0;n<e.inputList.length;n++){const r=e.inputList[n];for(let e=0;e<r.fieldRow.length;e++){const n=Nt(r.fieldRow[e]);n&&t.appendChild(n)}}},Dt=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Dt(t):new DocumentFragment;const n=Os.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(n.setAttribute("type",e.type),t||(n.id=e.id),e.mutationToDom){var r=e.mutationToDom();r&&(r.hasChildNodes()||r.hasAttributes())&&n.appendChild(r)}if(Pt(e,n),r=e.getCommentText()){var i=e.getIcon(Xl.COMMENT),o=i.getBubbleSize();i=i.bubbleIsVisible();var s=Os.createElement$$module$build$src$core$utils$xml("comment");s.appendChild(Os.createTextNode$$module$build$src$core$utils$xml(r)),s.setAttribute("pinned","".concat(i)),s.setAttribute("h",String(o.height)),s.setAttribute("w",String(o.width)),n.appendChild(s)}for(e.data&&((r=Os.createElement$$module$build$src$core$utils$xml("data")).appendChild(Os.createTextNode$$module$build$src$core$utils$xml(e.data)),n.appendChild(r)),r=0;r<e.inputList.length;r++){var a=void 0;if(i=!0,(o=e.inputList[r]).type!==Os.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&o.type!==Os.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){s=o.connection.targetBlock(),o.type===Os.inputTypes$$module$build$src$core$inputs$input_types.VALUE?a=Os.createElement$$module$build$src$core$utils$xml("value"):o.type===Os.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(a=Os.createElement$$module$build$src$core$utils$xml("statement"));const e=o.connection.getShadowDom();!e||s&&s.isShadow()||a.appendChild($t(e,t)),s&&(s=Dt(s,t)).nodeType===hl.ELEMENT_NODE&&(a.appendChild(s),i=!1),a.setAttribute("name",o.name),i||n.appendChild(a)}}let l;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&n.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&n.setAttribute("collapsed","true"),e.isEnabled()||n.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||n.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||n.setAttribute("movable","false"),e.isEditable()||n.setAttribute("editable","false"),(a=e.getNextBlock())&&(r=Dt(a,t)).nodeType===hl.ELEMENT_NODE&&(l=Os.createElement$$module$build$src$core$utils$xml("next"),l.appendChild(r),n.appendChild(l)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||a&&a.isShadow()||l.appendChild($t(e,t)),n},$t=function(e,t){let n,r=e=e.cloneNode(!0);for(;r;)if(t&&"shadow"===r.nodeName&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){let e;n=r,r=r.parentNode,n.nodeType===hl.TEXT_NODE&&""===n.data.trim()&&(null==(e=r)?void 0:e.firstChild)!==n&&le(n)}r&&(n=r,r=r.nextSibling,n.nodeType===hl.TEXT_NODE&&""===n.data.trim()&&le(n))}return e},Bt=function(e){return Ne(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Ft=function(e){e=Bt(e).split("<");let t="";for(let n=1;n<e.length;n++){const r=e[n];"/"===r[0]&&(t=t.substring(2)),e[n]=t+"<"+r,"/"!==r[0]&&"/>"!==r.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Ut=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=Os.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},Os.domToWorkspace$$module$build$src$core$xml=function(e,t){let n=0;t.RTL&&(n=t.getWidth());const r=[];de();const i=Os.getGroup$$module$build$src$core$events$utils();i||Os.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let o=!0;try{for(let i,s=0;i=e.childNodes[s];s++){const e=i.nodeName.toLowerCase(),s=i;if("block"===e||"shadow"===e&&!I()){const e=Ht(s,t);let i;r.push(e.id);const a=parseInt(null!=(i=s.getAttribute("x"))?i:"10",10);let l;const c=parseInt(null!=(l=s.getAttribute("y"))?l:"10",10);isNaN(a)||isNaN(c)||e.moveBy(t.RTL?n-a:a,c,["create"]),o=!1}else{if("shadow"===e)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===e)t.rendered?gc.fromXmlRendered(s,t,n):cc.fromXml(s,t);else if("variables"===e){if(!o)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Gt(s,t),o=!1}}}}finally{Os.setGroup$$module$build$src$core$events$utils(i),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&wt(),pe()}return k(new(B(ma))(t)),r},zt=function(e,t){if(!t.getBlocksBoundingBox)return Os.domToWorkspace$$module$build$src$core$xml(e,t);var n=t.getBlocksBoundingBox();if(e=Os.domToWorkspace$$module$build$src$core$xml(e,t),n&&n.top!==n.bottom){var r=n.bottom;n=t.RTL?n.right:n.left;var i=1/0;let o=-1/0,s=1/0;for(let n=0;n<e.length;n++){const r=t.getBlockById(e[n]).getRelativeToSurfaceXY();r.y<s&&(s=r.y),r.x<i&&(i=r.x),r.x>o&&(o=r.x)}for(r=r-s+10,n=t.RTL?n-o:n-i,i=0;i<e.length;i++)t.getBlockById(e[i]).moveBy(n,r,["create"])}return e},Os.domToBlock$$module$build$src$core$xml=function(e,t){return e=Ht(e,t),t.rendered&&wt(),e},Ht=function(e,t){Os.disable$$module$build$src$core$events$utils();var n=t.getAllVariables();let r;try{if(r=Zt(e,t),t.rendered){const e=r,n=r.getDescendants(!1);e.setConnectionTracking(!1);for(let t=n.length-1;0<=t;t--)n[t].initSvg();for(let t=n.length-1;0<=t;t--)n[t].queueRender();setTimeout((function(){e.disposed||e.setConnectionTracking(!0)}),1),t.resizeContents()}else{const e=r.getDescendants(!1);for(let t=e.length-1;0<=t;t--)e[t].initModel()}}finally{Os.enable$$module$build$src$core$events$utils()}if(N()){for(e=bt(t,n),t=0;t<e.length;t++)n=e[t],k(new(B(Zs))(n));k(new(B(Os.CREATE$$module$build$src$core$events$utils))(r))}return r},Gt=function(e,t){for(let r=0;r<e.children.length;r++){var n=e.children[r];const i=n.getAttribute("type"),o=n.getAttribute("id");if(!(n=n.textContent))break;t.createVariable(n,i,o)}},Vt=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let n=0;n<e.children.length;n++){const r=e.children[n];if(r.nodeType!==hl.TEXT_NODE)switch(r.nodeName.toLowerCase()){case"mutation":t.mutation.push(r);break;case"comment":t.comment.push(r);break;case"data":t.data.push(r);break;case"title":case"field":t.field.push(r);break;case"value":case"statement":t.input.push(r);break;case"next":t.next.push(r);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}}return t},Wt=function(e,t){let n=!1;for(let r=0;r<e.length;r++){const i=e[r];t.domToMutation&&(t.domToMutation(i),t.initSvg&&(n=!0))}return n},jt=function(e,t){for(let r=0;r<e.length;r++){var n=e[r];const i=n.textContent,o="true"===n.getAttribute("pinned");let s;const a=parseInt(null!=(s=n.getAttribute("w"))?s:"50",10);let l;n=parseInt(null!=(l=n.getAttribute("h"))?l:"50",10),t.setCommentText(i);const c=t.getIcon(Xl.COMMENT);isNaN(a)||isNaN(n)||c.setBubbleSize(new Tl(a,n)),c.setBubbleVisible(o),setTimeout((()=>c.setBubbleVisible(o)),1)}},Xt=function(e,t){for(let n=0;n<e.length;n++)t.data=e[n].textContent},Yt=function(e,t){for(let n=0;n<e.length;n++){const r=e[n],i=r.getAttribute("name");i?Qt(t,i,r):console.warn("Ignoring unnamed field in block ".concat(t.type))}},Kt=function(e){let t=null,n=null;for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes[r];tn(i)&&("block"===i.nodeName.toLowerCase()?t=i:"shadow"===i.nodeName.toLowerCase()&&(n=i))}return{childBlockElement:t,childShadowElement:n}},qt=function(e,t,n,r){for(let o=0;o<e.length;o++){var i=e[o];const s=i.getAttribute("name"),a=s?n.getInput(s):null;if(!a){console.warn("Ignoring non-existent input "+s+" in block "+r);break}if((i=Kt(i)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");Zt(i.childBlockElement,t,a.connection,!1)}if(i.childShadowElement){let e;null==(e=a.connection)||e.setShadowDom(i.childShadowElement)}}},Jt=function(e,t,n){for(let r=0;r<e.length;r++){const i=Kt(e[r]);if(i.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Zt(i.childBlockElement,t,n.nextConnection,!0)}i.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(i.childShadowElement)}},Zt=function(e,t,n,r){var i;const o=e.getAttribute("type");if(!o)throw TypeError("Block type unspecified: "+e.outerHTML);var s=null!=(i=e.getAttribute("id"))?i:void 0;i=t.newBlock(o,s),s=Vt(e);const a=Wt(s.mutation,i);if(jt(s.comment,i),Xt(s.data,i),n)if(r){if(!i.previousConnection)throw TypeError("Next block does not have previous statement.");n.connect(i.previousConnection)}else if(i.outputConnection)n.connect(i.outputConnection);else{if(!i.previousConnection)throw TypeError("Child block does not have output or previous statement.");n.connect(i.previousConnection)}if(Yt(s.field,i),qt(s.input,t,i,o),Jt(s.next,t,i),a&&i.initSvg(),(t=e.getAttribute("inline"))&&i.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&i.setEnabled("true"!==t&&"disabled"!==t),(t=e.getAttribute("deletable"))&&i.setDeletable("true"===t),(t=e.getAttribute("movable"))&&i.setMovable("true"===t),(t=e.getAttribute("editable"))&&i.setEditable("true"===t),(t=e.getAttribute("collapsed"))&&i.setCollapsed("true"===t),"shadow"===e.nodeName.toLowerCase()){for(e=i.getChildren(!1),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(i.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");i.setShadow(!0)}return i},Qt=function(e,t,n){const r=e.getField(t);r?r.fromXml(n):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},en=function(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if("next"===n.nodeName.toLowerCase()){e.removeChild(n);break}}},tn=function(e){return e.nodeType===hl.ELEMENT_NODE},nn=function(e){return void 0!==e.saveState&&void 0!==e.loadState},rn=function(t,n){e(Bs.SERIALIZER,t,n)},on=function(e){r(Bs.SERIALIZER,e)},sn=function(e){let{addCoordinates:t=!1,addInputBlocks:n=!0,addNextBlocks:r=!0,doFullSerialization:i=!0,saveIds:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.isInsertionMarker())return null;const s={type:e.type,id:o?e.id:void 0};return t&&ln(e,s),an(e,s),cn(e,s,i),un(e,s,i),hn(e,s,i),n&&dn(e,s,i,o),r&&pn(e,s,i,o),s},an=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.enabled=!1),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},ln=function(e,t){const n=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(n.RTL?n.getWidth()-e.x:e.x),t.y=Math.round(e.y)},cn=function(e,t,n){e.saveExtraState?null!==(e=e.saveExtraState(n))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=Bt(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},un=function(e,t,n){const r=Object.create(null);for(const i of e.getIcons())nn(i)&&(e=i.saveState(n))&&(r[i.getType().toString()]=e);Object.keys(r).length&&(t.icons=r)},hn=function(e,t,n){const r=Object.create(null);for(let i=0;i<e.inputList.length;i++){const t=e.inputList[i];for(let e=0;e<t.fieldRow.length;e++){const i=t.fieldRow[e];i.isSerializable()&&(r[i.name]=i.saveState(n))}}Object.keys(r).length&&(t.fields=r)},dn=function(e,t,n,r){const i=Object.create(null);for(let o=0;o<e.inputList.length;o++){const t=e.inputList[o];if(!t.connection)continue;const s=fn(t.connection,n,r);s&&(i[t.name]=s)}Object.keys(i).length&&(t.inputs=i)},pn=function(e,t,n,r){e.nextConnection&&(e=fn(e.nextConnection,n,r))&&(t.next=e)},fn=function(e,t,n){const r=e.getShadowState(!0);if(e=e.targetBlock(),!r&&!e)return null;const i=Object.create(null);return r&&(i.shadow=r),e&&!e.isShadow()&&(i.block=sn(e,{doFullSerialization:t,saveIds:n})),i},mn=function(e,t){let{recordUndo:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=gn(e,t,{recordUndo:n}),t.rendered&&wt(),e},gn=function(e,t){let{parentConnection:n,isShadow:r=!1,recordUndo:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=I();let s;C(i),(i=Os.getGroup$$module$build$src$core$events$utils())||Os.setGroup$$module$build$src$core$events$utils(!0),Os.disable$$module$build$src$core$events$utils();try{s=vn(e,t,{parentConnection:n,isShadow:r})}finally{Os.enable$$module$build$src$core$events$utils()}if(N()&&k(new(B(Os.CREATE$$module$build$src$core$events$utils))(s)),Os.setGroup$$module$build$src$core$events$utils(i),C(o),t.rendered){const e=s;setTimeout((()=>{e.disposed||e.setConnectionTracking(!0)}),1)}return s},vn=function(e,t){let{parentConnection:n,isShadow:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.type)throw new xc(e);const i=t.newBlock(e.type,e.id);return i.setShadow(r),_n(i,e),bn(i,e),yn(i,e),Tn(n,i,e),En(i,e),Sn(i,e),wn(i,e),xn(i,e),Cn(i,t.rendered),i},_n=function(e,t){let n=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const r=e.workspace;n=r.RTL?r.getWidth()-n:n,e.moveBy(n,t)},bn=function(e,t){t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setEnabled(!1),void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},yn=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(Os.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Tn=function(e,t,n){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Ic(n);if(e.type===Os.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var r=t.outputConnection;if(!r)throw new Mc("output",t,n)}else if(!(r=t.previousConnection))throw new Mc("previous",t,n);if(!e.connect(r)){const i=t.workspace.connectionChecker;throw new Cc(i.getErrorMessage(i.canConnectWithReason(r,e,!1),r,e),e.type===Os.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,n)}}},En=function(e,t){if(t.icons){var n=Object.keys(t.icons);for(const i of n){n=t.icons[i];var r=e.getIcon(i);if(!r){if(!(r=s(Bs.ICON,i,!1)))throw new kc(i,e,t);r=new r(e),e.addIcon(r)}nn(r)&&r.loadState(n)}}},Sn=function(e,t){if(t.fields){var n=Object.keys(t.fields);for(let r=0;r<n.length;r++){const i=n[r],o=t.fields[i],s=e.getField(i);s?s.loadState(o):console.warn("Ignoring non-existant field ".concat(i," in block ").concat(e.type))}}},wn=function(e,t){if(t.inputs){var n=Object.keys(t.inputs);for(let r=0;r<n.length;r++){const i=n[r],o=e.getInput(i);if(!o||!o.connection)throw new Mc(i,e,t);Mn(o.connection,t.inputs[i])}}},xn=function(e,t){if(t.next){if(!e.nextConnection)throw new Mc("next",e,t);Mn(e.nextConnection,t.next)}},Mn=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&vn(t.block,e.getSourceBlock().workspace,{parentConnection:e})},Cn=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const t of e.getIcons())t.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},In=function(e){const t=e.workspace,n=Os.config$$module$build$src$core$config.snapRadius,r=e.getRelativeToSurfaceXY(),i=new cl(0,0),o=t.getAllBlocks(!1).filter((t=>t.id!=e.id)).map((e=>e.getRelativeToSurfaceXY()));for(;kn(cl.sum(r,i),o)||Rn(e,i,n);)t.RTL?i.translate(-n,2*n):i.translate(n,2*n);e.moveTo(cl.sum(r,i))},kn=function(e,t){return t.some((t=>1>=Math.abs(t.x-e.x)&&1>=Math.abs(t.y-e.y)))},Rn=function(e,t,n){return e.getConnections_(!1).some((e=>!!e.closest(n,t).connection))},An=function(e){return ne("Blockly.clipboard.copy","v11","v12","myCopyable.toCopyData()"),qc.copyInternal(e)},Ln=function(e){const t=e.toCopyData();let n;return Yc=t,Kc=null!=(n=e.workspace)?n:null,t},On=function(e,t,n){return e&&t?Nn(e,t,n):Yc&&Kc?Nn(Yc,Kc):null},Nn=function(e,t,n){let r,i,o;return t=null!=(r=t.getRootWorkspace())?r:t,null!=(o=null==(i=a(Bs.PASTER,e.paster,!1))?void 0:i.paste(e,t,n))?o:null},Pn=function(e){return ne("Blockly.clipboard.duplicate","v11","v12","Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)"),qc.duplicateInternal(e)},Dn=function(e){const t=e.toCopyData();return t?On(t,e.workspace):null},$n=function(e,t){e.setAttribute(tu,t)},Bn=function(e,t,n){Array.isArray(n)&&(n=n.join(" ")),e.setAttribute(eu+t,"".concat(n))},Fn=function(){return ru},Un=function(e){if(ru=e,null===e){let e;null==(e=document.querySelector("."+lu))||e.remove()}},zn=function(){document.querySelector("."+lu)||((ru=document.createElement("div")).className=lu,(_()||document.body).appendChild(ru))},Hn=function(e,t,n){Gn(),su=e,au=n,(e=ru)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=f(),cu=t.getRenderer().getClassName(),uu=t.getTheme().getClassName(),cu&&ie(e,cu),uu&&ie(e,uu))},Gn=function(){if(Vn()){su=null;var e=ru;e&&(e.style.display="none",e.style.left="",e.style.top="",au&&au(),au=null,e.textContent="",cu&&(se(e,cu),cu=""),uu&&(se(e,uu),uu=""),f().markFocused())}},Vn=function(){return!!su},Wn=function(e){su===e&&Gn()},jn=function(e,t,n){ru.style.left=e+"px",ru.style.top=t+"px",ru.style.height=n+"px"},Xn=function(e,t,n,r){const i=Kn(e,t,n);e=Yn(e,t,n,r),0>i?jn(e,0,n.height+i):jn(e,i,n.height)},Yn=function(e,t,n,r){return r?Math.min(Math.max(t.right-n.width,e.left),e.right-n.width):Math.max(Math.min(t.left,e.right-n.width),e.left)},Kn=function(e,t,n){return t.bottom+n.height>=e.bottom?t.top-n.height:t.bottom},qn=function(e){return!(null==e||!e.repositionForWindowResize)},Jn=function(){qn(su)&&su.repositionForWindowResize()||Gn()},Zn=function(){return du},Qn=function(e){du=e},er=function(e,t,n){if(Hn(pu,n,sr),t.length){var r=tr(t,n);fu=r,nr(r,e,n),setTimeout((function(){r.focus()}),1),du=null}else or()},tr=function(e,t){const n=new iu;n.setRole(Zc.MENU);for(let r=0;r<e.length;r++){const i=e[r],o=new ou(i.text);o.setRightToLeft(t),o.setRole(Zc.MENUITEM),n.addChild(o),o.setEnabled(i.enabled),i.enabled&&o.onAction((function(){or(),requestAnimationFrame((()=>{setTimeout((()=>{i.callback(i.scope)}),0)}))}),{})}return n},nr=function(e,t,n){const r=ke();t=new yl(t.clientY+r.top,t.clientY+r.top,t.clientX+r.left,t.clientX+r.left),rr(e);const i=e.getSize();n&&(t.left+=i.width,t.right+=i.width,r.left+=i.width,r.right+=i.width),Xn(r,t,i,n),e.focus()},rr=function(e){var t=Fn();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ie(t,"blocklyContextMenu"),j(t,"contextmenu",null,ir),e.focus()},ir=function(e){e.preventDefault(),e.stopPropagation()},or=function(){Wn(pu),du=null},sr=function(){fu&&(fu.dispose(),fu=null)},Os.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let n;Os.disable$$module$build$src$core$events$utils();try{n=t instanceof Element?Ht(t,e.workspace):gn(t,e.workspace);const r=e.getRelativeToSurfaceXY();r.x=e.RTL?r.x-Os.config$$module$build$src$core$config.snapRadius:r.x+Os.config$$module$build$src$core$config.snapRadius,r.y+=2*Os.config$$module$build$src$core$config.snapRadius,n.moveBy(r.x,r.y)}finally{Os.enable$$module$build$src$core$events$utils()}return N()&&!n.isShadow()&&k(new(B(Os.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}},ar=function(e){return{text:Os.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){Os.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),Os.setGroup$$module$build$src$core$events$utils(!1)}}},lr=function(e){return{text:Os.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const t=e.toCopyData();t&&On(t,e.workspace)}}},cr=function(e,t){const n={enabled:!0};return n.text=Os.Msg$$module$build$src$core$msg.ADD_COMMENT,n.callback=function(){const n=new gc(e,Os.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,gc.DEFAULT_SIZE,gc.DEFAULT_SIZE);var r=e.getInjectionDiv().getBoundingClientRect();r=new cl(t.clientX-r.left,t.clientY-r.top);const i=e.getOriginOffsetInPixels();(r=cl.difference(r,i)).scale(1/e.scale),n.moveBy(r.x,r.y),e.rendered&&(n.initSvg(),n.render(),n.select())},n},ur=function(e){return e*Math.PI/180},hr=function(e){return 180*e/Math.PI},dr=function(e,t,n){if(n<e){const t=n;n=e,e=t}return Math.max(e,Math.min(t,n))},pr=function(){document.querySelector(".blocklyDropDownDiv")||((yu=document.createElement("div")).className="blocklyDropDownDiv",(_()||document.body).appendChild(yu),(Tu=document.createElement("div")).className="blocklyDropDownContent",yu.appendChild(Tu),(Eu=document.createElement("div")).className="blocklyDropDownArrow",yu.appendChild(Eu),yu.style.opacity="0",yu.style.transition="transform "+Cu+"s, opacity "+Cu+"s",yu.addEventListener("focusin",(function(){ie(yu,"blocklyFocused")})),yu.addEventListener("focusout",(function(){se(yu,"blocklyFocused")})))},fr=function(e){Lu=e},mr=function(){return Ou},gr=function(){return Tu},vr=function(){Tu.textContent="",Tu.style.width=""},_r=function(e,t){yu.style.backgroundColor=e,yu.style.borderColor=t},br=function(e,t,n,r){return Sr(Tr(t),e,n,r)},yr=function(e,t,n){return Nu=!0,Sr(Er(e),e,t,n)},Tr=function(e){var t=e.getSvgRoot();const n=e.workspace.scale,r=e.height*n;return e=e.width*n,t=Ee(t),new yl(t.y,t.y+r,t.x,t.x+e)},Er=function(e){return e=e.getScaledBBox(),new yl(e.top,e.bottom,e.left,e.right)},Sr=function(e,t,n,r){const i=e.left+(e.right-e.left)/2,o=e.bottom;e=e.top,r&&(e+=r);let s=(r=t.getSourceBlock()).workspace;for(;s.options.parentWorkspace;)s=s.options.parentWorkspace;return fr(s.getParentSvg().parentNode),wr(t,r.RTL,i,o,i,e,n)},wr=function(e,t,n,r,i,o,s){return Ou=e,ku=s||null,yu.style.direction=t?"rtl":"ltr",e=f(),Ru=e.getRenderer().getClassName(),Au=e.getTheme().getClassName(),Ru&&ie(yu,Ru),Au&&ie(yu,Au),Or(n,r,i,o)},xr=function(e,t,n,r){return{initialX:(e=Ir(e,n.left,n.right,r.width)).divX,initialY:t,finalX:e.divX,finalY:t+Mu,arrowX:e.arrowX,arrowY:-(Su/2+wu),arrowAtTop:!0,arrowVisible:!0}},Mr=function(e,t,n,r){return{initialX:(e=Ir(e,n.left,n.right,r.width)).divX,initialY:t-r.height,finalX:e.divX,finalY:t-r.height-Mu,arrowX:e.arrowX,arrowY:r.height-2*wu-Su/2,arrowAtTop:!1,arrowVisible:!0}},Cr=function(e,t,n){return{initialX:(e=Ir(e,t.left,t.right,n.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Ir=function(e,t,n,r){return t=dr(t,e-r/2,n-r),{arrowX:e=dr(n=xu,e=e-Su/2-t,r-n-Su),divX:t}},kr=function(){return!!Ou},Rr=function(e,t){return Ou===e&&(t?Lr():Ar(),!0)},Ar=function(){yu.style.transform="translate(0, 0)",yu.style.opacity="0",Iu=setTimeout((function(){Lr()}),1e3*Cu),ku&&(ku(),ku=null)},Lr=function(){kr()&&(Iu&&clearTimeout(Iu),yu.style.transform="",yu.style.left="",yu.style.top="",yu.style.opacity="0",yu.style.display="none",yu.style.backgroundColor="",yu.style.borderColor="",ku&&(ku(),ku=null),vr(),Ou=null,Ru&&(se(yu,Ru),Ru=""),Au&&(se(yu,Au),Au=""),f().markFocused())},Or=function(e,t,n,r){(e=Pu.getPositionMetrics(e,t,n,r)).arrowVisible?(Eu.style.display="",Eu.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Eu.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):Eu.style.display="none",t=Math.floor(e.initialX),n=Math.floor(e.initialY),r=Math.floor(e.finalX);const i=Math.floor(e.finalY);return yu.style.left=t+"px",yu.style.top=n+"px",yu.style.display="block",yu.style.opacity="1",yu.style.transform="translate("+(r-t)+"px,"+(i-n)+"px)",!!e.arrowAtTop},Nr=function(){if(Ou){var e=Ou.getSourceBlock();const t=(e=Nu?Er(Ou):Tr(e)).left+(e.right-e.left)/2;Or(t,e.bottom,t,e.top)}else Ar()},Pr=function(e){if(!(100<e.getDescendants(!1).length)){var t=e.workspace,n=e.getSvgRoot();t.getAudioManager().play("delete");var r=t.getSvgXY(n);(n=n.cloneNode(!0)).setAttribute("transform","translate("+r.x+","+r.y+")"),t.getParentSvg().appendChild(n),Dr(n,{x:r.x,y:r.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)}},Dr=function(e,t,n,r,i){const o=((new Date).getTime()-r.getTime())/150;1<o?le(e):(e.setAttribute("transform","translate("+(t.x+(n?-1:1)*t.width*i/2*o)+","+(t.y+t.height*i*o)+") scale("+(1-o)*i+")"),setTimeout(Dr,10,e,t,n,r,i))},$r=function(e){var t=e.workspace;const n=t.scale;if(t.getAudioManager().play("click"),!(1>n)){var r=t.getSvgXY(e.getSvgRoot());e.outputConnection?(r.x+=(e.RTL?3:-3)*n,r.y+=13*n):e.previousConnection&&(r.x+=(e.RTL?-23:23)*n,r.y+=3*n);var i=re(bl.CIRCLE,{cx:r.x,cy:r.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=re(bl.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*n},i),t=re(bl.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},i),e.beginElement(),t.beginElement(),setTimeout((()=>{le(i)}),150)}},Br=function(e){if(Ur(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Bu=e,Fr(e,t,new Date)}},Fr=function(e,t,n){const r=((new Date).getTime()-n.getTime())/200;let i="";1>=r&&(i="skewX(".concat(Math.round(Math.sin(r*Math.PI*3)*(1-r)*t),")"),$u=setTimeout(Fr,10,e,t,n)),e.getSvgRoot().setAttribute("transform","".concat(e.getTranslation()," ").concat(i))},Ur=function(){Bu&&($u&&(clearTimeout($u),$u=null),Bu.getSvgRoot().setAttribute("transform",Bu.getTranslation()),Bu=null)},zr=function(e,t){return ne("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},Hr=function(e){return e.length?e.reduce((function(e,t){return e.length<t.length?e:t})).length:0},Gr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,r=0;for(t=t||Hr(e),n=0;n<t;n++){for(var i=e[0][n],o=1;o<e.length;o++)if(i!==e[o][n])return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((o=e[i][n])&&" "!==o)return r;return t},Vr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,r=0;for(t=t||Hr(e),n=0;n<t;n++){for(var i=e[0].substr(-n-1,1),o=1;o<e.length;o++)if(i!==e[o].substr(-n-1,1))return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((o=e[i].charAt(e[i].length-n-1))&&" "!==o)return r;return t},Os.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let n=0;n<e.length;n++)e[n]=Wr(e[n],t);return e.join("\n")},Wr=function(e,t){if(e.length<=t)return e;const n=e.trim().split(/\s+/);for(var r=0;r<n.length;r++)n[r].length>t&&(t=n[r].length);var i=-1/0;let o,s=1;do{r=i,o=e,e=[],i=n.length/s;let a=1;for(let t=0;t<n.length-1;t++)a<(t+1.5)/i?(a++,e[t]=!0):e[t]=!1;e=Xr(n,e,t),i=jr(n,e,t),e=Yr(n,e),s++}while(i>r);return o},jr=function(e,t,n){const r=[0],i=[];for(var o=0;o<e.length;o++)r[r.length-1]+=e[o].length,!0===t[o]?(r.push(0),i.push(e[o].charAt(e[o].length-1))):!1===t[o]&&r[r.length-1]++;for(e=Math.max(...r),t=0,o=0;o<r.length;o++)t-=2*Math.pow(Math.abs(n-r[o]),1.5),t-=Math.pow(e-r[o],1.5),-1!==".?!".indexOf(i[o])?t+=n/3:-1!==",;)]}".indexOf(i[o])&&(t+=n/4);return 1<r.length&&r[r.length-1]<=r[r.length-2]&&(t+=.5),t},Xr=function(e,t,n){let r,i=jr(e,t,n);for(let o=0;o<t.length-1;o++){if(t[o]===t[o+1])continue;const s=[].concat(t);s[o]=!s[o],s[o+1]=!s[o+1];const a=jr(e,s,n);a>i&&(i=a,r=s)}return r?Xr(e,r,n):t},Yr=function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e[r]),void 0!==t[r]&&n.push(t[r]?"\n":" ");return n.join("")},Os.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Kr=function(e){Ku=e},qr=function(){return Ku},Jr=function(){return qu},Zr=function(){return uh},Qr=function(e){if(e=ei(e)){for(e=e.tooltip;"function"===typeof e;)e=e();if("string"!==typeof e)throw Error("Tooltip function must return a string.");return e}return""},ei=function(e){for(;e&&e.tooltip;){if("string"===typeof e.tooltip||"function"===typeof e.tooltip)return e;e=e.tooltip}return null},ti=function(){document.querySelector(".blocklyTooltipDiv")||((uh=document.createElement("div")).className="blocklyTooltipDiv",(_()||document.body).appendChild(uh))},ni=function(e){e.mouseOverWrapper_=X(e,"pointerover",null,ii),e.mouseOutWrapper_=X(e,"pointerout",null,oi),e.addEventListener("pointermove",si,!1)},ri=function(e){e&&(Y(e.mouseOverWrapper_),Y(e.mouseOutWrapper_),e.removeEventListener("pointermove",si))},ii=function(e){Ju||(e=ei(e.currentTarget),rh!==e&&(li(),ih=null,rh=e),clearTimeout(Qu))},oi=function(e){Ju||(Qu=setTimeout((function(){ih=rh=null,li()}),1),clearTimeout(eh),eh=0)},si=function(e){if(rh&&rh.tooltip&&!Ju)if(qu){const t=th-e.pageX;e=nh-e.pageY,Math.sqrt(t*t+e*e)>ah&&li()}else ih!==rh&&(clearTimeout(eh),th=e.pageX,nh=e.pageY,eh=setTimeout(fi,lh))},ai=function(){ih=rh=null,li()},li=function(){qu&&(qu=!1,uh&&(uh.style.display="none")),eh&&(clearTimeout(eh),eh=0)},ci=function(){li(),Ju=!0},ui=function(){Ju=!1},hi=function(){uh&&rh&&("function"===typeof Ku?Ku(uh,rh):di())},di=function(){var e=Qr(rh);e=(e=Os.wrap$$module$build$src$core$utils$string(e,Zu)).split("\n");for(let t=0;t<e.length;t++){const n=document.createElement("div");n.appendChild(document.createTextNode(e[t])),uh.appendChild(n)}},pi=function(e){const t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;let r=th;r=e?r-(oh+uh.offsetWidth):r+oh;let i=nh+sh;return i+uh.offsetHeight>n+window.scrollY&&(i-=uh.offsetHeight+2*sh),e?r=Math.max(ch-window.scrollX,r):r+uh.offsetWidth>t+window.scrollX-2*ch&&(r=t-uh.offsetWidth-2*ch),{x:r,y:i}},fi=function(){if(!Ju&&(ih=rh,uh)){uh.textContent="",hi();var e=rh.RTL;uh.style.direction=e?"rtl":"ltr",uh.style.display="block",qu=!0;var{x:t,y:n}=pi(e);uh.style.left=t+"px",uh.style.top=n+"px"}},mi=function(e,t){for(const n in t)e[n]=null!==t[n]&&"object"===typeof t[n]?mi(e[n]||Object.create(null),t[n]):t[n];return e},gi=function(e){return void 0!==e.bubbleIsVisible&&void 0!==e.setBubbleVisible},vi=function(){return Sh},_i=function(e){Sh=e},bi=function(){return wh},yi=function(e){wh=e},Ti=function(e){e="".concat(e).toLowerCase().trim();var t=xh[e];if(t)return t;if(t="#"===(t="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?t:"#"+t,/^#[0-9a-f]{6}$/.test(t))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var n=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return n&&(e=Number(n[1]),t=Number(n[2]),n=Number(n[3]),0<=e&&256>e&&0<=t&&256>t&&0<=n&&256>n)?Ei(e,t,n):null},Ei=function(e,t,n){return t=e<<16|t<<8|n,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Si=function(e){return(e=Ti(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},wi=function(e,t,n){let r=0,i=0,o=0;if(0===t)o=i=r=n;else{const s=Math.floor(e/60),a=e/60-s;e=n*(1-t);const l=n*(1-t*a);switch(t=n*(1-t*(1-a)),s){case 1:r=l,i=n,o=e;break;case 2:r=e,i=n,o=t;break;case 3:r=e,i=l,o=n;break;case 4:r=t,i=e,o=n;break;case 5:r=n,i=e,o=l;break;case 6:case 0:r=n,i=t,o=e}}return Ei(Math.floor(r),Math.floor(i),Math.floor(o))},xi=function(e,t,n){return(e=Ti(e))&&(t=Ti(t))?(e=Si(e),t=Si(t),Ei(Math.round(t[0]+n*(e[0]-t[0])),Math.round(t[1]+n*(e[1]-t[1])),Math.round(t[2]+n*(e[2]-t[2])))):null},Mi=function(e){return wi(e,Sh,255*wh)},Ci=function(e,t,n){const r=[];var i=e.split("");i.push("");var o=0;e=[];let s=null;for(let c=0;c<i.length;c++){var a=i[c];if(0===o)if("%"===a)(o=e.join(""))&&r.push(o),e.length=0,o=1;else if(n&&"\n"===a){const t=e.join("");t&&r.push(t),e.length=0,r.push(a)}else e.push(a);else if(1===o)"%"===a?(e.push(a),o=0):t&&"0"<=a&&"9">=a?(o=2,s=a,(a=e.join(""))&&r.push(a),e.length=0):"{"===a?o=3:(e.push("%",a),o=0);else if(2===o)if("0"<=a&&"9">=a)s+=a;else{var l=void 0;r.push(parseInt(null!=(l=s)?l:"",10)),c--,o=0}else 3===o&&(""===a?(e.splice(0,0,"%{"),c--,o=0):"}"!==a?e.push(a):(o=e.join(""),/[A-Z]\w*/i.test(o)&&(a=(a=o.toUpperCase()).startsWith("BKY_")?a.substring(4):null)&&a in Os.Msg$$module$build$src$core$msg?"string"===typeof(o=Os.Msg$$module$build$src$core$msg[a])?Array.prototype.push.apply(r,Ci(o,t,n)):t?r.push("".concat(o)):r.push(o):r.push("%{"+o+"}"),o=e.length=0))}for((t=e.join(""))&&r.push(t),l=[],e.length=0,i=0;i<r.length;i++)"string"!==typeof r[i]||n&&"\n"===r[i]?((t=e.join(""))&&l.push(t),e.length=0,l.push(r[i])):e.push(r[i]);return(t=e.join(""))&&l.push(t),e.length=0,l},Ii=function(e){return Ci(e,!0,!0)},ki=function(e){return"string"!==typeof e?e:(e=Ci(e,!1,!1)).length?String(e[0]):""},Ri=function(e){let t=!0;const n=Os.Msg$$module$build$src$core$msg,r=e.match(/%{BKY_[A-Z]\w*}/gi);if(r)for(let i=0;i<r.length;i++)void 0===n[r[i].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+r[i]+" in "+e),t=!1);return t},Ai=function(e){const t="string"===typeof e?ki(e):e;var n=Number(t);if(!isNaN(n)&&0<=n&&360>=n)return{hue:n,hex:wi(n,vi(),255*bi())};if(n=Ti(t))return{hue:null,hex:n};throw n='Invalid colour: "'+t+'"',e!==t&&(n+=' (from "'+e+'")'),Error(n)},Li=function(e){return void 0!==e.getProcedureModel&&void 0!==e.doProcedureUpdate&&void 0!==e.isProcedureDef},Oi=function(e){return void 0!==e.startPublishing&&void 0!==e.stopPublishing},Ni=function(t,n){e(Bs.FIELD,t,n)},Pi=function(e){r(Bs.FIELD,e)},Os.fromJson$$module$build$src$core$field_registry=function(e){return Oh.fromJsonInternal(e)},Di=function(e){const t=a(Bs.FIELD,e.type);if(t){if("function"!==typeof t.fromJson)throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},$i=function(e){let t=!1;const n=e.map((e=>{let[n,r]=e;return"string"===typeof n?[ki(n),r]:(t=!0,[null!==n.alt?Object.assign({},n,{alt:ki(n.alt)}):Object.assign({},n),r])}));if(t||2>e.length)return{options:n};var r=n.map((e=>{let[t]=e;return t})),i=Hr(r);e=Gr(r,i);const o=Vr(r,i);return!e&&!o||i<=e+o?{options:n}:(i=e?r[0].substring(0,e-1):void 0,r=o?r[0].substr(1-o):void 0,{options:Bi(n,e,o),prefix:i,suffix:r})},Bi=function(e,t,n){return e.map((e=>{let[r,i]=e;return[r.substring(t,r.length-n),i]}))},Fi=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)?"string"!==typeof r[1]?(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!==typeof r[0]&&"string"!==typeof r[0].src&&(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",r))}if(t)throw TypeError("Found invalid FieldDropdown options.")},Os.register$$module$build$src$core$extensions=function(e,t){if("string"!==typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Hh[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!==typeof t)throw Error('Error: Extension "'+e+'" must be a function');Hh[e]=t},Os.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!==typeof t)throw Error('Error: Mixin "'+e+'" must be a object');Os.register$$module$build$src$core$extensions(e,(function(){this.mixin(t)}))},Os.registerMutator$$module$build$src$core$extensions=function(e,t,n,r){const i='Error when registering mutator "'+e+'": ';Yi(i,t);const o=ji(t,i);if(n&&"function"!==typeof n)throw Error(i+'Extension "'+e+'" is not a function');Os.register$$module$build$src$core$extensions(e,(function(){o&&this.setMutator(new Os.MutatorIcon$$module$build$src$core$icons$mutator_icon(r||[],this)),this.mixin(t),n&&n.apply(this)}))},Ui=function(e){zi(e)?delete Hh[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},zi=function(e){return!!Hh[e]},Hi=function(e,t,n){const r=Hh[e];if("function"!==typeof r)throw Error('Error: Extension "'+e+'" not found.');let i;if(n?Gi(e,t):i=Ki(t),r.apply(t),n)Yi('Error after applying mutator "'+e+'": ',t);else if(!qi(i,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},Gi=function(e,t){if(Ki(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},Vi=function(e,t){return Xi(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},Wi=function(e,t){return Xi(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},ji=function(e,t){return Xi(e.compose,e.decompose,t+" compose/decompose")},Xi=function(e,t,n){if(e&&t){if("function"!==typeof e||"function"!==typeof t)throw Error(n+" must be a function");return!0}if(!e&&!t)return!1;throw Error(n+"Must have both or neither functions")},Yi=function(e,t){const n=Vi(t,e),r=Wi(t,e);if(!n&&!r)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");ji(t,e)},Ki=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},qi=function(e,t){if((t=Ki(t)).length!==e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},Ji=function(e){if("object"!==typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval((function(){"complete"===document.readyState&&(clearInterval(t),e())}),10)}},Os.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const n=[];return function(){-1===n.indexOf(this.type)&&(Zi(this,e,t),n.push(this.type)),this.setTooltip(function(){const n=String(this.getFieldValue(e));return ki(t[n])}.bind(this))}},Zi=function(e,t,n){var r=e.getField(t);if(r instanceof Ph&&!r.isOptionListDynamic()){r=r.getOptions();for(const[,i]of r)void 0===n[i]&&console.warn("No tooltip mapping for value ".concat(i," of field ")+"".concat(t," of block type ").concat(e.type,"."))}},Os.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const n=this.getField(t);return ki(e).replace("%1",n?n.getText():"")}.bind(this))}},Qi=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},eo=function(e,t){return" "+e+","+t+" "},to=function(e,t){return" "+e+t.join("")},no=function(e,t){return" M "+e+","+t+" "},ro=function(e,t){return" m "+e+","+t+" "},io=function(e,t){return" l "+e+","+t+" "},oo=function(e){return" l"+e.join("")},so=function(e,t){return" "+e+" "+t+" "},ao=function(e,t,n,r){return e+" "+n+" "+n+" "+t+r},lo=function(t,n){e(Bs.ICON,t.toString(),n)},co=function(e){r(Bs.ICON,e)},uo=function(e){const t=e.getProcedureMap().getProcedures().filter((e=>!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!1]));e.getBlocksByType("procedures_defnoreturn",!1).forEach((e=>{!Li(e)&&rt(e)&&t.push(e.getProcedureDef())}));const n=e.getProcedureMap().getProcedures().filter((e=>!!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!0]));return e.getBlocksByType("procedures_defreturn",!1).forEach((e=>{!Li(e)&&rt(e)&&n.push(e.getProcedureDef())})),t.sort(ho),n.sort(ho),[t,n]},ho=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},Os.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||Os.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!po(e,t.workspace,t);){const t=e.match(/^(.*?)(\d+)$/);e=t?t[1]+(parseInt(t[2])+1):e+"2"}return e},po=function(e,t,n){return!fo(e,t,n)},fo=function(e,t,n){for(const r of t.getAllBlocks(!1))if(r!==n&&rt(r)&&Os.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],e))return!0;n=n&&Li(n)?null==n?void 0:n.getProcedureModel():void 0;for(const r of t.getProcedureMap().getProcedures())if(r!==n&&Os.Names$$module$build$src$core$names.equals(r.getName(),e))return!0;return!1},Os.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new kh;e=e.trim();const n=Os.findLegalName$$module$build$src$core$procedures(e,t);Li(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(n);const r=this.getValue();if(r!==e&&r!==n)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const i=e[t];i.renameProcedure&&i.renameProcedure(r,n)}return n},mo=function(e){function t(e,t){for(let i=0;i<e.length;i++){var r=e[i][0];const o=e[i][1],s=Os.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type",t),s.setAttribute("gap","16");const a=Os.createElement$$module$build$src$core$utils$xml("mutation");for(a.setAttribute("name",r),s.appendChild(a),r=0;r<o.length;r++){const e=Os.createElement$$module$build$src$core$utils$xml("arg");e.setAttribute("name",o[r]),a.appendChild(e)}n.push(s)}}const n=[];if(Hs.procedures_defnoreturn){var r=Os.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap","16");var i=Os.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME"),i.appendChild(Os.createTextNode$$module$build$src$core$utils$xml(Os.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(i),n.push(r)}return Hs.procedures_defreturn&&((r=Os.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap","16"),(i=Os.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),i.appendChild(Os.createTextNode$$module$build$src$core$utils$xml(Os.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(i),n.push(r)),Hs.procedures_ifreturn&&((r=Os.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap","16"),n.push(r)),n.length&&n[n.length-1].setAttribute("gap","24"),t((e=uo(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),n},go=function(e){var t=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let o,s=0;o=n[s];s++)t.push(o.getFieldValue("NAME"));n=Os.createElement$$module$build$src$core$utils$xml("xml");const r=Os.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","procedures_mutatorarg");const i=Os.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME"),t=ct(Os.DEFAULT_ARG$$module$build$src$core$procedures,t),t=Os.createTextNode$$module$build$src$core$utils$xml(t),i.appendChild(t),r.appendChild(i),n.appendChild(r),e.updateToolbox(n)},vo=function(e){if(e.type===sa&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=u(e.workspaceId).getBlockById(e.blockId)).type;"procedures_defnoreturn"!==t&&"procedures_defreturn"!==t||(e=e.getIcon(Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),go(e),e.addChangeListener(_o))}},_o=function(e){e.type!==Os.CREATE$$module$build$src$core$events$utils&&e.type!==Os.DELETE$$module$build$src$core$events$utils&&e.type!==Os.CHANGE$$module$build$src$core$events$utils&&e.type!==Js||(e=u(e.workspaceId),go(e))},bo=function(e,t){return t.getAllBlocks(!1).filter((t=>yo(t,e)||it(t)&&Os.Names$$module$build$src$core$names.equals(t.getProcedureCall(),e)))},yo=function(e,t){return Li(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&Os.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},Os.mutateCallers$$module$build$src$core$procedures=function(e){const t=I();var n=e.getProcedureDef()[0];const r=e.mutationToDom(!0);e=bo(n,e.workspace);for(let o,s=0;o=e[s];s++){n=(n=o.mutationToDom())&&Ne(n),o.domToMutation&&o.domToMutation(r);var i=o.mutationToDom();n!==(i=i&&Ne(i))&&(C(!1),k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(o,"mutation",null,n,i)),C(t))}},Os.getDefinition$$module$build$src$core$procedures=function(e,t){for(const n of t.getAllBlocks(!1))if(Li(n)&&n.isProcedureDef()&&Os.Names$$module$build$src$core$names.equals(n.getProcedureModel().getName(),e)||rt(n)&&Os.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return n;return null},To=function(e){return e.isDynamic},Eo=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},So=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},wo=function(e,t){let n=null;const r=null==(t=t.outputConnection)?void 0:t.getConnectionChecker();for(let i,o=0;i=e.inputList[o];o++){const e=i.connection;let o;if(e&&null!=(o=r)&&o.canConnect(t,e,!1)){if(n)return null;n=e}}return n},xo=function(e,t){let n;for(;n=wo(e,t);)if(!(e=n.targetBlock())||e.isShadow())return n;return null},Mo=function(t,n){e(Bs.RENDERER,t,n)},Co=function(e){r(Bs.RENDERER,e)},Io=function(e,t,n){return(e=new(s(Bs.RENDERER,e))(e)).init(t,n),e},ko=function(e){ut(e.getTargetWorkspace(),void 0,"String")},Ro=function(e){ut(e.getTargetWorkspace(),void 0,"Number")},Ao=function(e){ut(e.getTargetWorkspace(),void 0,"Colour")},Lo=function(e){let t=[],n=document.createElement("button");return n.setAttribute("text",Os.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Os.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Os.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(n),e.registerButtonCallback("CREATE_VARIABLE_STRING",ko),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Ro),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Ao),e=Oo(e),t.concat(e)},Oo=function(e){const t=[];if(0<(e=e.getAllVariables()).length){if(Hs.variables_set_dynamic){var n=e[e.length-1];const r=Os.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","variables_set_dynamic"),r.setAttribute("gap","24"),r.appendChild(vt(n)),t.push(r)}if(Hs.variables_get_dynamic){e.sort(ic.compareByName);for(let r,i=0;r=e[i];i++)(n=Os.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(vt(r)),t.push(n)}}return t},No=function(e){e.resizeContents()},Po=function(e){return void 0!==e.toCopyData},Do=function(){jp.registry.register({name:Ip.ESCAPE,preconditionFn:e=>!e.options.readOnly,callback:e=>(e.hideChaff(),!0),keyCodes:[Vh.ESC]})},$o=function(){jp.registry.register({name:Ip.DELETE,preconditionFn(e){const t=g();return!e.options.readOnly&&null!=t&&t.isDeletable()},callback:(e,t)=>(t.preventDefault(),!mh.inProgress()&&(g().checkAndDelete(),!0)),keyCodes:[Vh.DELETE,Vh.BACKSPACE]})},Bo=function(){const e=jp.registry.createSerializedKey(Vh.C,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.C,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.C,[Vh.META]);jp.registry.register({name:Ip.COPY,preconditionFn(e){const t=g();return!e.options.readOnly&&!mh.inProgress()&&null!=t&&t.isDeletable()&&t.isMovable()&&Po(t)},callback:(e,t)=>(t.preventDefault(),e.hideChaff(),!(!(t=g())||!Po(t))&&(Xp=t.toCopyData(),Yp=e,!!Xp)),keyCodes:[e,t,n]})},Fo=function(){const e=jp.registry.createSerializedKey(Vh.X,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.X,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.X,[Vh.META]);jp.registry.register({name:Ip.CUT,preconditionFn(e){const t=g();return!e.options.readOnly&&!mh.inProgress()&&null!=t&&t instanceof Cp&&t.isDeletable()&&t.isMovable()&&!t.workspace.isFlyout},callback(e){const t=g();return!(!t||!Po(t))&&(Xp=t.toCopyData(),Yp=e,t.checkAndDelete(),!0)},keyCodes:[e,t,n]})},Uo=function(){const e=jp.registry.createSerializedKey(Vh.V,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.V,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.V,[Vh.META]);jp.registry.register({name:Ip.PASTE,preconditionFn:e=>!e.options.readOnly&&!mh.inProgress(),callback:()=>!(!Xp||!Yp)&&!!On(Xp,Yp),keyCodes:[e,t,n]})},zo=function(){const e=jp.registry.createSerializedKey(Vh.Z,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.Z,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.Z,[Vh.META]);jp.registry.register({name:Ip.UNDO,preconditionFn:e=>!e.options.readOnly&&!mh.inProgress(),callback:e=>(e.hideChaff(),e.undo(!1),!0),keyCodes:[e,t,n]})},Ho=function(){const e=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.ALT]),n=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.META]),r=jp.registry.createSerializedKey(Vh.Y,[Vh.CTRL]);jp.registry.register({name:Ip.REDO,preconditionFn:e=>!mh.inProgress()&&!e.options.readOnly,callback:e=>(e.hideChaff(),e.undo(!0),!0),keyCodes:[e,t,n,r]})},Go=function(){Do(),$o(),Bo(),Fo(),Uo(),zo(),Ho()},Vo=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length?(t.parameters=e.getParameters().map((e=>Wo(e))),t):t},Wo=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length?(t.types=e.getTypes(),t):t},jo=function(e,t,n,r){if(e=new e(r,n.name,n.id).setReturnTypes(n.returnTypes),!n.parameters)return e;for(const[i,o]of n.parameters.entries())e.insertParameter(Xo(t,o,r),i);return e},Xo=function(e,t,n){return e=new e(n,t.name,t.id),t.types&&e.setTypes(t.types),e},Yo=function(e){const t=Object.create(null),n=l(Bs.SERIALIZER,!0);for(const r in n){let i;const o=null==(i=n[r])?void 0:i.save(e);o&&(t[r]=o)}return t},Ko=function(e,t){let{recordUndo:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r=l(Bs.SERIALIZER,!0);if(r){r=Object.entries(r).sort(((e,t)=>t[1].priority-e[1].priority));var i=I();C(n),(n=Os.getGroup$$module$build$src$core$events$utils())||Os.setGroup$$module$build$src$core$events$utils(!0),de(),t instanceof fp&&t.setResizesEnabled(!1);for(const[,e]of r.reverse()){let n;null==(n=e)||n.clear(t)}for(let[n,i]of r.reverse())if(e[n]){let r;null==(r=i)||r.load(e[n],t)}t instanceof fp&&t.setResizesEnabled(!0),pe(),k(new(B(ma))(t)),Os.setGroup$$module$build$src$core$events$utils(n),C(i)}},qo=function(e,t,n){const r=n.getBoundingRectangle(),i=r.right-r.left,o=dr(t.top,r.top,t.top+t.height-(r.bottom-r.top))-r.top;let s=t.left;return t=t.left+t.width-i,e.RTL?s=Math.min(t,s):t=Math.max(s,t),!(!(e=dr(s,r.left,t)-r.left)&&!o)&&(n.moveBy(e,o,["inbounds"]),!0)},Jo=function(e){return t=>{var n,r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging())if(-1!==ga.indexOf(null!=(n=t.type)?n:"")){n=r.getScrollMetrics(!0);const i=Zo(e,t);i&&(r=Os.getGroup$$module$build$src$core$events$utils()||!1,Os.setGroup$$module$build$src$core$events$utils(t.group),qo(e,n,i)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),Os.setGroup$$module$build$src$core$events$utils(r))}else t.type===ua&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Qo(e)}},Zo=function(e,t){let n=null;switch(t.type){case Os.CREATE$$module$build$src$core$events$utils:case Os.MOVE$$module$build$src$core$events$utils:(n=e.getBlockById(t.blockId))&&(n=n.getRootBlock());break;case ha:case fa:n=e.getCommentById(t.commentId)}return n},Qo=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var n=e.getTopBoundedElements();for(let r,i=0;r=n[i];i++)qo(e,t,r)}},es=function(e,t){const n=[];for(const r of e.getIcons())gi(r)&&!r.bubbleIsVisible()||(n.push({location:t,icon:r}),r.onLocationChange(t));for(const r of e.getChildren(!1))n.push(...es(r,cl.sum(t,r.relativeCoords)));return n},ts=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>0<e.workspace.getUndoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:gu.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},ns=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>0<e.workspace.getRedoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:gu.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},rs=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:gu.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},is=function(e,t){function n(t){i--,t.setCollapsed(e),0===i&&Os.setGroup$$module$build$src$core$events$utils(!1)}let r=0,i=0;Os.setGroup$$module$build$src$core$events$utils(!0);for(let o=0;o<t.length;o++){let e=t[o];for(;e;)i++,setTimeout(n.bind(null,e),r),e=e.getNextBlock(),r+=10}},os=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){is(!0,e.workspace.getTopBlocks(!0))},scopeType:gu.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},ss=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){is(!1,e.workspace.getTopBlocks(!0))},scopeType:gu.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},as=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let n=0;n<e.length;n++)as(e[n],t)}},ls=function(e){const t=[];e=e.getTopBlocks(!0);for(let n=0;n<e.length;n++)as(e[n],t);return t},cs=function(e,t){t?Os.setGroup$$module$build$src$core$events$utils(t):(Os.setGroup$$module$build$src$core$events$utils(!0),t=Os.getGroup$$module$build$src$core$events$utils());const n=e.shift();n&&(n.isDeadOrDying()?cs(e,t):(n.dispose(!1,!0),setTimeout(cs,10,e,t))),Os.setGroup$$module$build$src$core$events$utils(!1)},us=function(){gu.registry.register({displayText:e=>e.workspace?1===(e=ls(e.workspace).length)?Os.Msg$$module$build$src$core$msg.DELETE_BLOCK:Os.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1","".concat(e)):"",preconditionFn:e=>e.workspace&&0<ls(e.workspace).length?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=ls(e.workspace);2>t.length?cs(t):Je(Os.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),(function(e){e&&cs(t)}))}},scopeType:gu.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},hs=function(){ts(),ns(),rs(),os(),ss(),us()},ds=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&On(t,e.block.workspace)}},scopeType:gu.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},ps=function(){gu.registry.register({displayText:e=>e.block.hasIcon(ed.TYPE)?Os.Msg$$module$build$src$core$msg.REMOVE_COMMENT:Os.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(ed.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:gu.ScopeType.BLOCK,id:"blockComment",weight:2})},fs=function(){gu.registry.register({displayText:e=>e.block.getInputsInline()?Os.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Os.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof If||e.inputList[t]instanceof If))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:gu.ScopeType.BLOCK,id:"blockInline",weight:3})},ms=function(){gu.registry.register({displayText:e=>e.block.isCollapsed()?Os.Msg$$module$build$src$core$msg.EXPAND_BLOCK:Os.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:gu.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},gs=function(){gu.registry.register({displayText:e=>e.block.isEnabled()?Os.Msg$$module$build$src$core$msg.DISABLE_BLOCK:Os.Msg$$module$build$src$core$msg.ENABLE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden",callback(e){e=e.block;const t=Os.getGroup$$module$build$src$core$events$utils();t||Os.setGroup$$module$build$src$core$events$utils(!0),e.setEnabled(!e.isEnabled()),Os.setGroup$$module$build$src$core$events$utils(t)},scopeType:gu.ScopeType.BLOCK,id:"blockDisable",weight:5})},vs=function(){gu.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?Os.Msg$$module$build$src$core$msg.DELETE_BLOCK:Os.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1","".concat(e))},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:gu.ScopeType.BLOCK,id:"blockDelete",weight:6})},_s=function(){gu.registry.register({displayText:()=>Os.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"===typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:gu.ScopeType.BLOCK,id:"blockHelp",weight:7})},bs=function(){ds(),ps(),fs(),ms(),gs(),vs(),_s()},ys=function(){hs(),bs()},Ts=function(e,t){var n=null;let r;if(n="string"===typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(n)&&document!==(null==(r=n)?void 0:r.ownerDocument))throw Error("Error: container is not in current document");e=new Th(t||{}),(t=document.createElement("div")).className="injectionDiv",t.tabIndex=0,Bn(t,Qc.LABEL,Os.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),n.appendChild(t),n=Es(t,e);const i=Ss(t,n,e);return ws(i),m(i),y(i),t.addEventListener("focusin",(function(){m(i)})),i},Es=function(e,t){e.setAttribute("dir","LTR"),te(t.hasCss,t.pathToMedia),e=re(bl.SVG,{xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const n=re(bl.DEFS,{},e),r=String(Math.random()).substring(2);return t.gridPattern=gh.createDom(r,t.gridOptions,n),e},Ss=function(e,t,n){n.parentWorkspace=null;const r=(n=new fp(n)).options;n.scale=r.zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground",e));var i=n.getRenderer().getClassName();return i&&ie(e,i),(i=n.getTheme().getClassName())&&ie(e,i),!r.hasCategories&&r.languageTree&&(e=n.addFlyout(bl.SVG),ce(e,t)),r.hasTrashcan&&n.addTrashcan(),r.zoomOptions&&r.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(Jo(n)),y(n),zn(),pr(),ti(),n},ws=function(e){const t=e.options;var n=e.getParentSvg();if(j(n.parentNode,"contextmenu",null,(function(e){K(e)||e.preventDefault()})),n=j(window,"resize",null,(function(){li(),e.hideComponents(!0),Nr(),Jn(),y(e),Qo(e)})),e.setResizeHandlerWrapper(n),Ms(),t.languageTree){n=e.getToolbox();const r=e.getFlyout(!0);n?n.init():r&&(r.init(e),r.show(t.languageTree),"function"===typeof r.scrollToStart&&r.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new nf(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&Cs(t.pathToMedia,e)},xs=function(e){const t=f();t&&!(K(e)||t.rendered&&!t.isVisible())&&jp.registry.onKeyDown(t,e)},Ms=function(){Zf||(j(document,"scroll",null,(function(){const e=h();for(let t,n=0;t=e[n];n++)t instanceof fp&&t.updateInverseScreenCTM()})),j(document,"keydown",null,xs),X(document,"touchend",null,z),X(document,"touchcancel",null,z),Ka&&j(window,"orientationchange",document,(function(){y(f())}))),Zf=!0},Cs=function(e,t){function n(){for(;i.length;){const e=i.pop();e&&Y(e)}r.preload()}const r=t.getAudioManager();r.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),r.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),r.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const i=[];i.push(j(document,"pointermove",null,n,!0)),i.push(j(document,"touchstart",null,n,!0))},Is=function(e){return void 0!==e.getType&&void 0!==e.initView&&void 0!==e.dispose&&void 0!==e.getWeight&&void 0!==e.getSize&&void 0!==e.applyColour&&void 0!==e.hideForInsertionMarker&&void 0!==e.updateEditable&&void 0!==e.updateCollapsed&&void 0!==e.isShownWhenCollapsed&&void 0!==e.setOffsetInBlock&&void 0!==e.onLocationChange&&void 0!==e.onClick},ks=function(e){return void 0!==e.paste},Rs=function(e){return e.isSelectable()},As=function(e){f().hideChaff(e)},(Ls=Ls||{}).scope={},Ls.ASSUME_ES5=!1,Ls.ASSUME_NO_NATIVE_MAP=!1,Ls.ASSUME_NO_NATIVE_SET=!1,Ls.SIMPLE_FROUND_POLYFILL=!1,Ls.ISOLATE_POLYFILLS=!1,Ls.FORCE_POLYFILL_PROMISE=!1,Ls.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Ls.defineProperty=Ls.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},Ls.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},Ls.global=Ls.getGlobal(this),Ls.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x"),Ls.TRUST_ES6_POLYFILLS=!Ls.ISOLATE_POLYFILLS||Ls.IS_SYMBOL_NATIVE,Ls.polyfills={},Ls.propertyToPolyfillSymbol={},Ls.POLYFILL_PREFIX="$jscp$",Ls.polyfill=function(e,t,n,r){t&&(Ls.ISOLATE_POLYFILLS?Ls.polyfillIsolated(e,t,n,r):Ls.polyfillUnisolated(e,t,n,r))},Ls.polyfillUnisolated=function(e,t,n,r){for(n=Ls.global,e=e.split("."),r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))return;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&Ls.defineProperty(n,e,{configurable:!0,writable:!0,value:t})},Ls.polyfillIsolated=function(e,t,n,r){var i=e.split(".");e=1===i.length,r=i[0],r=!e&&r in Ls.polyfills?Ls.polyfills:Ls.global;for(var o=0;o<i.length-1;o++){var s=i[o];if(!(s in r))return;r=r[s]}i=i[i.length-1],null!=(t=t(n=Ls.IS_SYMBOL_NATIVE&&"es6"===n?r[i]:null))&&(e?Ls.defineProperty(Ls.polyfills,i,{configurable:!0,writable:!0,value:t}):t!==n&&(void 0===Ls.propertyToPolyfillSymbol[i]&&(n=1e9*Math.random()>>>0,Ls.propertyToPolyfillSymbol[i]=Ls.IS_SYMBOL_NATIVE?Ls.global.Symbol(i):Ls.POLYFILL_PREFIX+n+"$"+i),Ls.defineProperty(r,Ls.propertyToPolyfillSymbol[i],{configurable:!0,writable:!0,value:t})))},Ls.polyfill("globalThis",(function(e){return e||Ls.global}),"es_2020","es3"),Ls.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},Ls.arrayIterator=function(e){return{next:Ls.arrayIteratorImpl(e)}},Ls.initSymbol=function(){},Ls.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},Ls.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i},Ls.polyfill("Array.prototype.values",(function(e){return e||function(){return Ls.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),Ls.polyfill("Array.prototype.flat",(function(e){return e||function(e){e=void 0===e?1:e;var t=[];return Array.prototype.forEach.call(this,(function(n){Array.isArray(n)&&0<e?(n=Array.prototype.flat.call(n,e-1),t.push.apply(t,n)):t.push(n)})),t}}),"es9","es5"),Ls.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Ls.polyfill("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)Ls.owns(e,t)&&n.push([t,e[t]]);return n}}),"es8","es3"),Ls.polyfill("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)Ls.owns(e,t)&&n.push(e[t]);return n}}),"es8","es3");var Ns=Object.create(null),Ps={typeMap:Ns},Ds=Object.create(null),$s="default",Bs=class{constructor(e){this.name=e}toString(){return this.name}};Bs.CONNECTION_CHECKER=new Bs("connectionChecker"),Bs.CURSOR=new Bs("cursor"),Bs.EVENT=new Bs("event"),Bs.FIELD=new Bs("field"),Bs.INPUT=new Bs("input"),Bs.RENDERER=new Bs("renderer"),Bs.TOOLBOX=new Bs("toolbox"),Bs.THEME=new Bs("theme"),Bs.TOOLBOX_ITEM=new Bs("toolboxItem"),Bs.FLYOUTS_VERTICAL_TOOLBOX=new Bs("flyoutsVerticalToolbox"),Bs.FLYOUTS_HORIZONTAL_TOOLBOX=new Bs("flyoutsHorizontalToolbox"),Bs.METRICS_MANAGER=new Bs("metricsManager"),Bs.BLOCK_DRAGGER=new Bs("blockDragger"),Bs.SERIALIZER=new Bs("serializer"),Bs.ICON=new Bs("icon"),Bs.PASTER=new Bs("paster");var Fs={DEFAULT:$s,TEST_ONLY:Ps};Fs.Type=Bs,Fs.getAllItems=l,Fs.getClass=s,Fs.getClassFromOptions=c,Fs.getObject=a,Fs.hasItem=o,Fs.register=e,Fs.unregister=r;var Us,zs,Hs=Object.create(null),Gs=Object.create(null),Vs=null,Ws=[],js={defineBlocksWithJsonArrayInternal:w},Xs={TEST_ONLY:js};Xs.createBlockDefinitionsFromJsonArray=Os.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Xs.defineBlocks=Os.defineBlocks$$module$build$src$core$common,Xs.defineBlocksWithJsonArray=S,Xs.draggingConnections=Ws,Xs.getAllWorkspaces=h,Xs.getBlockTypeCounts=T,Xs.getMainWorkspace=f,Xs.getParentContainer=_,Xs.getSelected=g,Xs.getWorkspaceById=u,Xs.registerWorkspace=d,Xs.setMainWorkspace=m,Xs.setParentContainer=b,Xs.setSelected=v,Xs.svgResize=y,Xs.unregisterWorkpace=p;var Ys,Ks,qs,Js,Zs,Qs,ea,ta,na,ra,ia,oa,sa,aa,la,ca,ua,ha,da,pa,fa,ma,ga,va,_a,ba,ya="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Ta={genUid:()=>{const e=ya.length,t=[];for(let n=0;20>n;n++)t[n]=ya.charAt(Math.random()*e);return t.join("")}},Ea=0,Sa={TEST_ONLY:Ta};Sa.genUid=M,Sa.getNextUniqueId=x,Ys="",Ks=!0,qs=0,Os.CREATE$$module$build$src$core$events$utils="create",Os.CREATE$$module$build$src$core$events$utils,Os.DELETE$$module$build$src$core$events$utils="delete",Os.DELETE$$module$build$src$core$events$utils,Os.CHANGE$$module$build$src$core$events$utils="change",Os.CHANGE$$module$build$src$core$events$utils,Js="block_field_intermediate_change",Os.MOVE$$module$build$src$core$events$utils="move",Os.MOVE$$module$build$src$core$events$utils,Zs="var_create",Qs="var_delete",ea="var_rename",ta="ui",na="drag",ra="selected",ia="click",oa="marker_move",sa="bubble_open",aa="trashcan_open",la="toolbox_item_select",ca="theme_change",ua="viewport_change",ha="comment_create",da="comment_delete",pa="comment_change",fa="comment_move",ma="finished_loading",ga=[Os.CREATE$$module$build$src$core$events$utils,Os.MOVE$$module$build$src$core$events$utils,ha,fa],_a={FIRE_QUEUE:va=[],fireNow:A,fireInternal:R,setGroupInternal:P},(ba={BLOCK_CHANGE:Os.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:Os.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:Os.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:na,BLOCK_FIELD_INTERMEDIATE_CHANGE:Js,BLOCK_MOVE:Os.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:sa,BUMP_EVENTS:ga,CHANGE:Os.CHANGE$$module$build$src$core$events$utils,CLICK:ia,COMMENT_CHANGE:pa,COMMENT_CREATE:ha,COMMENT_DELETE:da,COMMENT_MOVE:fa,CREATE:Os.CREATE$$module$build$src$core$events$utils,DELETE:Os.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:ma,MARKER_MOVE:oa,MOVE:Os.MOVE$$module$build$src$core$events$utils,SELECTED:ra,TEST_ONLY:_a,THEME_CHANGE:ca,TOOLBOX_ITEM_SELECT:la,TRASHCAN_OPEN:aa,UI:ta,VAR_CREATE:Zs,VAR_DELETE:Qs,VAR_RENAME:ea,VIEWPORT_CHANGE:ua}).clearPendingUndo=O,ba.disable=Os.disable$$module$build$src$core$events$utils,ba.disableOrphans=F,ba.enable=Os.enable$$module$build$src$core$events$utils,ba.filter=L,ba.fire=k,ba.fromJson=$,ba.get=B,ba.getDescendantIds=D,ba.getGroup=Os.getGroup$$module$build$src$core$events$utils,ba.getRecordUndo=I,ba.isEnabled=N,ba.setGroup=Os.setGroup$$module$build$src$core$events$utils,ba.setRecordUndo=C;var wa,xa,Ma=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Os.getGroup$$module$build$src$core$events$utils(),this.recordUndo=I()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,n){return n.isBlank=!1,n.group=e.group||"",n.workspaceId=t.id,n}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=u(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Ca=class extends Ma{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank="undefined"===typeof e,this.workspaceId=e||""}},Ia=class extends Ca{constructor(e,t,n){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=ia,this.blockId=e?e.id:void 0,this.targetType=n}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ia)).targetType=e.targetType,t.blockId=e.blockId,t}};(xa=wa||(wa={})).BLOCK="block",xa.WORKSPACE="workspace",xa.ZOOM_CONTROLS="zoom_controls",e(Bs.EVENT,ia,Ia);var ka={};ka.Click=Ia,ka.ClickTarget=wa;var Ra,Aa,La,Oa,Na,Pa,Da,$a,Ba,Fa,Ua=750,za="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Ha=null,Ga={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Va=0,Wa={TOUCH_ENABLED:za,TOUCH_MAP:Ga};Wa.checkTouchIdentifier=W,Wa.clearTouchIdentifier=H,Wa.getTouchIdentifierFromEvent=V,Wa.longStart=U,Wa.longStop=z,Wa.shouldHandleEvent=G,function(e){function t(e){return-1!==n.indexOf(e.toUpperCase())}const n=(Ra=e).toUpperCase();Aa=t("JavaFX"),La=t("WebKit"),Oa=t("Gecko")&&!La,Na=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Pa=t("iPad")||t("Macintosh")&&0<e,Da=t("iPhone")&&!Pa,$a=t("Macintosh"),Ba=Pa||Na&&!t("Mobile")||t("Silk"),Fa=!Ba&&(Da||Na)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var ja=Aa,Xa=Oa,Ya=Na,Ka=Pa,qa=Da,Ja=$a,Za=Fa,Qa={ANDROID:Ya,GECKO:Xa,IPAD:Ka,IPHONE:qa,JavaFx:ja,MAC:Ja,MOBILE:Za,raw:Ra},el=40,tl=125,nl={};nl.bind=X,nl.conditionalBind=j,nl.getScrollDeltaPixels=Z,nl.isRightButton=q,nl.isTargetInput=K,nl.mouseToSvg=J,nl.unbind=Y;var rl={};rl.removeElem=Q;var il=class{constructor(e){this.name_=e}toString(){return this.name_}};il.POSITIONABLE=new il("positionable"),il.DRAG_TARGET=new il("drag_target"),il.DELETE_AREA=new il("delete_area"),il.AUTOHIDEABLE=new il("autohideable");var ol=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const n=e.component.id;var r;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(r=this.componentData.get(n))?void 0:r.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],r=0;r<e.capabilities.length;r++){const i=String(e.capabilities[r]).toLowerCase();if(t.push(i),this.capabilityToComponentIds.has(i)){let e;null==(e=this.capabilityToComponentIds.get(i))||e.push(n)}else this.capabilityToComponentIds.set(i,[n])}this.componentData.get(n).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let n=0;n<t.capabilities.length;n++){const r=String(t.capabilities[n]).toLowerCase();Q(this.capabilityToComponentIds.get(r),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var n,r;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t="".concat(t).toLowerCase(),null==(n=this.componentData.get(e))||n.capabilities.push(t),null==(r=this.capabilityToComponentIds.get(t))||r.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t="".concat(t).toLowerCase(),Q(this.componentData.get(e).capabilities,t),Q(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t="".concat(t).toLowerCase(),this.componentData.has(e)&&-1!==this.componentData.get(e).capabilities.indexOf(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e="".concat(e).toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const n=[];if(t){const t=[];e.forEach((e=>{t.push(this.componentData.get(e))})),t.sort((function(e,t){return e.weight-t.weight})),t.forEach((function(e){n.push(e.component)}))}else e.forEach((e=>{n.push(this.componentData.get(e).component)}));return n}};ol.Capability=il;var sl=!1,al='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n',ll={};ll.inject=te,ll.register=ee;var cl=class{constructor(e,t){this.x=e,this.y=t}clone(){return new cl(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const n=e.x-t.x;return e=e.y-t.y,Math.sqrt(n*n+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new cl(e.x-t.x,e.y-t.y)}static sum(e,t){return new cl(e.x+t.x,e.y+t.y)}},ul={};ul.warn=ne;var hl,dl="http://www.w3.org/2000/svg",pl="http://www.w3.org/1999/xhtml",fl="http://www.w3.org/1999/xlink";!function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"}(hl||(hl={}));var ml=null,gl=0,vl=null,_l={HTML_NS:pl};_l.NodeType=hl,_l.SVG_NS=dl,_l.XLINK_NS=fl,_l.addClass=ie,_l.containsNode=ue,_l.createSvgElement=re,_l.getFastTextWidth=me,_l.getFastTextWidthWithSizeString=ge,_l.getTextWidth=fe,_l.hasClass=ae,_l.insertAfter=ce,_l.measureFontMetrics=ve,_l.removeClass=se,_l.removeClasses=oe,_l.removeNode=le,_l.setCssTransform=he,_l.startTextWidthCache=de,_l.stopTextWidthCache=pe;var bl=class{constructor(e){this.tagName=e}toString(){return this.tagName}};bl.ANIMATE=new bl("animate"),bl.CIRCLE=new bl("circle"),bl.CLIPPATH=new bl("clipPath"),bl.DEFS=new bl("defs"),bl.FECOMPOSITE=new bl("feComposite"),bl.FECOMPONENTTRANSFER=new bl("feComponentTransfer"),bl.FEFLOOD=new bl("feFlood"),bl.FEFUNCA=new bl("feFuncA"),bl.FEGAUSSIANBLUR=new bl("feGaussianBlur"),bl.FEPOINTLIGHT=new bl("fePointLight"),bl.FESPECULARLIGHTING=new bl("feSpecularLighting"),bl.FILTER=new bl("filter"),bl.FOREIGNOBJECT=new bl("foreignObject"),bl.G=new bl("g"),bl.IMAGE=new bl("image"),bl.LINE=new bl("line"),bl.PATH=new bl("path"),bl.PATTERN=new bl("pattern"),bl.POLYGON=new bl("polygon"),bl.RECT=new bl("rect"),bl.SVG=new bl("svg"),bl.TEXT=new bl("text"),bl.TSPAN=new bl("tspan");var yl=class{constructor(e,t,n,r){this.top=e,this.bottom=t,this.left=n,this.right=r}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},Tl=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}},El={getSizeInternal:be},Sl={TEST_ONLY:El};Sl.getBorderBox=we,Sl.getComputedStyle=Te,Sl.getContainerOffsetToScrollInto=Me,Sl.getPageOffset=Ee,Sl.getSize=_e,Sl.getViewportPageOffset=Se,Sl.scrollIntoContainerView=xe;var wl=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,xl=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Ml={TEST_ONLY:{XY_REGEX:wl,XY_STYLE_REGEX:xl}};Ml.getDocumentScroll=Re,Ml.getInjectionDivXY=Ie,Ml.getRelativeXY=Ce,Ml.getViewportBBox=ke,Ml.screenToWsCoordinates=Ae,Ml.wsToScreenCoordinates=Le;var Cl=class{constructor(e,t,n,r,i){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new cl(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new cl(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=n||!1,this.margin=void 0!==i?i:Cl.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),r&&(e+=" "+r),this.outerSvg=re(bl.SVG,{class:e}),r=re(bl.G,{},this.outerSvg),this.svgBackground=re(bl.RECT,{class:"blocklyScrollbarBackground"},r),e=Math.floor((Cl.scrollbarThickness-5)/2),this.svgHandle=re(bl.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},r),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),ce(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=j(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=j(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Cl.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),Y(this.onMouseDownBarWrapper_),Y(this.onMouseDownHandleWrapper_),le(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,he(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){(e||(e=this.workspace.getMetrics()))&&(this.oldHostMetrics&&Cl.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics()))}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Cl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Cl.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Cl.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var n=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Cl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Cl.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var n=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),H(),this.cleanUp(),q(e))e.stopPropagation();else{var t=J(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var n=Ie(this.svgHandle);n=this.horizontal?n.x:n.y;var r=this.handlePosition,i=.95*this.handleLength;t<=n?r-=i:t>=n+this.handleLength&&(r+=i),this.setHandlePosition(this.constrainHandlePosition(r)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),q(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=j(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=j(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){H(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(Y(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(Y(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new cl(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Cl.scrollbarThickness=za?25:15,Cl.DEFAULT_SCROLLBAR_MARGIN=.5;var Il={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},kl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Rl,DOMParser:Al,XMLSerializer:Ll}=globalThis;Al&&(Il=new Al),Ll&&(kl=new Ll);var Ol="https://developers.google.com/blockly/xml",Nl=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Pl={NAME_SPACE:Ol};Pl.createElement=Os.createElement$$module$build$src$core$utils$xml,Pl.createTextNode=Os.createTextNode$$module$build$src$core$utils$xml,Pl.domToText=Ne,Pl.injectDependencies=Oe,Pl.textToDom=Os.textToDom$$module$build$src$core$utils$xml;var Dl,$l="categoryToolbox",Bl="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Dl||(Dl={}));var Fl,Ul,zl,Hl={hasCategoriesInternal:Ue},Gl={};Gl.Position=Dl,Gl.TEST_ONLY=Hl,Gl.convertFlyoutDefToJsonArray=Be,Gl.convertToolboxDefToJson=De,Gl.hasCategories=Fe,Gl.isCategoryCollapsible=ze,Gl.parseToolboxTree=We,function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(Fl||(Fl={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(Ul||(Ul={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(zl||(zl={}));var Vl={};Vl.bumpDirection=zl,Vl.bumpPositionRect=Ye,Vl.getCornerOppositeToolbox=Xe,Vl.getStartPositionRect=je,Vl.horizontalPosition=Ul,Vl.verticalPosition=Fl;var Wl={width:96,height:124,url:"sprites.png"},jl=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=re(bl.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[ol.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&le(this.svgGroup);for(const e of this.boundEvents)Y(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new yl(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var n,r=Xe(this.workspace,e),i=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(i+=this.LARGE_SPACING+this.HEIGHT),e=je(r,new Tl(this.WIDTH,i),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=Ye(e,this.MARGIN_VERTICAL,r===Fl.TOP?zl.DOWN:zl.UP,t),r===Fl.TOP){var o,s=this.SMALL_SPACING+this.HEIGHT;null==(o=this.zoomInGroup)||o.setAttribute("transform","translate(0, "+s+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(s+this.LARGE_SPACING+this.HEIGHT)+")")}else{let e;o=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(e=this.zoomInGroup)||e.setAttribute("transform","translate(0, "+o+")"),o=o+this.SMALL_SPACING+this.HEIGHT,null==(s=this.zoomOutGroup)||s.setAttribute("transform","translate(0, "+o+")")}this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=re(bl.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=re(bl.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);re(bl.RECT,{width:32,height:32},t),re(bl.IMAGE,{width:Wl.width,height:Wl.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=re(bl.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=re(bl.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);re(bl.RECT,{width:32,height:32},t),re(bl.IMAGE,{width:Wl.width,height:Wl.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),H(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=re(bl.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=re(bl.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);re(bl.RECT,{width:32,height:32},t),re(bl.IMAGE,{width:Wl.width,height:Wl.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),H(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(B(ia))(null,this.workspace.id,"zoom_controls");k(e)}};ee("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var Xl=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Xl.MUTATOR=new Xl("mutator"),Xl.WARNING=new Xl("warning"),Xl.COMMENT=new Xl("comment"),function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(Os.inputTypes$$module$build$src$core$inputs$input_types||(Os.inputTypes$$module$build$src$core$inputs$input_types={})),Os.inputTypes$$module$build$src$core$inputs$input_types;var Yl,Kl,ql=function(e,t){window.alert(e),t&&t()},Jl=function(e,t){t(window.confirm(e))},Zl=function(e,t,n){n(window.prompt(e,t))},Ql={confirmInternal:Ze},ec={TEST_ONLY:Ql};ec.alert=Ke,ec.confirm=Je,ec.prompt=et,ec.setAlert=qe,ec.setConfirm=Qe,ec.setPrompt=tt,Os.Msg$$module$build$src$core$msg=Object.create(null),Yl=function(e){Object.keys(e).forEach((function(t){Os.Msg$$module$build$src$core$msg[t]=e[t]}))},Kl={Msg:Os.Msg$$module$build$src$core$msg,setLocale:Yl};var tc={};tc.isLegacyProcedureCallBlock=it,tc.isLegacyProcedureDefBlock=rt;var nc=class extends Ma{constructor(e){super(),this.isBlank="undefined"===typeof e,e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new nc)).varId=e.varId,t}},rc=class extends nc{constructor(e){super(e),this.type=Zs,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new rc)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};e(Bs.EVENT,Zs,rc);var ic=class{constructor(e,t,n,r){this.workspace=e,this.name=t,this.type=n||"",this.id_=r||M()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},oc="VARIABLE",sc="ijkmnopqrstuvwxyzabcdefgh",ac={generateUniqueNameInternal:lt},lc={CATEGORY_NAME:oc,TEST_ONLY:ac,VAR_LETTER_OPTIONS:sc};lc.allDeveloperVariables=Os.allDeveloperVariables$$module$build$src$core$variables,lc.allUsedVarModels=Os.allUsedVarModels$$module$build$src$core$variables,lc.createVariableButtonHandler=ut,lc.flyoutCategory=ot,lc.flyoutCategoryBlocks=st,lc.generateUniqueName=at,lc.generateUniqueNameFromOptions=ct,lc.generateVariableFieldDom=vt,lc.getAddedVariables=bt,lc.getOrCreateVariablePackage=Os.getOrCreateVariablePackage$$module$build$src$core$variables,lc.getVariable=Os.getVariable$$module$build$src$core$variables,lc.nameUsedWithAnyType=pt,lc.nameUsedWithConflictingParam=ft,lc.promptName=ht,lc.renameVariable=Os.renameVariable$$module$build$src$core$variables;var cc=class{constructor(e,t,n,r,i){this.workspace=e,this.editable=this.movable=this.deletable=!0,this.disposed_=!1,this.isComment=!0,this.id=i&&!e.getCommentById(i)?i:M(),e.addTopComment(this),this.xy_=new cl(0,0),this.height_=n,this.width_=r,this.RTL=e.RTL,this.content_=t,cc.fireCreateEvent(this)}dispose(){this.disposed_||(N()&&k(new(B(da))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getRelativeToSurfaceXY(){return new cl(this.xy_.x,this.xy_.y)}moveBy(e,t){const n=new(B(fa))(this);this.xy_.translate(e,t),n.recordNew(),k(n)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable=e}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(k(new(B(pa))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return(e=this.toXml(e)).setAttribute("x",String(Math.round(this.xy_.x))),e.setAttribute("y",String(Math.round(this.xy_.y))),e.setAttribute("h",String(this.height_)),e.setAttribute("w",String(this.width_)),e}toXml(e){const t=Os.createElement$$module$build$src$core$utils$xml("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(N()){const t=Os.getGroup$$module$build$src$core$events$utils();t||Os.setGroup$$module$build$src$core$events$utils(!0);try{k(new(B(ha))(e))}finally{Os.setGroup$$module$build$src$core$events$utils(t)}}}static fromXml(e,t){var n=cc.parseAttributes(e);return t=new cc(t,n.content,n.h,n.w,n.id),n=e.getAttribute("x"),e=e.getAttribute("y"),n=n?parseInt(n,10):NaN,e=e?parseInt(e,10):NaN,isNaN(n)||isNaN(e)||t.moveBy(n,e),cc.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),n=e.getAttribute("w"),r=e.getAttribute("x"),i=e.getAttribute("y"),o=e.getAttribute("id");if(!o)throw Error("No ID present in XML comment definition.");let s;return{id:o,h:t?parseInt(t):100,w:n?parseInt(n):100,x:r?parseInt(r):NaN,y:i?parseInt(i):NaN,content:null!=(s=e.textContent)?s:""}}},uc=class extends Ca{constructor(e,t,n){super(n),this.type=ra,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new uc)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};e(Bs.EVENT,ra,uc);var hc={};hc.register=yt,hc.unregister=Tt;var dc=class{paste(e,t,n){const r=e.commentState;if(n)r.setAttribute("x","".concat(n.x)),r.setAttribute("y","".concat(n.y));else{var i;let e;n=parseInt(null!=(i=r.getAttribute("x"))?i:"0")+50,i=parseInt(null!=(e=r.getAttribute("y"))?e:"0")+50,r.setAttribute("x","".concat(n)),r.setAttribute("y","".concat(i))}return gc.fromXmlRendered(e.commentState,t)}};dc.TYPE="workspace-comment",yt(dc.TYPE,new dc);var pc=8,fc=3,mc=2,gc=class extends cc{constructor(e,t,n,r,i){super(e,t,n,r,i),this.onMouseMoveWrapper=this.onMouseUpWrapper=null,this.eventsInit=!1,this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=this.svgHandleTarget=this.svgRectTarget=this.textarea=null,this.rendered=this.autoLayout=this.focused=!1,this.svgGroup=re(bl.G,{class:"blocklyComment"}),this.workspace=e,this.svgRect_=re(bl.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:fc,ry:fc}),this.svgGroup.appendChild(this.svgRect_),this.render()}dispose(){this.disposed_||(g()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),N()&&k(new(B(da))(this)),le(this.svgGroup),Os.disable$$module$build$src$core$events$utils(),super.dispose(),Os.enable$$module$build$src$core$events$utils())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit||(j(this.svgRectTarget,"pointerdown",this,this.pathMouseDown),j(this.svgHandleTarget,"pointerdown",this,this.pathMouseDown)),this.eventsInit=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea&&this.textarea.select()}pathMouseDown(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(g()!==this){var e=null;if(g()){e=g().id,Os.disable$$module$build$src$core$events$utils();try{g().unselect()}finally{Os.enable$$module$build$src$core$events$utils()}}e=new(B(ra))(e,this.id,this.workspace.id),k(e),v(this),this.addSelect()}}unselect(){if(g()===this){var e=new(B(ra))(this.id,null,this.workspace.id);k(e),v(null),this.removeSelect(),this.blurFocus()}}addSelect(){ie(this.svgGroup,"blocklySelected"),this.setFocus()}removeSelect(){ie(this.svgGroup,"blocklySelected"),this.blurFocus()}addFocus(){ie(this.svgGroup,"blocklyFocused")}removeFocus(){se(this.svgGroup,"blocklyFocused")}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,r=this.getSvgRoot();if(r)do{const e=Ce(r);t+=e.x,n+=e.y,r=r.parentNode}while(r&&!e.hasLayer(r)&&null!==r);return this.xy_=new cl(t,n)}moveBy(e,t){const n=new(B(fa))(this),r=this.getRelativeToSurfaceXY();this.translate(r.x+e,r.y+t),this.xy_=new cl(r.x+e,r.y+t),n.recordNew(),k(n),this.workspace.resizeContents()}translate(e,t){this.xy_=new cl(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveDuringDrag(e){e="translate(".concat(e.x,", ").concat(e.y,")"),this.getSvgRoot().setAttribute("transform",e)}moveTo(e,t){this.translate(e,t)}clearTransformAttributes(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),n=e.y,r=e.y+t.height;let i;return this.RTL?(i=e.x-t.width,e=e.x):(i=e.x,e=e.x+t.width),new yl(n,r,i,e)}updateMovable(){this.isMovable()?ie(this.svgGroup,"blocklyDraggable"):se(this.svgGroup,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea&&(this.textarea.readOnly=!e)}setDragging(e){e?ie(this.getSvgRoot(),"blocklyDragging"):se(this.getSvgRoot(),"blocklyDragging")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(e){super.setContent(e),this.textarea&&(this.textarea.value=e)}setDeleteStyle(e){e?ie(this.svgGroup,"blocklyDraggingDelete"):se(this.svgGroup,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const n=this.getRelativeToSurfaceXY();return e.setAttribute("x",String(Math.round(this.workspace.RTL?t-n.x:n.x))),e.setAttribute("y",String(Math.round(n.y))),e.setAttribute("h",String(this.getHeight())),e.setAttribute("w",String(this.getWidth())),e}toCopyData(){return{paster:dc.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered){var e=this.getHeightWidth(),t=this.createEditor();this.svgGroup.appendChild(t),this.svgHandleTarget=re(bl.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup.appendChild(this.svgHandleTarget),this.svgRectTarget=re(bl.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:fc,ry:fc}),this.svgGroup.appendChild(this.svgRectTarget),this.addResizeDom(),this.isDeletable()&&this.addDeleteDom(),this.setSize(e.width,e.height),this.textarea.value=this.content_,this.rendered=!0,this.resizeGroup&&j(this.resizeGroup,"pointerdown",this,this.resizeMouseDown),this.isDeletable()&&(j(this.deleteGroup,"pointerdown",this,this.deleteMouseDown),j(this.deleteGroup,"pointerout",this,this.deleteMouseOut),j(this.deleteGroup,"pointerup",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=re(bl.FOREIGNOBJECT,{x:0,y:gc.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(pl,"body");e.setAttribute("xmlns",pl),e.className="blocklyMinimalBody";const t=document.createElementNS(pl,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea=t,this.foreignObject.appendChild(e),j(t,"wheel",this,(function(e){e.stopPropagation()})),j(t,"change",this,(function(e){this.setContent(t.value)})),this.foreignObject}addResizeDom(){this.resizeGroup=re(bl.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup),re(bl.POLYGON,{points:"0,".concat(pc," ").concat(pc,",").concat(pc," ").concat(pc,",0")},this.resizeGroup),re(bl.LINE,{class:"blocklyResizeLine",x1:pc/3,y1:pc-1,x2:pc-1,y2:pc/3},this.resizeGroup),re(bl.LINE,{class:"blocklyResizeLine",x1:2*pc/3,y1:pc-1,x2:pc-1,y2:2*pc/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=re(bl.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup),this.deleteIconBorder=re(bl.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup),re(bl.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup),re(bl.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup)}resizeMouseDown(e){this.unbindDragEvents(),q(e)||(this.workspace.startDrag(e,new cl(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=j(document,"pointerup",this,this.resizeMouseUp),this.onMouseMoveWrapper=j(document,"pointermove",this,this.resizeMouseMove),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown(e){this.deleteIconBorder&&ie(this.deleteIconBorder,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut(e){this.deleteIconBorder&&se(this.deleteIconBorder,"blocklyDeleteIconHighlighted")}deleteMouseUp(e){this.dispose(),e.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(Y(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onMouseMoveWrapper&&(Y(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)}resizeMouseUp(e){H(),this.unbindDragEvents()}resizeMouseMove(e){this.autoLayout=!1,e=this.workspace.moveDrag(e),this.setSize(this.RTL?-e.x:e.x,e.y)}resizeComment(){const e=this.getHeightWidth(),t=gc.TOP_OFFSET,n=2*mc;let r,i;if(null==(r=this.foreignObject)||r.setAttribute("width",String(e.width)),null==(i=this.foreignObject)||i.setAttribute("height",String(e.height-t)),this.RTL){let t;null==(t=this.foreignObject)||t.setAttribute("x",String(-e.width))}this.textarea&&(this.textarea.style.width=e.width-n+"px",this.textarea.style.height=e.height-n-t+"px")}setSize(e,t){let n,r,i,o;if(e=Math.max(e,45),t=Math.max(t,20+gc.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width","".concat(e)),this.svgRect_.setAttribute("height","".concat(t)),null==(n=this.svgRectTarget)||n.setAttribute("width","".concat(e)),null==(r=this.svgRectTarget)||r.setAttribute("height","".concat(t)),null==(i=this.svgHandleTarget)||i.setAttribute("width","".concat(e)),null==(o=this.svgHandleTarget)||o.setAttribute("height",String(gc.TOP_OFFSET)),this.RTL){let e;this.svgRect_.setAttribute("transform","scale(-1 1)"),null==(e=this.svgRectTarget)||e.setAttribute("transform","scale(-1 1)")}if(this.resizeGroup)if(this.RTL){let n;this.resizeGroup.setAttribute("transform","translate("+(-e+pc)+","+(t-pc)+") scale(-1 1)"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(-e+pc)+","+-pc+") scale(-1 1)")}else{let n;this.resizeGroup.setAttribute("transform","translate("+(e-pc)+","+(t-pc)+")"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(e-pc)+","+-pc+")")}this.resizeComment()}setFocus(){this.focused=!0,setTimeout((()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&ie(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&ie(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}blurFocus(){this.focused=!1,setTimeout((()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&se(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&se(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}static fromXmlRendered(e,t,n){let r;Os.disable$$module$build$src$core$events$utils();try{const i=cc.parseAttributes(e);if(r=new gc(t,i.content,i.h,i.w,i.id),t.rendered&&(r.initSvg(!0),r.render()),!isNaN(i.x)&&!isNaN(i.y))if(t.RTL){const e=n||t.getWidth();r.moveBy(e-i.x,i.y)}else r.moveBy(i.x,i.y)}finally{Os.enable$$module$build$src$core$events$utils()}return cc.fireCreateEvent(r),r}};gc.DEFAULT_SIZE=100,gc.TOP_OFFSET=10,ee("\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n");var vc=new Set,_c=new WeakSet,bc=null,yc=null,Tc=0,Ec={};Ec.finishQueuedRenders=St,Ec.queueRender=Et,Ec.triggerQueuedRenders=wt;var Sc={};Sc.appendDomToWorkspace=zt,Sc.blockToDom=Dt,Sc.blockToDomWithXY=Ot,Sc.clearWorkspaceAndLoadFromXml=Ut,Sc.deleteNext=en,Sc.domToBlock=Os.domToBlock$$module$build$src$core$xml,Sc.domToBlockInternal=Ht,Sc.domToPrettyText=Ft,Sc.domToText=Bt,Sc.domToVariables=Gt,Sc.domToWorkspace=Os.domToWorkspace$$module$build$src$core$xml,Sc.variablesToDom=Lt,Sc.workspaceToDom=At;var wc=class extends Error{},xc=class extends wc{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Mc=class extends wc{constructor(e,t,n){super("The block ".concat(t.toDevString()," is missing a(n) ").concat(e,"\nconnection")),this.block=t,this.state=n}},Cc=class extends wc{constructor(e,t,n,r){super("The block ".concat(n.toDevString()," could not connect its\n").concat(t," to its parent, because: ").concat(e)),this.childBlock=n,this.childState=r}},Ic=class extends wc{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},kc=class extends wc{constructor(e,t,n){super("Cannot add an icon of type '".concat(e,"' to the block ")+"".concat(t.toDevString(),", because there is no icon registered with ")+"type '".concat(e,"'. Make sure that all of your icons have been ")+"registered."),this.block=t,this.state=n}},Rc={};Rc.BadConnectionCheck=Cc,Rc.DeserializationError=wc,Rc.MissingBlockType=xc,Rc.MissingConnection=Mc,Rc.RealChildOfShadow=Ic,Rc.UnregisteredIcon=kc;var Ac=100,Lc=75,Oc=50,Nc={BLOCKS:Oc,PROCEDURES:Lc,VARIABLES:Ac},Pc={};Pc.register=rn,Pc.unregister=on;var Dc=class{constructor(){this.priority=Oc}save(e){const t=[];for(const n of e.getTopBlocks(!1))(e=sn(n,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const n of e)mn(n,t,{recordUndo:I()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};rn("blocks",new Dc);var $c={};$c.BlockSerializer=Dc,$c.append=mn,$c.appendInternal=gn,$c.save=sn;var Bc=class extends Ma{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Bc)).blockId=e.blockId,t}},Fc=class extends Bc{constructor(e){super(e),this.type=Os.CREATE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Ot(e),this.ids=D(e),this.json=sn(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bt(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Fc)).xml=Os.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!Uc(t,this.ids))if(e)mn(this.json,t);else for(e=0;e<this.ids.length;e++){const n=this.ids[e],r=t.getBlockById(n);r?r.dispose(!1):n===this.blockId&&console.warn("Can't uncreate non-existent block: "+n)}}},Uc=function(e,t){return t.map((t=>e.getBlockById(t))).filter((e=>e&&e.isShadow())).length===t.length};e(Bs.EVENT,Os.CREATE$$module$build$src$core$events$utils,Fc);var zc=class extends Ca{constructor(e,t){super(t),this.type=ca,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new zc)).themeName=e.themeName,t}};e(Bs.EVENT,ca,zc);var Hc,Gc,Vc=class extends Ca{constructor(e,t,n,r,i){super(r),this.type=ua,this.viewTop=e,this.viewLeft=t,this.scale=n,this.oldScale=i}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Vc)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};e(Bs.EVENT,ua,Vc),Hc=28,Os.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Hc,connectingSnapRadius:Hc,currentConnectionPreference:8,bumpDelay:250},Os.config$$module$build$src$core$config,function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"}(Gc||(Gc={}));var Wc=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const n=this.calculateIndexForYPos(t);if(n>=this.connections.length)return-1;t=e.y;let r=n;for(;0<=r&&this.connections[r].y===t;){if(this.connections[r]===e)return r;r--}for(r=n;r<this.connections.length&&this.connections[r].y===t;){if(this.connections[r]===e)return r;r++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,n=this.connections.length;for(;t<n;){const r=Math.floor((t+n)/2);if(this.connections[r].y<e)t=r+1;else{if(!(this.connections[r].y>e)){t=r;break}n=r}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function n(e){const n=i-r[e].x,s=o-r[e].y;return Math.sqrt(n*n+s*s)<=t&&l.push(r[e]),s<t}const r=this.connections,i=e.x,o=e.y;e=0;let s=r.length-2,a=s;for(;e<a;)r[a].y<o?e=a:s=a,a=Math.floor((e+s)/2);const l=[];if(s=e=a,r.length){for(;0<=e&&n(e);)e--;do{s++}while(s<r.length&&n(s))}return l}isInYRange(e,t,n){return Math.abs(this.connections[e].y-t)<=n}searchForClosest(e,t,n){if(!this.connections.length)return{connection:null,radius:t};const r=e.y,i=e.x;e.x=i+n.x,e.y=r+n.y;var o=this.calculateIndexForYPos(e.y);n=null;let s,a=t,l=o-1;for(;0<=l&&this.isInYRange(l,e.y,t);)s=this.connections[l],this.connectionChecker.canConnect(e,s,!0,a)&&(n=s,a=s.distanceFrom(e)),l--;for(;o<this.connections.length&&this.isInYRange(o,e.y,t);)s=this.connections[o],this.connectionChecker.canConnect(e,s,!0,a)&&(n=s,a=s.distanceFrom(e)),o++;return e.x=i,e.y=r,{connection:n,radius:a}}static init(e){const t=[];return t[Gc.INPUT_VALUE]=new Wc(e),t[Gc.OUTPUT_VALUE]=new Wc(e),t[Gc.NEXT_STATEMENT]=new Wc(e),t[Gc.PREVIOUS_STATEMENT]=new Wc(e),t}},jc=class{paste(e,t,n){if(!t.isCapacityAvailable(e.typeCounts))return null;let r;n&&(e.blockState.x=n.x,e.blockState.y=n.y),Os.disable$$module$build$src$core$events$utils();try{r=mn(e.blockState,t),In(r)}finally{Os.enable$$module$build$src$core$events$utils()}return r?(N()&&!r.isShadow()&&k(new(B(Os.CREATE$$module$build$src$core$events$utils))(r)),r.select(),r):r}};jc.TYPE="block",yt(jc.TYPE,new jc);var Xc={};Xc.BlockPaster=jc,Xc.moveBlockToNotConflict=In;var Yc=null,Kc=null,qc={duplicateInternal:Dn,copyInternal:Ln},Jc={};Jc.BlockPaster=jc,Jc.TEST_ONLY=qc,Jc.copy=An,Jc.duplicate=Pn,Jc.paste=On,Jc.registry=hc;var Zc,Qc,eu="aria-",tu="role";(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(Zc||(Zc={})),function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"}(Qc||(Qc={}));var nu={};nu.Role=Zc,nu.State=Qc,nu.setRole=$n,nu.setState=Bn;var ru,iu=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&$n(t,this.roleName),this.element=t;for(let n,r=0;n=this.menuItems[r];r++)t.appendChild(n.createDom());return this.mouseOverHandler=j(t,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=j(t,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=j(t,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=j(t,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=j(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:!0}),ie(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),se(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(Y(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(Y(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(Y(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(Y(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(Y(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e,t=0;e=this.menuItems[t];t++)e.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem"))for(let t,n=0;t=this.menuItems[n];n++)if(t.getElement()===e)return t;e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement(),xe(e.getElement(),t),Bn(t,Qc.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let n;for(e+=t;n=this.menuItems[e];){if(n.isEnabled()){this.setHighlighted(n);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&"number"===typeof e.clientX){const n=new cl(e.clientX,e.clientY);if(1>cl.distance(t,n))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=_e(e);return t.height=e.scrollHeight,t}},ou=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=x(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var n=document.createElement("div");n.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(n)}return n=this.content,"string"===typeof this.content&&(n=document.createTextNode(this.content)),t.appendChild(n),e.appendChild(t),this.roleName&&$n(e,this.roleName),Bn(e,Qc.SELECTED,this.checkable&&this.checked||!1),Bn(e,Qc.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(ie(t,"blocklyMenuItemHighlight"),ie(t,"goog-menuitem-highlight")):(se(t,"blocklyMenuItemHighlight"),se(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},su=null,au=null,lu="blocklyWidgetDiv",cu="",uu="",hu={};hu.createDom=zn,hu.getDiv=Fn,hu.hide=Gn,hu.hideIfOwner=Wn,hu.isVisible=Vn,hu.positionWithAnchor=Xn,hu.repositionForWindowResize=Jn,hu.show=Hn,hu.testOnly_setDiv=Un;var du=null,pu={},fu=null,mu={};mu.callbackFactory=Os.callbackFactory$$module$build$src$core$contextmenu,mu.commentDeleteOption=ar,mu.commentDuplicateOption=lr,mu.dispose=sr,mu.getCurrentBlock=Zn,mu.hide=or,mu.setCurrentBlock=Qn,mu.show=er,mu.workspaceCommentOption=cr;var gu=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return null!=(t=this.registry_.get(e))?t:null}getContextMenuOptions(e,t){const n=[];for(const i of this.registry_.values())if(e===i.scopeType){var r=i.preconditionFn(t);"hidden"!==r&&(r={text:"function"===typeof i.displayText?i.displayText(t):i.displayText,enabled:"enabled"===r,callback:i.callback,scope:t,weight:i.weight},n.push(r))}return n.sort((function(e,t){return e.weight-t.weight})),n}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e}(gu||(gu={}));var vu=gu.ScopeType,_u={};_u.ContextMenuRegistry=gu,_u.ScopeType=vu;var bu={};bu.clamp=dr,bu.toDegrees=hr,bu.toRadians=ur;var yu,Tu,Eu,Su=16,wu=1,xu=12,Mu=16,Cu=.25,Iu=null,ku=null,Ru="",Au="",Lu=null,Ou=null,Nu=null,Pu={getBoundsInfo:function(){const e=Ee(Lu),t=_e(Lu);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,n,r){const i=Pu.getBoundsInfo(),o=_e(yu);return t+o.height<i.bottom?xr(e,t,i,o):r-o.height>i.top?Mr(n,r,i,o):t+o.height<document.documentElement.clientHeight?xr(e,t,i,o):r-o.height>document.documentElement.clientTop?Mr(n,r,i,o):Cr(e,i,o)}},Du={ANIMATION_TIME:Cu,ARROW_HORIZONTAL_PADDING:xu,ARROW_SIZE:Su,BORDER_SIZE:wu,PADDING_Y:Mu,TEST_ONLY:Pu};Du.clearContent=vr,Du.createDom=pr,Du.getContentDiv=gr,Du.getOwner=mr,Du.getPositionX=Ir,Du.hide=Ar,Du.hideIfOwner=Rr,Du.hideWithoutAnimation=Lr,Du.isVisible=kr,Du.repositionForWindowResize=Nr,Du.setBoundsElement=fr,Du.setColour=_r,Du.show=wr,Du.showPositionedByBlock=br,Du.showPositionedByField=yr;var $u=null,Bu=null,Fu={};Fu.connectionUiEffect=$r,Fu.disconnectUiEffect=Br,Fu.disconnectUiStop=Ur,Fu.disposeUiEffect=Pr;var Uu=50,zu=100,Hu=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){let e;Os.getGroup$$module$build$src$core$events$utils()||Os.setGroup$$module$build$src$core$events$utils(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=cl.sum(this.startXY_,t),this.bubble.moveDuringDrag(t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return!(!e||!this.workspace.getComponentManager().hasCapability(e.id,ol.Capability.DELETE_AREA))&&e.wouldDelete(this.bubble,!1)}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){if(this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=cl.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_)this.fireMoveEvent_(),this.bubble.dispose();else{if(this.bubble.setDragging){let e;this.bubble.setDragging(!1),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,zu)}this.fireMoveEvent_()}this.workspace.setResizesEnabled(!0),Os.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof gc){const e=new(B(fa))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),k(e)}}pixelsToWorkspaceUnits_(e){return e=new cl(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},Gu=30,Vu=!0,Wu=[];Wu[Gc.INPUT_VALUE]=Gc.OUTPUT_VALUE,Wu[Gc.OUTPUT_VALUE]=Gc.INPUT_VALUE,Wu[Gc.NEXT_STATEMENT]=Gc.PREVIOUS_STATEMENT,Wu[Gc.PREVIOUS_STATEMENT]=Gc.NEXT_STATEMENT;var ju="RENAME_VARIABLE_ID",Xu="DELETE_VARIABLE_ID",Yu={};Yu.commonWordPrefix=Gr,Yu.commonWordSuffix=Vr,Yu.isNumber=Os.isNumber$$module$build$src$core$utils$string,Yu.shortestStringLength=Hr,Yu.startsWith=zr,Yu.wrap=Os.wrap$$module$build$src$core$utils$string;var Ku=void 0,qu=!1,Ju=!1,Zu=50,Qu=0,eh=0,th=0,nh=0,rh=null,ih=null,oh=0,sh=10,ah=10,lh=750,ch=5,uh=null,hh={HOVER_MS:lh,LIMIT:Zu,MARGINS:ch,OFFSET_X:oh,OFFSET_Y:sh,RADIUS_OK:ah};hh.bindMouseEvents=ni,hh.block=ci,hh.createDom=ti,hh.dispose=ai,hh.getCustomTooltip=qr,hh.getDiv=Zr,hh.getTooltipOfObject=Qr,hh.hide=li,hh.isVisible=Jr,hh.setCustomTooltip=Kr,hh.unbindMouseEvents=ri,hh.unblock=ui;var dh=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new cl(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){g()&&g().unselect()}endDrag(e){this.drag(e)}drag(e){if(e=cl.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},ph=5,fh=6,mh=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new cl(0,0),this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new cl(0,0),this.healStack=!Vu}dispose(){H(),ui(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.blockDragger&&this.blockDragger.dispose(),this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new cl(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(),z()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=cl.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=cl.magnitude(this.currentDragDeltaXY)>(this.flyout?Os.config$$module$build$src$core$config.flyoutDragRadius:Os.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY))&&(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Os.getGroup$$module$build$src$core$events$utils()||Os.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),!0)}updateIsDraggingBubble(){return!!this.startBubble&&(this.startDraggingBubble(),!0)}updateIsDraggingBlock(){if(!this.targetBlock)return!1;if(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger=new dh(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new(c(Bs.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_),this.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack),this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger=new Hu(this.startBubble,this.startWorkspace_),this.bubbleDragger.startBubbleDrag(),this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,K(e)?this.cancel():(this.gestureHasStarted=!0,Ur(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=mr(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,ci(),this.targetBlock&&this.targetBlock.select(),q(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&U(e,this),this.mouseDownXY=new cl(e.clientX,e.clientY),this.healStack=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(j(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(j(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(j(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&z())}handleMove(e){this.isDragging()&&G(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),z())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!G(e))return;if(this.updateFromEvent(e),z(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.bubbleDragger?this.bubbleDragger.endBubbleDrag(e,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(e,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=V(e);this.cachedPoints.set(t,this.getTouchPoint(e));var n=Array.from(this.cachedPoints.keys());2===n.length&&(t=this.cachedPoints.get(n[0]),n=this.cachedPoints.get(n[1]),this.startDistance=cl.distance(t,n),this.isMultiTouch_=!0,e.preventDefault())}handleTouchMove(e){const t=V(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):this.handleMove(e)}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),n=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),n=cl.distance(n,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=0<(t=n-this.previousScale)?t*ph:t*fh,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const r=this.startWorkspace_,i=J(e,r.getParentSvg(),r.getInverseScreenCTM());r.zoom(i.x,i.y,t)}this.previousScale=n,e.preventDefault()}handleTouchEnd(e){e=V(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new cl(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(z(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.doStart(e)}fireWorkspaceClick(e){k(new(B(ia))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}doBubbleClick(){this.startBubble instanceof gc&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock.isEnabled()&&(Os.getGroup$$module$build$src$core$events$utils()||Os.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new(B(ia))(this.startBlock,this.startWorkspace_.id,"block");k(e)}this.bringBlockToFront(),Os.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){e=this.creatorWorkspace,g()&&g().unselect(),this.fireWorkspaceClick(this.startWorkspace_||e)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):this.targetBlock=e}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.blockDragger)?e:this.workspaceDragger)?t:this.bubbleDragger}static inProgress(){const e=h();for(let t,n=0;t=e[n];n++)if(t.currentGesture_)return!0;return!1}},gh=class{constructor(e,t){let n,r,i;this.pattern=e,this.spacing=null!=(n=t.spacing)?n:0,this.length=null!=(r=t.length)?r:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(i=t.snap)&&i}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){var t=this.spacing*e;this.pattern.setAttribute("width","".concat(t)),this.pattern.setAttribute("height","".concat(t));let n=(t=Math.floor(this.spacing/2)+.5)-this.length/2,r=t+this.length/2;t*=e,n*=e,r*=e,this.setLineAttributes(this.line1,e,n,r,t,t),this.setLineAttributes(this.line2,e,t,t,n,r)}setLineAttributes(e,t,n,r,i,o){e&&(e.setAttribute("stroke-width","".concat(t)),e.setAttribute("x1","".concat(n)),e.setAttribute("y1","".concat(i)),e.setAttribute("x2","".concat(r)),e.setAttribute("y2","".concat(o)))}moveTo(e,t){this.pattern.setAttribute("x","".concat(e)),this.pattern.setAttribute("y","".concat(t))}static createDom(e,t,n){let r,i;if(e=re(bl.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},n),0<(null!=(r=t.length)?r:1)&&0<(null!=(i=t.spacing)?i:0)){let n;re(bl.LINE,{stroke:t.colour},e),null!=(n=t.length)&&n&&re(bl.LINE,{stroke:t.colour},e)}else re(bl.LINE,{},e);return e}},vh=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t,n=0;t=e[n];n++)this.unregisterMarker(t);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};vh.LOCAL_MARKER="local_marker_1";var _h={};_h.deepMerge=mi;var bh=class{constructor(t,n,r,i){this.name=t,this.startHats=!1,this.blockStyles=n||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=i||Object.create(null),this.fontStyle=Object.create(null),e(Bs.THEME,t,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"===typeof e){const t=this.getComponentStyle(e);if(t)return t}return"".concat(e)}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const n=new bh(e);let r=t.base;if(r){if("string"===typeof r){let e;r=null!=(e=a(Bs.THEME,r))?e:void 0}r instanceof bh&&(mi(n,r),n.name=e)}return mi(n.blockStyles,t.blockStyles),mi(n.categoryStyles,t.categoryStyles),mi(n.componentStyles,t.componentStyles),mi(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}},yh=new bh("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Th=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,n=!1;var r=!1,i=!1,o=!1,s=!1,a=!1;const l=!!e.readOnly;var c;l||(t=De(null!=(c=e.toolbox)?c:null),n=Fe(t),r=void 0===(r=e.trashcan)?n:r,i=void 0===(i=e.collapse)?n:i,o=void 0===(o=e.comments)?n:o,s=void 0===(s=e.disable)?n:s,a=void 0===(a=e.sounds)||a),c=e.maxTrashcanContents,r?void 0===c&&(c=32):c=0;const u=!!e.rtl;let h=e.horizontalLayout;void 0===h&&(h=!1);var d="end"!==e.toolboxPosition;d=h?d?Dl.TOP:Dl.BOTTOM:d===u?Dl.RIGHT:Dl.LEFT;let p=e.css;void 0===p&&(p=!0);let f="https://blockly-demo.appspot.com/static/media/";e.media?f=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(ne("path","Nov 2014","Jul 2023","media"),f=e.path+"media/");const m=e.oneBasedIndex,g=e.renderer||"geras",v=e.plugins||{};let _,b,y,T=e.modalInputs;void 0===T&&(T=!0),this.RTL=u,this.oneBasedIndex=void 0===m||m,this.collapse=i,this.comments=o,this.disable=s,this.readOnly=l,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(_=e.maxInstances)?_:null,this.modalInputs=T,this.pathToMedia=f,this.hasCategories=n,this.moveOptions=Th.parseMoveOptions_(e,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=r,this.maxTrashcanContents=c,this.hasSounds=a,this.hasCss=p,this.horizontalLayout=h,this.languageTree=t,this.gridOptions=Th.parseGridOptions_(e),this.zoomOptions=Th.parseZoomOptions_(e),this.toolboxPosition=d,this.theme=Th.parseThemeOptions_(e),this.renderer=g,this.rendererOverrides=null!=(b=e.rendererOverrides)?b:null,this.parentWorkspace=null!=(y=e.parentWorkspace)?y:null,this.plugins=v}static parseMoveOptions_(e,t){const n=e.move||{},r={};return void 0===n.scrollbars&&void 0===e.scrollbars?r.scrollbars=t:"object"===typeof n.scrollbars?(r.scrollbars={horizontal:!!n.scrollbars.horizontal,vertical:!!n.scrollbars.vertical},r.scrollbars.horizontal&&r.scrollbars.vertical?r.scrollbars=!0:r.scrollbars.horizontal||r.scrollbars.vertical||(r.scrollbars=!1)):r.scrollbars=!!n.scrollbars||!!e.scrollbars,r.wheel=r.scrollbars&&void 0!==n.wheel?!!n.wheel:"object"===typeof r.scrollbars,r.drag=!!r.scrollbars&&(void 0===n.drag||!!n.drag),r}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return"string"===typeof(e=e.theme||yh)?a(Bs.THEME,e):e instanceof bh?e:bh.defineTheme(e.name||"builtin"+x(),e)}},Eh=class extends Bc{constructor(e,t,n,r,i){super(e),this.type=Os.CHANGE$$module$build$src$core$events$utils,e&&(this.element=t,this.name=n||void 0,this.oldValue=r,this.newValue=i)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Eh)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getIcon(Xl.MUTATOR);switch(n&&gi(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":n=Eh.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(Os.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),k(new Eh(t,"mutation",null,n,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Bt(e):""}};e(Bs.EVENT,Os.CHANGE$$module$build$src$core$events$utils,Eh);var Sh=.45,wh=.65,xh={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Mh={};Mh.blend=xi,Mh.getHsvSaturation=vi,Mh.getHsvValue=bi,Mh.hexToRgb=Si,Mh.hsvToHex=wi,Mh.hueToHex=Mi,Mh.names=xh,Mh.parse=Ti,Mh.rgbToHex=Ei,Mh.setHsvSaturation=_i,Mh.setHsvValue=yi;var Ch={};Ch.checkMessageReferences=Ri,Ch.parseBlockColour=Ai,Ch.replaceMessageReferences=ki,Ch.tokenizeInterpolation=Ii;var Ih=class{constructor(e,t,n){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Tl(0,0),e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(ki(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=re(bl.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=re(bl.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=re(bl.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");ni(e),this.mouseDownWrapper_=j(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(Ih))?e:this.getValue()}loadState(e){this.loadLegacyState(Ih,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=Os.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Ne(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(Os.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;Rr(this),Wn(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||le(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ie(e,"blocklyEditableText"),se(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(ie(e,"blocklyNonEditableText"),se(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Ih.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error("The border rectangle is ".concat(this.borderRect_,"."));return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error("The text element is ".concat(this.textElement_,"."));return this.textElement_}getTextContent(){if(!this.textContent_)throw Error("The text content is ".concat(this.textContent_,"."));return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let n=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),r=t.FIELD_TEXT_HEIGHT,i=0;this.textElement_&&(i=me(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),n+=i),this.isFullBlockField()||(r=Math.max(r,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=r,this.size_.width=n,this.positionTextElement_(e,i),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,r=this.getConstants(),i=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?i:i-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Tl(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new kh;if(this.isFullBlockField()){var n=this.sourceBlock_.getHeightWidth();const r=t.workspace.scale;e=this.getAbsoluteXY_(),t=(n.width+1)*r,n=(n.height+1)*r,Xa?(e.x+=1.5*r,e.y+=1.5*r):(e.x-=.5*r,e.y-=.5*r)}else n=this.borderRect_.getBoundingClientRect(),e=Ee(this.borderRect_),t=n.width,n=n.height;return new yl(e.y,e.y+n,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,Ih.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e):Ih.NBSP}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),this.sourceBlock_.bumpNeighbours())}setValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==e){var n,r=this.doClassValidation_(e);(e=this.processValidation_(e,r))instanceof Error||(r=null==(n=this.getValidator())?void 0:n.call(this,e),(n=this.processValidation_(e,r))instanceof Error||(e=this.sourceBlock_)&&e.disposed||((r=this.getValue())===n?this.doValueUpdate_(n):(this.doValueUpdate_(n),t&&e&&N()&&k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(e,"field",this.name||null,r,n)),this.isDirty_&&this.forceRerender())))}}processValidation_(e,t){return null===t?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null===e||void 0===e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return Qr(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Ee(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new kh;const n=t.inputList;for(let r=0;r<t.inputList.length;r++){const t=n[r],i=t.fieldRow;for(let n=0;n<i.length;n++)if(i[n]===this){e=t;break}}return e}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(e){return!1}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new kh;(e=e.workspace).keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(vh.LOCAL_MARKER).draw()}};Ih.NBSP="\xa0",Ih.SKIP_SETUP=Symbol("SKIP_SETUP");var kh=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Rh={};Rh.Field=Ih,Rh.UnattachedFieldError=kh,Os.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=Os.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),Os.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let n=e;t===Os.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(n=e),e=n.toLowerCase();const r=t===Os.NameType$$module$build$src$core$names.VARIABLE||t===Os.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const i=this.db.get(t);return i.has(e)?r+i.get(e):(t=this.getDistinctName(n,t),i.set(e,t.substr(r.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let n,r,i,o=null;for(;this.dbReverse.has(e+(null!=(n=o)?n:""))||this.reservedWords.has(e+(null!=(r=o)?r:""));)o=o?o+1:2;return e+=null!=(i=o)?i:"",this.dbReverse.add(e),(t===Os.NameType$$module$build$src$core$names.VARIABLE||t===Os.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!=="0123456789".indexOf(e[0])&&(e="my_"+e)):e=Os.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(Os.Names$$module$build$src$core$names||(Os.Names$$module$build$src$core$names={})),Os.NameType$$module$build$src$core$names=Os.Names$$module$build$src$core$names.NameType,Os.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=Os.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:Os.NameType$$module$build$src$core$names}.Names=Os.Names$$module$build$src$core$names;var Ah=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),Oi(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))?(Oi(t)&&t.stopPublishing(),e):e}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Lh=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new cl(0,0),this.workspaceLocation=new cl(0,0),this.svgRoot=null,this.tooltip=e}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=re(bl.G,{class:"blocklyIconGroup"}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),j(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,ni(this.svgRoot)}}dispose(){ri(this.svgRoot),le(this.svgRoot)}getWeight(){return-1}getSize(){return new Tl(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",gi(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform","translate(".concat(this.offsetInBlock.x,", ").concat(this.offsetInBlock.y,")"))}onLocationChange(e){this.workspaceLocation=cl.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}setVisible(e){ne("setVisible","v10","v11","setBubbleVisible"),gi(this)&&this.setBubbleVisible(e)}},Oh={fromJsonInternal:Di},Nh={TEST_ONLY:Oh};Nh.fromJson=Os.fromJson$$module$build$src$core$field_registry,Nh.register=Ni,Nh.unregister=Pi;var Ph=class extends Ih{constructor(e,t,n){super(Ih.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==Ih.SKIP_SETUP&&(Array.isArray(e)?(Fi(e),e=$i(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],n&&this.configure_(n),this.setValue(this.selectedOption[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Ph,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=re(bl.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ie(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=re(bl.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?Ph.ARROW_CHAR+" ":" "+Ph.ARROW_CHAR)),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=re(bl.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(fl,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new kh;this.dropdownCreate(),this.menu_.openingCoords=e&&"number"===typeof e.clientX?new cl(e.clientX,e.clientY):null,vr(),e=this.menu_.render(gr()),ie(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),_r(t,this.sourceBlock_.style.colourTertiary)),yr(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),xe(this.selectedMenuItem.getElement(),gr(),!0)),this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new kh;const t=new iu;t.setRole(Zc.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let i=0;i<n.length;i++){const[o,s]=n[i];if("object"===typeof o){var r=new Image(o.width,o.height);r.src=o.src,r.alt=o.alt||""}else r=o;(r=new ou(r,s)).setRole(Zc.OPTION),r.setRightToLeft(e.RTL),r.setCheckable(!0),t.addChild(r),r.setChecked(s===this.value_),s===this.value_&&(this.selectedMenuItem=r),r.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Rr(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"===typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),Fi(this.generatedOptions)),this.generatedOptions)}doClassValidation_(e){return this.getOptions(!0).some((t=>t[1]===e))?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t,n=0;t=e[n];n++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=e.colourSecondary:this.arrow.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];e&&"object"===typeof e?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new kh;this.imageElement.style.display="",this.imageElement.setAttributeNS(fl,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const n=Number(e.height);e=Number(e.width);var r=!!this.borderRect_;const i=Math.max(r?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+Dh);let o;r=r?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,o=this.svgArrow?this.positionSVGArrow(e+r,i/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):me(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+o+2*r,this.size_.height=i;let s=0;t.RTL?this.imageElement.setAttribute("x","".concat(r+o)):(s=e+o,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x","".concat(r))),this.imageElement.setAttribute("y",String(i/2-n/2)),this.positionTextElement_(s+r,e+o)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ie(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const n=me(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let r=0;this.svgArrow&&(r=this.positionSVGArrow(n+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=n+r+2*t,this.size_.height=e,this.positionTextElement_(t,n)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new kh;const r=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(n.RTL?r:e+i)+","+t+")"),o+i}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];return"object"===typeof e?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};Ph.CHECKMARK_OVERHANG=25,Ph.MAX_MENU_HEIGHT_VH=.45,Ph.ARROW_CHAR="\u25be";var Dh=10;Ni("field_dropdown",Ph);var $h,Bh=class{constructor(e,t,n){this.workspace=e,this.anchor=t,this.ownerRect=n,this.size=new Tl(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.svgRoot=re(bl.G,{},e.getBubbleCanvas()),e=re(bl.G,{filter:"url(#".concat(this.workspace.getRenderer().getConstants().embossFilterId,")")},this.svgRoot),this.tail=re(bl.PATH,{},e),this.background=re(bl.RECT,{class:"blocklyDraggable",x:0,y:0,rx:$h.BORDER_WIDTH,ry:$h.BORDER_WIDTH},e),this.contentContainer=re(bl.G,{},this.svgRoot),j(this.background,"pointerdown",this,this.onMouseDown)}dispose(){le(this.svgRoot),this.disposed=!0}setAnchorLocation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.width=Math.max(e.width,$h.MIN_SIZE),e.height=Math.max(e.height,$h.MIN_SIZE),this.size=e,this.background.setAttribute("width","".concat(e.width)),this.background.setAttribute("height","".concat(e.height)),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform","translate(".concat(e,", ").concat(t,")"))}positionByRect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yl(0,0,0,0);var t=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(t),r=this.getOptimalRelativeTop(t);const i={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},o={x:-this.size.width-30,y:r};r={x:e.getWidth(),y:r};var s={x:n,y:e.getHeight()};n=e.getWidth()<e.getHeight()?r:s,e=e.getWidth()<e.getHeight()?s:r,r=this.getOverlap(i,t),s=this.getOverlap(o,t);const a=this.getOverlap(n,t);t=this.getOverlap(e,t),r===(t=Math.max(r,s,a,t))?(this.relativeLeft=i.x,this.relativeTop=i.y):s===t?(this.relativeLeft=o.x,this.relativeTop=o.y):a===t?(this.relativeLeft=n.x,this.relativeTop=n.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var n=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(n+this.size.width,t.left+t.width)-Math.max(n,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var n=this.anchor.x-t;n-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):n>e.right&&(t=-(e.right-this.anchor.x))}else{const r=(n=t+this.anchor.x)+this.size.width;n<e.left?t=e.left-this.anchor.x:r>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const n=this.anchor.y+t,r=n+this.size.height;return n<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:r>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let n=e.top+e.height,r=e.left;return e=e.left+e.width,n-=this.getScrollbarThickness(),this.workspace.RTL?r-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new yl(t,n,r,e)}getScrollbarThickness(){return Cl.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,n=this.size.height/2,r=-this.relativeLeft,i=-this.relativeTop;if(t===r&&n===i)e.push("M "+t+","+n);else{i-=n,r-=t,this.workspace.RTL&&(r*=-1);var o=Math.sqrt(i*i+r*r),s=Math.acos(r/o);0>i&&(s=2*Math.PI-s);var a=s+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a);const c=Math.cos(a);let u=(this.size.width+this.size.height)/$h.TAIL_THICKNESS;u=Math.min(u,this.size.width,this.size.height)/4,r=t+(a=1-$h.ANCHOR_RADIUS/o)*r,i=n+a*i,a=t+u*c;const h=n+u*l;t-=u*c,n-=u*l,(l=s+(l=ur(this.workspace.RTL?-$h.TAIL_ANGLE:$h.TAIL_ANGLE)))>2*Math.PI&&(l-=2*Math.PI),s=Math.sin(l)*o/$h.TAIL_BEND,o=Math.cos(l)*o/$h.TAIL_BEND,e.push("M"+a+","+h),e.push("C"+(a+o)+","+(h+s)+" "+r+","+i+" "+r+","+i),e.push("C"+r+","+i+" "+(t+o)+","+(n+s)+" "+t+","+n)}let c;e.push("z"),null==(c=this.tail)||c.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==t?void 0:t.lastChild)===this.svgRoot)&&(null==t||t.appendChild(this.svgRoot),!0)}getRelativeToSurfaceXY(){return new cl(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}};$h=Bh,Bh.BORDER_WIDTH=6,Bh.DOUBLE_BORDER=2*$h.BORDER_WIDTH,Bh.MIN_SIZE=$h.DOUBLE_BORDER,Bh.TAIL_THICKNESS=1,Bh.TAIL_ANGLE=20,Bh.TAIL_BEND=4,Bh.ANCHOR_RADIUS=8;var Fh,Uh,zh=class extends Bh{constructor(e,t,n,r){let i,o;super(t,n,r),this.workspace=t,this.anchor=n,this.ownerRect=r,this.autoLayout=!0,t=new Th(e),this.validateWorkspaceOptions(t),this.svgDialog=re(bl.SVG,{x:Bh.BORDER_WIDTH,y:Bh.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Th(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(bl.G),this.miniWorkspace.getCanvas()),null==(e=this.miniWorkspace.getFlyout())||e.init(this.miniWorkspace),null==e||e.show(t.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(i=this.miniWorkspace.getFlyout())||null==(o=i.getWorkspace())||o.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let n=-20;const r=this.miniWorkspace.getFlyout();r&&(n-=r.getWidth()),t.x>n&&e.moveBy(n-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<zh.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<zh.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width","".concat(t.width,"px")),this.svgDialog.setAttribute("height","".concat(t.height,"px")),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform","translate(".concat(t.width,", 0)")),this.setSize(new Tl(t.width+Bh.DOUBLE_BORDER,t.height+Bh.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+zh.MARGIN;e=e.height+zh.MARGIN;const n=this.miniWorkspace.getFlyout();if(n){const r=n.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,r.height+20),t+=n.getWidth()}return new Tl(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const n of e.getAllBlocks(!1))n.setStyle(n.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};zh.MINIMUM_VIEW_CHANGE=10,zh.MARGIN=3*Bh.DOUBLE_BORDER,Fh=17,Uh=16,Os.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Lh{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),re(bl.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),re(bl.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),re(bl.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),ie(this.svgRoot,"blockly-icon-mutator"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Tl(Fh,Fh)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.style.colourPrimary),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e){let e;this.miniWorkspaceBubble=new zh(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour(),this.createRootBlock(),this.addSaveConnectionsListener(),null==(e=this.miniWorkspaceBubble)||e.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let e;null==(e=this.miniWorkspaceBubble)||e.dispose(),this.miniWorkspaceBubble=null,this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener),this.saveConnectionsListener=null}k(new(B(sa))(this.sourceBlock,e,"mutator"))}}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map((e=>({kind:"block",type:e})))}),t}getAnchorLocation(){const e=Fh/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,n,r,i;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(i=null==(t=this.miniWorkspaceBubble)||null==(n=t.getWorkspace())||null==(r=n.getFlyout())?void 0:r.getWidth())?i:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+Uh):Uh,Uh)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout((()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()}),0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||e.type===Os.CREATE$$module$build$src$core$events$utils||e.type===Os.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=Os.getGroup$$module$build$src$core$events$utils();e||Os.setGroup$$module$build$src$core$events$utils(!0);var t=Eh.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var n=Eh.getExtraBlockState_(this.sourceBlock);t!==n&&k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,t,n)),Os.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}static reconnect(e,t,n){return ne("MutatorIcon.reconnect","v10","v11","connection.reconnect"),!!e&&e.reconnect(t,n)}static findParentWs(e){return ne("MutatorIcon.findParentWs","v10","v11","workspace.getRootWorkspace"),e.getRootWorkspace()}},Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Xl.MUTATOR,Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,Os.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Hh=Object.create(null),Gh={allExtensions:Hh};Os.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Qi);var Vh,Wh={TEST_ONLY:Gh};Wh.apply=Hi,Wh.buildTooltipForDropdown=Os.buildTooltipForDropdown$$module$build$src$core$extensions,Wh.buildTooltipWithFieldText=Os.buildTooltipWithFieldText$$module$build$src$core$extensions,Wh.isRegistered=zi,Wh.register=Os.register$$module$build$src$core$extensions,Wh.registerMixin=Os.registerMixin$$module$build$src$core$extensions,Wh.registerMutator=Os.registerMutator$$module$build$src$core$extensions,Wh.runAfterPageLoad=Ji,Wh.unregister=Ui,function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"}(Vh||(Vh={}));var jh={};jh.arc=ao,jh.curve=to,jh.line=oo,jh.lineOnAxis=so,jh.lineTo=io,jh.moveBy=ro,jh.moveTo=no,jh.point=eo;var Xh={};Xh.Coordinate=cl,Xh.KeyCodes=Vh,Xh.Rect=yl,Xh.Size=Tl,Xh.Svg=bl,Xh.aria=nu,Xh.array=rl,Xh.browserEvents=nl,Xh.colour=Mh,Xh.deprecation=ul,Xh.dom=_l,Xh.extensions=Wh,Xh.idGenerator=Sa,Xh.math=bu,Xh.object=_h,Xh.parsing=Ch,Xh.string=Yu,Xh.style=Sl,Xh.svgMath=Ml,Xh.svgPaths=jh,Xh.toolbox=Gl,Xh.userAgent=Qa,Xh.xml=Pl;var Yh={};Yh.register=lo,Yh.unregister=co;var Kh=class extends Bh{constructor(e,t,n,r){super(t,n,r),this.text=e,this.workspace=t,this.anchor=n,this.ownerRect=r,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(e){this.text=e,le(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createSpans(t,e),this.workspace.RTL&&this.rightAlignSpans(t.getBBox().width,e),t}createParagraph(e){return re(bl.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Bh.BORDER_WIDTH},e)}createSpans(e,t){return t.split("\n").map((t=>{const n=re(bl.TSPAN,{dy:"1em",x:Bh.BORDER_WIDTH},e);return t=document.createTextNode(t),n.appendChild(t),n}))}rightAlignSpans(e,t){for(const n of t)n.setAttribute("text-anchor","end"),n.setAttribute("x","".concat(e+Bh.BORDER_WIDTH))}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Tl(e.width+2*Bh.BORDER_WIDTH,e.height+2*Bh.BORDER_WIDTH),!0)}},qh=class extends Bh{constructor(e,t,n){super(e,t,n),this.workspace=e,this.anchor=t,this.ownerRect=n,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Tl(160+Bh.DOUBLE_BORDER,80+Bh.DOUBLE_BORDER),this.MIN_SIZE=new Tl(45+Bh.DOUBLE_BORDER,20+Bh.DOUBLE_BORDER),({inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer)),this.resizeGroup=this.createResizeHandle(this.svgRoot),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}createEditor(e){e=re(bl.FOREIGNOBJECT,{x:Bh.BORDER_WIDTH,y:Bh.BORDER_WIDTH},e);const t=document.createElementNS(pl,"body");t.setAttribute("xmlns",pl),t.className="blocklyMinimalBody";const n=document.createElementNS(pl,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),t.appendChild(n),e.appendChild(t),this.bindTextAreaEvents(n),setTimeout((()=>{n.focus()}),0),{inputRoot:e,textArea:n}}bindTextAreaEvents(e){j(e,"wheel",this,(e=>{e.stopPropagation()})),j(e,"focus",this,this.onStartEdit,!0),j(e,"change",this,this.onTextChange)}createResizeHandle(e){e=re(bl.G,{class:this.workspace.RTL?"blocklyResizeSW":"blocklyResizeSE"},e);const t=2*Bh.BORDER_WIDTH;return re(bl.POLYGON,{points:"0,".concat(t," ").concat(t,",").concat(t," ").concat(t,",0")},e),re(bl.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},e),re(bl.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},e),j(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const n=e.width-Bh.DOUBLE_BORDER,r=e.height-Bh.DOUBLE_BORDER;this.inputRoot.setAttribute("width","".concat(n)),this.inputRoot.setAttribute("height","".concat(r)),this.textArea.style.width="".concat(n-4,"px"),this.textArea.style.height="".concat(r-4,"px"),this.workspace.RTL?this.resizeGroup.setAttribute("transform","translate(".concat(Bh.DOUBLE_BORDER,", ").concat(r,") scale(-1 1)")):this.resizeGroup.setAttribute("transform","translate(".concat(n,", ").concat(r,")")),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(e){this.bringToFront(),q(e)||(this.workspace.startDrag(e,new cl(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=j(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=j(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){H(),this.resizePointerUpListener&&(Y(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Y(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=this.workspace.moveDrag(e),this.setSize(new Tl(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}};ee("\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n");var Jh=17,Zh=160,Qh=80,ed=class extends Lh{constructor(e){super(e),this.sourceBlock=e,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Tl(Zh,Qh),this.bubbleVisiblity=!1}getType(){return ed.TYPE}initView(e){this.svgRoot||(super.initView(e),re(bl.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),re(bl.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),re(bl.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),ie(this.svgRoot,"blockly-icon-comment"))}dispose(){let e,t;super.dispose(),null==(e=this.textInputBubble)||e.dispose(),null==(t=this.textBubble)||t.dispose()}getWeight(){return ed.WEIGHT}getSize(){return new Tl(Jh,Jh)}applyColour(){super.applyColour();const e=this.sourceBlock.style.colourPrimary;let t,n;null==(t=this.textInputBubble)||t.setColour(e),null==(n=this.textBubble)||n.setColour(e)}updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(e){let t,n;super.onLocationChange(e),e=this.getAnchorLocation(),null==(t=this.textInputBubble)||t.setAnchorLocation(e),null==(n=this.textBubble)||n.setAnchorLocation(e)}setText(e){const t=this.text;let n,r;k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(n=this.textInputBubble)||n.setText(this.text),null==(r=this.textBubble)||r.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){let t,n,r,i;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new Tl(null!=(n=e.width)?n:Zh,null!=(r=e.height)?r:Qh),this.bubbleVisiblity=null!=(i=e.pinned)&&i,setTimeout((()=>this.setBubbleVisible(this.bubbleVisiblity)),1)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){e&&(this.textBubble||this.textInputBubble)||(e||this.textBubble||this.textInputBubble)&&(this.bubbleVisiblity=e,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),k(new(B(sa))(this.sourceBlock,e,"comment"))))}showEditableBubble(){this.textInputBubble=new qh(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener((()=>this.onTextChange())),this.textInputBubble.addSizeChangeListener((()=>this.onSizeChange()))}showNonEditableBubble(){this.textBubble=new Kh(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let e,t;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null,null==(t=this.textBubble)||t.dispose(),this.textBubble=null}getAnchorLocation(){const e=Jh/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}};ed.TYPE=Xl.COMMENT,ed.WEIGHT=3,lo(ed.TYPE,ed);var td=17,nd=class extends Lh{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return nd.TYPE}initView(e){this.svgRoot||(super.initView(e),re(bl.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),re(bl.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),re(bl.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),ie(this.svgRoot,"blockly-icon-warning"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return nd.WEIGHT}getSize(){return new Tl(td,td)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let n;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(n=this.textBubble)||n.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e)this.textBubble=new Kh(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let e;null==(e=this.textBubble)||e.dispose(),this.textBubble=null}k(new(B(sa))(this.sourceBlock,e,"warning"))}}getAnchorLocation(){const e=td/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}};nd.TYPE=Xl.WARNING,nd.WEIGHT=2;var rd=class extends Error{constructor(e){super("Tried to append an icon of type ".concat(e.getType()," when an icon of ")+"that type already exists on the block. Use getIcon to access the existing icon."),this.icon=e}},id={};id.DuplicateIconType=rd;var od,sd,ad={};ad.CommentIcon=ed,ad.Icon=Lh,ad.IconType=Xl,ad.MutatorIcon=Os.MutatorIcon$$module$build$src$core$icons$mutator_icon,ad.WarningIcon=nd,ad.exceptions=id,ad.registry=Yh,od="PROCEDURE",Os.DEFAULT_ARG$$module$build$src$core$procedures="x",(sd={CATEGORY_NAME:od,DEFAULT_ARG:Os.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Ah,sd.allProcedures=uo,sd.findLegalName=Os.findLegalName$$module$build$src$core$procedures,sd.flyoutCategory=mo,sd.getCallers=bo,sd.getDefinition=Os.getDefinition$$module$build$src$core$procedures,sd.isNameUsed=fo,sd.isProcedureBlock=Li,sd.mutateCallers=Os.mutateCallers$$module$build$src$core$procedures,sd.mutatorOpenListener=vo,sd.rename=Os.rename$$module$build$src$core$procedures;var ld=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},cd=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=ld.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},ud=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=ld.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(ld.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(ld.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(ld.isSpacer(t))return t}return null}},hd=class extends ud{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=ld.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let r=0;r<this.elements.length;r++){const i=this.elements[r];t+=i.width,ld.isSpacer(i)||(ld.isNextConnection(i)?n=Math.max(n,i.height):e=Math.max(e,i.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},dd=class extends cd{constructor(e,t){super(e),this.connectionModel=t,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=ld.CONNECTION}},pd=class extends dd{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=ld.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},fd=class extends pd{constructor(e,t){super(e,t),this.height=0,this.type|=ld.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},md=class extends cd{constructor(e,t,n){super(e),this.field=t,this.parentInput=n,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=ld.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},gd=class extends cd{constructor(e){super(e),this.type|=ld.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},vd=class extends cd{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.isVisible=gi(t)&&t.bubbleIsVisible(),this.type|=ld.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},_d=class extends cd{constructor(e,t){super(e),this.type=this.type|ld.SPACER|ld.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},bd=class extends pd{constructor(e,t){super(e,t),this.type|=ld.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},yd=class extends pd{constructor(e,t){super(e,t),this.type|=ld.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Td=class extends ud{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=ld.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const n=this.elements[t];this.width+=n.width,ld.isInput(n)&&n instanceof pd&&(ld.isStatementInput(n)&&n instanceof yd?e+=n.connectedBlockWidth:ld.isExternalInput(n)&&n instanceof fd&&0!==n.connectedBlockWidth&&(e+=n.connectedBlockWidth-n.connectionWidth)),ld.isSpacer(n)||(this.height=Math.max(this.height,n.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Ed=class extends cd{constructor(e){super(e),this.type|=ld.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Sd=class extends dd{constructor(e,t){super(e,t),this.type|=ld.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},wd=class extends dd{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=ld.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},xd=class extends dd{constructor(e,t){super(e,t),this.type|=ld.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Md=class extends cd{constructor(e,t){super(e),this.type=(t&&"left"!==t?ld.RIGHT_ROUND_CORNER:ld.LEFT_ROUND_CORNER)|ld.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Cd=class extends ud{constructor(e,t,n){super(e),this.height=t,this.width=n,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|ld.SPACER|ld.BETWEEN_ROW_SPACER,this.elements=[new _d(this.constants_,n)]}measure(){}},Id=class extends cd{constructor(e,t){super(e),this.type=(t&&"left"!==t?ld.RIGHT_SQUARE_CORNER:ld.LEFT_SQUARE_CORNER)|ld.CORNER,this.width=this.height=this.constants_.NO_PADDING}},kd=class extends ud{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=ld.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,n=e.getPreviousBlock();return!!e.outputConnection||t||!!n&&n.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let r=0;r<this.elements.length;r++){const i=this.elements[r];t+=i.width,ld.isSpacer(i)||(ld.isHat(i)&&i instanceof gd?n=Math.max(n,i.ascenderHeight):e=Math.max(e,i.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Rd=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=ro(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const n in t)this.blockStyles[n]=this.validatedBlockStyle_(t[n]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=ve("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&0===e.indexOf("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=Ai(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?Ai(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?Ai(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return xi("#fff",e,.6)||e}generateTertiaryColour_(e){return xi("#fff",e,.3)||e}dispose(){this.embossFilter&&le(this.embossFilter),this.disabledPattern&&le(this.disabledPattern),this.debugFilter&&le(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:oo([eo(t,e/4),eo(2*-t,e/2),eo(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:to("c",[eo(30,-e),eo(70,-e),eo(t,0)])}}makePuzzleTab(){function e(e){const r=-(e=e?-1:1);var i=n/2;const o=i+2.5,s=i+.5,a=eo(-t,e*i);return i=eo(t,e*i),to("c",[eo(0,e*o),eo(-t,r*s),a])+to("s",[eo(t,2.5*r),i])}const t=this.TAB_WIDTH,n=this.TAB_HEIGHT,r=e(!0),i=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:n,pathDown:i,pathUp:r}}makeNotch(){function e(e){return oo([eo(e*r,n),eo(3*e,0),eo(e*r,-n)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,r=(t-3)/2,i=e(1),o=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:i,pathRight:o}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:ao("a","0 0,0",e,eo(-e,e)),pathBottom:ao("a","0 0,0",e,eo(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=ro(0,e)+ao("a","0 0,1",e,eo(e,-e)),n=ao("a","0 0,1",e,eo(e,e)),r=ao("a","0 0,1",e,eo(-e,-e));return{topLeft:t,topRight:n,bottomRight:ao("a","0 0,1",e,eo(-e,e)),bottomLeft:r,rightHeight:e}}shapeFor(e){switch(e.type){case Gc.INPUT_VALUE:case Gc.OUTPUT_VALUE:return this.PUZZLE_TAB;case Gc.PREVIOUS_STATEMENT:case Gc.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,n){this.injectCSS_(t,n),this.defs=re(bl.DEFS,{},e),e=re(bl.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),re(bl.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=re(bl.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),re(bl.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),re(bl.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),re(bl.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=re(bl.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),re(bl.RECT,{width:10,height:10,fill:"#aaa"},e),re(bl.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const e=re(bl.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=re(bl.FECOMPONENTTRANSFER,{result:"outBlur"},e);re(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(bl.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),re(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const n=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=n:((t=document.createElement("style")).id=e,e=document.createTextNode(n),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return["".concat(e," .blocklyText, "),"".concat(e," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ")+"".concat(this.FIELD_TEXT_FONTSIZE,"pt ").concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e," .blocklyText {"),"fill: #fff;","}","".concat(e," .blocklyNonEditableText>rect,"),"".concat(e," .blocklyEditableText>rect {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"fill-opacity: .6;","stroke: none;","}","".concat(e," .blocklyNonEditableText>text,"),"".concat(e," .blocklyEditableText>text {"),"fill: #000;","}","".concat(e," .blocklyFlyoutLabelText {"),"fill: #000;","}","".concat(e," .blocklyText.blocklyBubbleText {"),"fill: #000;","}","".concat(e," .blocklyEditableText:not(.editing):hover>rect {"),"stroke: #fff;","stroke-width: 2;","}","".concat(e," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"}","".concat(e," .blocklySelected>.blocklyPath {"),"stroke: #fc3;","stroke-width: 3px;","}","".concat(e," .blocklyHighlightedConnectionPath {"),"stroke: #fc3;","}","".concat(e," .blocklyReplaceable .blocklyPath {"),"fill-opacity: .5;","}","".concat(e," .blocklyReplaceable .blocklyPathLight,"),"".concat(e," .blocklyReplaceable .blocklyPathDark {"),"display: none;","}","".concat(e," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"]}},Ad={};Ad.ConstantProvider=Rd,Ad.isDynamicShape=To;var Ld=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}hideHiddenIcons_(){ne("hideHiddenIcons_","v10","v11")}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=ro(e.xPos,this.info_.startY);for(let n,r=0;n=t[r];r++)ld.isLeftRoundedCorner(n)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:ld.isRightRoundedCorner(n)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:ld.isPreviousConnection(n)&&n instanceof dd?this.outlinePath_+=n.shape.pathLeft:ld.isHat(n)?this.outlinePath_+=this.constants_.START_HAT.path:ld.isSpacer(n)&&(this.outlinePath_+=so("h",n.width));this.outlinePath_+=so("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+so("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const n=To(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=so("H",t.xPos+t.width)+n+so("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var n=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+so("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var r=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=so("H",n)+t+so("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+so("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=so("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let n=0,r="";for(let i,o=t.length-1;i=t[o];o--)ld.isNextConnection(i)&&i instanceof dd?r+=i.shape.pathRight:ld.isLeftSquareCorner(i)?r+=so("H",e.xPos):ld.isLeftRoundedCorner(i)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:ld.isRightRoundedCorner(i)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):ld.isSpacer(i)&&(r+=so("h",-1*i.width));this.outlinePath_+=so("V",e.baseline-n),this.outlinePath_+=r}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=To(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=so("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e,t=0;e=this.info_.rows[t];t++)for(let n,r=0;n=e.elements[r];r++)ld.isInlineInput(n)?this.drawInlineInput_(n):(ld.isIcon(n)||ld.isField(n))&&this.layoutField_(n)}layoutField_(e){const t=e.centerline-e.height/2;let n=e.xPos;var r="";this.info_.RTL&&(n=-(n+e.width),e.flipRtl&&(n+=e.width,r="scale(-1 1)")),ld.isIcon(e)?((r=e.icon).setOffsetInBlock(new cl(n,t)),this.info_.isInsertionMarker&&r.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+n+","+t+")"+r),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,n=e.height,r=e.connectionOffsetY,i=e.connectionHeight+r;this.inlinePath_+=no(e.xPos+e.connectionWidth,e.centerline-n/2)+so("v",r)+e.shape.pathDown+so("v",n-i)+so("h",t-e.connectionWidth)+so("v",-n)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}};(function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Os.Align$$module$build$src$core$inputs$align||(Os.Align$$module$build$src$core$inputs$align={})),Os.Align$$module$build$src$core$inputs$align;var Od=class extends Ih{constructor(e,t,n){super(Ih.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==Ih.SKIP_SETUP&&(n?this.configure_(n):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&ie(this.getTextElement(),this.class)}doClassValidation_(e){return null===e||void 0===e?null:"".concat(e)}setClass(e){this.textElement_&&(this.class&&se(this.textElement_,this.class),e&&ie(this.textElement_,e)),this.class=e}static fromJson(e){return new this(ki(e.text),void 0,e)}};Ni("field_label",Od),Od.prototype.DEFAULT_VALUE="";var Nd=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=Os.Align$$module$build$src$core$inputs$input.LEFT,this.visible=!0,this.type=Os.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,n){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return t||""===t&&n?("string"===typeof t&&(t=Os.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=n,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),e):e}removeField(e,t){for(let n,r=0;n=this.fieldRow[r];r++)if(n.name===e)return n.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let r,i=0;r=this.fieldRow[i];i++)r.setVisible(e);if(this.connection){var n=this.connection;e?t=n.startTrackingAll():n.stopTrackingAll(),(n=n.targetBlock())&&(n.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e,t=0;e=this.fieldRow[t];t++)e.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e,t=0;e=this.fieldRow[t];t++)e.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}};(function(e){(e=e.Align||(e.Align={}))[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Nd||(Nd={})),Os.Align$$module$build$src$core$inputs$input=Nd.Align,{Align:Os.Align$$module$build$src$core$inputs$input}.Input=Nd;var Pd=class extends Nd{constructor(e,t){super(e,t),this.name=e,this.type=Os.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Dd=class extends Nd{constructor(e,t){super(e,t),this.name=e,this.type=Os.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},$d=class extends Nd{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=Os.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Gc.NEXT_STATEMENT)}};Os.ValueInput$$module$build$src$core$inputs$value_input=class extends Nd{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=Os.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Gc.INPUT_VALUE)}},Os.ValueInput$$module$build$src$core$inputs$value_input;var Bd=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new wd(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new kd(this.constants_),this.bottomRow=new hd(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new Td(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let n,r=0;n=t[r];r++){const t=new vd(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}t=void 0;for(let n,r=0;n=this.block_.inputList[r];r++)if(n.isVisible()){this.shouldStartNewRow_(n,t)&&(this.rows.push(e),e=new Td(this.constants_),this.inputRows.push(e));for(let t,r=0;t=n.fieldRow[r];r++)e.elements.push(new md(this.constants_,t,n));this.addInput_(n,e),t=n}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Ed(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let n=this.topRow.hasLeftSquareCorner(this.block_)?Id:Md;this.topRow.elements.push(new n(this.constants_)),t?(e=new gd(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new xd(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof $d&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,n=this.topRow.hasRightSquareCorner(this.block_)?Id:Md,this.topRow.elements.push(new n(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof $d?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Id(this.constants_)):this.bottomRow.elements.push(new Md(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Sd(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Id(this.constants_,"right")):this.bottomRow.elements.push(new Md(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new bd(this.constants_,e)),t.hasInlineInput=!0):e instanceof $d?(t.elements.push(new yd(this.constants_,e)),t.hasStatement=!0):e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new fd(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Pd||e instanceof Dd)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof Dd||e instanceof $d||t instanceof $d||(e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Pd||t instanceof Os.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e,t=0;e=this.rows[t];t++){const t=e.elements;if(e.elements=[],e.startsWithElemSpacer()&&e.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){e.elements.push(t[n]);const r=this.getInRowSpacing_(t[n],t[n+1]);e.elements.push(new _d(this.constants_,r))}e.elements.push(t[t.length-1]),e.endsWithElemSpacer()&&e.elements.push(new _d(this.constants_,this.getInRowSpacing_(t[t.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&ld.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}return e&&ld.isLeftSquareCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset:e&&ld.isLeftRoundedCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,n=0;for(let i,o=0;i=this.rows[o];o++){if(i.measure(),t=Math.max(t,i.width),i.hasStatement){var r=i.getLastInput();let t,n;r=i.width-(null!=(n=null==(t=r)?void 0:t.width)?n:0),e=Math.max(e,r)}n=Math.max(n,i.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let i,o=0;i=this.rows[o];o++)i.hasStatement&&(i.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t,n=0;t=this.rows[n];n++)if(t.hasStatement)this.alignStatementRow_(t);else{var e=t.width;0<(e=this.getDesiredRowWidth_(t)-e)&&this.addAlignmentPadding_(t,e),ld.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const n=e.getFirstSpacer(),r=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===Os.Align$$module$build$src$core$inputs$align.LEFT&&r)r.width+=t;else if(e.align===Os.Align$$module$build$src$core$inputs$align.CENTRE&&n&&r)n.width+=t/2,r.width+=t/2;else if(e.align===Os.Align$$module$build$src$core$inputs$align.RIGHT&&n)n.width+=t;else{if(!r)return;r.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var n=e.width-t.width,r=this.statementEdge;0<(n=r-n)&&this.addAlignmentPadding_(e,n),n=e.width,r=this.getDesiredRowWidth_(e),t.width+=r-n,t.height=Math.max(t.height,e.height),e.width+=r-n,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var n=this.getSpacerRowHeight_(e,t);const r=this.getSpacerRowWidth_(e,t);return n=new Cd(this.constants_,n,r),e.hasStatement&&(n.followsStatement=!0),t.hasStatement&&(n.precedesStatement=!0),n}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return ld.isSpacer(t)?e.yPos+t.height/2:ld.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2):ld.isTopRow(e)?ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let n,r=0;n=e.elements[r];r++)ld.isSpacer(n)&&(n.height=e.height),n.xPos=t,n.centerline=this.getElemCenterline_(e,n),t+=n.width}finalize_(){let e=0,t=0;for(let n,r=0;n=this.rows[r];r++)n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),this.recordElemPositions_(n);if(this.outputConnection&&this.block_.nextConnection){const t=this.block_.nextConnection.targetBlock();t&&(e=Math.max(e,t.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}},Fd=class{constructor(e,t,n){if(this.wsCoordinate=null,!t)throw Error("Cannot create a node without a location.");this.type=e,this.isConnectionLocation=Fd.isConnectionType(e),this.location=t,this.processParams(n||null)}processParams(e){e&&e.wsCoordinate&&(this.wsCoordinate=e.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var e=this.location.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const n=t.inputList[e],r=n.fieldRow;for(let e=0;e<r.length;e++){const t=r[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}if(n.connection)return Fd.createInputNode(n)}return null}findNextForField(){var e=this.location,t=e.getParentInput();const n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var r=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;r<n.inputList.length;r++){const i=(t=n.inputList[r]).fieldRow;for(;e<i.length;){if(i[e].isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(i[e]);e++}if(e=0,t.connection)return Fd.createInputNode(t)}return null}findPrevForInput(){const e=this.location.getParentInput(),t=e.getSourceBlock();for(var n=t.inputList.indexOf(e);0<=n;n--){var r=t.inputList[n];if(r.connection&&r!==e)return Fd.createInputNode(r);for(let e=(r=r.fieldRow).length-1;0<=e;e--){const t=r[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}}return null}findPrevForField(){var e=this.location;const t=e.getParentInput(),n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var r=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=r;r--){var i=n.inputList[r];if(i.connection&&i!==t)return Fd.createInputNode(i);for(i=i.fieldRow;-1<e;){if(i[e].isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(i[e]);e--}0<=r-1&&(e=n.inputList[r-1].fieldRow.length-1)}return null}navigateBetweenStacks(e){var t=this.getLocation();if(t.getSourceBlock){var n=t.getSourceBlock();n&&(t=n)}if(!t||t.isDeadOrDying())return null;n=t.getRootBlock(),t=n.workspace.getTopBlocks(!0);for(let r=0;r<t.length;r++)if(n.id===t[r].id)return-1===(e=r+(e?1:-1))||e===t.length?null:Fd.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock(e){const t=Eo(e);return t?Fd.createConnectionNode(t):Fd.createBlockNode(e)}getOutAstNodeForBlock(e){if(!e)return null;e=e.getTopStackBlock();const t=Eo(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?Fd.createInputNode(t.targetConnection.getParentInput()):Fd.createStackNode(e)}findFirstFieldOrInput(e){e=e.inputList;for(let t=0;t<e.length;t++){const n=e[t],r=n.fieldRow;for(let e=0;e<r.length;e++){const t=r[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}if(n.connection)return Fd.createInputNode(n)}return null}getSourceBlock(){return this.getType()===Fd.types.BLOCK||this.getType()===Fd.types.STACK?this.getLocation():this.getType()===Fd.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Fd.types.STACK:return this.navigateBetweenStacks(!0);case Fd.types.OUTPUT:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.FIELD:return this.findNextForField();case Fd.types.INPUT:return this.findNextForInput();case Fd.types.BLOCK:const e=this.location.nextConnection;if(!e)break;return Fd.createConnectionNode(e);case Fd.types.PREVIOUS:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.NEXT:return Fd.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case Fd.types.WORKSPACE:const e=this.location.getTopBlocks(!0);if(0<e.length)return Fd.createStackNode(e[0]);break;case Fd.types.STACK:return this.findTopASTNodeForBlock(this.location);case Fd.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Fd.types.INPUT:return Fd.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Fd.types.STACK:return this.navigateBetweenStacks(!1);case Fd.types.FIELD:return this.findPrevForField();case Fd.types.INPUT:return this.findPrevForInput();case Fd.types.BLOCK:var e=Eo(this.location);if(!e)break;return Fd.createConnectionNode(e);case Fd.types.PREVIOUS:if((e=this.location.targetConnection)&&!e.getParentInput())return Fd.createConnectionNode(e);break;case Fd.types.NEXT:return Fd.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case Fd.types.STACK:var e=this.location,t=e.getRelativeToSurfaceXY();return t=new cl(t.x,t.y+Fd.DEFAULT_OFFSET_Y),Fd.createWorkspaceNode(e.workspace,t);case Fd.types.OUTPUT:return(t=(e=this.location).targetConnection)?Fd.createConnectionNode(t):Fd.createStackNode(e.getSourceBlock());case Fd.types.FIELD:if(!(e=this.location.getSourceBlock()))throw Error("The current AST location is not associated with a block");return Fd.createBlockNode(e);case Fd.types.INPUT:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Fd.types.PREVIOUS:case Fd.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(e){switch(e){case Fd.types.PREVIOUS:case Fd.types.NEXT:case Fd.types.INPUT:case Fd.types.OUTPUT:return!0}return!1}static createFieldNode(e){return e?new Fd(Fd.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Gc.INPUT_VALUE||t===Gc.NEXT_STATEMENT&&e.getParentInput()?Fd.createInputNode(e.getParentInput()):t===Gc.NEXT_STATEMENT?new Fd(Fd.types.NEXT,e):t===Gc.OUTPUT_VALUE?new Fd(Fd.types.OUTPUT,e):t===Gc.PREVIOUS_STATEMENT?new Fd(Fd.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new Fd(Fd.types.INPUT,e.connection):null}static createBlockNode(e){return e?new Fd(Fd.types.BLOCK,e):null}static createStackNode(e){return e?new Fd(Fd.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new Fd(Fd.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Eo(e);return t?Fd.createConnectionNode(t):Fd.createBlockNode(e)}};Fd.NAVIGATE_ALL_FIELDS=!1,Fd.DEFAULT_OFFSET_Y=-20,function(e){(e=e.types||(e.types={})).FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(Fd||(Fd={}));var Ud=class extends Ca{constructor(e,t,n,r){let i=e?e.workspace.id:void 0;r&&r.getType()===Fd.types.WORKSPACE&&(i=r.getLocation().id),super(i),this.type=oa,this.blockId=null==e?void 0:e.id,this.oldNode=n||void 0,this.newNode=r,this.isCursor=t}toJson(){const e=super.toJson();if(void 0===this.isCursor)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ud)).isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};e(Bs.EVENT,oa,Ud);var zd="blocklyCursor",Hd="blocklyMarker",Gd=.75,Vd=class{constructor(e,t,n){this.workspace=e,this.marker=n,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=n.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return"cursor"===this.marker.type}createDom(){const e=this.isCursor()?zd:Hd;return this.svgGroup_=re(bl.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var n=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||n,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent(e,t),void 0!==(e=this.currentMarkerSvg.childNodes[0])&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===Fd.types.BLOCK?this.showWithBlock_(e):e.getType()===Fd.types.OUTPUT?this.showWithOutput_(e):t===Gc.INPUT_VALUE?this.showWithInput_(e):t===Gc.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===Fd.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===Fd.types.FIELD?this.showWithField_(e):e.getType()===Fd.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===Fd.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput(e){const t=(e=e.getSourceBlock()).width;var n=e.height,r=n*Gd;const i=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(n=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,i,r,n)):e.outputConnection?(r=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,n,r)):this.positionBlock_(t,i,r),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput(e)}showWithPrevious_(e){this.showWithBlockPrevOutput(e)}showWithOutput_(e){this.showWithBlockPrevOutput(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){const t=(e=e.getLocation()).getSize().width,n=e.getSize().height;this.positionRect_(0,0,t,n),this.setParent_(e),this.showCurrent_()}showWithInput_(e){const t=(e=e.getLocation()).getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let n=0;t=t.getOffsetInBlock().y;const r=e.getHeightWidth().width;this.workspace.RTL&&(n=-r),this.positionLine_(n,t,r),this.setParent_(e),this.showCurrent_()}showWithStack_(e){var t=(e=e.getLocation()).getHeightWidth();const n=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const r=-this.constants_.CURSOR_STACK_PADDING/2,i=-this.constants_.CURSOR_STACK_PADDING/2;let o=r;this.workspace.RTL&&(o=-(n+r)),this.positionRect_(o,i,n,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,n){if(e=ro(-t,n)+so("V",-t)+so("H",e+2*t)+so("V",n),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,n=e.getOffsetInBlock().y;e=no(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+n+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,n){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x","".concat(e)),this.markerSvgLine_.setAttribute("y","".concat(t)),this.markerSvgLine_.setAttribute("width","".concat(n)),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,n){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=ro(e,0)+so("h",-(e-n.width))+so("v",this.constants_.TAB_OFFSET_FROM_TOP)+n.pathDown+so("V",t)+so("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,n,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=ro(-t,n)+so("V",-t)+so("H",this.constants_.NOTCH_OFFSET_LEFT)+r.pathLeft+so("H",e+2*t)+so("V",n),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,n,r){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x","".concat(e)),this.markerSvgRect_.setAttribute("y","".concat(t)),this.markerSvgRect_.setAttribute("width","".concat(n)),this.markerSvgRect_.setAttribute("height","".concat(r)),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(e,t){const n=t.getSourceBlock();e=new(B(oa))(n,this.isCursor(),e,t),k(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=re(bl.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=re(bl.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=re(bl.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=re(bl.PATH,{transform:""},this.markerSvg_),this.markerBlock_=re(bl.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(bl.ANIMATE,e,this.markerSvgLine_),re(bl.ANIMATE,e,this.markerInput_),re(bl.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&le(this.svgGroup_)}},Wd=class{constructor(e,t,n){this.markerSvg=this.cursorSvg=null,this.constants=n,this.style=t,this.svgRoot=e,this.svgPath=re(bl.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ie(this.svgRoot,e):se(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}},jd=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e}connect_(e){const t=Gc.INPUT_VALUE,n=this.getSourceBlock();var r=e.getSourceBlock();let i,o;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const e=this.stashShadowState(),t=this.targetBlock();t.isShadow()?t.dispose(!1):(this.disconnectInternal(),i=t),this.applyShadowState(e)}N()&&(o=new(B(Os.MOVE$$module$build$src$core$events$utils))(r),o.setReason(["connect"])),So(this,e),r.setParent(n),o&&(o.recordNew(),k(o)),i&&(e=this.type===t?i.outputConnection:i.previousConnection)&&((r=jd.getConnectionForOrphanedConnection(r,e))?e.connect(r):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Gc.INPUT_VALUE||this.type===Gc.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=Os.getGroup$$module$build$src$core$events$utils();t||Os.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),Os.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(!t||!n)throw Error("Source connection not connected.");const r=Os.getGroup$$module$build$src$core$events$utils();let i;r||Os.setGroup$$module$build$src$core$events$utils(!0),N()&&(i=new(B(Os.MOVE$$module$build$src$core$events$utils))(n.getSourceBlock()),i.setReason(["disconnect"]));const o=this.targetConnection;o&&(o.targetConnection=null),this.targetConnection=null,e&&n.getSourceBlock().setParent(null),i&&(i.recordNew(),k(i)),n.getSourceBlock().isShadow()||t.respawnShadow_(),Os.setGroup$$module$build$src$core$events$utils(r)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!this.getSourceBlock().isDeadOrDying()&&(t=null==(n=e.getInput(t))?void 0:n.connection,!((n=this.targetBlock())&&n!==e||!t||t.targetConnection===this)&&(t.isConnected()&&t.disconnect(),t.connect(this),!0));var n}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Dt(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?sn(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let n=0;n<t.length;n++)if(t[n].connection===this){e=t[n];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let n,r=0;n=e.inputList[r];r++)if(n.connection===this){t=n;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState(e){let{shadowDom:t,shadowState:n}=e;this.shadowDom=t,this.shadowState=n}setShadowStateInternal(){let{shadowDom:e=null,shadowState:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.shadowDom=e,this.shadowState=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(e){var t=this.getSourceBlock();const n=this.getShadowState(),r=this.getShadowDom();if(t.isDeadOrDying()||!n&&!r)return null;if(n)return gn(n,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(r){if(t=Ht(r,t.workspace),e)if(this.type===Gc.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==Gc.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=Dt(e),this.shadowState=sn(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Gc.OUTPUT_VALUE)return xo(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const n=t.getConnectionChecker();return e&&n.canConnect(t,e,!1)?e:null}};jd.CAN_CONNECT=0,jd.REASON_SELF_CONNECTION=1,jd.REASON_WRONG_TYPE=2,jd.REASON_TARGET_NULL=3,jd.REASON_CHECKS_FAILED=4,jd.REASON_DIFFERENT_WORKSPACES=5,jd.REASON_SHADOW_PARENT=6,jd.REASON_DRAG_CHECKS_FAILED=7,jd.REASON_PREVIOUS_AND_OUTPUT=8;var Xd="_TEMP_COLLAPSED_INPUT",Yd="_TEMP_COLLAPSED_FIELD",Kd={COLLAPSED_FIELD_NAME:Yd,COLLAPSED_INPUT_NAME:Xd},qd="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Jd=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,v(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Os.disable$$module$build$src$core$events$utils(),this.hidePreview(),Os.enable$$module$build$src$core$events$utils();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const n=e.isSuperior()?t:e,r=this.topBlock.getRootBlock();St().then((()=>{$r(n.getSourceBlock()),setTimeout((()=>{r.bringToFront()}),0)}))}}}update(e,t){const n=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!n,t))||this.shouldUpdatePreviews(n,e))&&(Os.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(n),this.maybeShowPreview(n),Os.enable$$module$build$src$core$events$utils())}createMarkerBlock(e){var t=e.type;let n;Os.disable$$module$build$src$core$events$utils();try{if(n=this.workspace.newBlock(t),n.setInsertionMarker(!0),e.saveExtraState){var r=e.saveExtraState(!0);r&&n.loadExtraState&&n.loadExtraState(r)}else if(e.mutationToDom){const t=e.mutationToDom();t&&n.domToMutation&&n.domToMutation(t)}for(t=0;t<e.inputList.length;t++){const i=e.inputList[t];if(i.name===Xd)continue;const o=n.inputList[t];if(!o)throw Error(qd.replace("%1","an input"));for(r=0;r<i.fieldRow.length;r++){const e=i.fieldRow[r],t=o.fieldRow[r];if(!t)throw Error(qd.replace("%1","a field"));t.setValue(e.getValue())}}for(const e of n.getDescendants(!1))e.setInsertionMarker(!0);n.setCollapsed(e.isCollapsed()),n.setInputsInline(e.getInputsInline()),n.initSvg(),n.getSvgRoot().setAttribute("visibility","hidden")}finally{Os.enable$$module$build$src$core$events$utils()}return n}initAvailableConnections(){const e=this.topBlock.getConnections_(!1),t=this.topBlock.lastConnectionInStack(!0);return t&&t!==this.topBlock.nextConnection&&(e.push(t),this.lastOnStack=t),e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:n,closest:r}=this.activeCandidate;if(r===e.closest&&n===e.local)return!1;const i=n.x+t.x-r.x;return t=n.y+t.y-r.y,e.radius<Math.sqrt(i*i+t*t)-Os.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),n=null;for(let r=0;r<this.availableConnections.length;r++){const i=this.availableConnections[r],o=i.closest(t,e);o.connection&&(n={closest:o.connection,local:i,radius:o.radius},t=o.radius)}return n}getStartRadius(){return this.activeCandidate?Os.config$$module$build$src$core$config.connectingSnapRadius:Os.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return!(!t||!this.workspace.getComponentManager().hasCapability(t.id,ol.Capability.DELETE_AREA))&&t.wouldDelete(this.topBlock,e)}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t,n=e.closest;n===(null==(t=this.activeCandidate)?void 0:t.closest)||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Jd.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Jd.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Jd.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(e){if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}}else this.hidePreview();this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=null==(e=this.activeCandidate)?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:n}=e;let r,i=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!i)throw Error("Cannot show the insertion marker because there is no insertion marker block");try{r=i.getMatchingConnection(t.getSourceBlock(),t)}catch(l){if(e&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),i=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),i=this.firstMarker=this.createMarkerBlock(this.topBlock)),!i)throw Error("Cannot show the insertion marker because there is no insertion marker block");r=i.getMatchingConnection(t.getSourceBlock(),t)}if(!r)throw Error("Cannot show the insertion marker because there is no associated connection");if(r===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");i.queueRender(),wt(),r.connect(n);const o={x:n.x-r.x,y:n.y-r.y},s=r.getOffsetInBlock().clone(),a=r;St().then((()=>{let e,t;null==(e=i)||e.positionNearConnection(a,o,s),null==(t=i)||t.getSvgRoot().setAttribute("visibility","visible")})),this.markerConnection=r}hideInsertionMarker(){if(this.markerConnection){var e,t=this.markerConnection,n=t.getSourceBlock(),r=n.outputConnection;if(null!=(e=n.previousConnection)&&e.targetConnection||null!=r&&r.targetConnection)n.unplug(!0);else{let e;null==(e=t.targetBlock())||e.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}disposeInsertionMarker(e){if(e){Os.disable$$module$build$src$core$events$utils();try{e.dispose()}finally{Os.enable$$module$build$src$core$events$utils()}}}};!function(e){(e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}))[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"}(Jd||(Jd={}));var Zd=Jd.PREVIEW_TYPE,Qd={};Qd.InsertionMarkerManager=Jd,Qd.PreviewType=Zd;var ep=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Rd}makeRenderInfo_(e){return new Bd(this,e)}makeDrawer_(e,t){return new Ld(e,t)}makeMarkerDrawer(e,t){return new Vd(e,this.getConstants(),t)}makePathObject(e,t){return new Wd(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,n){return!!jd.getConnectionForOrphanedConnection(e,n===Gc.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,n){return t.type===Gc.OUTPUT_VALUE||t.type===Gc.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(n,e.targetBlock(),t.type)?Jd.PREVIEW_TYPE.INSERTION_MARKER:Jd.PREVIEW_TYPE.REPLACEMENT_FADE:Jd.PREVIEW_TYPE.INSERTION_MARKER}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},tp={};tp.BottomRow=hd,tp.Connection=dd,tp.ConstantProvider=Rd,tp.Drawer=Ld,tp.ExternalValueInput=fd,tp.Field=md,tp.Hat=gd,tp.Icon=vd,tp.InRowSpacer=_d,tp.InlineInput=bd,tp.InputConnection=pd,tp.InputRow=Td,tp.JaggedEdge=Ed,tp.MarkerSvg=Vd,tp.Measurable=cd,tp.NextConnection=Sd,tp.OutputConnection=wd,tp.PathObject=Wd,tp.PreviousConnection=xd,tp.RenderInfo=Bd,tp.Renderer=ep,tp.RoundCorner=Md,tp.Row=ud,tp.SpacerRow=Cd,tp.SquareCorner=Id,tp.StatementInput=yd,tp.TopRow=kd,tp.Types=ld,tp.init=Io,tp.register=Mo,tp.unregister=Co;var np=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&se(e,t),(t=this.theme.getClassName())&&ie(e,t));for(let n,r=0;n=this.subscribedWorkspaces_[r];r++)n.refreshTheme();for(const[n,r]of this.componentDB)for(const i of r){e=i.element,t=i.propertyName;const r=this.theme&&this.theme.getComponentStyle(n);e.style.setProperty(t,r||"")}for(const n of this.subscribedWorkspaces_)n.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!Q(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,n){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:n}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(n,t||"")}unsubscribe(e){if(e)for(const[t,n]of this.componentDB){for(let t=n.length-1;0<=t;t--)n[t].element===e&&n.splice(t,1);n.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},rp="VARIABLE_DYNAMIC",ip={CATEGORY_NAME:rp};ip.flyoutCategory=Lo,ip.flyoutCategoryBlocks=Oo,ip.onCreateVariableButtonClick_Colour=Ao,ip.onCreateVariableButtonClick_Number=Ro,ip.onCreateVariableButtonClick_String=ko;var op=class{canConnect(e,t,n,r){return this.canConnectWithReason(e,t,n,r)===jd.CAN_CONNECT}canConnectWithReason(e,t,n,r){const i=this.doSafetyChecks(e,t);return i!==jd.CAN_CONNECT?i:this.doTypeChecks(e,t)?n&&!this.doDragChecks(e,t,r||0)?jd.REASON_DRAG_CHECKS_FAILED:jd.CAN_CONNECT:jd.REASON_CHECKS_FAILED}getErrorMessage(e,t,n){switch(e){case jd.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case jd.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case jd.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case jd.REASON_TARGET_NULL:return"Target connection is null.";case jd.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+n.getCheck();case jd.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case jd.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case jd.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return jd.REASON_TARGET_NULL;let n,r,i;return e.isSuperior()?(n=e.getSourceBlock(),r=t.getSourceBlock(),i=t):(r=e.getSourceBlock(),n=t.getSourceBlock(),i=e,e=t),n===r?jd.REASON_SELF_CONNECTION:i.type!==Wu[e.type]?jd.REASON_WRONG_TYPE:n.workspace!==r.workspace?jd.REASON_DIFFERENT_WORKSPACES:n.isShadow()&&!r.isShadow()?jd.REASON_SHADOW_PARENT:i.type===Gc.OUTPUT_VALUE&&r.previousConnection&&r.previousConnection.isConnected()||i.type===Gc.PREVIOUS_STATEMENT&&r.outputConnection&&r.outputConnection.isConnected()?jd.REASON_PREVIOUS_AND_OUTPUT:jd.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let n=0;n<e.length;n++)if(-1!==t.indexOf(e[n]))return!0;return!1}doDragChecks(e,t,n){if(e.distanceFrom(t)>n||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case Gc.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Gc.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case Gc.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Gc.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return-1===Ws.indexOf(t)}canConnectToPrevious_(e,t){return!e.targetConnection&&-1===Ws.indexOf(t)&&(!t.targetConnection||!!(e=t.targetBlock()).isInsertionMarker()&&!e.getPreviousBlock())}};e(Bs.CONNECTION_CHECKER,$s,op);var sp=class extends nc{constructor(e){super(e),this.type=Qs,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new sp)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};e(Bs.EVENT,Qs,sp);var ap=class extends nc{constructor(e,t){super(e),this.type=ea,e&&(this.oldName=e.name,this.newName="undefined"===typeof t?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ap)).oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};e(Bs.EVENT,ea,ap);var lp=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(;0<e.length;)this.deleteVariable(e[0]);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.name!==t){var n=this.getVariable(t,e.type),r=this.workspace.getAllBlocks(!1),i=Os.getGroup$$module$build$src$core$events$utils();i||Os.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,n,r):this.renameVariableAndUses_(e,t,r)}finally{Os.setGroup$$module$build$src$core$events$utils(i)}}}renameVariableById(e,t){const n=this.getVariableById(e);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(n,t)}renameVariableAndUses_(e,t,n){for(k(new(B(ea))(e,t)),e.name=t,t=0;t<n.length;t++)n[t].updateVarName(e)}renameVariableWithConflict_(e,t,n,r){const i=e.type;for(t!==n.name&&this.renameVariableAndUses_(n,t,r),t=0;t<r.length;t++)r[t].renameVarById(e.getId(),n.getId());k(new(B(Qs))(e)),Q(this.variableMap.get(i),e)}createVariable(e,t,n){var r=this.getVariable(e,t);if(r){if(n&&r.getId()!==n)throw Error('Variable "'+e+'" is already in use and its id is "'+r.getId()+'" which conflicts with the passed in id, "'+n+'".');return r}if(n&&this.getVariableById(n))throw Error('Variable id, "'+n+'", is already in use.');return r=n||M(),t=t||"",r=new ic(this.workspace,e,t,r),(e=this.variableMap.get(t)||[]).push(r),this.variableMap.delete(t),this.variableMap.set(t,e),k(new(B(Zs))(r)),r}deleteVariable(e){const t=e.getId(),n=this.variableMap.get(e.type);if(n)for(let r=0;r<n.length;r++)if(n[r].getId()===t){n.splice(r,1),k(new(B(Qs))(e)),0===n.length&&this.variableMap.delete(e.type);break}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var n=t.name;const r=this.getVariableUsesById(e);for(let t,i=0;t=r[i];i++)if("procedures_defnoreturn"===t.type||"procedures_defreturn"===t.type)return e=String(t.getFieldValue("NAME")),n=Os.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",n).replace("%2",e),void Ke(n);1<r.length?(n=Os.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",n),Je(n,(e=>{e&&t&&this.deleteVariableInternal(t,r)}))):this.deleteVariableInternal(t,r)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const n=Os.getGroup$$module$build$src$core$events$utils();n||Os.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);this.deleteVariable(e)}finally{Os.setGroup$$module$build$src$core$events$utils(n)}}getVariable(e,t){if(t=this.variableMap.get(t||""))for(let n,r=0;n=t[r];r++)if(Os.Names$$module$build$src$core$names.equals(n.name,e))return n;return null}getVariableById(e){for(const t of this.variableMap.values())for(const n of t)if(n.getId()===e)return n;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const n of e.getPotentialVariableMap().variableMap.keys())t.add(n);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map((e=>e.name))}getVariableUsesById(e){const t=[],n=this.workspace.getAllBlocks(!1);for(let r=0;r<n.length;r++){const i=n[r].getVarModels();if(i)for(let o=0;o<i.length;o++)i[o].getId()===e&&t.push(n[r])}return t}},cp=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Ah,this.potentialVariableMap=null,this.id=M(),d(this),this.options=e||new Th({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(c(Bs.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new lp(this)}dispose(){this.listeners.length=0,this.clear(),p(this)}sortObjects_(e,t){const n=Math.sin(ur(cp.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+n*e.x-(t.y+n*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!Q(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){Q(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects_.bind(this)),e.filter((function(e){return!e.isInsertionMarker()}))):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!Q(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}getAllBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.getTopBlocks(!0);e=[];for(let n=0;n<t.length;n++)e.push(...t[n].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter((function(e){return!e.isInsertionMarker()}))}clear(){this.isClearing=!0;try{const e=Os.getGroup$$module$build$src$core$events$utils();for(e||Os.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();Os.setGroup$$module$build$src$core$events$utils(e),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,n){return this.variableMap.createVariable(e,t,n)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const n in e){if(e[n]>this.remainingCapacityOfType(n))return!1;t+=e[n]}return!(t>this.remainingCapacity())}hasBlockLimits(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,n=e?this.undoStack_:this.redoStack_;const r=t.pop();if(r){for(var i=[r];t.length&&r.group&&r.group===t[t.length-1].group;){const e=t.pop();e&&i.push(e)}for(t=0;t<i.length;t++)n.push(i[t]);i=L(i,e),C(!1);try{for(n=0;n<i.length;n++)i[n].run(e)}finally{C(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,O()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){Q(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let n=0;n<t.length;n++)if(!t[n].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new lp(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return u(e)}static getAll(){return h()}};cp.SCAN_ANGLE=3;var up=100,hp=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var n=new globalThis.Audio}catch(i){return}for(let t=0;t<e.length;t++){const i=e[t],o=i.match(/\.(\w+)$/);if(o&&n.canPlayType("audio/"+o[1])){var r=new globalThis.Audio(i);break}}r&&this.sounds.set(t,r)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch((function(){})):e.pause(),Ka||qa)break}}play(e,t){var n=this.sounds.get(e);n?(e=new Date,null!==this.lastSound_&&e.getTime()-this.lastSound_.getTime()<up||(this.lastSound_=e,(n=Ka||Ya?n:n.cloneNode()).volume=void 0===t?1:t,n.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}},dp=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e)),e=this.createLayer(Uu),ie(e,"blocklyBlockCanvas"),e=this.createLayer(zu),ie(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=re(bl.SVG,{class:"blocklyBlockDragSurface",xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1"});return e.append(t),re(bl.G,{},t)}translateLayers(e,t){let n;e="translate(".concat(e.x,", ").concat(e.y,") scale(").concat(t,")"),null==(n=this.dragLayer)||n.setAttribute("transform",e);for(const[,r]of this.layers)r.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot())}moveOffDragLayer(e,t){this.append(e,t)}append(e,t){let n;this.layers.has(t)||this.createLayer(t),null==(n=this.layers.get(t))||n.appendChild(e.getSvgRoot())}createLayer(e){const t=this.workspace.getSvgGroup(),n=re(bl.G,{});let r=!1;const i=[...this.layers].sort(((e,t)=>e[0]-t[0]));for(const[o,s]of i)if(e<o){t.insertBefore(n,s),r=!0;break}return r||t.appendChild(n),this.layers.set(e,n),n}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(Uu)}getBubbleLayer(){return this.layers.get(zu)}},pp=20,fp=class extends cp{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(c(Bs.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||fp.setTopLevelWorkspaceMetrics_,this.componentManager=new ol,this.connectionDBList=Wc.init(this.connectionChecker),this.audioManager=new hp(e.parentWorkspace),this.grid=this.options.gridPattern?new gh(this.options.gridPattern,e.gridOptions):null,this.markerManager=new vh(this),lc&&ot&&this.registerToolboxCategoryCallback(oc,ot),ip&&Lo&&this.registerToolboxCategoryCallback(rp,Lo),sd&&mo&&(this.registerToolboxCategoryCallback(od,mo),this.addChangeListener(vo)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new np(this,this.options.theme||yh),this.themeManager_.subscribeWorkspace(this),this.renderer=Io(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new Tl(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=yh),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(e){return!!e.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const e=new(B(ca))(this.getTheme().name,this.id);k(e)}updateBlockStyles_(e){for(let t,n=0;t=e[n];n++){const e=t.getStyleName();e&&t.setStyle(e)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,n=0,r=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(r=this.scale);do{const i=Ce(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(r=1),t+=i.x*r,n+=i.y*r,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new cl(t,n)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Tl(e.width,e.height)}getOriginOffsetInPixels(){return Ie(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if(-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=re(bl.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=re(bl.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new dp(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(j(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),j(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(c(Bs.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=c(Bs.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&le(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&le(e.parentNode)}this.resizeHandlerWrapper&&(Y(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=fp.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new jl(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new Th({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(c(Bs.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(c(Bs.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(ol.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),n=[];for(let r,i=0;r=e[i];i++){r.position(t,n);const e=r.getBoundingRectangle();e&&n.push(e)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Re();cl.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const n=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,n.setAttribute("data-cached-width","".concat(e))),null!=t&&(this.cachedParentSvgSize.height=t,n.setAttribute("data-cached-height","".concat(t)))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(N()){var e=this.scale,t=-this.scrollY,n=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(n-this.oldLeft))){var r=new(B(ua))(t,n,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=n,k(r)}}}translate(e,t){let n,r;null==(n=this.layerManager)||n.translateLayers(new cl(e,t),this.scale),null==(r=this.grid)||r.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.isVisible_=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e||this.hideChaff(!0))}render(){for(var e=this.getAllBlocks(!1),t=e.length-1;0<=t;t--)e[t].queueRender();if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].queueRender();St().then((()=>{this.markerManager.updateMarkers()}))}highlightBlock(e,t){if(void 0===t){for(let e,t=0;e=this.highlightedBlocks[t];t++)e.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?-1===this.highlightedBlocks.indexOf(e)&&this.highlightedBlocks.push(e):Q(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(ne("Blockly.WorkspaceSvg.prototype.paste","v10","v11","Blockly.clipboard.paste"),!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Os.getGroup$$module$build$src$core$events$utils();let n;t||Os.setGroup$$module$build$src$core$events$utils(!0);try{n=e.type?this.pasteBlock_(null,e):"comment"===e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null)}finally{Os.setGroup$$module$build$src$core$events$utils(t)}return n}pasteBlock_(e,t){let n;Os.disable$$module$build$src$core$events$utils();try{let r=0,i=0;if(e){let t,o;n=Ht(e,this),r=parseInt(null!=(t=e.getAttribute("x"))?t:"0"),this.RTL&&(r=-r),i=parseInt(null!=(o=e.getAttribute("y"))?o:"0")}else t&&(n=mn(t,this),r=t.x||10,this.RTL&&(r=this.getWidth()-r),i=t.y||10);if(!isNaN(r)&&!isNaN(i)){let e;do{e=!1;const t=this.getAllBlocks(!1);for(let n,o=0;n=t[o];o++){const t=n.getRelativeToSurfaceXY();if(1>=Math.abs(r-t.x)&&1>=Math.abs(i-t.y)){e=!0;break}}if(!e){const t=n.getConnections_(!1);for(let n,o=0;n=t[o];o++)if(n.closest(Os.config$$module$build$src$core$config.snapRadius,new cl(r,i)).connection){e=!0;break}}e&&(r=this.RTL?r-Os.config$$module$build$src$core$config.snapRadius:r+Os.config$$module$build$src$core$config.snapRadius,i+=2*Os.config$$module$build$src$core$config.snapRadius)}while(e);n.moveTo(new cl(r,i))}}finally{Os.enable$$module$build$src$core$events$utils()}return N()&&!n.isShadow()&&k(new(B(Os.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}pasteWorkspaceComment_(e){let t;Os.disable$$module$build$src$core$events$utils();try{t=gc.fromXmlRendered(e,this);let n,r,i=parseInt(null!=(n=e.getAttribute("x"))?n:"0"),o=parseInt(null!=(r=e.getAttribute("y"))?r:"0");isNaN(i)||isNaN(o)||(this.RTL&&(i=-i),t.moveBy(i+50,o+50))}finally{Os.enable$$module$build$src$core$events$utils()}return N()&&cc.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,n){return e=super.createVariable(e,t,n),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(ol.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t,n=0;t=e[n];n++){const e=t.getClientRect();e&&this.dragTargetAreas.push({component:t,clientRect:e})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t,n=0;t=this.dragTargetAreas[n];n++)if(t.clientRect.contains(e.clientX,e.clientY))return t.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){(e=J(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,this.dragDeltaXY=cl.difference(t,e)}moveDrag(e){return(e=J(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,cl.sum(this.dragDeltaXY,e)}isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(mh.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,n=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||n){var r=Z(e);if(Ja)var i=e.metaKey;t&&(e.ctrlKey||i||!n)?(r=-r.y/50,t=J(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,r)):(t=this.scrollX-r.x,n=this.scrollY-r.y,e.shiftKey&&!r.x&&(t=this.scrollX-r.y,n=this.scrollY),this.scroll(t,n)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new yl(0,0,0,0);const t=e[0].getBoundingRectangle();for(let r=1;r<e.length;r++){var n=e[r];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<t.top&&(t.top=n.top),n.bottom>t.bottom&&(t.bottom=n.bottom),n.left<t.left&&(t.left=n.left),n.right>t.right&&(t.right=n.right))}return t}cleanUp(){this.setResizesEnabled(!1),Os.setGroup$$module$build$src$core$events$utils(!0);const e=this.getTopBlocks(!0);let t=0;for(let n,r=0;n=e[r];r++){if(!n.isMovable())continue;const e=n.getRelativeToSurfaceXY();n.moveBy(-e.x,t-e.y,["cleanup"]),n.snapToGrid(),t=n.getRelativeToSurfaceXY().y+n.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}Os.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=gu.registry.getContextMenuOptions(gu.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),er(e,t,this.RTL)}}updateToolbox(e){if(e=De(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Fe(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(m(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);const r=this.scale*n;if(this.scale!==r){r>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var i=this.getCanvas().getCTM(),o=this.getParentSvg().createSVGPoint();o.x=e,o.y=t,e=(o=o.matrixTransform(i.inverse())).x,t=o.y,i=i.translate(e*(1-n),t*(1-n)).scale(n),this.scrollX=i.e,this.scrollY=i.f,this.setScale(r)}}zoomCenter(e){var t=this.getMetrics();let n;this.flyout?(n=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(n=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(n,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var n=this.getBlocksBoundingBox(),r=2*pp,i=n.right-n.left+r;if(n=n.bottom-n.top+r,i){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),i+=this.flyout.getWidth()/this.scale)),t/=i,e/=n,Os.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{Os.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ie(this.getCanvas(),"blocklyCanvasTransitioning"),ie(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){se(this.getCanvas(),"blocklyCanvasTransitioning"),se(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,n=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,n=-n-e.scrollTop,this.scroll(t,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var n=e?this.getBlockById(e):null;if(n){e=n.getRelativeToSurfaceXY(),n=t?{height:n.height,width:n.width}:n.getHeightWidth();var r=this.scale;t=(e.x+(this.RTL?-1:1)*n.width/2)*r,e=(e.y+n.height/2)*r,n=this.getMetrics(),this.scroll(-(t-n.viewWidth/2),-(e-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(!0);const n=this.getMetrics();e=Math.min(e,-n.scrollLeft),t=Math.min(t,-n.scrollTop);const r=n.scrollTop+Math.max(0,n.scrollHeight-n.viewHeight);e=Math.max(e,-(n.scrollLeft+Math.max(0,n.scrollWidth-n.viewWidth))),t=Math.max(t,-r),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+n.scrollLeft),-(t+n.scrollTop),!1),e+=n.absoluteLeft,t+=n.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return super.getAllBlocks(e)}getTopBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){Q(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!==typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!==typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t="pointerdown"===e.type,n=this.currentGesture_;return n?t&&n.hasStarted()?(console.warn("Tried to start the same gesture twice."),n.cancel(),null):n:t?this.currentGesture_=new mh(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];li(),Gn(),Lr(),this.hideComponents(e)}hideComponents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getComponentManager().getComponents(ol.Capability.AUTOHIDEABLE,!0).forEach((t=>t.autoHide(e)))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();"number"===typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"===typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},mp={};mp.WorkspaceSvg=fp,mp.resizeSvgContents=No;var gp=class extends Ca{constructor(e,t){super(t),this.type=aa,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new gp)).isOpen=e.isOpen,t}};e(Bs.EVENT,aa,gp);var vp=class extends Bc{constructor(e){if(super(e),this.type=Os.DELETE$$module$build$src$core$events$utils,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Ot(e),this.ids=D(e),this.wasShadow=e.isShadow(),this.oldJson=sn(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=Bt(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new vp)).oldXml=Os.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const n=this.ids[e],r=t.getBlockById(n);r?r.dispose(!1):n===this.blockId&&console.warn("Can't delete non-existent block: "+n)}else mn(this.oldJson,t)}};e(Bs.EVENT,Os.DELETE$$module$build$src$core$events$utils,vp);var _p=class{constructor(e,t,n){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.isInsertionMarker_=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=n&&!e.getBlockById(n)?n:M(),e.setBlockById(this.id,this),this.xy_=new cl(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(n=Hs[t])||"object"!==typeof n)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,n)}e.addTopBlock(this),e.addTypedBlock(this),new.target===_p&&this.doInit_()}doInit_(){const e=Os.getGroup$$module$build$src$core$events$utils();e||Os.setGroup$$module$build$src$core$events$utils(!0);const t=I();try{"function"===typeof this.init&&(C(!1),this.init(),C(t)),N()&&k(new(B(Os.CREATE$$module$build$src$core$events$utils))(this))}finally{Os.setGroup$$module$build$src$core$events$utils(e),C(t)}this.inputsInlineDefault=this.inputsInline,"function"===typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),N()&&k(new(B(Os.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,"function"===typeof this.destroy&&this.destroy(),this.childBlocks_.forEach((e=>e.disposeInternal())),this.inputList.forEach((e=>e.dispose())),this.inputList.length=0,this.getConnections_(!0).forEach((e=>e.dispose())),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const e of this.inputList)for(const t of e.fieldRow)t.initModel&&t.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t,n=null;null!=(t=this.outputConnection)&&t.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null==(e=e.targetConnection)||e.disconnect(),this.workspace.connectionChecker.canConnect(e,n,!1)?n.connect(e):null==e||e.onFailedConnect(n))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const n=this.inputList[t].connection;if(n&&n.type===Gc.INPUT_VALUE&&n.targetConnection){if(e)return null;e=n}}return e}unplugFromStack_(e){let t=null;var n;if(null!=(n=this.previousConnection)&&n.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),n=this.getNextBlock(),e&&n&&!n.isShadow()){let n,r;null==(e=null!=(r=null==(n=this.nextConnection)?void 0:n.targetConnection)?r:null)||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t,n=0;t=this.inputList[n];n++)t.connection&&e.push(t.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const n=t.targetBlock();if(!n||e&&n.isShadow())return t;t=n.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t,n=0;t=this.inputList[n];n++)if(t.connection&&t.connection.targetBlock()===e)return t;return null}getSurroundParent(){let e,t=this;do{if(e=t,t=t.getParent(),!t)return null}while(t.getNextBlock()===e);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{e=t,t=e.parentBlock_}while(t);return e}getTopStackBlock(){let e,t=this;do{e=t.getPreviousBlock()}while(e&&e.getNextBlock()===t&&(t=e));return t}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let n,r=0;n=this.inputList[r];r++)if(n.connection){var t=n.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),n=!!t;if(n&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!n&&e)throw Error("Block not connected to new parent.");if(n&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Q(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],n=this.getChildren(e);for(let r,i=0;r=n[i];i++)t.push(...r.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(e){this.movable_=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(T(this,!0))}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(e){this.editable_=e;for(let t,n=0;t=this.inputList[n];n++)for(let e,r=0;e=t.fieldRow[r];r++)e.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){const n=this.getConnections_(!0);if(e=e.getConnections_(!0),n.length!==e.length)throw Error("Connection lists did not match in length.");for(let r=0;r<e.length;r++)if(e[r]===t)return n[r];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Qr(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=Ai(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!==typeof e)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if("string"!==typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(let t,n=0;t=this.inputList[n];n++)for(let r,i=0;r=t.fieldRow[i];i++)if(r.name===e)return r;return null}getVars(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let r,i=0;r=t.fieldRow[i];i++)r.referencesVariables()&&e.push(r.getValue());return e}getVarModels(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let r,i=0;r=t.fieldRow[i];i++)if(r.referencesVariables()){const t=this.workspace.getVariableById(r.getValue());t&&e.push(t)}return e}updateVarName(e){for(let t,n=0;t=this.inputList[n];n++)for(let r,i=0;r=t.fieldRow[i];i++)r.referencesVariables()&&e.getId()===r.getValue()&&r.refreshVariableName()}renameVarById(e,t){for(let n,r=0;n=this.inputList[r];r++)for(let i,o=0;i=n.fieldRow[o];o++)i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const n=this.getField(t);if(!n)throw Error('Field "'+t+'" not found.');n.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Gc.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Gc.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Gc.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Pd&&this.inputList[e]instanceof Pd)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Os.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Pd)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof Dd)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let r=2;r<t.length;r++)"("===t[r-2]&&")"===t[r]&&(t[r-2]=t[r-1],t.splice(r-1,2));let n="";return t=(t=t.reduce(((e,t)=>(e=e+("("===n||")"===t?"":" ")+t,n=t[t.length-1],e)),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"?";const t=[];for(const r of this.inputList)if(r.name!=Xd){for(const e of r.fieldRow)t.push(e.getText());if(r.connection){const i=r.connection.targetBlock();if(i){var n=r.connection;let o=n.getCheck();!o&&n.targetConnection&&(o=n.targetConnection.getCheck()),(n=!!o&&(-1!==o.indexOf("Boolean")||-1!==o.indexOf("Number")))&&t.push("("),t.push(...i.toTokens(e)),n&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new Os.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new $d(e,this))}appendDummyInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.appendInput(new Pd(e,this))}appendEndRowInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.appendInput(new Dd(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=s(Bs.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var n=0;e["args"+n];){if(void 0===e["message"+n])throw Error(t+"args".concat(n," must have a corresponding message (message").concat(n,")."));n++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t),n=0;void 0!==e["message"+n];)this.interpolate_(e["message"+n],e["args"+n]||[],e["implicitAlign"+n]||e["lastDummyAlign"+n],t),n++;if(void 0!==e.inputsInline&&(Os.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),Os.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(n=ki(e.tooltip),this.setTooltip(n)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(n=ki(e.helpUrl),this.setHelpUrl(n)),"string"===typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Hi(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Hi(e[t],this,!1)}jsonInitColour_(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(n){console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch(n){console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!==typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const n in e)void 0!==this[n]&&t.push(n);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,n,r){e=Ii(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,n),n=[];for(let i,o=0;i=t[o];o++)if(this.isInputKeyword_(i.type)){if(e=this.inputFromJson_(i,r)){for(let t,r=0;t=n[r];r++)e.appendField(t[0],t[1]);n.length=0}}else(e=this.fieldFromJson_(i))&&n.push([e,i.name])}validateTokens_(e,t){const n=[];let r=0;for(let i=0;i<e.length;i++){const o=e[i];if("number"===typeof o){if(1>o||o>t)throw Error('Block "'+this.type+'": Message index %'+o+" out of range.");if(n[o])throw Error('Block "'+this.type+'": Message index %'+o+" duplicated.");n[o]=!0,r++}}if(r!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,n){const r=[];for(let o=0;o<e.length;o++){var i=e[o];if("number"===typeof i&&(i=t[i-1]),"string"===typeof i)if("\n"===i)i={type:"input_end_row"},n&&(i.align=n);else if(!(i=this.stringToFieldJson_(i)))continue;r.push(i)}return(e=r.length)&&!this.isInputKeyword_(r[e-1].type)&&(e={type:"input_dummy"},n&&(e.align=n),r.push(e)),r}fieldFromJson_(e){const t=Os.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"===typeof e.alt?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var n={LEFT:Os.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:Os.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:Os.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:Os.Align$$module$build$src$core$inputs$align.CENTRE};let r;switch(e.type){case"input_value":r=this.appendValueInput(e.name);break;case"input_statement":r=this.appendStatementInput(e.name);break;case"input_dummy":r=this.appendDummyInput(e.name);break;case"input_end_row":r=this.appendEndRowInput(e.name);break;default:r=this.appendInputFromRegistry(e.type,e.name)}return r?(e.check&&r.setCheck(e.check),e.align&&(void 0===(n=n[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):r.setAlign(n)),r):null}isInputKeyword_(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||o(Bs.INPUT,e)}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var n=-1,r=t?-1:this.inputList.length;for(let i,o=0;i=this.inputList[o];o++)if(i.name===e){if(n=o,-1!==r)break}else if(t&&i.name===t&&(r=o,-1!==n))break;if(-1===n)throw Error('Named input "'+e+'" not found.');if(-1===r)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(n,r)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const n=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,n)}removeInput(e,t){for(let n,r=0;n=this.inputList[r];r++)if(n.name===e)return n instanceof $d&&this.statementInputCount--,n.dispose(),this.inputList.splice(r,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(ed.TYPE))?void 0:e.getText())?t:null}setCommentText(e){var t;let n;const r=null!=(n=null==(t=this.getIcon(ed.TYPE))?void 0:t.getText())?n:null;r!==e&&(null!==e?((t=this.getIcon(ed.TYPE))||(t=this.addIcon(new ed(this))),Os.disable$$module$build$src$core$events$utils(),t.setText(e),Os.enable$$module$build$src$core$events$utils()):this.removeIcon(ed.TYPE),k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,r,e)))}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new rd(e);return this.icons.push(e),this.icons.sort(((e,t)=>e.getWeight()-t.getWeight())),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter((t=>!t.getType().equals(e))),!0}hasIcon(e){return this.icons.some((t=>t.getType().equals(e)))}getIcon(e){return e instanceof Xl?this.icons.find((t=>t.getType().equals(e))):this.icons.find((t=>t.getType().toString()===e))}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const r=new(B(Os.MOVE$$module$build$src$core$events$utils))(this);n&&r.setReason(n),this.xy_.translate(e,t),r.recordNew(),k(r)}makeConnection_(e){return new jd(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let n,r=0;n=this.inputList[r];r++)if(n.connection){var t=n.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};_p.COLLAPSED_INPUT_NAME=Xd,_p.COLLAPSED_FIELD_NAME=Yd;var bp=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(e){this.drawer=e}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(e){const t=this.curNode;this.curNode=e,this.drawer&&this.drawer.draw(t,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},yp=class extends bp{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===Fd.types.NEXT||e.getType()===Fd.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;let t,n;return e.getType()!==Fd.types.PREVIOUS&&e.getType()!==Fd.types.OUTPUT||(e=e.next()),(e=null!=(n=null==(t=e)?void 0:t.in())?n:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===Fd.types.NEXT||e.getType()===Fd.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===Fd.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};e(Bs.CURSOR,$s,yp);var Tp=class extends yp{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const n=e.in()||e.next();return t(n)?n:n?this.getNextNode_(n,t):t(e=this.findSiblingOrParent(e.out()))?e:e?this.getNextNode_(e,t):null}getPreviousNode_(e,t){if(!e)return null;let n=e.prev();return n=n?this.getRightMostChild(n):e.out(),t(n)?n:n?this.getPreviousNode_(n,t):null}validNode_(e){let t=!1;return(e=e&&e.getType())!==Fd.types.OUTPUT&&e!==Fd.types.INPUT&&e!==Fd.types.FIELD&&e!==Fd.types.NEXT&&e!==Fd.types.PREVIOUS&&e!==Fd.types.WORKSPACE||(t=!0),t}findSiblingOrParent(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent(e.out())}getRightMostChild(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild(e)}};Tp.registrationName="basicCursor",e(Bs.CURSOR,Tp.registrationName,Tp);var Ep=class extends Tp{validNode_(e){let t=!1;const n=e&&e.getType();return e&&(e=e.getLocation(),n===Fd.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=!0)),t}},Sp=10,wp=class extends jd{constructor(e,t){super(e,t),this.targetConnection=this.highlightPath=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Wu[t]],this.offsetInBlock=new cl(0,0),this.trackedState=wp.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===wp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.highlightPath&&(le(this.highlightPath),this.highlightPath=null)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var n=!1;if(!t.isMovable()){if(!(t=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,n=!0}var r=g()==t;r||t.addSelect();var i=e.x+Os.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Sp)-this.x,o=e.y+Os.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Sp)-this.y;n&&(o=-o),t.RTL&&(i=e.x-Os.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*Sp)-this.x),t.moveBy(i,o,["bump"]),r||t.removeSelect()}}}moveTo(e,t){let n=!1;return this.trackedState===wp.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=wp.TrackedState.TRACKED,n=!0):this.trackedState===wp.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),n=!0),this.x=e,this.y=t,n}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=cl.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){if(!this.highlightPath){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),t=e.shapeFor(this);this.type===Gc.INPUT_VALUE||this.type===Gc.OUTPUT_VALUE?(e=e.TAB_OFFSET_FROM_TOP,t=ro(0,-e)+so("v",e)+t.pathDown+so("v",e)):(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS,t=ro(-e,0)+so("h",e)+t.pathLeft+so("h",e)),e=this.offsetInBlock,this.highlightPath=re(bl.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate(".concat(e.x,", ").concat(e.y,")")+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(le(this.highlightPath),this.highlightPath=null)}setTracking(e){e&&this.trackedState===wp.TrackedState.TRACKED||!e&&this.trackedState===wp.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=wp.TrackedState.TRACKED):(this.trackedState===wp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=wp.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const n=e[t],r=n.getConnections_(!0);for(let e=0;e<r.length;e++)r[e].setTracking(!1);for(const e of n.getIcons())gi(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==Gc.INPUT_VALUE&&this.type!==Gc.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let n;t.isCollapsed()?(n=[],t.outputConnection&&n.push(t.outputConnection),t.nextConnection&&n.push(t.nextConnection),t.previousConnection&&n.push(t.previousConnection)):n=t.getConnections_(!0);for(let t=0;t<n.length;t++)e.push(...n[t].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(I()){const n=Os.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(Os.setGroup$$module$build$src$core$events$utils(n),this.bumpAwayFrom(e),Os.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),Os.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(t&&n){var r=t.getSourceBlock(),i=n.getSourceBlock();super.disconnectInternal(e),r.rendered&&r.queueRender(),i.rendered&&(i.updateDisabled(),i.queueRender(),i.getSvgRoot().style.display="block")}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const n=t.rendered,r=e.rendered;n&&t.updateDisabled(),r&&e.updateDisabled(),n&&r&&(this.type===Gc.NEXT_STATEMENT||this.type===Gc.PREVIOUS_STATEMENT?e.queueRender():t.queueRender()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(e){return super.setCheck(e),this.sourceBlock_.rendered&&this.sourceBlock_.queueRender(),this}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(wp||(wp={}));var xp=wp.TrackedState,Mp={};Mp.RenderedConnection=wp,Mp.TrackedState=xp;var Cp=class extends _p{constructor(e,t,n){super(e,t,n),this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1,this.translation="",this.bumpNeighboursPid=0,this.dragging=!1,this.relativeCoords=new cl(0,0),this.workspace=e,this.svgGroup_=re(bl.G,{}),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),(e=this.pathObject.svgPath).tooltip=this,ni(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let t,n=0;t=this.inputList[n];n++)t.init();for(var e of this.getIcons())e.initView(this.createIconPointerDownListener(e)),e.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||j(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(g()!==this){var e=null;if(g()){e=g().id,Os.disable$$module$build$src$core$events$utils();try{g().unselect()}finally{Os.enable$$module$build$src$core$events$utils()}}e=new(B(ra))(e,this.id,this.workspace.id),k(e),v(this),this.addSelect()}}unselect(){if(g()===this){var e=new(B(ra))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,k(e),v(null),this.removeSelect()}}setParent(e){const t=this.parentBlock_;if(e!==t){de(),super.setParent(e),pe();var n=this.getSvgRoot();if(!this.workspace.isClearing&&n){var r=this.getRelativeToSurfaceXY();e?e.getSvgRoot().appendChild(n):t&&((e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(n,e):this.workspace.getCanvas().appendChild(n),this.translate(r.x,r.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,r=this.getSvgRoot();if(r)do{const e=Ce(r);t+=e.x,n+=e.y,r=r.parentNode}while(r&&!e.hasLayer(r));return new cl(t,n)}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const r=N();let i=null;r&&(i=new(B(Os.MOVE$$module$build$src$core$events$utils))(this),n&&i.setReason(n)),e=new cl(e,t),t=this.getRelativeToSurfaceXY(),e=cl.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),r&&i&&(i.recordNew(),k(i)),this.workspace.resizeContents()}translate(e,t){this.translation="translate(".concat(e,", ").concat(t,")"),this.relativeCoords=new cl(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const n=this.getRelativeToSurfaceXY();this.moveBy(e.x-n.x,e.y-n.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),n=t/2,r=this.getRelativeToSurfaceXY();e=Math.round(Math.round((r.x-n)/t)*t+n-r.x),t=Math.round(Math.round((r.y-n)/t)*t+n-r.y),(e||t)&&this.moveBy(e,t,["snap"])}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let n,r;return this.RTL?(n=e.x-t.width,r=e.x):(n=e.x,r=e.x+t.width),new yl(e.y,e.y+t.height,n,r)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e,t=0;e=this.inputList[t];t++)e.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t=Xd,n=Yd;for(let i,o=0;i=this.inputList[o];o++)i.name!==t&&i.setVisible(!e);for(var r of this.getIcons())r.updateCollapsed();e?(e=this.toString(Gu),(r=this.getField(n))?r.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Od(e),n)):(this.updateDisabled(),this.removeInput(t))}tab(e,t){const n=new Ep;n.setCurNode(Fd.createFieldNode(e)),e=n.getCurNode(),t?n.next():n.prev(),(t=n.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e="function"===typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=gu.registry.getContextMenuOptions(gu.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(er(e,t,this.RTL),Qn(this))}updateComponentLocations(e){if(this.rendered){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(cl.sum(e,t.relativeCoords))}}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const n of t.fieldRow)n.onLocationChange(e)}setDragging(e){(this.dragging=e)?(this.translation="",Ws.push(...this.getConnections_(!0)),ie(this.svgGroup_,"blocklyDragging")):(Ws.length=0,se(this.svgGroup_,"blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(e,t){this.isDeadOrDying()||(ai(),or(),t&&this.rendered&&(this.unplug(e),Pr(this)),super.dispose(!!e),le(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,g()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach((e=>clearTimeout(e))),this.warningTextDb.clear(),this.getIcons().forEach((e=>e.dispose())))}checkAndDelete(){this.workspace.isFlyout||(Os.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),Os.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:jc.TYPE,blockState:sn(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:T(this,!0)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t,n=0;t=this.inputList[n];n++)for(let e,r=0;e=t.fieldRow[r];r++)e.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let e;null==(e=this.getNextBlock())||e.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const e of this.getChildren(!1))e.updateDisabled()}}getCommentIcon(){let e;return ne("getCommentIcon","v10","v11","getIcon"),null!=(e=this.getIcon(ed.TYPE))?e:null}setWarningText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var n of this.warningTextDb.values())clearTimeout(n);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout((()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))}),100));else if(this.isInFlyout&&(e=null),n=this.getIcon(nd.TYPE),e){let r=this.getSurroundParent(),i=null;for(;r;)r.isCollapsed()&&(i=r),r=r.getSurroundParent();i&&i.setWarningText(Os.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Cp.COLLAPSED_WARNING_ID),n?n.addMessage(e,t):this.addIcon(new nd(this).addMessage(e,t))}else n&&(t?(n.addMessage("",t),n.getText()||this.removeIcon(nd.TYPE)):this.removeIcon(nd.TYPE))}setMutator(e){this.removeIcon(Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof nd&&(this.warning=e),e instanceof Os.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),this.rendered&&(e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),wt(),this.bumpNeighbours()),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(nd.TYPE)&&(this.warning=null),e.equals(Os.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.rendered&&(this.queueRender(),wt(),this.bumpNeighbours()),t}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,!t)throw Error("Invalid style name: "+e);this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour()}bringToFront(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(!t.isDeadOrDying())do{const n=t.getSvgRoot(),r=n.parentNode,i=r.childNodes;if(i[i.length-1]!==n&&r.appendChild(n),e)break;t=t.getParent()}while(t)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(e){return super.appendInput(e),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var n=this.inputList[t].connection;n&&(n.setTracking(e),(n=n.targetBlock())&&n.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let n,r=0;n=this.inputList[r];r++)n.connection&&t.push(n.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new wp(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var e=Os.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout((()=>{const t=Os.getGroup$$module$build$src$core$events$utils();Os.setGroup$$module$build$src$core$events$utils(e),this.getRootBlock().bumpNeighboursInternal(),Os.setGroup$$module$build$src$core$events$utils(t),this.bumpNeighboursPid=0}),Os.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let e;null==(e=t.targetBlock())||e.bumpNeighboursInternal()}for(const n of t.neighbours(Os.config$$module$build$src$core$config.snapRadius))n.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&n.isConnected()||(t.isSuperior()?n.bumpAwayFrom(t):t.bumpAwayFrom(n)))}}scheduleSnapAndBump(){const e=Os.getGroup$$module$build$src$core$events$utils();setTimeout((()=>{Os.setGroup$$module$build$src$core$events$utils(e),this.snapToGrid(),Os.setGroup$$module$build$src$core$events$utils(!1)}),Os.config$$module$build$src$core$config.bumpDelay/2),this.bumpNeighbours()}positionNearConnection(e,t,n){if(e.type===Gc.NEXT_STATEMENT||e.type===Gc.INPUT_VALUE){let r=t.x;t=t.y,r+=n.x-e.getOffsetInBlock().x,t+=n.y-e.getOffsetInBlock().y,this.moveBy(r,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Et(this)}render(){this.queueRender(),wt()}renderEfficiently(){this.rendered=!0,de(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),pe(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(vh.LOCAL_MARKER).draw();for(const e of this.inputList)for(const t of e.fieldRow)t.updateMarkers_()}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var n=this.getNextBlock();if(n){n=n.getHeightWidth();const r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=n.height-r,t=Math.max(t,n.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Cp.INLINE=-1,Cp.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Ip,kp=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Rp=class extends kp{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e,t){return e instanceof Cp?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Ap=class extends Rp{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=new Th({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Dl.TOP?Dl.BOTTOM:Dl.TOP,this.flyout=new(c(Bs.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Dl.RIGHT?Dl.LEFT:Dl.RIGHT,this.flyout=new(c(Bs.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=re(bl.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=re(bl.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),re(bl.RECT,{width:Lp,height:Op,y:Np},e);const n=re(bl.IMAGE,{width:Wl.width,x:-Bp,height:Wl.height,y:-Fp,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return n.setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),e=re(bl.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),re(bl.RECT,{width:Lp,height:Np},e),this.svgLid=re(bl.IMAGE,{width:Wl.width,x:-Bp,height:Wl.height,y:-Fp,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),X(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),X(this.svgGroup,"pointerup",this,this.click),X(n,"pointerover",this,this.mouseOver),X(n,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(ce(this.flyout.createDom(bl.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[ol.Capability.AUTOHIDEABLE,ol.Capability.DELETE_AREA,ol.Capability.DRAG_TARGET,ol.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&le(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map((function(e){return JSON.parse(e)})),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout((()=>{let n,r;null==(n=this.flyout)||n.show(e),t.cursor="",null==(r=this.workspace.scrollbar)||r.setVisible(!1)}),10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var n,r=Xe(this.workspace,e);e=je(r,new Tl(Lp,Op+Np),Dp,Pp,e,this.workspace),t=Ye(e,Pp,r.vertical===Fl.TOP?zl.DOWN:zl.UP,t),this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new yl(this.top,this.top+Op+Np,this.left,this.left+Lp)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Fp-$p;return e=e.left+Bp-$p,new yl(t,t+Np+Op+2*$p,e,e+Lp+2*$p)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=Hp;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Wp),t=Gp+this.lidOpen*(Vp-Gp),this.svgGroup&&(this.svgGroup.style.opacity="".concat(t)),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),zp/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Dl.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let n;null==(n=this.svgLid)||n.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Lp-4)+","+(Np-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Wp)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(B(aa))(e,this.workspace.id),k(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==Os.DELETE$$module$build$src$core$events$utils||e.type!==Os.DELETE$$module$build$src$core$events$utils||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),-1===this.contents.indexOf(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Up)}}}cleanBlockJson(e){function t(e){if(e){if(delete e.id,delete e.x,delete e.y,delete e.enabled,e.icons&&e.icons.comment){var n=e.icons.comment;delete n.height,delete n.width,delete n.pinned}for(var r in n=e.inputs){var i=n[r];const e=i.block;i=i.shadow,e&&t(e),i&&t(i)}e.next&&(e=(r=e.next).block,r=r.shadow,e&&t(e),r&&t(r))}}return t(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},Lp=47,Op=44,Np=16,Pp=20,Dp=20,$p=10,Bp=0,Fp=32,Up=.1,zp=80,Hp=4,Gp=.4,Vp=.8,Wp=45,jp=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error('Shortcut named "'.concat(e.name,'" already exists.'));if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let n=0;n<t.length;n++)this.addKeyMapping(t[n],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn('Keyboard shortcut named "'.concat(e,'" not found.')),!1)}addKeyMapping(e,t,n){e="".concat(e);const r=this.keyMap.get(e);if(r&&!n)throw Error('Shortcut named "'.concat(t,'" collides with shortcuts "').concat(r,'"'));r&&n?r.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,n){const r=this.keyMap.get(e);if(!r)return n||console.warn('No keyboard shortcut named "'.concat(t,'" registered with key code "').concat(e,'"')),!1;const i=r.indexOf(t);return-1<i?(r.splice(i,1),0===r.length&&this.keyMap.delete(e),!0):(n||console.warn('No keyboard shortcut named "'.concat(t,'" registered with key code "').concat(e,'"')),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,n]of this.keyMap)e[t]=n;return e}getRegistry(){const e=Object.create(null);for(const[t,n]of this.shortcuts)e[t]=n;return mi(Object.create(null),e)}onKeyDown(e,t){var n=this.serializeKeyEvent_(t);if(!(n=this.getShortcutNamesByKeyCode(n)))return!1;for(let r,i=0;r=n[i];i++){const n=this.shortcuts.get(r);let i,o;if(null==(i=n)||!i.preconditionFn||null!=(o=n)&&o.preconditionFn(e)){let r,i;if(null!=(r=n)&&r.callback&&null!=(i=n)&&i.callback(e,t,n))return!0}}return!1}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[n,r]of this.keyMap)-1<r.indexOf(e)&&t.push(n);return t}serializeKeyEvent_(e){let t="";for(const n in jp.modifierKeys)e.getModifierState(n)&&(""!==t&&(t+="+"),t+=n);return""!==t&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers_(e){for(let t,n=0;t=e[n];n++)if(!(t in jp.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let n="";if(t){this.checkModifiers_(t);for(const e in jp.modifierKeys)-1<t.indexOf(jp.modifierKeys[e])&&(""!==n&&(n+="+"),n+=e)}return""!==n&&e?n=n+"+"+e:e&&(n="".concat(e)),n}};jp.registry=new jp,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(jp||(jp={})),function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"}(Ip||(Ip={}));var Xp=null,Yp=null;Go();var Kp={};Kp.names=Ip,Kp.registerCopy=Bo,Kp.registerCut=Fo,Kp.registerDefaultShortcuts=Go,Kp.registerDelete=$o,Kp.registerEscape=Do,Kp.registerPaste=Uo,Kp.registerRedo=Ho,Kp.registerUndo=zo;var qp=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Lc}save(e){return(e=e.getProcedureMap().getProcedures().map((e=>Vo(e)))).length?e:null}load(e,t){const n=t.getProcedureMap();for(const r of e)n.add(jo(this.procedureModelClass,this.parameterModelClass,r,t))}clear(e){e.getProcedureMap().clear()}},Jp={};Jp.ProcedureSerializer=qp,Jp.loadParameter=Xo,Jp.loadProcedure=jo,Jp.saveParameter=Wo,Jp.saveProcedure=Vo;var Zp=class{constructor(){this.priority=Ac}save(e){const t=[];for(const n of e.getAllVariables())e={name:n.name,id:n.getId()},n.type&&(e.type=n.type),t.push(e);return t.length?t:null}load(e,t){for(const n of e)t.createVariable(n.name,n.type,n.id)}clear(e){e.getVariableMap().clear()}};rn("variables",new Zp);var Qp={};Qp.VariableSerializer=Zp;var ef={};ef.load=Ko,ef.save=Yo;var tf={blocks:$c,exceptions:Rc,priorities:Nc,procedures:Jp,registry:Pc,variables:Qp,workspaces:ef},nf=class{constructor(e,t,n,r,i){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,n=void 0===n||n;const o=(t=void 0===t||t)&&n;t&&(this.hScroll=new Cl(e,!0,o,r,i)),n&&(this.vScroll=new Cl(e,!1,o,r,i)),o&&(this.corner_=re(bl.RECT,{height:Cl.scrollbarThickness,width:Cl.scrollbarThickness,class:"blocklyScrollbarBackground"}),ce(this.corner_,e.getBubbleCanvas()))}dispose(){le(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,n=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(n=!0)):n=t=!0,t||n){try{Os.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&n&&this.vScroll.resize(e)}finally{Os.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let e;null==(e=this.corner_)||e.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let e;null==(e=this.corner_)||e.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,n){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(n||void 0===n)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},rf=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,n=0;return e&&(t=e.getWidth(),n=e.getHeight()),new Tl(t,n)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const n=this.getToolboxMetrics(),r=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox();var o;const s=!(null!=(o=this.workspace_.getFlyout())&&o.autoClose),a=(o=i?n.position:r.position)===Dl.TOP;return o===Dl.LEFT&&(i&&(e+=n.width),s&&(e+=r.width)),a&&(i&&(t+=n.height),s&&(t+=r.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),n=this.getToolboxMetrics(),r=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox();var o;const s=!(null!=(o=this.workspace_.getFlyout())&&o.autoClose),a=(o=i?n.position:r.position)===Dl.LEFT||o===Dl.RIGHT;return o!==Dl.TOP&&o!==Dl.BOTTOM||(i&&(t.height-=n.height),s&&(t.height-=r.height)),a&&(i&&(t.width-=n.width),s&&(t.width-=r.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),n=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const r={};return n||(r.top=e.top,r.bottom=e.top+e.height),t||(r.left=e.left,r.right=e.left+e.width),r}getPaddedContent_(e,t){const n=t.top+t.height,r=t.left+t.width,i=e.width,o=i/2,s=(e=e.height)/2;return{top:Math.min(t.top-s,n-e),bottom:Math.max(n+s,t.top+e),left:Math.min(t.left-o,r-i),right:Math.max(r+o,t.left+i)}}getScrollMetrics(e,t,n){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var r=n||this.getContentMetrics();n=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,r),r=void 0!==n.top?n.top:t.top;const i=void 0!==n.left?n.left:t.left;return{top:r/e,left:i/e,width:((void 0!==n.right?n.right:t.right)-i)/e,height:((void 0!==n.bottom?n.bottom:t.bottom)-r)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),n=this.getSvgMetrics(),r=this.getAbsoluteMetrics(),i=this.getViewMetrics(),o=this.getContentMetrics(),s=this.getScrollMetrics(!1,i,o);return{contentHeight:o.height,contentWidth:o.width,contentTop:o.top,contentLeft:o.left,scrollHeight:s.height,scrollWidth:s.width,scrollTop:s.top,scrollLeft:s.left,viewHeight:i.height,viewWidth:i.width,viewTop:i.top,viewLeft:i.left,absoluteTop:r.top,absoluteLeft:r.left,svgHeight:n.height,svgWidth:n.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};e(Bs.METRICS_MANAGER,$s,rf);var of=class extends Ma{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=ma,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};e(Bs.EVENT,ma,of);var sf=class extends Ca{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=na,e&&(this.blockId=e.id,this.isStart=t,this.blocks=n)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new sf)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};e(Bs.EVENT,na,sf);var af={};af.bumpIntoBounds=qo,af.bumpIntoBoundsHandler=Jo,af.bumpTopObjectsIntoBounds=Qo;var lf=class{constructor(e,t){this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.dragIconData_=[],this.draggingBlock_=e,this.draggedConnectionManager_=new Jd(this.draggingBlock_),this.workspace_=t,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=es(e,this.startXY_)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(e,t){let n;Os.getGroup$$module$build$src$core$events$utils()||Os.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent_(),this.draggingBlock_.bringToFront(!0),de(),this.workspace_.setResizesEnabled(!1),Ur(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(!0),null==(n=this.workspace_.getLayerManager())||n.moveToDragLayer(this.draggingBlock_)}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=cl.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),Br(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const e=new(B(na))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));k(e)}drag(e,t){t=this.pixelsToWorkspaceUnits_(t);var n=cl.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(n),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(t,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,e!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(e,t){if(this.drag(e,t),this.fireDragEndEvent_(),pe(),Ur(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(e=this.getNewLocationAfterDrag_(t).delta),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),!this.maybeDeleteBlock_()){let t;null==(t=this.workspace_.getLayerManager())||t.moveOffDragLayer(this.draggingBlock_,Uu),this.draggingBlock_.setDragging(!1),e?this.updateBlockAfterMove_():qo(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)}this.workspace_.setResizesEnabled(!0),Os.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(e){return{delta:e=this.pixelsToWorkspaceUnits_(e),newLocation:cl.sum(this.startXY_,e)}}maybeDeleteBlock_(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),Ws.length=0,!0)}updateBlockAfterMove_(){this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.queueRender(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const e=new(B(na))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));k(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const n=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&"function"===typeof t.removeStyle?t.removeStyle(n):e||"function"!==typeof t.addStyle||t.addStyle(n)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var e=new(B(Os.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);e.setReason(["drag"]),e.oldCoordinate=this.startXY_,e.recordNew(),k(e)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new cl(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(){ne("Blockly.BlockDragger.prototype.dragIcons_","v10","v11")}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};e(Bs.BLOCK_DRAGGER,$s,lf);var cf={};cf.Bubble=Bh,cf.MiniWorkspaceBubble=zh,cf.TextBubble=Kh,cf.TextInputBubble=qh;var uf=class extends Bc{constructor(e,t,n,r){super(e),this.type=Js,this.recordUndo=!1,e&&(this.name=t,this.oldValue=n,this.newValue=r)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new uf)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};e(Bs.EVENT,Js,uf);var hf=class extends Bc{constructor(e){super(e),this.type=Os.MOVE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate="".concat(Math.round(this.oldCoordinate.x),", ")+"".concat(Math.round(this.oldCoordinate.y))),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate="".concat(Math.round(this.newCoordinate.x),", ")+"".concat(Math.round(this.newCoordinate.y))),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new hf)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(n=e.oldCoordinate.split(","),t.oldCoordinate=new cl(Number(n[0]),Number(n[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(n=e.newCoordinate.split(","),t.newCoordinate=new cl(Number(n[0]),Number(n[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const n=t.getParent();return n?(e.parentId=n.id,(t=n.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&cl.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getBlockById(this.blockId);if(n){var r=e?this.newParentId:this.oldParentId,i=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,r){var o=t.getBlockById(r);if(!o)return void console.warn("Can't connect to non-existent block: "+r)}if(n.getParent()&&n.unplug(),e)i=n.getRelativeToSurfaceXY(),n.moveBy(e.x-i.x,e.y-i.y,this.reason);else{let e,r;(!(t=n.outputConnection)||n.previousConnection&&n.previousConnection.isConnected())&&(t=n.previousConnection),n=null==(r=t)?void 0:r.type,i?(n=o.getInput(i))&&(e=n.connection):n===Gc.PREVIOUS_STATEMENT&&(e=o.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+i)}}else console.warn("Can't move non-existent block: "+this.blockId)}};e(Bs.EVENT,Os.MOVE$$module$build$src$core$events$utils,hf);var df,pf=class extends Ca{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=sa,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=n)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new pf)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(df||(df={})),e(Bs.EVENT,sa,pf);var ff={};ff.BubbleOpen=pf,ff.BubbleType=df;var mf=class extends Ma{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Os.getGroup$$module$build$src$core$events$utils(),this.recordUndo=I())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new mf)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var n=e.getEventWorkspace_();if(t){if(t=Os.createElement$$module$build$src$core$utils$xml("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Os.domToWorkspace$$module$build$src$core$xml(t,n)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(n=n.getCommentById(e.commentId))?n.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},gf=class extends mf{constructor(e,t,n){super(e),this.type=pa,e&&(this.oldContents_="undefined"===typeof t?"":t,this.newContents_="undefined"===typeof n?"":n)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new gf)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var n=e?this.newContents_:this.oldContents_;if(!n){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setContent(n)}else console.warn("Can't change non-existent comment: "+this.commentId)}};e(Bs.EVENT,pa,gf);var vf=class extends mf{constructor(e){super(e),this.type=ha,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bt(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new vf)).xml=Os.textToDom$$module$build$src$core$utils$xml(e.xml),t}run(e){mf.CommentCreateDeleteHelper(this,e)}};e(Bs.EVENT,ha,vf);var _f=class extends mf{constructor(e){super(e),this.type=da,e&&(this.xml=e.toXmlWithXY())}run(e){mf.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bt(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new _f)).xml=Os.textToDom$$module$build$src$core$utils$xml(e.xml),t}};e(Bs.EVENT,da,_f);var bf=class extends mf{constructor(e){super(e),this.type=fa,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate="".concat(Math.round(this.oldCoordinate_.x),", ")+"".concat(Math.round(this.oldCoordinate_.y)),e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,n){return t=super.fromJson(e,t,null!=n?n:new bf),n=e.oldCoordinate.split(","),t.oldCoordinate_=new cl(Number(n[0]),Number(n[1])),n=e.newCoordinate.split(","),t.newCoordinate_=new cl(Number(n[0]),Number(n[1])),t}isNull(){return cl.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var n=t.getRelativeToSurfaceXY();t.moveBy(e.x-n.x,e.y-n.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};e(Bs.EVENT,fa,bf);var yf=class extends Ca{constructor(e,t,n){super(n),this.type=la,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new yf)).oldItem=e.oldItem,t.newItem=e.newItem,t}};e(Bs.EVENT,la,yf),Os.CHANGE$$module$build$src$core$events$utils,Os.CREATE$$module$build$src$core$events$utils,Os.DELETE$$module$build$src$core$events$utils,Os.MOVE$$module$build$src$core$events$utils,Os.CHANGE$$module$build$src$core$events$utils,Os.CREATE$$module$build$src$core$events$utils,Os.DELETE$$module$build$src$core$events$utils,Os.MOVE$$module$build$src$core$events$utils,Os.disable$$module$build$src$core$events$utils,Os.enable$$module$build$src$core$events$utils,Os.getGroup$$module$build$src$core$events$utils,Os.setGroup$$module$build$src$core$events$utils;var Tf={};Tf.Abstract=Ma,Tf.BLOCK_CHANGE=Os.CHANGE$$module$build$src$core$events$utils,Tf.BLOCK_CREATE=Os.CREATE$$module$build$src$core$events$utils,Tf.BLOCK_DELETE=Os.DELETE$$module$build$src$core$events$utils,Tf.BLOCK_DRAG=na,Tf.BLOCK_FIELD_INTERMEDIATE_CHANGE=Js,Tf.BLOCK_MOVE=Os.MOVE$$module$build$src$core$events$utils,Tf.BUBBLE_OPEN=sa,Tf.BUMP_EVENTS=ga,Tf.BlockBase=Bc,Tf.BlockChange=Eh,Tf.BlockCreate=Fc,Tf.BlockDelete=vp,Tf.BlockDrag=sf,Tf.BlockFieldIntermediateChange=uf,Tf.BlockMove=hf,Tf.BubbleOpen=pf,Tf.BubbleType=df,Tf.CHANGE=Os.CHANGE$$module$build$src$core$events$utils,Tf.CLICK=ia,Tf.COMMENT_CHANGE=pa,Tf.COMMENT_CREATE=ha,Tf.COMMENT_DELETE=da,Tf.COMMENT_MOVE=fa,Tf.CREATE=Os.CREATE$$module$build$src$core$events$utils,Tf.Click=Ia,Tf.ClickTarget=wa,Tf.CommentBase=mf,Tf.CommentChange=gf,Tf.CommentCreate=vf,Tf.CommentDelete=_f,Tf.CommentMove=bf,Tf.DELETE=Os.DELETE$$module$build$src$core$events$utils,Tf.FINISHED_LOADING=ma,Tf.FinishedLoading=of,Tf.MARKER_MOVE=oa,Tf.MOVE=Os.MOVE$$module$build$src$core$events$utils,Tf.MarkerMove=Ud,Tf.SELECTED=ra,Tf.Selected=uc,Tf.THEME_CHANGE=ca,Tf.TOOLBOX_ITEM_SELECT=la,Tf.TRASHCAN_OPEN=aa,Tf.ThemeChange=zc,Tf.ToolboxItemSelect=yf,Tf.TrashcanOpen=gp,Tf.UI=ta,Tf.UiBase=Ca,Tf.VAR_CREATE=Zs,Tf.VAR_DELETE=Qs,Tf.VAR_RENAME=ea,Tf.VIEWPORT_CHANGE=ua,Tf.VarBase=nc,Tf.VarCreate=rc,Tf.VarDelete=sp,Tf.VarRename=ap,Tf.ViewportChange=Vc,Tf.clearPendingUndo=O,Tf.disable=Os.disable$$module$build$src$core$events$utils,Tf.disableOrphans=F,Tf.enable=Os.enable$$module$build$src$core$events$utils,Tf.filter=L,Tf.fire=k,Tf.fromJson=$,Tf.get=B,Tf.getDescendantIds=D,Tf.getGroup=Os.getGroup$$module$build$src$core$events$utils,Tf.getRecordUndo=I,Tf.isEnabled=N,Tf.setGroup=Os.setGroup$$module$build$src$core$events$utils,Tf.setRecordUndo=C;var Ef=class extends Rd{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&le(this.selectedGlowFilter),this.replacementGlowFilter&&le(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:to("c",[eo(25,-e),eo(71,-e),eo(t,0)])}}makeHexagonal(){function e(e,n,r){var i=e/2;return io(-(r=r?-1:1)*(i=i>t?t:i),e=(n?-1:1)*e/2)+io(r*i,e)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeRounded(){function e(e,t,r){const i=e>n?e-n:0;return ao("a","0 0,1",e=(e>n?n:e)/2,eo((t?-1:1)*e,(t?-1:1)*e))+so("v",(r?1:-1)*i)+ao("a","0 0,1",e,eo((t?1:-1)*e,(t?-1:1)*e))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeSquared(){function e(e,n,r){return e-=2*t,ao("a","0 0,1",t,eo((n?-1:1)*t,(n?-1:1)*t))+so("v",(r?1:-1)*e)+ao("a","0 0,1",t,eo((n?1:-1)*t,(n?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:e=>t,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Gc.INPUT_VALUE:case Gc.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&-1!==t.indexOf("Boolean")?this.HEXAGONAL:(t&&-1!==t.indexOf("Number")||t&&t.indexOf("String"),this.ROUNDED);case Gc.PREVIOUS_STATEMENT:case Gc.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return to("c",[eo(e*i/2,0),eo(e*i*3/4,s/2),eo(e*i,s)])+oo([eo(e*i,o)])+to("c",[eo(e*i/4,s/2),eo(e*i/2,s),eo(e*i,s)])+so("h",e*r)+to("c",[eo(e*i/2,0),eo(e*i*3/4,-s/2),eo(e*i,-s)])+oo([eo(e*i,-o)])+to("c",[eo(e*i/4,-s/2),eo(e*i/2,-s),eo(e*i,-s)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,r=t/3,i=r/3,o=n/2,s=o/2,a=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:a,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=ao("a","0 0,0",e,eo(-e,e)),n=ao("a","0 0,1",e,eo(-e,e));return{width:e,height:e,pathTop:t,pathBottom:ao("a","0 0,0",e,eo(e,e)),rightWidth:e,rightHeight:e,pathTopRight:n,pathBottomRight:ao("a","0 0,1",e,eo(e,e))}}generateSecondaryColour_(e){return xi("#000",e,.15)||e}generateTertiaryColour_(e){return xi("#000",e,.25)||e}createDom(e,t,n){super.createDom(e,t,n),e=re(bl.DEFS,{},e),t=re(bl.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(bl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),n=re(bl.FECOMPONENTTRANSFER,{result:"outBlur"},t),re(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),re(bl.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),re(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=re(bl.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(bl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=re(bl.FECOMPONENTTRANSFER,{result:"outBlur"},e),re(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(bl.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),re(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),re(bl.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e}getCSS_(e){return["".concat(e," .blocklyText,"),"".concat(e," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ").concat(this.FIELD_TEXT_FONTSIZE)+"pt ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e," .blocklyText {"),"fill: #fff;","}","".concat(e," .blocklyNonEditableText>rect:not(.blocklyDropdownRect),"),"".concat(e," .blocklyEditableText>rect:not(.blocklyDropdownRect) {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"}","".concat(e," .blocklyNonEditableText>text,"),"".concat(e," .blocklyEditableText>text,"),"".concat(e," .blocklyNonEditableText>g>text,"),"".concat(e," .blocklyEditableText>g>text {"),"fill: #575E75;","}","".concat(e," .blocklyFlyoutLabelText {"),"fill: #575E75;","}","".concat(e," .blocklyText.blocklyBubbleText {"),"fill: #575E75;","}","".concat(e," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>rect,","".concat(e," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}","".concat(e," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"color: #575E75;","}","".concat(e," .blocklyDropdownText {"),"fill: #fff !important;","}","".concat(e,".blocklyWidgetDiv .goog-menuitem,"),"".concat(e,".blocklyDropDownDiv .goog-menuitem {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e,".blocklyDropDownDiv .goog-menuitem-content {"),"color: #fff;","}","".concat(e," .blocklyHighlightedConnectionPath {"),"stroke: ".concat(this.SELECTED_GLOW_COLOUR,";"),"}","".concat(e," .blocklyDisabled > .blocklyOutlinePath {"),"fill: url(#blocklyDisabledPattern".concat(this.randomIdentifier,")"),"}","".concat(e," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"]}},Sf=class extends Ld{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(ld.isSpacer(e)){const r=e.precedesStatement;var t=e.followsStatement;if(r||t){const i=this.constants_.INSIDE_CORNERS;var n=i.rightHeight;return n=e.height-(r?n:0),t=t?i.pathBottomRight:"",e=0<n?so("V",e.yPos+n):"",void(this.outlinePath_+=t+e+(r?i.pathTopRight:""))}}this.outlinePath_+=so("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=ro(e.xPos,this.info_.startY),this.outlinePath_+=so("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=so("V",e.baseline),this.outlinePath_+=so("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var n=e.width-2*e.connectionWidth;e=no(e.xPos+e.connectionWidth,e.centerline-e.height/2)+so("h",n)+e.shape.pathRightDown(e.height)+so("h",-n)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(t,e)}}drawStatementInput_(e){var t=e.getLastInput();const n=t.xPos+t.notchOffset+t.shape.width,r=this.constants_.INSIDE_CORNERS,i=t.shape.pathRight+so("h",-(t.notchOffset-r.width))+r.pathTop,o=e.height-2*r.height;t=r.pathBottom+so("h",t.notchOffset-r.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=so("H",n)+i+so("v",o)+t+so("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}},wf=class extends Ih{constructor(e,t,n,r,i,o,s){if(super(Ih.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",n=Number(ki(n)),t=Number(ki(t)),isNaN(n)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=n||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Tl(t,n+wf.Y_PADDING),this.imageHeight=n,"function"===typeof i&&(this.clickHandler=i),e!==Ih.SKIP_SETUP&&(s?this.configure_(s):(this.flipRtl=!!o,this.altText=ki(r)||""),this.setValue(ki(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=ki(e.alt))}initView(){this.imageElement=re(bl.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(fl,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!==typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(fl,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};wf.Y_PADDING=1,Ni("field_image",wf),wf.prototype.DEFAULT_VALUE="";var xf=class extends Ih{constructor(e,t,n){super(Ih.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new kh;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new kh;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&N()&&k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new kh;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.style.colourTertiary)):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(se(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!1)):(ie(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new kh;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(Za||Ya||Ka)?this.showPromptEditor_():this.showInlineEditor_(t)}showPromptEditor_(){et(Os.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),(e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)}))}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new kh;Hn(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new kh;Os.setGroup$$module$build$src$core$events$utils(!0);const t=Fn();var n=this.getClickTarget_();if(!n)throw Error("A click target has not been set.");ie(n,"editing"),(n=document.createElement("input")).className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);const r=this.workspace_.getScale();var i=this.getConstants().FIELD_TEXT_FONTSIZE*r+"pt";return t.style.fontSize=i,n.style.fontSize=i,i=xf.BORDERRADIUS*r+"px",this.isFullBlockField()&&(i=((i=this.getScaledBBox()).bottom-i.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,n.style.border=1*r+"px solid "+e,t.style.borderRadius=i,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*r+"px")),n.style.borderRadius=i,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(n),n}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&N()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(k(new(B(Os.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),Os.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=Fn().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");se(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=j(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=j(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(Y(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(Y(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){"Enter"===e.key?(Gn(),Lr()):"Escape"===e.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),Gn(),Lr()):"Tab"===e.key&&(Gn(),Lr(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&N()&&this.value_!==e&&k(new(B(Js))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new kh;const t=Fn(),n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",e=new cl(e.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}repositionForWindowResize(){const e=this.getSourceBlock();return e instanceof Cp&&(qo(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),e)||this.resizeEditor_(),!0)}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return"".concat(e)}getValueFromEditorText_(e){return e}};xf.BORDERRADIUS=4;var Mf=class extends xf{constructor(e,t,n){super(e,t,n)}doClassValidation_(e){return void 0===e?null:"".concat(e)}static fromJson(e){return new this(ki(e.text),void 0,e)}};Ni("field_input",Mf),Mf.prototype.DEFAULT_VALUE="";var Cf=class extends hd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},If=class extends yd{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},kf=class extends cd{constructor(e){super(e),this.width=this.height=0,this.type|=ld.getType("RIGHT_CONNECTION")}},Rf=class extends kd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Af=class extends Bd{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new Rf(this.constants_),this.bottomRow=new Cf(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new kf(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof Dd||e instanceof $d||t instanceof $d||(e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Pd||e instanceof Dd)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&ld.isLeftRoundedCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&ld.isLeftSquareCorner(e)&&t&&ld.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(ld.isTopRow(e)&&ld.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const n=ld.isInputRow(e)&&e.hasStatement,r=ld.isInputRow(t)&&t.hasStatement;return r||n?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),r&&n?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):ld.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):ld.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const n=this.width-this.startX;return ld.isInputRow(e)&&e.hasStatement||ld.isInputRow(t)&&t.hasStatement?Math.max(n,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):n}getElemCenterline_(e,t){if(e.hasStatement&&!ld.isSpacer(t)&&!ld.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(ld.isInlineInput(t)&&t instanceof pd){const n=t.connectedBlock;if(n&&n.outputConnection&&n.nextConnection)return e.yPos+n.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Pd||e instanceof Dd)&&t.hasDummyInput&&t.align===Os.Align$$module$build$src$core$inputs$align.LEFT&&e.align===Os.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof $d)return t.elements.push(new If(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let n;for(let t=0;t<e.elements.length;t++){const r=e.elements[t];if(ld.isSpacer(r)&&(n=r),ld.isField(r)&&r instanceof md&&r.parentInput===this.rightAlignedDummyInputs.get(e))break}if(n)return n.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let i=2;i<this.rows.length-1;i+=2){var n=this.rows[i-1];const o=this.rows[i];var r=this.rows[i+1];if(n=2===i?!!this.topRow.hasPreviousConnection:!!n.followsStatement,r=i+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement,ld.isInputRow(o)&&o.hasStatement){let n,r;o.measure(),t=o.width-(null!=(r=null==(n=o.getLastInput())?void 0:n.width)?r:0)+e}else if(n&&(2===i||r)&&ld.isInputRow(o)&&!o.hasStatement){r=o.xPos,n=null;for(let e=0;e<o.elements.length;e++){const i=o.elements[e];ld.isSpacer(i)&&(n=i),n&&(ld.isField(i)||ld.isInput(i))&&r<t&&!(ld.isField(i)&&i instanceof md&&(i.field instanceof Od||i.field instanceof wf))&&(n.width+=t-r),r+=i.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,n=0;n<this.rows.length;n++){const e=this.rows[n];e.yPos=t,t+=e.height}this.height=t,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(n),n=e.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(n),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=n,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=n,this.width+=n+e,this.widthWithChildren+=n+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var n=this.rows[t];if(!ld.isInputRow(n))continue;e=n.elements[n.elements.length-2];let r=this.getNegativeSpacing_(n.elements[1]),i=this.getNegativeSpacing_(e);e=r+i;const o=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<o&&(r=(e=this.width-o)/2,i=e/2),n.elements.unshift(new _d(this.constants_,-r)),n.elements.push(new _d(this.constants_,-i))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)n=this.rows[t],ld.isTopOrBottomRow(n)&&(n.elements[1].width-=e),n.width-=e,n.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var n=this.outputConnection.shape.type;const r=this.constants_;if(1<this.inputRows.length)return n===r.SHAPES.ROUND?(n=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(n=this.height/2>n?n:this.height/2)*(1-Math.sin(Math.acos((n-this.constants_.SMALL_PADDING)/n)))):0;if(ld.isInlineInput(e)&&e instanceof pd){const i=e.connectedBlock;return null==(e=i?i.pathObject.outputShapeType:e.shape.type)||i&&i.outputConnection&&(i.statementInputCount||i.nextConnection)||n===r.SHAPES.HEXAGONAL&&n!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][e]}return ld.isField(e)&&e instanceof md?n===r.SHAPES.ROUND&&e.field instanceof Mf?t-2.75*r.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][0]:ld.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let r=2;r<this.rows.length-1;r+=2){const i=this.rows[r-1],o=this.rows[r],s=this.rows[r+1];var e=2===r,t=r+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement;if(e?this.topRow.hasPreviousConnection:i.followsStatement){var n=o.elements[1];if(n=3===o.elements.length&&n instanceof md&&(n.field instanceof Od||n.field instanceof wf),!e&&n)i.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<o.elements.length;t++)if((n=o.elements[t])instanceof pd&&ld.isInlineInput(n)&&n.connectedBlock&&!n.connectedBlock.isShadow()&&40<=n.connectedBlock.getHeightWidth().height){e=!0;break}e&&(i.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.SMALL_PADDING)}}else i.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Lf=class extends Vd{constructor(e,t,n){super(e,t,n),this.markerCircle=null}showWithInputOutput(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput(e)}showWithInput_(e){this.showWithInputOutput(e)}showWithBlock_(e){const t=(e=e.getLocation()).getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle(e,t){let n,r;null==(n=this.markerCircle)||n.setAttribute("cx","".concat(e)),null==(r=this.markerCircle)||r.setAttribute("cy","".concat(t)),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=re(bl.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(bl.ANIMATE,e,this.markerCircle)}return this.markerSvg_}applyColour_(e){let t,n;if(super.applyColour_(e),null==(t=this.markerCircle)||t.setAttribute("fill",this.colour_),null==(n=this.markerCircle)||n.setAttribute("stroke",this.colour_),this.isCursor()){let t;e=this.colour_+";transparent;transparent;",null==(t=this.markerCircle)||t.firstElementChild.setAttribute("values",e)}}},Of=class extends Wd{constructor(e,t,n){super(e,t,n),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=n}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const n of this.outlines.values())n.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,re(bl.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,n;null==(t=this.outlines.get(e))||null==(n=t.parentNode)||n.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Nf=class extends ep{constructor(e){super(e)}makeConstants_(){return new Ef}makeRenderInfo_(e){return new Af(this,e)}makeDrawer_(e,t){return new Sf(e,t)}makeMarkerDrawer(e,t){return new Lf(e,this.getConstants(),t)}makePathObject(e,t){return new Of(e,t,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(e){return e.type!==Gc.INPUT_VALUE&&e.type!==Gc.OUTPUT_VALUE}getConnectionPreviewMethod(e,t,n){return t.type===Gc.OUTPUT_VALUE?e.isConnected()?Jd.PREVIEW_TYPE.REPLACEMENT_FADE:Jd.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,n)}};Mo("zelos",Nf);var Pf={};Pf.BottomRow=Cf,Pf.ConstantProvider=Ef,Pf.Drawer=Sf,Pf.MarkerSvg=Lf,Pf.PathObject=Of,Pf.RenderInfo=Af,Pf.Renderer=Nf,Pf.RightConnectionShape=kf,Pf.StatementInput=If,Pf.TopRow=Rf,ys();var Df={};Df.registerCleanup=rs,Df.registerCollapse=os,Df.registerCollapseExpandBlock=ms,Df.registerComment=ps,Df.registerDefaultOptions=ys,Df.registerDelete=vs,Df.registerDeleteAll=us,Df.registerDisable=gs,Df.registerDuplicate=ds,Df.registerExpand=ss,Df.registerHelp=_s,Df.registerInline=fs,Df.registerRedo=ns,Df.registerUndo=ts;var $f,Bf=class extends xf{constructor(e,t,n){super(Ih.SKIP_SETUP),this.clockwise=Bf.CLOCKWISE,this.offset=Bf.OFFSET,this.wrap=Bf.WRAP,this.round=Bf.ROUND,this.boundEvents=[],this.symbol_=this.gauge=this.line=null,e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case $f.COMPASS:this.clockwise=!0,this.offset=90;break;case $f.PROTRACTOR:this.clockwise=!1,this.offset=0}e.clockwise&&(this.clockwise=e.clockwise),e.offset&&(this.offset=e.offset),e.wrap&&(this.wrap=e.wrap),e.round&&(this.round=e.round)}initView(){super.initView(),this.symbol_=re(bl.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("\xb0")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph()}showEditor_(e){super.showEditor_(e,Za||Ya||Ka),e=this.dropdownCreate(),gr().appendChild(e),this.sourceBlock_ instanceof Cp&&_r(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),yr(this,this.dropdownDispose.bind(this)),this.updateGraph()}dropdownCreate(){const e=re(bl.SVG,{xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1",height:2*Bf.HALF+"px",width:2*Bf.HALF+"px"});e.style.touchAction="none";const t=re(bl.CIRCLE,{cx:Bf.HALF,cy:Bf.HALF,r:Bf.RADIUS,class:"blocklyAngleCircle"},e);this.gauge=re(bl.PATH,{class:"blocklyAngleGauge"},e),this.line=re(bl.LINE,{x1:Bf.HALF,y1:Bf.HALF,class:"blocklyAngleLine"},e);for(let n=0;360>n;n+=15)re(bl.LINE,{x1:Bf.HALF+Bf.RADIUS,y1:Bf.HALF,x2:Bf.HALF+Bf.RADIUS-(0===n%45?10:5),y2:Bf.HALF,class:"blocklyAngleMarks",transform:"rotate("+n+","+Bf.HALF+","+Bf.HALF+")"},e);return this.boundEvents.push(j(e,"click",this,this.hide)),this.boundEvents.push(j(t,"pointerdown",this,this.onMouseMove_,!0)),this.boundEvents.push(j(t,"pointermove",this,this.onMouseMove_,!0)),e}dropdownDispose(){for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.line=this.gauge=null}hide(){Rr(this),Gn()}onMouseMove_(e){var t=this.gauge.ownerSVGElement.getBoundingClientRect();const n=e.clientX-t.left-Bf.HALF;e=e.clientY-t.top-Bf.HALF,t=Math.atan(-e/n),isNaN(t)||(t=hr(t),0>n?t+=180:0<e&&(t+=360),t=this.clockwise?this.offset+360-t:360-(this.offset-t),this.displayMouseOrKeyboardValue(t))}displayMouseOrKeyboardValue(e){if(this.round&&(e=Math.round(e/this.round)*this.round),(e=this.wrapValue(e))!==this.value_){const t=this.value_;this.setEditorValue_(e,!1),this.sourceBlock_&&N()&&this.value_!==t&&k(new(B(Js))(this.sourceBlock_,this.name||null,t,this.value_))}}updateGraph(){if(this.gauge&&this.line){var e=Number(this.getText())+this.offset,t=ur(e%360);e=["M ",Bf.HALF,",",Bf.HALF];var n=Bf.HALF,r=Bf.HALF;if(!isNaN(t)){const i=Number(this.clockwise),o=ur(this.offset),s=Math.cos(o)*Bf.RADIUS,a=Math.sin(o)*-Bf.RADIUS;i&&(t=2*o-t),n+=Math.cos(t)*Bf.RADIUS,r-=Math.sin(t)*Bf.RADIUS,t=Math.abs(Math.floor((t-o)/Math.PI)%2),i&&(t=1-t),e.push(" l ",s,",",a," A ",Bf.RADIUS,",",Bf.RADIUS," 0 ",t," ",i," ",n,",",r," z")}this.gauge.setAttribute("d",e.join("")),this.line.setAttribute("x2","".concat(n)),this.line.setAttribute("y2","".concat(r))}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new kh;let n=0;switch(e.key){case"ArrowLeft":n=t.RTL?1:-1;break;case"ArrowRight":n=t.RTL?-1:1;break;case"ArrowDown":n=-1;break;case"ArrowUp":n=1}n&&(t=this.getValue(),this.displayMouseOrKeyboardValue(t+n*this.round),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue(e)}wrapValue(e){return 0>(e%=360)&&(e+=360),e>this.wrap&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};Bf.HALF=50,Bf.RADIUS=Bf.HALF-1,Bf.CLOCKWISE=!1,Bf.OFFSET=0,Bf.WRAP=360,Bf.ROUND=15,Ni("field_angle",Bf),Bf.prototype.DEFAULT_VALUE=0,ee("\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: 0.8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: 0.8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n"),function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"}($f||($f={}));var Ff={};Ff.FieldAngle=Bf,Ff.Mode=$f;var Uf=class extends Ih{constructor(e,t,n){super(Ih.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=Uf.CHECK_CHAR,e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Uf);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ie(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Uf.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return"string"===typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Uf.CHECK_CHAR="\u2713",Ni("field_checkbox",Uf),Uf.prototype.DEFAULT_VALUE=!1;var zf=class extends Ih{constructor(e,t,n){super(Ih.SKIP_SETUP),this.highlightedIndex=this.picker=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles=this.colours=null,this.columns=0,e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours=e.colourOptions),e.colourTitles&&(this.titles=e.colourTitles),e.columns&&(this.columns=e.columns)}initView(){this.size_=new Tl(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new kh;const t=this.getConstants();return e.isSimpleReporter()&&!(null==t||!t.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const e=this.getSourceBlock();if(!e)throw new kh;if(this.fieldGroup_){var t=this.borderRect_;if(!t)throw Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getValue())}}getSize(){let e;return null!=(e=this.getConstants())&&e.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const e=this.getSourceBlock();if(!e)throw new kh;e.applyColour()}updateSize_(e){var t=this.getConstants();this.isFullBlockField()?(e=2*(null!=e?e:0),t=t.FIELD_TEXT_HEIGHT):(e=t.FIELD_COLOUR_DEFAULT_WIDTH,t=t.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=t,this.size_.width=e,this.positionBorderRect_()}doClassValidation_(e){return"string"!==typeof e?null:Ti(e)}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours=e,t&&(this.titles=t),this}setColumns(e){return this.columns=e,this}showEditor_(){this.dropdownCreate(),gr().appendChild(this.picker),yr(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(e){null!==(e=(e=e.target)&&e.getAttribute("data-colour"))&&(this.setValue(e),Rr(this))}onKeyDown(e){let t=!0;var n;switch(e.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":(n=this.getHighlighted())&&null!==(n=n.getAttribute("data-colour"))&&this.setValue(n),Lr();break;default:t=!1}t&&e.stopPropagation()}moveHighlightBy(e,t){if(this.highlightedIndex){var n=this.colours||zf.COLOURS,r=this.columns||zf.COLUMNS,i=this.highlightedIndex%r,o=Math.floor(this.highlightedIndex/r);i+=e,o+=t,0>e?0>i&&0<o?(i=r-1,o--):0>i&&(i=0):0<e?i>r-1&&o<Math.floor(n.length/r)-1?(i=0,o++):i>r-1&&i--:0>t?0>o&&(o=0):0<t&&o>Math.floor(n.length/r)-1&&(o=Math.floor(n.length/r)-1),this.setHighlightedCell(this.picker.childNodes[o].childNodes[i],o*r+i)}}onMouseMove(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));null!==t&&t!==this.highlightedIndex&&this.setHighlightedCell(e,t)}onMouseEnter(){let e;null==(e=this.picker)||e.focus({preventScroll:!0})}onMouseLeave(){var e;null==(e=this.picker)||e.blur(),(e=this.getHighlighted())&&se(e,"blocklyColourHighlighted")}getHighlighted(){if(!this.highlightedIndex)return null;const e=this.columns||zf.COLUMNS,t=this.picker.childNodes[Math.floor(this.highlightedIndex/e)];return t?t.childNodes[this.highlightedIndex%e]:null}setHighlightedCell(e,t){const n=this.getHighlighted();n&&se(n,"blocklyColourHighlighted"),ie(e,"blocklyColourHighlighted"),this.highlightedIndex=t,(e=e.getAttribute("id"))&&this.picker&&Bn(this.picker,Qc.ACTIVEDESCENDANT,e)}dropdownCreate(){const e=this.columns||zf.COLUMNS,t=this.colours||zf.COLOURS,n=this.titles||zf.TITLES,r=this.getValue(),i=document.createElement("table");let o;i.className="blocklyColourTable",i.tabIndex=0,i.dir="ltr",$n(i,Zc.GRID),Bn(i,Qc.EXPANDED,!0),Bn(i,Qc.ROWCOUNT,Math.floor(t.length/e)),Bn(i,Qc.COLCOUNT,e);for(let s=0;s<t.length;s++){0===s%e&&(o=document.createElement("tr"),$n(o,Zc.ROW),i.appendChild(o));const a=document.createElement("td");o.appendChild(a),a.setAttribute("data-colour",t[s]),a.title=n[s]||t[s],a.id=x(),a.setAttribute("data-index","".concat(s)),$n(a,Zc.GRIDCELL),Bn(a,Qc.LABEL,t[s]),Bn(a,Qc.SELECTED,t[s]===r),a.style.backgroundColor=t[s],t[s]===r&&(a.className="blocklyColourSelected",this.highlightedIndex=s)}this.boundEvents.push(j(i,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(j(i,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(j(i,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(j(i,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(j(i,"keydown",this,this.onKeyDown,!1)),this.picker=i}dropdownDispose(){for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.highlightedIndex=this.picker=null}static fromJson(e){return new this(e.colour,void 0,e)}};zf.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),zf.TITLES=[],zf.COLUMNS=7,zf.prototype.DEFAULT_VALUE=zf.COLOURS[0],Ni("field_colour",zf),ee("\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n");var Hf=class extends Od{constructor(e,t,n){super(String(null!=e?e:""),t,n),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(ki(e.text),void 0,e)}};Ni("field_label_serializable",Hf);var Gf=class extends Mf{constructor(e,t,n){super(Ih.SKIP_SETUP),this.textGroup=null,this.maxLines_=1/0,this.isOverflowedY_=!1,e!==Ih.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,"\n"))}saveState(){const e=this.saveLegacyState(Gf);return null!==e?e:this.getValue()}loadState(e){this.loadLegacyState(Ih,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup=re(bl.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new kh;let t=this.getText();if(!t)return Ih.NBSP;const n=t.split("\n");t="";const r=this.isOverflowedY_?this.maxLines_:n.length;for(let i=0;i<r;i++){let e=n[i];e.length>this.maxDisplayLength?e=e.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&i===r-1&&(e=e.substring(0,e.length-3)+"..."),e=e.replace(/\s/g,Ih.NBSP),t+=e,i!==r-1&&(t+="\n")}return e.RTL&&(t+="\u200f"),t}doValueUpdate_(e){super.doValueUpdate_(e),null!==this.value_&&(this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_)}render_(){var e=this.getSourceBlock();if(!e)throw new kh;for(var t,n=this.textGroup;t=n.firstChild;)n.removeChild(t);t=this.getDisplayText_().split("\n");let r=0;for(let i=0;i<t.length;i++){const e=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;re(bl.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},n).appendChild(document.createTextNode(t[i])),r+=e}this.isBeingEdited_&&(n=this.htmlInput_,this.isOverflowedY_?ie(n,"blocklyHtmlTextAreaInputOverflowedY"):se(n,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(se(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!1)):(ie(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!0)))}updateSize_(){var e=this.textGroup.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,n=this.getConstants().FIELD_TEXT_FONTWEIGHT,r=this.getConstants().FIELD_TEXT_FONTFAMILY;let i=0,o=0;for(var s=0;s<e.length;s++){var a=me(e[s],t,n,r);a>i&&(i=a),o+=this.getConstants().FIELD_TEXT_HEIGHT+(0<s?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=String(this.value_).split("\n"),s=re(bl.TEXT,{class:"blocklyText blocklyMultilineText"}),a=0;a<e.length;a++){e[a].length>this.maxDisplayLength&&(e[a]=e[a].substring(0,this.maxDisplayLength)),s.textContent=e[a];const o=me(s,t,n,r);o>i&&(i=o)}i+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(o+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,i+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width","".concat(i)),this.borderRect_.setAttribute("height","".concat(o))),this.size_.width=i,this.size_.height=o,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=Fn(),t=this.workspace_.getScale(),n=document.createElement("textarea");n.className="blocklyHtmlInput blocklyHtmlTextAreaInput",n.setAttribute("spellcheck",String(this.spellcheck_));var r=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=r,n.style.fontSize=r,n.style.borderRadius=Mf.BORDERRADIUS*t+"px",r=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const i=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return n.style.padding=i+"px "+r+"px "+i+"px "+r+"px",r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n.style.lineHeight=r*t+"px",e.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),n.setAttribute("data-old-value",""),Xa?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(n),n}setMaxLines(e){"number"===typeof e&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){"Enter"!==e.key&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(ki(e.text),void 0,e)}};Ni("field_multilinetext",Gf),ee("\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n");var Vf=class extends xf{constructor(e,t,n,r,i,o){super(Ih.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==Ih.SKIP_SETUP&&(o?this.configure_(o):this.setConstraints(t,n,r),this.setValue(e),i&&this.setValidator(i))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);-1!==t.indexOf("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e?null:(e=(e=(e="".concat(e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e)?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e))}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&(e.min="".concat(this.min_),Bn(e,Qc.VALUEMIN,this.min_)),1/0>this.max_&&(e.max="".concat(this.max_),Bn(e,Qc.VALUEMAX,this.max_)),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Ni("field_number",Vf),Vf.prototype.DEFAULT_VALUE=0;var Wf=class extends Ph{constructor(e,t,n,r,i){super(Ih.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=Wf.dropdownCreate,this.defaultVariableName="string"===typeof e?e:"",this.size_=new Tl(0,0),e!==Ih.SKIP_SETUP&&(i?this.configure_(i):this.setTypes(n,r),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new kh;this.variable||(e=Os.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new kh;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new kh;const n=e.getAttribute("id"),r=e.textContent,i=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Os.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,n,r,i),null!==i&&i!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+Bt(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.name,this.variable.type&&e.setAttribute("variabletype",this.variable.type),e}saveState(e){var t=this.saveLegacyState(Wf);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.name,t.type=this.variable.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new kh;this.loadLegacyState(Wf,e)||(e=Os.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new kh;return(t=Os.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.type,this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new kh;this.variable=Os.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let n=0;n<t.length;n++)if(e===t[n])return!0;return!1}getVariableTypes(){var e=this.variableTypes;if(null===e&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(0===(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(Array.isArray(e)){let n=!1;for(let r=0;r<e.length;r++)e[r]===t&&(n=!0);if(!n)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===ju)return void Os.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===Xu)return void this.sourceBlock_.workspace.deleteVariableById(this.variable.getId())}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(ki(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var n=this.getVariableTypes(),r=0;r<n.length;r++){const e=this.sourceBlock_.workspace.getVariablesOfType(n[r]);t=t.concat(e)}for(t.sort(ic.compareByName),n=[],r=0;r<t.length;r++)n[r]=[t[r].name,t[r].getId()];return n.push([Os.Msg$$module$build$src$core$msg.RENAME_VARIABLE,ju]),Os.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&n.push([Os.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Xu]),n}};Ni("field_variable",Wf);var jf=class{constructor(e,t,n,r){this.workspace=e,this.targetWorkspace=t,this.isLabel_=r,this.onMouseUpWrapper=null,this.height=this.width=0,this.svgText=this.svgGroup=null,this.text=n.text,this.position=new cl(0,0),this.callbackKey=n.callbackKey||n.callbackkey,this.cssClass=n["web-class"]||null,this.info=n}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";let t;this.cssClass&&(e+=" "+this.cssClass),this.svgGroup=re(bl.G,{class:e},this.workspace.getCanvas()),this.isLabel_||(t=re(bl.RECT,{class:"blocklyFlyoutButtonShadow",rx:jf.BORDER_RADIUS,ry:jf.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=re(bl.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:jf.BORDER_RADIUS,ry:jf.BORDER_RADIUS},this.svgGroup);const n=re(bl.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var r=ki(this.text);this.workspace.RTL&&(r+="\u200f"),n.textContent=r,this.isLabel_&&(this.svgText=n,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const i=Te(n,"fontSize"),o=Te(n,"fontWeight"),s=Te(n,"fontFamily");if(this.width=ge(n,i,o,s),r=ve(r,i,o,s),this.height=r.height,!this.isLabel_){let e,n;this.width+=2*jf.TEXT_MARGIN_X,this.height+=2*jf.TEXT_MARGIN_Y,null==(e=t)||e.setAttribute("width",String(this.width)),null==(n=t)||n.setAttribute("height",String(this.height))}return e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),n.setAttribute("x",String(this.width/2)),n.setAttribute("y",String(this.height/2-r.height/2+r.baseline)),this.updateTransform(),this.onMouseUpWrapper=j(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&Y(this.onMouseUpWrapper),this.svgGroup&&le(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};jf.TEXT_MARGIN_X=5,jf.TEXT_MARGIN_Y=2,jf.BORDER_RADIUS=4,ee("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Xf,Yf=class extends rf{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,n){return t=n||this.getContentMetrics(),n=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*n)/e,width:(t.width+t.left+n)/e,top:0,left:0}}};!function(e){e.BLOCK="block",e.BUTTON="button"}(Xf||(Xf={}));var Kf=class extends Rp{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new fp(e),this.workspace_.setMetricsManager(new Yf(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=M(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=re(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=re(bl.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new nf(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(j(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(j(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[ol.Capability.AUTOHIDEABLE,ol.Capability.DELETE_AREA,ol.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&le(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,n,r){let i,o;null==(i=this.svgGroup_)||i.setAttribute("width","".concat(e)),null==(o=this.svgGroup_)||o.setAttribute("height","".concat(t)),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&he(this.svgGroup_,"translate("+n+"px,"+r+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(n,r),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const e of this.listeners)Y(e);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"===typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=Be(e),e=this.createFlyoutInfo(e),wt(this.workspace_),this.layout_(e.contents,e.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(e){const t=[],n=[];this.permanentlyDisabled.length=0;const r=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const i of e){if("custom"in i){e=this.getDynamicCategoryContents(i.custom),e=Be(e);const{contents:r,gaps:o}=this.createFlyoutInfo(e);t.push(...r),n.push(...o)}switch(i.kind.toUpperCase()){case"BLOCK":e=i;const o=this.createFlyoutBlock(e);t.push({type:Xf.BLOCK,block:o}),this.addBlockGap(e,n,r);break;case"SEP":this.addSeparatorGap(i,n,r);break;case"LABEL":e=this.createButton(i,!0),t.push({type:Xf.BUTTON,button:e}),n.push(r);break;case"BUTTON":e=this.createButton(i,!1),t.push({type:Xf.BUTTON,button:e}),n.push(r)}}return{contents:t,gaps:n}}getDynamicCategoryContents(e){if("function"!==typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton(e,t){return new jf(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock(e){let t;return e.blockxml?(e="string"===typeof e.blockxml?Os.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,(t=this.getRecycledBlock(e.getAttribute("type")))||(t=Ht(e,this.workspace_))):(t=this.getRecycledBlock(e.type),t||(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),t=gn(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled.push(t),t}getRecycledBlock(e){let t=-1;for(let n=0;n<this.recycledBlocks.length;n++)if(this.recycledBlocks[n].type===e){t=n;break}return-1===t?void 0:this.recycledBlocks.splice(t,1)[0]}addBlockGap(e,t,n){let r;e.gap?r=parseInt(String(e.gap)):e.blockxml&&(e="string"===typeof e.blockxml?Os.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,r=parseInt(e.getAttribute("gap"))),t.push(!r||isNaN(r)?n:r)}addSeparatorGap(e,t,n){e=parseInt(String(e.gap)),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(n)}clearOldBlocks(){var e=this.workspace_.getTopBlocks(!1);for(let n,r=0;n=e[r];r++)this.blockIsRecyclable_(n)?this.recycleBlock(n):n.dispose(!1,!1);for(e=0;e<this.mats.length;e++){const t=this.mats[e];t&&(ri(t),le(t))}this.mats.length=0;for(let n,r=0;n=this.buttons_[r];r++)n.dispose();let t;this.buttons_.length=0,null==(t=this.workspace_.getPotentialVariableMap())||t.clear()}emptyRecycledBlocks(){for(let e=0;e<this.recycledBlocks.length;e++)this.recycledBlocks[e].dispose();this.recycledBlocks=[]}blockIsRecyclable_(e){return!1}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks.push(e)}addBlockListeners_(e,t,n){this.listeners.push(j(e,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(j(n,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(X(e,"pointerenter",t,t.addSelect)),this.listeners.push(X(e,"pointerleave",t,t.removeSelect)),this.listeners.push(X(n,"pointerenter",t,t.addSelect)),this.listeners.push(X(n,"pointerleave",t,t.removeSelect))}blockMouseDown(e){return t=>{const n=this.targetWorkspace.getGesture(t);n&&(n.setStartBlock(e),n.handleFlyoutStart(t,this))}}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Os.disable$$module$build$src$core$events$utils();var n=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{Os.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=bt(this.targetWorkspace,n),N()){for(Os.setGroup$$module$build$src$core$events$utils(!0),n=0;n<e.length;n++){const t=e[n];k(new(B(Zs))(t))}k(new(B(Os.CREATE$$module$build$src$core$events$utils))(t))}return this.autoClose?this.hide():this.filterForCapacity(),t}initFlyoutButton_(e,t,n){const r=e.createDom();e.moveTo(t,n),e.show(),this.listeners.push(j(r,"pointerdown",this,this.onMouseDown)),this.buttons_.push(e)}createRect_(e,t,n,r,i){return(t=re(bl.RECT,{"fill-opacity":0,x:t,y:n,height:r.height,width:r.width})).tooltip=e,ni(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats[i]=t}moveRectToBlock_(e,t){const n=t.getHeightWidth();e.setAttribute("width",String(n.width)),e.setAttribute("height",String(n.height)),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",String(t.y)),e.setAttribute("x",String(this.RTL?t.x-n.width:t.x))}filterForCapacity(){const e=this.workspace_.getTopBlocks(!1);for(let t,n=0;t=e[n];n++)if(-1===this.permanentlyDisabled.indexOf(t)){const e=this.targetWorkspace.isCapacityAvailable(T(t));for(;t;)t.setEnabled(e),t=t.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const n=sn(e);return t.setResizesEnabled(!1),t=mn(n,t),this.positionNewBlock(e,t),t}positionNewBlock(e,t){const n=this.targetWorkspace;var r=n.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),i=cl.sum(i,e),(r=cl.difference(i,r)).scale(1/n.scale),t.moveTo(new cl(r.x,r.y))}};Kf.FlyoutItemType=Xf;var qf=class extends Kf{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),r=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"===typeof e.x&&(this.workspace_.scrollX=-(n.left+(n.width-r.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();e=e.getToolboxMetrics();const r=this.toolboxPosition_===Dl.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?r?e.height:n.height-this.height_:r?0:n.height:r?0:n.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Dl.TOP,r=["M 0,"+(n?0:this.CORNER_RADIUS)];n?(r.push("h",e+2*this.CORNER_RADIUS),r.push("v",t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",-e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),r.push("h",e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",t),r.push("h",-e-2*this.CORNER_RADIUS)),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=Z(e);if(t=t.x||t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let r;t=e.getViewMetrics().left-n.left+t,null==(r=this.workspace_.scrollbar)||r.setX(t),Gn(),Lr()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const n=this.MARGIN;let r=n+this.tabWidth_;this.RTL&&(e=e.reverse());for(let a,l=0;a=e[l];l++)if("block"===a.type){var i=a.block,o=i.getDescendants(!1);for(let t,n=0;t=o[n];n++)t.isInFlyout=!0;o=i.getSvgRoot();const e=i.getHeightWidth();var s=i.outputConnection?this.tabWidth_:0;s=this.RTL?r+e.width:r-s,i.moveBy(s,n),s=this.createRect_(i,s,n,e,l),r+=e.width+t[l],this.addBlockListeners_(o,i,s)}else"button"===a.type&&(i=a.button,this.initFlyoutButton_(i,r,n),r+=i.width+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Dl.TOP?new yl(-1e9,t+e.height,-1e9,1e9):new yl(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(!1);for(let r,i=0;r=t[i];i++)e=Math.max(e,r.getHeightWidth().height);const n=this.buttons_;for(let r,i=0;r=n[i];i++)e=Math.max(e,r.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Cl.scrollbarThickness,this.height_!==e){for(let e,n=0;e=t[n];n++)this.rectMap_.has(e)&&this.moveRectToBlock_(this.rectMap_.get(e),e);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Dl.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};e(Bs.FLYOUTS_HORIZONTAL_TOOLBOX,$s,qf);var Jf=class extends Kf{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),r=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"===typeof e.y&&(this.workspace_.scrollY=-(n.top+(n.height-r.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Dl.LEFT?e.width:n.width-this.width_:this.toolboxPosition_===Dl.LEFT?0:n.width:this.toolboxPosition_===Dl.LEFT?0:n.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Dl.RIGHT;var r=e+this.CORNER_RADIUS;(r=["M "+(n?r:0)+",0"]).push("h",n?-e:e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",Math.max(0,t)),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",n?e:-e),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=Z(e);if(t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let r;t=e.getViewMetrics().top-n.top+t.y,null==(r=this.workspace_.scrollbar)||r.setY(t),Gn(),Lr()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var n=this.MARGIN;const r=this.RTL?n:n+this.tabWidth_;for(let a,l=0;a=e[l];l++)if("block"===a.type){var i=a.block,o=i.getDescendants(!1);for(let t,n=0;t=o[n];n++)t.isInFlyout=!0;o=i.getSvgRoot();const e=i.getHeightWidth();var s=i.outputConnection?r-this.tabWidth_:r;i.moveBy(s,n),s=this.createRect_(i,this.RTL?s-e.width:s,n,e,l),this.addBlockListeners_(o,i,s),n+=e.height+t[l]}else"button"===a.type&&(i=a.button,this.initFlyoutButton_(i,r,n),n+=i.height+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Dl.LEFT?new yl(-1e9,1e9,-1e9,t+e.width):new yl(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(!1);for(let r,i=0;r=t[i];i++){var n=r.getHeightWidth().width;r.outputConnection&&(n-=this.tabWidth_),e=Math.max(e,n)}for(let r,i=0;r=this.buttons_[i];i++)e=Math.max(e,r.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Cl.scrollbarThickness,this.width_!==e){for(let r,i=0;r=t[i];i++){if(this.RTL){n=r.getRelativeToSurfaceXY().x;let t=e/this.workspace_.scale-this.MARGIN;r.outputConnection||(t-=this.tabWidth_),r.moveBy(t-n,0)}this.rectMap_.has(r)&&this.moveRectToBlock_(this.rectMap_.get(r),r)}if(this.RTL)for(let n,r=0;n=this.buttons_[r];r++)t=n.getPosition().y,n.moveTo(e/this.workspace_.scale-n.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Dl.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Jf.registryName="verticalFlyout",e(Bs.FLYOUTS_VERTICAL_TOOLBOX,$s,Jf),Os.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=f());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let n,r=0;n=e[r];r++){let e=this.blockToCode(n);Array.isArray(e)&&(e=e[0]),e&&(n.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,n)+e),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,n))),t.push(e))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let n=0;n<e.length;n++){const r=e[n].getCommentText();r&&t.push(r)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var n=this.forBlock[e.type];if(!n&&this[e.type]&&(ne("block generator functions on CodeGenerator objects","10.0","11.0","the .forBlock[blockType] dictionary"),n=this[e.type]),"function"!==typeof n)throw Error("".concat(this.name_," generator does not know how to generate code ")+'for block type "'.concat(e.type,'".'));if(n=n.call(e,e,this),Array.isArray(n)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,n[0],t),n[1]]}if("string"===typeof n)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,e)+n),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,n,t);if(null===n)return"";throw SyntaxError("Invalid code generated: "+n)}valueToCode(e,t,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+e.type);var r=e.getInputTargetBlock(t);if(!r)return"";if(""===(t=this.blockToCode(r)))return"";if(!Array.isArray(t))throw TypeError("Expecting tuple from value block: ".concat(r.type," See ")+"developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information");if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+r.type);if(!e)return"";r=!1;var i=Math.floor(n);const o=Math.floor(t);if(i<=o&&(i!==o||0!==i&&99!==i))for(r=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]===n&&this.ORDER_OVERRIDES[i][1]===t){r=!1;break}return r&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),"string"!==typeof(t=this.blockToCode(e)))throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const n=this.nameDB_.getDistinctName(e,Os.NameType$$module$build$src$core$names.PROCEDURE);let r;for(this.functionNames_[e]=n,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);r!==t;)r=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,Os.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,Os.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,n){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Os.CodeGenerator$$module$build$src$core$generator;var Zf=!1,Qf={};Qf.Align=Os.Align$$module$build$src$core$inputs$align,Qf.DummyInput=Pd,Qf.EndRowInput=Dd,Qf.Input=Nd,Qf.StatementInput=$d,Qf.ValueInput=Os.ValueInput$$module$build$src$core$inputs$value_input,Qf.inputTypes=Os.inputTypes$$module$build$src$core$inputs$input_types;var em=class extends Rd{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat(["".concat(e," .blocklyInsertionMarker>.blocklyPathLight,"),"".concat(e," .blocklyInsertionMarker>.blocklyPathDark {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"])}},tm=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=ro(e.xPos,this.info_.startY);for(let t,n=0;t=e.elements[n];n++)ld.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:ld.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):ld.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:ld.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):ld.isSpacer(t)&&0!==t.width&&(this.steps_+=so("H",t.xPos+t.width-this.highlightOffset));this.steps_+=so("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+so("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const n=e.height-t.connectionHeight;this.steps_+=no(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+so("v",n)}else this.steps_+=no(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const n=e.height-2*this.insideCornerPaths_.height;this.steps_+=no(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+so("v",n)+this.insideCornerPaths_.pathBottom(this.RTL_)+io(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=no(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+io(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof Cd&&e.followsStatement&&(this.steps_+=so("H",t)),this.RTL_&&(this.steps_+=so("H",t),e.height>this.highlightOffset&&(this.steps_+=so("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=so("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];ld.isLeftSquareCorner(t)?this.steps_+=no(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):ld.isLeftRoundedCorner(t)&&(this.steps_+=no(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=no(this.info_.startX,e):(this.steps_+=no(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=so("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,ld.isLeftRoundedCorner(e.elements[0])?this.steps_+=so("V",this.outsideCornerPaths_.height):this.steps_+=so("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,n=e.xPos+e.connectionWidth;var r=e.centerline-e.height/2;const i=e.width-e.connectionWidth,o=r+t;this.RTL_?(r=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=no(n-t,o)+so("v",r)+this.puzzleTabPaths_.pathDown(this.RTL_)+so("v",e)+so("h",i)):this.inlineSteps_+=no(e.xPos+e.width+t,o)+so("v",e.height)+so("h",-i)+no(n,r+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},nm=class extends Ld{constructor(e,t){super(e,t),this.highlighter_=new tm(t)}draw(){this.drawOutline_(),this.drawInternals_();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=so("H",e.xPos+e.width)+so("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(n,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},rm=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=ro(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e+t)-t,r=ro(n,n)+ao("a","0 0,0",e,eo(-n-t,e-n)),i=ao("a","0 0,0",e+t,eo(e+t,e+t)),o=ro(n,-n)+ao("a","0 0,0",e+t,eo(e-n,n+t));return{width:e+t,height:e,pathTop:e=>e?r:"",pathBottom:e=>e?i:o}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e-t)+t,r=ro(n,n)+ao("a","0 0,1",e-t,eo(e-n,-n+t)),i=ro(t,e)+ao("a","0 0,1",e-t,eo(e,-e+t)),o=-n,s=ro(n,o)+ao("a","0 0,1",e-t,eo(-n+t,-o-e));return{height:e,topLeft:e=>e?r:i,bottomLeft:()=>s}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,n=ro(-2,3.4-t)+io(-.45*e,-2.1),r=so("v",2.5)+ro(.97*-e,2.5)+to("q",[eo(.05*-e,10),eo(.3*e,9.5)])+ro(.67*e,-1.9)+so("v",2.5),i=so("v",-1.5)+ro(-.92*e,-.5)+to("q",[eo(-.19*e,-5.5),eo(0,-11)])+ro(.92*e,1),o=ro(-5,t-.7)+io(.46*e,-2.1);return{width:e,height:t,pathUp:e=>e?n:i,pathDown:e=>e?r:o}}makeNotch(){return{pathLeft:so("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:io(5.1,2.6)+ro(-10.2,6.8)+io(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=ro(25,-8.7)+to("c",[eo(29.7,-6.2),eo(57.2,-.5),eo(75,8.7)]),n=to("c",[eo(17.8,-9.2),eo(45.3,-14.9),eo(75,-8.7)])+no(100.5,e+.5);return{path:e=>e?t:n}}},im=class extends bd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},om=class extends yd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},sm=class extends Bd{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof $d||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new im(this.constants_,e)),t.hasInlineInput=!0):e instanceof $d?(t.elements.push(new om(this.constants_,e)),t.hasStatement=!0):e instanceof Os.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new fd(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Pd||e instanceof Dd)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let n,r=0;n=this.rows[r];r++)n.hasExternalInput&&(e=!0);for(let n,r=0;n=this.rows[r];r++){var t=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let e=0;e<t.length-1;e++){n.elements.push(t[e]);const r=this.getInRowSpacing_(t[e],t[e+1]);n.elements.push(new _d(this.constants_,r))}n.elements.push(t[t.length-1]),n.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&n.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),n.elements.push(new _d(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&ld.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ld.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ld.isInput(e)&&(!t||ld.isStatementInput(t)))return ld.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:ld.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ld.isHat(e)?this.constants_.NO_PADDING:ld.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ld.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ld.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}if(!ld.isInput(e)&&t&&ld.isInput(t)){if(ld.isField(e)&&e.isEditable){if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ld.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ld.isIcon(e)&&t&&!ld.isInput(t))return this.constants_.LARGE_PADDING;if(ld.isInlineInput(e)&&t&&ld.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ld.isLeftSquareCorner(e)&&t){if(ld.isHat(t))return this.constants_.NO_PADDING;if(ld.isPreviousConnection(t))return t.notchOffset;if(ld.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(ld.isLeftRoundedCorner(e)&&t){if(ld.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(ld.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return ld.isField(e)&&t&&ld.isField(t)&&e.isEditable===t.isEditable||t&&ld.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ld.isTopRow(e)&&ld.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ld.isTopRow(e)||ld.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ld.isSpacer(t))return e.yPos+t.height/2;if(ld.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ld.isTopRow(e))return ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ld.isField(t)||ld.isIcon(t)?(n+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(n+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):n=ld.isInlineInput(t)?n+t.height/2:n+e.height/2,n}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,n=null;for(let r,i=this.rows.length-1;r=this.rows[i];i--)t.set(r,e),ld.isInputRow(r)&&(r.hasStatement&&this.alignStatementRow_(r),n&&n.hasStatement&&r.width<n.width?t.set(r,n.width):e=r.hasStatement?r.width:Math.max(e,r.width),n=r);e=0;for(let r,i=0;r=this.rows[i];i++)r.hasStatement?e=this.getDesiredRowWidth_(r):ld.isSpacer(r)?r.width=Math.max(e,t.get(r)):(n=r.width,0<(e=Math.max(e,t.get(r))-n)&&this.addAlignmentPadding_(r,e),e=r.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let r,i=0;r=this.rows[i];i++){r.yPos=t,r.xPos=this.startX,t+=r.height,e=Math.max(e,r.widthWithConnectedBlocks);var n=t-this.topRow.ascenderHeight;r===this.bottomRow&&n<this.constants_.MIN_BLOCK_HEIGHT&&(n=this.constants_.MIN_BLOCK_HEIGHT-n,this.bottomRow.height+=n,t+=n),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},am=class extends Wd{constructor(e,t,n){super(e,t,n),this.constants=n,this.colourDark="#000000",this.svgPathDark=re(bl.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=re(bl.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=xi("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},lm=class extends ep{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new em}makeRenderInfo_(e){return new sm(this,e)}makeDrawer_(e,t){return new nm(e,t)}makePathObject(e,t){return new am(e,t,this.getConstants())}makeHighlightConstants_(){return new rm(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};Mo("geras",lm);var cm={};cm.ConstantProvider=em,cm.Drawer=nm,cm.HighlightConstantProvider=rm,cm.Highlighter=tm,cm.InlineInput=im,cm.PathObject=am,cm.RenderInfo=sm,cm.Renderer=lm,cm.StatementInput=om;var um=class extends Rd{constructor(){super(),ne("Blockly.minimalist.ConstantProvider","v10","v11","Blockly.blockRendering.ConstantProvider")}},hm=class extends Ld{constructor(e,t){super(e,t),ne("Blockly.minimalist.Drawer","v10","v11","Blockly.blockRendering.Drawer")}},dm=class extends Bd{constructor(e,t){super(e,t),ne("Blockly.minimalist.RenderInfo","v10","v11","Blockly.blockRendering.RenderInfo")}getRenderer(){return this.renderer_}},pm=class extends ep{constructor(e){super(e),ne("Blockly.minimalist.Renderer","v10","v11","Blockly.blockRendering.Renderer")}makeConstants_(){return new um}makeRenderInfo_(e){return new dm(this,e)}makeDrawer_(e,t){return new hm(e,t)}};Mo("minimalist",pm);var fm={};fm.ConstantProvider=um,fm.Drawer=hm,fm.RenderInfo=dm,fm.Renderer=pm;var mm=class extends Bd{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const r=this.rows[t];var n=r.elements;if(r.elements=[],r.startsWithElemSpacer()&&r.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){r.elements.push(n[e]);const t=this.getInRowSpacing_(n[e],n[e+1]);r.elements.push(new _d(this.constants_,t))}r.elements.push(n[n.length-1]),r.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&r.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),r.elements.push(new _d(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&ld.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ld.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ld.isInput(e)&&!t)return ld.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:ld.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ld.isHat(e)?this.constants_.NO_PADDING:ld.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ld.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ld.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}if(!ld.isInput(e)&&t&&ld.isInput(t)){if(ld.isField(e)&&e.isEditable){if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ld.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ld.isIcon(e)&&t&&!ld.isInput(t))return this.constants_.LARGE_PADDING;if(ld.isInlineInput(e)&&t&&ld.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ld.isLeftSquareCorner(e)&&t){if(ld.isHat(t))return this.constants_.NO_PADDING;if(ld.isPreviousConnection(t)||ld.isNextConnection(t))return t.notchOffset}return ld.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:ld.isField(e)&&t&&ld.isField(t)&&e.isEditable===t.isEditable||t&&ld.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ld.isTopRow(e)&&ld.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ld.isTopRow(e)||ld.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ld.isSpacer(t))return e.yPos+t.height/2;if(ld.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ld.isTopRow(e))return ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ld.isField(t)&&e.hasStatement?n+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):n+e.height/2}finalize_(){let e=0,t=0;for(var n=0;n<this.rows.length;n++){const i=this.rows[n];i.yPos=t,i.xPos=this.startX,t+=i.height,e=Math.max(e,i.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;i===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(i)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},gm=class extends ep{constructor(e){super(e)}makeRenderInfo_(e){return new mm(this,e)}};Mo("thrasos",gm);var vm={};vm.RenderInfo=mm,vm.Renderer=gm;var _m=new bh("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),bm={Classic:yh,Zelos:_m},ym=class{constructor(e,t,n){this.id_=e.toolboxitemid||x(),this.level_=(this.parent_=n||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}},Tm=class extends ym{constructor(e,t,n){super(e,t,n),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(n)}}parseCategoryDef_(e){this.name_="name"in e?ki(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),$n(this.htmlDiv_,Zc.TREEITEM),Bn(this.htmlDiv_,Qc.SELECTED,!1),Bn(this.htmlDiv_,Qc.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),$n(this.iconDom_,Zc.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Bn(this.htmlDiv_,Qc.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ie(e,t),t="".concat(Tm.nestedPadding*this.getLevel(),"px"),this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ie(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ie(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Tm.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(null==(e=ki(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=Ti(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Mi(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&oe(e,t),(t=this.cssConfig_.openicon)&&ie(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&oe(e,t),(t=this.cssConfig_.closedicon)&&ie(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const e=this.parseColour_(Tm.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,t&&ie(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&se(this.rowDiv_,t);Bn(this.htmlDiv_,Qc.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled","".concat(e)),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"===typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Be(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){le(this.htmlDiv_)}};Tm.registrationName="category",Tm.nestedPadding=19,Tm.borderWidth=8,Tm.defaultBackgroundColour="#57e",ee('\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n'),e(Bs.TOOLBOX_ITEM,Tm.registrationName,Tm);var Em=class extends ym{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){le(this.htmlDiv_)}};Em.registrationName="sep",ee('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),e(Bs.TOOLBOX_ITEM,Em.registrationName,Em);var Sm=class extends Tm{constructor(e,t,n){super(e,t,n),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let n=0;n<t.length;n++){const r=t[n];!o(Bs.TOOLBOX_ITEM,r.kind)||r.kind.toLowerCase()===Em.registrationName&&e?(this.flyoutItems_.push(r),e=!0):(this.createToolboxItem_(r),e=!1)}}}}createToolboxItem_(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&ze(e)&&(t=Sm.registrationName),e=new(s(Bs.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),$n(this.subcategoriesDiv_,Zc.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Bn(this.htmlDiv_,Qc.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var n=this.cssConfig_.contents;for(n&&ie(t,n),n=0;n<e.length;n++){const r=e[n];r.init();const i=r.getDiv();if(t.appendChild(i),r.getClickTarget){let e;null==(e=r.getClickTarget())||e.setAttribute("id",r.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let e;null==(e=this.parentToolbox_.getFlyout())||e.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Bn(this.htmlDiv_,Qc.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let n=0;n<t.length;n++)t[n].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Sm.registrationName="collapsibleCategory",e(Bs.TOOLBOX_ITEM,Sm.registrationName,Sm);var wm=class extends Rp{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),ce(this.flyout_.createDom("svg"),t),this.setVisible(!0),this.flyout_.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[ol.Capability.AUTOHIDEABLE,ol.Capability.DELETE_AREA,ol.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,$n(this.contentsDiv_,Zc.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ie(e,"blocklyToolboxDiv"),ie(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ie(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=j(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=j(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(q(e)||e.target===this.HtmlDiv)f().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),f().hideChaff(!0)}H()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext_();break;case"ArrowUp":t=this.selectPrevious_();break;case"ArrowLeft":t=this.selectParent_();break;case"ArrowRight":t=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new Th({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?c(Bs.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):c(Bs.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const e=this.contents_[t];e&&e.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let n=0;n<e.length;n++)this.createToolboxItem_(e[n],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var n=e.kind;"CATEGORY"===n.toUpperCase()&&ze(e)&&(n=Sm.registrationName),(n=s(Bs.TOOLBOX_ITEM,n.toLowerCase()))&&((e=new n(e,this)).init(),this.addToolboxItem_(e),(n=e.getDiv())&&t.appendChild(n),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&ie(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&se(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,n=t+e.height,r=e.left;return e=r+e.width,this.toolboxPosition===Dl.TOP?new yl(-1e7,n,-1e7,1e7):this.toolboxPosition===Dl.BOTTOM?new yl(t,1e7,-1e7,1e7):this.toolboxPosition===Dl.LEFT?new yl(-1e7,1e7,-1e7,e):new yl(-1e7,1e7,r,1e7)}wouldDelete(e,t){return e instanceof Cp?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Dl.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Dl.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===Dl.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===Dl.TOP?e.scrollY+t.height:e.scrollY),y(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Rs(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),Bn(this.contentsDiv_,Qc.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Bn(this.contentsDiv_,Qc.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e]).isSelectable()&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const n=e&&e.getName();let r=t&&t.getName();e===t&&(r=null),e=new(B(la))(n,r,this.workspace_.id),k(e)}selectParent_(){return!!this.selectedItem_&&(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):!(!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable())&&(this.setSelectedItem(this.selectedItem_.getParent()),!0))}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)Y(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),le(this.HtmlDiv))}};ee('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n'),e(Bs.TOOLBOX,$s,wm);var xm="10.3.1",Mm=Os.Align$$module$build$src$core$inputs$align.LEFT,Cm=Os.Align$$module$build$src$core$inputs$align.CENTRE,Im=Os.Align$$module$build$src$core$inputs$align.RIGHT,km=Gc.INPUT_VALUE,Rm=Gc.OUTPUT_VALUE,Am=Gc.NEXT_STATEMENT,Lm=Gc.PREVIOUS_STATEMENT,Om=Os.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,Nm=Dl.TOP,Pm=Dl.BOTTOM,Dm=Dl.LEFT,$m=Dl.RIGHT;cp.prototype.newBlock=function(e,t){return new _p(this,e,t)},fp.prototype.newBlock=function(e,t){return new Cp(this,e,t)},fp.newTrashcan=function(e){return new Ap(e)},gc.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(lr(this)),t.push(ar(this))),er(e,t,this.RTL)}},zh.prototype.newWorkspaceSvg=function(e){return new fp(e)},Os.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=uo(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Os.Names$$module$build$src$core$names.NameType.PROCEDURE)};var Bm=Gc,Fm={ALIGN_CENTRE:Cm,ALIGN_LEFT:Mm,ALIGN_RIGHT:Im};return Fm.ASTNode=Fd,Fm.BasicCursor=Tp,Fm.Block=_p,Fm.BlockDragger=lf,Fm.BlockSvg=Cp,Fm.Blocks=Hs,Fm.Bubble=Bh,Fm.BubbleDragger=Hu,Fm.COLLAPSED_FIELD_NAME=Yd,Fm.COLLAPSED_INPUT_NAME=Xd,Fm.COLLAPSE_CHARS=Gu,Fm.CodeGenerator=Os.CodeGenerator$$module$build$src$core$generator,Fm.CollapsibleToolboxCategory=Sm,Fm.ComponentManager=ol,Fm.Connection=jd,Fm.ConnectionChecker=op,Fm.ConnectionDB=Wc,Fm.ConnectionType=Gc,Fm.ContextMenu=mu,Fm.ContextMenuItems=Df,Fm.ContextMenuRegistry=gu,Fm.Css=ll,Fm.Cursor=yp,Fm.DELETE_VARIABLE_ID=Xu,Fm.DRAG_STACK=Vu,Fm.DUMMY_INPUT=Om,Fm.DeleteArea=Rp,Fm.DragTarget=kp,Fm.DropDownDiv=Du,Fm.Events=Tf,Fm.Extensions=Wh,Fm.Field=Ih,Fm.FieldAngle=Bf,Fm.FieldCheckbox=Uf,Fm.FieldColour=zf,Fm.FieldDropdown=Ph,Fm.FieldImage=wf,Fm.FieldLabel=Od,Fm.FieldLabelSerializable=Hf,Fm.FieldMultilineInput=Gf,Fm.FieldNumber=Vf,Fm.FieldTextInput=Mf,Fm.FieldVariable=Wf,Fm.Flyout=Kf,Fm.FlyoutButton=jf,Fm.FlyoutMetricsManager=Yf,Fm.Generator=Os.CodeGenerator$$module$build$src$core$generator,Fm.Gesture=mh,Fm.Grid=gh,Fm.HorizontalFlyout=qf,Fm.INPUT_VALUE=km,Fm.Input=Nd,Fm.InsertionMarkerManager=Jd,Fm.Marker=bp,Fm.MarkerManager=vh,Fm.Menu=iu,Fm.MenuItem=ou,Fm.MetricsManager=rf,Fm.Msg=Os.Msg$$module$build$src$core$msg,Fm.NEXT_STATEMENT=Am,Fm.Names=Os.Names$$module$build$src$core$names,Fm.OPPOSITE_TYPE=Wu,Fm.OUTPUT_VALUE=Rm,Fm.Options=Th,Fm.PREVIOUS_STATEMENT=Lm,Fm.PROCEDURE_CATEGORY_NAME=od,Fm.Procedures=sd,Fm.RENAME_VARIABLE_ID=ju,Fm.RenderedConnection=wp,Fm.Scrollbar=Cl,Fm.ScrollbarPair=nf,Fm.ShortcutItems=Kp,Fm.ShortcutRegistry=jp,Fm.TOOLBOX_AT_BOTTOM=Pm,Fm.TOOLBOX_AT_LEFT=Dm,Fm.TOOLBOX_AT_RIGHT=$m,Fm.TOOLBOX_AT_TOP=Nm,Fm.TabNavigateCursor=Ep,Fm.Theme=bh,Fm.ThemeManager=np,Fm.Themes=bm,Fm.Toolbox=wm,Fm.ToolboxCategory=Tm,Fm.ToolboxItem=ym,Fm.ToolboxSeparator=Em,Fm.Tooltip=hh,Fm.Touch=Wa,Fm.Trashcan=Ap,Fm.UnattachedFieldError=kh,Fm.VARIABLE_CATEGORY_NAME=oc,Fm.VARIABLE_DYNAMIC_CATEGORY_NAME=rp,Fm.VERSION=xm,Fm.VariableMap=lp,Fm.VariableModel=ic,Fm.Variables=lc,Fm.VariablesDynamic=ip,Fm.VerticalFlyout=Jf,Fm.WidgetDiv=hu,Fm.Workspace=cp,Fm.WorkspaceAudio=hp,Fm.WorkspaceComment=cc,Fm.WorkspaceCommentSvg=gc,Fm.WorkspaceDragger=dh,Fm.WorkspaceSvg=fp,Fm.Xml=Sc,Fm.ZoomControls=jl,Fm.blockAnimations=Fu,Fm.blockRendering=tp,Fm.browserEvents=nl,Fm.bubbles=cf,Fm.bumpObjects=af,Fm.clipboard=Jc,Fm.common=Xs,Fm.config=Os.config$$module$build$src$core$config,Fm.connectionTypes=Bm,Fm.constants=Kd,Fm.defineBlocksWithJsonArray=S,Fm.dialog=ec,Fm.fieldRegistry=Nh,Fm.geras=cm,Fm.getMainWorkspace=f,Fm.getSelected=g,Fm.hasBubble=gi,Fm.hideChaff=As,Fm.icons=ad,Fm.inject=Ts,Fm.inputTypes=Os.inputTypes$$module$build$src$core$inputs$input_types,Fm.inputs=Qf,Fm.isCopyable=Po,Fm.isIcon=Is,Fm.isObservable=Oi,Fm.isPaster=ks,Fm.isSerializable=nn,Fm.isVariableBackedParameterModel=nt,Fm.minimalist=fm,Fm.procedures=sd,Fm.registry=Fs,Fm.renderManagement=Ec,Fm.serialization=tf,Fm.setLocale=Yl,Fm.setParentContainer=b,Fm.svgResize=y,Fm.thrasos=vm,Fm.uiPosition=Vl,Fm.utils=Xh,Fm.zelos=Pf,Object.defineProperties(Fm,{HSV_SATURATION:{get:function(){return ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.getHsvSaturation()"),vi()},set:function(e){ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.setHsvSaturation()"),_i(e)}},HSV_VALUE:{get:function(){return ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.getHsvValue()"),bi()},set:function(e){ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.setHsvValue()"),yi(e)}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:Kl}),Fm.__namespace__=Os,Fm},void 0===(o="function"===typeof r?r.apply(t,i):r)||(e.exports=o)},720:function(e,t,n){var r,i,o;i=[n(657)],void 0===(o="function"===typeof(r=function(e){return e})?r.apply(t,i):r)||(e.exports=o)},657:function(e,t,n){var r,i,o;i=[n(363)],void 0===(o="function"===typeof(r=function(e){var t=e.__namespace__,n=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),r={customContextMenu:function(e){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(r={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:i(this)},s=this.getField("VAR").getText(),s={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",s),enabled:!0,callback:o(this)},e.unshift(r),e.unshift(s));else{if("variables_get_dynamic"===this.type)var n="variables_set_dynamic",r=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get_dynamic",r=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var s=this.getField("VAR");n={type:n,fields:{VAR:s.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:r.replace("%1",s.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}},onchange:function(e){e=this.getFieldValue("VAR"),e=t.getVariable$$module$build$src$core$variables(this.workspace,e),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(e.type):this.getInput("VALUE").connection.setCheck(e.type)}},i=function(e){return function(){const n=e.workspace,r=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,r)}},o=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",r),t.defineBlocks$$module$build$src$core$common(n);var s={blocks:n},a=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),l={customContextMenu:function(e){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(r={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:c(this)},i=this.getField("VAR").getText(),i={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:u(this)},e.unshift(r),e.unshift(i));else{if("variables_get"===this.type)var n="variables_set",r=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get",r=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var i=this.getField("VAR");n={type:n,fields:{VAR:i.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:r.replace("%1",i.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}},c=function(e){return function(){const n=e.workspace,r=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,r)}},u=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",l),t.defineBlocks$$module$build$src$core$common(a);var h={blocks:a},d=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),p={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1","".concat(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2","".concat(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const r=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});r.setValidator((function(t){const r="FROM_START"===t||"FROM_END"===t;if(r!==n){const n=this.getSourceBlock();return n.updateAt_(e,r),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(r,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};d.text_getSubstring=p,d.text_changeCase={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},d.text_trim={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},d.text_print={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var f={updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}};d.text_prompt_ext=Object.assign({},f,{init:function(){var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});var m=Object.assign({},f,{init:function(){this.mixin(g);var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});d.text_prompt=m,d.text_count={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},d.text_replace={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},d.text_reverse={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var g={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(let t,n=0;t=this.inputList[n];n++)for(let r,i=0;r=t.fieldRow[i];i++)if(e===r.name)return t.insertFieldAt(i,this.newQuote_(!0)),void t.insertFieldAt(i+2,this.newQuote_(!1));console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,t.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"\u201c":"\u201d"})}},v=function(){this.mixin(g),this.quoteField_("TEXT")},_={itemCount_:0,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items","".concat(this.itemCount_)),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("text_create_join_container");t.initSvg();let n=t.getInput("STACK").connection;for(let r=0;r<this.itemCount_;r++){const t=e.newBlock("text_create_join_item");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);e.valueConnection_=n&&n.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}},b=function(){this.mixin(g),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};t.register$$module$build$src$core$extensions("text_append_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var y=function(){this.setTooltip((()=>t.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))},T={isAt_:!1,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at","".concat(this.isAt_)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}},E=function(){this.getField("WHERE").setValidator((function(e){e="FROM_START"===e||"FROM_END"===e;const t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)})),this.updateAt_(!0),this.setTooltip((()=>{var e=this.getFieldValue("WHERE");let n=t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===e||"FROM_END"===e)&&(e="FROM_START"===e?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(n+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),n}))};t.register$$module$build$src$core$extensions("text_indexOf_tooltip",y),t.register$$module$build$src$core$extensions("text_quotes",v),t.registerMixin$$module$build$src$core$extensions("quote_image_mixin",g),t.registerMutator$$module$build$src$core$extensions("text_join_mutator",_,b),t.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",T,E),t.defineBlocks$$module$build$src$core$common(d);var S={blocks:d},w={},x={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=t.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{t.enable$$module$build$src$core$events$utils()}},mutationToDom:function(e){const n=t.createElement$$module$build$src$core$utils$xml("mutation");e&&n.setAttribute("name",this.getFieldValue("NAME"));for(let r=0;r<this.argumentVarModels_.length;r++){const i=t.createElement$$module$build$src$core$utils$xml("arg"),o=this.argumentVarModels_[r];i.setAttribute("name",o.name),i.setAttribute("varid",o.getId()),e&&this.paramIds_&&i.setAttribute("paramId",this.paramIds_[r]),n.appendChild(i)}return this.hasStatements_||n.setAttribute("statements","false"),n},domToMutation:function(e){this.arguments_=[],this.argumentVarModels_=[];for(let r,i=0;r=e.childNodes[i];i++)if("arg"===r.nodeName.toLowerCase()){var n=r;const e=n.getAttribute("name");n=n.getAttribute("varid")||n.getAttribute("varId"),this.arguments_.push(e),null!==(n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n,e,""))?this.argumentVarModels_.push(n):console.log('Failed to create a variable named "'.concat(e,'", ignoring.'))}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==e.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const e=Object.create(null);if(this.argumentVarModels_.length){e.params=[];for(let t=0;t<this.argumentVarModels_.length;t++)e.params.push({name:this.argumentVarModels_[t].name,id:this.argumentVarModels_[t].getId()})}return this.hasStatements_||(e.hasStatements=!1),e},loadExtraState:function(e){if(this.arguments_=[],this.argumentVarModels_=[],e.params)for(let r=0;r<e.params.length;r++){var n=e.params[r];n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n.id,n.name,""),this.arguments_.push(n.name),this.argumentVarModels_.push(n)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==e.hasStatements)},decompose:function(e){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorcontainer");var r=t.createElement$$module$build$src$core$utils$xml("statement");r.setAttribute("name","STACK"),n.appendChild(r);for(let o=0;o<this.arguments_.length;o++){const e=t.createElement$$module$build$src$core$utils$xml("block");e.setAttribute("type","procedures_mutatorarg");var i=t.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME");const n=t.createTextNode$$module$build$src$core$utils$xml(this.arguments_[o]);i.appendChild(n),e.appendChild(i),i=t.createElement$$module$build$src$core$utils$xml("next"),e.appendChild(i),r.appendChild(e),r=i}return e=t.domToBlock$$module$build$src$core$xml(n,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),t.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let n=e.getInputTargetBlock("STACK");for(;n&&!n.isInsertionMarker();){var r=n.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(n.id),n=n.nextConnection&&n.nextConnection.targetBlock()}if(this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&(e="TRUE"===e,this.hasStatements_!==e))if(e){var i;this.setStatements_(!0),null==(i=this.statementConnection_)||i.reconnect(this,"STACK"),this.statementConnection_=null}else i=this.getInput("STACK").connection,(this.statementConnection_=i.targetConnection)&&((i=i.targetBlock()).unplug(),i.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,n){var r=this.workspace.getVariableById(e);if(""===r.type){r=r.name,n=this.workspace.getVariableById(n);var i=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e&&(this.arguments_[t]=n.name,this.argumentVarModels_[t]=n,i=!0);i&&(this.displayRenamedVar_(r,n.name),t.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(e){const n=e.name;let r,i=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e.getId()&&(r=this.arguments_[t],this.arguments_[t]=n,i=!0);i&&(this.displayRenamedVar_(r,n),t.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(e,n){this.updateParams_();var r=this.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(r&&r.bubbleIsVisible()){r=r.getWorkspace().getAllBlocks(!1);for(let i,o=0;i=r[o];o++)"procedures_mutatorarg"===i.type&&t.Names$$module$build$src$core$names.equals(e,i.getFieldValue("NAME"))&&i.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var n=this.getFieldValue("NAME"),r={type:this.callType_,extraState:{name:n,params:this.arguments_}};if(e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",n),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,r)}),!this.isCollapsed())for(n=0;n<this.argumentVarModels_.length;n++){const i={type:"variables_get",fields:{VAR:{name:(r=this.argumentVarModels_[n]).name,id:r.getId(),type:r.type}}};e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r.name),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,i)})}}}};w.procedures_defnoreturn=Object.assign({},x,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),w.procedures_defreturn=Object.assign({},x,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var M={init:function(){this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};w.procedures_mutatorcontainer=M;var C={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:t.DEFAULT_ARG$$module$build$src$core$procedures});e.setValidator(this.validator_),e.oldShowEditorFn_=e.showEditor_,e.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,e.onFinishEditing_=this.deleteIntermediateVars_,e.createdVariables_=[],e.onFinishEditing_("x")},validator_:function(e){var t=this.getSourceBlock();const n=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const r=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),i=e.toLowerCase();for(let o=0;o<r.length;o++){if(r[o].id===this.getSourceBlock().id)continue;const e=r[o].getFieldValue("NAME");if(e&&e.toLowerCase()===i)return null}return t.isInFlyout||((t=n.getVariable(e,""))&&t.name!==e&&n.renameVariableById(t.getId(),e),t||(t=n.createVariable(e,""))&&this.createdVariables_&&this.createdVariables_.push(t)),e},deleteIntermediateVars_:function(e){const t=this.getSourceBlock().workspace.getRootWorkspace();if(t)for(let n=0;n<this.createdVariables_.length;n++){const r=this.createdVariables_[n];r.name!==e&&t.deleteVariableById(r.getId())}}};w.procedures_mutatorarg=C;var I={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,n){t.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(n,"NAME"),this.setTooltip((this.outputConnection?t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",n)))},setProcedureParameters_:function(e,n){var r=t.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((r=(r=r&&r.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&r.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=n;else{if(n.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var i=this.getInput("ARG"+e);i&&(i=i.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=i,r&&i&&-1===n.indexOf(this.quarkIds_[e])&&(i.disconnect(),i.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)r=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(r);if(this.updateShape_(),this.quarkIds_=n)for(n=0;n<this.arguments_.length;n++)if((e=this.quarkIds_[n])in this.quarkConnections_){let t;null!=(t=this.quarkConnections_[e])&&t.reconnect(this,"ARG"+n)||delete this.quarkConnections_[e]}}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var n=this.getField("ARGNAME"+e);if(n){t.disable$$module$build$src$core$events$utils();try{n.setValue(this.arguments_[e])}finally{t.enable$$module$build$src$core$events$utils()}}else n=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(n,"ARGNAME"+e).init()}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(e.appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),e.init()):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("name",this.getProcedureCall());for(let n=0;n<this.arguments_.length;n++){const r=t.createElement$$module$build$src$core$utils$xml("arg");r.setAttribute("name",this.arguments_[n]),e.appendChild(r)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];const n=[];for(let r,i=0;r=e.childNodes[i];i++)"arg"===r.nodeName.toLowerCase()&&(t.push(r.getAttribute("name")),n.push(r.getAttribute("paramId")));this.setProcedureParameters_(t,n)},saveExtraState:function(){const e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){if(this.renameProcedure(this.getProcedureCall(),e.name),e=e.params){const t=[];t.length=e.length,t.fill(null),this.setProcedureParameters_(e,t)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===t.CREATE$$module$build$src$core$events$utils&&-1!==e.ids.indexOf(this.id)){var n=this.getProcedureCall();if(!(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))||n.type===this.defType_&&JSON.stringify(n.getVars())===JSON.stringify(this.arguments_)||(n=null),!n){t.setGroup$$module$build$src$core$events$utils(e.group),e=t.createElement$$module$build$src$core$utils$xml("xml"),(n=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var r=this.getRelativeToSurfaceXY(),i=r.y+2*t.config$$module$build$src$core$config.snapRadius;n.setAttribute("x","".concat(r.x+t.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1))),n.setAttribute("y","".concat(i)),r=this.mutationToDom(),n.appendChild(r),(r=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),i=this.getProcedureCall();const o=t.findLegalName$$module$build$src$core$procedures(i,this);i!==o&&this.renameProcedure(i,o),r.appendChild(t.createTextNode$$module$build$src$core$utils$xml(i)),n.appendChild(r),e.appendChild(n),t.domToWorkspace$$module$build$src$core$xml(e,this.workspace),t.setGroup$$module$build$src$core$events$utils(!1)}}else e.type===t.DELETE$$module$build$src$core$events$utils?(n=this.getProcedureCall(),t.getDefinition$$module$build$src$core$procedures(n,this.workspace)||(t.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),t.setGroup$$module$build$src$core$events$utils(!1))):e.type===t.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element&&(n=this.getProcedureCall(),(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))&&n.id===e.blockId&&((n=t.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),t.setGroup$$module$build$src$core$events$utils(e.group),e.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.setGroup$$module$build$src$core$events$utils(n)))},customContextMenu:function(e){if(this.workspace.isMovable()){var n=this.getProcedureCall(),r=this.workspace;e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const e=t.getDefinition$$module$build$src$core$procedures(n,r);e&&(r.centerOnBlock(e.id),e.select())}})}}};w.procedures_callnoreturn=Object.assign({},I,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),w.procedures_callreturn=Object.assign({},I,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"});var k={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==t.MOVE$$module$build$src$core$events$utils)){var n=!1,r=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(r.type)){n=!0;break}r=r.getSurroundParent()}while(r);n?("procedures_defnoreturn"===r.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==r.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(r=t.getGroup$$module$build$src$core$events$utils(),t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(r))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};w.procedures_ifreturn=k,t.defineBlocks$$module$build$src$core$common(w);var R={blocks:w},A=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),L={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};t.register$$module$build$src$core$extensions("math_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",L));var O={mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(n)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){const t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}},N=function(){this.getField("PROPERTY").setValidator((function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)}))};t.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",O,N),t.register$$module$build$src$core$extensions("math_change_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var P={updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}},D=function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))};t.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",P,D),t.defineBlocks$$module$build$src$core$common(A);var $={blocks:A},B=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),F={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};t.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",F));var U={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};t.register$$module$build$src$core$extensions("controls_flow_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",U));var z={customContextMenu:function(e){if(!this.isInFlyout){var n=this.getField("VAR"),r=n.getVariable().name;this.isCollapsed()||null===r||(n={type:"variables_get",fields:{VAR:n.saveState(!0)}},e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}};t.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",z),t.register$$module$build$src$core$extensions("controls_for_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("controls_forEach_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var H=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),G={getSurroundLoop:function(){let e=this;do{if(H.has(e.type))return e;e=e.getSurroundParent()}while(e);return null},onchange:function(e){var n=this.workspace;if(n.isDragging&&!n.isDragging()&&e.type===t.MOVE$$module$build$src$core$events$utils&&(n=!!this.getSurroundLoop(),this.setWarningText(n?null:t.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const r=t.getGroup$$module$build$src$core$events$utils();t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(r)}}};t.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",G),t.defineBlocks$$module$build$src$core$common(B);var V={blocks:B,loopTypes:H},W=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),j={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};t.register$$module$build$src$core$extensions("logic_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",j));var X={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=t.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=Object.create(null);return this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(e){const t=e.newBlock("controls_if_if");t.initSvg();let n=t.nextConnection;for(let r=1;r<=this.elseifCount_;r++){const t=e.newBlock("controls_if_elseif");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),n.connect(e.previousConnection)),t},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const t=[null],n=[null];let r=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),n.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,r=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,n,r)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var n=this.getInput("IF"+t);const r=this.getInput("DO"+t);e.valueConnection_=n&&n.connection.targetConnection,e.statementConnection_=r&&r.connection.targetConnection,t++;break;case"controls_if_else":n=this.getInput("ELSE"),e.statementConnection_=n&&n.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);for(let r=1;this.getInput("IF"+r);r++){const n=this.getInput("IF"+r),i=this.getInput("DO"+r);e.push(n.connection.targetConnection),t.push(i.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(e,t,n){for(let r=1;r<=this.elseifCount_;r++){let n,i;null==(n=e[r])||n.reconnect(this,"IF"+r),null==(i=t[r])||i.reconnect(this,"DO"+r)}null==n||n.reconnect(this,"ELSE")}};t.registerMutator$$module$build$src$core$extensions("controls_if_mutator",X,null,["controls_if_elseif","controls_if_else"]);var Y=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))};t.register$$module$build$src$core$extensions("controls_if_tooltip",Y);var K={onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var n=this.getInputTargetBlock("A");const r=this.getInputTargetBlock("B");n&&r&&!this.workspace.connectionChecker.doTypeChecks(n.outputConnection,r.outputConnection)&&(t.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==n&&(n.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(n=this.prevBlocks_[1])!==r&&(r.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("B").connection.connect(n.outputConnection)),this.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},q=function(){this.mixin(K)};t.register$$module$build$src$core$extensions("logic_compare",q);var J={prevParentConnection_:null,onchange:function(e){const n=this.getInputTargetBlock("THEN"),r=this.getInputTargetBlock("ELSE"),i=this.outputConnection.targetConnection;if((n||r)&&i)for(let o=0;2>o;o++){const s=1===o?n:r;s&&!s.workspace.connectionChecker.doTypeChecks(s.outputConnection,i)&&(t.setGroup$$module$build$src$core$events$utils(e.group),i===this.prevParentConnection_?(this.unplug(),i.getSourceBlock().bumpNeighbours()):(s.unplug(),s.bumpNeighbours()),t.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=i}};t.registerMixin$$module$build$src$core$extensions("logic_ternary",J),t.defineBlocks$$module$build$src$core$common(W);var Z=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),Q={init:function(){this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("lists_create_with_container");t.initSvg();let n=t.getInput("STACK").connection;for(let r=0;r<this.itemCount_;r++){const t=e.newBlock("lists_create_with_item");if(t.initSvg(),!t.previousConnection)throw Error("itemBlock has no previousConnection");n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);let r;e.valueConnection_=null==(r=n)?void 0:r.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};Z.lists_create_with=Q;var ee={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};Z.lists_create_with_container=ee;var te={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};Z.lists_create_with_item=te;var ne={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip((()=>t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))}};Z.lists_indexOf=ne;var re={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)})),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let r="";switch(e+" "+n){case"GET FROM_START":case"GET FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(r+="  "+("FROM_START"===n?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("statement",String(!this.outputConnection));const n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"===typeof e&&this.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.getInput("AT").appendField(n,"WHERE"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};Z.lists_getIndex=re;var ie={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let r="";switch(e+" "+n){case"SET FROM_START":case"SET FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(r+="  "+t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(n,"WHERE")}};Z.lists_setIndex=ie;var oe={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e);const r=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});r.setValidator((function(t){const r="FROM_START"===t||"FROM_END"===t;if(r!==n){const n=this.getSourceBlock();return n.updateAt_(e,r),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(r,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};Z.lists_getSublist=oe,Z.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},Z.lists_split={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator((e=>{this.updateType_(e)})),this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((()=>{const e=this.getFieldValue("MODE");if("SPLIT"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)}))},updateType_:function(e){if(this.getFieldValue("MODE")!==e){const e=this.getInput("INPUT").connection;e.setShadowDom(null);const t=e.targetBlock();t&&(e.disconnect(),t.isShadow()?t.dispose(!1):this.bumpNeighbours())}"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},t.defineBlocks$$module$build$src$core$common(Z);var se={blocks:Z},ae=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]);t.defineBlocks$$module$build$src$core$common(ae);var le={blocks:ae},ce={blocks:Object.assign({},ae,Z,W,B,A,w,a,n),colour:le,lists:se,loops:V,math:$,procedures:R,texts:S,variables:h,variablesDynamic:s};return ce.__namespace__=t,ce})?r.apply(t,i):r)||(e.exports=o)},285:function(e,t,n){var r,i,o;i=[n(30),n(130),n(720),n(505)],void 0===(o="function"===typeof(r=function(e,t,n,r){"use strict";return e.setLocale(t),e})?r.apply(t,i):r)||(e.exports=o)},30:function(e,t,n){var r,i,o;i=[n(478)],void 0===(o="function"===typeof(r=function(e){"use strict";return e})?r.apply(t,i):r)||(e.exports=o)},271:function(e,t,n){var r,i,o;i=[n(285)],void 0===(o="function"===typeof(r=function(e){return e})?r.apply(t,i):r)||(e.exports=o)},505:function(e,t,n){var r,i,o;i=[n(30),n(952)],void 0===(o="function"===typeof(r=function(e,t){return t})?r.apply(t,i):r)||(e.exports=o)},952:function(e,t,n){var r,i,o;i=[n(363)],r=function(e){var t,n,r=e.__namespace__,i=function(e,n){return[n.quote_(e.getFieldValue("COLOUR")),t.ATOMIC]},o=function(e,n){return[n.provideFunction_("colourRandom","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"() {\n  var num = Math.floor(Math.random() * Math.pow(2, 24));\n  return '#' + ('00000' + num.toString(16)).substr(-6);\n}\n"))+"()",t.FUNCTION_CALL]},s=function(e,n){const r=n.valueToCode(e,"RED",t.NONE)||0,i=n.valueToCode(e,"GREEN",t.NONE)||0;return e=n.valueToCode(e,"BLUE",t.NONE)||0,[n.provideFunction_("colourRgb","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(r, g, b) {\n  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;\n  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;\n  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;\n  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);\n  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);\n  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n"))+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]},a=function(e,n){const r=n.valueToCode(e,"COLOUR1",t.NONE)||"'#000000'",i=n.valueToCode(e,"COLOUR2",t.NONE)||"'#000000'";return e=n.valueToCode(e,"RATIO",t.NONE)||.5,[n.provideFunction_("colourBlend","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(c1, c2, ratio) {\n  ratio = Math.max(Math.min(Number(ratio), 1), 0);\n  var r1 = parseInt(c1.substring(1, 3), 16);\n  var g1 = parseInt(c1.substring(3, 5), 16);\n  var b1 = parseInt(c1.substring(5, 7), 16);\n  var r2 = parseInt(c2.substring(1, 3), 16);\n  var g2 = parseInt(c2.substring(3, 5), 16);\n  var b2 = parseInt(c2.substring(5, 7), 16);\n  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);\n  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);\n  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);\n  r = ('0' + (r || 0).toString(16)).slice(-2);\n  g = ('0' + (g || 0).toString(16)).slice(-2);\n  b = ('0' + (b || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n"))+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]},l=function(e,n){return["[]",t.ATOMIC]},c=function(e,n){const r=Array(e.itemCount_);for(let i=0;i<e.itemCount_;i++)r[i]=n.valueToCode(e,"ADD"+i,t.NONE)||"null";return["["+r.join(", ")+"]",t.ATOMIC]},u=function(e,n){return[n.provideFunction_("listsRepeat","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n}\n"))+"("+(n.valueToCode(e,"ITEM",t.NONE)||"null")+", "+(e=n.valueToCode(e,"NUM",t.NONE)||"0")+")",t.FUNCTION_CALL]},h=function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.MEMBER]},d=function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.LOGICAL_NOT]},p=function(e,n){const r="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+"."+r+"("+i+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},f=function(e,n){const r=e.getFieldValue("MODE")||"GET",i=e.getFieldValue("WHERE")||"FROM_START";var o=n.valueToCode(e,"VALUE","RANDOM"===i?t.NONE:t.MEMBER)||"[]";switch(i){case"FIRST":if("GET"===r)return[o+"[0]",t.MEMBER];if("GET_REMOVE"===r)return[o+".shift()",t.MEMBER];if("REMOVE"===r)return o+".shift();\n";break;case"LAST":if("GET"===r)return[o+".slice(-1)[0]",t.MEMBER];if("GET_REMOVE"===r)return[o+".pop()",t.MEMBER];if("REMOVE"===r)return o+".pop();\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"GET"===r)return[o+"["+e+"]",t.MEMBER];if("GET_REMOVE"===r)return[o+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===r)return o+".splice("+e+", 1);\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!0),"GET"===r)return[o+".slice("+e+")[0]",t.FUNCTION_CALL];if("GET_REMOVE"===r)return[o+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===r)return o+".splice("+e+", 1);";break;case"RANDOM":if(o=n.provideFunction_("listsGetRandomItem","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(list, remove) {\n  var x = Math.floor(Math.random() * list.length);\n  if (remove) {\n    return list.splice(x, 1)[0];\n  } else {\n    return list[x];\n  }\n}\n"))+"("+o+", "+("GET"!==r)+")","GET"===r||"GET_REMOVE"===r)return[o,t.FUNCTION_CALL];if("REMOVE"===r)return o+";\n"}throw Error("Unhandled combination (lists_getIndex).")},m=function(e,n){function i(){if(o.match(/^\w+$/))return"";const e=n.nameDB_.getDistinctName("tmpList",r.NameType$$module$build$src$core$names.VARIABLE),t="var "+e+" = "+o+";\n";return o=e,t}let o=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const s=e.getFieldValue("MODE")||"GET";var a=e.getFieldValue("WHERE")||"FROM_START";const l=n.valueToCode(e,"TO",t.ASSIGNMENT)||"null";switch(a){case"FIRST":if("SET"===s)return o+"[0] = "+l+";\n";if("INSERT"===s)return o+".unshift("+l+");\n";break;case"LAST":if("SET"===s)return i()+(o+"[")+o+".length - 1] = "+l+";\n";if("INSERT"===s)return o+".push("+l+");\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"SET"===s)return o+"["+e+"] = "+l+";\n";if("INSERT"===s)return o+".splice("+e+", 0, "+l+");\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!1,t.SUBTRACTION),a=i(),"SET"===s)return a+(o+"[")+o+".length - "+e+"] = "+l+";\n";if("INSERT"===s)return a+(o+".splice(")+o+".length - "+e+", 0, "+l+");\n";break;case"RANDOM":if(e=i(),e+="var "+(a=n.nameDB_.getDistinctName("tmpX",r.NameType$$module$build$src$core$names.VARIABLE))+" = Math.floor(Math.random() * "+o+".length);\n","SET"===s)return e+(o+"[")+a+"] = "+l+";\n";if("INSERT"===s)return e+(o+".splice(")+a+", 0, "+l+");\n"}throw Error("Unhandled combination (lists_setIndex).")},g=function(e,n){var r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},i=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const o=e.getFieldValue("WHERE1"),s=e.getFieldValue("WHERE2");if("FIRST"===o&&"LAST"===s)i+=".slice(0)";else if(i.match(/^\w+$/)||"FROM_END"!==o&&"FROM_START"===s){switch(o){case"FROM_START":r=n.getAdjusted(e,"AT1");break;case"FROM_END":r=i+".length - "+(r=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(s){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=i+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=i+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}i=i+".slice("+r+", "+n+")"}else{const t=n.getAdjusted(e,"AT1");e=n.getAdjusted(e,"AT2"),i=n.provideFunction_("subsequence"+r[o]+r[s],"\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(sequence").concat("FROM_END"===o||"FROM_START"===o?", at1":"").concat("FROM_END"===s||"FROM_START"===s?", at2":"",") {\n  var start = ").concat(me("sequence",o,"at1"),";\n  var end = ").concat(me("sequence",s,"at2")," + 1;\n  return sequence.slice(start, end);\n}\n"))+"("+i+("FROM_END"===o||"FROM_START"===o?", "+t:"")+("FROM_END"===s||"FROM_START"===s?", "+e:"")+")"}return[i,t.FUNCTION_CALL]},v=function(e,n){const r=n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]",i="1"===e.getFieldValue("DIRECTION")?1:-1;return e=e.getFieldValue("TYPE"),[r+".slice().sort("+(n=n.provideFunction_("listsGetSortCompare","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(type, direction) {\n  var compareFuncs = {\n    'NUMERIC': function(a, b) {\n        return Number(a) - Number(b); },\n    'TEXT': function(a, b) {\n        return String(a) > String(b) ? 1 : -1; },\n    'IGNORE_CASE': function(a, b) {\n        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },\n  };\n  var compare = compareFuncs[type];\n  return function(a, b) { return compare(a, b) * direction; };\n}\n      ")))+'("'+e+'", '+i+"))",t.FUNCTION_CALL]},_=function(e,n){let r=n.valueToCode(e,"INPUT",t.MEMBER);if(n=n.valueToCode(e,"DELIM",t.NONE)||"''","SPLIT"===(e=e.getFieldValue("MODE")))r||(r="''"),e="split";else{if("JOIN"!==e)throw Error("Unknown mode: "+e);r||(r="[]"),e="join"}return[r+"."+e+"("+n+")",t.FUNCTION_CALL]},b=function(e,n){return[(n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]")+".slice().reverse()",t.FUNCTION_CALL]},y=function(e,n){var r=0;let i="";n.STATEMENT_PREFIX&&(i+=n.injectId(n.STATEMENT_PREFIX,e));do{const o=n.valueToCode(e,"IF"+r,t.NONE)||"false";let s=n.statementToCode(e,"DO"+r);n.STATEMENT_SUFFIX&&(s=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+s),i+=(0<r?" else ":"")+"if ("+o+") {\n"+s+"}",r++}while(e.getInput("IF"+r));return(e.getInput("ELSE")||n.STATEMENT_SUFFIX)&&(r=n.statementToCode(e,"ELSE"),n.STATEMENT_SUFFIX&&(r=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+r),i+=" else {\n"+r+"}"),i+"\n"},T=function(e,n){const r={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],i="=="===r||"!="===r?t.EQUALITY:t.RELATIONAL;return[(n.valueToCode(e,"A",i)||"0")+" "+r+" "+(e=n.valueToCode(e,"B",i)||"0"),i]},E=function(e,n){const r="AND"===e.getFieldValue("OP")?"&&":"||",i="&&"===r?t.LOGICAL_AND:t.LOGICAL_OR;let o=n.valueToCode(e,"A",i);return e=n.valueToCode(e,"B",i),o||e?(n="&&"===r?"true":"false",o||(o=n),e||(e=n)):e=o="false",[o+" "+r+" "+e,i]},S=function(e,n){const r=t.LOGICAL_NOT;return["!"+(n.valueToCode(e,"BOOL",r)||"true"),r]},w=function(e,n){return["TRUE"===e.getFieldValue("BOOL")?"true":"false",t.ATOMIC]},x=function(e,n){return["null",t.ATOMIC]},M=function(e,n){return[(n.valueToCode(e,"IF",t.CONDITIONAL)||"false")+" ? "+(n.valueToCode(e,"THEN",t.CONDITIONAL)||"null")+" : "+(e=n.valueToCode(e,"ELSE",t.CONDITIONAL)||"null"),t.CONDITIONAL]},C=function(e,n){let i;i=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):n.valueToCode(e,"TIMES",t.ASSIGNMENT)||"0";let o=n.statementToCode(e,"DO");o=n.addLoopTrap(o,e),e="";const s=n.nameDB_.getDistinctName("count",r.NameType$$module$build$src$core$names.VARIABLE);let a=i;return i.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(i)||(a=n.nameDB_.getDistinctName("repeat_end",r.NameType$$module$build$src$core$names.VARIABLE),e+="var "+a+" = "+i+";\n"),e+"for (var "+s+" = 0; "+s+" < "+a+"; "+s+"++) {\n"+o+"}\n"},I=function(e,n){const r="UNTIL"===e.getFieldValue("MODE");let i=n.valueToCode(e,"BOOL",r?t.LOGICAL_NOT:t.NONE)||"false",o=n.statementToCode(e,"DO");return o=n.addLoopTrap(o,e),r&&(i="!"+i),"while ("+i+") {\n"+o+"}\n"},k=function(e,n){var i=n.getVariableName(e.getFieldValue("VAR")),o=n.valueToCode(e,"FROM",t.ASSIGNMENT)||"0",s=n.valueToCode(e,"TO",t.ASSIGNMENT)||"0";const a=n.valueToCode(e,"BY",t.ASSIGNMENT)||"1";let l=n.statementToCode(e,"DO");if(l=n.addLoopTrap(l,e),r.isNumber$$module$build$src$core$utils$string(o)&&r.isNumber$$module$build$src$core$utils$string(s)&&r.isNumber$$module$build$src$core$utils$string(a))e="for ("+i+" = "+o+"; "+i+((n=Number(o)<=Number(s))?" <= ":" >= ")+s+"; "+i,e=1===(i=Math.abs(Number(a)))?e+(n?"++":"--"):e+(n?" += ":" -= ")+i,e+=") {\n"+l+"}\n";else{e="";let t=o;o.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(o)||(t=n.nameDB_.getDistinctName(i+"_start",r.NameType$$module$build$src$core$names.VARIABLE),e+="var "+t+" = "+o+";\n"),o=s,s.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(s)||(e+="var "+(o=n.nameDB_.getDistinctName(i+"_end",r.NameType$$module$build$src$core$names.VARIABLE))+" = "+s+";\n"),e+="var "+(s=n.nameDB_.getDistinctName(i+"_inc",r.NameType$$module$build$src$core$names.VARIABLE))+" = ",e=r.isNumber$$module$build$src$core$utils$string(a)?e+(Math.abs(Number(a))+";\n"):e+"Math.abs("+a+");\n",e+="if ("+t+" > "+o+") {\n",e=(e+=n.INDENT+s+" = -"+s+";\n")+"}\nfor ("+i+" = "+t+"; "+s+" >= 0 ? "+i+" <= "+o+" : "+i+" >= "+o+"; "+i+" += "+s+") {\n"+l+"}\n"}return e},R=function(e,n){const i=n.getVariableName(e.getFieldValue("VAR"));var o=n.valueToCode(e,"LIST",t.ASSIGNMENT)||"[]";let s=n.statementToCode(e,"DO");s=n.addLoopTrap(s,e),e="";let a=o;return o.match(/^\w+$/)||(a=n.nameDB_.getDistinctName(i+"_list",r.NameType$$module$build$src$core$names.VARIABLE),e+="var "+a+" = "+o+";\n"),o=n.nameDB_.getDistinctName(i+"_index",r.NameType$$module$build$src$core$names.VARIABLE),s=n.INDENT+i+" = "+a+"["+o+"];\n"+s,e+"for (var "+o+" in "+a+") {\n"+s+"}\n"},A=function(e,t){let n="";if(t.STATEMENT_PREFIX&&(n+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(n+=t.injectId(t.STATEMENT_SUFFIX,e)),t.STATEMENT_PREFIX){const r=e.getSurroundLoop();r&&!r.suppressPrefixSuffix&&(n+=t.injectId(t.STATEMENT_PREFIX,r))}switch(e.getFieldValue("FLOW")){case"BREAK":return n+"break;\n";case"CONTINUE":return n+"continue;\n"}throw Error("Unknown flow statement.")},L=function(e,n){return e=Number(e.getFieldValue("NUM")),[String(e),0<=e?t.ATOMIC:t.UNARY_NEGATION]},O=function(e,n){var r={ADD:[" + ",t.ADDITION],MINUS:[" - ",t.SUBTRACTION],MULTIPLY:[" * ",t.MULTIPLICATION],DIVIDE:[" / ",t.DIVISION],POWER:[null,t.NONE]}[e.getFieldValue("OP")];const i=r[0];r=r[1];const o=n.valueToCode(e,"A",r)||"0";return e=n.valueToCode(e,"B",r)||"0",i?[o+i+e,r]:["Math.pow("+o+", "+e+")",t.FUNCTION_CALL]},N=function(e,n){const r=e.getFieldValue("OP");let i;if("NEG"===r)return"-"===(e=n.valueToCode(e,"NUM",t.UNARY_NEGATION)||"0")[0]&&(e=" "+e),["-"+e,t.UNARY_NEGATION];switch(e="SIN"===r||"COS"===r||"TAN"===r?n.valueToCode(e,"NUM",t.DIVISION)||"0":n.valueToCode(e,"NUM",t.NONE)||"0",r){case"ABS":i="Math.abs("+e+")";break;case"ROOT":i="Math.sqrt("+e+")";break;case"LN":i="Math.log("+e+")";break;case"EXP":i="Math.exp("+e+")";break;case"POW10":i="Math.pow(10,"+e+")";break;case"ROUND":i="Math.round("+e+")";break;case"ROUNDUP":i="Math.ceil("+e+")";break;case"ROUNDDOWN":i="Math.floor("+e+")";break;case"SIN":i="Math.sin("+e+" / 180 * Math.PI)";break;case"COS":i="Math.cos("+e+" / 180 * Math.PI)";break;case"TAN":i="Math.tan("+e+" / 180 * Math.PI)"}if(i)return[i,t.FUNCTION_CALL];switch(r){case"LOG10":i="Math.log("+e+") / Math.log(10)";break;case"ASIN":i="Math.asin("+e+") / Math.PI * 180";break;case"ACOS":i="Math.acos("+e+") / Math.PI * 180";break;case"ATAN":i="Math.atan("+e+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+r)}return[i,t.DIVISION]},P=function(e,n){return{PI:["Math.PI",t.MEMBER],E:["Math.E",t.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.DIVISION],SQRT2:["Math.SQRT2",t.MEMBER],SQRT1_2:["Math.SQRT1_2",t.MEMBER],INFINITY:["Infinity",t.ATOMIC]}[e.getFieldValue("CONSTANT")]},D=function(e,n){var r={EVEN:[" % 2 === 0",t.MODULUS,t.EQUALITY],ODD:[" % 2 === 1",t.MODULUS,t.EQUALITY],WHOLE:[" % 1 === 0",t.MODULUS,t.EQUALITY],POSITIVE:[" > 0",t.RELATIONAL,t.RELATIONAL],NEGATIVE:[" < 0",t.RELATIONAL,t.RELATIONAL],DIVISIBLE_BY:[null,t.MODULUS,t.EQUALITY],PRIME:[null,t.NONE,t.FUNCTION_CALL]};const i=e.getFieldValue("PROPERTY"),[o,s,a]=r[i];return r=n.valueToCode(e,"NUMBER_TO_CHECK",s)||"0",[e="PRIME"===i?n.provideFunction_("mathIsPrime","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(n) {\n  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n  if (n == 2 || n == 3) {\n    return true;\n  }\n  // False if n is NaN, negative, is 1, or not whole.\n  // And false if n is divisible by 2 or 3.\n  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {\n    return false;\n  }\n  // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {\n    if (n % (x - 1) === 0 || n % (x + 1) === 0) {\n      return false;\n    }\n  }\n  return true;\n}\n"))+"("+r+")":"DIVISIBLE_BY"===i?r+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0")+" === 0":r+o,a]},$=function(e,n){const r=n.valueToCode(e,"DELTA",t.ADDITION)||"0";return(e=n.getVariableName(e.getFieldValue("VAR")))+" = (typeof "+e+" === 'number' ? "+e+" : 0) + "+r+";\n"},B=function(e,n){var r=e.getFieldValue("OP");switch(r){case"SUM":e=n.valueToCode(e,"LIST",t.MEMBER)||"[]",e+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":e="Math.min.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MAX":e="Math.max.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"AVERAGE":e=(r=n.provideFunction_("mathMean","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MEDIAN":e=(r=n.provideFunction_("mathMedian","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n  var localList = myList.filter(function (x) {return typeof x === 'number';});\n  if (!localList.length) return null;\n  localList.sort(function(a, b) {return b - a;});\n  if (localList.length % 2 === 0) {\n    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n  } else {\n    return localList[(localList.length - 1) / 2];\n  }\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MODE":e=(r=n.provideFunction_("mathModes","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(values) {\n  var modes = [];\n  var counts = [];\n  var maxCount = 0;\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i];\n    var found = false;\n    var thisCount;\n    for (var j = 0; j < counts.length; j++) {\n      if (counts[j][0] === value) {\n        thisCount = ++counts[j][1];\n        found = true;\n        break;\n      }\n    }\n    if (!found) {\n      counts.push([value, 1]);\n      thisCount = 1;\n    }\n    maxCount = Math.max(thisCount, maxCount);\n  }\n  for (var j = 0; j < counts.length; j++) {\n    if (counts[j][1] === maxCount) {\n        modes.push(counts[j][0]);\n    }\n  }\n  return modes;\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"STD_DEV":e=(r=n.provideFunction_("mathStandardDeviation","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(numbers) {\n  var n = numbers.length;\n  if (!n) return null;\n  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;\n  var variance = 0;\n  for (var j = 0; j < n; j++) {\n    variance += Math.pow(numbers[j] - mean, 2);\n  }\n  variance = variance / n;\n  return Math.sqrt(variance);\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"RANDOM":e=(r=n.provideFunction_("mathRandomList","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(list) {\n  var x = Math.floor(Math.random() * list.length);\n  return list[x];\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+r)}return[e,t.FUNCTION_CALL]},F=function(e,n){return[(n.valueToCode(e,"DIVIDEND",t.MODULUS)||"0")+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0"),t.MODULUS]},U=function(e,n){return["Math.min(Math.max("+(n.valueToCode(e,"VALUE",t.NONE)||"0")+", "+(n.valueToCode(e,"LOW",t.NONE)||"0")+"), "+(e=n.valueToCode(e,"HIGH",t.NONE)||"Infinity")+")",t.FUNCTION_CALL]},z=function(e,n){const r=n.valueToCode(e,"FROM",t.NONE)||"0";return e=n.valueToCode(e,"TO",t.NONE)||"0",[n.provideFunction_("mathRandomInt","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return Math.floor(Math.random() * (b - a + 1) + a);\n}\n"))+"("+r+", "+e+")",t.FUNCTION_CALL]},H=function(e,n){return["Math.random()",t.FUNCTION_CALL]},G=function(e,n){const r=n.valueToCode(e,"X",t.NONE)||"0";return["Math.atan2("+(n.valueToCode(e,"Y",t.NONE)||"0")+", "+r+") / Math.PI * 180",t.DIVISION]},V=function(e,n){const r=n.getProcedureName(e.getFieldValue("NAME"));var i="";n.STATEMENT_PREFIX&&(i+=n.injectId(n.STATEMENT_PREFIX,e)),n.STATEMENT_SUFFIX&&(i+=n.injectId(n.STATEMENT_SUFFIX,e)),i&&(i=n.prefixLines(i,n.INDENT));let o="";n.INFINITE_LOOP_TRAP&&(o=n.prefixLines(n.injectId(n.INFINITE_LOOP_TRAP,e),n.INDENT));const s=n.statementToCode(e,"STACK");let a=n.valueToCode(e,"RETURN",t.NONE)||"",l="";s&&a&&(l=i),a&&(a=n.INDENT+"return "+a+";\n");const c=[],u=e.getVars();for(let t=0;t<u.length;t++)c[t]=n.getVariableName(u[t]);return i="function "+r+"("+c.join(", ")+") {\n"+i+o+s+l+a+"}",i=n.scrub_(e,i),n.definitions_["%"+r]=i,null},W=function(e,n){const r=n.getProcedureName(e.getFieldValue("NAME")),i=[],o=e.getVars();for(let s=0;s<o.length;s++)i[s]=n.valueToCode(e,"ARG"+s,t.NONE)||"null";return[r+"("+i.join(", ")+")",t.FUNCTION_CALL]},j=function(e,t){return t.forBlock.procedures_callreturn(e,t)[0]+";\n"},X=function(e,n){let r="if ("+(n.valueToCode(e,"CONDITION",t.NONE)||"false")+") {\n";return n.STATEMENT_SUFFIX&&(r+=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)),e.hasReturnValue_?(e=n.valueToCode(e,"VALUE",t.NONE)||"null",r+=n.INDENT+"return "+e+";\n"):r+=n.INDENT+"return;\n",r+"}\n"},Y=function(e,n){return[n.quote_(e.getFieldValue("TEXT")),t.ATOMIC]},K=function(e,n){return e=n.multiline_quote_(e.getFieldValue("TEXT")),n=-1!==e.indexOf("+")?t.ADDITION:t.ATOMIC,[e,n]},q=function(e,n){switch(e.itemCount_){case 0:return["''",t.ATOMIC];case 1:return e=n.valueToCode(e,"ADD0",t.NONE)||"''",Ee(e);case 2:var r=n.valueToCode(e,"ADD0",t.NONE)||"''";return e=n.valueToCode(e,"ADD1",t.NONE)||"''",[Ee(r)[0]+" + "+Ee(e)[0],t.ADDITION];default:r=Array(e.itemCount_);for(let i=0;i<e.itemCount_;i++)r[i]=n.valueToCode(e,"ADD"+i,t.NONE)||"''";return["["+r.join(",")+"].join('')",t.FUNCTION_CALL]}},J=function(e,n){const r=n.getVariableName(e.getFieldValue("VAR"));return e=n.valueToCode(e,"TEXT",t.NONE)||"''",r+" += "+Ee(e)[0]+";\n"},Z=function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.MEMBER]},Q=function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.LOGICAL_NOT]},ee=function(e,n){const r="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+"."+r+"("+i+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},te=function(e,n){const r=e.getFieldValue("WHERE")||"FROM_START",i=n.valueToCode(e,"VALUE","RANDOM"===r?t.NONE:t.MEMBER)||"''";switch(r){case"FIRST":return[i+".charAt(0)",t.FUNCTION_CALL];case"LAST":return[i+".slice(-1)",t.FUNCTION_CALL];case"FROM_START":return[i+".charAt("+(e=n.getAdjusted(e,"AT"))+")",t.FUNCTION_CALL];case"FROM_END":return[i+".slice("+(e=n.getAdjusted(e,"AT",1,!0))+").charAt(0)",t.FUNCTION_CALL];case"RANDOM":return[n.provideFunction_("textRandomLetter","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(text) {\n  var x = Math.floor(Math.random() * text.length);\n  return text[x];\n}\n"))+"("+i+")",t.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},ne=function(e,n){var r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const i=e.getFieldValue("WHERE1"),o=e.getFieldValue("WHERE2");var s="FROM_END"!==i&&"LAST"!==i&&"FROM_END"!==o&&"LAST"!==o,a=n.valueToCode(e,"STRING",s?t.MEMBER:t.NONE)||"''";if("FIRST"===i&&"LAST"===o)return[a,t.NONE];if(a.match(/^'?\w+'?$/)||s){switch(i){case"FROM_START":r=n.getAdjusted(e,"AT1");break;case"FROM_END":r=a+".length - "+(r=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(o){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=a+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=a+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}a=a+".slice("+r+", "+n+")"}else s=n.getAdjusted(e,"AT1"),e=n.getAdjusted(e,"AT2"),a=n.provideFunction_("subsequence"+r[i]+r[o],"\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(sequence").concat("FROM_END"===i||"FROM_START"===i?", at1":"").concat("FROM_END"===o||"FROM_START"===o?", at2":"",") {\n  var start = ").concat(Se("sequence",i,"at1"),";\n  var end = ").concat(Se("sequence",o,"at2")," + 1;\n  return sequence.slice(start, end);\n}\n"))+"("+a+("FROM_END"===i||"FROM_START"===i?", "+s:"")+("FROM_END"===o||"FROM_START"===o?", "+e:"")+")";return[a,t.FUNCTION_CALL]},re=function(e,n){const r={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")];return e=n.valueToCode(e,"TEXT",r?t.MEMBER:t.NONE)||"''",[r?e+r:n.provideFunction_("textToTitleCase","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(str) {\n  return str.replace(/\\S+/g,\n      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});\n}\n"))+"("+e+")",t.FUNCTION_CALL]},ie=function(e,n){const r={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")];return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+r,t.FUNCTION_CALL]},oe=function(e,n){return"window.alert("+(n.valueToCode(e,"TEXT",t.NONE)||"''")+");\n"},se=function(e,n){return n="window.prompt("+(e.getField("TEXT")?n.quote_(e.getFieldValue("TEXT")):n.valueToCode(e,"TEXT",t.NONE)||"''")+")","NUMBER"===e.getFieldValue("TYPE")&&(n="Number("+n+")"),[n,t.FUNCTION_CALL]},ae=function(e,n){const r=n.valueToCode(e,"TEXT",t.NONE)||"''";return e=n.valueToCode(e,"SUB",t.NONE)||"''",[n.provideFunction_("textCount","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(haystack, needle) {\n  if (needle.length === 0) {\n    return haystack.length + 1;\n  } else {\n    return haystack.split(needle).length - 1;\n  }\n}\n"))+"("+r+", "+e+")",t.FUNCTION_CALL]},le=function(e,n){const r=n.valueToCode(e,"TEXT",t.NONE)||"''",i=n.valueToCode(e,"FROM",t.NONE)||"''";return e=n.valueToCode(e,"TO",t.NONE)||"''",[n.provideFunction_("textReplace","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(haystack, needle, replacement) {\n  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')\n                 .replace(/\\x08/g, '\\\\x08');\n  return haystack.replace(new RegExp(needle, 'g'), replacement);\n}\n"))+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]},ce=function(e,n){return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+".split('').reverse().join('')",t.FUNCTION_CALL]},ue=function(e,n){return[n.getVariableName(e.getFieldValue("VAR")),t.ATOMIC]},he=function(e,n){const r=n.valueToCode(e,"VALUE",t.ASSIGNMENT)||"0";return n.getVariableName(e.getFieldValue("VAR"))+" = "+r+";\n"};(n=t||(t={}))[n.ATOMIC=0]="ATOMIC",n[n.NEW=1.1]="NEW",n[n.MEMBER=1.2]="MEMBER",n[n.FUNCTION_CALL=2]="FUNCTION_CALL",n[n.INCREMENT=3]="INCREMENT",n[n.DECREMENT=3]="DECREMENT",n[n.BITWISE_NOT=4.1]="BITWISE_NOT",n[n.UNARY_PLUS=4.2]="UNARY_PLUS",n[n.UNARY_NEGATION=4.3]="UNARY_NEGATION",n[n.LOGICAL_NOT=4.4]="LOGICAL_NOT",n[n.TYPEOF=4.5]="TYPEOF",n[n.VOID=4.6]="VOID",n[n.DELETE=4.7]="DELETE",n[n.AWAIT=4.8]="AWAIT",n[n.EXPONENTIATION=5]="EXPONENTIATION",n[n.MULTIPLICATION=5.1]="MULTIPLICATION",n[n.DIVISION=5.2]="DIVISION",n[n.MODULUS=5.3]="MODULUS",n[n.SUBTRACTION=6.1]="SUBTRACTION",n[n.ADDITION=6.2]="ADDITION",n[n.BITWISE_SHIFT=7]="BITWISE_SHIFT",n[n.RELATIONAL=8]="RELATIONAL",n[n.IN=8]="IN",n[n.INSTANCEOF=8]="INSTANCEOF",n[n.EQUALITY=9]="EQUALITY",n[n.BITWISE_AND=10]="BITWISE_AND",n[n.BITWISE_XOR=11]="BITWISE_XOR",n[n.BITWISE_OR=12]="BITWISE_OR",n[n.LOGICAL_AND=13]="LOGICAL_AND",n[n.LOGICAL_OR=14]="LOGICAL_OR",n[n.CONDITIONAL=15]="CONDITIONAL",n[n.ASSIGNMENT=16]="ASSIGNMENT",n[n.YIELD=17]="YIELD",n[n.COMMA=18]="COMMA",n[n.NONE=99]="NONE";var de=class extends r.CodeGenerator$$module$build$src$core$generator{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"JavaScript";super(e),this.ORDER_OVERRIDES=[[t.FUNCTION_CALL,t.MEMBER],[t.FUNCTION_CALL,t.FUNCTION_CALL],[t.MEMBER,t.MEMBER],[t.MEMBER,t.FUNCTION_CALL],[t.LOGICAL_NOT,t.LOGICAL_NOT],[t.MULTIPLICATION,t.MULTIPLICATION],[t.ADDITION,t.ADDITION],[t.LOGICAL_AND,t.LOGICAL_AND],[t.LOGICAL_OR,t.LOGICAL_OR]],this.isInitialized=!1;for(const n in t)e=t[n],"string"!==typeof e&&(this["ORDER_"+n]=e);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(e){super.init(e),this.nameDB_?this.nameDB_.reset():this.nameDB_=new r.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e);const t=[];var n=r.allDeveloperVariables$$module$build$src$core$variables(e);for(let i=0;i<n.length;i++)t.push(this.nameDB_.getName(n[i],r.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(e=r.allUsedVarModels$$module$build$src$core$variables(e),n=0;n<e.length;n++)t.push(this.nameDB_.getName(e[n].getId(),r.NameType$$module$build$src$core$names.VARIABLE));t.length&&(this.definitions_.variables="var "+t.join(", ")+";"),this.isInitialized=!0}finish(e){const t=Object.values(this.definitions_);return super.finish(e),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+e}scrubNakedValue(e){return e+";\n"}quote_(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"}multiline_quote_(e){return e.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")}scrub_(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="";if(!e.outputConnection||!e.outputConnection.targetConnection){var o=e.getCommentText();o&&(o=r.wrap$$module$build$src$core$utils$string(o,this.COMMENT_WRAP-3),i+=this.prefixLines(o+"\n","// "));for(let t=0;t<e.inputList.length;t++)e.inputList[t].type===r.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(o=e.inputList[t].connection.targetBlock())&&(o=this.allNestedComments(o))&&(i+=this.prefixLines(o,"// "))}return e=e.nextConnection&&e.nextConnection.targetBlock(),n=n?"":this.blockToCode(e),i+t+n}getAdjusted(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.NONE;e.workspace.options.oneBasedIndex&&i--;const a=e.workspace.options.oneBasedIndex?"1":"0";let l=s;return 0<i?l=t.ADDITION:0>i?l=t.SUBTRACTION:o&&(l=t.UNARY_NEGATION),e=this.valueToCode(e,n,l)||a,0!==i||o?r.isNumber$$module$build$src$core$utils$string(e)?(e=String(Number(e)+i),o&&(e=String(-Number(e))),e):(0<i?e="".concat(e," + ").concat(i):0>i&&(e="".concat(e," - ").concat(-i)),o&&(e=i?"-(".concat(e,")"):"-".concat(e)),Math.floor(s)>=Math.floor(l)&&(e="(".concat(e,")")),e):e}},pe={};pe.JavascriptGenerator=de,pe.Order=t;var fe={};fe.colour_blend=a,fe.colour_picker=i,fe.colour_random=o,fe.colour_rgb=s;var me=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},ge={};ge.lists_create_empty=l,ge.lists_create_with=c,ge.lists_getIndex=f,ge.lists_getSublist=g,ge.lists_indexOf=p,ge.lists_isEmpty=d,ge.lists_length=h,ge.lists_repeat=u,ge.lists_reverse=b,ge.lists_setIndex=m,ge.lists_sort=v,ge.lists_split=_;var ve={};ve.controls_if=y,ve.controls_ifelse=y,ve.logic_boolean=w,ve.logic_compare=T,ve.logic_negate=S,ve.logic_null=x,ve.logic_operation=E,ve.logic_ternary=M;var _e={};_e.controls_flow_statements=A,_e.controls_for=k,_e.controls_forEach=R,_e.controls_repeat=C,_e.controls_repeat_ext=C,_e.controls_whileUntil=I;var be={};be.math_arithmetic=O,be.math_atan2=G,be.math_change=$,be.math_constant=P,be.math_constrain=U,be.math_modulo=F,be.math_number=L,be.math_number_property=D,be.math_on_list=B,be.math_random_float=H,be.math_random_int=z,be.math_round=N,be.math_single=N,be.math_trig=N;var ye={};ye.procedures_callnoreturn=j,ye.procedures_callreturn=W,ye.procedures_defnoreturn=V,ye.procedures_defreturn=V,ye.procedures_ifreturn=X;var Te=/^\s*'([^']|\\')*'\s*$/,Ee=function(e){return Te.test(e)?[e,t.ATOMIC]:["String("+e+")",t.FUNCTION_CALL]},Se=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},we={};we.text=Y,we.text_append=J,we.text_changeCase=re,we.text_charAt=te,we.text_count=ae,we.text_getSubstring=ne,we.text_indexOf=ee,we.text_isEmpty=Q,we.text_join=q,we.text_length=Z,we.text_multiline=K,we.text_print=oe,we.text_prompt=se,we.text_prompt_ext=se,we.text_replace=le,we.text_reverse=ce,we.text_trim=ie;var xe={};xe.variables_get=ue,xe.variables_set=he;var Me={};Me.variables_get_dynamic=ue,Me.variables_set_dynamic=he;var Ce=new de,Ie=Object.assign({},fe,ge,ve,_e,be,ye,we,xe,Me);for(const Re in Ie)Ce.forBlock[Re]=Ie[Re];var ke={};return ke.JavascriptGenerator=de,ke.Order=t,ke.javascriptGenerator=Ce,ke.__namespace__=r,ke},void 0===(o="function"===typeof r?r.apply(t,i):r)||(e.exports=o)},130:function(e,t){var n,r,i;r=[],void 0===(i="function"===typeof(n=function(){"use strict";var e=e||{Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="\xf7",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg})?n.apply(t,r):n)||(e.exports=i)},110:(e,t,n)=>{"use strict";var r=n(309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var s=u(n);h&&(s=s.concat(h(n)));for(var a=l(t),m=l(n),g=0;g<s.length;++g){var v=s[g];if(!o[v]&&(!r||!r[v])&&(!m||!m[v])&&(!a||!a[v])){var _=d(n,v);try{c(t,v,_)}catch(b){}}}}return t}},746:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,_=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,y=n?Symbol.for("react.scope"):60119;function T(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case h:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case i:return t}}}function E(e){return T(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=o,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return E(e)||T(e)===u},t.isConcurrentMode=E,t.isContextConsumer=function(e){return T(e)===c},t.isContextProvider=function(e){return T(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return T(e)===d},t.isFragment=function(e){return T(e)===o},t.isLazy=function(e){return T(e)===g},t.isMemo=function(e){return T(e)===m},t.isPortal=function(e){return T(e)===i},t.isProfiler=function(e){return T(e)===a},t.isStrictMode=function(e){return T(e)===s},t.isSuspense=function(e){return T(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===h||e===a||e===s||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===_||e.$$typeof===b||e.$$typeof===y||e.$$typeof===v)},t.typeOf=T},309:(e,t,n)=>{"use strict";e.exports=n(746)},463:(e,t,n)=>{"use strict";var r=n(791),i=n(296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var D,$=Object.assign;function B(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function z(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case E:return"Portal";case x:return"Profiler";case w:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function j(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return $({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){J(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return $({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function oe(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=$({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function Te(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Se=null,we=null;function xe(e){if(e=bi(e)){if("function"!==typeof Ee)throw Error(o(280));var t=e.stateNode;t&&(t=Ti(t),Ee(e.stateNode,e.type,t))}}function Me(e){Se?we?we.push(e):we=[e]:Se=e}function Ce(){if(Se){var e=Se,t=we;if(we=Se=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Ie(e,t){return e(t)}function ke(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ie(e,t,n)}finally{Re=!1,(null!==Se||null!==we)&&(ke(),Ce())}}function Le(e,t){var n=e.stateNode;if(null===n)return null;var r=Ti(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Oe=!1}function Pe(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var De=!1,$e=null,Be=!1,Fe=null,Ue={onError:function(e){De=!0,$e=e}};function ze(e,t,n,r,i,o,s,a,l){De=!1,$e=null,Pe.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(He(e)!==e)throw Error(o(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Ve(i),e;if(s===r)return Ve(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?je(e):null}function je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=je(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Ke=i.unstable_shouldYield,qe=i.unstable_requestPaint,Je=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Qe=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=ht(a):0!==(o&=s)&&(r=ht(o))}else 0!==(s=n&~i)?r=ht(s):0!==o&&(r=ht(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Tt,Et,St,wt,xt,Mt=!1,Ct=[],It=null,kt=null,Rt=null,At=new Map,Lt=new Map,Ot=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Dt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function $t(e){var t=_i(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void xt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ye=r,n.target.dispatchEvent(r),ye=null,t.shift()}return!0}function Ft(e,t,n){Bt(e)&&n.delete(t)}function Ut(){Mt=!1,null!==It&&Bt(It)&&(It=null),null!==kt&&Bt(kt)&&(kt=null),null!==Rt&&Bt(Rt)&&(Rt=null),At.forEach(Ft),Lt.forEach(Ft)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Mt||(Mt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return zt(t,e)}if(0<Ct.length){zt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&zt(It,e),null!==kt&&zt(kt,e),null!==Rt&&zt(Rt,e),At.forEach(t),Lt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)$t(n),null===n.blockedOn&&Ot.shift()}var Gt=y.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,n,r){var i=bt,o=Gt.transition;Gt.transition=null;try{bt=1,Xt(e,t,n,r)}finally{bt=i,Gt.transition=o}}function jt(e,t,n,r){var i=bt,o=Gt.transition;Gt.transition=null;try{bt=4,Xt(e,t,n,r)}finally{bt=i,Gt.transition=o}}function Xt(e,t,n,r){if(Vt){var i=Kt(e,t,n,r);if(null===i)Vr(e,t,r,Yt,n),Pt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=Dt(It,e,t,n,r,i),!0;case"dragenter":return kt=Dt(kt,e,t,n,r,i),!0;case"mouseover":return Rt=Dt(Rt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return At.set(o,Dt(At.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Lt.set(o,Dt(Lt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<Nt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&Tt(o),null===(o=Kt(e,t,n,r))&&Vr(e,t,r,Yt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Yt=null;function Kt(e,t,n,r){if(Yt=null,null!==(e=_i(e=Te(r))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Zt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Qt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return $(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=$({},cn,{view:0,detail:0}),dn=on(hn),pn=$({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=on(pn),mn=on($({},pn,{dataTransfer:0})),gn=on($({},hn,{relatedTarget:0})),vn=on($({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=$({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(_n),yn=on($({},cn,{data:0})),Tn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function xn(){return wn}var Mn=$({},hn,{key:function(e){if(e.key){var t=Tn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(Mn),In=on($({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=on($({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Rn=on($({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=$({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=on(An),On=[9,13,27,32],Nn=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var Dn=u&&"TextEvent"in window&&!Pn,$n=u&&(!Nn||Pn&&8<Pn&&11>=Pn),Bn=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Wn(e,t,n,r){Me(r),0<(t=jr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var jn=null,Xn=null;function Yn(e){Br(e,0)}function Kn(e){if(X(yi(e)))return e}function qn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Zn;if(u){var Qn="oninput"in document;if(!Qn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Qn="function"===typeof er.oninput}Zn=Qn}else Zn=!1;Jn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){jn&&(jn.detachEvent("onpropertychange",nr),Xn=jn=null)}function nr(e){if("value"===e.propertyName&&Kn(Xn)){var t=[];Wn(t,Xn,e,Te(e)),Ae(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(jn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Xn)}function or(e,t){if("click"===e)return Kn(t)}function sr(e,t){if("input"===e||"change"===e)return Kn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,_r=null,br=!1;function yr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},_r&&lr(_r,r)||(_r=r,0<(r=jr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Tr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:Tr("Animation","AnimationEnd"),animationiteration:Tr("Animation","AnimationIteration"),animationstart:Tr("Animation","AnimationStart"),transitionend:Tr("Transition","TransitionEnd")},Sr={},wr={};function xr(e){if(Sr[e])return Sr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in wr)return Sr[e]=n[t];return e}u&&(wr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Mr=xr("animationend"),Cr=xr("animationiteration"),Ir=xr("animationstart"),kr=xr("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){Rr.set(e,t),l(t,[e])}for(var Or=0;Or<Ar.length;Or++){var Nr=Ar[Or];Lr(Nr.toLowerCase(),"on"+(Nr[0].toUpperCase()+Nr.slice(1)))}Lr(Mr,"onAnimationEnd"),Lr(Cr,"onAnimationIteration"),Lr(Ir,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(kr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function $r(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,a,l,c){if(ze.apply(this,arguments),De){if(!De)throw Error(o(198));var u=$e;De=!1,$e=null,Be||(Be=!0,Fe=u)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;$r(i,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;$r(i,a,c),o=l}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Fr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[zr]){e[zr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Dr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(qt(t)){case 1:var i=Wt;break;case 4:i=jt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=_i(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}Ae((function(){var r=o,i=Te(n),s=[];e:{var a=Rr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Mr:case Cr:case Ir:l=vn;break;case kr:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Le(f,d))&&u.push(Wr(f,m,p)))),h)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!_i(c)&&!c[fi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?_i(c):null)&&(c!==(h=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:yi(l),p=null==c?a:yi(c),(a=new u(m,f+"leave",l,n,i)).target=h,a.relatedTarget=p,m=null,_i(i)===r&&((u=new u(d,f+"enter",c,n,i)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Xr(p))f++;for(p=0,m=d;m;m=Xr(m))p++;for(;0<f-p;)u=Xr(u),f--;for(;0<p-f;)d=Xr(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xr(u),d=Xr(d)}u=null}else u=null;null!==l&&Yr(s,a,l,u,!1),null!==c&&null!==h&&Yr(s,h,c,u,!0)}if("select"===(l=(a=r?yi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=qn;else if(Vn(a))if(Jn)g=sr;else{g=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=or);switch(g&&(g=g(e,r))?Wn(s,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?yi(r):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,_r=null);break;case"focusout":_r=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,yr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":yr(s,n,i)}var _;if(Nn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&($n&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(_=en()):(Zt="value"in(Jt=i)?Jt.value:Jt.textContent,Hn=!0)),0<(v=jr(r,b)).length&&(b=new yn(b,e,null,n,i),s.push({event:b,listeners:v}),_?b.data=_:null!==(_=zn(n))&&(b.data=_))),(_=Dn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Nn&&Un(e,t)?(e=en(),Qt=Zt=Jt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=jr(r,"onBeforeInput")).length&&(i=new yn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=_))}Br(s,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function jr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Le(e,n))&&r.unshift(Wr(e,o,i)),null!=(o=Le(e,t))&&r.push(Wr(e,o,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Le(n,o))&&s.unshift(Wr(n,l,a)):i||null!=(l=Le(n,o))&&s.push(Wr(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Kr=/\r\n?/g,qr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Kr,"\n").replace(qr,"")}function Zr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function Qr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ht(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ht(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function _i(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Ti(e){return e[pi]||null}var Ei=[],Si=-1;function wi(e){return{current:e}}function xi(e){0>Si||(e.current=Ei[Si],Ei[Si]=null,Si--)}function Mi(e,t){Si++,Ei[Si]=e.current,e.current=t}var Ci={},Ii=wi(Ci),ki=wi(!1),Ri=Ci;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Li(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){xi(ki),xi(Ii)}function Ni(e,t,n){if(Ii.current!==Ci)throw Error(o(168));Mi(Ii,t),Mi(ki,n)}function Pi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,G(e)||"Unknown",i));return $({},n,r)}function Di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ri=Ii.current,Mi(Ii,e),Mi(ki,ki.current),!0}function $i(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Pi(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,xi(ki),xi(Ii),Mi(Ii,e)):xi(ki),Mi(ki,n)}var Bi=null,Fi=!1,Ui=!1;function zi(e){null===Bi?Bi=[e]:Bi.push(e)}function Hi(){if(!Ui&&null!==Bi){Ui=!0;var e=0,t=bt;try{var n=Bi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Bi=null,Fi=!1}catch(i){throw null!==Bi&&(Bi=Bi.slice(e+1)),Xe(Qe,Hi),i}finally{bt=t,Ui=!1}}return null}var Gi=[],Vi=0,Wi=null,ji=0,Xi=[],Yi=0,Ki=null,qi=1,Ji="";function Zi(e,t){Gi[Vi++]=ji,Gi[Vi++]=Wi,Wi=e,ji=t}function Qi(e,t,n){Xi[Yi++]=qi,Xi[Yi++]=Ji,Xi[Yi++]=Ki,Ki=e;var r=qi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,qi=1<<32-st(t)+i|n<<i|r,Ji=o+e}else qi=1<<o|n<<i|r,Ji=e}function eo(e){null!==e.return&&(Zi(e,1),Qi(e,1,0))}function to(e){for(;e===Wi;)Wi=Gi[--Vi],Gi[Vi]=null,ji=Gi[--Vi],Gi[Vi]=null;for(;e===Ki;)Ki=Xi[--Yi],Xi[Yi]=null,Ji=Xi[--Yi],Xi[Yi]=null,qi=Xi[--Yi],Xi[Yi]=null}var no=null,ro=null,io=!1,oo=null;function so(e,t){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ao(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ki?{id:qi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Lc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(io){var t=ro;if(t){var n=t;if(!ao(e,t)){if(lo(e))throw Error(o(418));t=ci(n.nextSibling);var r=no;t&&ao(e,t)?so(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)so(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ci(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ci(e.nextSibling)}function fo(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=y.ReactCurrentBatchConfig;function vo(e,t){if(e&&e.defaultProps){for(var n in t=$({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var _o=wi(null),bo=null,yo=null,To=null;function Eo(){To=yo=bo=null}function So(e){var t=_o.current;xi(_o),e._currentValue=t}function wo(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xo(e,t){bo=e,To=yo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Mo(e){var t=e._currentValue;if(To!==e)if(e={context:e,memoizedValue:t,next:null},null===yo){if(null===bo)throw Error(o(308));yo=e,bo.dependencies={lanes:0,firstContext:e}}else yo=yo.next=e;return t}var Co=null;function Io(e){null===Co?Co=[e]:Co.push(e)}function ko(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Io(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ro(e,r)}function Ro(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ao=!1;function Lo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function No(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Po(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&kl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ro(e,n)}return null===(i=r.interleaved)?(t.next=t,Io(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ro(e,n)}function Do(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}function $o(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bo(e,t,n,r){var i=e.updateQueue;Ao=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(s=0,u=c=l=null,a=o;;){var d=a.lane,p=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=$({},h,d);break e;case 2:Ao=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);$l|=s,e.lanes=s,e.memoizedState=h}}function Fo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Uo=(new r.Component).refs;function zo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:$({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ho={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),o=No(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Po(e,o,i))&&(rc(t,e,i,r),Do(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),o=No(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Po(e,o,i))&&(rc(t,e,i,r),Do(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=No(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Po(e,i,r))&&(rc(t,e,r,n),Do(t,e,r))}};function Go(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function Vo(e,t,n){var r=!1,i=Ci,o=t.contextType;return"object"===typeof o&&null!==o?o=Mo(o):(i=Li(t)?Ri:Ii.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Ci),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ho,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Wo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ho.enqueueReplaceState(t,t.state,null)}function jo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Uo,Lo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Mo(o):(o=Li(t)?Ri:Ii.current,i.context=Ai(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(zo(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ho.enqueueReplaceState(i,i.state,null),Bo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Xo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===Uo&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ko(e){return(0,e._init)(e._payload)}function qo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Nc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Bc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===L&&Ko(o)===t.type)?((r=i(t,n.props)).ref=Xo(e,t,n),r.return=e,r):((r=Pc(n.type,n.key,n.props,null,e.mode,r)).ref=Xo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Dc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case T:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=Xo(e,null,t),n.return=e,n;case E:return(t=Fc(t,e.mode,n)).return=e,t;case L:return d(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Dc(t,e.mode,n,null)).return=e,t;Yo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case T:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case L:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||P(n))return null!==i?null:h(e,t,n,r,null);Yo(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case T:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case L:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||P(r))return h(t,e=e.get(n)||null,r,i,null);Yo(t,r)}return null}function m(i,o,a,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(i,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),o=s(v,o,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===a.length)return n(i,h),io&&Zi(i,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(o=s(h,o,m),null===u?c=h:u.sibling=h,u=h);return io&&Zi(i,m),c}for(h=r(i,h);m<a.length;m++)null!==(g=f(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),io&&Zi(i,m),c}function g(i,a,l,c){var u=P(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=a,g=a=0,v=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,_.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),a=s(b,a,g),null===h?u=b:h.sibling=b,h=b,m=v}if(_.done)return n(i,m),io&&Zi(i,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(i,_.value,c))&&(a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return io&&Zi(i,g),u}for(m=r(i,m);!_.done;g++,_=l.next())null!==(_=f(m,i,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(i,e)})),io&&Zi(i,g),u}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case T:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===L&&Ko(c)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=Xo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===S?((o=Dc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=Pc(s.type,s.key,s.props,null,r.mode,l)).ref=Xo(r,o,s),l.return=r,r=l)}return a(r);case E:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Fc(s,r.mode,l)).return=r,r=o}return a(r);case L:return e(r,o,(u=s._init)(s._payload),l)}if(te(s))return m(r,o,s,l);if(P(s))return g(r,o,s,l);Yo(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=Bc(s,r.mode,l)).return=r,r=o),a(r)):n(r,o)}}var Jo=qo(!0),Zo=qo(!1),Qo={},es=wi(Qo),ts=wi(Qo),ns=wi(Qo);function rs(e){if(e===Qo)throw Error(o(174));return e}function is(e,t){switch(Mi(ns,t),Mi(ts,e),Mi(es,Qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(es),Mi(es,t)}function os(){xi(es),xi(ts),xi(ns)}function ss(e){rs(ns.current);var t=rs(es.current),n=le(t,e.type);t!==n&&(Mi(ts,e),Mi(es,n))}function as(e){ts.current===e&&(xi(es),xi(ts))}var ls=wi(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function hs(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var ds=y.ReactCurrentDispatcher,ps=y.ReactCurrentBatchConfig,fs=0,ms=null,gs=null,vs=null,_s=!1,bs=!1,ys=0,Ts=0;function Es(){throw Error(o(321))}function Ss(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function ws(e,t,n,r,i,s){if(fs=s,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ds.current=null===e||null===e.memoizedState?aa:la,e=n(r,i),bs){s=0;do{if(bs=!1,ys=0,25<=s)throw Error(o(301));s+=1,vs=gs=null,t.updateQueue=null,ds.current=ca,e=n(r,i)}while(bs)}if(ds.current=sa,t=null!==gs&&null!==gs.next,fs=0,vs=gs=ms=null,_s=!1,t)throw Error(o(300));return e}function xs(){var e=0!==ys;return ys=0,e}function Ms(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vs?ms.memoizedState=vs=e:vs=vs.next=e,vs}function Cs(){if(null===gs){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=gs.next;var t=null===vs?ms.memoizedState:vs.next;if(null!==t)vs=t,gs=e;else{if(null===e)throw Error(o(310));e={memoizedState:(gs=e).memoizedState,baseState:gs.baseState,baseQueue:gs.baseQueue,queue:gs.queue,next:null},null===vs?ms.memoizedState=vs=e:vs=vs.next=e}return vs}function Is(e,t){return"function"===typeof t?t(e):t}function ks(e){var t=Cs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=gs,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((fs&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,ms.lanes|=h,$l|=h}u=u.next}while(null!==u&&u!==s);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ya=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,ms.lanes|=s,$l|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Rs(e){var t=Cs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);ar(s,t.memoizedState)||(ya=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function As(){}function Ls(e,t){var n=ms,r=Cs(),i=t(),s=!ar(r.memoizedState,i);if(s&&(r.memoizedState=i,ya=!0),r=r.queue,Vs(Ps.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==vs&&1&vs.memoizedState.tag){if(n.flags|=2048,Fs(9,Ns.bind(null,n,r,i,t),void 0,null),null===Rl)throw Error(o(349));0!==(30&fs)||Os(n,t,i)}return i}function Os(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Ds(t)&&$s(e)}function Ps(e,t,n){return n((function(){Ds(t)&&$s(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function $s(e){var t=Ro(e,1);null!==t&&rc(t,e,1,-1)}function Bs(e){var t=Ms();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,ms,e),[t.memoizedState,e]}function Fs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Us(){return Cs().memoizedState}function zs(e,t,n,r){var i=Ms();ms.flags|=e,i.memoizedState=Fs(1|t,n,void 0,void 0===r?null:r)}function Hs(e,t,n,r){var i=Cs();r=void 0===r?null:r;var o=void 0;if(null!==gs){var s=gs.memoizedState;if(o=s.destroy,null!==r&&Ss(r,s.deps))return void(i.memoizedState=Fs(t,n,o,r))}ms.flags|=e,i.memoizedState=Fs(1|t,n,o,r)}function Gs(e,t){return zs(8390656,8,e,t)}function Vs(e,t){return Hs(2048,8,e,t)}function Ws(e,t){return Hs(4,2,e,t)}function js(e,t){return Hs(4,4,e,t)}function Xs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ys(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Hs(4,4,Xs.bind(null,t,e),n)}function Ks(){}function qs(e,t){var n=Cs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ss(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Js(e,t){var n=Cs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ss(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Zs(e,t,n){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),ms.lanes|=n,$l|=n,e.baseState=!0),t)}function Qs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ps.transition;ps.transition={};try{e(!1),t()}finally{bt=n,ps.transition=r}}function ea(){return Cs().memoizedState}function ta(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e))ia(t,n);else if(null!==(n=ko(e,t,n,r))){rc(n,e,r,tc()),oa(n,t,r)}}function na(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))ia(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,s)){var l=t.interleaved;return null===l?(i.next=i,Io(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=ko(e,t,i,r))&&(rc(n,e,r,i=tc()),oa(n,t,r))}}function ra(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function ia(e,t){bs=_s=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}var sa={readContext:Mo,useCallback:Es,useContext:Es,useEffect:Es,useImperativeHandle:Es,useInsertionEffect:Es,useLayoutEffect:Es,useMemo:Es,useReducer:Es,useRef:Es,useState:Es,useDebugValue:Es,useDeferredValue:Es,useTransition:Es,useMutableSource:Es,useSyncExternalStore:Es,useId:Es,unstable_isNewReconciler:!1},aa={readContext:Mo,useCallback:function(e,t){return Ms().memoizedState=[e,void 0===t?null:t],e},useContext:Mo,useEffect:Gs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,Xs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){return zs(4,2,e,t)},useMemo:function(e,t){var n=Ms();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ms();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ta.bind(null,ms,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ms().memoizedState=e},useState:Bs,useDebugValue:Ks,useDeferredValue:function(e){return Ms().memoizedState=e},useTransition:function(){var e=Bs(!1),t=e[0];return e=Qs.bind(null,e[1]),Ms().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ms,i=Ms();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Rl)throw Error(o(349));0!==(30&fs)||Os(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Gs(Ps.bind(null,r,s,e),[e]),r.flags|=2048,Fs(9,Ns.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Ms(),t=Rl.identifierPrefix;if(io){var n=Ji;t=":"+t+"R"+(n=(qi&~(1<<32-st(qi)-1)).toString(32)+n),0<(n=ys++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ts++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Mo,useCallback:qs,useContext:Mo,useEffect:Vs,useImperativeHandle:Ys,useInsertionEffect:Ws,useLayoutEffect:js,useMemo:Js,useReducer:ks,useRef:Us,useState:function(){return ks(Is)},useDebugValue:Ks,useDeferredValue:function(e){return Zs(Cs(),gs.memoizedState,e)},useTransition:function(){return[ks(Is)[0],Cs().memoizedState]},useMutableSource:As,useSyncExternalStore:Ls,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Mo,useCallback:qs,useContext:Mo,useEffect:Vs,useImperativeHandle:Ys,useInsertionEffect:Ws,useLayoutEffect:js,useMemo:Js,useReducer:Rs,useRef:Us,useState:function(){return Rs(Is)},useDebugValue:Ks,useDeferredValue:function(e){var t=Cs();return null===gs?t.memoizedState=e:Zs(t,gs.memoizedState,e)},useTransition:function(){return[Rs(Is)[0],Cs().memoizedState]},useMutableSource:As,useSyncExternalStore:Ls,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ha(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=No(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,jl=r),da(0,t)},n}function ma(e,t,n){(n=No(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof r&&(null===Xl?Xl=new Set([this]):Xl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Mc.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _a(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=No(-1,1)).tag=2,Po(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=y.ReactCurrentOwner,ya=!1;function Ta(e,t,n,r){t.child=null===e?Zo(t,null,n,r):Jo(t,e.child,n,r)}function Ea(e,t,n,r,i){n=n.render;var o=t.ref;return xo(t,i),r=ws(e,t,n,r,o,i),n=xs(),null===e||ya?(io&&n&&eo(t),t.flags|=1,Ta(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function Sa(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Oc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,wa(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wa(e,t,i)}return t.flags|=1,(e=Nc(o,r)).ref=t.ref,e.return=t,t.child=e}function wa(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(ya=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Wa(e,t,i);0!==(131072&e.flags)&&(ya=!0)}}return Ca(e,t,n,r,i)}function xa(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(Nl,Ol),Ol|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mi(Nl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Mi(Nl,Ol),Ol|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Mi(Nl,Ol),Ol|=r;return Ta(e,t,i,n),t.child}function Ma(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,r,i){var o=Li(n)?Ri:Ii.current;return o=Ai(t,o),xo(t,i),n=ws(e,t,n,r,o,i),r=xs(),null===e||ya?(io&&r&&eo(t),t.flags|=1,Ta(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function Ia(e,t,n,r,i){if(Li(n)){var o=!0;Di(t)}else o=!1;if(xo(t,i),null===t.stateNode)Va(e,t),Vo(t,n,r),jo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Mo(c):c=Ai(t,c=Li(n)?Ri:Ii.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==c)&&Wo(t,s,r,c),Ao=!1;var d=t.memoizedState;s.state=d,Bo(t,r,s,i),l=t.memoizedState,a!==r||d!==l||ki.current||Ao?("function"===typeof u&&(zo(t,n,u,r),l=t.memoizedState),(a=Ao||Go(t,n,a,r,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Oo(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:vo(t.type,a),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Mo(l):l=Ai(t,l=Li(n)?Ri:Ii.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==h||d!==l)&&Wo(t,s,r,l),Ao=!1,d=t.memoizedState,s.state=d,Bo(t,r,s,i);var f=t.memoizedState;a!==h||d!==f||ki.current||Ao?("function"===typeof p&&(zo(t,n,p,r),f=t.memoizedState),(c=Ao||Go(t,n,c,r,d,f,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return ka(e,t,n,r,o,i)}function ka(e,t,n,r,i,o){Ma(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&$i(t,n,!1),Wa(e,t,o);r=t.stateNode,ba.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Jo(t,e.child,null,o),t.child=Jo(t,null,a,o)):Ta(e,t,a,o),t.memoizedState=r.state,i&&$i(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Ni(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ni(0,t.context,!1),is(e,t.containerInfo)}function Aa(e,t,n,r,i){return fo(),mo(i),t.flags|=256,Ta(e,t,n,r),t.child}var La,Oa,Na,Pa,Da={dehydrated:null,treeContext:null,retryLane:0};function $a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,n){var r,i=t.pendingProps,s=ls.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Mi(ls,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=$c(l,i,0,null),e=Dc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$a(n),t.memoizedState=Da,e):Fa(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,r=ha(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=$c({mode:"visible",children:r.children},i,0,null),(s=Dc(s,i,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&Jo(t,e.child,null,a),t.child.memoizedState=$a(a),t.memoizedState=Da,s);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ua(e,t,a,r=ha(s=Error(o(419)),r,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(r=Rl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Ro(e,i),rc(r,e,i,-1))}return gc(),Ua(e,t,a,r=ha(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ro=ci(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Xi[Yi++]=qi,Xi[Yi++]=Ji,Xi[Yi++]=Ki,qi=e.id,Ji=e.overflow,Ki=t),t=Fa(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(a){a=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Nc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Nc(r,a):(a=Dc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?$a(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Da,i}return e=(a=e.child).sibling,i=Nc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fa(e,t){return(t=$c({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,r){return null!==r&&mo(r),Jo(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function za(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wo(e.return,t,n)}function Ha(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ga(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ta(e,t,r.children,n),0!==(2&(r=ls.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&za(e,n,t);else if(19===e.tag)za(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mi(ls,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===cs(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ha(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===cs(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ha(t,!0,n,null,o);break;case"together":Ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),$l|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Nc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Nc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ja(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ya(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(t),null;case 1:case 17:return Li(t.type)&&Oi(),Xa(t),null;case 3:return r=t.stateNode,os(),xi(ki),xi(Ii),hs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Oa(e,t),Xa(t),null;case 5:as(t);var i=rs(ns.current);if(n=t.type,null!==e&&null!=t.stateNode)Na(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Xa(t),null}if(e=rs(es.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[di]=t,r[pi]=s,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Pr.length;i++)Fr(Pr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":q(r,s),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",r);break;case"textarea":ie(r,s),Fr("invalid",r)}for(var l in _e(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":j(r),Q(r,s,!0);break;case"textarea":j(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Qr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[pi]=r,La(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),i=r;break;case"iframe":case"object":case"embed":Fr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Pr.length;i++)Fr(Pr[i],e);i=r;break;case"source":Fr("error",e),i=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=r;break;case"details":Fr("toggle",e),i=r;break;case"input":q(e,r),i=K(e,r),Fr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=$({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Fr("invalid",e)}for(s in _e(n,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Fr("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":j(e),Q(e,r,!1);break;case"textarea":j(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Qr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xa(t),null;case 6:if(e&&null!=t.stateNode)Pa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=rs(ns.current),rs(es.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Xa(t),null;case 13:if(xi(ls),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[di]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xa(t),s=!1}else null!==oo&&(ac(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ls.current)?0===Pl&&(Pl=3):gc())),null!==t.updateQueue&&(t.flags|=4),Xa(t),null);case 4:return os(),Oa(e,t),null===e&&Hr(t.stateNode.containerInfo),Xa(t),null;case 10:return So(t.type._context),Xa(t),null;case 19:if(xi(ls),null===(s=t.memoizedState))return Xa(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)ja(s,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=cs(e))){for(t.flags|=128,ja(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mi(ls,1&ls.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Gl&&(t.flags|=128,r=!0,ja(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=cs(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ja(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!io)return Xa(t),null}else 2*Je()-s.renderingStartTime>Gl&&1073741824!==n&&(t.flags|=128,r=!0,ja(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=ls.current,Mi(ls,r?1&n|2:1&n),t):(Xa(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ol)&&(Xa(t),6&t.subtreeFlags&&(t.flags|=8192)):Xa(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ka(e,t){switch(to(t),t.tag){case 1:return Li(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return os(),xi(ki),xi(Ii),hs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(xi(ls),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(ls),null;case 4:return os(),null;case 10:return So(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}La=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oa=function(){},Na=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,rs(es.current);var o,s=null;switch(n){case"input":i=K(e,i),r=K(e,r),s=[];break;case"select":i=$({},i,{value:void 0}),r=$({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Qr)}for(u in _e(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Pa=function(e,t,n,r){n!==r&&(t.flags|=4)};var qa=!1,Ja=!1,Za="function"===typeof WeakSet?WeakSet:Set,Qa=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){xc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){xc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tl(t,n,o)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[pi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ja||el(n,t);case 6:var r=hl,i=dl;hl=null,pl(e,t,n),dl=i,null!==(hl=r)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Ht(e)):li(hl,n.stateNode));break;case 4:r=hl,i=dl,hl=n.stateNode.containerInfo,dl=!0,pl(e,t,n),hl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&tl(n,t,s),i=i.next}while(i!==r)}pl(e,t,n);break;case 1:if(!Ja&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xc(n,t,a)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Ja=(r=Ja)||null!==n.memoizedState,pl(e,t,n),Ja=r):pl(e,t,n);break;default:pl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach((function(t){var r=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(o(160));fl(s,a,i),hl=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){xc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),_l(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){xc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){xc(e,e.return,g)}}break;case 1:gl(t,e),_l(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),_l(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){xc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(i,s),be(l,a);var u=be(l,s);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,u)}switch(l){case"input":Z(i,s);break;case"textarea":oe(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(i,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[pi]=s}catch(g){xc(e,e.return,g)}}break;case 6:if(gl(t,e),_l(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){xc(e,e.return,g)}}break;case 3:if(gl(t,e),_l(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){xc(e,e.return,g)}break;case 4:default:gl(t,e),_l(e);break;case 13:gl(t,e),_l(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Hl=Je())),4&r&&ml(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||h,gl(t,e),Ja=u):gl(t,e),_l(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qa=e,h=e.child;null!==h;){for(d=Qa=h;null!==Qa;){switch(f=(p=Qa).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){xc(r,n,g)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){El(d);continue}}null!==f?(f.return=p,Qa=f):El(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){xc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){xc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),_l(e),4&r&&ml(e);case 21:}}function _l(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(o(161))}}catch(a){xc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Qa=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==Qa;){var i=Qa,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||qa;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=qa;var c=Ja;if(qa=s,(Ja=l)&&!c)for(Qa=i;null!==Qa;)l=(s=Qa).child,22===s.tag&&null!==s.memoizedState?Sl(i):null!==l?(l.return=s,Qa=l):Sl(i);for(;null!==o;)Qa=o,yl(o,t,n),o=o.sibling;Qa=i,qa=a,Ja=c}Tl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Qa=o):Tl(e)}}function Tl(e){for(;null!==Qa;){var t=Qa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ja)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:vo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Fo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Fo(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ht(d)}}}break;default:throw Error(o(163))}Ja||512&t.flags&&ol(t)}catch(p){xc(t,t.return,p)}}if(t===e){Qa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qa=n;break}Qa=t.return}}function El(e){for(;null!==Qa;){var t=Qa;if(t===e){Qa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qa=n;break}Qa=t.return}}function Sl(e){for(;null!==Qa;){var t=Qa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){xc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){xc(t,i,l)}}var o=t.return;try{ol(t)}catch(l){xc(t,o,l)}break;case 5:var s=t.return;try{ol(t)}catch(l){xc(t,s,l)}}}catch(l){xc(t,t.return,l)}if(t===e){Qa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Qa=a;break}Qa=t.return}}var wl,xl=Math.ceil,Ml=y.ReactCurrentDispatcher,Cl=y.ReactCurrentOwner,Il=y.ReactCurrentBatchConfig,kl=0,Rl=null,Al=null,Ll=0,Ol=0,Nl=wi(0),Pl=0,Dl=null,$l=0,Bl=0,Fl=0,Ul=null,zl=null,Hl=0,Gl=1/0,Vl=null,Wl=!1,jl=null,Xl=null,Yl=!1,Kl=null,ql=0,Jl=0,Zl=null,Ql=-1,ec=0;function tc(){return 0!==(6&kl)?Je():-1!==Ql?Ql:Ql=Je()}function nc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Ll?Ll&-Ll:null!==go.transition?(0===ec&&(ec=mt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:qt(e.type)}function rc(e,t,n,r){if(50<Jl)throw Jl=0,Zl=null,Error(o(185));vt(e,n,r),0!==(2&kl)&&e===Rl||(e===Rl&&(0===(2&kl)&&(Bl|=n),4===Pl&&lc(e,Ll)),ic(e,r),1===n&&0===kl&&0===(1&t.mode)&&(Gl=Je()+500,Fi&&Hi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=pt(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=dt(e,e===Rl?Ll:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Fi=!0,zi(e)}(cc.bind(null,e)):zi(cc.bind(null,e)),si((function(){0===(6&kl)&&Hi()})),n=null;else{switch(yt(r)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Ql=-1,ec=0,0!==(6&kl))throw Error(o(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=dt(e,e===Rl?Ll:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=kl;kl|=2;var s=mc();for(Rl===e&&Ll===t||(Vl=null,Gl=Je()+500,pc(e,t));;)try{bc();break}catch(l){fc(e,l)}Eo(),Ml.current=s,kl=i,null!==Al?t=0:(Rl=null,Ll=0,t=Pl)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=sc(e,i))),1===t)throw n=Dl,pc(e,0),lc(e,r),ic(e,Je()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ar(o(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(s=ft(e))&&(r=s,t=sc(e,s))),1===t))throw n=Dl,pc(e,0),lc(e,r),ic(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Ec(e,zl,Vl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Hl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Ec.bind(null,e,zl,Vl),t);break}Ec(e,zl,Vl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>i&&(i=a),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xl(r/1960))-r)){e.timeoutHandle=ri(Ec.bind(null,e,zl,Vl),r);break}Ec(e,zl,Vl);break;default:throw Error(o(329))}}}return ic(e,Je()),e.callbackNode===n?oc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~Fl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&kl))throw Error(o(327));Sc();var t=dt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Dl,pc(e,0),lc(e,t),ic(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,zl,Vl),ic(e,Je()),null}function uc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Gl=Je()+500,Fi&&Hi())}}function hc(e){null!==Kl&&0===Kl.tag&&0===(6&kl)&&Sc();var t=kl;kl|=1;var n=Il.transition,r=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=r,Il.transition=n,0===(6&(kl=t))&&Hi()}}function dc(){Ol=Nl.current,xi(Nl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:os(),xi(ki),xi(Ii),hs();break;case 5:as(r);break;case 4:os();break;case 13:case 19:xi(ls);break;case 10:So(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Rl=e,Al=e=Nc(e.current,null),Ll=Ol=t,Pl=0,Dl=null,Fl=Bl=$l=0,zl=Ul=null,null!==Co){for(t=0;t<Co.length;t++)if(null!==(r=(n=Co[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}Co=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Eo(),ds.current=sa,_s){for(var r=ms.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}_s=!1}if(fs=0,vs=gs=ms=null,bs=!1,ys=0,Cl.current=null,null===n||null===n.return){Pl=1,Dl=t,Al=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Ll,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,_a(f,a,l,0,t),1&f.mode&&ga(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ga(s,u,t),gc();break e}c=Error(o(426))}else if(io&&1&l.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),_a(v,a,l,0,t),mo(ua(c,l));break e}}s=c=ua(c,l),4!==Pl&&(Pl=2),null===Ul?Ul=[s]:Ul.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,$o(s,fa(0,c,t));break e;case 1:l=c;var _=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof _.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xl||!Xl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,$o(s,ma(s,l,t));break e}}s=s.return}while(null!==s)}Tc(n)}catch(y){t=y,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function mc(){var e=Ml.current;return Ml.current=sa,null===e?sa:e}function gc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Rl||0===(268435455&$l)&&0===(268435455&Bl)||lc(Rl,Ll)}function vc(e,t){var n=kl;kl|=2;var r=mc();for(Rl===e&&Ll===t||(Vl=null,pc(e,t));;)try{_c();break}catch(i){fc(e,i)}if(Eo(),kl=n,Ml.current=r,null!==Al)throw Error(o(261));return Rl=null,Ll=0,Pl}function _c(){for(;null!==Al;)yc(Al)}function bc(){for(;null!==Al&&!Ke();)yc(Al)}function yc(e){var t=wl(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?Tc(e):Al=t,Cl.current=null}function Tc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ya(n,t,Ol)))return void(Al=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Pl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Pl&&(Pl=5)}function Ec(e,t,n){var r=bt,i=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Kl);if(0!==(6&kl))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Rl&&(Al=Rl=null,Ll=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Rc(tt,(function(){return Sc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Il.transition,Il.transition=null;var a=bt;bt=1;var l=kl;kl|=4,Cl.current=null,function(e,t){if(ei=Vt,pr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(T){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==s||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===i&&(l=a),p===s&&++h===r&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Vt=!1,Qa=t;null!==Qa;)if(e=(t=Qa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qa=e;else for(;null!==Qa;){t=Qa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:vo(t.type,g),v);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(o(163))}}catch(T){xc(t,t.return,T)}if(null!==(e=t.sibling)){e.return=t.return,Qa=e;break}Qa=t.return}m=nl,nl=!1}(e,n),vl(n,e),fr(ti),Vt=!!ei,ti=ei=null,e.current=n,bl(n,e,i),qe(),kl=l,bt=a,Il.transition=s}else e.current=n;if(Yl&&(Yl=!1,Kl=e,ql=i),s=e.pendingLanes,0===s&&(Xl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=jl,jl=null,e;0!==(1&ql)&&0!==e.tag&&Sc(),s=e.pendingLanes,0!==(1&s)?e===Zl?Jl++:(Jl=0,Zl=e):Jl=0,Hi()}(e,t,n,r)}finally{Il.transition=i,bt=r}return null}function Sc(){if(null!==Kl){var e=yt(ql),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,ql=0,0!==(6&kl))throw Error(o(331));var i=kl;for(kl|=4,Qa=e.current;null!==Qa;){var s=Qa,a=s.child;if(0!==(16&Qa.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qa=u;null!==Qa;){var h=Qa;switch(h.tag){case 0:case 11:case 15:rl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Qa=d;else for(;null!==Qa;){var p=(h=Qa).sibling,f=h.return;if(sl(h),h===u){Qa=null;break}if(null!==p){p.return=f,Qa=p;break}Qa=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Qa=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Qa=a;else e:for(;null!==Qa;){if(0!==(2048&(s=Qa).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var _=s.sibling;if(null!==_){_.return=s.return,Qa=_;break e}Qa=s.return}}var b=e.current;for(Qa=b;null!==Qa;){var y=(a=Qa).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,Qa=y;else e:for(a=b;null!==Qa;){if(0!==(2048&(l=Qa).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){xc(l,l.return,E)}if(l===a){Qa=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,Qa=T;break e}Qa=l.return}}if(kl=i,Hi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{bt=n,Il.transition=t}}return!1}function wc(e,t,n){e=Po(e,t=fa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ic(e,t))}function xc(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xl||!Xl.has(r))){t=Po(t,e=ma(t,e=ua(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Mc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Ll&n)===n&&(4===Pl||3===Pl&&(130023424&Ll)===Ll&&500>Je()-Hl?pc(e,0):Fl|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ro(e,t))&&(vt(e,t,n),ic(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Cc(e,n)}function Rc(e,t){return Xe(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(e,t,n,r){return new Ac(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nc(e,t){var n=e.alternate;return null===n?((n=Lc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,r,i,s){var a=2;if(r=e,"function"===typeof e)Oc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Dc(n.children,i,s,t);case w:a=8,i|=8;break;case x:return(e=Lc(12,n,t,2|i)).elementType=x,e.lanes=s,e;case k:return(e=Lc(13,n,t,i)).elementType=k,e.lanes=s,e;case R:return(e=Lc(19,n,t,i)).elementType=R,e.lanes=s,e;case O:return $c(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case M:a=10;break e;case C:a=9;break e;case I:a=11;break e;case A:a=14;break e;case L:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Lc(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Dc(e,t,n,r){return(e=Lc(7,e,r,t)).lanes=n,e}function $c(e,t,n,r){return(e=Lc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Lc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Lc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,o,s,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Lc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lo(o),e}function Hc(e){if(!e)return Ci;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Li(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Li(n))return Pi(e,n,t)}return t}function Gc(e,t,n,r,i,o,s,a,l){return(e=zc(n,r,!0,e,0,o,0,a,l)).context=Hc(null),n=e.current,(o=No(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Po(n,o,i),e.current.lanes=i,vt(e,i,r),ic(e,r),e}function Vc(e,t,n,r){var i=t.current,o=tc(),s=nc(i);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=No(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Po(i,t,s))&&(rc(e,i,s,o),Do(e,i,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xc(e,t){jc(e,t),(e=e.alternate)&&jc(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ki.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),fo();break;case 5:ss(t);break;case 1:Li(t.type)&&Di(t);break;case 4:is(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Mi(_o,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Mi(ls,1&ls.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ba(e,t,n):(Mi(ls,1&ls.current),null!==(e=Wa(e,t,n))?e.sibling:null);Mi(ls,1&ls.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ga(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mi(ls,ls.current),r)break;return null;case 22:case 23:return t.lanes=0,xa(e,t,n)}return Wa(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,io&&0!==(1048576&t.flags)&&Qi(t,ji,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=Ai(t,Ii.current);xo(t,n),i=ws(null,t,r,e,i,n);var s=xs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Li(r)?(s=!0,Di(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Lo(t),i.updater=Ho,t.stateNode=i,i._reactInternals=t,jo(t,r,e,n),t=ka(null,t,r,!0,s,n)):(t.tag=0,io&&s&&eo(t),Ta(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===A)return 14}return 2}(r),e=vo(r,e),i){case 0:t=Ca(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=Ea(null,t,r,e,n);break e;case 14:t=Sa(null,t,r,vo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ca(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 3:e:{if(Ra(t),null===e)throw Error(o(387));r=t.pendingProps,i=(s=t.memoizedState).element,Oo(e,t),Bo(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Aa(e,t,r,n,i=ua(Error(o(423)),t));break e}if(r!==i){t=Aa(e,t,r,n,i=ua(Error(o(424)),t));break e}for(ro=ci(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Zo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){t=Wa(e,t,n);break e}Ta(e,t,r,n)}t=t.child}return t;case 5:return ss(t),null===e&&co(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==s&&ni(r,s)&&(t.flags|=32),Ma(e,t),Ta(e,t,a,n),t.child;case 6:return null===e&&co(t),null;case 13:return Ba(e,t,n);case 4:return is(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Jo(t,null,r,n):Ta(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:vo(r,i),n);case 7:return Ta(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ta(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Mi(_o,r._currentValue),r._currentValue=a,null!==s)if(ar(s.value,a)){if(s.children===i.children&&!ki.current){t=Wa(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=No(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),wo(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),wo(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Ta(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,xo(t,n),r=r(i=Mo(i)),t.flags|=1,Ta(e,t,r,n),t.child;case 14:return i=vo(r=t.type,t.pendingProps),Sa(e,t,r,i=vo(r.type,i),n);case 15:return wa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vo(r,i),Va(e,t),t.tag=1,Li(r)?(e=!0,Di(t)):e=!1,xo(t,n),Vo(t,r,i),jo(t,r,i,n),ka(null,t,r,!0,e,n);case 19:return Ga(e,t,n);case 22:return xa(e,t,n)}throw Error(o(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function eu(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=Wc(s);a.call(e)}}Vc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Wc(s);o.call(e)}}var s=Gc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=s,e[fi]=s.current,Hr(8===e.nodeType?e.parentNode:e),hc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Wc(l);a.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fi]=l.current,Hr(8===e.nodeType?e.parentNode:e),hc((function(){Vc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(s)}qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vc(e,t,null,null)},qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Vc(null,e,null,null)})),t[fi]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&$t(e)}},Tt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(_t(t,1|n),ic(t,Je()),0===(6&kl)&&(Gl=Je()+500,Hi()))}break;case 13:hc((function(){var t=Ro(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Xc(e,1)}},Et=function(e){if(13===e.tag){var t=Ro(e,134217728);if(null!==t)rc(t,e,134217728,tc());Xc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Ro(e,t);if(null!==n)rc(n,e,t,tc());Xc(e,t)}},wt=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ti(r);if(!i)throw Error(o(90));X(r),Z(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=uc,ke=hc;var tu={usingClientEntryPoint:!1,Events:[bi,yi,Ti,Me,Ce,uc]},nu={findFiberByHostInstance:_i,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),ot=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(o(299));var n=!1,r="",i=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(o(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",a=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Gc(t,null,e,1,null!=n?n:null,i,0,s,a),e[fi]=t.current,Hr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new qc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(o(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(o(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{"use strict";var r=n(791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:a.current}}t.jsx=c,t.jsxs=c},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function _(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=v.prototype;var y=b.prototype=new _;y.constructor=b,m(y,v.prototype),y.isPureReactComponent=!0;var T=Array.isArray,E=Object.prototype.hasOwnProperty,S={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,i)&&!w.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:S.current}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+I(l,0):o,T(s)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),k(s,t,i,"",(function(e){return e}))):null!=s&&(M(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",T(e))for(var c=0;c<e.length;c++){var u=o+I(a=e[c],c);l+=k(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=k(a=a.value,t,i,u=o+I(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},O={transition:null},N={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!w.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,n){return L.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,n){return L.current.useReducer(e,t,n)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return L.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return L.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function T(e){if(g=!1,y(e),!m)if(null!==r(c))m=!0,O(E);else{var t=r(u);null!==t&&N(T,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,_(M),M=-1),f=!0;var o=p;try{for(y(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!k());){var s=d.callback;if("function"===typeof s){d.callback=null,p=d.priorityLevel;var a=s(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),y(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&N(T,h.startTime-n),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,w=!1,x=null,M=-1,C=5,I=-1;function k(){return!(t.unstable_now()-I<C)}function R(){if(null!==x){var e=t.unstable_now();I=e;var n=!0;try{n=x(!0,e)}finally{n?S():(w=!1,x=null)}}else w=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,L=A.port2;A.port1.onmessage=R,S=function(){L.postMessage(null)}}else S=function(){v(R,0)};function O(e){x=e,w||(w=!0,S())}function N(e,n){M=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(_(M),M=-1):g=!0,N(T,o-s))):(e.sortIndex=a,n(c,e),m||f||(m=!0,O(E))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},561:(e,t,n)=>{"use strict";var r=n(791);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,s=r.useEffect,a=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,u=r[1];return a((function(){i.value=n,i.getSnapshot=t,c(i)&&u({inst:i})}),[e,n,t]),s((function(){return c(i)&&u({inst:i}),e((function(){c(i)&&u({inst:i})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},595:(e,t,n)=>{"use strict";var r=n(791),i=n(248);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=i.useSyncExternalStore,a=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=c((function(){function e(e){if(!l){if(l=!0,s=e,e=r(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return a=t}return a=e}if(t=a,o(s,e))return t;var n=r(e);return void 0!==i&&i(t,n)?t:(s=e,a=n)}var s,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,i]);var p=s(e,h[0],h[1]);return l((function(){d.hasValue=!0,d.value=p}),[p]),u(p),p}},248:(e,t,n)=>{"use strict";e.exports=n(561)},327:(e,t,n)=>{"use strict";e.exports=n(595)},174:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var i=Object.create(null);__webpack_require__.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,__webpack_require__.d(i,o),i}})(),__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>"static/js/"+e+".578359c5.chunk.js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="my-blockly-app:";__webpack_require__.l=(n,r,i,o)=>{if(e[n])e[n].push(r);else{var s,a;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[r];var h=(t,r)=>{s.onerror=s.onload=null,clearTimeout(d);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(r))),t)return t(r)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),a&&document.head.appendChild(s)}}})(),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/gpu-programming/",(()=>{var e={179:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,o=n[0],s=n[1],a=n[2],l=0;if(o.some((t=>0!==e[t]))){for(r in s)__webpack_require__.o(s,r)&&(__webpack_require__.m[r]=s[r]);if(a)a(__webpack_require__)}for(t&&t(n);l<o.length;l++)i=o[l],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkmy_blockly_app=self.webpackChunkmy_blockly_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(791),t=__webpack_require__.t(e,2),n=__webpack_require__(250),r=(__webpack_require__(174),__webpack_require__(271));const i="143",o={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},s={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a=0,l=1,c=2,u=1,h=2,d=3,p=0,f=1,m=2,g=0,v=1,_=2,b=3,y=4,T=5,E=100,S=101,w=102,x=103,M=104,C=200,I=201,k=202,R=203,A=204,L=205,O=206,N=207,P=208,D=209,$=210,B=0,F=1,U=2,z=3,H=4,G=5,V=6,W=7,j=0,X=1,Y=2,K=0,q=1,J=2,Z=3,Q=4,ee=5,te=300,ne=301,re=302,ie=303,oe=304,se=306,ae=1e3,le=1001,ce=1002,ue=1003,he=1004,de=1005,pe=1006,fe=1007,me=1008,ge=1009,ve=1010,_e=1011,be=1012,ye=1013,Te=1014,Ee=1015,Se=1016,we=1017,xe=1018,Me=1020,Ce=1021,Ie=1022,ke=1023,Re=1024,Ae=1025,Le=1026,Oe=1027,Ne=1028,Pe=1029,De=1030,$e=1031,Be=1033,Fe=33776,Ue=33777,ze=33778,He=33779,Ge=35840,Ve=35841,We=35842,je=35843,Xe=36196,Ye=37492,Ke=37496,qe=37808,Je=37809,Ze=37810,Qe=37811,et=37812,tt=37813,nt=37814,rt=37815,it=37816,ot=37817,st=37818,at=37819,lt=37820,ct=37821,ut=36492,ht=2300,dt=2301,pt=2302,ft=2400,mt=2401,gt=2402,vt=2500,_t=2501,bt=3e3,yt=3001,Tt=3200,Et=3201,St=0,wt=1,xt="srgb",Mt="srgb-linear",Ct=7680,It=35044,kt=35048,Rt="300 es",At=1035;class Lt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const Ot=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Nt=1234567;const Pt=Math.PI/180,Dt=180/Math.PI;function $t(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Ot[255&e]+Ot[e>>8&255]+Ot[e>>16&255]+Ot[e>>24&255]+"-"+Ot[255&t]+Ot[t>>8&255]+"-"+Ot[t>>16&15|64]+Ot[t>>24&255]+"-"+Ot[63&n|128]+Ot[n>>8&255]+"-"+Ot[n>>16&255]+Ot[n>>24&255]+Ot[255&r]+Ot[r>>8&255]+Ot[r>>16&255]+Ot[r>>24&255]).toLowerCase()}function Bt(e,t,n){return Math.max(t,Math.min(n,e))}function Ft(e,t){return(e%t+t)%t}function Ut(e,t,n){return(1-n)*e+n*t}function zt(e){return 0===(e&e-1)&&0!==e}function Ht(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Gt(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var Vt=Object.freeze({__proto__:null,DEG2RAD:Pt,RAD2DEG:Dt,generateUUID:$t,clamp:Bt,euclideanModulo:Ft,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Ut,damp:function(e,t,n,r){return Ut(e,t,1-Math.exp(-n*r))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Ft(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Nt=e);let t=Nt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Pt},radToDeg:function(e){return e*Dt},isPowerOfTwo:zt,ceilPowerOfTwo:Ht,floorPowerOfTwo:Gt,setQuaternionFromProperEuler:function(e,t,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),l=s(n/2),c=o((t+r)/2),u=s((t+r)/2),h=o((t-r)/2),d=s((t-r)/2),p=o((r-t)/2),f=s((r-t)/2);switch(i){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*f,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*f,a*c);break;case"ZYZ":e.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}},denormalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}});class Wt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Wt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class jt{constructor(){jt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,i,o,s,a,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],_=r[4],b=r[7],y=r[2],T=r[5],E=r[8];return i[0]=o*f+s*v+a*y,i[3]=o*m+s*_+a*T,i[6]=o*g+s*b+a*E,i[1]=l*f+c*v+u*y,i[4]=l*m+c*_+u*T,i[7]=l*g+c*b+u*E,i[2]=h*f+d*v+p*y,i[5]=h*m+d*_+p*T,i[8]=h*g+d*b+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*o*c-t*s*l-n*i*c+n*s*a+r*i*l-r*o*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=c*o-s*l,h=s*a-c*i,d=l*i-o*a,p=t*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(r*l-c*n)*f,e[2]=(s*n-r*o)*f,e[3]=h*f,e[4]=(c*t-r*a)*f,e[5]=(r*i-s*t)*f,e[6]=d*f,e[7]=(n*a-l*t)*f,e[8]=(o*t-n*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,s){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*o+l*s)+o+e,-r*l,r*a,-r*(-l*o+a*s)+s+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],s=r[6],a=r[1],l=r[4],c=r[7];return r[0]=t*i+n*a,r[3]=t*o+n*l,r[6]=t*s+n*c,r[1]=-n*i+t*a,r[4]=-n*o+t*l,r[7]=-n*s+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Xt(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}const Yt={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Kt(e,t){return new Yt[e](t)}function qt(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Jt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Zt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const Qt={[xt]:{[Mt]:Jt},[Mt]:{[xt]:Zt}},en={legacyMode:!0,get workingColorSpace(){return Mt},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(Qt[t]&&void 0!==Qt[t][n]){const r=Qt[t][n];return e.r=r(e.r),e.g=r(e.g),e.b=r(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},tn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nn={r:0,g:0,b:0},rn={h:0,s:0,l:0},on={h:0,s:0,l:0};function sn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function an(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}class ln{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,en.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mt;return this.r=e,this.g=t,this.b=n,en.toWorkingColorSpace(this,r),this}setHSL(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mt;if(e=Ft(e,1),t=Bt(t,0,1),n=Bt(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=sn(i,r,e+1/3),this.g=sn(i,r,e),this.b=sn(i,r,e-1/3)}return en.toWorkingColorSpace(this,r),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const i=t[1],o=t[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,en.toWorkingColorSpace(this,n),r(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,en.toWorkingColorSpace(this,n),r(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const t=parseFloat(e[1])/360,i=parseInt(e[2],10)/100,o=parseInt(e[3],10)/100;return r(e[4]),this.setHSL(t,i,o,n)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=t[1],r=e.length;if(3===r)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,en.toWorkingColorSpace(this,n),this;if(6===r)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,en.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;const n=tn[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Jt(e.r),this.g=Jt(e.g),this.b=Jt(e.b),this}copyLinearToSRGB(e){return this.r=Zt(e.r),this.g=Zt(e.g),this.b=Zt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return en.fromWorkingColorSpace(an(this,nn),e),Bt(255*nn.r,0,255)<<16^Bt(255*nn.g,0,255)<<8^Bt(255*nn.b,0,255)<<0}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt;en.fromWorkingColorSpace(an(this,nn),t);const n=nn.r,r=nn.g,i=nn.b,o=Math.max(n,r,i),s=Math.min(n,r,i);let a,l;const c=(s+o)/2;if(s===o)a=0,l=0;else{const e=o-s;switch(l=c<=.5?e/(o+s):e/(2-o-s),o){case n:a=(r-i)/e+(r<i?6:0);break;case r:a=(i-n)/e+2;break;case i:a=(n-r)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt;return en.fromWorkingColorSpace(an(this,nn),t),e.r=nn.r,e.g=nn.g,e.b=nn.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return en.fromWorkingColorSpace(an(this,nn),e),e!==xt?"color(".concat(e," ").concat(nn.r," ").concat(nn.g," ").concat(nn.b,")"):"rgb(".concat(255*nn.r|0,",").concat(255*nn.g|0,",").concat(255*nn.b|0,")")}offsetHSL(e,t,n){return this.getHSL(rn),rn.h+=e,rn.s+=t,rn.l+=n,this.setHSL(rn.h,rn.s,rn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(rn),e.getHSL(on);const n=Ut(rn.h,on.h,t),r=Ut(rn.s,on.s,t),i=Ut(rn.l,on.l,t);return this.setHSL(n,r,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let cn;ln.NAMES=tn;class un{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===cn&&(cn=qt("canvas")),cn.width=e.width,cn.height=e.height;const n=cn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=cn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=qt("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*Jt(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*Jt(t[e]/255)):t[e]=Jt(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class hn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=$t(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(dn(r[t].image)):e.push(dn(r[t]))}else e=dn(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function dn(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?un.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let pn=0;class fn extends Lt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fn.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fn.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:le,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pe,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ke,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:ge,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:bt;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:pn++}),this.uuid=$t(),this.name="",this.source=new hn(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=a,this.offset=new Wt(0,0),this.repeat=new Wt(1,1),this.center=new Wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==te)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ae:e.x=e.x-Math.floor(e.x);break;case le:e.x=e.x<0?0:1;break;case ce:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ae:e.y=e.y-Math.floor(e.y);break;case le:e.y=e.y<0?0:1;break;case ce:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}fn.DEFAULT_IMAGE=null,fn.DEFAULT_MAPPING=te;class mn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;mn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const o=e.elements,s=o[0],a=o[4],l=o[8],c=o[1],u=o[5],h=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(s+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(s+1)/2,o=(u+1)/2,m=(f+1)/2,g=(a+c)/4,v=(l+d)/4,_=(h+p)/4;return e>o&&e>m?e<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=g/n,i=v/n):o>m?o<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=g/r,i=_/r):m<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(m),n=v/i,r=_/i),this.set(n,r,i,t),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(c-a)/m,this.w=Math.acos((s+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class gn extends Lt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new mn(0,0,e,t),this.scissorTest=!1,this.viewport=new mn(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new fn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:pe,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new hn(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vn extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ue,this.minFilter=ue,this.wrapR=le,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _n extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ue,this.minFilter=ue,this.wrapR=le,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,s){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(0===s)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||a!==h||l!==d||c!==p){let e=1-s;const t=a*h+l*d+c*p+u*f,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,t*n);e=Math.sin(e*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*e+h*i,l=l*e+d*i,c=c*e+p*i,u=u*e+f*i,e===1-s){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,o){const s=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],d=i[o+2],p=i[o+3];return e[t]=s*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-s*d,e[t+2]=l*p+c*d+s*h-a*u,e[t+3]=c*p-s*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,i=e._z,o=e._order,s=Math.cos,a=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=a(n/2),d=a(r/2),p=a(i/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+s+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-l)*e,this._z=(o-r)*e}else if(n>s&&n>u){const e=2*Math.sqrt(1+n-s-u);this._w=(c-a)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(i+l)/e}else if(s>u){const e=2*Math.sqrt(1+s-n-u);this._w=(i-l)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-s);this._w=(o-r)/e,this._x=(i+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,s=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+o*s+r*l-i*a,this._y=r*c+o*a+i*s-n*l,this._z=i*c+o*l+n*a-r*s,this._w=o*c-n*s-r*a-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,s),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class yn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;yn.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(En.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(En.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z,a=e.w,l=a*t+o*r-s*n,c=a*n+s*t-i*r,u=a*r+i*n-o*t,h=-i*t-o*n-s*r;return this.x=l*a+h*-i+c*-s-u*-o,this.y=c*a+h*-o+u*-i-l*-s,this.z=u*a+h*-s+l*-o-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Tn.copy(this).projectOnVector(e),this.sub(Tn)}reflect(e){return this.sub(Tn.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Bt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Tn=new yn,En=new bn;class Sn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,o,s),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,o,s),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=xn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,r=t.count;n<r;n++)xn.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(xn)}else null===n.boundingBox&&n.computeBoundingBox(),Mn.copy(n.boundingBox),Mn.applyMatrix4(e.matrixWorld),this.union(Mn);const r=e.children;for(let i=0,o=r.length;i<o;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,xn),xn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(On),Nn.subVectors(this.max,On),Cn.subVectors(e.a,On),In.subVectors(e.b,On),kn.subVectors(e.c,On),Rn.subVectors(In,Cn),An.subVectors(kn,In),Ln.subVectors(Cn,kn);let t=[0,-Rn.z,Rn.y,0,-An.z,An.y,0,-Ln.z,Ln.y,Rn.z,0,-Rn.x,An.z,0,-An.x,Ln.z,0,-Ln.x,-Rn.y,Rn.x,0,-An.y,An.x,0,-Ln.y,Ln.x,0];return!(!$n(t,Cn,In,kn,Nn)||(t=[1,0,0,0,1,0,0,0,1],!$n(t,Cn,In,kn,Nn)))&&(Pn.crossVectors(Rn,An),t=[Pn.x,Pn.y,Pn.z],$n(t,Cn,In,kn,Nn))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return xn.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(xn).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(wn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wn)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wn=[new yn,new yn,new yn,new yn,new yn,new yn,new yn,new yn],xn=new yn,Mn=new Sn,Cn=new yn,In=new yn,kn=new yn,Rn=new yn,An=new yn,Ln=new yn,On=new yn,Nn=new yn,Pn=new yn,Dn=new yn;function $n(e,t,n,r,i){for(let o=0,s=e.length-3;o<=s;o+=3){Dn.fromArray(e,o);const s=i.x*Math.abs(Dn.x)+i.y*Math.abs(Dn.y)+i.z*Math.abs(Dn.z),a=t.dot(Dn),l=n.dot(Dn),c=r.dot(Dn);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>s)return!1}return!0}const Bn=new Sn,Fn=new yn,Un=new yn,zn=new yn;class Hn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Bn.setFromPoints(e).getCenter(n);let r=0;for(let i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){zn.subVectors(e,this.center);const t=zn.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add(zn.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return!0===this.center.equals(e.center)?Un.set(0,0,1).multiplyScalar(e.radius):Un.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Fn.copy(e.center).add(Un)),this.expandByPoint(Fn.copy(e.center).sub(Un)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Gn=new yn,Vn=new yn,Wn=new yn,jn=new yn,Xn=new yn,Yn=new yn,Kn=new yn;class qn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Gn)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Gn.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Gn.copy(this.direction).multiplyScalar(t).add(this.origin),Gn.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Vn.copy(e).add(t).multiplyScalar(.5),Wn.copy(t).sub(e).normalize(),jn.copy(this.origin).sub(Vn);const i=.5*e.distanceTo(t),o=-this.direction.dot(Wn),s=jn.dot(this.direction),a=-jn.dot(Wn),l=jn.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*a-s,h=o*s-a,p=i*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+o*h+2*s)+h*(o*u+h+2*a)+l}else h=i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-o*i+s)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(o*i+s)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+s)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(Wn).multiplyScalar(h).add(Vn),d}intersectSphere(e,t){Gn.subVectors(e.center,this.origin);const n=Gn.dot(this.direction),r=Gn.dot(Gn)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return s<0&&a<0?null:s<0?this.at(a,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,s,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||i>r||((i>n||n!==n)&&(n=i),(o<r||r!==r)&&(r=o),u>=0?(s=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||s>r)||((s>n||n!==n)&&(n=s),(a<r||r!==r)&&(r=a),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Gn)}intersectTriangle(e,t,n,r,i){Xn.subVectors(t,e),Yn.subVectors(n,e),Kn.crossVectors(Xn,Yn);let o,s=this.direction.dot(Kn);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}jn.subVectors(this.origin,e);const a=o*this.direction.dot(Yn.crossVectors(jn,Yn));if(a<0)return null;const l=o*this.direction.dot(Xn.cross(jn));if(l<0||a+l>s)return null;const c=-o*jn.dot(Kn);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Jn{constructor(){Jn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,i,o,s,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Jn).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Zn.setFromMatrixColumn(e,0).length(),i=1/Zn.setFromMatrixColumn(e,1).length(),o=1/Zn.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=o*c,n=o*u,r=s*c,i=s*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*a,t[2]=i-e*l,t[6]=r+n*l,t[10]=o*a}else if("YXZ"===e.order){const e=a*c,n=a*u,r=l*c,i=l*u;t[0]=e+i*s,t[4]=r*s-n,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=o*a}else if("ZXY"===e.order){const e=a*c,n=a*u,r=l*c,i=l*u;t[0]=e-i*s,t[4]=-o*u,t[8]=r+n*s,t[1]=n+r*s,t[5]=o*c,t[9]=i-e*s,t[2]=-o*l,t[6]=s,t[10]=o*a}else if("ZYX"===e.order){const e=o*c,n=o*u,r=s*c,i=s*u;t[0]=a*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=a*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*a,t[10]=o*a}else if("YZX"===e.order){const e=o*a,n=o*l,r=s*a,i=s*l;t[0]=a*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=o*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=o*a,n=o*l,r=s*a,i=s*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=o*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=s*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(er,e,tr)}lookAt(e,t,n){const r=this.elements;return ir.subVectors(e,t),0===ir.lengthSq()&&(ir.z=1),ir.normalize(),nr.crossVectors(n,ir),0===nr.lengthSq()&&(1===Math.abs(n.z)?ir.x+=1e-4:ir.z+=1e-4,ir.normalize(),nr.crossVectors(n,ir)),nr.normalize(),rr.crossVectors(ir,nr),r[0]=nr.x,r[4]=rr.x,r[8]=ir.x,r[1]=nr.y,r[5]=rr.y,r[9]=ir.y,r[2]=nr.z,r[6]=rr.z,r[10]=ir.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],_=n[7],b=n[11],y=n[15],T=r[0],E=r[4],S=r[8],w=r[12],x=r[1],M=r[5],C=r[9],I=r[13],k=r[2],R=r[6],A=r[10],L=r[14],O=r[3],N=r[7],P=r[11],D=r[15];return i[0]=o*T+s*x+a*k+l*O,i[4]=o*E+s*M+a*R+l*N,i[8]=o*S+s*C+a*A+l*P,i[12]=o*w+s*I+a*L+l*D,i[1]=c*T+u*x+h*k+d*O,i[5]=c*E+u*M+h*R+d*N,i[9]=c*S+u*C+h*A+d*P,i[13]=c*w+u*I+h*L+d*D,i[2]=p*T+f*x+m*k+g*O,i[6]=p*E+f*M+m*R+g*N,i[10]=p*S+f*C+m*A+g*P,i[14]=p*w+f*I+m*L+g*D,i[3]=v*T+_*x+b*k+y*O,i[7]=v*E+_*M+b*R+y*N,i[11]=v*S+_*C+b*A+y*P,i[15]=v*w+_*I+b*L+y*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],s=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*a*u-r*l*u-i*s*h+n*l*h+r*s*d-n*a*d)+e[7]*(+t*a*d-t*l*h+i*o*h-r*o*d+r*l*c-i*a*c)+e[11]*(+t*l*u-t*s*d-i*o*u+n*o*d+i*s*c-n*l*c)+e[15]*(-r*s*c-t*a*u+t*s*h+r*o*u-n*o*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*a*d-s*m*d-u*a*g+s*h*g,_=p*h*l-c*m*l-p*a*d+o*m*d+c*a*g-o*h*g,b=c*f*l-p*u*l+p*s*d-o*f*d-c*s*g+o*u*g,y=p*u*a-c*f*a-p*s*h+o*f*h+c*s*m-o*u*m,T=t*v+n*_+r*b+i*y;if(0===T)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/T;return e[0]=v*E,e[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*g-n*h*g)*E,e[2]=(s*m*i-f*a*i+f*r*l-n*m*l-s*r*g+n*a*g)*E,e[3]=(u*a*i-s*h*i-u*r*l+n*h*l+s*r*d-n*a*d)*E,e[4]=_*E,e[5]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*g+t*h*g)*E,e[6]=(p*a*i-o*m*i-p*r*l+t*m*l+o*r*g-t*a*g)*E,e[7]=(o*h*i-c*a*i+c*r*l-t*h*l-o*r*d+t*a*d)*E,e[8]=b*E,e[9]=(p*u*i-c*f*i-p*n*d+t*f*d+c*n*g-t*u*g)*E,e[10]=(o*f*i-p*s*i+p*n*l-t*f*l-o*n*g+t*s*g)*E,e[11]=(c*s*i-o*u*i-c*n*l+t*u*l+o*n*d-t*s*d)*E,e[12]=y*E,e[13]=(c*f*r-p*u*r+p*n*h-t*f*h-c*n*m+t*u*m)*E,e[14]=(p*s*r-o*f*r-p*n*a+t*f*a+o*n*m-t*s*m)*E,e[15]=(o*u*r-c*s*r+c*n*a-t*u*a-o*n*h+t*s*h)*E,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,s=e.y,a=e.z,l=i*o,c=i*s;return this.set(l*o+n,l*s-r*a,l*a+r*s,0,l*s+r*a,c*s+n,c*a-r*o,0,l*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,s=t._z,a=t._w,l=i+i,c=o+o,u=s+s,h=i*l,d=i*c,p=i*u,f=o*c,m=o*u,g=s*u,v=a*l,_=a*c,b=a*u,y=n.x,T=n.y,E=n.z;return r[0]=(1-(f+g))*y,r[1]=(d+b)*y,r[2]=(p-_)*y,r[3]=0,r[4]=(d-b)*T,r[5]=(1-(h+g))*T,r[6]=(m+v)*T,r[7]=0,r[8]=(p+_)*E,r[9]=(m-v)*E,r[10]=(1-(h+f))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=Zn.set(r[0],r[1],r[2]).length();const o=Zn.set(r[4],r[5],r[6]).length(),s=Zn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Qn.copy(this);const a=1/i,l=1/o,c=1/s;return Qn.elements[0]*=a,Qn.elements[1]*=a,Qn.elements[2]*=a,Qn.elements[4]*=l,Qn.elements[5]*=l,Qn.elements[6]*=l,Qn.elements[8]*=c,Qn.elements[9]*=c,Qn.elements[10]*=c,t.setFromRotationMatrix(Qn),n.x=i,n.y=o,n.z=s,this}makePerspective(e,t,n,r,i,o){const s=this.elements,a=2*i/(t-e),l=2*i/(n-r),c=(t+e)/(t-e),u=(n+r)/(n-r),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,n,r,i,o){const s=this.elements,a=1/(t-e),l=1/(n-r),c=1/(o-i),u=(t+e)*a,h=(n+r)*l,d=(o+i)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Zn=new yn,Qn=new Jn,er=new yn(0,0,0),tr=new yn(1,1,1),nr=new yn,rr=new yn,ir=new yn,or=new Jn,sr=new bn;class ar{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ar.DefaultOrder;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.elements,i=r[0],o=r[4],s=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Bt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Bt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Bt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-Bt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(Bt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-Bt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return or.makeRotationFromQuaternion(e),this.setFromRotationMatrix(or,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return sr.setFromEuler(this),this.setFromQuaternion(sr,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}ar.DefaultOrder="XYZ",ar.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class lr{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&(1<<e|0))}}let cr=0;const ur=new yn,hr=new bn,dr=new Jn,pr=new yn,fr=new yn,mr=new yn,gr=new bn,vr=new yn(1,0,0),_r=new yn(0,1,0),br=new yn(0,0,1),yr={type:"added"},Tr={type:"removed"};class Er extends Lt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cr++}),this.uuid=$t(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Er.DefaultUp.clone();const e=new yn,t=new ar,n=new bn,r=new yn(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Jn},normalMatrix:{value:new jt}}),this.matrix=new Jn,this.matrixWorld=new Jn,this.matrixAutoUpdate=Er.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new lr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hr.setFromAxisAngle(e,t),this.quaternion.multiply(hr),this}rotateOnWorldAxis(e,t){return hr.setFromAxisAngle(e,t),this.quaternion.premultiply(hr),this}rotateX(e){return this.rotateOnAxis(vr,e)}rotateY(e){return this.rotateOnAxis(_r,e)}rotateZ(e){return this.rotateOnAxis(br,e)}translateOnAxis(e,t){return ur.copy(e).applyQuaternion(this.quaternion),this.position.add(ur.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(vr,e)}translateY(e){return this.translateOnAxis(_r,e)}translateZ(e){return this.translateOnAxis(br,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(dr.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?pr.copy(e):pr.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),fr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?dr.lookAt(fr,pr,this.up):dr.lookAt(pr,fr,this.up),this.quaternion.setFromRotationMatrix(dr),r&&(dr.extractRotation(r.matrixWorld),hr.setFromRotationMatrix(dr),this.quaternion.premultiply(hr.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(yr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Tr)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Tr)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),dr.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),dr.multiply(e.parent.matrixWorld)),e.applyMatrix4(dr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fr,e,mr),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fr,gr,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),s=o(e.images),a=o(e.shapes),l=o(e.skeletons),c=o(e.animations),u=o(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Er.DefaultUp=new yn(0,1,0),Er.DefaultMatrixAutoUpdate=!0;const Sr=new yn,wr=new yn,xr=new yn,Mr=new yn,Cr=new yn,Ir=new yn,kr=new yn,Rr=new yn,Ar=new yn,Lr=new yn;class Or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Sr.subVectors(e,t),r.cross(Sr);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Sr.subVectors(r,t),wr.subVectors(n,t),xr.subVectors(e,t);const o=Sr.dot(Sr),s=Sr.dot(wr),a=Sr.dot(xr),l=wr.dot(wr),c=wr.dot(xr),u=o*l-s*s;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-s*c)*h,p=(o*c-s*a)*h;return i.set(1-d-p,p,d)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Mr),Mr.x>=0&&Mr.y>=0&&Mr.x+Mr.y<=1}static getUV(e,t,n,r,i,o,s,a){return this.getBarycoord(e,t,n,r,Mr),a.set(0,0),a.addScaledVector(i,Mr.x),a.addScaledVector(o,Mr.y),a.addScaledVector(s,Mr.z),a}static isFrontFacing(e,t,n,r){return Sr.subVectors(n,t),wr.subVectors(e,t),Sr.cross(wr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sr.subVectors(this.c,this.b),wr.subVectors(this.a,this.b),.5*Sr.cross(wr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Or.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Or.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return Or.getUV(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Or.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Or.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,s;Cr.subVectors(r,n),Ir.subVectors(i,n),Rr.subVectors(e,n);const a=Cr.dot(Rr),l=Ir.dot(Rr);if(a<=0&&l<=0)return t.copy(n);Ar.subVectors(e,r);const c=Cr.dot(Ar),u=Ir.dot(Ar);if(c>=0&&u<=c)return t.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),t.copy(n).addScaledVector(Cr,o);Lr.subVectors(e,i);const d=Cr.dot(Lr),p=Ir.dot(Lr);if(p>=0&&d<=p)return t.copy(i);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),t.copy(n).addScaledVector(Ir,s);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return kr.subVectors(i,r),s=(u-c)/(u-c+(d-p)),t.copy(r).addScaledVector(kr,s);const g=1/(m+f+h);return o=f*g,s=h*g,t.copy(n).addScaledVector(Cr,o).addScaledVector(Ir,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Nr=0;class Pr extends Lt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Nr++}),this.uuid=$t(),this.name="",this.type="Material",this.blending=v,this.side=p,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=A,this.blendDst=L,this.blendEquation=E,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ct,this.stencilZFail=Ct,this.stencilZPass=Ct,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==v&&(n.blending=this.blending),this.side!==p&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Dr extends Pr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ln(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $r=new yn,Br=new Wt;class Fr{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=It,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new ln),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new Wt),t[n++]=i.x,t[n++]=i.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new yn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new mn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Br.fromBufferAttribute(this,t),Br.applyMatrix3(e),this.setXY(t,Br.x,Br.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)$r.fromBufferAttribute(this,t),$r.applyMatrix3(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)$r.fromBufferAttribute(this,t),$r.applyMatrix4(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)$r.fromBufferAttribute(this,t),$r.applyNormalMatrix(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)$r.fromBufferAttribute(this,t),$r.transformDirection(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==It&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Ur extends Fr{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class zr extends Fr{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Hr extends Fr{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Gr=0;const Vr=new Jn,Wr=new Er,jr=new yn,Xr=new Sn,Yr=new Sn,Kr=new yn;class qr extends Lt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Gr++}),this.uuid=$t(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Xt(e)?zr:Ur)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new jt).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vr.makeRotationFromQuaternion(e),this.applyMatrix4(Vr),this}rotateX(e){return Vr.makeRotationX(e),this.applyMatrix4(Vr),this}rotateY(e){return Vr.makeRotationY(e),this.applyMatrix4(Vr),this}rotateZ(e){return Vr.makeRotationZ(e),this.applyMatrix4(Vr),this}translate(e,t,n){return Vr.makeTranslation(e,t,n),this.applyMatrix4(Vr),this}scale(e,t,n){return Vr.makeScale(e,t,n),this.applyMatrix4(Vr),this}lookAt(e){return Wr.lookAt(e),Wr.updateMatrix(),this.applyMatrix4(Wr.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jr).negate(),this.translate(jr.x,jr.y,jr.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Hr(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Sn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new yn(-1/0,-1/0,-1/0),new yn(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];Xr.setFromBufferAttribute(e),this.morphTargetsRelative?(Kr.addVectors(this.boundingBox.min,Xr.min),this.boundingBox.expandByPoint(Kr),Kr.addVectors(this.boundingBox.max,Xr.max),this.boundingBox.expandByPoint(Kr)):(this.boundingBox.expandByPoint(Xr.min),this.boundingBox.expandByPoint(Xr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Hn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new yn,1/0);if(e){const n=this.boundingSphere.center;if(Xr.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];Yr.setFromBufferAttribute(n),this.morphTargetsRelative?(Kr.addVectors(Xr.min,Yr.min),Xr.expandByPoint(Kr),Kr.addVectors(Xr.max,Yr.max),Xr.expandByPoint(Kr)):(Xr.expandByPoint(Yr.min),Xr.expandByPoint(Yr.max))}Xr.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)Kr.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(Kr));if(t)for(let i=0,o=t.length;i<o;i++){const o=t[i],s=this.morphTargetsRelative;for(let t=0,i=o.count;t<i;t++)Kr.fromBufferAttribute(o,t),s&&(jr.fromBufferAttribute(e,t),Kr.add(jr)),r=Math.max(r,n.distanceToSquared(Kr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,i=t.normal.array,o=t.uv.array,s=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Fr(new Float32Array(4*s),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let x=0;x<s;x++)l[x]=new yn,c[x]=new yn;const u=new yn,h=new yn,d=new yn,p=new Wt,f=new Wt,m=new Wt,g=new yn,v=new yn;function _(e,t,n){u.fromArray(r,3*e),h.fromArray(r,3*t),d.fromArray(r,3*n),p.fromArray(o,2*e),f.fromArray(o,2*t),m.fromArray(o,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);!isFinite(i)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(v),c[t].add(v),c[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let x=0,M=b.length;x<M;++x){const e=b[x],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)_(n[r+0],n[r+1],n[r+2])}const y=new yn,T=new yn,E=new yn,S=new yn;function w(e){E.fromArray(i,3*e),S.copy(E);const t=l[e];y.copy(t),y.sub(E.multiplyScalar(E.dot(t))).normalize(),T.crossVectors(S,t);const n=T.dot(c[e])<0?-1:1;a[4*e]=y.x,a[4*e+1]=y.y,a[4*e+2]=y.z,a[4*e+3]=n}for(let x=0,M=b.length;x<M;++x){const e=b[x],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)w(n[r+0]),w(n[r+1]),w(n[r+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Fr(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new yn,i=new yn,o=new yn,s=new yn,a=new yn,l=new yn,c=new yn,u=new yn;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),o.fromBufferAttribute(t,f),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(c),a.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const i=n[r].array,o=e.attributes[r],s=o.array,a=o.itemSize*t,l=Math.min(s.length,i.length-a);for(let e=0,t=a;e<l;e++,t++)i[t]=s[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Kr.fromBufferAttribute(e,t),Kr.normalize(),e.setXYZ(t,Kr.x,Kr.y,Kr.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r);let s=0,a=0;for(let l=0,c=t.length;l<c;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)o[a++]=n[s++]}return new Fr(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qr,n=this.index.array,r=this.attributes;for(const s in r){const i=e(r[s],n);t.setAttribute(s,i)}const i=this.morphAttributes;for(const s in i){const r=[],o=i[s];for(let t=0,i=o.length;t<i;t++){const i=e(o[t],n);r.push(i)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let s=0,a=o.length;s<a;s++){const e=o[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const r={};let i=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[a]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,c=o.length;l<c;l++){const e=o[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Jr=new Jn,Zr=new qn,Qr=new Hn,ei=new yn,ti=new yn,ni=new yn,ri=new yn,ii=new yn,oi=new yn,si=new yn,ai=new yn,li=new yn,ci=new Wt,ui=new Wt,hi=new Wt,di=new yn,pi=new yn;class fi extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dr;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Qr.copy(n.boundingSphere),Qr.applyMatrix4(i),!1===e.ray.intersectsSphere(Qr))||(Jr.copy(i).invert(),Zr.copy(e.ray).applyMatrix4(Jr),null!==n.boundingBox&&!1===Zr.intersectsBox(n.boundingBox)))return;let o;const s=n.index,a=n.attributes.position,l=n.morphAttributes.position,c=n.morphTargetsRelative,u=n.attributes.uv,h=n.attributes.uv2,d=n.groups,p=n.drawRange;if(null!==s)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const n=d[f],i=r[n.materialIndex];for(let r=Math.max(n.start,p.start),d=Math.min(s.count,Math.min(n.start+n.count,p.start+p.count));r<d;r+=3){const d=s.getX(r),p=s.getX(r+1),f=s.getX(r+2);o=mi(this,i,e,Zr,a,l,c,u,h,d,p,f),o&&(o.faceIndex=Math.floor(r/3),o.face.materialIndex=n.materialIndex,t.push(o))}}else{for(let n=Math.max(0,p.start),i=Math.min(s.count,p.start+p.count);n<i;n+=3){const i=s.getX(n),d=s.getX(n+1),p=s.getX(n+2);o=mi(this,r,e,Zr,a,l,c,u,h,i,d,p),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}}else if(void 0!==a)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const n=d[f],i=r[n.materialIndex];for(let r=Math.max(n.start,p.start),s=Math.min(a.count,Math.min(n.start+n.count,p.start+p.count));r<s;r+=3){o=mi(this,i,e,Zr,a,l,c,u,h,r,r+1,r+2),o&&(o.faceIndex=Math.floor(r/3),o.face.materialIndex=n.materialIndex,t.push(o))}}else{for(let n=Math.max(0,p.start),i=Math.min(a.count,p.start+p.count);n<i;n+=3){o=mi(this,r,e,Zr,a,l,c,u,h,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}}}}function mi(e,t,n,r,i,o,s,a,l,c,u,h){ei.fromBufferAttribute(i,c),ti.fromBufferAttribute(i,u),ni.fromBufferAttribute(i,h);const d=e.morphTargetInfluences;if(o&&d){si.set(0,0,0),ai.set(0,0,0),li.set(0,0,0);for(let e=0,t=o.length;e<t;e++){const t=d[e],n=o[e];0!==t&&(ri.fromBufferAttribute(n,c),ii.fromBufferAttribute(n,u),oi.fromBufferAttribute(n,h),s?(si.addScaledVector(ri,t),ai.addScaledVector(ii,t),li.addScaledVector(oi,t)):(si.addScaledVector(ri.sub(ei),t),ai.addScaledVector(ii.sub(ti),t),li.addScaledVector(oi.sub(ni),t)))}ei.add(si),ti.add(ai),ni.add(li)}e.isSkinnedMesh&&(e.boneTransform(c,ei),e.boneTransform(u,ti),e.boneTransform(h,ni));const p=function(e,t,n,r,i,o,s,a){let l;if(l=t.side===f?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,t.side!==m,a),null===l)return null;pi.copy(a),pi.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(pi);return c<n.near||c>n.far?null:{distance:c,point:pi.clone(),object:e}}(e,t,n,r,ei,ti,ni,di);if(p){a&&(ci.fromBufferAttribute(a,c),ui.fromBufferAttribute(a,u),hi.fromBufferAttribute(a,h),p.uv=Or.getUV(di,ei,ti,ni,ci,ui,hi,new Wt)),l&&(ci.fromBufferAttribute(l,c),ui.fromBufferAttribute(l,u),hi.fromBufferAttribute(l,h),p.uv2=Or.getUV(di,ei,ti,ni,ci,ui,hi,new Wt));const e={a:c,b:u,c:h,normal:new yn,materialIndex:0};Or.getNormal(ei,ti,ni,e.normal),p.face=e}return p}class gi extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,r,i,o,p,f,m,g,v){const _=o/m,b=p/g,y=o/2,T=p/2,E=f/2,S=m+1,w=g+1;let x=0,M=0;const C=new yn;for(let s=0;s<w;s++){const o=s*b-T;for(let a=0;a<S;a++){const h=a*_-y;C[e]=h*r,C[t]=o*i,C[n]=E,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=f>0?1:-1,c.push(C.x,C.y,C.z),u.push(a/m),u.push(1-s/g),x+=1}}for(let s=0;s<g;s++)for(let e=0;e<m;e++){const t=h+e+S*s,n=h+e+S*(s+1),r=h+(e+1)+S*(s+1),i=h+(e+1)+S*s;a.push(t,n,i),a.push(n,r,i),M+=6}s.addGroup(d,M,v),d+=M,h+=x}p("z","y","x",-1,-1,n,t,e,o,i,0),p("z","y","x",1,-1,n,t,-e,o,i,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new Hr(l,3)),this.setAttribute("normal",new Hr(c,3)),this.setAttribute("uv",new Hr(u,2))}static fromJSON(e){return new gi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vi(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function _i(e){const t={};for(let n=0;n<e.length;n++){const r=vi(e[n]);for(const e in r)t[e]=r[e]}return t}const bi={clone:vi,merge:_i};class yi extends Pr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vi(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Ti extends Er{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jn,this.projectionMatrix=new Jn,this.projectionMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Ei extends Ti{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Dt*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Pt*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Dt*Math.atan(Math.tan(.5*Pt*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Pt*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/e,t-=o.offsetY*n/s,r*=o.width/e,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Si=90;class wi extends Er{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Ei(Si,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new yn(1,0,0)),this.add(r);const i=new Ei(Si,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new yn(-1,0,0)),this.add(i);const o=new Ei(Si,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new yn(0,1,0)),this.add(o);const s=new Ei(Si,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new yn(0,-1,0)),this.add(s);const a=new Ei(Si,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new yn(0,0,1)),this.add(a);const l=new Ei(Si,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new yn(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,o,s,a,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=K,e.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,a),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class xi extends fn{constructor(e,t,n,r,i,o,s,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ne,n,r,i,o,s,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Mi extends gn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new xi(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:pe}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new gi(5,5,5),s=new yi({name:"CubemapFromEquirect",uniforms:vi(n),vertexShader:r,fragmentShader:i,side:f,blending:g});s.uniforms.tEquirect.value=t;const a=new fi(o,s),l=t.minFilter;return t.minFilter===me&&(t.minFilter=pe),new wi(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)}}const Ci=new yn,Ii=new yn,ki=new jt;class Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Ci.subVectors(n,t).cross(Ii.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Ci),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ki.getNormalMatrix(e),r=this.coplanarPoint(Ci).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ai=new Hn,Li=new yn;class Oi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ri,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ri,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ri,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ri,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Ri,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Ri;this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],_=n[15];return t[0].setComponents(s-r,u-a,f-h,_-m).normalize(),t[1].setComponents(s+r,u+a,f+h,_+m).normalize(),t[2].setComponents(s+i,u+l,f+d,_+g).normalize(),t[3].setComponents(s-i,u-l,f-d,_-g).normalize(),t[4].setComponents(s-o,u-c,f-p,_-v).normalize(),t[5].setComponents(s+o,u+c,f+p,_+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ai.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ai)}intersectsSprite(e){return Ai.center.set(0,0,0),Ai.radius=.7071067811865476,Ai.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ai)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Li.x=r.normal.x>0?e.max.x:e.min.x,Li.y=r.normal.y>0?e.max.y:e.min.y,Li.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Li)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ni(){let e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Pi(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=r.get(t);return void((!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const o=r.get(t);void 0===o?r.set(t,function(t,r){const i=t.array,o=t.usage,s=e.createBuffer();let a;if(e.bindBuffer(r,s),e.bufferData(r,i,o),t.onUploadCallback(),i instanceof Float32Array)a=5126;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(i instanceof Int16Array)a=5122;else if(i instanceof Uint32Array)a=5125;else if(i instanceof Int32Array)a=5124;else if(i instanceof Int8Array)a=5120;else if(i instanceof Uint8Array)a=5121;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=5121}return{buffer:s,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){const o=r.array,s=r.updateRange;e.bindBuffer(i,t),-1===s.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o,s.offset,s.count):e.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(o.buffer,t,i),o.version=t.version)}}}class Di extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,s=Math.floor(n),a=Math.floor(r),l=s+1,c=a+1,u=e/s,h=t/a,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const e=g*h-o;for(let t=0;t<l;t++){const n=t*u-i;p.push(n,-e,0),f.push(0,0,1),m.push(t/s),m.push(1-g/a)}}for(let g=0;g<a;g++)for(let e=0;e<s;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;d.push(t,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new Hr(p,3)),this.setAttribute("normal",new Hr(f,3)),this.setAttribute("uv",new Hr(m,2))}static fromJSON(e){return new Di(e.width,e.height,e.widthSegments,e.heightSegments)}}const $i={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Bi={common:{diffuse:{value:new ln(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new jt},uv2Transform:{value:new jt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ln(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ln(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jt}},sprite:{diffuse:{value:new ln(16777215)},opacity:{value:1},center:{value:new Wt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jt}}},Fi={basic:{uniforms:_i([Bi.common,Bi.specularmap,Bi.envmap,Bi.aomap,Bi.lightmap,Bi.fog]),vertexShader:$i.meshbasic_vert,fragmentShader:$i.meshbasic_frag},lambert:{uniforms:_i([Bi.common,Bi.specularmap,Bi.envmap,Bi.aomap,Bi.lightmap,Bi.emissivemap,Bi.fog,Bi.lights,{emissive:{value:new ln(0)}}]),vertexShader:$i.meshlambert_vert,fragmentShader:$i.meshlambert_frag},phong:{uniforms:_i([Bi.common,Bi.specularmap,Bi.envmap,Bi.aomap,Bi.lightmap,Bi.emissivemap,Bi.bumpmap,Bi.normalmap,Bi.displacementmap,Bi.fog,Bi.lights,{emissive:{value:new ln(0)},specular:{value:new ln(1118481)},shininess:{value:30}}]),vertexShader:$i.meshphong_vert,fragmentShader:$i.meshphong_frag},standard:{uniforms:_i([Bi.common,Bi.envmap,Bi.aomap,Bi.lightmap,Bi.emissivemap,Bi.bumpmap,Bi.normalmap,Bi.displacementmap,Bi.roughnessmap,Bi.metalnessmap,Bi.fog,Bi.lights,{emissive:{value:new ln(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$i.meshphysical_vert,fragmentShader:$i.meshphysical_frag},toon:{uniforms:_i([Bi.common,Bi.aomap,Bi.lightmap,Bi.emissivemap,Bi.bumpmap,Bi.normalmap,Bi.displacementmap,Bi.gradientmap,Bi.fog,Bi.lights,{emissive:{value:new ln(0)}}]),vertexShader:$i.meshtoon_vert,fragmentShader:$i.meshtoon_frag},matcap:{uniforms:_i([Bi.common,Bi.bumpmap,Bi.normalmap,Bi.displacementmap,Bi.fog,{matcap:{value:null}}]),vertexShader:$i.meshmatcap_vert,fragmentShader:$i.meshmatcap_frag},points:{uniforms:_i([Bi.points,Bi.fog]),vertexShader:$i.points_vert,fragmentShader:$i.points_frag},dashed:{uniforms:_i([Bi.common,Bi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$i.linedashed_vert,fragmentShader:$i.linedashed_frag},depth:{uniforms:_i([Bi.common,Bi.displacementmap]),vertexShader:$i.depth_vert,fragmentShader:$i.depth_frag},normal:{uniforms:_i([Bi.common,Bi.bumpmap,Bi.normalmap,Bi.displacementmap,{opacity:{value:1}}]),vertexShader:$i.meshnormal_vert,fragmentShader:$i.meshnormal_frag},sprite:{uniforms:_i([Bi.sprite,Bi.fog]),vertexShader:$i.sprite_vert,fragmentShader:$i.sprite_frag},background:{uniforms:{uvTransform:{value:new jt},t2D:{value:null}},vertexShader:$i.background_vert,fragmentShader:$i.background_frag},cube:{uniforms:_i([Bi.envmap,{opacity:{value:1}}]),vertexShader:$i.cube_vert,fragmentShader:$i.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$i.equirect_vert,fragmentShader:$i.equirect_frag},distanceRGBA:{uniforms:_i([Bi.common,Bi.displacementmap,{referencePosition:{value:new yn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$i.distanceRGBA_vert,fragmentShader:$i.distanceRGBA_frag},shadow:{uniforms:_i([Bi.lights,Bi.fog,{color:{value:new ln(0)},opacity:{value:1}}]),vertexShader:$i.shadow_vert,fragmentShader:$i.shadow_frag}};function Ui(e,t,n,r,i,o){const s=new ln(0);let a,l,c=!0===i?0:1,u=null,h=0,d=null;function m(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,o)}return{getClearColor:function(){return s},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),c=t,m(s,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,m(s,c)},render:function(n,i){let o=!1,g=!0===i.isScene?i.background:null;g&&g.isTexture&&(g=t.get(g));const v=e.xr,_=v.getSession&&v.getSession();_&&"additive"===_.environmentBlendMode&&(g=null),null===g?m(s,c):g&&g.isColor&&(m(g,1),o=!0),(e.autoClear||o)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===se)?(void 0===l&&(l=new fi(new gi(1,1,1),new yi({name:"BackgroundCubeMaterial",uniforms:vi(Fi.cube.uniforms),vertexShader:Fi.cube.vertexShader,fragmentShader:Fi.cube.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,(u!==g||h!==g.version||d!==e.toneMapping)&&(l.material.needsUpdate=!0,u=g,h=g.version,d=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===a&&(a=new fi(new Di(2,2),new yi({name:"BackgroundMaterial",uniforms:vi(Fi.background.uniforms),vertexShader:Fi.background.vertexShader,fragmentShader:Fi.background.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),(u!==g||h!==g.version||d!==e.toneMapping)&&(a.material.needsUpdate=!0,u=g,h=g.version,d=e.toneMapping),a.layers.enableAll(),n.unshift(a,a.geometry,a.material,0,0,null))}}}function zi(e,t,n,r){const i=e.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||null!==o,a={},l=p(null);let c=l,u=!1;function h(t){return r.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function p(e){const t=[],n=[],r=[];for(let o=0;o<i;o++)t[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function m(e){g(e,0)}function g(n,i){const o=c.newAttributes,s=c.enabledAttributes,a=c.attributeDivisors;o[n]=1,0===s[n]&&(e.enableVertexAttribArray(n),s[n]=1),a[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i)}function v(){const t=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function _(t,n,i,o,s,a){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,o,s,a):e.vertexAttribIPointer(t,n,i,s,a)}function b(){y(),u=!0,c!==l&&(c=l,h(c.object))}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,b,y){let T=!1;if(s){const t=function(t,n,i){const s=!0===i.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[s];return void 0===u&&(u=p(r.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),c[s]=u),u}(b,d,l);c!==t&&(c=t,h(c.object)),T=function(e,t,n,r){const i=c.attributes,o=t.attributes;let s=0;const a=n.getAttributes();for(const l in a)if(a[l].location>=0){const t=i[l];let n=o[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t||t.attribute!==n||n&&t.data!==n.data)return!0;s++}return c.attributesNum!==s||c.index!==r}(i,b,d,y),T&&function(e,t,n,r){const i={},o=t.attributes;let s=0;const a=n.getAttributes();for(const l in a)if(a[l].location>=0){let t=o[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[l]=n,s++}c.attributes=i,c.attributesNum=s,c.index=r}(i,b,d,y)}else{const e=!0===l.wireframe;(c.geometry!==b.id||c.program!==d.id||c.wireframe!==e)&&(c.geometry=b.id,c.program=d.id,c.wireframe=e,T=!0)}null!==y&&n.update(y,34963),(T||u)&&(u=!1,function(i,o,s,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=s.getAttributes(),u=o.defaultAttributeValues;for(const t in c){const r=c[t];if(r.location>=0){let o=l[t];if(void 0===o&&("instanceMatrix"===t&&i.instanceMatrix&&(o=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(o=i.instanceColor)),void 0!==o){const t=o.normalized,s=o.itemSize,l=n.get(o);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,l=n.stride,d=o.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)g(r.location+e,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<r.locationSize;e++)m(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)_(r.location+e,s/r.locationSize,u,t,l*h,(d+s/r.locationSize*e)*h)}else{if(o.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)g(r.location+e,o.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let e=0;e<r.locationSize;e++)m(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)_(r.location+e,s/r.locationSize,u,t,s*h,s/r.locationSize*e*h)}}else if(void 0!==u){const n=u[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(r.location,n);break;case 3:e.vertexAttrib3fv(r.location,n);break;case 4:e.vertexAttrib4fv(r.location,n);break;default:e.vertexAttrib1fv(r.location,n)}}}}v()}(i,l,d,b),null!==y&&e.bindBuffer(34963,n.get(y).buffer))},reset:b,resetDefaultState:y,dispose:function(){b();for(const e in a){const t=a[e];for(const e in t){const n=t[e];for(const e in n)d(n[e].object),delete n[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const n in t){const e=t[n];for(const t in e)d(e[t].object),delete e[t];delete t[n]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const n=a[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)d(r[e].object),delete r[e];delete n[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function Hi(e,t,n,r){const i=r.isWebGL2;let o;this.setMode=function(e){o=e},this.render=function(t,r){e.drawArrays(o,t,r),n.update(r,o,1)},this.renderInstances=function(r,s,a){if(0===a)return;let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,r,s,a),n.update(s,o,a)}}function Gi(e,t,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),_=h>0,b=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:_&&b,maxSamples:o?e.getParameter(36183):0}}function Vi(e){const t=this;let n=null,r=0,i=!1,o=!1;const s=new Ri,a=new jt,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){const o=null!==e?e.length:0;let c=null;if(0!==o){if(c=l.value,!0!==i||null===c){const t=r+4*o,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==o;++n,l+=4)s.copy(e[n]).applyMatrix4(i,a),s.normal.toArray(c,l),c[l+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){const s=0!==e.length||t||0!==r||i;return i=t,n=u(e,o,0),r=e.length,s},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(t,s,a){const h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(!i||null===h||0===h.length||o&&!p)o?u(null):c();else{const e=o?0:r,t=4*e;let i=f.clippingState||null;l.value=i,i=u(h,s,t,a);for(let r=0;r!==t;++r)i[r]=n[r];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function Wi(e){let t=new WeakMap;function n(e,t){return t===ie?e.mapping=ne:t===oe&&(e.mapping=re),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const o=i.mapping;if(o===ie||o===oe){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const o=i.image;if(o&&o.height>0){const s=new Mi(o.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}Fi.physical={uniforms:_i([Fi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Wt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ln(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Wt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ln(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ln(1,1,1)},specularColorMap:{value:null}}]),vertexShader:$i.meshphysical_vert,fragmentShader:$i.meshphysical_frag};class ji extends Ti{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,s=r+t,a=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,o=i+e*this.view.width,s-=t*this.view.offsetY,a=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Xi=[.125,.215,.35,.446,.526,.582],Yi=20,Ki=new ji,qi=new ln;let Ji=null;const Zi=(1+Math.sqrt(5))/2,Qi=1/Zi,eo=[new yn(1,1,1),new yn(-1,1,1),new yn(1,1,-1),new yn(-1,1,-1),new yn(0,Zi,Qi),new yn(0,Zi,-Qi),new yn(Qi,0,Zi),new yn(-Qi,0,Zi),new yn(Zi,Qi,0),new yn(-Zi,Qi,0)];class to{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Ji=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=oo(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=io(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ji),e.scissorTest=!1,ro(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ne||e.mapping===re?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ji=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:pe,minFilter:pe,generateMipmaps:!1,type:Se,format:ke,encoding:bt,depthBuffer:!1},r=no(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=no(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const o=e-4+1+Xi.length;for(let s=0;s<o;s++){const o=Math.pow(2,i);n.push(o);let a=1/o;s>e-4?a=Xi[s-e+4-1]:0===s&&(a=0),r.push(a);const l=1/(o-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),_=new Float32Array(m*p*d),b=new Float32Array(g*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,f*p*e),_.set(h,m*p*e);const i=[e,e,e,e,e,e];b.set(i,g*p*e)}const y=new qr;y.setAttribute("position",new Fr(v,f)),y.setAttribute("uv",new Fr(_,m)),y.setAttribute("faceIndex",new Fr(b,g)),t.push(y),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(Yi),i=new yn(0,1,0);return new yi({name:"SphericalGaussianBlur",defines:{n:Yi,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:g,depthTest:!1,depthWrite:!1})}(r,e,t)}return r}_compileMaterial(e){const t=new fi(this._lodPlanes[0],e);this._renderer.compile(t,Ki)}_sceneToCubeUV(e,t,n,r){const i=new Ei(90,1,t,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(qi),a.toneMapping=K,a.autoClear=!1;const u=new Dr({name:"PMREM.Background",side:f,depthWrite:!1,depthTest:!1}),h=new fi(new gi,u);let d=!1;const p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(qi),d=!0);for(let f=0;f<6;f++){const t=f%3;0===t?(i.up.set(0,o[f],0),i.lookAt(s[f],0,0)):1===t?(i.up.set(0,0,o[f]),i.lookAt(0,s[f],0)):(i.up.set(0,o[f],0),i.lookAt(0,0,s[f]));const n=this._cubeSize;ro(r,t*n,f>2?n:0,n,n),a.setRenderTarget(r),d&&a.render(h,i),a.render(e,i)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===ne||e.mapping===re;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=oo()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=io());const i=r?this._cubemapMaterial:this._equirectMaterial,o=new fi(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;ro(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(o,Ki)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=eo[(r-1)%eo.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,s){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new fi(this._lodPlanes[r],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):Yi;f>Yi&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(Yi));const m=[];let g=0;for(let b=0;b<Yi;++b){const e=b/p,t=Math.exp(-e*e/2);m.push(t),0===b?g+=t:b<f&&(g+=2*t)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,s&&(u.poleAxis.value=s);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const _=this._sizeLods[r];ro(t,3*_*(r>v-4?r-v+4:0),4*(this._cubeSize-_),3*_,2*_),a.setRenderTarget(t),a.render(c,Ki)}}function no(e,t,n){const r=new gn(e,t,n);return r.texture.mapping=se,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function ro(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function io(){return new yi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:g,depthTest:!1,depthWrite:!1})}function oo(){return new yi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:g,depthTest:!1,depthWrite:!1})}function so(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,s=o===ie||o===oe,a=o===ne||o===re;if(s||a){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=t.get(i);return null===n&&(n=new to(e)),r=s?n.fromEquirectangular(i,r):n.fromCubemap(i,r),t.set(i,r),r.texture}if(t.has(i))return t.get(i).texture;{const o=i.image;if(s&&o&&o.height>0||a&&o&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(o)){null===n&&(n=new to(e));const o=s?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,o),i.addEventListener("dispose",r),o.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function ao(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function lo(e,t,n,r){const i={},o=new WeakMap;function s(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const n in a.attributes)t.remove(a.attributes[n]);a.removeEventListener("dispose",s),delete i[a.id];const l=o.get(a);l&&(t.remove(l),o.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],o=e[t+2];n.push(r,i,i,o,o,r)}}else{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const a=new(Xt(n)?zr:Ur)(n,1);a.version=s;const l=o.get(e);l&&t.remove(l),o.set(e,a)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(e){const n=e.attributes;for(const i in n)t.update(n[i],34962);const r=e.morphAttributes;for(const i in r){const e=r[i];for(let n=0,r=e.length;n<r;n++)t.update(e[n],34962)}},getWireframeAttribute:function(e){const t=o.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return o.get(e)}}}function co(e,t,n,r){const i=r.isWebGL2;let o,s,a;this.setMode=function(e){o=e},this.setIndex=function(e){s=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(o,r,s,t*a),n.update(r,o,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,s,r*a,c),n.update(l,o,c)}}function uo(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function ho(e,t){return e[0]-t[0]}function po(e,t){return Math.abs(t[1])-Math.abs(e[1])}function fo(e,t){let n=1;const r=t.isInterleavedBufferAttribute?t.data.array:t.array;r instanceof Int8Array?n=127:r instanceof Uint8Array?n=255:r instanceof Uint16Array?n=65535:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),e.divideScalar(n)}function mo(e,t,n){const r={},i=new Float32Array(8),o=new WeakMap,s=new mn,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const r=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,i=void 0!==r?r.length:0;let a=o.get(c);if(void 0===a||a.count!==i){let e=function(){v.dispose(),o.delete(c),c.removeEventListener("dispose",e)};void 0!==a&&a.texture.dispose();const n=void 0!==c.morphAttributes.position,r=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,u=c.morphAttributes.position||[],h=c.morphAttributes.normal||[],d=c.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===r&&(p=2),!0===l&&(p=3);let f=c.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const g=new Float32Array(f*m*4*i),v=new vn(g,f,m,i);v.type=Ee,v.needsUpdate=!0;const _=4*p;for(let t=0;t<i;t++){const e=u[t],i=h[t],o=d[t],a=f*m*4*t;for(let t=0;t<e.count;t++){const c=t*_;!0===n&&(s.fromBufferAttribute(e,t),!0===e.normalized&&fo(s,e),g[a+c+0]=s.x,g[a+c+1]=s.y,g[a+c+2]=s.z,g[a+c+3]=0),!0===r&&(s.fromBufferAttribute(i,t),!0===i.normalized&&fo(s,i),g[a+c+4]=s.x,g[a+c+5]=s.y,g[a+c+6]=s.z,g[a+c+7]=0),!0===l&&(s.fromBufferAttribute(o,t),!0===o.normalized&&fo(s,o),g[a+c+8]=s.x,g[a+c+9]=s.y,g[a+c+10]=s.z,g[a+c+11]=4===o.itemSize?s.w:1)}}a={count:i,texture:v,size:new Wt(f,m)},o.set(c,a),c.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",a.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",a.size)}else{const t=void 0===d?0:d.length;let n=r[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];r[c.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=d[e]}n.sort(po);for(let e=0;e<8;e++)e<t&&n[e][1]?(a[e][0]=n[e][0],a[e][1]=n[e][1]):(a[e][0]=Number.MAX_SAFE_INTEGER,a[e][1]=0);a.sort(ho);const o=c.morphAttributes.position,s=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=a[e],n=t[0],r=t[1];n!==Number.MAX_SAFE_INTEGER&&r?(o&&c.getAttribute("morphTarget"+e)!==o[n]&&c.setAttribute("morphTarget"+e,o[n]),s&&c.getAttribute("morphNormal"+e)!==s[n]&&c.setAttribute("morphNormal"+e,s[n]),i[e]=r,l+=r):(o&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),s&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),i[e]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function go(e,t,n,r){let i=new WeakMap;function o(e){const t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){const s=r.render.frame,a=e.geometry,l=t.get(e,a);return i.get(l)!==s&&(t.update(l),i.set(l,s)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}const vo=new fn,_o=new vn,bo=new _n,yo=new xi,To=[],Eo=[],So=new Float32Array(16),wo=new Float32Array(9),xo=new Float32Array(4);function Mo(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let o=To[i];if(void 0===o&&(o=new Float32Array(i),To[i]=o),0!==t){r.toArray(o,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(o,i)}return o}function Co(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Io(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function ko(e,t){let n=Eo[t];void 0===n&&(n=new Int32Array(t),Eo[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Ro(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ao(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Co(n,t))return;e.uniform2fv(this.addr,t),Io(n,t)}}function Lo(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Co(n,t))return;e.uniform3fv(this.addr,t),Io(n,t)}}function Oo(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Co(n,t))return;e.uniform4fv(this.addr,t),Io(n,t)}}function No(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Co(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Io(n,t)}else{if(Co(n,r))return;xo.set(r),e.uniformMatrix2fv(this.addr,!1,xo),Io(n,r)}}function Po(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Co(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Io(n,t)}else{if(Co(n,r))return;wo.set(r),e.uniformMatrix3fv(this.addr,!1,wo),Io(n,r)}}function Do(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Co(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Io(n,t)}else{if(Co(n,r))return;So.set(r),e.uniformMatrix4fv(this.addr,!1,So),Io(n,r)}}function $o(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Bo(e,t){const n=this.cache;Co(n,t)||(e.uniform2iv(this.addr,t),Io(n,t))}function Fo(e,t){const n=this.cache;Co(n,t)||(e.uniform3iv(this.addr,t),Io(n,t))}function Uo(e,t){const n=this.cache;Co(n,t)||(e.uniform4iv(this.addr,t),Io(n,t))}function zo(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Ho(e,t){const n=this.cache;Co(n,t)||(e.uniform2uiv(this.addr,t),Io(n,t))}function Go(e,t){const n=this.cache;Co(n,t)||(e.uniform3uiv(this.addr,t),Io(n,t))}function Vo(e,t){const n=this.cache;Co(n,t)||(e.uniform4uiv(this.addr,t),Io(n,t))}function Wo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||vo,i)}function jo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||bo,i)}function Xo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||yo,i)}function Yo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||_o,i)}function Ko(e,t){e.uniform1fv(this.addr,t)}function qo(e,t){const n=Mo(t,this.size,2);e.uniform2fv(this.addr,n)}function Jo(e,t){const n=Mo(t,this.size,3);e.uniform3fv(this.addr,n)}function Zo(e,t){const n=Mo(t,this.size,4);e.uniform4fv(this.addr,n)}function Qo(e,t){const n=Mo(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function es(e,t){const n=Mo(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ts(e,t){const n=Mo(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function ns(e,t){e.uniform1iv(this.addr,t)}function rs(e,t){e.uniform2iv(this.addr,t)}function is(e,t){e.uniform3iv(this.addr,t)}function os(e,t){e.uniform4iv(this.addr,t)}function ss(e,t){e.uniform1uiv(this.addr,t)}function as(e,t){e.uniform2uiv(this.addr,t)}function ls(e,t){e.uniform3uiv(this.addr,t)}function cs(e,t){e.uniform4uiv(this.addr,t)}function us(e,t,n){const r=t.length,i=ko(n,r);e.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.setTexture2D(t[o]||vo,i[o])}function hs(e,t,n){const r=t.length,i=ko(n,r);e.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.setTexture3D(t[o]||bo,i[o])}function ds(e,t,n){const r=t.length,i=ko(n,r);e.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.setTextureCube(t[o]||yo,i[o])}function ps(e,t,n){const r=t.length,i=ko(n,r);e.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.setTexture2DArray(t[o]||_o,i[o])}class fs{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Ro;case 35664:return Ao;case 35665:return Lo;case 35666:return Oo;case 35674:return No;case 35675:return Po;case 35676:return Do;case 5124:case 35670:return $o;case 35667:case 35671:return Bo;case 35668:case 35672:return Fo;case 35669:case 35673:return Uo;case 5125:return zo;case 36294:return Ho;case 36295:return Go;case 36296:return Vo;case 35678:case 36198:case 36298:case 36306:case 35682:return Wo;case 35679:case 36299:case 36307:return jo;case 35680:case 36300:case 36308:case 36293:return Xo;case 36289:case 36303:case 36311:case 36292:return Yo}}(t.type)}}class ms{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ko;case 35664:return qo;case 35665:return Jo;case 35666:return Zo;case 35674:return Qo;case 35675:return es;case 35676:return ts;case 5124:case 35670:return ns;case 35667:case 35671:return rs;case 35668:case 35672:return is;case 35669:case 35673:return os;case 5125:return ss;case 36294:return as;case 36295:return ls;case 36296:return cs;case 35678:case 36198:case 36298:case 36306:case 35682:return us;case 35679:case 36299:case 36307:return hs;case 35680:case 36300:case 36308:case 36293:return ds;case 36289:case 36303:case 36311:case 36292:return ps}}(t.type)}}class gs{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(e,t[o.id],n)}}}const vs=/(\w+)(\])?(\[|\.)?/g;function _s(e,t){e.seq.push(t),e.map[t.id]=t}function bs(e,t,n){const r=e.name,i=r.length;for(vs.lastIndex=0;;){const o=vs.exec(r),s=vs.lastIndex;let a=o[1];const l="]"===o[2],c=o[3];if(l&&(a|=0),void 0===c||"["===c&&s+2===i){_s(n,void 0===c?new fs(a,e,t):new ms(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new gs(a),_s(n,e)),n=e}}}class ys{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);bs(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,o=t.length;i!==o;++i){const o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Ts(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let Es=0;function Ss(e,t,n){const r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let s=i;s<o;s++){const e=s+1;r.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[s]))}return r.join("\n")}(e.getShaderSource(t),r)}return i}function ws(e,t){const n=function(e){switch(e){case bt:return["Linear","( value )"];case yt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function xs(e,t){let n;switch(t){case q:n="Linear";break;case J:n="Reinhard";break;case Z:n="OptimizedCineon";break;case Q:n="ACESFilmic";break;case ee:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ms(e){return""!==e}function Cs(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Is(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ks=/^[ \t]*#include +<([\w\d./]+)>/gm;function Rs(e){return e.replace(ks,As)}function As(e,t){const n=$i[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Rs(n)}const Ls=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Os=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ns(e){return e.replace(Os,Ds).replace(Ls,Ps)}function Ps(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ds(e,t,n,r)}function Ds(e,t,n,r){let i="";for(let o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function $s(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Bs(e,t,n,r){const i=e.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===u?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===h?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===d&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ne:case re:t="ENVMAP_TYPE_CUBE";break;case se:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),p=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===re&&(t="ENVMAP_MODE_REFRACTION");return t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case j:t="ENVMAP_BLENDING_MULTIPLY";break;case X:t="ENVMAP_BLENDING_MIX";break;case Y:t="ENVMAP_BLENDING_ADD"}return t}(n),m=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),g=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ms).join("\n")}(n),v=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(o),_=i.createProgram();let b,y,T=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(b=[v].filter(Ms).join("\n"),b.length>0&&(b+="\n"),y=[g,v].filter(Ms).join("\n"),y.length>0&&(y+="\n")):(b=[$s(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ms).join("\n"),y=[g,$s(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+p:"",n.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==K?"#define TONE_MAPPING":"",n.toneMapping!==K?$i.tonemapping_pars_fragment:"",n.toneMapping!==K?xs("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",$i.encodings_pars_fragment,ws("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ms).join("\n")),s=Rs(s),s=Cs(s,n),s=Is(s,n),a=Rs(a),a=Cs(a,n),a=Is(a,n),s=Ns(s),a=Ns(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(T="#version 300 es\n",b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,y=["#define varying in",n.glslVersion===Rt?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Rt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const E=T+y+a,S=Ts(i,35633,T+b+s),w=Ts(i,35632,E);if(i.attachShader(_,S),i.attachShader(_,w),void 0!==n.index0AttributeName?i.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_),e.debug.checkShaderErrors){const e=i.getProgramInfoLog(_).trim(),t=i.getShaderInfoLog(S).trim(),n=i.getShaderInfoLog(w).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(_,35714)){r=!1;const t=Ss(i,S,"vertex"),n=Ss(i,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===n)&&(o=!1);o&&(this.diagnostics={runnable:r,programLog:e,vertexShader:{log:t,prefix:b},fragmentShader:{log:n,prefix:y}})}let x,M;return i.deleteShader(S),i.deleteShader(w),this.getUniforms=function(){return void 0===x&&(x=new ys(i,_)),x},this.getAttributes=function(){return void 0===M&&(M=function(e,t){const n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),o=r.name;let s=1;35674===r.type&&(s=2),35675===r.type&&(s=3),35676===r.type&&(s=4),n[o]={type:r.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(i,_)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=Es++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=w,this}let Fs=0;class Us{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new zs(e);t.set(e,n)}return t.get(e)}}class zs{constructor(e){this.id=Fs++,this.code=e,this.usedTimes=0}}function Hs(e,t,n,r,i,o,s){const a=new lr,l=new Us,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.vertexTextures;let p=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,a,c,_,b){const y=_.fog,T=b.geometry,E=o.isMeshStandardMaterial?_.environment:null,S=(o.isMeshStandardMaterial?n:t).get(o.envMap||E),w=S&&S.mapping===se?S.image.height:null,x=g[o.type];null!==o.precision&&(p=i.getMaxPrecision(o.precision),p!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead."));const M=T.morphAttributes.position||T.morphAttributes.normal||T.morphAttributes.color,C=void 0!==M?M.length:0;let I,k,R,A,L=0;if(void 0!==T.morphAttributes.position&&(L=1),void 0!==T.morphAttributes.normal&&(L=2),void 0!==T.morphAttributes.color&&(L=3),x){const e=Fi[x];I=e.vertexShader,k=e.fragmentShader}else I=o.vertexShader,k=o.fragmentShader,l.update(o),R=l.getVertexShaderID(o),A=l.getFragmentShaderID(o);const O=e.getRenderTarget(),N=o.alphaTest>0,P=o.clearcoat>0,D=o.iridescence>0;return{isWebGL2:u,shaderID:x,shaderName:o.type,vertexShader:I,fragmentShader:k,defines:o.defines,customVertexShaderID:R,customFragmentShaderID:A,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:p,instancing:!0===b.isInstancedMesh,instancingColor:!0===b.isInstancedMesh&&null!==b.instanceColor,supportsVertexTextures:d,outputEncoding:null===O?e.outputEncoding:!0===O.isXRRenderTarget?O.texture.encoding:bt,map:!!o.map,matcap:!!o.matcap,envMap:!!S,envMapMode:S&&S.mapping,envMapCubeUVHeight:w,lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===wt,tangentSpaceNormalMap:o.normalMapType===St,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===yt,clearcoat:P,clearcoatMap:P&&!!o.clearcoatMap,clearcoatRoughnessMap:P&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:P&&!!o.clearcoatNormalMap,iridescence:D,iridescenceMap:D&&!!o.iridescenceMap,iridescenceThicknessMap:D&&!!o.iridescenceThicknessMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,opaque:!1===o.transparent&&o.blending===v,alphaMap:!!o.alphaMap,alphaTest:N,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!T.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!T.attributes.color&&4===T.attributes.color.itemSize,vertexUvs:!!o.map||!!o.bumpMap||!!o.normalMap||!!o.specularMap||!!o.alphaMap||!!o.emissiveMap||!!o.roughnessMap||!!o.metalnessMap||!!o.clearcoatMap||!!o.clearcoatRoughnessMap||!!o.clearcoatNormalMap||!!o.iridescenceMap||!!o.iridescenceThicknessMap||!!o.displacementMap||!!o.transmissionMap||!!o.thicknessMap||!!o.specularIntensityMap||!!o.specularColorMap||!!o.sheenColorMap||!!o.sheenRoughnessMap,uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.iridescenceMap||o.iridescenceThicknessMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap)&&!!o.displacementMap,fog:!!y,useFog:!0===o.fog,fogExp2:y&&y.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===b.isSkinnedMesh,morphTargets:void 0!==T.morphAttributes.position,morphNormals:void 0!==T.morphAttributes.normal,morphColors:void 0!==T.morphAttributes.color,morphTargetsCount:C,morphTextureStride:L,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:o.toneMapped?e.toneMapping:K,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===m,flipSided:o.side===f,useDepthPacking:!!o.depthPacking,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0),t.supportsVertexTextures&&a.enable(1),t.instancing&&a.enable(2),t.instancingColor&&a.enable(3),t.map&&a.enable(4),t.matcap&&a.enable(5),t.envMap&&a.enable(6),t.lightMap&&a.enable(7),t.aoMap&&a.enable(8),t.emissiveMap&&a.enable(9),t.bumpMap&&a.enable(10),t.normalMap&&a.enable(11),t.objectSpaceNormalMap&&a.enable(12),t.tangentSpaceNormalMap&&a.enable(13),t.clearcoat&&a.enable(14),t.clearcoatMap&&a.enable(15),t.clearcoatRoughnessMap&&a.enable(16),t.clearcoatNormalMap&&a.enable(17),t.iridescence&&a.enable(18),t.iridescenceMap&&a.enable(19),t.iridescenceThicknessMap&&a.enable(20),t.displacementMap&&a.enable(21),t.specularMap&&a.enable(22),t.roughnessMap&&a.enable(23),t.metalnessMap&&a.enable(24),t.gradientMap&&a.enable(25),t.alphaMap&&a.enable(26),t.alphaTest&&a.enable(27),t.vertexColors&&a.enable(28),t.vertexAlphas&&a.enable(29),t.vertexUvs&&a.enable(30),t.vertexTangents&&a.enable(31),t.uvsVertexOnly&&a.enable(32),t.fog&&a.enable(33),e.push(a.mask),a.disableAll(),t.useFog&&a.enable(0),t.flatShading&&a.enable(1),t.logarithmicDepthBuffer&&a.enable(2),t.skinning&&a.enable(3),t.morphTargets&&a.enable(4),t.morphNormals&&a.enable(5),t.morphColors&&a.enable(6),t.premultipliedAlpha&&a.enable(7),t.shadowMapEnabled&&a.enable(8),t.physicallyCorrectLights&&a.enable(9),t.doubleSided&&a.enable(10),t.flipSided&&a.enable(11),t.useDepthPacking&&a.enable(12),t.dithering&&a.enable(13),t.specularIntensityMap&&a.enable(14),t.specularColorMap&&a.enable(15),t.transmission&&a.enable(16),t.transmissionMap&&a.enable(17),t.thicknessMap&&a.enable(18),t.sheen&&a.enable(19),t.sheenColorMap&&a.enable(20),t.sheenRoughnessMap&&a.enable(21),t.decodeVideoTexture&&a.enable(22),t.opaque&&a.enable(23),e.push(a.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=Fi[t];n=bi.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=c.length;e<i;e++){const t=c[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new Bs(e,n,t,o),c.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Gs(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Vs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ws(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function js(){const e=[];let t=0;const n=[],r=[],i=[];function o(n,r,i,o,s,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=a),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,a,l,c){const u=o(e,t,s,a,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(e,t,s,a,l,c){const u=o(e,t,s,a,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Vs),r.length>1&&r.sort(t||Ws),i.length>1&&i.sort(t||Ws)}}}function Xs(){let e=new WeakMap;return{get:function(t,n){let r;return!1===e.has(t)?(r=new js,e.set(t,[r])):n>=e.get(t).length?(r=new js,e.get(t).push(r)):r=e.get(t)[n],r},dispose:function(){e=new WeakMap}}}function Ys(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new yn,color:new ln};break;case"SpotLight":n={position:new yn,direction:new yn,color:new ln,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new yn,color:new ln,distance:0,decay:0};break;case"HemisphereLight":n={direction:new yn,skyColor:new ln,groundColor:new ln};break;case"RectAreaLight":n={color:new ln,position:new yn,halfWidth:new yn,halfHeight:new yn}}return e[t.id]=n,n}}}let Ks=0;function qs(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Js(e,t){const n=new Ys,r=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)i.probe.push(new yn);const o=new yn,s=new Jn,a=new Jn;return{setup:function(o,s){let a=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,g=0,v=0;o.sort(qs);const _=!0!==s?Math.PI:1;for(let e=0,t=o.length;e<t;e++){const t=o[e],s=t.color,b=t.intensity,y=t.distance,T=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=s.r*b*_,l+=s.g*b*_,c+=s.b*b*_;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.directionalShadow[u]=n,i.directionalShadowMap[u]=T,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){const e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(s).multiplyScalar(b*_),e.distance=y,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.spotShadow[d]=n,i.spotShadowMap[d]=T,i.spotShadowMatrix[d]=t.shadow.matrix,v++}i.spot[d]=e,d++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(s).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[p]=e,p++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=T,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(b*_),e.groundColor.copy(t.groundColor).multiplyScalar(b*_),i.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Bi.LTC_FLOAT_1,i.rectAreaLTC2=Bi.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Bi.LTC_HALF_1,i.rectAreaLTC2=Bi.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const b=i.hash;(b.directionalLength!==u||b.pointLength!==h||b.spotLength!==d||b.rectAreaLength!==p||b.hemiLength!==f||b.numDirectionalShadows!==m||b.numPointShadows!==g||b.numSpotShadows!==v)&&(i.directional.length=u,i.spot.length=d,i.rectArea.length=p,i.point.length=h,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=v,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=p,b.hemiLength=f,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=v,i.version=Ks++)},setupView:function(e,t){let n=0,r=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){const t=e[d];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),o.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),o.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),a.identity(),s.copy(t.matrixWorld),s.premultiply(h),a.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=i.point[r];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),r++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function Zs(e,t){const n=new Js(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Qs(e,t){let n=new WeakMap;return{get:function(r){let i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new Zs(e,t),n.set(r,[i])):o>=n.get(r).length?(i=new Zs(e,t),n.get(r).push(i)):i=n.get(r)[o],i},dispose:function(){n=new WeakMap}}}class ea extends Pr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Tt,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ta extends Pr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new yn,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const na="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",ra="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function ia(e,t,n){let r=new Oi;const i=new Wt,o=new Wt,s=new mn,a=new ea({depthPacking:Et}),l=new ta,c={},h=n.maxTextureSize,v={0:f,1:p,2:m},_=new yi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Wt},radius:{value:4}},vertexShader:na,fragmentShader:ra}),b=_.clone();b.defines.HORIZONTAL_PASS=1;const y=new qr;y.setAttribute("position",new Fr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new fi(y,_),E=this;function S(n,r){const o=t.update(T);_.defines.VSM_SAMPLES!==n.blurSamples&&(_.defines.VSM_SAMPLES=n.blurSamples,b.defines.VSM_SAMPLES=n.blurSamples,_.needsUpdate=!0,b.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new gn(i.x,i.y)),_.uniforms.shadow_pass.value=n.map.texture,_.uniforms.resolution.value=n.mapSize,_.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,o,_,T,null),b.uniforms.shadow_pass.value=n.mapPass.texture,b.uniforms.resolution.value=n.mapSize,b.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,o,b,T,null)}function w(t,n,r,i,o,s){let u=null;const h=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(u=void 0!==h?h:!0===r.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const e=u.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=u.clone(),r[t]=i),u=i}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=s===d?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:v[n.side],u.alphaMap=n.alphaMap,u.alphaTest=n.alphaTest,u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.displacementMap=n.displacementMap,u.displacementScale=n.displacementScale,u.displacementBias=n.displacementBias,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=o),u}function x(n,i,o,s,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===d)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=i[c.materialIndex];if(u&&u.visible){const t=w(n,u,s,o.near,o.far,a);e.renderBufferDirect(o,null,r,t,n,c)}}}else if(i.visible){const t=w(n,i,s,o.near,o.far,a);e.renderBufferDirect(o,null,r,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)x(l[e],i,o,s,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=u,this.render=function(t,n,a){if(!1===E.enabled||!1===E.autoUpdate&&!1===E.needsUpdate||0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),p=e.state;p.setBlending(g),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(let f=0,m=t.length;f<m;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const u=c.getFrameExtents();if(i.multiply(u),o.copy(c.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(o.x=Math.floor(h/u.x),i.x=o.x*u.x,c.mapSize.x=o.x),i.y>h&&(o.y=Math.floor(h/u.y),i.y=o.y*u.y,c.mapSize.y=o.y)),null===c.map){const e=this.type!==d?{minFilter:ue,magFilter:ue}:{};c.map=new gn(i.x,i.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const m=c.getViewportCount();for(let e=0;e<m;e++){const t=c.getViewport(e);s.set(o.x*t.x,o.y*t.y,o.x*t.z,o.y*t.w),p.viewport(s),c.updateMatrices(l,e),r=c.getFrustum(),x(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===d&&S(c,a),c.needsUpdate=!1}E.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function oa(e,t,n){const r=n.isWebGL2;const i=new function(){let t=!1;const n=new mn;let r=null;const i=new mn(0,0,0,0);return{setMask:function(n){r!==n&&!t&&(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,s,a){!0===a&&(t*=s,r*=s,o*=s),n.set(t,r,o,s),!1===i.equals(n)&&(e.clearColor(t,r,o,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){e?Te(2929):Ee(2929)},setMask:function(r){n!==r&&!t&&(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case B:e.depthFunc(512);break;case F:e.depthFunc(519);break;case U:e.depthFunc(513);break;case z:e.depthFunc(515);break;case H:e.depthFunc(514);break;case G:e.depthFunc(518);break;case V:e.depthFunc(516);break;case W:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},s=new function(){let t=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?Te(2960):Ee(2960))},setMask:function(r){n!==r&&!t&&(e.stencilMask(r),n=r)},setFunc:function(t,n,s){(r!==t||i!==n||o!==s)&&(e.stencilFunc(t,n,s),r=t,i=n,o=s)},setOp:function(t,n,r){(s!==t||a!==n||l!==r)&&(e.stencilOp(t,n,r),s=t,a=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null}}},u=new WeakMap,h=new WeakMap;let d={},p={},j=new WeakMap,X=[],Y=null,K=!1,q=null,J=null,Z=null,Q=null,ee=null,te=null,ne=null,re=!1,ie=null,oe=null,se=null,ae=null,le=null;const ce=e.getParameter(35661);let ue=!1,he=0;const de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(he=parseFloat(/^WebGL (\d)/.exec(de)[1]),ue=he>=1):-1!==de.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),ue=he>=2);let pe=null,fe={};const me=e.getParameter(3088),ge=e.getParameter(2978),ve=(new mn).fromArray(me),_e=(new mn).fromArray(ge);function be(t,n,r){const i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let s=0;s<r;s++)e.texImage2D(n+s,0,6408,1,1,0,6408,5121,i);return o}const ye={};function Te(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function Ee(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}ye[3553]=be(3553,3553,1),ye[34067]=be(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Te(2929),o.setFunc(z),Me(!1),Ce(l),Te(2884),xe(g);const Se={[E]:32774,[S]:32778,[w]:32779};if(r)Se[x]=32775,Se[M]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(Se[x]=e.MIN_EXT,Se[M]=e.MAX_EXT)}const we={[C]:0,[I]:1,[k]:768,[A]:770,[$]:776,[P]:774,[O]:772,[R]:769,[L]:771,[D]:775,[N]:773};function xe(t,n,r,i,o,s,a,l){if(t!==g){if(!1===K&&(Te(3042),K=!0),t===T)o=o||n,s=s||r,a=a||i,(n!==J||o!==ee)&&(e.blendEquationSeparate(Se[n],Se[o]),J=n,ee=o),(r!==Z||i!==Q||s!==te||a!==ne)&&(e.blendFuncSeparate(we[r],we[i],we[s],we[a]),Z=r,Q=i,te=s,ne=a),q=t,re=null;else if(t!==q||l!==re){if((J!==E||ee!==E)&&(e.blendEquation(32774),J=E,ee=E),l)switch(t){case v:e.blendFuncSeparate(1,771,1,771);break;case _:e.blendFunc(1,1);break;case b:e.blendFuncSeparate(0,769,0,1);break;case y:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case v:e.blendFuncSeparate(770,771,1,771);break;case _:e.blendFunc(770,1);break;case b:e.blendFuncSeparate(0,769,0,1);break;case y:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}Z=null,Q=null,te=null,ne=null,q=t,re=l}}else!0===K&&(Ee(3042),K=!1)}function Me(t){ie!==t&&(t?e.frontFace(2304):e.frontFace(2305),ie=t)}function Ce(t){t!==a?(Te(2884),t!==oe&&(t===l?e.cullFace(1029):t===c?e.cullFace(1028):e.cullFace(1032))):Ee(2884),oe=t}function Ie(t,n,r){t?(Te(32823),(ae!==n||le!==r)&&(e.polygonOffset(n,r),ae=n,le=r)):Ee(32823)}function ke(t){void 0===t&&(t=33984+ce-1),pe!==t&&(e.activeTexture(t),pe=t)}return{buffers:{color:i,depth:o,stencil:s},enable:Te,disable:Ee,bindFramebuffer:function(t,n){return p[t]!==n&&(e.bindFramebuffer(t,n),p[t]=n,r&&(36009===t&&(p[36160]=n),36160===t&&(p[36009]=n)),!0)},drawBuffers:function(r,i){let o=X,s=!1;if(r)if(o=j.get(i),void 0===o&&(o=[],j.set(i,o)),r.isWebGLMultipleRenderTargets){const e=r.texture;if(o.length!==e.length||36064!==o[0]){for(let t=0,n=e.length;t<n;t++)o[t]=36064+t;o.length=e.length,s=!0}}else 36064!==o[0]&&(o[0]=36064,s=!0);else 1029!==o[0]&&(o[0]=1029,s=!0);s&&(n.isWebGL2?e.drawBuffers(o):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(t){return Y!==t&&(e.useProgram(t),Y=t,!0)},setBlending:xe,setMaterial:function(e,t){e.side===m?Ee(2884):Te(2884);let n=e.side===f;t&&(n=!n),Me(n),e.blending===v&&!1===e.transparent?xe(g):xe(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),i.setMask(e.colorWrite);const r=e.stencilWrite;s.setTest(r),r&&(s.setMask(e.stencilWriteMask),s.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),s.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ie(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?Te(32926):Ee(32926)},setFlipSided:Me,setCullFace:Ce,setLineWidth:function(t){t!==se&&(ue&&e.lineWidth(t),se=t)},setPolygonOffset:Ie,setScissorTest:function(e){e?Te(3089):Ee(3089)},activeTexture:ke,bindTexture:function(t,n){null===pe&&ke();let r=fe[pe];void 0===r&&(r={type:void 0,texture:void 0},fe[pe]=r),(r.type!==t||r.texture!==n)&&(e.bindTexture(t,n||ye[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=fe[pe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let r=h.get(n);void 0===r&&(r=new WeakMap,h.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=h.get(n).get(t);u.get(t)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),u.set(t,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===ve.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ve.copy(t))},viewport:function(t){!1===_e.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),_e.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===r&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},pe=null,fe={},p={},j=new WeakMap,X=[],Y=null,K=!1,q=null,J=null,Z=null,Q=null,ee=null,te=null,ne=null,re=!1,ie=null,oe=null,se=null,ae=null,le=null,ve.set(0,0,e.canvas.width,e.canvas.height),_e.set(0,0,e.canvas.width,e.canvas.height),i.reset(),o.reset(),s.reset()}}}function sa(e,t,n,r,i,o,s){const a=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(e,t){return v?new OffscreenCanvas(e,t):qt("canvas")}function b(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const r=t?Gt:Math.floor,o=r(i*e.width),s=r(i*e.height);void 0===m&&(m=_(o,s));const a=n?_(o,s):m;return a.width=o,a.height=s,a.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function y(e){return zt(e.width)&&zt(e.height)}function T(e,t){return e.generateMipmaps&&t&&e.minFilter!==ue&&e.minFilter!==pe}function E(t){e.generateMipmap(t)}function S(n,r,i,o){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===a)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return 6403===r&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===r&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===r&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=o===yt&&!1===s?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),(33325===l||33326===l||33327===l||33328===l||34842===l||34836===l)&&t.get("EXT_color_buffer_float"),l}function w(e,t,n){return!0===T(e,n)||e.isFramebufferTexture&&e.minFilter!==ue&&e.minFilter!==pe?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function x(e){return e===ue||e===he||e===de?9728:9729}function M(e){const t=e.target;t.removeEventListener("dispose",M),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=g.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&I(e),0===Object.keys(i).length&&g.delete(n)}r.remove(e)}(t),t.isVideoTexture&&f.delete(t)}function C(t){const n=t.target;n.removeEventListener("dispose",C),function(t){const n=t.texture,i=r.get(t),o=r.get(n);if(void 0!==o.__webglTexture&&(e.deleteTexture(o.__webglTexture),s.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++)e.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[r]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let a=0,l=n.length;a<l;a++){const t=r.get(n[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(n[a])}r.remove(n),r.remove(t)}(n)}function I(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete g.get(i)[n.__cacheKey],s.memory.textures--}let k=0;function R(e,t){const i=r.get(e);if(e.isVideoTexture&&function(e){const t=s.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&i.__version!==e.version){const n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void P(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}const A={[ae]:10497,[le]:33071,[ce]:33648},L={[ue]:9728,[he]:9984,[de]:9986,[pe]:9729,[fe]:9985,[me]:9987};function O(n,o,s){if(s?(e.texParameteri(n,10242,A[o.wrapS]),e.texParameteri(n,10243,A[o.wrapT]),(32879===n||35866===n)&&e.texParameteri(n,32882,A[o.wrapR]),e.texParameteri(n,10240,L[o.magFilter]),e.texParameteri(n,10241,L[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),(32879===n||35866===n)&&e.texParameteri(n,32882,33071),(o.wrapS!==le||o.wrapT!==le)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,x(o.magFilter)),e.texParameteri(n,10241,x(o.minFilter)),o.minFilter!==ue&&o.minFilter!==pe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const s=t.get("EXT_texture_filter_anisotropic");if(o.type===Ee&&!1===t.has("OES_texture_float_linear")||!1===a&&o.type===Se&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function N(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",M));const i=n.source;let o=g.get(i);void 0===o&&(o={},g.set(i,o));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(a!==t.__cacheKey){void 0===o[a]&&(o[a]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),o[a].usedTimes++;const i=o[t.__cacheKey];void 0!==i&&(o[t.__cacheKey].usedTimes--,0===i.usedTimes&&I(n)),t.__cacheKey=a,t.__webglTexture=o[a].texture}return r}function P(t,r,i){let s=3553;r.isDataArrayTexture&&(s=35866),r.isData3DTexture&&(s=32879);const l=N(t,r),c=r.source;if(n.activeTexture(33984+i),n.bindTexture(s,t.__webglTexture),c.version!==c.__currentVersion||!0===l){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const t=function(e){return!a&&(e.wrapS!==le||e.wrapT!==le||e.minFilter!==ue&&e.minFilter!==pe)}(r)&&!1===y(r.image);let i=b(r.image,t,!1,u);i=z(r,i);const h=y(i)||a,d=o.convert(r.format,r.encoding);let p,f=o.convert(r.type),m=S(r.internalFormat,d,f,r.encoding,r.isVideoTexture);O(s,r,h);const g=r.mipmaps,v=a&&!0!==r.isVideoTexture,_=void 0===c.__currentVersion||!0===l,x=w(r,i,h);if(r.isDepthTexture)m=6402,a?m=r.type===Ee?36012:r.type===Te?33190:r.type===Me?35056:33189:r.type===Ee&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Le&&6402===m&&r.type!==be&&r.type!==Te&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Te,f=o.convert(r.type)),r.format===Oe&&6402===m&&(m=34041,r.type!==Me&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Me,f=o.convert(r.type))),_&&(v?n.texStorage2D(3553,1,m,i.width,i.height):n.texImage2D(3553,0,m,i.width,i.height,0,d,f,null));else if(r.isDataTexture)if(g.length>0&&h){v&&_&&n.texStorage2D(3553,x,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],v?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,m,p.width,p.height,0,d,f,p.data);r.generateMipmaps=!1}else v?(_&&n.texStorage2D(3553,x,m,i.width,i.height),n.texSubImage2D(3553,0,0,0,i.width,i.height,d,f,i.data)):n.texImage2D(3553,0,m,i.width,i.height,0,d,f,i.data);else if(r.isCompressedTexture){v&&_&&n.texStorage2D(3553,x,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],r.format!==ke?null!==d?v?n.compressedTexSubImage2D(3553,e,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,e,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,m,p.width,p.height,0,d,f,p.data)}else if(r.isDataArrayTexture)v?(_&&n.texStorage3D(35866,x,m,i.width,i.height,i.depth),n.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,d,f,i.data)):n.texImage3D(35866,0,m,i.width,i.height,i.depth,0,d,f,i.data);else if(r.isData3DTexture)v?(_&&n.texStorage3D(32879,x,m,i.width,i.height,i.depth),n.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,d,f,i.data)):n.texImage3D(32879,0,m,i.width,i.height,i.depth,0,d,f,i.data);else if(r.isFramebufferTexture){if(_)if(v)n.texStorage2D(3553,x,m,i.width,i.height);else{let e=i.width,t=i.height;for(let r=0;r<x;r++)n.texImage2D(3553,r,m,e,t,0,d,f,null),e>>=1,t>>=1}}else if(g.length>0&&h){v&&_&&n.texStorage2D(3553,x,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],v?n.texSubImage2D(3553,e,0,0,d,f,p):n.texImage2D(3553,e,m,d,f,p);r.generateMipmaps=!1}else v?(_&&n.texStorage2D(3553,x,m,i.width,i.height),n.texSubImage2D(3553,0,0,0,d,f,i)):n.texImage2D(3553,0,m,d,f,i);T(r,h)&&E(s),c.__currentVersion=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function D(t,i,s,a,l){const c=o.convert(s.format,s.encoding),u=o.convert(s.type),h=S(s.internalFormat,c,u,s.encoding);r.get(i).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),n.bindFramebuffer(36160,t),U(i)?d.framebufferTexture2DMultisampleEXT(36160,a,l,r.get(s).__webglTexture,0,F(i)):e.framebufferTexture2D(36160,a,l,r.get(s).__webglTexture,0),n.bindFramebuffer(36160,null)}function $(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||U(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===Ee?i=36012:t.type===Te&&(i=33190));const r=F(n);U(n)?d.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):e.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){const i=F(n);r&&!1===U(n)?e.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):U(n)?d.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let i=0;i<t.length;i++){const s=t[i],a=o.convert(s.format,s.encoding),l=o.convert(s.type),c=S(s.internalFormat,a,l,s.encoding),u=F(n);r&&!1===U(n)?e.renderbufferStorageMultisample(36161,u,c,n.width,n.height):U(n)?d.renderbufferStorageMultisampleEXT(36161,u,c,n.width,n.height):e.renderbufferStorage(36161,c,n.width,n.height)}}e.bindRenderbuffer(36161,null)}function B(t){const i=r.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(i.depthTexture).__webglTexture||i.depthTexture.image.width!==i.width||i.depthTexture.image.height!==i.height)&&(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),R(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,s=F(i);if(i.depthTexture.format===Le)U(i)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,s):e.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==Oe)throw new Error("Unknown depthTexture format");U(i)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,s):e.framebufferTexture2D(36160,33306,3553,o,0)}}(i.__webglFramebuffer,t)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),$(i.__webglDepthbuffer[r],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),$(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function F(e){return Math.min(h,e.samples)}function U(e){const n=r.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function z(e,n){const r=e.encoding,i=e.format,o=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===At||r!==bt&&(r===yt?!1===a?!0===t.has("EXT_sRGB")&&i===ke?(e.format=At,e.minFilter=pe,e.generateMipmaps=!1):n=un.sRGBToLinear(n):(i!==ke||o!==ge)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",r)),n}this.allocateTextureUnit=function(){const e=k;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),k+=1,e},this.resetTextureUnits=function(){k=0},this.setTexture2D=R,this.setTexture2DArray=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?P(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?P(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=function(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;const s=N(t,r),l=r.source;if(n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),l.version!==l.__currentVersion||!0===s){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const t=r.isCompressedTexture||r.image[0].isCompressedTexture,i=r.image[0]&&r.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=t||i?i?r.image[e].image:r.image[e]:b(r.image[e],!1,!0,c),u[e]=z(r,u[e]);const h=u[0],d=y(h)||a,p=o.convert(r.format,r.encoding),f=o.convert(r.type),m=S(r.internalFormat,p,f,r.encoding),g=a&&!0!==r.isVideoTexture,v=void 0===l.__currentVersion||!0===s;let _,x=w(r,h,d);if(O(34067,r,d),t){g&&v&&n.texStorage2D(34067,x,m,h.width,h.height);for(let e=0;e<6;e++){_=u[e].mipmaps;for(let t=0;t<_.length;t++){const i=_[t];r.format!==ke?null!==p?g?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,p,i.data):n.compressedTexImage2D(34069+e,t,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,p,f,i.data):n.texImage2D(34069+e,t,m,i.width,i.height,0,p,f,i.data)}}}else{_=r.mipmaps,g&&v&&(_.length>0&&x++,n.texStorage2D(34067,x,m,u[0].width,u[0].height));for(let e=0;e<6;e++)if(i){g?n.texSubImage2D(34069+e,0,0,0,u[e].width,u[e].height,p,f,u[e].data):n.texImage2D(34069+e,0,m,u[e].width,u[e].height,0,p,f,u[e].data);for(let t=0;t<_.length;t++){const r=_[t].image[e].image;g?n.texSubImage2D(34069+e,t+1,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+e,t+1,m,r.width,r.height,0,p,f,r.data)}}else{g?n.texSubImage2D(34069+e,0,0,0,p,f,u[e]):n.texImage2D(34069+e,0,m,p,f,u[e]);for(let t=0;t<_.length;t++){const r=_[t];g?n.texSubImage2D(34069+e,t+1,0,0,p,f,r.image[e]):n.texImage2D(34069+e,t+1,m,p,f,r.image[e])}}}T(r,d)&&E(34067),l.__currentVersion=l.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}(s,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,s.__webglTexture))},this.rebindTextures=function(e,t,n){const i=r.get(e);void 0!==t&&D(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&B(e)},this.setupRenderTarget=function(t){const l=t.texture,c=r.get(t),u=r.get(l);t.addEventListener("dispose",C),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,s.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=y(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d)if(i.drawBuffers){const n=t.texture;for(let t=0,i=n.length;t<i;t++){const i=r.get(n[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&t.samples>0&&!1===U(t)){const r=d?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let n=0;n<r.length;n++){const i=r[n];c.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[n]);const s=o.convert(i.format,i.encoding),a=o.convert(i.type),l=S(i.internalFormat,s,a,i.encoding),u=F(t);e.renderbufferStorageMultisample(36161,u,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+n,36161,c.__webglColorRenderbuffer[n])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),$(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}}if(h){n.bindTexture(34067,u.__webglTexture),O(34067,l,p);for(let e=0;e<6;e++)D(c.__webglFramebuffer[e],t,l,36064,34069+e);T(l,p)&&E(34067),n.unbindTexture()}else if(d){const e=t.texture;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=r.get(o);n.bindTexture(3553,s.__webglTexture),O(3553,o,p),D(c.__webglFramebuffer,t,o,36064+i,3553),T(o,p)&&E(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,u.__webglTexture),O(e,l,p),D(c.__webglFramebuffer,t,l,36064,e),T(l,p)&&E(e),n.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(e){const t=y(e)||a,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let o=0,s=i.length;o<s;o++){const s=i[o];if(T(s,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(s).__webglTexture;n.bindTexture(t,i),E(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===U(t)){const i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=t.width,s=t.height;let a=16384;const l=[],c=t.stencilBuffer?33306:36096,u=r.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);n.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,u.__webglFramebuffer);for(let n=0;n<i.length;n++){l.push(36064+n),t.depthBuffer&&l.push(c);const d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),h){const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,o,s,0,0,o,s,a,9728),p&&e.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,u.__webglColorRenderbuffer[t]);const o=r.get(i[t]).__webglTexture;n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,o,0)}n.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=D,this.useMultisampledRTT=U}function aa(e,t,n){const r=n.isWebGL2;return{convert:function(n){let i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n===ge)return 5121;if(n===we)return 32819;if(n===xe)return 32820;if(n===ve)return 5120;if(n===_e)return 5122;if(n===be)return 5123;if(n===ye)return 5124;if(n===Te)return 5125;if(n===Ee)return 5126;if(n===Se)return r?5131:(i=t.get("OES_texture_half_float"),null!==i?i.HALF_FLOAT_OES:null);if(n===Ce)return 6406;if(n===ke)return 6408;if(n===Re)return 6409;if(n===Ae)return 6410;if(n===Le)return 6402;if(n===Oe)return 34041;if(n===Ne)return 6403;if(n===Ie)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===At)return i=t.get("EXT_sRGB"),null!==i?i.SRGB_ALPHA_EXT:null;if(n===Pe)return 36244;if(n===De)return 33319;if(n===$e)return 33320;if(n===Be)return 36249;if(n===Fe||n===Ue||n===ze||n===He)if(o===yt){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===Fe)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ue)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ze)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===He)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===Fe)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ue)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ze)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===He)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Ge||n===Ve||n===We||n===je){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===Ge)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Ve)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===We)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===je)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Xe)return i=t.get("WEBGL_compressed_texture_etc1"),null!==i?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===Ye||n===Ke){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Ye)return o===yt?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Ke)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===qe||n===Je||n===Ze||n===Qe||n===et||n===tt||n===nt||n===rt||n===it||n===ot||n===st||n===at||n===lt||n===ct){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===qe)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Je)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ze)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Qe)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===et)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===tt)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===nt)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===rt)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===it)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ot)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===st)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===at)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===lt)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ct)return o===yt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===ut){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===ut)return o===yt?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===Me?r?34042:(i=t.get("WEBGL_depth_texture"),null!==i?i.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}class la extends Ei{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}}class ca extends Er{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ua={type:"move"};class ha{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ca,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ca,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new yn,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new yn),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ca,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new yn,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new yn),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const s=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const o of e.hand.values()){const e=t.getJointPose(o,n);if(void 0===l.joints[o.jointName]){const e=new ca;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[o.jointName]=e,l.add(e)}const r=l.joints[o.jointName];null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&s>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(ua)))}return null!==s&&(s.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==o),this}}class da extends fn{constructor(e,t,n,r,i,o,s,a,l,c){if((c=void 0!==c?c:Le)!==Le&&c!==Oe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Le&&(n=Te),void 0===n&&c===Oe&&(n=Me),super(null,r,i,o,s,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:ue,this.minFilter=void 0!==a?a:ue,this.flipY=!1,this.generateMipmaps=!1}}class pa extends Lt{constructor(e,t){super();const n=this;let r=null,i=1,o=null,s="local-floor",a=null,l=null,c=null,u=null,h=null,d=null;const p=t.getContextAttributes();let f=null,m=null;const g=[],v=[],_=new Ei;_.layers.enable(1),_.viewport=new mn;const b=new Ei;b.layers.enable(2),b.viewport=new mn;const y=[_,b],T=new la;T.layers.enable(1),T.layers.enable(2);let E=null,S=null;function w(e){const t=v.indexOf(e.inputSource);if(-1===t)return;const n=g[t];void 0!==n&&n.dispatchEvent({type:e.type,data:e.inputSource})}function x(){r.removeEventListener("select",w),r.removeEventListener("selectstart",w),r.removeEventListener("selectend",w),r.removeEventListener("squeeze",w),r.removeEventListener("squeezestart",w),r.removeEventListener("squeezeend",w),r.removeEventListener("end",x),r.removeEventListener("inputsourceschange",M);for(let e=0;e<g.length;e++){const t=v[e];null!==t&&(v[e]=null,g[e].disconnect(t))}E=null,S=null,e.setRenderTarget(f),h=null,u=null,c=null,r=null,m=null,A.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function M(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=v.indexOf(n);r>=0&&(v[r]=null,g[r].dispatchEvent({type:"disconnected",data:n}))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=v.indexOf(n);if(-1===r){for(let e=0;e<g.length;e++){if(e>=v.length){v.push(n),r=e;break}if(null===v[e]){v[e]=n,r=e;break}}if(-1===r)break}const i=g[r];i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=g[e];return void 0===t&&(t=new ha,g[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=g[e];return void 0===t&&(t=new ha,g[e]=t),t.getGripSpace()},this.getHand=function(e){let t=g[e];return void 0===t&&(t=new ha,g[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a||o},this.setReferenceSpace=function(e){a=e},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(f=e.getRenderTarget(),r.addEventListener("select",w),r.addEventListener("selectstart",w),r.addEventListener("selectend",w),r.addEventListener("squeeze",w),r.addEventListener("squeezestart",w),r.addEventListener("squeezeend",w),r.addEventListener("end",x),r.addEventListener("inputsourceschange",M),!0!==p.xrCompatible&&await t.makeXRCompatible(),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),m=new gn(h.framebufferWidth,h.framebufferHeight,{format:ke,type:ge,encoding:e.outputEncoding})}else{let n=null,o=null,s=null;p.depth&&(s=p.stencil?35056:33190,n=p.stencil?Oe:Le,o=p.stencil?Me:Te);const a={colorFormat:32856,depthFormat:s,scaleFactor:i};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(a),r.updateRenderState({layers:[u]}),m=new gn(u.textureWidth,u.textureHeight,{format:ke,type:ge,depthTexture:new da(u.textureWidth,u.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});e.properties.get(m).__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),a=null,o=await r.requestReferenceSpace(s),A.setContext(r),A.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const C=new yn,I=new yn;function k(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;T.near=b.near=_.near=e.near,T.far=b.far=_.far=e.far,(E!==T.near||S!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),E=T.near,S=T.far);const t=e.parent,n=T.cameras;k(T,t);for(let r=0;r<n.length;r++)k(n[r],t);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),e.position.copy(T.position),e.quaternion.copy(T.quaternion),e.scale.copy(T.scale),e.matrix.copy(T.matrix),e.matrixWorld.copy(T.matrixWorld);const i=e.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(!0);2===n.length?function(e,t,n){C.setFromMatrixPosition(t.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const r=C.distanceTo(I),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,s=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=s*u,p=s*h,f=r/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=s+f,v=a+f,_=d-m,b=p+(r-m),y=l*a/v*g,T=c*a/v*g;e.projectionMatrix.makePerspective(_,b,y,T,g,v)}(T,_,b):T.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(e){null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let R=null;const A=new Ni;A.setAnimationLoop((function(t,n){if(l=n.getViewerPose(a||o),d=n,null!==l){const t=l.views;null!==h&&(e.setRenderTargetFramebuffer(m,h.framebuffer),e.setRenderTarget(m));let n=!1;t.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let o=null;if(null!==h)o=h.getViewport(i);else{const t=c.getViewSubImage(u,i);o=t.viewport,0===r&&(e.setRenderTargetTextures(m,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(m))}let s=y[r];void 0===s&&(s=new Ei,s.layers.enable(r),s.viewport=new mn,y[r]=s),s.matrix.fromArray(i.transform.matrix),s.projectionMatrix.fromArray(i.projectionMatrix),s.viewport.set(o.x,o.y,o.width,o.height),0===r&&T.matrix.copy(s.matrix),!0===n&&T.cameras.push(s)}}for(let e=0;e<g.length;e++){const t=v[e],r=g[e];null!==t&&void 0!==r&&r.update(t,n,a||o)}R&&R(t,n),d=null})),this.setAnimationLoop=function(e){R=e},this.dispose=function(){}}}function fa(e,t){function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===f&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===f&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const i=t.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*t}let o,s;r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?o=r.map:r.specularMap?o=r.specularMap:r.displacementMap?o=r.displacementMap:r.normalMap?o=r.normalMap:r.bumpMap?o=r.bumpMap:r.roughnessMap?o=r.roughnessMap:r.metalnessMap?o=r.metalnessMap:r.alphaMap?o=r.alphaMap:r.emissiveMap?o=r.emissiveMap:r.clearcoatMap?o=r.clearcoatMap:r.clearcoatNormalMap?o=r.clearcoatNormalMap:r.clearcoatRoughnessMap?o=r.clearcoatRoughnessMap:r.iridescenceMap?o=r.iridescenceMap:r.iridescenceThicknessMap?o=r.iridescenceThicknessMap:r.specularIntensityMap?o=r.specularIntensityMap:r.specularColorMap?o=r.specularColorMap:r.transmissionMap?o=r.transmissionMap:r.thicknessMap?o=r.thicknessMap:r.sheenColorMap?o=r.sheenColorMap:r.sheenRoughnessMap&&(o=r.sheenRoughnessMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uvTransform.value.copy(o.matrix)),r.aoMap?s=r.aoMap:r.lightMap&&(s=r.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,o,s){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(e,r):r.isMeshToonMaterial?(n(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(n(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(n(e,r),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===f&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,r,s)):r.isMeshMatcapMaterial?(n(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?n(e,r):r.isMeshDistanceMaterial?(n(e,r),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?n(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){let i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,o):r.isSpriteMaterial?function(e,t){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ma(e,t,n,r){let i={},o={},s=[];const a=n.isWebGL2?e.getParameter(35375):0;function l(e,t,n){const r=e.value;if(void 0===n[t])return n[t]="number"==typeof r?r:r.clone(),!0;if("number"==typeof r){if(n[t]!==r)return n[t]=r,!0}else{const e=n[t];if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t=e.value,n={boundary:0,storage:0};return"number"==typeof t?(n.boundary=4,n.storage=4):t.isVector2?(n.boundary=8,n.storage=8):t.isVector3||t.isColor?(n.boundary=16,n.storage=12):t.isVector4?(n.boundary=16,n.storage=16):t.isMatrix3?(n.boundary=48,n.storage=48):t.isMatrix4?(n.boundary=64,n.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),n}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete o[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(function(e){const t=e.uniforms;let n=0;const r=16;let i=0;for(let o=0,s=t.length;o<s;o++){const e=t[o],s=c(e);if(e.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,o>0){i=n%r;0!==i&&r-i-s.boundary<0&&(n+=r-i,e.__offset=n)}n+=s.storage}i=n%r,i>0&&(n+=r-i),e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,o=t.usage;return e.bindBuffer(35345,r),e.bufferData(35345,i,o),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const p=h.program;r.updateUBOMapping(n,p);const f=t.render.frame;o[n.id]!==f&&(function(t){const n=i[t.id],r=t.uniforms,o=t.__cache;e.bindBuffer(35345,n);for(let i=0,s=r.length;i<s;i++){const t=r[i];if(!0===l(t,i,o)){const n=t.value,r=t.__offset;"number"==typeof n?(t.__data[0]=n,e.bufferSubData(35345,r,t.__data)):(t.value.isMatrix3?(t.__data[0]=t.value.elements[0],t.__data[1]=t.value.elements[1],t.__data[2]=t.value.elements[2],t.__data[3]=t.value.elements[0],t.__data[4]=t.value.elements[3],t.__data[5]=t.value.elements[4],t.__data[6]=t.value.elements[5],t.__data[7]=t.value.elements[0],t.__data[8]=t.value.elements[6],t.__data[9]=t.value.elements[7],t.__data[10]=t.value.elements[8],t.__data[11]=t.value.elements[0]):n.toArray(t.__data),e.bufferSubData(35345,r,t.__data))}}e.bindBuffer(35345,null)}(n),o[n.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},o={}}}}function ga(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;const t=void 0!==e.canvas?e.canvas:function(){const e=qt("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h;h=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let d=null,g=null;const v=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=bt,this.physicallyCorrectLights=!1,this.toneMapping=K,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const b=this;let y=!1,T=0,E=0,S=null,w=-1,x=null;const M=new mn,C=new mn;let I=null,k=t.width,R=t.height,A=1,L=null,O=null;const N=new mn(0,0,k,R),P=new mn(0,0,k,R);let D=!1;const $=new Oi;let B=!1,F=!1,U=null;const z=new Jn,H=new Wt,G=new yn,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===S?A:1}let j,X,Y,q,J,Z,Q,ee,te,ne,re,ie,oe,se,ae,le,ce,ue,he,de,pe,fe,ve,_e,be=n;function ye(e,n){for(let r=0;r<e.length;r++){const i=e[r],o=t.getContext(i,n);if(null!==o)return o}return null}try{const e={alpha:!0,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(i)),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",Me,!1),t.addEventListener("webglcontextcreationerror",Ce,!1),null===be){const t=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&t.shift(),be=ye(t,e),null===be)throw ye(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===be.getShaderPrecisionFormat&&(be.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ue){throw console.error("THREE.WebGLRenderer: "+Ue.message),Ue}function Te(){j=new ao(be),X=new Gi(be,j,e),j.init(X),fe=new aa(be,j,X),Y=new oa(be,j,X),q=new uo,J=new Gs,Z=new sa(be,j,Y,J,X,fe,q),Q=new Wi(b),ee=new so(b),te=new Pi(be,X),ve=new zi(be,j,te,X),ne=new lo(be,te,q,ve),re=new go(be,ne,te,q),he=new mo(be,X,Z),le=new Vi(J),ie=new Hs(b,Q,ee,j,X,ve,le),oe=new fa(b,J),se=new Xs,ae=new Qs(j,X),ue=new Ui(b,Q,Y,re,h,a),ce=new ia(b,re,X),_e=new ma(be,q,X,Y),de=new Hi(be,j,q,X),pe=new co(be,j,q,X),q.programs=ie.programs,b.capabilities=X,b.extensions=j,b.properties=J,b.renderLists=se,b.shadowMap=ce,b.state=Y,b.info=q}Te();const we=new pa(b,be);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Me(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=q.autoReset,t=ce.enabled,n=ce.autoUpdate,r=ce.needsUpdate,i=ce.type;Te(),q.autoReset=e,ce.enabled=t,ce.autoUpdate=n,ce.needsUpdate=r,ce.type=i}function Ce(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ie(e){const t=e.target;t.removeEventListener("dispose",Ie),function(e){(function(e){const t=J.get(e).programs;void 0!==t&&(t.forEach((function(e){ie.releaseProgram(e)})),e.isShaderMaterial&&ie.releaseShaderCache(e))})(e),J.remove(e)}(t)}this.xr=we,this.getContext=function(){return be},this.getContextAttributes=function(){return be.getContextAttributes()},this.forceContextLoss=function(){const e=j.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=j.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(e){void 0!==e&&(A=e,this.setSize(k,R,!1))},this.getSize=function(e){return e.set(k,R)},this.setSize=function(e,n,r){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=e,R=n,t.width=Math.floor(e*A),t.height=Math.floor(n*A),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(k*A,R*A).floor()},this.setDrawingBufferSize=function(e,n,r){k=e,R=n,A=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(M)},this.getViewport=function(e){return e.copy(N)},this.setViewport=function(e,t,n,r){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,r),Y.viewport(M.copy(N).multiplyScalar(A).floor())},this.getScissor=function(e){return e.copy(P)},this.setScissor=function(e,t,n,r){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,r),Y.scissor(C.copy(P).multiplyScalar(A).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(e){Y.setScissorTest(D=e)},this.setOpaqueSort=function(e){L=e},this.setTransparentSort=function(e){O=e},this.getClearColor=function(e){return e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),be.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",Me,!1),t.removeEventListener("webglcontextcreationerror",Ce,!1),se.dispose(),ae.dispose(),J.dispose(),Q.dispose(),ee.dispose(),re.dispose(),ve.dispose(),_e.dispose(),ie.dispose(),we.dispose(),we.removeEventListener("sessionstart",Ae),we.removeEventListener("sessionend",Le),U&&(U.dispose(),U=null),Oe.stop()},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=V);const s=i.isMesh&&i.matrixWorld.determinant()<0,a=function(e,t,n,r,i){!0!==t.isScene&&(t=V),Z.resetTextureUnits();const o=t.fog,s=r.isMeshStandardMaterial?t.environment:null,a=null===S?b.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:bt,l=(r.isMeshStandardMaterial?ee:Q).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,f=r.toneMapped?b.toneMapping:K,m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,_=J.get(r),y=g.state.lights;if(!0===B&&(!0===F||e!==x)){const t=e===x&&r.id===w;le.setState(r,e,t)}let T=!1;r.version===_.__version?(_.needsLights&&_.lightsStateVersion!==y.state.version||_.outputEncoding!==a||i.isInstancedMesh&&!1===_.instancing||!i.isInstancedMesh&&!0===_.instancing||i.isSkinnedMesh&&!1===_.skinning||!i.isSkinnedMesh&&!0===_.skinning||_.envMap!==l||!0===r.fog&&_.fog!==o||void 0!==_.numClippingPlanes&&(_.numClippingPlanes!==le.numPlanes||_.numIntersection!==le.numIntersection)||_.vertexAlphas!==c||_.vertexTangents!==u||_.morphTargets!==h||_.morphNormals!==d||_.morphColors!==p||_.toneMapping!==f||!0===X.isWebGL2&&_.morphTargetsCount!==v)&&(T=!0):(T=!0,_.__version=r.version);let E=_.currentProgram;!0===T&&(E=Be(r,t,i));let M=!1,C=!1,I=!1;const k=E.getUniforms(),L=_.uniforms;if(Y.useProgram(E.program)&&(M=!0,C=!0,I=!0),r.id!==w&&(w=r.id,C=!0),M||x!==e){if(k.setValue(be,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&k.setValue(be,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,C=!0,I=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=k.map.cameraPosition;void 0!==t&&t.setValue(be,G.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&k.setValue(be,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&k.setValue(be,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){k.setOptional(be,i,"bindMatrix"),k.setOptional(be,i,"bindMatrixInverse");const e=i.skeleton;e&&(X.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),k.setValue(be,"boneTexture",e.boneTexture,Z),k.setValue(be,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const O=n.morphAttributes;if((void 0!==O.position||void 0!==O.normal||void 0!==O.color&&!0===X.isWebGL2)&&he.update(i,n,r,E),(C||_.receiveShadow!==i.receiveShadow)&&(_.receiveShadow=i.receiveShadow,k.setValue(be,"receiveShadow",i.receiveShadow)),C&&(k.setValue(be,"toneMappingExposure",b.toneMappingExposure),_.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(L,I),o&&!0===r.fog&&oe.refreshFogUniforms(L,o),oe.refreshMaterialUniforms(L,r,A,R,U),ys.upload(be,_.uniformsList,L,Z)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ys.upload(be,_.uniformsList,L,Z),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&k.setValue(be,"center",i.center),k.setValue(be,"modelViewMatrix",i.modelViewMatrix),k.setValue(be,"normalMatrix",i.normalMatrix),k.setValue(be,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(X.isWebGL2){const n=e[t];_e.update(n,E),_e.bind(n,E)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return E}(e,t,n,r,i);Y.setMaterial(r,s);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u=1;!0===r.wireframe&&(l=ne.getWireframeAttribute(n),u=2),ve.setup(i,r,a,n,l);let h,d=de;null!==l&&(h=te.get(l),d=pe,d.setIndex(h));const p=null!==l?l.count:c.count,f=n.drawRange.start*u,m=n.drawRange.count*u,v=null!==o?o.start*u:0,_=null!==o?o.count*u:1/0,y=Math.max(f,v),T=Math.min(p,f+m,v+_)-1,E=Math.max(0,T-y+1);if(0!==E){if(i.isMesh)!0===r.wireframe?(Y.setLineWidth(r.wireframeLinewidth*W()),d.setMode(1)):d.setMode(4);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),Y.setLineWidth(e*W()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(y,E,i.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,E,e)}else d.render(y,E)}},this.compile=function(e,t){g=ae.get(e),g.init(),_.push(g),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))})),g.setupLights(b.physicallyCorrectLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){Be(n[r],e,t)}else Be(n,e,t)})),_.pop(),g=null};let Re=null;function Ae(){Oe.stop()}function Le(){Oe.start()}const Oe=new Ni;function Ne(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)g.pushLight(e),e.castShadow&&g.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||$.intersectsSprite(e)){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;i.visible&&d.push(e,t,i,n,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==q.render.frame&&(e.skeleton.update(),e.skeleton.frame=q.render.frame),!e.frustumCulled||$.intersectsObject(e))){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=re.update(e),i=e.material;if(Array.isArray(i)){const r=t.groups;for(let o=0,s=r.length;o<s;o++){const s=r[o],a=i[s.materialIndex];a&&a.visible&&d.push(e,t,a,n,G.z,s)}}else i.visible&&d.push(e,t,i,n,G.z,null)}const i=e.children;for(let o=0,s=i.length;o<s;o++)Ne(i[o],t,n,r)}function Pe(e,t,n,r){const i=e.opaque,o=e.transmissive,a=e.transparent;g.setupLightsView(n),o.length>0&&function(e,t,n){const r=X.isWebGL2;null===U&&(U=new gn(1,1,{generateMipmaps:!0,type:j.has("EXT_color_buffer_half_float")?Se:ge,minFilter:me,samples:r&&!0===s?4:0})),b.getDrawingBufferSize(H),r?U.setSize(H.x,H.y):U.setSize(Gt(H.x),Gt(H.y));const i=b.getRenderTarget();b.setRenderTarget(U),b.clear();const o=b.toneMapping;b.toneMapping=K,De(e,t,n),b.toneMapping=o,Z.updateMultisampleRenderTarget(U),Z.updateRenderTargetMipmap(U),b.setRenderTarget(i)}(i,t,n),r&&Y.viewport(M.copy(r)),i.length>0&&De(i,t,n),o.length>0&&De(o,t,n),a.length>0&&De(a,t,n),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1)}function De(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=o.object,a=o.geometry,l=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&$e(s,t,n,a,l,c)}}function $e(e,t,n,r,i,o){e.onBeforeRender(b,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(b,t,n,r,e,o),!0===i.transparent&&i.side===m?(i.side=f,i.needsUpdate=!0,b.renderBufferDirect(n,t,r,i,e,o),i.side=p,i.needsUpdate=!0,b.renderBufferDirect(n,t,r,i,e,o),i.side=m):b.renderBufferDirect(n,t,r,i,e,o),e.onAfterRender(b,t,n,r,i,o)}function Be(e,t,n){!0!==t.isScene&&(t=V);const r=J.get(e),i=g.state.lights,o=g.state.shadowsArray,s=i.state.version,a=ie.getParameters(e,i.state,o,t,n),l=ie.getProgramCacheKey(a);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ee:Q).get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",Ie),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return Fe(e,a),u}else a.uniforms=ie.getUniforms(e),e.onBuild(n,a,b),e.onBeforeCompile(a,b),u=ie.acquireProgram(a,l),c.set(l,u),r.uniforms=a.uniforms;const h=r.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(h.clippingPlanes=le.uniform),Fe(e,a),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=u.getUniforms(),p=ys.seqWithValue(d.seq,h);return r.currentProgram=u,r.uniformsList=p,u}function Fe(e,t){const n=J.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Oe.setAnimationLoop((function(e){Re&&Re(e)})),typeof self<"u"&&Oe.setContext(self),this.setAnimationLoop=function(e){Re=e,we.setAnimationLoop(e),null===e?Oe.stop():Oe.start()},we.addEventListener("sessionstart",Ae),we.addEventListener("sessionend",Le),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(!0===we.cameraAutoUpdate&&we.updateCamera(t),t=we.getCamera()),!0===e.isScene&&e.onBeforeRender(b,e,t,S),g=ae.get(e,_.length),g.init(),_.push(g),z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromProjectionMatrix(z),F=this.localClippingEnabled,B=le.init(this.clippingPlanes,F,t),d=se.get(e,v.length),d.init(),v.push(d),Ne(e,t,0,b.sortObjects),d.finish(),!0===b.sortObjects&&d.sort(L,O),!0===B&&le.beginShadows();const n=g.state.shadowsArray;if(ce.render(n,e,t),!0===B&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),ue.render(d,e),g.setupLights(b.physicallyCorrectLights),t.isArrayCamera){const n=t.cameras;for(let t=0,r=n.length;t<r;t++){const r=n[t];Pe(d,e,r,r.viewport)}}else Pe(d,e,t);null!==S&&(Z.updateMultisampleRenderTarget(S),Z.updateRenderTargetMipmap(S)),!0===e.isScene&&e.onAfterRender(b,e,t),ve.resetDefaultState(),w=-1,x=null,_.pop(),g=_.length>0?_[_.length-1]:null,v.pop(),d=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(e,t,n){J.get(e.texture).__webglTexture=t,J.get(e.depthTexture).__webglTexture=n;const r=J.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===j.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=J.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;S=e,T=t,E=n;let r=!0;if(e){const t=J.get(e);void 0!==t.__useDefaultFramebuffer?(Y.bindFramebuffer(36160,null),r=!1):void 0===t.__webglFramebuffer?Z.setupRenderTarget(e):t.__hasExternalTextures&&Z.rebindTextures(e,J.get(e.texture).__webglTexture,J.get(e.depthTexture).__webglTexture)}let i=null,o=!1,s=!1;if(e){const n=e.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(s=!0);const r=J.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=r[t],o=!0):i=X.isWebGL2&&e.samples>0&&!1===Z.useMultisampledRTT(e)?J.get(e).__webglMultisampledFramebuffer:r,M.copy(e.viewport),C.copy(e.scissor),I=e.scissorTest}else M.copy(N).multiplyScalar(A).floor(),C.copy(P).multiplyScalar(A).floor(),I=D;if(Y.bindFramebuffer(36160,i)&&X.drawBuffers&&r&&Y.drawBuffers(e,i),Y.viewport(M),Y.scissor(C),Y.setScissorTest(I),o){const r=J.get(e.texture);be.framebufferTexture2D(36160,36064,34069+t,r.__webglTexture,n)}else if(s){const r=J.get(e.texture),i=t||0;be.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}w=-1},this.readRenderTargetPixels=function(e,t,n,r,i,o,s){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=J.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){Y.bindFramebuffer(36160,a);try{const s=e.texture,a=s.format,l=s.type;if(a!==ke&&fe.convert(a)!==be.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Se&&(j.has("EXT_color_buffer_half_float")||X.isWebGL2&&j.has("EXT_color_buffer_float"));if(l!==ge&&fe.convert(l)!==be.getParameter(35738)&&(l!==Ee||!(X.isWebGL2||j.has("OES_texture_float")||j.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&be.readPixels(t,n,r,i,fe.convert(a),fe.convert(l),o)}finally{const e=null!==S?J.get(S).__webglFramebuffer:null;Y.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r);Z.setTexture2D(t,0),be.copyTexSubImage2D(3553,n,0,0,e.x,e.y,i,o),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=t.image.width,o=t.image.height,s=fe.convert(n.format),a=fe.convert(n.type);Z.setTexture2D(n,0),be.pixelStorei(37440,n.flipY),be.pixelStorei(37441,n.premultiplyAlpha),be.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?be.texSubImage2D(3553,r,e.x,e.y,i,o,s,a,t.image.data):t.isCompressedTexture?be.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,s,t.mipmaps[0].data):be.texSubImage2D(3553,r,e.x,e.y,s,a,t.image),0===r&&n.generateMipmaps&&be.generateMipmap(3553),Y.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=fe.convert(r.format),c=fe.convert(r.type);let u;if(r.isData3DTexture)Z.setTexture3D(r,0),u=32879;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(r,0),u=35866}be.pixelStorei(37440,r.flipY),be.pixelStorei(37441,r.premultiplyAlpha),be.pixelStorei(3317,r.unpackAlignment);const h=be.getParameter(3314),d=be.getParameter(32878),p=be.getParameter(3316),f=be.getParameter(3315),m=be.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;be.pixelStorei(3314,g.width),be.pixelStorei(32878,g.height),be.pixelStorei(3316,e.min.x),be.pixelStorei(3315,e.min.y),be.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?be.texSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,c,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),be.compressedTexSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,g.data)):be.texSubImage3D(u,i,t.x,t.y,t.z,o,s,a,l,c,g),be.pixelStorei(3314,h),be.pixelStorei(32878,d),be.pixelStorei(3316,p),be.pixelStorei(3315,f),be.pixelStorei(32877,m),0===i&&r.generateMipmaps&&be.generateMipmap(u),Y.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?Z.setTextureCube(e,0):e.isData3DTexture?Z.setTexture3D(e,0):e.isDataArrayTexture?Z.setTexture2DArray(e,0):Z.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){T=0,E=0,S=null,Y.reset(),ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class va extends ga{}va.prototype.isWebGL1Renderer=!0;class _a{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new ln(e),this.density=t}clone(){return new _a(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ba{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new ln(e),this.near=t,this.far=n}clone(){return new ba(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ya extends Er{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class Ta{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=It,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=$t()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ea=new yn;class Sa{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyMatrix4(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyNormalMatrix(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.transformDirection(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Fr(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Sa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class wa extends Pr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ln(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let xa;const Ma=new yn,Ca=new yn,Ia=new yn,ka=new Wt,Ra=new Wt,Aa=new Jn,La=new yn,Oa=new yn,Na=new yn,Pa=new Wt,Da=new Wt,$a=new Wt;class Ba extends Er{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===xa){xa=new qr;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Ta(e,5);xa.setIndex([0,1,2,0,2,3]),xa.setAttribute("position",new Sa(t,3,0,!1)),xa.setAttribute("uv",new Sa(t,2,3,!1))}this.geometry=xa,this.material=void 0!==e?e:new wa,this.center=new Wt(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ca.setFromMatrixScale(this.matrixWorld),Aa.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ia.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ca.multiplyScalar(-Ia.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;Fa(La.set(-.5,-.5,0),Ia,o,Ca,r,i),Fa(Oa.set(.5,-.5,0),Ia,o,Ca,r,i),Fa(Na.set(.5,.5,0),Ia,o,Ca,r,i),Pa.set(0,0),Da.set(1,0),$a.set(1,1);let s=e.ray.intersectTriangle(La,Oa,Na,!1,Ma);if(null===s&&(Fa(Oa.set(-.5,.5,0),Ia,o,Ca,r,i),Da.set(0,1),s=e.ray.intersectTriangle(La,Na,Oa,!1,Ma),null===s))return;const a=e.ray.origin.distanceTo(Ma);a<e.near||a>e.far||t.push({distance:a,point:Ma.clone(),uv:Or.getUV(Ma,La,Oa,Na,Pa,Da,$a,new Wt),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Fa(e,t,n,r,i,o){ka.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Ra.x=o*ka.x-i*ka.y,Ra.y=i*ka.x+o*ka.y):Ra.copy(ka),e.copy(t),e.x+=Ra.x,e.y+=Ra.y,e.applyMatrix4(Aa)}const Ua=new yn,za=new yn;class Ha extends Er{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);const n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Ua.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Ua);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Ua.setFromMatrixPosition(e.matrixWorld),za.setFromMatrixPosition(this.matrixWorld);const n=Ua.distanceTo(za)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance})}return t}}const Ga=new yn,Va=new mn,Wa=new mn,ja=new yn,Xa=new Jn;class Ya extends fi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Jn,this.bindMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new mn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;Va.fromBufferAttribute(r.attributes.skinIndex,e),Wa.fromBufferAttribute(r.attributes.skinWeight,e),Ga.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=Wa.getComponent(i);if(0!==e){const r=Va.getComponent(i);Xa.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(ja.copy(Ga).applyMatrix4(Xa),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ka extends Er{constructor(){super(),this.isBone=!0,this.type="Bone"}}class qa extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:ue,arguments.length>9&&void 0!==arguments[9]?arguments[9]:ue,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Ja=new Jn,Za=new Jn;class Qa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=$t(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Jn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Jn;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,o=e.length;i<o;i++){const r=e[i]?e[i].matrixWorld:Za;Ja.multiplyMatrices(r,t[i]),Ja.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new Qa(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Ht(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new qa(t,e,e,ke,Ee);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new Ka),this.bones.push(i),this.boneInverses.push((new Jn).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const o=n[r];e.boneInverses.push(o.toArray())}return e}}class el extends Fr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const tl=new Jn,nl=new Jn,rl=[],il=new fi;class ol extends fi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new el(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(il.geometry=this.geometry,il.material=this.material,void 0!==il.material)for(let i=0;i<r;i++){this.getMatrixAt(i,tl),nl.multiplyMatrices(n,tl),il.matrixWorld=nl,il.raycast(e,rl);for(let e=0,n=rl.length;e<n;e++){const n=rl[e];n.instanceId=i,n.object=this,t.push(n)}rl.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new el(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class sl extends Pr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ln(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const al=new yn,ll=new yn,cl=new Jn,ul=new qn,hl=new Hn;class dl extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sl;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)al.fromBufferAttribute(t,e-1),ll.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=al.distanceTo(ll);e.setAttribute("lineDistance",new Hr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),hl.copy(n.boundingSphere),hl.applyMatrix4(r),hl.radius+=i,!1===e.ray.intersectsSphere(hl))return;cl.copy(r).invert(),ul.copy(e.ray).applyMatrix4(cl);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=new yn,c=new yn,u=new yn,h=new yn,d=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p){for(let n=Math.max(0,o.start),r=Math.min(p.count,o.start+o.count)-1;n<r;n+=d){const r=p.getX(n),i=p.getX(n+1);if(l.fromBufferAttribute(f,r),c.fromBufferAttribute(f,i),ul.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const o=e.ray.origin.distanceTo(h);o<e.near||o>e.far||t.push({distance:o,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,o.start),r=Math.min(f.count,o.start+o.count)-1;n<r;n+=d){if(l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,n+1),ul.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(h);r<e.near||r>e.far||t.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const pl=new yn,fl=new yn;class ml extends dl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)pl.fromBufferAttribute(t,e),fl.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+pl.distanceTo(fl);e.setAttribute("lineDistance",new Hr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gl extends dl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class vl extends Pr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ln(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const _l=new Jn,bl=new qn,yl=new Hn,Tl=new yn;class El extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new vl;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),yl.copy(n.boundingSphere),yl.applyMatrix4(r),yl.radius+=i,!1===e.ray.intersectsSphere(yl))return;_l.copy(r).invert(),bl.copy(e.ray).applyMatrix4(_l);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,o.start),i=Math.min(l.count,o.start+o.count);n<i;n++){const i=l.getX(n);Tl.fromBufferAttribute(c,i),Sl(Tl,i,a,r,e,t,this)}}else{for(let n=Math.max(0,o.start),i=Math.min(c.count,o.start+o.count);n<i;n++)Tl.fromBufferAttribute(c,n),Sl(Tl,n,a,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Sl(e,t,n,r,i,o,s){const a=bl.distanceSqToPoint(e);if(a<n){const n=new yn;bl.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:s})}}class wl extends fn{constructor(e,t,n,r,i,o,s,a,l,c,u,h){super(null,o,s,a,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class xl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let o;o=t||e*n[i-1];let s,a=0,l=i-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),s=n[r]-o,s<0)a=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){let n=e-1e-4,r=e+1e-4;n<0&&(n=0),r>1&&(r=1);const i=this.getPoint(n),o=this.getPoint(r),s=t||(i.isVector2?new Wt:new yn);return s.copy(o).sub(i).normalize(),s}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new yn,r=[],i=[],o=[],s=new yn,a=new Jn;for(let d=0;d<=e;d++){const t=d/e;r[d]=this.getTangentAt(t,new yn)}i[0]=new yn,o[0]=new yn;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),o[0].crossVectors(r[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),o[d]=o[d-1].clone(),s.crossVectors(r[d-1],r[d]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(Bt(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(a.makeRotationAxis(s,e))}o[d].crossVectors(r[d],i[d])}if(!0===t){let t=Math.acos(Bt(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],t*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ml extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a}getPoint(e,t){const n=t||new Wt,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0===this.aClockwise&&!o&&(i===r?i=-r:i-=r);const s=this.aStartAngle+e*i;let a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*e-r*t+this.aX,l=n*t+r*e+this.aY}return n.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Cl extends Ml{constructor(e,t,n,r,i,o){super(e,t,n,n,r,i,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Il(){let e=0,t=0,n=0,r=0;function i(i,o,s,a){e=i,t=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,s,a){let l=(t-e)/o-(n-e)/(o+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+a)+(r-n)/a;l*=s,c*=s,i(t,n,l,c)},calc:function(i){const o=i*i;return e+t*i+n*o+r*(o*i)}}}const kl=new yn,Rl=new Il,Al=new Il,Ll=new Il;class Ol extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.points,r=n.length,i=(r-(this.closed?0:1))*e;let o,s,a=Math.floor(i),l=i-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r)+1)*r:0===l&&a===r-1&&(a=r-2,l=1),this.closed||a>0?o=n[(a-1)%r]:(kl.subVectors(n[0],n[1]).add(n[0]),o=kl);const c=n[a%r],u=n[(a+1)%r];if(this.closed||a+2<r?s=n[(a+2)%r]:(kl.subVectors(n[r-1],n[r-2]).add(n[r-1]),s=kl),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(s),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),Rl.initNonuniformCatmullRom(o.x,c.x,u.x,s.x,t,n,r),Al.initNonuniformCatmullRom(o.y,c.y,u.y,s.y,t,n,r),Ll.initNonuniformCatmullRom(o.z,c.z,u.z,s.z,t,n,r)}else"catmullrom"===this.curveType&&(Rl.initCatmullRom(o.x,c.x,u.x,s.x,this.tension),Al.initCatmullRom(o.y,c.y,u.y,s.y,this.tension),Ll.initCatmullRom(o.z,c.z,u.z,s.z,this.tension));return t.set(Rl.calc(l),Al.calc(l),Ll.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new yn).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Nl(e,t,n,r,i){const o=.5*(r-t),s=.5*(i-n),a=e*e;return(2*n-2*r+o+s)*(e*a)+(-3*n+3*r-2*o-s)*a+o*e+n}function Pl(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Dl(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class $l extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wt,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Wt;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return t.set(Dl(e,n.x,r.x,i.x,o.x),Dl(e,n.y,r.y,i.y,o.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Bl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new yn;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return t.set(Dl(e,n.x,r.x,i.x,o.x),Dl(e,n.y,r.y,i.y,o.y),Dl(e,n.z,r.z,i.z,o.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Fl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Wt;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ul extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wt;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.v0,r=this.v1,i=this.v2;return t.set(Pl(e,n.x,r.x,i.x),Pl(e,n.y,r.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.v0,r=this.v1,i=this.v2;return t.set(Pl(e,n.x,r.x,i.x),Pl(e,n.y,r.y,i.y),Pl(e,n.z,r.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.points,r=(n.length-1)*e,i=Math.floor(r),o=r-i,s=n[0===i?i:i-1],a=n[i],l=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return t.set(Nl(o,s.x,a.x,l.x,c.x),Nl(o,s.y,a.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Wt).fromArray(n))}return this}}var Vl=Object.freeze({__proto__:null,ArcCurve:Cl,CatmullRomCurve3:Ol,CubicBezierCurve:$l,CubicBezierCurve3:Bl,EllipseCurve:Ml,LineCurve:Fl,LineCurve3:Ul,QuadraticBezierCurve:zl,QuadraticBezierCurve3:Hl,SplineCurve:Gl});class Wl extends xl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Fl(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,o=this.curves[i],s=o.getLength(),a=0===s?0:1-e/s;return o.getPointAt(a,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],s=o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,a=o.getPoints(s);for(let e=0;e<a.length;e++){const r=a[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new Vl[n.type]).fromJSON(n))}return this}}class jl extends Wl{constructor(e){super(),this.type="Path",this.currentPoint=new Wt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Fl(this.currentPoint.clone(),new Wt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new zl(this.currentPoint.clone(),new Wt(e,t),new Wt(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,o){const s=new $l(this.currentPoint.clone(),new Wt(e,t),new Wt(n,r),new Wt(i,o));return this.curves.push(s),this.currentPoint.set(i,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Gl(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,o){const s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+s,t+a,n,r,i,o),this}absarc(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this}ellipse(e,t,n,r,i,o,s,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,o,s,a),this}absellipse(e,t,n,r,i,o,s,a){const l=new Ml(e,t,n,r,i,o,s,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Xl extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new Wt(0,-.5),new Wt(.5,0),new Wt(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Bt(r,0,2*Math.PI);const i=[],o=[],s=[],a=[],l=[],c=1/t,u=new yn,h=new Wt,d=new yn,p=new yn,f=new yn;let m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){const i=n+v*c*r,d=Math.sin(i),p=Math.cos(i);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*p,o.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),s.push(h.x,h.y);const r=a[3*n+0]*d,i=a[3*n+1],c=a[3*n+0]*p;l.push(r,i,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,r=n,o=n+e.length,s=n+e.length+1,a=n+1;i.push(r,o,a),i.push(s,a,o)}this.setIndex(i),this.setAttribute("position",new Hr(o,3)),this.setAttribute("uv",new Hr(s,2)),this.setAttribute("normal",new Hr(l,3))}static fromJSON(e){return new Xl(e.points,e.segments,e.phiStart,e.phiLength)}}class Yl extends Xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;const i=new jl;i.absarc(0,-t/2,e,1.5*Math.PI,0),i.absarc(0,t/2,e,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Yl(e.radius,e.length,e.capSegments,e.radialSegments)}}class Kl extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],o=[],s=[],a=[],l=new yn,c=new Wt;o.push(0,0,0),s.push(0,0,1),a.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const i=n+u/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),o.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(o[h]/e+1)/2,c.y=(o[h+1]/e+1)/2,a.push(c.x,c.y)}for(let u=1;u<=t;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new Hr(o,3)),this.setAttribute("normal",new Hr(s,3)),this.setAttribute("uv",new Hr(a,2))}static fromJSON(e){return new Kl(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ql extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function v(n){const i=p,o=new Wt,f=new yn;let v=0;const _=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=r;e++)u.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),p++;const y=p;for(let e=0;e<=r;e++){const t=e/r*a+s,n=Math.cos(t),i=Math.sin(t);f.x=_*i,f.y=m*b,f.z=_*n,u.push(f.x,f.y,f.z),h.push(0,b,0),o.x=.5*n+.5,o.y=.5*i*b+.5,d.push(o.x,o.y),p++}for(let e=0;e<r;e++){const t=i+e,r=y+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}(function(){const o=new yn,v=new yn;let _=0;const b=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,_=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*a+s,l=Math.sin(i),f=Math.cos(i);v.x=_*l,v.y=-g*n+m,v.z=_*f,u.push(v.x,v.y,v.z),o.set(l,b,f).normalize(),h.push(o.x,o.y,o.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<r;e++)for(let t=0;t<i;t++){const n=f[t][e],r=f[t+1][e],i=f[t+1][e+1],o=f[t][e+1];c.push(n,r,o),c.push(r,i,o),_+=6}l.addGroup(g,_,0),g+=_})(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Hr(u,3)),this.setAttribute("normal",new Hr(h,3)),this.setAttribute("uv",new Hr(d,2))}static fromJSON(e){return new ql(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Jl extends ql{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,r,i,o,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}static fromJSON(e){return new Jl(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zl extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],o=[];function s(e,t,n,r){const i=r+1,o=[];for(let s=0;s<=i;s++){o[s]=[];const r=e.clone().lerp(n,s/i),a=t.clone().lerp(n,s/i),l=i-s;for(let e=0;e<=l;e++)o[s][e]=0===e&&s===i?r:r.clone().lerp(a,e/l)}for(let s=0;s<i;s++)for(let e=0;e<2*(i-s)-1;e++){const t=Math.floor(e/2);e%2===0?(a(o[s][t+1]),a(o[s+1][t]),a(o[s][t])):(a(o[s][t+1]),a(o[s+1][t+1]),a(o[s+1][t]))}}function a(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){const n=new yn,r=new yn,i=new yn;for(let o=0;o<t.length;o+=3)l(t[o+0],n),l(t[o+1],r),l(t[o+2],i),s(n,r,i,e)})(r),function(e){const t=new yn;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new yn;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];const n=u(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;o.push(n,1-r)}(function(){const e=new yn,t=new yn,n=new yn,r=new yn,s=new Wt,a=new Wt,l=new Wt;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(o[d+0],o[d+1]),a.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),r.copy(e).add(t).add(n).divideScalar(3);const p=u(r);c(s,d+0,e,p),c(a,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<o.length;e+=6){const t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),s=Math.min(t,n,r);i>.9&&s<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.setAttribute("position",new Hr(i,3)),this.setAttribute("normal",new Hr(i.slice(),3)),this.setAttribute("uv",new Hr(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Zl(e.vertices,e.indices,e.radius,e.details)}}class Ql extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ql(e.radius,e.detail)}}const ec=new yn,tc=new yn,nc=new yn,rc=new Or;class ic extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=Math.pow(10,4),r=Math.cos(Pt*t),i=e.getIndex(),o=e.getAttribute("position"),s=i?i.count:o.count,a=[0,0,0],l=["a","b","c"],c=new Array(3),u={},h=[];for(let e=0;e<s;e+=3){i?(a[0]=i.getX(e),a[1]=i.getX(e+1),a[2]=i.getX(e+2)):(a[0]=e,a[1]=e+1,a[2]=e+2);const{a:t,b:s,c:d}=rc;if(t.fromBufferAttribute(o,a[0]),s.fromBufferAttribute(o,a[1]),d.fromBufferAttribute(o,a[2]),rc.getNormal(nc),c[0]="".concat(Math.round(t.x*n),",").concat(Math.round(t.y*n),",").concat(Math.round(t.z*n)),c[1]="".concat(Math.round(s.x*n),",").concat(Math.round(s.y*n),",").concat(Math.round(s.z*n)),c[2]="".concat(Math.round(d.x*n),",").concat(Math.round(d.y*n),",").concat(Math.round(d.z*n)),c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=c[e],i=c[t],o=rc[l[e]],s=rc[l[t]],d="".concat(n,"_").concat(i),p="".concat(i,"_").concat(n);p in u&&u[p]?(nc.dot(u[p].normal)<=r&&(h.push(o.x,o.y,o.z),h.push(s.x,s.y,s.z)),u[p]=null):d in u||(u[d]={index0:a[e],index1:a[t],normal:nc.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];ec.fromBufferAttribute(o,t),tc.fromBufferAttribute(o,n),h.push(ec.x,ec.y,ec.z),h.push(tc.x,tc.y,tc.z)}this.setAttribute("position",new Hr(h,3))}}}class oc extends jl{constructor(e){super(e),this.uuid=$t(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new jl).fromJSON(n))}return this}}const sc=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let o=ac(e,0,i,n,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,h,d,p;if(r&&(o=function(e,t,n,r){const i=[];let o,s,a,l,c;for(o=0,s=t.length;o<s;o++)a=t[o]*r,l=o<s-1?t[o+1]*r:e.length,c=ac(e,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(_c(c));for(i.sort(fc),o=0;o<i.length;o++)mc(i[o],n),n=lc(n,n.next);return n}(e,t,o,n)),e.length>80*n){a=c=e[0],l=u=e[1];for(let t=n;t<i;t+=n)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return cc(o,s,n,a,l,p),s};function ac(e,t,n,r,i){let o,s;if(i===function(e,t,n,r){let i=0;for(let o=t,s=n-r;o<n;o+=r)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)s=Ic(o,e[o],e[o+1],s);else for(o=n-r;o>=t;o-=r)s=Ic(o,e[o],e[o+1],s);return s&&Ec(s,s.next)&&(kc(s),s=s.next),s}function lc(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Ec(r,r.next)&&0!==Tc(r.prev,r,r.next))r=r.next;else{if(kc(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function cc(e,t,n,r,i,o,s){if(!e)return;!s&&o&&function(e,t,n,r){let i=e;do{null===i.z&&(i.z=vc(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n,r,i,o,s,a,l,c=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ,r);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(e,r,i,o);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,o?hc(e,r,i,o):uc(e))t.push(a.i/n),t.push(e.i/n),t.push(l.i/n),kc(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?cc(e=dc(lc(e),t,n),t,n,r,i,o,2):2===s&&pc(e,t,n,r,i,o):cc(lc(e),t,n,r,i,o,1);break}}function uc(e){const t=e.prev,n=e,r=e.next;if(Tc(t,n,r)>=0)return!1;let i=e.next.next;for(;i!==e.prev;){if(bc(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Tc(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function hc(e,t,n,r){const i=e.prev,o=e,s=e.next;if(Tc(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,u=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=vc(a,l,t,n,r),d=vc(c,u,t,n,r);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&bc(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Tc(p.prev,p,p.next)>=0||(p=p.prevZ,f!==e.prev&&f!==e.next&&bc(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Tc(f.prev,f,f.next)>=0))return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&bc(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Tc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&bc(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Tc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function dc(e,t,n){let r=e;do{const i=r.prev,o=r.next.next;!Ec(i,o)&&Sc(i,r,r.next,o)&&Mc(i,o)&&Mc(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),kc(r),kc(r.next),r=e=o),r=r.next}while(r!==e);return lc(r)}function pc(e,t,n,r,i,o){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&yc(s,e)){let a=Cc(s,e);return s=lc(s,s.next),a=lc(a,a.next),cc(s,t,n,r,i,o),void cc(a,t,n,r,i,o)}e=e.next}s=s.next}while(s!==e)}function fc(e,t){return e.x-t.x}function mc(e,t){if(t=function(e,t){let n=t;const r=e.x,i=e.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s){if(s=e,e===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(r===s)return o;const a=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&bc(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Mc(n,e)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&gc(o,n)))&&(o=n,h=u)),n=n.next}while(n!==a);return o}(e,t),t){const n=Cc(t,e);lc(t,t.next),lc(n,n.next)}}function gc(e,t){return Tc(e.prev,e,t.prev)<0&&Tc(t.next,e,e.next)<0}function vc(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _c(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function bc(e,t,n,r,i,o,s,a){return(i-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(r-a)-(n-s)*(t-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function yc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Sc(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Mc(e,t)&&Mc(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Tc(e.prev,e,t.prev)||Tc(e,t.prev,t))||Ec(e,t)&&Tc(e.prev,e,e.next)>0&&Tc(t.prev,t,t.next)>0)}function Tc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Ec(e,t){return e.x===t.x&&e.y===t.y}function Sc(e,t,n,r){const i=xc(Tc(e,t,n)),o=xc(Tc(e,t,r)),s=xc(Tc(n,r,e)),a=xc(Tc(n,r,t));return!!(i!==o&&s!==a||0===i&&wc(e,n,t)||0===o&&wc(e,r,t)||0===s&&wc(n,e,r)||0===a&&wc(n,t,r))}function wc(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function xc(e){return e>0?1:e<0?-1:0}function Mc(e,t){return Tc(e.prev,e,e.next)<0?Tc(e,t,e.next)>=0&&Tc(e,e.prev,t)>=0:Tc(e,t,e.prev)<0||Tc(e,e.next,t)<0}function Cc(e,t){const n=new Rc(e.i,e.x,e.y),r=new Rc(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Ic(e,t,n,r){const i=new Rc(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function kc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Rc(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ac{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return Ac.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];Lc(e),Oc(n,e);let o=e.length;t.forEach(Lc);for(let a=0;a<t.length;a++)r.push(o),o+=t[a].length,Oc(n,t[a]);const s=sc(n,r);for(let a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}}function Lc(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Oc(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class Nc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new oc([new Wt(.5,.5),new Wt(-.5,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let s=0,a=e.length;s<a;s++){o(e[s])}function o(e){const o=[],s=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Pc;let g,v,_,b,y,T=!1;f&&(g=f.getSpacedPoints(a),T=!0,c=!1,v=f.computeFrenetFrames(a,!1),_=new yn,b=new yn,y=new yn),c||(p=0,u=0,h=0,d=0);const E=e.extractPoints(s);let S=E.shape;const w=E.holes;if(!Ac.isClockWise(S)){S=S.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];Ac.isClockWise(t)&&(w[e]=t.reverse())}}const x=Ac.triangulateShape(S,w),M=S;for(let t=0,n=w.length;t<n;t++){const e=w[t];S=S.concat(e)}function C(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const I=S.length,k=x.length;function R(e,t,n){let r,i,o;const s=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=s*s+a*a,h=s*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,f=t.y+s/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(s*c-a*l);r=p+s*m-e.x,i=f+a*m-e.y;const g=r*r+i*i;if(g<=2)return new Wt(r,i);o=Math.sqrt(g/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(r=-a,i=s,o=Math.sqrt(u)):(r=s,i=a,o=Math.sqrt(u/2))}return new Wt(r/o,i/o)}const A=[];for(let t=0,n=M.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),A[t]=R(M[t],M[r],M[i]);const L=[];let O,N=A.concat();for(let t=0,n=w.length;t<n;t++){const e=w[t];O=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),O[t]=R(e[t],e[r],e[i]);L.push(O),N=N.concat(O)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,i=M.length;t<i;t++){const e=C(M[t],A[t],r);$(e.x,e.y,-n)}for(let t=0,i=w.length;t<i;t++){const e=w[t];O=L[t];for(let t=0,i=e.length;t<i;t++){const i=C(e[t],O[t],r);$(i.x,i.y,-n)}}}const P=h+d;for(let t=0;t<I;t++){const e=c?C(S[t],N[t],P):S[t];T?(b.copy(v.normals[0]).multiplyScalar(e.x),_.copy(v.binormals[0]).multiplyScalar(e.y),y.copy(g[0]).add(b).add(_),$(y.x,y.y,y.z)):$(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<I;e++){const n=c?C(S[e],N[e],P):S[e];T?(b.copy(v.normals[t]).multiplyScalar(n.x),_.copy(v.binormals[t]).multiplyScalar(n.y),y.copy(g[t]).add(b).add(_),$(y.x,y.y,y.z)):$(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,i=M.length;t<i;t++){const e=C(M[t],A[t],r);$(e.x,e.y,l+n)}for(let t=0,i=w.length;t<i;t++){const e=w[t];O=L[t];for(let t=0,i=e.length;t<i;t++){const i=C(e[t],O[t],r);T?$(i.x,i.y+g[a-1].y,g[a-1].x+n):$(i.x,i.y,l+n)}}}function D(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=I*e,o=I*(e+1);F(t+r+n,t+i+n,t+i+o,t+r+o)}}}function $(e,t,n){o.push(e),o.push(t),o.push(n)}function B(e,t,i){U(e),U(t),U(i);const o=r.length/3,s=m.generateTopUV(n,r,o-3,o-2,o-1);z(s[0]),z(s[1]),z(s[2])}function F(e,t,i,o){U(e),U(t),U(o),U(t),U(i),U(o);const s=r.length/3,a=m.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);z(a[0]),z(a[1]),z(a[3]),z(a[1]),z(a[2]),z(a[3])}function U(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function z(e){i.push(e.x),i.push(e.y)}(function(){const e=r.length/3;if(c){let e=0,t=I*e;for(let n=0;n<k;n++){const e=x[n];B(e[2]+t,e[1]+t,e[0]+t)}e=a+2*p,t=I*e;for(let n=0;n<k;n++){const e=x[n];B(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<k;e++){const t=x[e];B(t[2],t[1],t[0])}for(let e=0;e<k;e++){const t=x[e];B(t[0]+I*a,t[1]+I*a,t[2]+I*a)}}n.addGroup(e,r.length/3-e,0)})(),function(){const e=r.length/3;let t=0;D(M,t),t+=M.length;for(let n=0,r=w.length;n<r;n++){const e=w[n];D(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new Hr(r,3)),this.setAttribute("uv",new Hr(i,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);return n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,o=e.shapes.length;i<o;i++){const r=t[e.shapes[i]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Vl[r.type]).fromJSON(r)),new Nc(n,e.options)}}const Pc={generateTopUV:function(e,t,n,r,i){const o=t[3*n],s=t[3*n+1],a=t[3*r],l=t[3*r+1],c=t[3*i],u=t[3*i+1];return[new Wt(o,s),new Wt(a,l),new Wt(c,u)]},generateSideWallUV:function(e,t,n,r,i,o){const s=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(a-u)<Math.abs(s-c)?[new Wt(s,1-l),new Wt(c,1-h),new Wt(d,1-f),new Wt(m,1-v)]:[new Wt(a,1-l),new Wt(u,1-h),new Wt(p,1-f),new Wt(g,1-v)]}};class Dc extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Dc(e.radius,e.detail)}}class $c extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $c(e.radius,e.detail)}}class Bc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const s=[],a=[],l=[],c=[];let u=e;const h=(t-e)/r,d=new yn,p=new Wt;for(let f=0;f<=r;f++){for(let e=0;e<=n;e++){const r=i+e/n*o;d.x=u*Math.cos(r),d.y=u*Math.sin(r),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let f=0;f<r;f++){const e=f*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,o=r+n+1,a=r+n+2,l=r+1;s.push(i,o,l),s.push(o,a,l)}}this.setIndex(s),this.setAttribute("position",new Hr(a,3)),this.setAttribute("normal",new Hr(l,3)),this.setAttribute("uv",new Hr(c,2))}static fromJSON(e){return new Bc(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Fc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new oc([new Wt(0,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],o=[];let s=0,a=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(s,a,c),s+=a,a=0;function l(e){const s=r.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===Ac.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===Ac.isClockWise(e)&&(u[t]=e.reverse())}const h=Ac.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),o.push(e.x,e.y)}for(let t=0,r=h.length;t<r;t++){const e=h[t],r=e[0]+s,i=e[1]+s,o=e[2]+s;n.push(r,i,o),a+=3}}this.setIndex(n),this.setAttribute("position",new Hr(r,3)),this.setAttribute("normal",new Hr(i,3)),this.setAttribute("uv",new Hr(o,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new Fc(n,e.curveSegments)}}class Uc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let l=0;const c=[],u=new yn,h=new yn,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let _=0;0==g&&0==o?_=.5/t:g==n&&a==Math.PI&&(_=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(r+a*i)*Math.sin(o+v*s),u.y=e*Math.cos(o+v*s),u.z=e*Math.sin(r+a*i)*Math.sin(o+v*s),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+_,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],s=c[g+1][e+1];(0!==g||o>0)&&d.push(t,r,s),(g!==n-1||a<Math.PI)&&d.push(r,i,s)}this.setIndex(d),this.setAttribute("position",new Hr(p,3)),this.setAttribute("normal",new Hr(f,3)),this.setAttribute("uv",new Hr(m,2))}static fromJSON(e){return new Uc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zc extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zc(e.radius,e.detail)}}class Hc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],s=[],a=[],l=[],c=new yn,u=new yn,h=new yn;for(let d=0;d<=n;d++)for(let o=0;o<=r;o++){const p=o/r*i,f=d/n*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),s.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(o/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=r;e++){const t=(r+1)*d+e-1,n=(r+1)*(d-1)+e-1,i=(r+1)*(d-1)+e,s=(r+1)*d+e;o.push(t,n,s),o.push(n,i,s)}this.setIndex(o),this.setAttribute("position",new Hr(s,3)),this.setAttribute("normal",new Hr(a,3)),this.setAttribute("uv",new Hr(l,2))}static fromJSON(e){return new Hc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Gc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const s=[],a=[],l=[],c=[],u=new yn,h=new yn,d=new yn,p=new yn,f=new yn,m=new yn,g=new yn;for(let _=0;_<=n;++_){const s=_/n*i*Math.PI*2;v(s,i,o,e,d),v(s+.01,i,o,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,o=-t*Math.cos(i),s=t*Math.sin(i);u.x=d.x+(o*g.x+s*f.x),u.y=d.y+(o*g.y+s*f.y),u.z=d.z+(o*g.z+s*f.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(_/n),c.push(e/r)}}for(let _=1;_<=n;_++)for(let e=1;e<=r;e++){const t=(r+1)*(_-1)+(e-1),n=(r+1)*_+(e-1),i=(r+1)*_+e,o=(r+1)*(_-1)+e;s.push(t,n,o),s.push(n,i,o)}function v(e,t,n,r,i){const o=Math.cos(e),s=Math.sin(e),a=n/t*e,l=Math.cos(a);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(a)*.5}this.setIndex(s),this.setAttribute("position",new Hr(a,3)),this.setAttribute("normal",new Hr(l,3)),this.setAttribute("uv",new Hr(c,2))}static fromJSON(e){return new Gc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Vc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hl(new yn(-1,-1,0),new yn(-1,1,0),new yn(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const s=new yn,a=new yn,l=new Wt;let c=new yn;const u=[],h=[],d=[],p=[];function f(i){c=e.getPointAt(i/t,c);const l=o.normals[i],d=o.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),o=-Math.cos(t);a.x=o*l.x+i*d.x,a.y=o*l.y+i*d.y,a.z=o*l.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),s.x=c.x+n*a.x,s.y=c.y+n*a.y,s.z=c.z+n*a.z,u.push(s.x,s.y,s.z)}}(function(){for(let e=0;e<t;e++)f(e);f(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),o=(r+1)*e+t,s=(r+1)*(e-1)+t;p.push(n,i,s),p.push(i,o,s)}}()})(),this.setIndex(p),this.setAttribute("position",new Hr(u,3)),this.setAttribute("normal",new Hr(h,3)),this.setAttribute("uv",new Hr(d,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Vc((new Vl[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Wc extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new yn,i=new yn;if(null!==e.index){const o=e.attributes.position,s=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let l=0;l<3;l++){const a=s.getX(e+l),c=s.getX(e+(l+1)%3);r.fromBufferAttribute(o,a),i.fromBufferAttribute(o,c),!0===jc(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const o=e.attributes.position;for(let e=0,s=o.count/3;e<s;e++)for(let a=0;a<3;a++){const s=3*e+a,l=3*e+(a+1)%3;r.fromBufferAttribute(o,s),i.fromBufferAttribute(o,l),!0===jc(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new Hr(t,3))}}}function jc(e,t,n){const r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var Xc=Object.freeze({__proto__:null,BoxGeometry:gi,BoxBufferGeometry:gi,CapsuleGeometry:Yl,CapsuleBufferGeometry:Yl,CircleGeometry:Kl,CircleBufferGeometry:Kl,ConeGeometry:Jl,ConeBufferGeometry:Jl,CylinderGeometry:ql,CylinderBufferGeometry:ql,DodecahedronGeometry:Ql,DodecahedronBufferGeometry:Ql,EdgesGeometry:ic,ExtrudeGeometry:Nc,ExtrudeBufferGeometry:Nc,IcosahedronGeometry:Dc,IcosahedronBufferGeometry:Dc,LatheGeometry:Xl,LatheBufferGeometry:Xl,OctahedronGeometry:$c,OctahedronBufferGeometry:$c,PlaneGeometry:Di,PlaneBufferGeometry:Di,PolyhedronGeometry:Zl,PolyhedronBufferGeometry:Zl,RingGeometry:Bc,RingBufferGeometry:Bc,ShapeGeometry:Fc,ShapeBufferGeometry:Fc,SphereGeometry:Uc,SphereBufferGeometry:Uc,TetrahedronGeometry:zc,TetrahedronBufferGeometry:zc,TorusGeometry:Hc,TorusBufferGeometry:Hc,TorusKnotGeometry:Gc,TorusKnotBufferGeometry:Gc,TubeGeometry:Vc,TubeBufferGeometry:Vc,WireframeGeometry:Wc});class Yc extends Pr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ln(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Kc extends yi{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qc extends Pr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ln(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jc extends qc{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Wt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Bt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ln(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new ln(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ln(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Zc extends Pr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ln(16777215),this.specular=new ln(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Qc extends Pr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ln(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class eu extends Pr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class tu extends Pr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ln(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class nu extends Pr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ln(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ru extends sl{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function iu(e,t,n){return su(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function ou(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function su(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function au(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n}function lu(e,t,n){const r=e.length,i=new e.constructor(r);for(let o=0,s=0;s!==r;++o){const r=n[o]*t;for(let n=0;n!==t;++n)i[s++]=e[r+n]}return i}function cu(e,t,n,r){let i=1,o=e[0];for(;void 0!==o&&void 0===o[r];)o=e[i++];if(void 0===o)return;let s=o[r];if(void 0!==s)if(Array.isArray(s))do{s=o[r],void 0!==s&&(t.push(o.time),n.push.apply(n,s)),o=e[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[r],void 0!==s&&(t.push(o.time),s.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{s=o[r],void 0!==s&&(t.push(o.time),n.push(s)),o=e[i++]}while(void 0!==o)}var uu=Object.freeze({__proto__:null,arraySlice:iu,convertArray:ou,isTypedArray:su,getKeyframeOrder:au,sortedArray:lu,flattenJSON:cu,subclip:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const o=e.clone();o.name=t;const s=[];for(let l=0;l<o.tracks.length;++l){const e=o.tracks[l],t=e.getValueSize(),a=[],c=[];for(let o=0;o<e.times.length;++o){const s=e.times[o]*i;if(!(s<n||s>=r)){a.push(e.times[o]);for(let n=0;n<t;++n)c.push(e.values[o*t+n])}}0!==a.length&&(e.times=ou(a,e.times.constructor),e.values=ou(c,e.values.constructor),s.push(e))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);const i=n.tracks.length,o=t/r;for(let s=0;s<i;++s){const t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===r}));if(void 0===i)continue;let a=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(o<=t.times[0]){const e=a,n=l-a;d=iu(t.values,e,n)}else if(o>=t.times[h]){const e=h*l+a,n=e+l-a;d=iu(t.values,e,n)}else{const e=t.createInterpolant(),n=a,r=l-a;e.evaluate(o),d=iu(e.resultBuffer,n,r)}"quaternion"===r&&(new bn).fromArray(d).normalize().conjugate().toArray(d);const p=i.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===r)bn.multiplyQuaternionsFlat(i.values,t,d,0,i.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)i.values[t+n]-=d[n]}}}return e.blendMode=_t,e}});class hu{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0}}for(;n<o;){const r=n+o>>>1;e<t[r]?o=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let o=0;o!==r;++o)t[o]=n[i+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class du extends hu{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ft,endingEnd:ft}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case mt:i=e,s=2*t-n;break;case gt:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case mt:o=e,a=2*n-t;break;case gt:o=1,a=n+r[1]-r[0];break;default:o=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,_=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f;for(let y=0;y!==s;++y)i[y]=g*o[c+y]+v*o[l+y]+_*o[a+y]+b*o[u+y];return i}}class pu extends hu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==s;++h)i[h]=o[l+h]*u+o[a+h]*c;return i}}class fu extends hu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class mu{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ou(t,this.TimeBufferType),this.values=ou(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ou(e.times,Array),values:ou(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new fu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new du(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ht:t=this.InterpolantFactoryMethodDiscrete;break;case dt:t=this.InterpolantFactoryMethodLinear;break;case pt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ht;case this.InterpolantFactoryMethodLinear:return dt;case this.InterpolantFactoryMethodSmooth:return pt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const e=this.getValueSize();this.times=iu(n,i,o),this.values=iu(this.values,i*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let s=0;s!==i;s++){const t=n[s];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,t),e=!1;break}if(null!==o&&o>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,t,o),e=!1;break}o=t}if(void 0!==r&&su(r))for(let s=0,a=r.length;s!==a;++s){const t=r[s];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,t),e=!1;break}}return e}optimize(){const e=iu(this.times),t=iu(this.values),n=this.getValueSize(),r=this.getInterpolation()===pt,i=e.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=e[s];if(a!==e[s+1]&&(1!==s||a!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,o=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[o+s]){i=!0;break}}}if(i){if(s!==o){e[o]=e[s];const r=s*n,i=o*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++o}}if(i>0){e[o]=e[i];for(let e=i*n,r=o*n,s=0;s!==n;++s)t[r+s]=t[e+s];++o}return o!==e.length?(this.times=iu(e,0,o),this.values=iu(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=iu(this.times,0),t=iu(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}mu.prototype.TimeBufferType=Float32Array,mu.prototype.ValueBufferType=Float32Array,mu.prototype.DefaultInterpolation=dt;class gu extends mu{}gu.prototype.ValueTypeName="bool",gu.prototype.ValueBufferType=Array,gu.prototype.DefaultInterpolation=ht,gu.prototype.InterpolantFactoryMethodLinear=void 0,gu.prototype.InterpolantFactoryMethodSmooth=void 0;class vu extends mu{}vu.prototype.ValueTypeName="color";class _u extends mu{}_u.prototype.ValueTypeName="number";class bu extends hu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-t)/(r-t);let l=e*s;for(let c=l+s;l!==c;l+=4)bn.slerpFlat(i,0,o,l-s,o,l,a);return i}}class yu extends mu{InterpolantFactoryMethodLinear(e){return new bu(this.times,this.values,this.getValueSize(),e)}}yu.prototype.ValueTypeName="quaternion",yu.prototype.DefaultInterpolation=dt,yu.prototype.InterpolantFactoryMethodSmooth=void 0;class Tu extends mu{}Tu.prototype.ValueTypeName="string",Tu.prototype.ValueBufferType=Array,Tu.prototype.DefaultInterpolation=ht,Tu.prototype.InterpolantFactoryMethodLinear=void 0,Tu.prototype.InterpolantFactoryMethodSmooth=void 0;class Eu extends mu{}Eu.prototype.ValueTypeName="vector";class Su{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vt;this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=$t(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,s=n.length;o!==s;++o)t.push(wu(n[o]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,o=n.length;i!==o;++i)t.push(mu.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,o=[];for(let s=0;s<i;s++){let e=[],a=[];e.push((s+i-1)%i,s,(s+1)%i),a.push(0,1,0);const l=au(e);e=lu(e,1,l),a=lu(a,1,l),!r&&0===e[0]&&(e.push(i),a.push(a[0])),o.push(new _u(".morphTargetInfluences["+t[s].name+"]",e,a).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let s=0,a=e.length;s<a;s++){const t=e[s],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const o=[];for(const s in r)o.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const o=[],s=[];cu(n,o,s,r),0!==o.length&&i.push(new e(t,o,s))}},r=[],i=e.name||"default",o=e.fps||30,s=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],o=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),o.push(r.morphTarget===i?1:0)}r.push(new _u(".morphTargetInfluence["+i+"]",t,o))}a=t.length*o}else{const i=".bones["+t[c].name+"]";n(Eu,i+".position",e,"pos",r),n(yu,i+".quaternion",e,"rot",r),n(Eu,i+".scale",e,"scl",r)}}return 0===r.length?null:new this(i,a,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function wu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _u;case"vector":case"vector2":case"vector3":case"vector4":return Eu;case"color":return vu;case"quaternion":return yu;case"bool":case"boolean":return gu;case"string":return Tu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];cu(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const xu={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Mu{constructor(e,t,n){const r=this;let i,o=!1,s=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===o&&void 0!==r.onStart&&r.onStart(e,s,a),o=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const Cu=new Mu;class Iu{constructor(e){this.manager=void 0!==e?e:Cu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const ku={};class Ru extends Error{constructor(e,t){super(e),this.response=t}}class Au extends Iu{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=xu.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==ku[e])return void ku[e].push({onLoad:t,onProgress:n,onError:r});ku[e]=[],ku[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,a=this.responseType;fetch(o).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;const n=ku[e],r=t.body.getReader(),i=t.headers.get("Content-Length"),o=i?parseInt(i):0,s=0!==o;let a=0;const l=new ReadableStream({start(e){!function t(){r.read().then((r=>{let{done:i,value:l}=r;if(i)e.close();else{a+=l.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:a,total:o});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new Ru('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,s)));case"json":return e.json();default:if(void 0===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{xu.add(e,t);const n=ku[e];delete ku[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=ku[e];if(void 0===n)throw this.manager.itemError(e),t;delete ku[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Lu extends Iu{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=xu.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;const s=qt("img");function a(){c(),xu.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",a,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",a,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class Ou extends Er{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new ln(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Nu extends Ou{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Er.DefaultUp),this.updateMatrix(),this.groundColor=new ln(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Pu=new Jn,Du=new yn,$u=new yn;class Bu{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Wt(512,512),this.map=null,this.mapPass=null,this.matrix=new Jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Oi,this._frameExtents=new Wt(1,1),this._viewportCount=1,this._viewports=[new mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Du.setFromMatrixPosition(e.matrixWorld),t.position.copy(Du),$u.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($u),t.updateMatrixWorld(),Pu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Pu),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fu extends Bu{constructor(){super(new Ei(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Dt*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Uu extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Er.DefaultUp),this.updateMatrix(),this.target=new Er,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.shadow=new Fu}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const zu=new Jn,Hu=new yn,Gu=new yn;class Vu extends Bu{constructor(){super(new Ei(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Wt(4,2),this._viewportCount=6,this._viewports=[new mn(2,1,1,1),new mn(0,1,1,1),new mn(3,1,1,1),new mn(1,1,1,1),new mn(3,0,1,1),new mn(1,0,1,1)],this._cubeDirections=[new yn(1,0,0),new yn(-1,0,0),new yn(0,0,1),new yn(0,0,-1),new yn(0,1,0),new yn(0,-1,0)],this._cubeUps=[new yn(0,1,0),new yn(0,1,0),new yn(0,1,0),new yn(0,1,0),new yn(0,0,1),new yn(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Hu.setFromMatrixPosition(e.matrixWorld),n.position.copy(Hu),Gu.copy(n.position),Gu.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Gu),n.updateMatrixWorld(),r.makeTranslation(-Hu.x,-Hu.y,-Hu.z),zu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zu)}}class Wu extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Vu}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ju extends Bu{constructor(){super(new ji(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Xu extends Ou{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Er.DefaultUp),this.updateMatrix(),this.target=new Er,this.shadow=new ju}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Yu extends Ou{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ku extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class qu{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new yn)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class Ju extends Ou{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Zu extends Iu{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,o=new Au(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(e)}}),n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const r=Zu.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new ln).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const i in e.uniforms){const t=e.uniforms[i];switch(r.uniforms[i]={},t.type){case"t":r.uniforms[i].value=n(t.value);break;case"c":r.uniforms[i].value=(new ln).setHex(t.value);break;case"v2":r.uniforms[i].value=(new Wt).fromArray(t.value);break;case"v3":r.uniforms[i].value=(new yn).fromArray(t.value);break;case"v4":r.uniforms[i].value=(new mn).fromArray(t.value);break;case"m3":r.uniforms[i].value=(new jt).fromArray(t.value);break;case"m4":r.uniforms[i].value=(new Jn).fromArray(t.value);break;default:r.uniforms[i].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new Wt).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Wt).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:Yc,SpriteMaterial:wa,RawShaderMaterial:Kc,ShaderMaterial:yi,PointsMaterial:vl,MeshPhysicalMaterial:Jc,MeshStandardMaterial:qc,MeshPhongMaterial:Zc,MeshToonMaterial:Qc,MeshNormalMaterial:eu,MeshLambertMaterial:tu,MeshDepthMaterial:ea,MeshDistanceMaterial:ta,MeshBasicMaterial:Dr,MeshMatcapMaterial:nu,LineDashedMaterial:ru,LineBasicMaterial:sl,Material:Pr}[e]}}class Qu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class eh extends qr{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class th extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Au(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(e)}}),n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],o=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),s=Kt(i.type,o),a=new Ta(s,i.stride);return a.uuid=i.uuid,t[r]=a,a}const i=e.isInstancedBufferGeometry?new eh:new qr,o=e.data.index;if(void 0!==o){const e=Kt(o.type,o.array);i.setIndex(new Fr(e,1))}const s=e.data.attributes;for(const u in s){const t=s[u];let n;if(t.isInterleavedBufferAttribute){const i=r(e.data,t.data);n=new Sa(i,t.itemSize,t.offset,t.normalized)}else{const e=Kt(t.type,t.array);n=new(t.isInstancedBufferAttribute?el:Fr)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),void 0!==t.updateRange&&(n.updateRange.offset=t.updateRange.offset,n.updateRange.count=t.updateRange.count),i.setAttribute(u,n)}const a=e.data.morphAttributes;if(a)for(const u in a){const t=a[u],n=[];for(let i=0,o=t.length;i<o;i++){const o=t[i];let s;if(o.isInterleavedBufferAttribute){const t=r(e.data,o.data);s=new Sa(t,o.itemSize,o.offset,o.normalized)}else{const e=Kt(o.type,o.array);s=new Fr(e,o.itemSize,o.normalized)}void 0!==o.name&&(s.name=o.name),n.push(s)}i.morphAttributes[u]=n}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];i.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new yn;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new Hn(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}const nh={UVMapping:te,CubeReflectionMapping:ne,CubeRefractionMapping:re,EquirectangularReflectionMapping:ie,EquirectangularRefractionMapping:oe,CubeUVReflectionMapping:se},rh={RepeatWrapping:ae,ClampToEdgeWrapping:le,MirroredRepeatWrapping:ce},ih={NearestFilter:ue,NearestMipmapNearestFilter:he,NearestMipmapLinearFilter:de,LinearFilter:pe,LinearMipmapNearestFilter:fe,LinearMipmapLinearFilter:me};let oh;const sh={getContext:function(){return void 0===oh&&(oh=new(window.AudioContext||window.webkitAudioContext)),oh},setContext:function(e){oh=e}};const ah=new Jn,lh=new Jn,ch=new Jn;class uh{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=hh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=hh();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function hh(){return(typeof performance>"u"?Date:performance).now()}const dh=new yn,ph=new bn,fh=new yn,mh=new yn;class gh extends Er{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const vh=new yn,_h=new bn,bh=new yn,yh=new yn;class Th{constructor(e,t,n){let r,i,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let e=0;e!==r;++e)n[i+e]=n[e];o=t}else{o+=t;const e=t/o;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let a=t,l=t+t;a!==l;++a)if(n[a]!==n[a+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let o=0;o!==i;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){bn.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const o=this._workIndex*i;bn.multiplyQuaternionsFlat(e,o,e,t,e,n),bn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,i){const o=1-r;for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]*o+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]+e[n+o]*r}}}const Eh="\\[\\]\\.:\\/",Sh=new RegExp("["+Eh+"]","g"),wh="[^"+Eh+"]",xh="[^"+Eh.replace("\\.","")+"]",Mh=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wh)+/(WCOD+)?/.source.replace("WCOD",xh)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wh)+"$"),Ch=["material","materials","bones"];class Ih{constructor(e,t,n){this.path=t,this.parsedPath=n||Ih.parseTrackName(t),this.node=Ih.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ih.Composite(e,t,n):new Ih(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Sh,"")}static parseTrackName(e){const t=Mh.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==Ch.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const o=n(i.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Ih.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const o=e[r];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ih.Composite=class{constructor(e,t,n){const r=n||Ih.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Ih.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ih.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ih.prototype.GetterByBindingType=[Ih.prototype._getValue_direct,Ih.prototype._getValue_array,Ih.prototype._getValue_arrayElement,Ih.prototype._getValue_toArray],Ih.prototype.SetterByBindingTypeAndVersioning=[[Ih.prototype._setValue_direct,Ih.prototype._setValue_direct_setNeedsUpdate,Ih.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ih.prototype._setValue_array,Ih.prototype._setValue_array_setNeedsUpdate,Ih.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ih.prototype._setValue_arrayElement,Ih.prototype._setValue_arrayElement_setNeedsUpdate,Ih.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ih.prototype._setValue_fromArray,Ih.prototype._setValue_fromArray_setNeedsUpdate,Ih.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class kh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,o=i.length,s=new Array(o),a={endingStart:ft,endingEnd:ft};for(let l=0;l!==o;++l){const e=i[l].createInterpolant(null);s[l]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,r=e._clip.duration,i=r/n,o=n/r;e.warp(1,i,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,o=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=i,a[1]=i+n,l[0]=e/o,l[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;if(r<0||0===n)return;this._startTime=null,t=n*r}t*=this._updateTimeScale(e);const o=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===_t)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(o),t[n].accumulateAdditive(s);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(o),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const o=2202===n;if(0===e)return-1===i?r:o&&1===(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1===(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=mt,r.endingEnd=mt):(r.endingStart=e?this.zeroSlopeAtStart?mt:ft:gt,r.endingEnd=t?this.zeroSlopeAtEnd?mt:ft:gt)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=t,s[1]=i+e,a[1]=n,this}}const Rh=new Float32Array(1);class Ah{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Ah(void 0===this.value.clone?this.value:this.value.clone())}}let Lh=0;class Oh extends Ta{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new qn(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new lr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Dh(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(Ph),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0,i=e.length;r<i;r++)Dh(e[r],this,n,t);return n.sort(Ph),n}}function Ph(e,t){return e.distance-t.distance}function Dh(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)Dh(r[e],t,n,!0)}}class $h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Bt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Bh=new Wt;const Fh=new yn,Uh=new yn;class zh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Fh.subVectors(e,this.start),Uh.subVectors(this.end,this.start);const n=Uh.dot(Uh);let r=Uh.dot(Fh)/n;return t&&(r=Bt(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Hh=new yn;const Gh=new yn,Vh=new Jn,Wh=new Jn;function jh(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,jh(e.children[n]));return t}const Xh=new yn,Yh=new ln,Kh=new ln;const qh=new yn,Jh=new yn,Zh=new yn;const Qh=new yn,ed=new Ti;function td(e,t,n,r,i,o,s){Qh.set(i,o,s).unproject(r);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],Qh.x,Qh.y,Qh.z)}}const nd=new Sn;const rd=new yn;let id,od;const sd=ad();function ad(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const o=new Uint32Array(2048),s=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,o[l]=e|t}for(let l=1024;l<2048;++l)o[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:o,exponentTable:s,offsetTable:a}}var ld=Object.freeze({__proto__:null,toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Bt(e,-65504,65504),sd.floatView[0]=e;const t=sd.uint32View[0],n=t>>23&511;return sd.baseTable[n]+((8388607&t)>>sd.shiftTable[n])},fromHalfFloat:function(e){const t=e>>10;return sd.uint32View[0]=sd.mantissaTable[sd.offsetTable[t]+(1023&e)]+sd.exponentTable[t],sd.floatView[0]}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i);const cd=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Q,AddEquation:E,AddOperation:Y,AdditiveAnimationBlendMode:_t,AdditiveBlending:_,AlphaFormat:Ce,AlwaysDepth:F,AlwaysStencilFunc:519,AmbientLight:Yu,AmbientLightProbe:class extends Ju{constructor(e){super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isAmbientLightProbe=!0;const t=(new ln).set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}},AnimationClip:Su,AnimationLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Au(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(e)}}),n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Su.parse(e[n]);t.push(r)}return t}},AnimationMixer:class extends Lt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,s=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==i;++u){const e=r[u],i=e.name;let l=c[i];if(void 0!==l)++l.referenceCount,o[u]=l;else{if(l=o[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,i));continue}const r=t&&t._propertyBindings[u].binding.parsedPath;l=new Th(Ih.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,i),o[u]=l}s[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{const t=o.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,s=o[r],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[i],0===Object.keys(s).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new pu(new Float32Array(2),new Float32Array(2),1,Rh),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let o="string"==typeof e?Su.findByName(r,e):e;const s=null!==o?o.uuid:e,a=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:vt),void 0!==a){const e=a.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new kh(this,o,t,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"==typeof e?Su.findByName(n,e):e,o=i?i.uuid:e,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(r,e,i,o);const s=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)s[l].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,o=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,t[i]=o,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},AnimationObjectGroup:class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=$t(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let s,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=o;e!==t;++e)i[e].push(new Ih(u,n[e],r[e]))}else if(d<l){s=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=o;e!==t;++e){const t=i[e],o=t[a];let s=t[d];t[d]=o,void 0===s&&(s=new Ih(u,n[e],r[e])),t[a]=s}}else e[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o],a=s.uuid,l=t[a];if(void 0!==l&&l>=i){const o=i++,c=e[o];t[c.uuid]=l,e[l]=c,t[a]=o,e[o]=s;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[o],i=t[l];t[l]=r,t[o]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=e.length;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<i){const s=--i,a=e[s],c=--o,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=s,e[s]=u,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],i=t[c];t[l]=r,t[s]=i,t.pop()}}else{const i=--o,s=e[i];i>0&&(t[s.uuid]=l),e[l]=s,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[e]=r,o.push(e),s.push(t),i.push(u);for(let h=c,d=a.length;h!==d;++h){const n=a[h];u[h]=new Ih(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];t[e[s]]=n,o[n]=a,o.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}},AnimationUtils:uu,ArcCurve:Cl,ArrayCamera:la,ArrowHelper:class extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*i;super(),this.type="ArrowHelper",void 0===id&&(id=new qr,id.setAttribute("position",new Hr([0,0,0,0,1,0],3)),od=new ql(0,.5,1,5,1),od.translate(0,-.5,0)),this.position.copy(t),this.line=new dl(id,new sl({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fi(od,new Dr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{rd.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(rd,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}},Audio:gh,AudioAnalyser:class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},AudioContext:sh,AudioListener:class extends Er{constructor(){super(),this.type="AudioListener",this.context=sh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uh}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dh,ph,fh),mh.set(0,0,-1).applyQuaternion(ph),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(dh.x,e),t.positionY.linearRampToValueAtTime(dh.y,e),t.positionZ.linearRampToValueAtTime(dh.z,e),t.forwardX.linearRampToValueAtTime(mh.x,e),t.forwardY.linearRampToValueAtTime(mh.y,e),t.forwardZ.linearRampToValueAtTime(mh.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(dh.x,dh.y,dh.z),t.setOrientation(mh.x,mh.y,mh.z,n.x,n.y,n.z)}},AudioLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new Au(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{const e=n.slice(0);sh.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(o){r?r(o):console.error(o),i.manager.itemError(e)}}),n,r)}},AxesHelper:class extends ml{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new qr;n.setAttribute("position",new Hr(t,3)),n.setAttribute("color",new Hr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new sl({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new ln,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BackSide:f,BasicDepthPacking:Tt,BasicShadowMap:0,Bone:Ka,BooleanKeyframeTrack:gu,Box2:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Bh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Bh.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Box3:Sn,Box3Helper:class extends ml{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new qr;r.setIndex(new Fr(n,1)),r.setAttribute("position",new Hr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new sl({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}},BoxBufferGeometry:gi,BoxGeometry:gi,BoxHelper:class extends ml{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new qr;i.setIndex(new Fr(n,1)),i.setAttribute("position",new Fr(r,3)),super(i,new sl({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&nd.setFromObject(this.object),nd.isEmpty())return;const t=nd.min,n=nd.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}},BufferAttribute:Fr,BufferGeometry:qr,BufferGeometryLoader:th,ByteType:ve,Cache:xu,Camera:Ti,CameraHelper:class extends ml{constructor(e){const t=new qr,n=new sl({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={};function s(e,t){a(e),a(t)}function a(e){r.push(0,0,0),i.push(0,0,0),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new Hr(r,3)),t.setAttribute("color",new Hr(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const l=new ln(16755200),c=new ln(16711680),u=new ln(43775),h=new ln(16777215),d=new ln(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,r,i){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,i.r,i.g,i.b),o.setXYZ(41,i.r,i.g,i.b),o.setXYZ(42,i.r,i.g,i.b),o.setXYZ(43,i.r,i.g,i.b),o.setXYZ(44,i.r,i.g,i.b),o.setXYZ(45,i.r,i.g,i.b),o.setXYZ(46,i.r,i.g,i.b),o.setXYZ(47,i.r,i.g,i.b),o.setXYZ(48,i.r,i.g,i.b),o.setXYZ(49,i.r,i.g,i.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;ed.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),td("c",t,e,ed,0,0,-1),td("t",t,e,ed,0,0,1),td("n1",t,e,ed,-1,-1,-1),td("n2",t,e,ed,1,-1,-1),td("n3",t,e,ed,-1,1,-1),td("n4",t,e,ed,1,1,-1),td("f1",t,e,ed,-1,-1,1),td("f2",t,e,ed,1,-1,1),td("f3",t,e,ed,-1,1,1),td("f4",t,e,ed,1,1,1),td("u1",t,e,ed,.7,1.1,-1),td("u2",t,e,ed,-.7,1.1,-1),td("u3",t,e,ed,0,2,-1),td("cf1",t,e,ed,-1,0,1),td("cf2",t,e,ed,1,0,1),td("cf3",t,e,ed,0,-1,1),td("cf4",t,e,ed,0,1,1),td("cn1",t,e,ed,-1,0,-1),td("cn2",t,e,ed,1,0,-1),td("cn3",t,e,ed,0,-1,-1),td("cn4",t,e,ed,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},CanvasTexture:class extends fn{constructor(e,t,n,r,i,o,s,a,l){super(e,t,n,r,i,o,s,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},CapsuleBufferGeometry:Yl,CapsuleGeometry:Yl,CatmullRomCurve3:Ol,CineonToneMapping:Z,CircleBufferGeometry:Kl,CircleGeometry:Kl,ClampToEdgeWrapping:le,Clock:uh,Color:ln,ColorKeyframeTrack:vu,ColorManagement:en,CompressedTexture:wl,CompressedTextureLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=[],s=new wl,a=new Au(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=i.parse(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=pe),s.image=o,s.format=n.format,s.needsUpdate=!0,t&&t(s))}),n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else a.load(e,(function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){o[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)o[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),o[t].format=n.format,o[t].width=n.width,o[t].height=n.height}s.image=o}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=pe),s.format=n.format,s.needsUpdate=!0,t&&t(s)}),n,r);return s}},ConeBufferGeometry:Jl,ConeGeometry:Jl,CubeCamera:wi,CubeReflectionMapping:ne,CubeRefractionMapping:re,CubeTexture:xi,CubeTextureLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=new xi,o=new Lu(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let s=0;function a(n){o.load(e[n],(function(e){i.images[n]=e,s++,6===s&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(let l=0;l<e.length;++l)a(l);return i}},CubeUVReflectionMapping:se,CubicBezierCurve:$l,CubicBezierCurve3:Bl,CubicInterpolant:du,CullFaceBack:l,CullFaceFront:c,CullFaceFrontBack:3,CullFaceNone:a,Curve:xl,CurvePath:Wl,CustomBlending:T,CustomToneMapping:ee,CylinderBufferGeometry:ql,CylinderGeometry:ql,Cylindrical:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}},Data3DTexture:_n,DataArrayTexture:vn,DataTexture:qa,DataTexture2DArray:class extends vn{constructor(e,t,n,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,r)}},DataTexture3D:class extends _n{constructor(e,t,n,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,r)}},DataTextureLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=new qa,s=new Au(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,(function(e){const n=i.parse(e);!n||(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:le,o.wrapT=void 0!==n.wrapT?n.wrapT:le,o.magFilter=void 0!==n.magFilter?n.magFilter:pe,o.minFilter=void 0!==n.minFilter?n.minFilter:pe,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=me),1===n.mipmapCount&&(o.minFilter=pe),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,t&&t(o,n))}),n,r),o}},DataUtils:ld,DecrementStencilOp:7683,DecrementWrapStencilOp:34056,DefaultLoadingManager:Cu,DepthFormat:Le,DepthStencilFormat:Oe,DepthTexture:da,DirectionalLight:Xu,DirectionalLightHelper:class extends Er{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let r=new qr;r.setAttribute("position",new Hr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new sl({fog:!1,toneMapped:!1});this.lightPlane=new dl(r,i),this.add(this.lightPlane),r=new qr,r.setAttribute("position",new Hr([0,0,0,0,0,1],3)),this.targetLine=new dl(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){qh.setFromMatrixPosition(this.light.matrixWorld),Jh.setFromMatrixPosition(this.light.target.matrixWorld),Zh.subVectors(Jh,qh),this.lightPlane.lookAt(Jh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Jh),this.targetLine.scale.z=Zh.length()}},DiscreteInterpolant:fu,DodecahedronBufferGeometry:Ql,DodecahedronGeometry:Ql,DoubleSide:m,DstAlphaFactor:O,DstColorFactor:P,DynamicCopyUsage:35050,DynamicDrawUsage:kt,DynamicReadUsage:35049,EdgesGeometry:ic,EllipseCurve:Ml,EqualDepth:H,EqualStencilFunc:514,EquirectangularReflectionMapping:ie,EquirectangularRefractionMapping:oe,Euler:ar,EventDispatcher:Lt,ExtrudeBufferGeometry:Nc,ExtrudeGeometry:Nc,FileLoader:Au,FlatShading:1,Float16BufferAttribute:class extends Fr{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}},Float32BufferAttribute:Hr,Float64BufferAttribute:class extends Fr{constructor(e,t,n){super(new Float64Array(e),t,n)}},FloatType:Ee,Fog:ba,FogExp2:_a,Font:function(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")},FontLoader:function(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")},FramebufferTexture:class extends fn{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=ue,this.minFilter=ue,this.generateMipmaps=!1,this.needsUpdate=!0}},FrontSide:p,Frustum:Oi,GLBufferAttribute:class{constructor(e,t,n,r,i){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},GLSL1:"100",GLSL3:Rt,GreaterDepth:V,GreaterEqualDepth:G,GreaterEqualStencilFunc:518,GreaterStencilFunc:516,GridHelper:class extends ml{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new ln(n),r=new ln(r);const i=t/2,o=e/t,s=e/2,a=[],l=[];for(let u=0,h=0,d=-s;u<=t;u++,d+=o){a.push(-s,0,d,s,0,d),a.push(d,0,-s,d,0,s);const e=u===i?n:r;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new qr;c.setAttribute("position",new Hr(a,3)),c.setAttribute("color",new Hr(l,3));super(c,new sl({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}},Group:ca,HalfFloatType:Se,HemisphereLight:Nu,HemisphereLightHelper:class extends Er{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new $c(t);r.rotateY(.5*Math.PI),this.material=new Dr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Fr(o,3)),this.add(new fi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Yh.copy(this.light.color),Kh.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?Yh:Kh;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(Xh.setFromMatrixPosition(this.light.matrixWorld).negate())}},HemisphereLightProbe:class extends Ju{constructor(e,t){super(void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),this.isHemisphereLightProbe=!0;const n=(new ln).set(e),r=(new ln).set(t),i=new yn(n.r,n.g,n.b),o=new yn(r.r,r.g,r.b),s=Math.sqrt(Math.PI),a=s*Math.sqrt(.75);this.sh.coefficients[0].copy(i).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(i).sub(o).multiplyScalar(a)}},IcosahedronBufferGeometry:Dc,IcosahedronGeometry:Dc,ImageBitmapLoader:class extends Iu{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=xu.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){xu.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}},ImageLoader:Lu,ImageUtils:un,ImmediateRenderObject:function(){console.error("THREE.ImmediateRenderObject has been removed.")},IncrementStencilOp:7682,IncrementWrapStencilOp:34055,InstancedBufferAttribute:el,InstancedBufferGeometry:eh,InstancedInterleavedBuffer:Oh,InstancedMesh:ol,Int16BufferAttribute:class extends Fr{constructor(e,t,n){super(new Int16Array(e),t,n)}},Int32BufferAttribute:class extends Fr{constructor(e,t,n){super(new Int32Array(e),t,n)}},Int8BufferAttribute:class extends Fr{constructor(e,t,n){super(new Int8Array(e),t,n)}},IntType:ye,InterleavedBuffer:Ta,InterleavedBufferAttribute:Sa,Interpolant:hu,InterpolateDiscrete:ht,InterpolateLinear:dt,InterpolateSmooth:pt,InvertStencilOp:5386,KeepStencilOp:Ct,KeyframeTrack:mu,LOD:Ha,LatheBufferGeometry:Xl,LatheGeometry:Xl,Layers:lr,LessDepth:U,LessEqualDepth:z,LessEqualStencilFunc:515,LessStencilFunc:513,Light:Ou,LightProbe:Ju,Line:dl,Line3:zh,LineBasicMaterial:sl,LineCurve:Fl,LineCurve3:Ul,LineDashedMaterial:ru,LineLoop:gl,LineSegments:ml,LinearEncoding:bt,LinearFilter:pe,LinearInterpolant:pu,LinearMipMapLinearFilter:1008,LinearMipMapNearestFilter:1007,LinearMipmapLinearFilter:me,LinearMipmapNearestFilter:fe,LinearSRGBColorSpace:Mt,LinearToneMapping:q,Loader:Iu,LoaderUtils:Qu,LoadingManager:Mu,LoopOnce:2200,LoopPingPong:2202,LoopRepeat:2201,LuminanceAlphaFormat:Ae,LuminanceFormat:Re,MOUSE:o,Material:Pr,MaterialLoader:Zu,MathUtils:Vt,Matrix3:jt,Matrix4:Jn,MaxEquation:M,Mesh:fi,MeshBasicMaterial:Dr,MeshDepthMaterial:ea,MeshDistanceMaterial:ta,MeshLambertMaterial:tu,MeshMatcapMaterial:nu,MeshNormalMaterial:eu,MeshPhongMaterial:Zc,MeshPhysicalMaterial:Jc,MeshStandardMaterial:qc,MeshToonMaterial:Qc,MinEquation:x,MirroredRepeatWrapping:ce,MixOperation:X,MultiplyBlending:y,MultiplyOperation:j,NearestFilter:ue,NearestMipMapLinearFilter:1005,NearestMipMapNearestFilter:1004,NearestMipmapLinearFilter:de,NearestMipmapNearestFilter:he,NeverDepth:B,NeverStencilFunc:512,NoBlending:g,NoColorSpace:"",NoToneMapping:K,NormalAnimationBlendMode:vt,NormalBlending:v,NotEqualDepth:W,NotEqualStencilFunc:517,NumberKeyframeTrack:_u,Object3D:Er,ObjectLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=this,o=""===this.path?Qu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const s=new Au(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){let o=null;try{o=JSON.parse(n)}catch(a){return void 0!==r&&r(a),void console.error("THREE:ObjectLoader: Can't parse "+e+".",a.message)}const s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}async loadAsync(e,t){const n=""===this.path?Qu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new Au(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),o=JSON.parse(i),s=o.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),s=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,i,a,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in o)if(o[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,o),a=this.parseObject(e.object,r,s,o,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new oc).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(let i=0,o=e.length;i<o;i++){const t=(new Qa).fromJSON(e[i],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new th;for(let i=0,o=e.length;i<o;i++){let o;const s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in Xc?o=Xc[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new Zu;i.setTextures(t);for(let t=0,o=e.length;t<o;t++){const o=e[t];if("MultiMaterial"===o.type){const e=[];for(let t=0;t<o.materials.length;t++){const r=o.materials[t];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),e.push(n[r.uuid])}r[o.uuid]=e}else void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=Su.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function o(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:Kt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Mu(t);i=new Lu(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const n=e[t],i=n.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=o(i[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new qa(n.data,n.width,n.height)))}r[n.uuid]=new hn(e)}else{const e=o(n.url);r[n.uuid]=new hn(e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"==typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:Kt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new Lu(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],o=r.url;if(Array.isArray(o)){const e=[];for(let t=0,n=o.length;t<n;t++){const n=o[t],r=await i(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new qa(r.data,r.width,r.height)))}n[r.uuid]=new hn(e)}else{const e=await i(r.url);n[r.uuid]=new hn(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,o=e.length;i<o;i++){const o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const s=t[o.image],a=s.data;let l;Array.isArray(a)?(l=new xi,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new qa:new fn,a&&(l.needsUpdate=!0)),l.source=s,l.uuid=o.uuid,void 0!==o.name&&(l.name=o.name),void 0!==o.mapping&&(l.mapping=n(o.mapping,nh)),void 0!==o.offset&&l.offset.fromArray(o.offset),void 0!==o.repeat&&l.repeat.fromArray(o.repeat),void 0!==o.center&&l.center.fromArray(o.center),void 0!==o.rotation&&(l.rotation=o.rotation),void 0!==o.wrap&&(l.wrapS=n(o.wrap[0],rh),l.wrapT=n(o.wrap[1],rh)),void 0!==o.format&&(l.format=o.format),void 0!==o.type&&(l.type=o.type),void 0!==o.encoding&&(l.encoding=o.encoding),void 0!==o.minFilter&&(l.minFilter=n(o.minFilter,ih)),void 0!==o.magFilter&&(l.magFilter=n(o.magFilter,ih)),void 0!==o.anisotropy&&(l.anisotropy=o.anisotropy),void 0!==o.flipY&&(l.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(l.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(l.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(l.userData=o.userData),r[o.uuid]=l}return r}parseObject(e,t,n,r,i){let o,s,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":o=new ya,void 0!==e.background&&(Number.isInteger(e.background)?o.background=new ln(e.background):o.background=u(e.background)),void 0!==e.environment&&(o.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new ba(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new _a(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Ei(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ji(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Yu(e.color,e.intensity);break;case"DirectionalLight":o=new Xu(e.color,e.intensity);break;case"PointLight":o=new Wu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Ku(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Uu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Nu(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Ju).fromJSON(e);break;case"SkinnedMesh":s=l(e.geometry),a=c(e.material),o=new Ya(s,a),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":s=l(e.geometry),a=c(e.material),o=new fi(s,a);break;case"InstancedMesh":s=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,r=e.instanceColor;o=new ol(s,a,t),o.instanceMatrix=new el(new Float32Array(n.array),16),void 0!==r&&(o.instanceColor=new el(new Float32Array(r.array),r.itemSize));break;case"LOD":o=new Ha;break;case"Line":o=new dl(l(e.geometry),c(e.material));break;case"LineLoop":o=new gl(l(e.geometry),c(e.material));break;case"LineSegments":o=new ml(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new El(l(e.geometry),c(e.material));break;case"Sprite":o=new Ba(c(e.material));break;case"Group":o=new ca;break;case"Bone":o=new Ka;break;default:o=new Er}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const s=e.children;for(let e=0;e<s.length;e++)o.add(this.parseObject(s[e],t,n,r,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];o.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},ObjectSpaceNormalMap:wt,OctahedronBufferGeometry:$c,OctahedronGeometry:$c,OneFactor:I,OneMinusDstAlphaFactor:N,OneMinusDstColorFactor:D,OneMinusSrcAlphaFactor:L,OneMinusSrcColorFactor:R,OrthographicCamera:ji,PCFShadowMap:u,PCFSoftShadowMap:h,PMREMGenerator:to,ParametricGeometry:class extends qr{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}},Path:jl,PerspectiveCamera:Ei,Plane:Ri,PlaneBufferGeometry:Di,PlaneGeometry:Di,PlaneHelper:class extends dl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,r=new qr;r.setAttribute("position",new Hr([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new sl({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const i=new qr;i.setAttribute("position",new Hr([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new fi(i,new Dr({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}},PointLight:Wu,PointLightHelper:class extends fi{constructor(e,t,n){super(new Uc(t,4,2),new Dr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Points:El,PointsMaterial:vl,PolarGridHelper:class extends ml{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;i=new ln(i),o=new ln(o);const s=[],a=[];for(let c=0;c<=t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;s.push(0,0,0),s.push(r,0,l);const u=1&c?i:o;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let c=0;c<=n;c++){const t=1&c?i:o,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),i=Math.sin(n)*l,o=Math.cos(n)*l;s.push(i,0,o),a.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),i=Math.sin(n)*l,o=Math.cos(n)*l,s.push(i,0,o),a.push(t.r,t.g,t.b)}}const l=new qr;l.setAttribute("position",new Hr(s,3)),l.setAttribute("color",new Hr(a,3));super(l,new sl({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}},PolyhedronBufferGeometry:Zl,PolyhedronGeometry:Zl,PositionalAudio:class extends gh{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(vh,_h,bh),yh.set(0,0,1).applyQuaternion(_h);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(vh.x,e),t.positionY.linearRampToValueAtTime(vh.y,e),t.positionZ.linearRampToValueAtTime(vh.z,e),t.orientationX.linearRampToValueAtTime(yh.x,e),t.orientationY.linearRampToValueAtTime(yh.y,e),t.orientationZ.linearRampToValueAtTime(yh.z,e)}else t.setPosition(vh.x,vh.y,vh.z),t.setOrientation(yh.x,yh.y,yh.z)}},PropertyBinding:Ih,PropertyMixer:Th,QuadraticBezierCurve:zl,QuadraticBezierCurve3:Hl,Quaternion:bn,QuaternionKeyframeTrack:yu,QuaternionLinearInterpolant:bu,REVISION:i,RGBADepthPacking:Et,RGBAFormat:ke,RGBAIntegerFormat:Be,RGBA_ASTC_10x10_Format:at,RGBA_ASTC_10x5_Format:it,RGBA_ASTC_10x6_Format:ot,RGBA_ASTC_10x8_Format:st,RGBA_ASTC_12x10_Format:lt,RGBA_ASTC_12x12_Format:ct,RGBA_ASTC_4x4_Format:qe,RGBA_ASTC_5x4_Format:Je,RGBA_ASTC_5x5_Format:Ze,RGBA_ASTC_6x5_Format:Qe,RGBA_ASTC_6x6_Format:et,RGBA_ASTC_8x5_Format:tt,RGBA_ASTC_8x6_Format:nt,RGBA_ASTC_8x8_Format:rt,RGBA_BPTC_Format:ut,RGBA_ETC2_EAC_Format:Ke,RGBA_PVRTC_2BPPV1_Format:je,RGBA_PVRTC_4BPPV1_Format:We,RGBA_S3TC_DXT1_Format:Ue,RGBA_S3TC_DXT3_Format:ze,RGBA_S3TC_DXT5_Format:He,RGBFormat:Ie,RGB_ETC1_Format:Xe,RGB_ETC2_Format:Ye,RGB_PVRTC_2BPPV1_Format:Ve,RGB_PVRTC_4BPPV1_Format:Ge,RGB_S3TC_DXT1_Format:Fe,RGFormat:De,RGIntegerFormat:$e,RawShaderMaterial:Kc,Ray:qn,Raycaster:Nh,RectAreaLight:Ku,RedFormat:Ne,RedIntegerFormat:Pe,ReinhardToneMapping:J,RepeatWrapping:ae,ReplaceStencilOp:7681,ReverseSubtractEquation:w,RingBufferGeometry:Bc,RingGeometry:Bc,SRGBColorSpace:xt,Scene:ya,ShaderChunk:$i,ShaderLib:Fi,ShaderMaterial:yi,ShadowMaterial:Yc,Shape:oc,ShapeBufferGeometry:Fc,ShapeGeometry:Fc,ShapePath:class{constructor(){this.type="ShapePath",this.color=new ln,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new jl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new oc;i.curves=r.curves,t.push(i)}return t}function r(e,t){const n=t.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=t[i],s=t[o],a=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[o],a=-a,s=t[i],l=-l),e.y<n.y||e.y>s.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return r}const i=Ac.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);let s,a,l;const c=[];if(1===o.length)return a=o[0],l=new oc,l.curves=a.curves,c.push(l),c;let u=!i(o[0].getPoints());u=e?!u:u;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let v=0,_=o.length;v<_;v++)a=o[v],p=a.getPoints(),s=i(p),s=e?!s:s,s?(!u&&d[g]&&g++,d[g]={s:new oc,p:p},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return n(o);if(d.length>1){let e=!1,t=0;for(let n=0,r=d.length;n<r;n++)h[n]=[];for(let n=0,i=d.length;n<i;n++){const i=m[n];for(let o=0;o<i.length;o++){const s=i[o];let a=!0;for(let i=0;i<d.length;i++)r(s.p,d[i].p)&&(n!==i&&t++,a?(a=!1,h[i].push(s)):e=!0);a&&h[n].push(s)}}t>0&&!1===e&&(m=h)}for(let v=0,_=d.length;v<_;v++){l=d[v].s,c.push(l),f=m[v];for(let e=0,t=f.length;e<t;e++)l.holes.push(f[e].h)}return c}},ShapeUtils:Ac,ShortType:_e,Skeleton:Qa,SkeletonHelper:class extends ml{constructor(e){const t=jh(e),n=new qr,r=[],i=[],o=new ln(0,0,1),s=new ln(0,1,0);for(let a=0;a<t.length;a++){const e=t[a];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}n.setAttribute("position",new Hr(r,3)),n.setAttribute("color",new Hr(i,3));super(n,new sl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Wh.copy(this.root.matrixWorld).invert();for(let i=0,o=0;i<t.length;i++){const e=t[i];e.parent&&e.parent.isBone&&(Vh.multiplyMatrices(Wh,e.matrixWorld),Gh.setFromMatrixPosition(Vh),r.setXYZ(o,Gh.x,Gh.y,Gh.z),Vh.multiplyMatrices(Wh,e.parent.matrixWorld),Gh.setFromMatrixPosition(Vh),r.setXYZ(o+1,Gh.x,Gh.y,Gh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}},SkinnedMesh:Ya,SmoothShading:2,Source:hn,Sphere:Hn,SphereBufferGeometry:Uc,SphereGeometry:Uc,Spherical:$h,SphericalHarmonics3:qu,SplineCurve:Gl,SpotLight:Uu,SpotLightHelper:class extends Er{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new qr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,s=1,a=32;o<a;o++,s++){const e=o/a*Math.PI*2,t=s/a*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new Hr(r,3));const i=new sl({fog:!1,toneMapped:!1});this.cone=new ml(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Hh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Sprite:Ba,SpriteMaterial:wa,SrcAlphaFactor:A,SrcAlphaSaturateFactor:$,SrcColorFactor:k,StaticCopyUsage:35046,StaticDrawUsage:It,StaticReadUsage:35045,StereoCamera:class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ei,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ei,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,ch.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(Pt*t.fov*.5)/t.zoom;let o,s;lh.elements[12]=-n,ah.elements[12]=n,o=-i*t.aspect+r,s=i*t.aspect+r,ch.elements[0]=2*t.near/(s-o),ch.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(ch),o=-i*t.aspect-r,s=i*t.aspect-r,ch.elements[0]=2*t.near/(s-o),ch.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(ch)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ah)}},StreamCopyUsage:35042,StreamDrawUsage:35040,StreamReadUsage:35041,StringKeyframeTrack:Tu,SubtractEquation:S,SubtractiveBlending:b,TOUCH:s,TangentSpaceNormalMap:St,TetrahedronBufferGeometry:zc,TetrahedronGeometry:zc,TextGeometry:class extends qr{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}},Texture:fn,TextureLoader:class extends Iu{constructor(e){super(e)}load(e,t,n,r){const i=new fn,o=new Lu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}},TorusBufferGeometry:Hc,TorusGeometry:Hc,TorusKnotBufferGeometry:Gc,TorusKnotGeometry:Gc,Triangle:Or,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:0,TubeBufferGeometry:Vc,TubeGeometry:Vc,UVMapping:te,Uint16BufferAttribute:Ur,Uint32BufferAttribute:zr,Uint8BufferAttribute:class extends Fr{constructor(e,t,n){super(new Uint8Array(e),t,n)}},Uint8ClampedBufferAttribute:class extends Fr{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},Uniform:Ah,UniformsGroup:class extends Lt{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Lh++}),this.name="",this.usage=It,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}clone(){return(new this.constructor).copy(this)}},UniformsLib:Bi,UniformsUtils:bi,UnsignedByteType:ge,UnsignedInt248Type:Me,UnsignedIntType:Te,UnsignedShort4444Type:we,UnsignedShort5551Type:xe,UnsignedShortType:be,VSMShadowMap:d,Vector2:Wt,Vector3:yn,Vector4:mn,VectorKeyframeTrack:Eu,VideoTexture:class extends fn{constructor(e,t,n,r,i,o,s,a,l){super(e,t,n,r,i,o,s,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:pe,this.magFilter=void 0!==i?i:pe,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},WebGL1Renderer:va,WebGL3DRenderTarget:class extends gn{constructor(e,t,n){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new _n(null,e,t,n),this.texture.isRenderTargetTexture=!0}},WebGLArrayRenderTarget:class extends gn{constructor(e,t,n){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new vn(null,e,t,n),this.texture.isRenderTargetTexture=!0}},WebGLCubeRenderTarget:Mi,WebGLMultipleRenderTargets:class extends gn{constructor(e,t,n){super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;const r=this.texture;this.texture=[];for(let i=0;i<n;i++)this.texture[i]=r.clone(),this.texture[i].isRenderTargetTexture=!0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},WebGLMultisampleRenderTarget:class extends gn{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}},WebGLRenderTarget:gn,WebGLRenderer:ga,WebGLUtils:aa,WireframeGeometry:Wc,WrapAroundEnding:gt,ZeroCurvatureEnding:ft,ZeroFactor:C,ZeroSlopeEnding:mt,ZeroStencilOp:0,_SRGBAFormat:At,sRGBEncoding:yt},Symbol.toStringTag,{value:"Module"}));var ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof __webpack_require__.g<"u"?__webpack_require__.g:typeof self<"u"?self:{};function hd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dd,pd={exports:{}},fd={};function md(e){let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(i!==t){const e=t;t=r?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,subscribe:(e,r,o)=>r||o?function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=r(t);function a(){const n=r(t);if(!o(s,n)){const t=s;e(s=n,t)}}return n.add(a),()=>n.delete(a)}(e,r,o):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,i,o),o}pd.exports=(dd||(dd=1,fd.ConcurrentRoot=1,fd.ContinuousEventPriority=4,fd.DefaultEventPriority=16,fd.DiscreteEventPriority=1,fd.IdleEventPriority=536870912,fd.LegacyRoot=0),fd);const gd=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?e.useEffect:e.useLayoutEffect;var vd,_d={exports:{}},bd={exports:{}},yd={};var Td,Ed;function Sd(){return Ed||(Ed=1,Td=function(t){var n={},r=e,i=bd.exports,o=Object.assign;function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),T=Symbol.iterator;function E(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=T&&e[T]||e["@@iterator"])?e:null}function S(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case v:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case f:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case m:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:S(e.type)||"Memo";case b:t=e._payload,e=e._init;try{return S(e(t))}catch{}}return null}function w(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S(t);case 8:return t===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function x(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function M(e){if(x(e)!==e)throw Error(s(188))}function C(e){var t=e.alternate;if(!t){if(null===(t=x(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return M(i),e;if(o===r)return M(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}function I(e){return null!==(e=C(e))?k(e):null}function k(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=k(e);if(null!==t)return t;e=e.sibling}return null}function R(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=R(e);if(null!==t)return t}e=e.sibling}return null}var A,L=Array.isArray,O=t.getPublicInstance,N=t.getRootHostContext,P=t.getChildHostContext,D=t.prepareForCommit,$=t.resetAfterCommit,B=t.createInstance,F=t.appendInitialChild,U=t.finalizeInitialChildren,z=t.prepareUpdate,H=t.shouldSetTextContent,G=t.createTextInstance,V=t.scheduleTimeout,W=t.cancelTimeout,j=t.noTimeout,X=t.isPrimaryRenderer,Y=t.supportsMutation,K=t.supportsPersistence,q=t.supportsHydration,J=t.getInstanceFromNode,Z=t.preparePortalMount,Q=t.getCurrentEventPriority,ee=t.detachDeletedInstance,te=t.supportsMicrotasks,ne=t.scheduleMicrotask,re=t.supportsTestSelectors,ie=t.findFiberRoot,oe=t.getBoundingRect,se=t.getTextContent,ae=t.isHiddenSubtree,le=t.matchAccessibilityRole,ce=t.setFocusIfFocusable,ue=t.setupIntersectionObserver,he=t.appendChild,de=t.appendChildToContainer,pe=t.commitTextUpdate,fe=t.commitMount,me=t.commitUpdate,ge=t.insertBefore,ve=t.insertInContainerBefore,_e=t.removeChild,be=t.removeChildFromContainer,ye=t.resetTextContent,Te=t.hideInstance,Ee=t.hideTextInstance,Se=t.unhideInstance,we=t.unhideTextInstance,xe=t.clearContainer,Me=t.cloneInstance,Ce=t.createContainerChildSet,Ie=t.appendChildToContainerChildSet,ke=t.finalizeContainerChildren,Re=t.replaceContainerChildren,Ae=t.cloneHiddenInstance,Le=t.cloneHiddenTextInstance,Oe=t.canHydrateInstance,Ne=t.canHydrateTextInstance,Pe=t.canHydrateSuspenseInstance,De=t.isSuspenseInstancePending,$e=t.isSuspenseInstanceFallback,Be=t.registerSuspenseInstanceRetry,Fe=t.getNextHydratableSibling,Ue=t.getFirstHydratableChild,ze=t.getFirstHydratableChildWithinContainer,He=t.getFirstHydratableChildWithinSuspenseInstance,Ge=t.hydrateInstance,Ve=t.hydrateTextInstance,We=t.hydrateSuspenseInstance,je=t.getNextHydratableInstanceAfterSuspenseInstance,Xe=t.commitHydratedContainer,Ye=t.commitHydratedSuspenseInstance,Ke=t.clearSuspenseBoundary,qe=t.clearSuspenseBoundaryFromContainer,Je=t.shouldDeleteUnhydratedTailInstances,Ze=t.didNotMatchHydratedContainerTextInstance,Qe=t.didNotMatchHydratedTextInstance;function et(e){if(void 0===A)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return"\n"+A+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"==typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var rt=Object.prototype.hasOwnProperty,it=[],ot=-1;function st(e){return{current:e}}function at(e){0>ot||(e.current=it[ot],it[ot]=null,ot--)}function lt(e,t){ot++,it[ot]=e.current,e.current=t}var ct={},ut=st(ct),ht=st(!1),dt=ct;function pt(e,t){var n=e.type.contextTypes;if(!n)return ct;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ft(e){return null!=(e=e.childContextTypes)}function mt(){at(ht),at(ut)}function gt(e,t,n){if(ut.current!==ct)throw Error(s(168));lt(ut,t),lt(ht,n)}function vt(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,w(e)||"Unknown",i));return o({},n,r)}function _t(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,dt=ut.current,lt(ut,e),lt(ht,ht.current),!0}function bt(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=vt(e,t,dt),r.__reactInternalMemoizedMergedChildContext=e,at(ht),at(ut),lt(ut,e)):at(ht),lt(ht,n)}var yt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Tt(e)/Et|0)|0},Tt=Math.log,Et=Math.LN2;var St=64,wt=4194304;function xt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=xt(a):0!==(o&=s)&&(r=xt(o))}else 0!==(s=n&~i)?r=xt(s):0!==o&&(r=xt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-yt(t)),r|=e[n],t&=~i;return r}function Ct(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function It(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function kt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-yt(t)]=n}function At(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-yt(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Lt=0;function Ot(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Nt=i.unstable_scheduleCallback,Pt=i.unstable_cancelCallback,Dt=i.unstable_shouldYield,$t=i.unstable_requestPaint,Bt=i.unstable_now,Ft=i.unstable_ImmediatePriority,Ut=i.unstable_UserBlockingPriority,zt=i.unstable_NormalPriority,Ht=i.unstable_IdlePriority,Gt=null,Vt=null;var Wt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},jt=null,Xt=!1,Yt=!1;function Kt(e){null===jt?jt=[e]:jt.push(e)}function qt(){if(!Yt&&null!==jt){Yt=!0;var e=0,t=Lt;try{var n=jt;for(Lt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}jt=null,Xt=!1}catch(i){throw null!==jt&&(jt=jt.slice(e+1)),Nt(Ft,qt),i}finally{Lt=t,Yt=!1}}return null}var Jt=a.ReactCurrentBatchConfig;function Zt(e,t){if(Wt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!rt.call(t,i)||!Wt(e[i],t[i]))return!1}return!0}function Qt(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=o({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=st(null),nn=null,rn=null,on=null;function sn(){on=rn=nn=null}function an(e,t,n){X?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;at(tn),X?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function un(e,t){nn=e,on=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Di=!0),e.firstContext=null)}function hn(e){var t=X?e._currentValue:e._currentValue2;if(on!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(s(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var dn=null,pn=!1;function fn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Ko&&0!==(1&e.mode)&&0===(2&Yo)?(null===(e=n.interleaved)?(t.next=t,null===dn?dn=[n]:dn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function _n(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,At(e,n)}}function bn(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yn(e,t,n,r){var i=e.updateQueue;pn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(null!==l){i.shared.pending=null;var c=l,u=c.next;c.next=null,null===a?s=u:a.next=u,a=c;var h=e.alternate;null!==h&&((l=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===l?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(null!==s){var d=i.baseState;for(a=0,h=u=c=null,l=s;;){var p=l.lane,f=l.eventTime;if((r&p)===p){null!==h&&(h=h.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(p=t,f=n,g.tag){case 1:if("function"==typeof(m=g.payload)){d=m.call(f,d,p);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(p="function"==typeof(m=g.payload)?m.call(f,d,p):m))break e;d=o({},d,p);break e;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=i.effects)?i.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===h?(u=h=f,c=d):h=h.next=f,a|=p;if(null===(l=l.next)){if(null===(l=i.shared.pending))break;l=(p=l).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===h&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);ns|=a,e.lanes=a,e.memoizedState=d}}function Tn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(s(191,i));i.call(r)}}}var En=(new r.Component).refs;function Sn(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:o({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&x(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ts(),i=Es(e),o=gn(r,i);o.payload=t,null!=n&&(o.callback=n),vn(e,o),null!==(t=Ss(e,i,r))&&_n(t,e,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ts(),i=Es(e),o=gn(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),vn(e,o),null!==(t=Ss(e,i,r))&&_n(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ts(),r=Es(e),i=gn(n,r);i.tag=2,null!=t&&(i.callback=t),vn(e,i),null!==(t=Ss(e,r,n))&&_n(t,e,r)}};function xn(e,t,n,r,i,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Zt(n,r)||!Zt(i,o))}function Mn(e,t,n){var r=!1,i=ct,o=t.contextType;return"object"==typeof o&&null!==o?o=hn(o):(i=ft(t)?dt:ut.current,o=(r=null!=(r=t.contextTypes))?pt(e,i):ct),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Cn(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function In(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=En,fn(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=hn(o):(o=ft(t)?dt:ut.current,i.context=pt(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(Sn(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&wn.enqueueReplaceState(i,i.state,null),yn(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}var kn=[],Rn=0,An=null,Ln=0,On=[],Nn=0,Pn=null,Dn=1,$n="";function Bn(e,t){kn[Rn++]=Ln,kn[Rn++]=An,An=e,Ln=t}function Fn(e,t,n){On[Nn++]=Dn,On[Nn++]=$n,On[Nn++]=Pn,Pn=e;var r=Dn;e=$n;var i=32-yt(r)-1;r&=~(1<<i),n+=1;var o=32-yt(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Dn=1<<32-yt(t)+i|n<<i|r,$n=o+e}else Dn=1<<o|n<<i|r,$n=e}function Un(e){null!==e.return&&(Bn(e,1),Fn(e,1,0))}function zn(e){for(;e===An;)An=kn[--Rn],kn[Rn]=null,Ln=kn[--Rn],kn[Rn]=null;for(;e===Pn;)Pn=On[--Nn],On[Nn]=null,$n=On[--Nn],On[Nn]=null,Dn=On[--Nn],On[Nn]=null}var Hn=null,Gn=null,Vn=!1,Wn=!1,jn=null;function Xn(e,t){var n=Zs(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Yn(e,t){switch(e.tag){case 5:return null!==(t=Oe(t,e.type,e.pendingProps))&&(e.stateNode=t,Hn=e,Gn=Ue(t),!0);case 6:return null!==(t=Ne(t,e.pendingProps))&&(e.stateNode=t,Hn=e,Gn=null,!0);case 13:if(null!==(t=Pe(t))){var n=null!==Pn?{id:Dn,overflow:$n}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Zs(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Hn=e,Gn=null,!0}return!1;default:return!1}}function Kn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function qn(e){if(Vn){var t=Gn;if(t){var n=t;if(!Yn(e,t)){if(Kn(e))throw Error(s(418));t=Fe(n);var r=Hn;t&&Yn(e,t)?Xn(r,n):(e.flags=-4097&e.flags|2,Vn=!1,Hn=e)}}else{if(Kn(e))throw Error(s(418));e.flags=-4097&e.flags|2,Vn=!1,Hn=e}}}function Jn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Hn=e}function Zn(e){if(!q||e!==Hn)return!1;if(!Vn)return Jn(e),Vn=!0,!1;if(3!==e.tag&&(5!==e.tag||Je(e.type)&&!H(e.type,e.memoizedProps))){var t=Gn;if(t){if(Kn(e)){for(e=Gn;e;)e=Fe(e);throw Error(s(418))}for(;t;)Xn(e,t),t=Fe(t)}}if(Jn(e),13===e.tag){if(!q)throw Error(s(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));Gn=je(e)}else Gn=Hn?Fe(e.stateNode):null;return!0}function Qn(){q&&(Gn=Hn=null,Wn=Vn=!1)}function er(e){null===jn?jn=[e]:jn.push(e)}function tr(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=i.refs;t===En&&(t=i.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function nr(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rr(e){return(0,e._init)(e._payload)}function ir(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=ea(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function h(e,t,n,r){return null===t||6!==t.tag?((t=ia(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n,r){var o=n.type;return o===u?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===b&&rr(o)===t.type)?((r=i(t,n.props)).ref=tr(e,t,n),r.return=e,r):((r=ta(n.type,n.key,n.props,null,e.mode,r)).ref=tr(e,t,n),r.return=e,r)}function p(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=oa(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function f(e,t,n,r,o){return null===t||7!==t.tag?((t=na(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ia(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case l:return(n=ta(t.type,t.key,t.props,null,e.mode,n)).ref=tr(e,null,t),n.return=e,n;case c:return(t=oa(t,e.mode,n)).return=e,t;case b:return m(e,(0,t._init)(t._payload),n)}if(L(t)||E(t))return(t=na(t,e.mode,n,null)).return=e,t;nr(e,t)}return null}function g(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:h(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===i?d(e,t,n,r):null;case c:return n.key===i?p(e,t,n,r):null;case b:return g(e,t,(i=n._init)(n._payload),r)}if(L(n)||E(n))return null!==i?null:f(e,t,n,r,null);nr(e,n)}return null}function v(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return h(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case l:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case c:return p(t,e=e.get(null===r.key?n:r.key)||null,r,i);case b:return v(e,t,n,(0,r._init)(r._payload),i)}if(L(r)||E(r))return f(t,e=e.get(n)||null,r,i,null);nr(t,r)}return null}return function h(d,p,f,_){if("object"==typeof f&&null!==f&&f.type===u&&null===f.key&&(f=f.props.children),"object"==typeof f&&null!==f){switch(f.$$typeof){case l:e:{for(var y=f.key,T=p;null!==T;){if(T.key===y){if((y=f.type)===u){if(7===T.tag){n(d,T.sibling),(p=i(T,f.props.children)).return=d,d=p;break e}}else if(T.elementType===y||"object"==typeof y&&null!==y&&y.$$typeof===b&&rr(y)===T.type){n(d,T.sibling),(p=i(T,f.props)).ref=tr(d,T,f),p.return=d,d=p;break e}n(d,T);break}t(d,T),T=T.sibling}f.type===u?((p=na(f.props.children,d.mode,_,f.key)).return=d,d=p):((_=ta(f.type,f.key,f.props,null,d.mode,_)).ref=tr(d,p,f),_.return=d,d=_)}return a(d);case c:e:{for(T=f.key;null!==p;){if(p.key===T){if(4===p.tag&&p.stateNode.containerInfo===f.containerInfo&&p.stateNode.implementation===f.implementation){n(d,p.sibling),(p=i(p,f.children||[])).return=d,d=p;break e}n(d,p);break}t(d,p),p=p.sibling}(p=oa(f,d.mode,_)).return=d,d=p}return a(d);case b:return h(d,p,(T=f._init)(f._payload),_)}if(L(f))return function(i,s,a,l){for(var c=null,u=null,h=s,d=s=0,p=null;null!==h&&d<a.length;d++){h.index>d?(p=h,h=null):p=h.sibling;var f=g(i,h,a[d],l);if(null===f){null===h&&(h=p);break}e&&h&&null===f.alternate&&t(i,h),s=o(f,s,d),null===u?c=f:u.sibling=f,u=f,h=p}if(d===a.length)return n(i,h),Vn&&Bn(i,d),c;if(null===h){for(;d<a.length;d++)null!==(h=m(i,a[d],l))&&(s=o(h,s,d),null===u?c=h:u.sibling=h,u=h);return Vn&&Bn(i,d),c}for(h=r(i,h);d<a.length;d++)null!==(p=v(h,i,d,a[d],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?d:p.key),s=o(p,s,d),null===u?c=p:u.sibling=p,u=p);return e&&h.forEach((function(e){return t(i,e)})),Vn&&Bn(i,d),c}(d,p,f,_);if(E(f))return function(i,a,l,c){var u=E(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,d=a,p=a=0,f=null,_=l.next();null!==d&&!_.done;p++,_=l.next()){d.index>p?(f=d,d=null):f=d.sibling;var b=g(i,d,_.value,c);if(null===b){null===d&&(d=f);break}e&&d&&null===b.alternate&&t(i,d),a=o(b,a,p),null===h?u=b:h.sibling=b,h=b,d=f}if(_.done)return n(i,d),Vn&&Bn(i,p),u;if(null===d){for(;!_.done;p++,_=l.next())null!==(_=m(i,_.value,c))&&(a=o(_,a,p),null===h?u=_:h.sibling=_,h=_);return Vn&&Bn(i,p),u}for(d=r(i,d);!_.done;p++,_=l.next())null!==(_=v(d,i,p,_.value,c))&&(e&&null!==_.alternate&&d.delete(null===_.key?p:_.key),a=o(_,a,p),null===h?u=_:h.sibling=_,h=_);return e&&d.forEach((function(e){return t(i,e)})),Vn&&Bn(i,p),u}(d,p,f,_);nr(d,f)}return"string"==typeof f&&""!==f||"number"==typeof f?(f=""+f,null!==p&&6===p.tag?(n(d,p.sibling),(p=i(p,f)).return=d,d=p):(n(d,p),(p=ia(f,d.mode,_)).return=d,d=p),a(d)):n(d,p)}}var or=ir(!0),sr=ir(!1),ar={},lr=st(ar),cr=st(ar),ur=st(ar);function hr(e){if(e===ar)throw Error(s(174));return e}function dr(e,t){lt(ur,t),lt(cr,e),lt(lr,ar),e=N(t),at(lr),lt(lr,e)}function pr(){at(lr),at(cr),at(ur)}function fr(e){var t=hr(ur.current),n=hr(lr.current);n!==(t=P(n,e.type,t))&&(lt(cr,e),lt(lr,t))}function mr(e){cr.current===e&&(at(lr),at(cr))}var gr=st(0);function vr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||De(n)||$e(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _r=[];function br(){for(var e=0;e<_r.length;e++){var t=_r[e];X?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}_r.length=0}var yr=a.ReactCurrentDispatcher,Tr=a.ReactCurrentBatchConfig,Er=0,Sr=null,wr=null,xr=null,Mr=!1,Cr=!1,Ir=0,kr=0;function Rr(){throw Error(s(321))}function Ar(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wt(e[n],t[n]))return!1;return!0}function Lr(e,t,n,r,i,o){if(Er=o,Sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yr.current=null===e||null===e.memoizedState?fi:mi,e=n(r,i),Cr){o=0;do{if(Cr=!1,Ir=0,25<=o)throw Error(s(301));o+=1,xr=wr=null,t.updateQueue=null,yr.current=gi,e=n(r,i)}while(Cr)}if(yr.current=pi,t=null!==wr&&null!==wr.next,Er=0,xr=wr=Sr=null,Mr=!1,t)throw Error(s(300));return e}function Or(){var e=0!==Ir;return Ir=0,e}function Nr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xr?Sr.memoizedState=xr=e:xr=xr.next=e,xr}function Pr(){if(null===wr){var e=Sr.alternate;e=null!==e?e.memoizedState:null}else e=wr.next;var t=null===xr?Sr.memoizedState:xr.next;if(null!==t)xr=t,wr=e;else{if(null===e)throw Error(s(310));e={memoizedState:(wr=e).memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},null===xr?Sr.memoizedState=xr=e:xr=xr.next=e}return xr}function Dr(e,t){return"function"==typeof t?t(e):t}function $r(e){var t=Pr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=wr,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((Er&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,Sr.lanes|=h,ns|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,Wt(r,t.memoizedState)||(Di=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,Sr.lanes|=o,ns|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Br(e){var t=Pr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Wt(o,t.memoizedState)||(Di=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Fr(){}function Ur(e,t){var n=Sr,r=Pr(),i=t(),o=!Wt(r.memoizedState,i);if(o&&(r.memoizedState=i,Di=!0),r=r.queue,Jr(Gr.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==xr&&1&xr.memoizedState.tag){if(n.flags|=2048,jr(9,Hr.bind(null,n,r,i,t),void 0,null),null===Ko)throw Error(s(349));0!==(30&Er)||zr(n,t,i)}return i}function zr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Sr.updateQueue)?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Hr(e,t,n,r){t.value=n,t.getSnapshot=r,Vr(t)&&Ss(e,1,-1)}function Gr(e,t,n){return n((function(){Vr(t)&&Ss(e,1,-1)}))}function Vr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wt(e,n)}catch{return!0}}function Wr(e){var t=Nr();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dr,lastRenderedState:e},t.queue=e,e=e.dispatch=li.bind(null,Sr,e),[t.memoizedState,e]}function jr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Sr.updateQueue)?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Xr(){return Pr().memoizedState}function Yr(e,t,n,r){var i=Nr();Sr.flags|=e,i.memoizedState=jr(1|t,n,void 0,void 0===r?null:r)}function Kr(e,t,n,r){var i=Pr();r=void 0===r?null:r;var o=void 0;if(null!==wr){var s=wr.memoizedState;if(o=s.destroy,null!==r&&Ar(r,s.deps))return void(i.memoizedState=jr(t,n,o,r))}Sr.flags|=e,i.memoizedState=jr(1|t,n,o,r)}function qr(e,t){return Yr(8390656,8,e,t)}function Jr(e,t){return Kr(2048,8,e,t)}function Zr(e,t){return Kr(4,2,e,t)}function Qr(e,t){return Kr(4,4,e,t)}function ei(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ti(e,t,n){return n=null!=n?n.concat([e]):null,Kr(4,4,ei.bind(null,t,e),n)}function ni(){}function ri(e,t){var n=Pr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ar(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ii(e,t){var n=Pr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ar(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function oi(e,t){var n=Lt;Lt=0!==n&&4>n?n:4,e(!0);var r=Tr.transition;Tr.transition={};try{e(!1),t()}finally{Lt=n,Tr.transition=r}}function si(){return Pr().memoizedState}function ai(e,t,n){var r=Es(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ci(e)?ui(t,n):(hi(e,t,n),null!==(e=Ss(e,r,n=Ts()))&&di(e,t,r))}function li(e,t,n){var r=Es(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ci(e))ui(t,i);else{hi(e,t,i);var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Wt(a,s))return}catch{}null!==(e=Ss(e,r,n=Ts()))&&di(e,t,r)}}function ci(e){var t=e.alternate;return e===Sr||null!==t&&t===Sr}function ui(e,t){Cr=Mr=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hi(e,t,n){null!==Ko&&0!==(1&e.mode)&&0===(2&Yo)?(null===(e=t.interleaved)?(n.next=n,null===dn?dn=[t]:dn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function di(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,At(e,n)}}var pi={readContext:hn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},fi={readContext:hn,useCallback:function(e,t){return Nr().memoizedState=[e,void 0===t?null:t],e},useContext:hn,useEffect:qr,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Yr(4194308,4,ei.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Yr(4,2,e,t)},useMemo:function(e,t){var n=Nr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Nr();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ai.bind(null,Sr,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Nr().memoizedState=e},useState:Wr,useDebugValue:ni,useDeferredValue:function(e){var t=Wr(e),n=t[0],r=t[1];return qr((function(){var t=Tr.transition;Tr.transition={};try{r(e)}finally{Tr.transition=t}}),[e]),n},useTransition:function(){var e=Wr(!1),t=e[0];return e=oi.bind(null,e[1]),Nr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Sr,i=Nr();if(Vn){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Ko)throw Error(s(349));0!==(30&Er)||zr(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,qr(Gr.bind(null,r,o,e),[e]),r.flags|=2048,jr(9,Hr.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Nr(),t=Ko.identifierPrefix;if(Vn){var n=$n;t=":"+t+"R"+(n=(Dn&~(1<<32-yt(Dn)-1)).toString(32)+n),0<(n=Ir++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=kr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},mi={readContext:hn,useCallback:ri,useContext:hn,useEffect:Jr,useImperativeHandle:ti,useInsertionEffect:Zr,useLayoutEffect:Qr,useMemo:ii,useReducer:$r,useRef:Xr,useState:function(){return $r(Dr)},useDebugValue:ni,useDeferredValue:function(e){var t=$r(Dr),n=t[0],r=t[1];return Jr((function(){var t=Tr.transition;Tr.transition={};try{r(e)}finally{Tr.transition=t}}),[e]),n},useTransition:function(){return[$r(Dr)[0],Pr().memoizedState]},useMutableSource:Fr,useSyncExternalStore:Ur,useId:si,unstable_isNewReconciler:!1},gi={readContext:hn,useCallback:ri,useContext:hn,useEffect:Jr,useImperativeHandle:ti,useInsertionEffect:Zr,useLayoutEffect:Qr,useMemo:ii,useReducer:Br,useRef:Xr,useState:function(){return Br(Dr)},useDebugValue:ni,useDeferredValue:function(e){var t=Br(Dr),n=t[0],r=t[1];return Jr((function(){var t=Tr.transition;Tr.transition={};try{r(e)}finally{Tr.transition=t}}),[e]),n},useTransition:function(){return[Br(Dr)[0],Pr().memoizedState]},useMutableSource:Fr,useSyncExternalStore:Ur,useId:si,unstable_isNewReconciler:!1};function vi(e,t){try{var n="",r=t;do{n+=Qt(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i}}function _i(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var bi,yi,Ti,Ei,Si="function"==typeof WeakMap?WeakMap:Map;function wi(e,t,n){(n=gn(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){hs||(hs=!0,ds=r),_i(0,t)},n}function xi(e,t,n){(n=gn(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){_i(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){_i(0,t),"function"!=typeof r&&(null===ps?ps=new Set([this]):ps.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Mi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Si;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=js.bind(null,e,t,n),t.then(e,e))}function Ci(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ii(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=gn(-1,1)).tag=2,vn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}function ki(e){e.flags|=4}function Ri(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(Y)bi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)F(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},yi=function(){},Ti=function(e,t,n,r,i){if((e=e.memoizedProps)!==r){var o=t.stateNode,s=hr(lr.current);n=z(o,n,e,r,i,s),(t.updateQueue=n)&&ki(t)}},Ei=function(e,t,n,r){n!==r&&ki(t)};else if(K){bi=function(e,t,n,r){for(var i=t.child;null!==i;){if(5===i.tag){var o=i.stateNode;n&&r&&(o=Ae(o,i.type,i.memoizedProps,i)),F(e,o)}else if(6===i.tag)o=i.stateNode,n&&r&&(o=Le(o,i.memoizedProps,i)),F(e,o);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(o=i.child)&&(o.return=i),bi(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};var Ai=function(e,t,n,r){for(var i=t.child;null!==i;){if(5===i.tag){var o=i.stateNode;n&&r&&(o=Ae(o,i.type,i.memoizedProps,i)),Ie(e,o)}else if(6===i.tag)o=i.stateNode,n&&r&&(o=Le(o,i.memoizedProps,i)),Ie(e,o);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(o=i.child)&&(o.return=i),Ai(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};yi=function(e,t){var n=t.stateNode;if(!Ri(e,t)){e=n.containerInfo;var r=Ce(e);Ai(r,t,!1,!1),n.pendingChildren=r,ki(t),ke(e,r)}},Ti=function(e,t,n,r,i){var o=e.stateNode,s=e.memoizedProps;if((e=Ri(e,t))&&s===r)t.stateNode=o;else{var a=t.stateNode,l=hr(lr.current),c=null;s!==r&&(c=z(a,n,s,r,i,l)),e&&null===c?t.stateNode=o:(o=Me(o,c,n,s,r,t,e,a),U(o,n,r,i,l)&&ki(t),t.stateNode=o,e?ki(t):bi(o,t,!1,!1))}},Ei=function(e,t,n,r){n!==r?(e=hr(ur.current),n=hr(lr.current),t.stateNode=G(r,e,n,t),ki(t)):t.stateNode=e.stateNode}}else yi=function(){},Ti=function(){},Ei=function(){};function Li(e,t){if(!Vn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Oi(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ni(e,t,n){var r=t.pendingProps;switch(zn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oi(t),null;case 1:case 17:return ft(t.type)&&mt(),Oi(t),null;case 3:return r=t.stateNode,pr(),at(ht),at(ut),br(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(null===e||null===e.child)&&(Zn(t)?ki(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==jn&&(Is(jn),jn=null))),yi(e,t),Oi(t),null;case 5:mr(t),n=hr(ur.current);var i=t.type;if(null!==e&&null!=t.stateNode)Ti(e,t,i,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Oi(t),null}if(e=hr(lr.current),Zn(t)){if(!q)throw Error(s(175));e=Ge(t.stateNode,t.type,t.memoizedProps,n,e,t,!Wn),t.updateQueue=e,null!==e&&ki(t)}else{var o=B(i,r,n,e,t);bi(o,t,!1,!1),t.stateNode=o,U(o,i,r,n,e)&&ki(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Oi(t),null;case 6:if(e&&null!=t.stateNode)Ei(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));if(e=hr(ur.current),n=hr(lr.current),Zn(t)){if(!q)throw Error(s(176));if(e=t.stateNode,r=t.memoizedProps,(n=Ve(e,r,t,!Wn))&&null!==(i=Hn))switch(o=0!==(1&i.mode),i.tag){case 3:Ze(i.stateNode.containerInfo,e,r,o);break;case 5:Qe(i.type,i.memoizedProps,i.stateNode,e,r,o)}n&&ki(t)}else t.stateNode=G(r,e,n,t)}return Oi(t),null;case 13:if(at(gr),r=t.memoizedState,Vn&&null!==Gn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Gn;e;)e=Fe(e);return Qn(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Zn(t),null===e){if(!r)throw Error(s(318));if(!q)throw Error(s(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(s(317));We(e,t)}else Qn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Oi(t),null}return null!==jn&&(Is(jn),jn=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Zn(t):n=null!==e.memoizedState,r&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&gr.current)?0===es&&(es=3):Ds())),null!==t.updateQueue&&(t.flags|=4),Oi(t),null);case 4:return pr(),yi(e,t),null===e&&Z(t.stateNode.containerInfo),Oi(t),null;case 10:return ln(t.type._context),Oi(t),null;case 19:if(at(gr),null===(i=t.memoizedState))return Oi(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)Li(i,!1);else{if(0!==es||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=vr(e))){for(t.flags|=128,Li(i,!1),null!==(e=o.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,r=t.child;null!==r;)i=e,(n=r).flags&=14680066,null===(o=n.alternate)?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext}),r=r.sibling;return lt(gr,1&gr.current|2),t.child}e=e.sibling}null!==i.tail&&Bt()>ls&&(t.flags|=128,r=!0,Li(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=vr(o))){if(t.flags|=128,r=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Li(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!Vn)return Oi(t),null}else 2*Bt()-i.renderingStartTime>ls&&1073741824!==n&&(t.flags|=128,r=!0,Li(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Bt(),t.sibling=null,e=gr.current,lt(gr,r?1&e|2:1&e),t):(Oi(t),null);case 22:case 23:return Ls(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Zo)&&(Oi(t),Y&&6&t.subtreeFlags&&(t.flags|=8192)):Oi(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}var Pi=a.ReactCurrentOwner,Di=!1;function $i(e,t,n,r){t.child=null===e?sr(t,null,n,r):or(t,e.child,n,r)}function Bi(e,t,n,r,i){n=n.render;var o=t.ref;return un(t,i),r=Lr(e,t,n,r,o,i),n=Or(),null===e||Di?(Vn&&n&&Un(t),t.flags|=1,$i(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,io(e,t,i))}function Fi(e,t,n,r,i){if(null===e){var o=n.type;return"function"!=typeof o||Qs(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ta(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ui(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:Zt)(s,r)&&e.ref===t.ref)return io(e,t,i)}return t.flags|=1,(e=ea(o,r)).ref=t.ref,e.return=t,t.child=e}function Ui(e,t,n,r,i){if(null!==e&&Zt(e.memoizedProps,r)&&e.ref===t.ref){if(Di=!1,0===(e.lanes&i))return t.lanes=e.lanes,io(e,t,i);0!==(131072&e.flags)&&(Di=!0)}return Gi(e,t,n,r,i)}function zi(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(Qo,Zo),Zo|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(Qo,Zo),Zo|=e,null;t.memoizedState={baseLanes:0,cachePool:null},r=null!==o?o.baseLanes:n,lt(Qo,Zo),Zo|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,lt(Qo,Zo),Zo|=r;return $i(e,t,i,n),t.child}function Hi(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Gi(e,t,n,r,i){var o=ft(n)?dt:ut.current;return o=pt(t,o),un(t,i),n=Lr(e,t,n,r,o,i),r=Or(),null===e||Di?(Vn&&r&&Un(t),t.flags|=1,$i(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,io(e,t,i))}function Vi(e,t,n,r,i){if(ft(n)){var o=!0;_t(t)}else o=!1;if(un(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Mn(t,n,r),In(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"==typeof c&&null!==c?c=hn(c):c=pt(t,c=ft(n)?dt:ut.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&Cn(t,s,r,c),pn=!1;var d=t.memoizedState;s.state=d,yn(t,r,s,i),l=t.memoizedState,a!==r||d!==l||ht.current||pn?("function"==typeof u&&(Sn(t,n,u,r),l=t.memoizedState),(a=pn||xn(t,n,a,r,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,mn(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:en(t.type,a),s.props=c,h=t.pendingProps,d=s.context,"object"==typeof(l=n.contextType)&&null!==l?l=hn(l):l=pt(t,l=ft(n)?dt:ut.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==h||d!==l)&&Cn(t,s,r,l),pn=!1,d=t.memoizedState,s.state=d,yn(t,r,s,i);var f=t.memoizedState;a!==h||d!==f||ht.current||pn?("function"==typeof p&&(Sn(t,n,p,r),f=t.memoizedState),(c=pn||xn(t,n,c,r,d,f,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Wi(e,t,n,r,o,i)}function Wi(e,t,n,r,i,o){Hi(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&bt(t,n,!1),io(e,t,o);r=t.stateNode,Pi.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=or(t,e.child,null,o),t.child=or(t,null,a,o)):$i(e,t,a,o),t.memoizedState=r.state,i&&bt(t,n,!0),t.child}function ji(e){var t=e.stateNode;t.pendingContext?gt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&gt(0,t.context,!1),dr(e,t.containerInfo)}function Xi(e,t,n,r,i){return Qn(),er(i),t.flags|=256,$i(e,t,n,r),t.child}var Yi={dehydrated:null,treeContext:null,retryLane:0};function Ki(e){return{baseLanes:e,cachePool:null}}function qi(e,t,n){var r,i=t.pendingProps,o=gr.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(o|=1),lt(gr,1&o),null===e)return qn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:$e(e)?t.lanes=8:t.lanes=1073741824,null):(o=i.children,e=i.fallback,a?(i=t.mode,a=t.child,o={mode:"hidden",children:o},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=o):a=ra(o,i,0,null),e=na(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ki(n),t.memoizedState=Yi,e):Ji(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,eo(e,t,n,Error(s(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,o=t.mode,i=ra({mode:"visible",children:i.children},o,0,null),(a=na(a,o,n,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&or(t,e.child,null,n),t.child.memoizedState=Ki(n),t.memoizedState=Yi,a);if(0===(1&t.mode))t=eo(e,t,n,null);else if($e(r))t=eo(e,t,n,Error(s(419)));else if(i=0!==(n&e.childLanes),Di||i){if(null!==(i=Ko)){switch(n&-n){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(i=0!==(a&(i.suspendedLanes|n))?0:a)&&i!==o.retryLane&&(o.retryLane=i,Ss(e,i,-1))}Ds(),t=eo(e,t,n,Error(s(421)))}else De(r)?(t.flags|=128,t.child=e.child,t=Ys.bind(null,e),Be(r,t),t=null):(n=o.treeContext,q&&(Gn=He(r),Hn=t,Vn=!0,jn=null,Wn=!1,null!==n&&(On[Nn++]=Dn,On[Nn++]=$n,On[Nn++]=Pn,Dn=n.id,$n=n.overflow,Pn=t)),(t=Ji(t,t.pendingProps.children)).flags|=4096);return t}return a?(i=Qi(e,t,i.children,i.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?Ki(n):{baseLanes:o.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Yi,i):(n=Zi(e,t,i.children,n),t.memoizedState=null,n)}return a?(i=Qi(e,t,i.children,i.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?Ki(n):{baseLanes:o.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Yi,i):(n=Zi(e,t,i.children,n),t.memoizedState=null,n)}function Ji(e,t){return(t=ra({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Zi(e,t,n,r){var i=e.child;return e=i.sibling,n=ea(i,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function Qi(e,t,n,r,i){var o=t.mode,s=(e=e.child).sibling,a={mode:"hidden",children:n};return 0===(1&o)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=a,t.deletions=null):(n=ea(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==s?r=ea(s,r):(r=na(r,o,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function eo(e,t,n,r){return null!==r&&er(r),or(t,e.child,null,n),(e=Ji(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function to(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),cn(e.return,t,n)}function no(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function ro(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if($i(e,t,r.children,n),0!==(2&(r=gr.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&to(e,n,t);else if(19===e.tag)to(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(lt(gr,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===vr(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),no(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===vr(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}no(t,!0,n,null,o);break;case"together":no(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function io(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ns|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=ea(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ea(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function oo(e,t){switch(zn(t),t.tag){case 1:return ft(t.type)&&mt(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return pr(),at(ht),at(ut),br(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return mr(t),null;case 13:if(at(gr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));Qn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return at(gr),null;case 4:return pr(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Ls(),null;default:return null}}var so=!1,ao=!1,lo="function"==typeof WeakSet?WeakSet:Set,co=null;function uo(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(r){Ws(e,t,r)}else n.current=null}function ho(e,t,n){try{n()}catch(r){Ws(e,t,r)}}var po=!1;function fo(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&ho(t,n,o)}i=i.next}while(i!==r)}}function mo(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function go(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=O(n);else e=n;"function"==typeof t?t(e):t.current=e}}function vo(e,t,n){if(Vt&&"function"==typeof Vt.onCommitFiberUnmount)try{Vt.onCommitFiberUnmount(Gt,t)}catch{}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var i=r,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&ho(t,n,o),r=r.next}while(r!==e)}break;case 1:if(uo(t,n),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(s){Ws(t,n,s)}break;case 5:uo(t,n);break;case 4:Y?xo(e,t,n):K&&K&&(t=t.stateNode.containerInfo,n=Ce(t),Re(t,n))}}function _o(e,t,n){for(var r=t;;)if(vo(e,r,n),null===r.child||Y&&4===r.tag){if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function bo(e){var t=e.alternate;null!==t&&(e.alternate=null,bo(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yo(e){return 5===e.tag||3===e.tag||4===e.tag}function To(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||yo(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Eo(e){if(Y){e:{for(var t=e.return;null!==t;){if(yo(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(ye(t),n.flags&=-33),wo(e,n=To(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,So(e,n=To(e),t);break;default:throw Error(s(161))}}}function So(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ve(n,e,t):de(n,e);else if(4!==r&&null!==(e=e.child))for(So(e,t,n),e=e.sibling;null!==e;)So(e,t,n),e=e.sibling}function wo(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ge(n,e,t):he(n,e);else if(4!==r&&null!==(e=e.child))for(wo(e,t,n),e=e.sibling;null!==e;)wo(e,t,n),e=e.sibling}function xo(e,t,n){for(var r,i,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag)_o(e,o,n),i?be(r,o.stateNode):_e(r,o.stateNode);else if(18===o.tag)i?qe(r,o.stateNode):Ke(r,o.stateNode);else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(vo(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function Mo(e,t){if(Y){switch(t.tag){case 0:case 11:case 14:case 15:return fo(3,t,t.return),mo(3,t),void fo(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var i=t.type,o=t.updateQueue;t.updateQueue=null,null!==o&&me(n,o,i,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(s(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(q&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo));case 13:case 19:return void Co(t)}throw Error(s(163))}switch(t.tag){case 0:case 11:case 14:case 15:return fo(3,t,t.return),mo(3,t),void fo(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Co(t);case 3:q&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo)}e:if(K){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Re(t.containerInfo,t.pendingChildren);break e}throw Error(s(163))}}function Co(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new lo),t.forEach((function(t){var r=Ks.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Io(e,t,n){co=e,ko(e)}function ko(e,t,n){for(var r=0!==(1&e.mode);null!==co;){var i=co,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||so;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||ao;a=so;var c=ao;if(so=s,(ao=l)&&!c)for(co=i;null!==co;)l=(s=co).child,22===s.tag&&null!==s.memoizedState?Lo(i):null!==l?(l.return=s,co=l):Lo(i);for(;null!==o;)co=o,ko(o),o=o.sibling;co=i,so=a,ao=c}Ro(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,co=o):Ro(e)}}function Ro(e){for(;null!==co;){var t=co;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:ao||mo(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!ao)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Tn(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=O(t.child.stateNode);break;case 1:n=t.child.stateNode}Tn(t,a,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&fe(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(q&&null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ye(h)}}}break;default:throw Error(s(163))}ao||512&t.flags&&go(t)}catch(d){Ws(t,t.return,d)}}if(t===e){co=null;break}if(null!==(n=t.sibling)){n.return=t.return,co=n;break}co=t.return}}function Ao(e){for(;null!==co;){var t=co;if(t===e){co=null;break}var n=t.sibling;if(null!==n){n.return=t.return,co=n;break}co=t.return}}function Lo(e){for(;null!==co;){var t=co;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{mo(4,t)}catch(l){Ws(t,n,l)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ws(t,i,l)}}var o=t.return;try{go(t)}catch(l){Ws(t,o,l)}break;case 5:var s=t.return;try{go(t)}catch(l){Ws(t,s,l)}}}catch(l){Ws(t,t.return,l)}if(t===e){co=null;break}var a=t.sibling;if(null!==a){a.return=t.return,co=a;break}co=t.return}}var Oo=0,No=1,Po=2,Do=3,$o=4;if("function"==typeof Symbol&&Symbol.for){var Bo=Symbol.for;Oo=Bo("selector.component"),No=Bo("selector.has_pseudo_class"),Po=Bo("selector.role"),Do=Bo("selector.test_id"),$o=Bo("selector.text")}function Fo(e){var t=J(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(s(364));return t}if(null===(e=ie(e)))throw Error(s(362));return e.stateNode.current}function Uo(e,t){switch(t.$$typeof){case Oo:if(e.type===t.value)return!0;break;case No:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],i=e[n++],o=t[i];if(5!==r.tag||!ae(r)){for(;null!=o&&Uo(r,o);)o=t[++i];if(i===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,i),r=r.sibling}}t=!1}return t;case Po:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case $o:if((5===e.tag||6===e.tag)&&(null!==(e=se(e))&&0<=e.indexOf(t.value)))return!0;break;case Do:if(5===e.tag&&("string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function zo(e){switch(e.$$typeof){case Oo:return"<"+(S(e.value)||"Unknown")+">";case No:return":has("+(zo(e)||"")+")";case Po:return'[role="'+e.value+'"]';case $o:return'"'+e.value+'"';case Do:return'[data-testname="'+e.value+'"]';default:throw Error(s(365))}}function Ho(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],o=e[r++],s=t[o];if(5!==i.tag||!ae(i)){for(;null!=s&&Uo(i,s);)s=t[++o];if(o===t.length)n.push(i);else for(i=i.child;null!==i;)e.push(i,o),i=i.sibling}}return n}function Go(e,t){if(!re)throw Error(s(363));e=Ho(e=Fo(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)ae(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var Vo=Math.ceil,Wo=a.ReactCurrentDispatcher,jo=a.ReactCurrentOwner,Xo=a.ReactCurrentBatchConfig,Yo=0,Ko=null,qo=null,Jo=0,Zo=0,Qo=st(0),es=0,ts=null,ns=0,rs=0,is=0,os=null,ss=null,as=0,ls=1/0;function cs(){ls=Bt()+500}var us,hs=!1,ds=null,ps=null,fs=!1,ms=null,gs=0,vs=0,_s=null,bs=-1,ys=0;function Ts(){return 0!==(6&Yo)?Bt():-1!==bs?bs:bs=Bt()}function Es(e){return 0===(1&e.mode)?1:0!==(2&Yo)&&0!==Jo?Jo&-Jo:null!==Jt.transition?(0===ys&&(e=St,0===(4194240&(St<<=1))&&(St=64),ys=e),ys):0!==(e=Lt)?e:Q()}function Ss(e,t,n){if(50<vs)throw vs=0,_s=null,Error(s(185));var r=ws(e,t);return null===r?null:(Rt(r,t,n),(0===(2&Yo)||r!==Ko)&&(r===Ko&&(0===(2&Yo)&&(rs|=t),4===es&&ks(r,Jo)),xs(r,n),1===t&&0===Yo&&0===(1&e.mode)&&(cs(),Xt&&qt())),r)}function ws(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function xs(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-yt(o),a=1<<s,l=i[s];-1===l?(0===(a&n)||0!==(a&r))&&(i[s]=Ct(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=Mt(e,e===Ko?Jo:0);if(0===r)null!==n&&Pt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Pt(n),1===t)0===e.tag?function(e){Xt=!0,Kt(e)}(Rs.bind(null,e)):Kt(Rs.bind(null,e)),te?ne((function(){0===Yo&&qt()})):Nt(Ft,qt),n=null;else{switch(Ot(r)){case 1:n=Ft;break;case 4:n=Ut;break;case 16:default:n=zt;break;case 536870912:n=Ht}n=qs(n,Ms.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ms(e,t){if(bs=-1,ys=0,0!==(6&Yo))throw Error(s(327));var n=e.callbackNode;if(Gs()&&e.callbackNode!==n)return null;var r=Mt(e,e===Ko?Jo:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=$s(e,r);else{t=r;var i=Yo;Yo|=2;var o=Ps();for((Ko!==e||Jo!==t)&&(cs(),Os(e,t));;)try{Fs();break}catch(l){Ns(e,l)}sn(),Wo.current=o,Yo=i,null!==qo?t=0:(Ko=null,Jo=0,t=es)}if(0!==t){if(2===t&&(0!==(i=It(e))&&(r=i,t=Cs(e,i))),1===t)throw n=ts,Os(e,0),ks(e,r),xs(e,Bt()),n;if(6===t)ks(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Wt(o(),i))return!1}catch{return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=$s(e,r))&&(0!==(o=It(e))&&(r=o,t=Cs(e,o))),1===t))throw n=ts,Os(e,0),ks(e,r),xs(e,Bt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Hs(e,ss);break;case 3:if(ks(e,r),(130023424&r)===r&&10<(t=as+500-Bt())){if(0!==Mt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Ts(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=V(Hs.bind(null,e,ss),t);break}Hs(e,ss);break;case 4:if(ks(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-yt(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Bt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Vo(r/1960))-r)){e.timeoutHandle=V(Hs.bind(null,e,ss),r);break}Hs(e,ss);break;default:throw Error(s(329))}}}return xs(e,Bt()),e.callbackNode===n?Ms.bind(null,e):null}function Cs(e,t){var n=os;return e.current.memoizedState.isDehydrated&&(Os(e,t).flags|=256),2!==(e=$s(e,t))&&(t=ss,ss=n,null!==t&&Is(t)),e}function Is(e){null===ss?ss=e:ss.push.apply(ss,e)}function ks(e,t){for(t&=~is,t&=~rs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yt(t),r=1<<n;e[n]=-1,t&=~r}}function Rs(e){if(0!==(6&Yo))throw Error(s(327));Gs();var t=Mt(e,0);if(0===(1&t))return xs(e,Bt()),null;var n=$s(e,t);if(0!==e.tag&&2===n){var r=It(e);0!==r&&(t=r,n=Cs(e,r))}if(1===n)throw n=ts,Os(e,0),ks(e,t),xs(e,Bt()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Hs(e,ss),xs(e,Bt()),null}function As(e){null!==ms&&0===ms.tag&&0===(6&Yo)&&Gs();var t=Yo;Yo|=1;var n=Xo.transition,r=Lt;try{if(Xo.transition=null,Lt=1,e)return e()}finally{Lt=r,Xo.transition=n,0===(6&(Yo=t))&&qt()}}function Ls(){Zo=Qo.current,at(Qo)}function Os(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==j&&(e.timeoutHandle=j,W(n)),null!==qo)for(n=qo.return;null!==n;){var r=n;switch(zn(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&mt();break;case 3:pr(),at(ht),at(ut),br();break;case 5:mr(r);break;case 4:pr();break;case 13:case 19:at(gr);break;case 10:ln(r.type._context);break;case 22:case 23:Ls()}n=n.return}if(Ko=e,qo=e=ea(e.current,null),Jo=Zo=t,es=0,ts=null,is=rs=ns=0,ss=os=null,null!==dn){for(t=0;t<dn.length;t++)if(null!==(r=(n=dn[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}dn=null}return e}function Ns(e,t){for(;;){var n=qo;try{if(sn(),yr.current=pi,Mr){for(var r=Sr.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}Mr=!1}if(Er=0,xr=wr=Sr=null,Cr=!1,Ir=0,jo.current=null,null===n||null===n.return){es=1,ts=t,qo=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Jo,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=Ci(a);if(null!==f){f.flags&=-257,Ii(f,a,l,0,t),1&f.mode&&Mi(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){Mi(o,u,t),Ds();break e}c=Error(s(426))}else if(Vn&&1&l.mode){var v=Ci(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Ii(v,a,l,0,t),er(c);break e}}o=c,4!==es&&(es=2),null===os?os=[o]:os.push(o),c=vi(c,l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,bn(l,wi(0,c,t));break e;case 1:o=c;var _=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"==typeof _.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===ps||!ps.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,bn(l,xi(l,o,t));break e}}l=l.return}while(null!==l)}zs(n)}catch(y){t=y,qo===n&&null!==n&&(qo=n=n.return);continue}break}}function Ps(){var e=Wo.current;return Wo.current=pi,null===e?pi:e}function Ds(){(0===es||3===es||2===es)&&(es=4),null===Ko||0===(268435455&ns)&&0===(268435455&rs)||ks(Ko,Jo)}function $s(e,t){var n=Yo;Yo|=2;var r=Ps();for(Ko===e&&Jo===t||Os(e,t);;)try{Bs();break}catch(i){Ns(e,i)}if(sn(),Yo=n,Wo.current=r,null!==qo)throw Error(s(261));return Ko=null,Jo=0,es}function Bs(){for(;null!==qo;)Us(qo)}function Fs(){for(;null!==qo&&!Dt();)Us(qo)}function Us(e){var t=us(e.alternate,e,Zo);e.memoizedProps=e.pendingProps,null===t?zs(e):qo=t,jo.current=null}function zs(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ni(n,t,Zo)))return void(qo=n)}else{if(null!==(n=oo(n,t)))return n.flags&=32767,void(qo=n);if(null===e)return es=6,void(qo=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(qo=t);qo=t=e}while(null!==t);0===es&&(es=5)}function Hs(e,t){var n=Lt,r=Xo.transition;try{Xo.transition=null,Lt=1,function(e,t,n){do{Gs()}while(null!==ms);if(0!==(6&Yo))throw Error(s(327));var r=e.finishedWork,i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-yt(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,o),e===Ko&&(qo=Ko=null,Jo=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||fs||(fs=!0,qs(zt,(function(){return Gs(),null}))),o=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||o){o=Xo.transition,Xo.transition=null;var a=Lt;Lt=1;var l=Yo;Yo|=4,jo.current=null,function(e,t){for(D(e.containerInfo),co=t;null!==co;)if(t=(e=co).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,co=t;else for(;null!==co;){e=co;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var r=n.memoizedProps,i=n.memoizedState,o=e.stateNode,a=o.getSnapshotBeforeUpdate(e.elementType===e.type?r:en(e.type,r),i);o.__reactInternalSnapshotBeforeUpdate=a}break;case 3:Y&&xe(e.stateNode.containerInfo);break;default:throw Error(s(163))}}catch(l){Ws(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,co=t;break}co=e.return}n=po,po=!1}(e,r),function(e,t){for(co=t;null!==co;){var n=(t=co).deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e;Y?xo(o,i,t):_o(o,i,t);var s=i.alternate;null!==s&&(s.return=null),i.return=null}catch(T){Ws(i,t,T)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,co=n;else for(;null!==co;){t=co;try{var a=t.flags;if(32&a&&Y&&ye(t.stateNode),512&a){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"==typeof c?c(null):c.current=null)}}if(8192&a)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;(null===u||null===u.memoizedState)&&(as=Bt())}break;case 22:var h=null!==t.memoizedState,d=t.alternate,p=null!==d&&null!==d.memoizedState;if(n=t,Y)e:if(r=n,i=h,o=null,Y)for(var f=r;;){if(5===f.tag){if(null===o){o=f;var m=f.stateNode;i?Te(m):Se(f.stateNode,f.memoizedProps)}}else if(6===f.tag){if(null===o){var g=f.stateNode;i?Ee(g):we(g,f.memoizedProps)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===r)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===r)break;for(;null===f.sibling;){if(null===f.return||f.return===r)break e;o===f&&(o=null),f=f.return}o===f&&(o=null),f.sibling.return=f.return,f=f.sibling}if(h&&!p&&0!==(1&n.mode)){co=n;for(var v=n.child;null!==v;){for(n=co=v;null!==co;){var _=(r=co).child;switch(r.tag){case 0:case 11:case 14:case 15:fo(4,r,r.return);break;case 1:uo(r,r.return);var b=r.stateNode;if("function"==typeof b.componentWillUnmount){var y=r.return;try{b.props=r.memoizedProps,b.state=r.memoizedState,b.componentWillUnmount()}catch(T){Ws(r,y,T)}}break;case 5:uo(r,r.return);break;case 22:if(null!==r.memoizedState){Ao(n);continue}}null!==_?(_.return=r,co=_):Ao(n)}v=v.sibling}}}switch(4102&a){case 2:Eo(t),t.flags&=-3;break;case 6:Eo(t),t.flags&=-3,Mo(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,Mo(t.alternate,t);break;case 4:Mo(t.alternate,t)}}catch(T){Ws(t,t.return,T)}if(null!==(n=t.sibling)){n.return=t.return,co=n;break}co=t.return}}}(e,r),$(e.containerInfo),e.current=r,Io(r),$t(),Yo=l,Lt=a,Xo.transition=o}else e.current=r;if(fs&&(fs=!1,ms=e,gs=i),o=e.pendingLanes,0===o&&(ps=null),function(e){if(Vt&&"function"==typeof Vt.onCommitFiberRoot)try{Vt.onCommitFiberRoot(Gt,e,void 0,128===(128&e.current.flags))}catch{}}(r.stateNode),xs(e,Bt()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n(t[r]);if(hs)throw hs=!1,e=ds,ds=null,e;0!==(1&gs)&&0!==e.tag&&Gs(),o=e.pendingLanes,0!==(1&o)?e===_s?vs++:(vs=0,_s=e):vs=0,qt()}(e,t,n)}finally{Xo.transition=r,Lt=n}return null}function Gs(){if(null!==ms){var e=Ot(gs),t=Xo.transition,n=Lt;try{if(Xo.transition=null,Lt=16>e?16:e,null===ms)var r=!1;else{if(e=ms,ms=null,gs=0,0!==(6&Yo))throw Error(s(331));var i=Yo;for(Yo|=4,co=e.current;null!==co;){var o=co,a=o.child;if(0!==(16&co.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(co=u;null!==co;){var h=co;switch(h.tag){case 0:case 11:case 15:fo(8,h,o)}var d=h.child;if(null!==d)d.return=h,co=d;else for(;null!==co;){var p=(h=co).sibling,f=h.return;if(bo(h),h===u){co=null;break}if(null!==p){p.return=f,co=p;break}co=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}co=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,co=a;else e:for(;null!==co;){if(0!==(2048&(o=co).flags))switch(o.tag){case 0:case 11:case 15:fo(9,o,o.return)}var _=o.sibling;if(null!==_){_.return=o.return,co=_;break e}co=o.return}}var b=e.current;for(co=b;null!==co;){var y=(a=co).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,co=y;else e:for(a=b;null!==co;){if(0!==(2048&(l=co).flags))try{switch(l.tag){case 0:case 11:case 15:mo(9,l)}}catch(E){Ws(l,l.return,E)}if(l===a){co=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,co=T;break e}co=l.return}}if(Yo=i,qt(),Vt&&"function"==typeof Vt.onPostCommitFiberRoot)try{Vt.onPostCommitFiberRoot(Gt,e)}catch{}r=!0}return r}finally{Lt=n,Xo.transition=t}}return!1}function Vs(e,t,n){vn(e,t=wi(0,t=vi(n,t),1)),t=Ts(),null!==(e=ws(e,1))&&(Rt(e,1,t),xs(e,t))}function Ws(e,t,n){if(3===e.tag)Vs(e,e,n);else for(;null!==t;){if(3===t.tag){Vs(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ps||!ps.has(r))){vn(t,e=xi(t,e=vi(n,e),1)),e=Ts(),null!==(t=ws(t,1))&&(Rt(t,1,e),xs(t,e));break}}t=t.return}}function js(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ts(),e.pingedLanes|=e.suspendedLanes&n,Ko===e&&(Jo&n)===n&&(4===es||3===es&&(130023424&Jo)===Jo&&500>Bt()-as?Os(e,0):is|=n),xs(e,t)}function Xs(e,t){0===t&&(0===(1&e.mode)?t=1:(t=wt,0===(130023424&(wt<<=1))&&(wt=4194304)));var n=Ts();null!==(e=ws(e,t))&&(Rt(e,t,n),xs(e,n))}function Ys(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Xs(e,n)}function Ks(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Xs(e,n)}function qs(e,t){return Nt(e,t)}function Js(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zs(e,t,n,r){return new Js(e,t,n,r)}function Qs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ea(e,t){var n=e.alternate;return null===n?((n=Zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ta(e,t,n,r,i,o){var a=2;if(r=e,"function"==typeof e)Qs(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case u:return na(n.children,i,o,t);case h:a=8,i|=8;break;case d:return(e=Zs(12,n,t,2|i)).elementType=d,e.lanes=o,e;case g:return(e=Zs(13,n,t,i)).elementType=g,e.lanes=o,e;case v:return(e=Zs(19,n,t,i)).elementType=v,e.lanes=o,e;case y:return ra(n,i,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case p:a=10;break e;case f:a=9;break e;case m:a=11;break e;case _:a=14;break e;case b:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Zs(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function na(e,t,n,r){return(e=Zs(7,e,r,t)).lanes=n,e}function ra(e,t,n,r){return(e=Zs(22,e,r,t)).elementType=y,e.lanes=n,e.stateNode={},e}function ia(e,t,n){return(e=Zs(6,e,null,t)).lanes=n,e}function oa(e,t,n){return(t=Zs(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sa(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=j,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kt(0),this.expirationTimes=kt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kt(0),this.identifierPrefix=r,this.onRecoverableError=i,q&&(this.mutableSourceEagerHydrationData=null)}function aa(e,t,n,r,i,o,s,a,l){return e=new sa(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Zs(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null},fn(o),e}function la(e){if(!e)return ct;e:{if(x(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ft(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(ft(n))return vt(e,n,t)}return t}function ca(e){var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return null===(e=I(t))?null:e.stateNode}function ua(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ha(e,t){ua(e,t),(e=e.alternate)&&ua(e,t)}function da(e){return null===(e=I(e))?null:e.stateNode}function pa(){return null}return us=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ht.current)Di=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Di=!1,function(e,t,n){switch(t.tag){case 3:ji(t),Qn();break;case 5:fr(t);break;case 1:ft(t.type)&&_t(t);break;case 4:dr(t,t.stateNode.containerInfo);break;case 10:an(0,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(lt(gr,1&gr.current),t.flags|=128,null):0!==(n&t.child.childLanes)?qi(e,t,n):(lt(gr,1&gr.current),null!==(e=io(e,t,n))?e.sibling:null);lt(gr,1&gr.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return ro(e,t,n);t.flags|=128}var i=t.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),lt(gr,gr.current),r)break;return null;case 22:case 23:return t.lanes=0,zi(e,t,n)}return io(e,t,n)}(e,t,n);Di=0!==(131072&e.flags)}else Di=!1,Vn&&0!==(1048576&t.flags)&&Fn(t,Ln,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=pt(t,ut.current);un(t,n),i=Lr(null,t,r,e,i,n);var o=Or();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ft(r)?(o=!0,_t(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,fn(t),i.updater=wn,t.stateNode=i,i._reactInternals=t,In(t,r,e,n),t=Wi(null,t,r,!0,o,n)):(t.tag=0,Vn&&o&&Un(t),$i(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"==typeof e)return Qs(e)?1:0;if(null!=e){if((e=e.$$typeof)===m)return 11;if(e===_)return 14}return 2}(r),e=en(r,e),i){case 0:t=Gi(null,t,r,e,n);break e;case 1:t=Vi(null,t,r,e,n);break e;case 11:t=Bi(null,t,r,e,n);break e;case 14:t=Fi(null,t,r,en(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Gi(e,t,r,i=t.elementType===r?i:en(r,i),n);case 1:return r=t.type,i=t.pendingProps,Vi(e,t,r,i=t.elementType===r?i:en(r,i),n);case 3:e:{if(ji(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,mn(e,t),yn(t,r,null,n);var a=t.memoizedState;if(r=a.element,q&&o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Xi(e,t,r,n,i=Error(s(423)));break e}if(r!==i){t=Xi(e,t,r,n,i=Error(s(424)));break e}for(q&&(Gn=ze(t.stateNode.containerInfo),Hn=t,Vn=!0,jn=null,Wn=!1),n=sr(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Qn(),r===i){t=io(e,t,n);break e}$i(e,t,r,n)}t=t.child}return t;case 5:return fr(t),null===e&&qn(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,H(r,i)?a=null:null!==o&&H(r,o)&&(t.flags|=32),Hi(e,t),$i(e,t,a,n),t.child;case 6:return null===e&&qn(t),null;case 13:return qi(e,t,n);case 4:return dr(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=or(t,null,r,n):$i(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Bi(e,t,r,i=t.elementType===r?i:en(r,i),n);case 7:return $i(e,t,t.pendingProps,n),t.child;case 8:case 12:return $i(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,an(0,r,a=i.value),null!==o)if(Wt(o.value,a)){if(o.children===i.children&&!ht.current){t=io(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=gn(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),cn(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),cn(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}$i(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,un(t,n),r=r(i=hn(i)),t.flags|=1,$i(e,t,r,n),t.child;case 14:return i=en(r=t.type,t.pendingProps),Fi(e,t,r,i=en(r.type,i),n);case 15:return Ui(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:en(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ft(r)?(e=!0,_t(t)):e=!1,un(t,n),Mn(t,r,i),In(t,r,i,n),Wi(null,t,r,!0,e,n);case 19:return ro(e,t,n);case 22:return zi(e,t,n)}throw Error(s(156,t.tag))},n.attemptContinuousHydration=function(e){13===e.tag&&(Ss(e,134217728,Ts()),ha(e,134217728))},n.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Ts(),n=Es(e);Ss(e,n,t),ha(e,n)}},n.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=xt(t.pendingLanes);0!==n&&(At(t,1|n),xs(t,Bt()),0===(6&Yo)&&(cs(),qt()))}break;case 13:var r=Ts();As((function(){return Ss(e,1,r)})),ha(e,1)}},n.batchedUpdates=function(e,t){var n=Yo;Yo|=1;try{return e(t)}finally{0===(Yo=n)&&(cs(),Xt&&qt())}},n.createComponentSelector=function(e){return{$$typeof:Oo,value:e}},n.createContainer=function(e,t,n,r,i,o,s){return aa(e,t,!1,null,0,r,0,o,s)},n.createHasPseudoClassSelector=function(e){return{$$typeof:No,value:e}},n.createHydrationContainer=function(e,t,n,r,i,o,s,a,l){return(e=aa(n,r,!0,e,0,o,0,a,l)).context=la(null),n=e.current,(o=gn(r=Ts(),i=Es(n))).callback=null!=t?t:null,vn(n,o),e.current.lanes=i,Rt(e,i,r),xs(e,r),e},n.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},n.createRoleSelector=function(e){return{$$typeof:Po,value:e}},n.createTestNameSelector=function(e){return{$$typeof:Do,value:e}},n.createTextSelector=function(e){return{$$typeof:$o,value:e}},n.deferredUpdates=function(e){var t=Lt,n=Xo.transition;try{return Xo.transition=null,Lt=16,e()}finally{Lt=t,Xo.transition=n}},n.discreteUpdates=function(e,t,n,r,i){var o=Lt,s=Xo.transition;try{return Xo.transition=null,Lt=1,e(t,n,r,i)}finally{Lt=o,Xo.transition=s,0===Yo&&cs()}},n.findAllNodes=Go,n.findBoundingRects=function(e,t){if(!re)throw Error(s(363));t=Go(e,t),e=[];for(var n=0;n<t.length;n++)e.push(oe(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,i=r+n.width,o=n.y,a=o+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,h=u+c.width,d=c.y,p=d+c.height;if(r>=u&&o>=d&&i<=h&&a<=p){e.splice(t,1);break}if(!(r!==u||n.width!==c.width||p<o||d>a)){d>o&&(c.height+=d-o,c.y=o),p<a&&(c.height=a-d),e.splice(t,1);break}if(!(o!==d||n.height!==c.height||h<r||u>i)){u>r&&(c.width+=u-r,c.x=r),h<i&&(c.width=i-u),e.splice(t,1);break}}return e},n.findHostInstance=ca,n.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=C(e))?R(e):null)?null:e.stateNode},n.findHostInstanceWithWarning=function(e){return ca(e)},n.flushControlled=function(e){var t=Yo;Yo|=1;var n=Xo.transition,r=Lt;try{Xo.transition=null,Lt=1,e()}finally{Lt=r,Xo.transition=n,0===(Yo=t)&&(cs(),qt())}},n.flushPassiveEffects=Gs,n.flushSync=As,n.focusWithin=function(e,t){if(!re)throw Error(s(363));for(t=Ho(e=Fo(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ae(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Lt},n.getFindAllNodesFailureDescription=function(e,t){if(!re)throw Error(s(363));var n=0,r=[];e=[Fo(e),0];for(var i=0;i<e.length;){var o=e[i++],a=e[i++],l=t[a];if((5!==o.tag||!ae(o))&&(Uo(o,l)&&(r.push(zo(l)),++a>n&&(n=a)),a<t.length))for(o=o.child;null!==o;)e.push(o,a),o=o.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(zo(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},n.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?O(e.child.stateNode):e.child.stateNode:null},n.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:da,findFiberByHostInstance:e.findFiberByHostInstance||pa,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Gt=t.inject(e),Vt=t}catch{}e=!!t.checkDCE}}return e},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(e,t,n,r){if(!re)throw Error(s(363));e=Go(e,t);var i=ue(e,n,r).disconnect;return{disconnect:function(){i()}}},n.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},n.runWithPriority=function(e,t){var n=Lt;try{return Lt=e,t()}finally{Lt=n}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(e,t,n,r){var i=t.current,o=Ts(),s=Es(i);return n=la(n),null===t.context?t.context=n:t.pendingContext=n,(t=gn(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),vn(i,t),null!==(e=Ss(i,s,o))&&_n(e,i,s),s},n}),Td}!function(e){e.exports=(vd||(vd=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,s=o>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>i(l,n))c<o&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<o&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var i=n(c);null!==i;){if(null===i.callback)r(c);else{if(!(i.startTime<=e))break;r(c),i.sortIndex=i.expirationTime,t(l,i)}i=n(c)}}function y(e){if(m=!1,b(e),!f)if(null!==n(l))f=!0,L(T);else{var t=n(c);null!==t&&O(y,t.startTime-e)}}function T(t,i){f=!1,m&&(m=!1,v(x),x=-1),p=!0;var o=d;try{for(b(i),h=n(l);null!==h&&(!(h.expirationTime>i)||t&&!I());){var s=h.callback;if("function"==typeof s){h.callback=null,d=h.priorityLevel;var a=s(h.expirationTime<=i);i=e.unstable_now(),"function"==typeof a?h.callback=a:h===n(l)&&r(l),b(i)}else r(l);h=n(l)}if(null!==h)var u=!0;else{var g=n(c);null!==g&&O(y,g.startTime-i),u=!1}return u}finally{h=null,d=o,p=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,w=null,x=-1,M=5,C=-1;function I(){return!(e.unstable_now()-C<M)}function k(){if(null!==w){var t=e.unstable_now();C=t;var n=!0;try{n=w(!0,t)}finally{n?E():(S=!1,w=null)}}else S=!1}if("function"==typeof _)E=function(){_(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,A=R.port2;R.port1.onmessage=k,E=function(){A.postMessage(null)}}else E=function(){g(k,0)};function L(e){w=e,S||(S=!0,E())}function O(t,n){x=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,L(T))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_scheduleCallback=function(r,i,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,r){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return r={id:u++,callback:i,priorityLevel:r,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(r.sortIndex=o,t(c,r),null===n(l)&&r===n(c)&&(m?(v(x),x=-1):m=!0,O(y,o-s))):(r.sortIndex=a,t(l,r),f||p||(f=!0,L(T))),r},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}}(yd)),yd)}(bd);!function(e){e.exports=Sd()}(_d);const wd=hd(_d.exports);function xd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}const Md=[];const Cd=(e,t,n)=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(const o of Md)if(xd(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return o.response;if(!n)throw o.promise}const i={keys:t,equal:r.equal,promise:e(...t).then((e=>i.response=e)).then((()=>{r.lifespan&&r.lifespan>0&&setTimeout((()=>{const e=Md.indexOf(i);-1!==e&&Md.splice(e,1)}),r.lifespan)})).catch((e=>i.error=e))};if(Md.push(i),!n)throw i.promise}(e,t,!1,n);var Id,kd={exports:{}},Rd={};!function(t){t.exports=function(){if(Id)return Rd;Id=1;var t=e,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(e,t,r){var a,l={},c=null,u=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,a)&&!s.hasOwnProperty(a)&&(l[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===l[a]&&(l[a]=t[a]);return{$$typeof:n,type:e,key:c,ref:u,props:l,_owner:o.current}}return Rd.Fragment=r,Rd.jsx=a,Rd.jsxs=a,Rd}()}(kd);const Ad=kd.exports.Fragment,Ld=kd.exports.jsx,Od=kd.exports.jsxs,Nd={};var Pd,Dd;const $d=()=>{var e;return null!=(e=Nd.ColorManagement)?e:null},Bd=e=>e&&e.isOrthographicCamera,Fd=typeof window<"u"&&(null!=(Pd=window.document)&&Pd.createElement||"ReactNative"===(null==(Dd=window.navigator)?void 0:Dd.product))?e.useLayoutEffect:e.useEffect;function Ud(t){const n=e.useRef(t);return Fd((()=>{n.current=t}),[t]),n}function zd(e){let{set:t}=e;return Fd((()=>(t(new Promise((()=>null))),()=>t(!1))),[t]),null}class Hd extends e.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Hd.getDerivedStateFromError=()=>({error:!0});const Gd="__default",Vd=new Map,Wd=e=>e&&!!e.memoized&&!!e.changes;function jd(e){const t=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(e)?Math.min(Math.max(e[0],t),e[1]):e}const Xd=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},Yd={obj:e=>e===Object(e)&&!Yd.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:r="reference",strict:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(Yd.str(e)||Yd.num(e))return e===t;const o=Yd.obj(e);if(o&&"reference"===r)return e===t;const s=Yd.arr(e);if(s&&"reference"===n)return e===t;if((s||o)&&e===t)return!0;let a;for(a in e)if(!(a in t))return!1;if(o&&"shallow"===n&&"shallow"===r){for(a in i?t:e)if(!Yd.equ(e[a],t[a],{strict:i,objects:"reference"}))return!1}else for(a in i?t:e)if(e[a]!==t[a])return!1;if(Yd.und(a)){if(s&&0===e.length&&0===t.length||o&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function Kd(e,t){const n=e;return(null!=t&&t.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function qd(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),i=r.pop();return n=r.reduce(((e,t)=>e[t]),e),{target:n,key:i}}return{target:n,key:t}}const Jd=/-\d+$/;function Zd(e,t,n){if(Yd.str(n)){if(Jd.test(n)){const t=n.replace(Jd,""),{target:r,key:i}=qd(e,t);Array.isArray(r[i])||(r[i]=[])}const{target:r,key:i}=qd(e,n);t.__r3f.previousAttach=r[i],r[i]=t}else t.__r3f.previousAttach=n(e,t)}function Qd(e,t,n){var r,i;if(Yd.str(n)){const{target:r,key:i}=qd(e,n),o=t.__r3f.previousAttach;void 0===o?delete r[i]:r[i]=o}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(i=t.__r3f)||delete i.previousAttach}function ep(e,t){let{children:n,key:r,ref:i,...o}=t,{children:s,key:a,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var h;const d=null!=(h=null==e?void 0:e.__r3f)?h:{},p=Object.entries(o),f=[];if(u){const e=Object.keys(c);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||p.unshift([e[t],Gd+"remove"])}p.forEach((t=>{let[n,r]=t;var i;if(null!=(i=e.__r3f)&&i.primitive&&"object"===n||Yd.equ(r,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return f.push([n,r,!0,[]]);let s=[];n.includes("-")&&(s=n.split("-")),f.push([n,r,!1,s]);for(const e in o){const t=o[e];e.startsWith("".concat(n,"-"))&&f.push([e,t,!1,e.split("-")])}}));const m={...o};return d.memoizedProps&&d.memoizedProps.args&&(m.args=d.memoizedProps.args),d.memoizedProps&&d.memoizedProps.attach&&(m.attach=d.memoizedProps.attach),{memoized:m,changes:f}}function tp(e,t){var n,r,i;const o=null!=(n=e.__r3f)?n:{},s=o.root,a=null!=(r=null==s||null==s.getState?void 0:s.getState())?r:{},{memoized:l,changes:c}=Wd(t)?t:ep(e,t),u=o.eventCount;e.__r3f&&(e.__r3f.memoizedProps=l);for(let h=0;h<c.length;h++){let[t,n,r,i]=c[h],s=e,l=s[t];if(i.length&&(l=i.reduce(((e,t)=>e[t]),e),!l||!l.set)){const[n,...r]=i.reverse();s=r.reverse().reduce(((e,t)=>e[t]),e),t=n}if(n===Gd+"remove")if(s.constructor){let e=Vd.get(s.constructor);e||(e=new s.constructor,Vd.set(s.constructor,e)),n=e[t]}else n=0;if(r)n?o.handlers[t]=n:delete o.handlers[t],o.eventCount=Object.keys(o.handlers).length;else if(l&&l.set&&(l.copy||l instanceof lr)){if(Array.isArray(n))l.fromArray?l.fromArray(n):l.set(...n);else if(l.copy&&n&&n.constructor&&l.constructor===n.constructor)l.copy(n);else if(void 0!==n){const e=l instanceof ln;!e&&l.setScalar?l.setScalar(n):l instanceof lr&&n instanceof lr?l.mask=n.mask:l.set(n),!$d()&&!a.linear&&e&&l.convertSRGBToLinear()}}else s[t]=n,!a.linear&&s[t]instanceof fn&&s[t].format===ke&&s[t].type===ge&&(s[t].encoding=yt);np(e)}if(o.parent&&a.internal&&e.raycast&&u!==o.eventCount){const t=a.internal.interaction.indexOf(e);t>-1&&a.internal.interaction.splice(t,1),o.eventCount&&a.internal.interaction.push(e)}return!(1===c.length&&"onUpdate"===c[0][0])&&c.length&&null!=(i=e.__r3f)&&i.parent&&rp(e),e}function np(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function rp(e){null==e.onUpdate||e.onUpdate(e)}function ip(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function op(e,t,n,r){const i=n.get(t);i&&(n.delete(t),0===n.size&&(e.delete(r),i.target.releasePointerCapture(r)))}function sp(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const r=e.eventObject.__r3f,i=null==r?void 0:r.handlers;if(n.hovered.delete(ip(e)),null!=r&&r.eventCount){const n={...e,intersections:t};null==i.onPointerOut||i.onPointerOut(n),null==i.onPointerLeave||i.onPointerLeave(n)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))}))}}return function(o){const{onPointerMissed:s,internal:a}=e.getState();a.lastEvent.current=o;const l="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,u=function(t,n){const r=e.getState(),i=new Set,o=[],s=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<s.length;e++){const t=Xd(s[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let a=s.flatMap((function(e){const n=Xd(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r})).sort(((e,t)=>{const n=Xd(e.object),r=Xd(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=ip(e);return!i.has(t)&&(i.add(t),!0)}));r.events.filter&&(a=r.events.filter(a,r));for(const e of a){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&o.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())i.has(ip(e.intersection))||o.push(e.intersection);return o}(o,l?t:void 0),h=c?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],i=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}(o):0;"onPointerDown"===i&&(a.initialClick=[o.offsetX,o.offsetY],a.initialHits=u.map((e=>e.eventObject))),c&&!u.length&&h<=2&&(r(o,a.interaction),s&&s(o)),l&&n(u),function(t,r,i,o){const s=e.getState();if(t.length){const e={stopped:!1};for(const a of t){const l=Xd(a.object)||s,{raycaster:c,pointer:u,camera:h,internal:d}=l,p=new yn(u.x,u.y,0).unproject(h),f=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(a.eventObject))&&t},m=e=>{const t={intersection:a,target:r.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(a.eventObject,t):d.capturedMap.set(e,new Map([[a.eventObject,t]])),r.target.setPointerCapture(e)},g=e=>{const t=d.capturedMap.get(e);t&&op(d.capturedMap,a.eventObject,t,e)};let v={};for(let e in r){let t=r[e];"function"!=typeof t&&(v[e]=t)}let _={...a,...v,pointer:u,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:p,ray:c.ray,camera:h,stopPropagation(){const i="pointerId"in r&&d.capturedMap.get(r.pointerId);(!i||i.has(a.eventObject))&&(_.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find((e=>e.eventObject===a.eventObject)))&&n([...t.slice(0,t.indexOf(a)),a])},target:{hasPointerCapture:f,setPointerCapture:m,releasePointerCapture:g},currentTarget:{hasPointerCapture:f,setPointerCapture:m,releasePointerCapture:g},nativeEvent:r};if(o(_),!0===e.stopped)break}}}(u,o,h,(function(e){const t=e.eventObject,n=t.__r3f,s=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){const t=ip(e),n=a.hovered.get(t);n?n.stopped&&e.stopPropagation():(a.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{const n=s[i];n?(!c||a.initialHits.includes(t))&&(r(o,a.interaction.filter((e=>!a.initialHits.includes(e)))),n(e)):c&&a.initialHits.includes(t)&&r(o,a.interaction.filter((e=>!a.initialHits.includes(e))))}}))}}}}const ap=e=>!(null==e||!e.render),lp=e.createContext(null),cp=(t,n)=>{const r=function(t){const n="function"==typeof t?md(t):t,r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getState,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,i]=(0,e.useReducer)((e=>e+1),0),o=n.getState(),s=(0,e.useRef)(o),a=(0,e.useRef)(t),l=(0,e.useRef)(r),c=(0,e.useRef)(!1),u=(0,e.useRef)();void 0===u.current&&(u.current=t(o));let h,d=!1;(s.current!==o||a.current!==t||l.current!==r||c.current)&&(h=t(o),d=!r(u.current,h)),gd((()=>{d&&(u.current=h),s.current=o,a.current=t,l.current=r,c.current=!1}));const p=(0,e.useRef)(o);gd((()=>{const e=()=>{try{const e=n.getState(),t=a.current(e);l.current(u.current,t)||(s.current=e,u.current=t,i())}catch{c.current=!0,i()}},t=n.subscribe(e);return n.getState()!==p.current&&e(),t}),[]);const f=d?h:u.current;return(0,e.useDebugValue)(f),f};return Object.assign(r,n),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[r,n];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},r}(((r,i)=>{const o=new yn,s=new yn,a=new yn;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i().size;const{width:r,height:l,top:c,left:u}=n,h=r/l;t instanceof yn?a.copy(t):a.set(...t);const d=e.getWorldPosition(o).distanceTo(a);if(Bd(e))return{width:r/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,i=n*(r/l);return{width:i,height:n,top:c,left:u,factor:r/i,distance:d,aspect:h}}}let c;const u=e=>r((t=>({performance:{...t.performance,current:e}}))),h=new Wt;return{set:r,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,invalidate:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t(i(),e)},advance:(e,t)=>n(e,t,i()),legacy:!1,linear:!1,flat:!1,scene:Kd(new ya),controls:null,clock:new uh,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=i();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout((()=>u(i().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>r((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,n,o,a)=>{const c=i().camera,u={width:e,height:t,top:o||0,left:a||0,updateStyle:n};r((e=>({size:u,viewport:{...e.viewport,...l(c,s,u)}})))},setDpr:e=>r((t=>{const n=jd(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=i().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:e.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const r=i().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=i().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}}})),i=r.getState();let o=i.size,s=i.viewport.dpr,a=i.camera;return r.subscribe((()=>{const{camera:e,size:t,viewport:n,gl:i,set:l}=r.getState();if(t!==o||n.dpr!==s){var c;o=t,s=n.dpr,function(e,t){e.manual||(Bd(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}(e,t),i.setPixelRatio(n.dpr);const r=null!=(c=t.updateStyle)?c:typeof HTMLCanvasElement<"u"&&i.domElement instanceof HTMLCanvasElement;i.setSize(t.width,t.height,r)}e!==a&&(a=e,l((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),r.subscribe((e=>t(e))),r};let up,hp,dp,pp=new Set,fp=new Set,mp=new Set;function gp(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function vp(e,t){switch(e){case"before":return gp(pp,t);case"after":return gp(fp,t);case"tail":return gp(mp,t)}}function _p(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),hp=t.internal.subscribers,up=0;up<hp.length;up++)dp=hp[up],dp.ref.current(dp.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function bp(){const t=e.useContext(lp);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function yp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return bp()(e,t)}function Tp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=bp(),r=n.getState().internal.subscribe,i=Ud(e);return Fd((()=>r(i,t,n)),[t,r,n]),null}const Ep=new Map,{invalidate:Sp,advance:wp}=function(e){let t,n,r,i=!1;function o(s){n=requestAnimationFrame(o),i=!0,t=0,vp("before",s);for(const n of e.values()){var a;r=n.store.getState(),r.internal.active&&("always"===r.frameloop||r.internal.frames>0)&&(null==(a=r.gl.xr)||!a.isPresenting)&&(t+=_p(s,r))}if(vp("after",s),0===t)return vp("tail",s),i=!1,cancelAnimationFrame(n)}return{loop:o,invalidate:function t(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var s;if(!n)return e.forEach((e=>t(e.store.getState())),r);null!=(s=n.gl.xr)&&s.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+r),i||(i=!0,requestAnimationFrame(o)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(n&&vp("before",t),r)_p(t,r,i);else for(const o of e.values())_p(t,o.store.getState());n&&vp("after",t)}}}(Ep),{reconciler:xp,applyProps:Mp}=function(e,t){function n(e,t,n){let r,{args:i=[],attach:o,...s}=t,a="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===s.object)throw new Error("R3F: Primitives without 'object' are invalid!");r=Kd(s.object,{type:e,root:n,attach:o,primitive:!0})}else{const t=Nd[a];if(!t)throw new Error("R3F: ".concat(a," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(i))throw new Error("R3F: The args prop must be an array!");r=Kd(new t(...i),{type:e,root:n,attach:o,memoizedProps:{args:i}})}return void 0===r.__r3f.attach&&(r instanceof qr?r.__r3f.attach="geometry":r instanceof Pr&&(r.__r3f.attach="material")),"inject"!==a&&tp(r,s),r}function r(e,t){let n=!1;var r,i;t&&(null!=(r=t.__r3f)&&r.attach?Zd(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||Kd(t,{}),t.__r3f.parent=e,rp(t),np(t))}function i(e,t,n){let r=!1;if(t){var i,o;if(null!=(i=t.__r3f)&&i.attach)Zd(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});const i=e.children.filter((e=>e!==t)),o=i.indexOf(n);e.children=[...i.slice(0,o),t,...i.slice(o)],r=!0}r||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||Kd(t,{}),t.__r3f.parent=e,rp(t),np(t)}}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach((e=>s(t,e,n)))}function s(e,t,n){if(t){var r,i,s;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(i=t.__r3f)&&i.attach)Qd(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,r)=>{(e.eventObject===t||e.object===t)&&n.hovered.delete(r)})),n.capturedMap.forEach(((e,r)=>{op(n.capturedMap,t,e,r)}))}(t.__r3f.root,t)}const c=null==(s=t.__r3f)?void 0:s.primitive,u=void 0===n?null!==t.dispose&&!c:n;var l;if(!c)o(null==(l=t.__r3f)?void 0:l.objects,t,u),o(t.children,t,u);t.__r3f&&(delete t.__r3f.root,delete t.__r3f.objects,delete t.__r3f.handlers,delete t.__r3f.memoizedProps,c||delete t.__r3f),u&&t.dispose&&"Scene"!==t.type&&bd.exports.unstable_scheduleCallback(bd.exports.unstable_IdlePriority,(()=>{try{t.dispose()}catch{}})),np(e)}}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:wd({createInstance:n,removeChild:s,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;!n.__r3f||(n.__r3f.root=e,r(n,t))},removeChildFromContainer:(e,t)=>{!t||s(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;!r.__r3f||i(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,r){if(e.__r3f.primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:i,...o}=r,{args:s=[],children:a,...l}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==s[t])))return[!0];const c=ep(e,o,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,i,o,a,l){let[c,u]=t;c?function(e,t,i,o){var a;const l=null==(a=e.__r3f)?void 0:a.parent;if(!l)return;const c=n(t,i,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&r(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>r(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||s(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),r(l,c),c.raycast&&c.__r3f.eventCount&&c.__r3f.root.getState().internal.interaction.push(c),[o,o.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,i,a,l):tp(e,u)},commitMount(e,t,n,r){var i;const o=null!=(i=e.__r3f)?i:{};e.raycast&&o.handlers&&o.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>Kd(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&Qd(r,e,n),e.isObject3D&&(e.visible=!1),np(e)},unhideInstance(e,t){var n;const{attach:r,parent:i}=null!=(n=e.__r3f)?n:{};r&&i&&Zd(i,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),np(e)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():pd.exports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Yd.fun(performance.now)?performance.now:Yd.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Yd.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Yd.fun(clearTimeout)?clearTimeout:void 0}),applyProps:tp}}(0,(function(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return pd.exports.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return pd.exports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return pd.exports.ContinuousEventPriority;default:return pd.exports.DefaultEventPriority}})),Cp={objects:"shallow",strict:!1},Ip=(e,t)=>{const n="function"==typeof e?e(t):e;return ap(n)?n:new ga({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function kp(e){const t=Ep.get(e),n=null==t?void 0:t.fiber,r=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const i="function"==typeof reportError?reportError:console.error,o=r||cp(Sp,wp),s=n||xp.createContainer(o,pd.exports.ConcurrentRoot,null,!1,null,"",i,null);t||Ep.set(e,{fiber:s,store:o});let a,l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:r,events:i,onCreated:s,shadows:p=!1,linear:f=!1,flat:m=!1,legacy:g=!1,orthographic:v=!1,frameloop:_="always",dpr:b=[1,2],performance:y,raycaster:T,camera:E,onPointerMissed:S}=t,w=o.getState(),x=w.gl;w.gl||w.set({gl:x=Ip(n,e)});let M=w.raycaster;M||w.set({raycaster:M=new Nh});const{params:C,...I}=T||{};if(Yd.equ(I,M,Cp)||Mp(M,{...I}),Yd.equ(C,M.params,Cp)||Mp(M,{params:{...M.params,...C}}),!w.camera||w.camera===l&&!Yd.equ(l,E,Cp)){l=E;const e=E instanceof Ti,t=e?E:v?new ji(0,0,0,0,.1,1e3):new Ei(75,0,.1,1e3);e||(t.position.z=5,E&&Mp(t,E),!w.camera&&!(null!=E&&E.rotation)&&t.lookAt(0,0,0)),w.set({camera:t})}if(!w.xr){const e=(e,t)=>{const n=o.getState();"never"!==n.frameloop&&wp(e,!0,n,t)},t=()=>{const t=o.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||Sp(t)},n={connect(){const e=o.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=o.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};x.xr&&n.connect(),w.set({xr:n})}if(x.shadowMap){const e=x.shadowMap.enabled,t=x.shadowMap.type;if(x.shadowMap.enabled=!!p,Yd.boo(p))x.shadowMap.type=h;else if(Yd.str(p)){var k;const e={basic:0,percentage:u,soft:h,variance:d};x.shadowMap.type=null!=(k=e[p])?k:h}else Yd.obj(p)&&Object.assign(x.shadowMap,p);(e!==x.shadowMap.enabled||t!==x.shadowMap.type)&&(x.shadowMap.needsUpdate=!0)}const R=$d();R&&("enabled"in R?R.enabled=!g:"legacyMode"in R&&(R.legacyMode=g));const A=f?bt:yt,L=m?K:Q;x.outputEncoding!==A&&(x.outputEncoding=A),x.toneMapping!==L&&(x.toneMapping=L),w.legacy!==g&&w.set((()=>({legacy:g}))),w.linear!==f&&w.set((()=>({linear:f}))),w.flat!==m&&w.set((()=>({flat:m}))),n&&!Yd.fun(n)&&!ap(n)&&!Yd.equ(n,x,Cp)&&Mp(x,n),i&&!w.events.handlers&&w.set({events:i(o)});const O=function(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:i}}return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,r);return Yd.equ(O,w.size,Cp)||w.setSize(O.width,O.height,O.updateStyle,O.top,O.left),b&&w.viewport.dpr!==jd(b)&&w.setDpr(b),w.frameloop!==_&&w.setFrameloop(_),w.onPointerMissed||w.set({onPointerMissed:S}),y&&!Yd.equ(y,w.performance,Cp)&&w.set((e=>({performance:{...e.performance,...y}}))),a=s,c=!0,this},render(t){return c||this.configure(),xp.updateContainer(Ld(Rp,{store:o,children:t,onCreated:a,rootElement:e}),s,null,(()=>{})),o},unmount(){Ap(e)}}}function Rp(t){let{store:n,children:r,onCreated:i,rootElement:o}=t;return Fd((()=>{const e=n.getState();e.set((e=>({internal:{...e.internal,active:!0}}))),i&&i(e),n.getState().events.connected||null==e.events.connect||e.events.connect(o)}),[]),e.createElement(lp.Provider,{value:n},r)}function Ap(e,t){const n=Ep.get(e),r=null==n?void 0:n.fiber;if(r){const i=null==n?void 0:n.store.getState();i&&(i.internal.active=!1),xp.updateContainer(null,r,null,(()=>{i&&setTimeout((()=>{try{var n,r,o,s;null==i.events.disconnect||i.events.disconnect(),null==(n=i.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(o=i.gl)||null==o.forceContextLoss||o.forceContextLoss(),null!=(s=i.gl)&&s.xr&&i.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(i),Ep.delete(e),t&&t(e)}catch{}}),500)}))}}function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lp.apply(this,arguments)}function Op(e,t,n){var r,i,o,s,a;function l(){var c=Date.now()-s;c<t&&c>=0?r=setTimeout(l,t-c):(r=null,n||(a=e.apply(o,i),o=i=null))}null==t&&(t=100);var c=function(){o=this,i=arguments,s=Date.now();var c=n&&!r;return r||(r=setTimeout(l,t)),c&&(a=e.apply(o,i),o=i=null),a};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(a=e.apply(o,i),o=i=null,clearTimeout(r),r=null)},c}xp.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:e.version}),Op.debounce=Op;var Np=Op;function Pp(t){let{debounce:n,scroll:r,polyfill:i,offsetSize:o}=void 0===t?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,l]=(0,e.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,e.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),u=n?"number"==typeof n?n:n.scroll:null,h=n?"number"==typeof n?n:n.resize:null,d=(0,e.useRef)(!1);(0,e.useEffect)((()=>(d.current=!0,()=>{d.current=!1})));const[p,f,m]=(0,e.useMemo)((()=>{const e=()=>{if(!c.current.element)return;const{left:e,top:t,width:n,height:r,bottom:i,right:s,x:a,y:u}=c.current.element.getBoundingClientRect(),h={left:e,top:t,width:n,height:r,bottom:i,right:s,x:a,y:u};c.current.element instanceof HTMLElement&&o&&(h.height=c.current.element.offsetHeight,h.width=c.current.element.offsetWidth),Object.freeze(h),d.current&&!Bp(c.current.lastBounds,h)&&l(c.current.lastBounds=h)};return[e,h?Np(e,h):e,u?Np(e,u):e]}),[l,o,u,h]);function g(){c.current.scrollContainers&&(c.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",m,!0))),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null)}function v(){!c.current.element||(c.current.resizeObserver=new s(m),c.current.resizeObserver.observe(c.current.element),r&&c.current.scrollContainers&&c.current.scrollContainers.forEach((e=>e.addEventListener("scroll",m,{capture:!0,passive:!0}))))}return function(t,n){(0,e.useEffect)((()=>{if(n){const e=t;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",e,!0)}}}),[t,n])}(m,Boolean(r)),function(t){(0,e.useEffect)((()=>{const e=t;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[t])}(f),(0,e.useEffect)((()=>{g(),v()}),[r,m,f]),(0,e.useEffect)((()=>g),[]),[e=>{!e||e===c.current.element||(g(),c.current.element=e,c.current.scrollContainers=Dp(e),v())},a,p]}function Dp(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[n,r,i].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...Dp(e.parentElement)]}const $p=["x","y","top","bottom","left","right","width","height"],Bp=(e,t)=>$p.every((n=>e[n]===t[n]));var Fp,Up=Object.defineProperty,zp=Object.defineProperties,Hp=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,Vp=Object.prototype.hasOwnProperty,Wp=Object.prototype.propertyIsEnumerable,jp=(e,t,n)=>t in e?Up(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xp=(e,t)=>{for(var n in t||(t={}))Vp.call(t,n)&&jp(e,n,t[n]);if(Gp)for(var n of Gp(t))Wp.call(t,n)&&jp(e,n,t[n]);return e};function Yp(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=Yp(r,t,n);if(e)return e;r=t?null:r.sibling}}function Kp(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch{return e}}const qp=Kp(e.createContext(null));class Jp extends e.Component{render(){return Ld(qp.Provider,{value:this._reactInternals,children:this.props.children})}}const{ReactCurrentOwner:Zp,ReactCurrentDispatcher:Qp}=null!=(Fp=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)?Fp:{};function ef(){const t=e.useContext(qp),n=e.useId();return e.useMemo((()=>{var e;return null!=(e=null==Zp?void 0:Zp.current)?e:Yp(t,!1,(e=>{let t=e.memoizedState;for(;t;){if(t.memoizedState===n)return!0;t=t.next}}))}),[t,n])}function tf(){var t,n;const r=ef(),[i]=e.useState((()=>new Map));i.clear();let o=r;for(;o;){const e=null==(t=o.type)?void 0:t._context;e&&e!==qp&&!i.has(e)&&i.set(e,null==(n=null==Qp?void 0:Qp.current)?void 0:n.readContext(Kp(e))),o=o.return}return e.useMemo((()=>Array.from(i.keys()).reduce(((t,n)=>r=>e.createElement(t,null,e.createElement(n.Provider,((e,t)=>zp(e,Hp(t)))(Xp({},r),{value:i.get(n)})))),(e=>Ld(Jp,{...Xp({},e)})))),[i])}const nf={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function rf(e){const{handlePointer:t}=sp(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(nf).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:i}=e.getState();null==i.disconnect||i.disconnect(),r((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=i.handlers)?n:[]).forEach((e=>{let[n,r]=e;const[i,o]=nf[n];t.addEventListener(i,r,{passive:o})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach((e=>{let[t,r]=e;if(n&&n.connected instanceof HTMLElement){const[e]=nf[t];n.connected.removeEventListener(e,r)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}const of=e.forwardRef((function(t,n){let{children:r,fallback:i,resize:o,style:s,gl:a,events:l=rf,eventSource:c,eventPrefix:u,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:v,performance:_,raycaster:b,camera:y,onPointerMissed:T,onCreated:E,...S}=t;e.useMemo((()=>(e=>{Object.assign(Nd,e)})(cd)),[]);const w=tf(),[x,M]=Pp({scroll:!0,debounce:{scroll:50,resize:0},...o}),C=e.useRef(null),I=e.useRef(null);e.useImperativeHandle(n,(()=>C.current));const k=Ud(T),[R,A]=e.useState(!1),[L,O]=e.useState(!1);if(R)throw R;if(L)throw L;const N=e.useRef(null);return Fd((()=>{const t=C.current;M.width>0&&M.height>0&&t&&(N.current||(N.current=kp(t)),N.current.configure({gl:a,events:l,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:v,performance:_,raycaster:b,camera:y,size:M,onPointerMissed:function(){return null==k.current?void 0:k.current(...arguments)},onCreated:e=>{null==e.events.connect||e.events.connect(c?(e=>e&&e.hasOwnProperty("current"))(c)?c.current:c:I.current),u&&e.setEvents({compute:(e,t)=>{const n=e[u+"X"],r=e[u+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==E||E(e)}}),N.current.render(Ld(w,{children:Ld(Hd,{set:O,children:Ld(e.Suspense,{fallback:Ld(zd,{set:A}),children:r})})})))})),e.useEffect((()=>{const e=C.current;if(e)return()=>Ap(e)}),[]),Ld("div",{ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:c?"none":"auto",...s},...S,children:Ld("div",{ref:x,style:{width:"100%",height:"100%"},children:Ld("canvas",{ref:C,style:{display:"block"},children:i})})})})),sf=e.forwardRef((function(e,t){return Ld(Jp,{children:Ld(of,{...e,ref:t})})}));var af,lf={exports:{}},cf={},uf={exports:{}},hf={};var df,pf;function ff(){return df||(df=1,function(e){e.exports=(af||(af=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,s=o>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>i(l,n))c<o&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<o&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var i=n(c);null!==i;){if(null===i.callback)r(c);else{if(!(i.startTime<=e))break;r(c),i.sortIndex=i.expirationTime,t(l,i)}i=n(c)}}function y(e){if(m=!1,b(e),!f)if(null!==n(l))f=!0,L(T);else{var t=n(c);null!==t&&O(y,t.startTime-e)}}function T(t,i){f=!1,m&&(m=!1,v(x),x=-1),p=!0;var o=d;try{for(b(i),h=n(l);null!==h&&(!(h.expirationTime>i)||t&&!I());){var s=h.callback;if("function"==typeof s){h.callback=null,d=h.priorityLevel;var a=s(h.expirationTime<=i);i=e.unstable_now(),"function"==typeof a?h.callback=a:h===n(l)&&r(l),b(i)}else r(l);h=n(l)}if(null!==h)var u=!0;else{var g=n(c);null!==g&&O(y,g.startTime-i),u=!1}return u}finally{h=null,d=o,p=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,w=null,x=-1,M=5,C=-1;function I(){return!(e.unstable_now()-C<M)}function k(){if(null!==w){var t=e.unstable_now();C=t;var n=!0;try{n=w(!0,t)}finally{n?E():(S=!1,w=null)}}else S=!1}if("function"==typeof _)E=function(){_(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,A=R.port2;R.port1.onmessage=k,E=function(){A.postMessage(null)}}else E=function(){g(k,0)};function L(e){w=e,S||(S=!0,E())}function O(t,n){x=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,L(T))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_scheduleCallback=function(r,i,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,r){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return r={id:u++,callback:i,priorityLevel:r,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(r.sortIndex=o,t(c,r),null===n(l)&&r===n(c)&&(m?(v(x),x=-1):m=!0,O(y,o-s))):(r.sortIndex=a,t(l,r),f||p||(f=!0,L(T))),r},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}}(hf)),hf)}(uf)),uf.exports}function mf(){if(pf)return cf;pf=1;var t=e,n=ff();function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function s(e,t){a(e,t),a(e+"Capture",t)}function a(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function p(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){f[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];f[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){f[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){f[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){f[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){f[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){f[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){f[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){f[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function v(e,t,n,r){var i=f.hasOwnProperty(t)?f[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||typeof t>"u"||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!c.call(d,e)||!c.call(h,e)&&(u.test(e)?d[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);f[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);f[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);f[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),f.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),y=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),x=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),L=Symbol.iterator;function O(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,P=Object.assign;function D(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var $=!1;function B(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"==typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{$=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D(e):""}function F(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case y:return"Portal";case S:return"Profiler";case E:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case w:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return U(e(t))}catch{}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function j(e){if(typeof(e=e||(typeof document<"u"?document:void 0))>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function X(e,t){var n=t.checked;return P({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function q(e,t){K(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Z(e,t.type,n):t.hasOwnProperty("defaultValue")&&Z(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Z(e,t,n){("number"!==t||j(e.ownerDocument)!==e)&&(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Q=Array.isArray;function ee(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function te(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return P({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(Q(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function re(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ae,le,ce=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ae=ae||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ae.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(he).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var me=P({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(r(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ye=null,Te=null,Ee=null;function Se(e){if(e=vi(e)){if("function"!=typeof ye)throw Error(r(280));var t=e.stateNode;t&&(t=bi(t),ye(e.stateNode,e.type,t))}}function we(e){Te?Ee?Ee.push(e):Ee=[e]:Te=e}function xe(){if(Te){var e=Te,t=Ee;if(Ee=Te=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Me(e,t){return e(t)}function Ce(){}var Ie=!1;function ke(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Me(e,t,n)}finally{Ie=!1,(null!==Te||null!==Ee)&&(Ce(),xe())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var i=bi(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var Ae=!1;if(l)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch{Ae=!1}function Oe(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ne=!1,Pe=null,De=!1,$e=null,Be={onError:function(e){Ne=!0,Pe=e}};function Fe(e,t,n,r,i,o,s,a,l){Ne=!1,Pe=null,Oe.apply(Be,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(r(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(null===o)break;var s=o.alternate;if(null===s){if(null!==(i=o.return)){n=i;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return He(o),e;if(s===i)return He(o),t;s=s.sibling}throw Error(r(188))}if(n.return!==i.return)n=o,i=s;else{for(var a=!1,l=o.child;l;){if(l===n){a=!0,n=o,i=s;break}if(l===i){a=!0,i=o,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=o;break}if(l===i){a=!0,i=s,n=o;break}l=l.sibling}if(!a)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var We=n.unstable_scheduleCallback,je=n.unstable_cancelCallback,Xe=n.unstable_shouldYield,Ye=n.unstable_requestPaint,Ke=n.unstable_now,qe=n.unstable_getCurrentPriorityLevel,Je=n.unstable_ImmediatePriority,Ze=n.unstable_UserBlockingPriority,Qe=n.unstable_NormalPriority,et=n.unstable_LowPriority,tt=n.unstable_IdlePriority,nt=null,rt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/st|0)|0},ot=Math.log,st=Math.LN2;var at=64,lt=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=ct(a):0!==(o&=s)&&(r=ct(o))}else 0!==(s=n&~i)?r=ct(s):0!==o&&(r=ct(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-it(t)),r|=e[n],t&=~i;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=at;return 0===(4194240&(at<<=1))&&(at=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var vt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,yt,Tt,Et,St,wt=!1,xt=[],Mt=null,Ct=null,It=null,kt=new Map,Rt=new Map,At=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":kt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=vi(t))&&yt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Pt(e){var t=gi(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void St(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vi(n))&&yt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function $t(e,t,n){Dt(e)&&n.delete(t)}function Bt(){wt=!1,null!==Mt&&Dt(Mt)&&(Mt=null),null!==Ct&&Dt(Ct)&&(Ct=null),null!==It&&Dt(It)&&(It=null),kt.forEach($t),Rt.forEach($t)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,wt||(wt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return Ft(t,e)}if(0<xt.length){Ft(xt[0],e);for(var n=1;n<xt.length;n++){var r=xt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Mt&&Ft(Mt,e),null!==Ct&&Ft(Ct,e),null!==It&&Ft(It,e),kt.forEach(t),Rt.forEach(t),n=0;n<At.length;n++)(r=At[n]).blockedOn===e&&(r.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Pt(n),null===n.blockedOn&&At.shift()}var zt=_.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var i=vt,o=zt.transition;zt.transition=null;try{vt=1,Wt(e,t,n,r)}finally{vt=i,zt.transition=o}}function Vt(e,t,n,r){var i=vt,o=zt.transition;zt.transition=null;try{vt=4,Wt(e,t,n,r)}finally{vt=i,zt.transition=o}}function Wt(e,t,n,r){if(Ht){var i=Xt(e,t,n,r);if(null===i)Hr(e,t,r,jt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Mt=Nt(Mt,e,t,n,r,i),!0;case"dragenter":return Ct=Nt(Ct,e,t,n,r,i),!0;case"mouseover":return It=Nt(It,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return kt.set(o,Nt(kt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rt.set(o,Nt(Rt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=vi(i);if(null!==o&&bt(o),null===(o=Xt(e,t,n,r))&&Hr(e,t,r,jt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var jt=null;function Xt(e,t,n,r){if(jt=null,null!==(e=gi(e=be(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case Je:return 1;case Ze:return 4;case Qe:case et:return 16;case tt:return 536870912;default:return 16}default:return 16}}var Kt=null,qt=null,Jt=null;function Zt(){if(Jt)return Jt;var e,t,n=qt,r=n.length,i="value"in Kt?Kt.value:Kt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function Qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function en(){return!0}function tn(){return!1}function nn(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?en:tn,this.isPropagationStopped=tn,this}return P(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=en)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=en)},persist:function(){},isPersistent:en}),t}var rn,on,sn,an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=nn(an),cn=P({},an,{view:0,detail:0}),un=nn(cn),hn=P({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(rn=e.screenX-sn.screenX,on=e.screenY-sn.screenY):on=rn=0,sn=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),dn=nn(hn),pn=nn(P({},hn,{dataTransfer:0})),fn=nn(P({},cn,{relatedTarget:0})),mn=nn(P({},an,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=P({},an,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=nn(gn),_n=nn(P({},an,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function Sn(){return En}var wn=P({},cn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?yn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?Qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=nn(wn),Mn=nn(P({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=nn(P({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),In=nn(P({},an,{propertyName:0,elapsedTime:0,pseudoElement:0})),kn=P({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=nn(kn),An=[9,13,27,32],Ln=l&&"CompositionEvent"in window,On=null;l&&"documentMode"in document&&(On=document.documentMode);var Nn=l&&"TextEvent"in window&&!On,Pn=l&&(!Ln||On&&8<On&&11>=On),Dn=String.fromCharCode(32),$n=!1;function Bn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Gn(e,t,n,r){we(r),0<(t=Vr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Wn=null;function jn(e){Dr(e,0)}function Xn(e){if(W(_i(e)))return e}function Yn(e,t){if("change"===e)return t}var Kn=!1;if(l){var qn;if(l){var Jn="oninput"in document;if(!Jn){var Zn=document.createElement("div");Zn.setAttribute("oninput","return;"),Jn="function"==typeof Zn.oninput}qn=Jn}else qn=!1;Kn=qn&&(!document.documentMode||9<document.documentMode)}function Qn(){Vn&&(Vn.detachEvent("onpropertychange",er),Wn=Vn=null)}function er(e){if("value"===e.propertyName&&Xn(Wn)){var t=[];Gn(t,Wn,e,be(e)),ke(jn,t)}}function tr(e,t,n){"focusin"===e?(Qn(),Wn=n,(Vn=t).attachEvent("onpropertychange",er)):"focusout"===e&&Qn()}function nr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Wn)}function rr(e,t){if("click"===e)return Xn(t)}function ir(e,t){if("input"===e||"change"===e)return Xn(t)}var or="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(or(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!c.call(t,i)||!or(e[i],t[i]))return!1}return!0}function ar(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=ar(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ar(r)}}function cr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?cr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ur(){for(var e=window,t=j();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch{n=!1}if(!n)break;t=j((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=ur(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&cr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=lr(n,o);var s=lr(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=l&&"documentMode"in document&&11>=document.documentMode,fr=null,mr=null,gr=null,vr=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==fr||fr!==j(r)||("selectionStart"in(r=fr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Vr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=fr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var yr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Tr={},Er={};function Sr(e){if(Tr[e])return Tr[e];if(!yr[e])return e;var t,n=yr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Tr[e]=n[t];return e}l&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete yr.animationend.animation,delete yr.animationiteration.animation,delete yr.animationstart.animation),"TransitionEvent"in window||delete yr.transitionend.transition);var wr=Sr("animationend"),xr=Sr("animationiteration"),Mr=Sr("animationstart"),Cr=Sr("transitionend"),Ir=new Map,kr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Ir.set(e,t),s(t,[e])}for(var Ar=0;Ar<kr.length;Ar++){var Lr=kr[Ar];Rr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Rr(wr,"onAnimationEnd"),Rr(xr,"onAnimationIteration"),Rr(Mr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Cr,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Pr(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,o,s,a,l,c){if(Fe.apply(this,arguments),Ne){if(!Ne)throw Error(r(198));var u=Pe;Ne=!1,Pe=null,De||(De=!0,$e=u)}}(i,t,void 0,e),e.currentTarget=null}function Dr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Pr(i,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Pr(i,a,c),o=l}}}if(De)throw e=$e,De=!1,$e=null,e}function $r(e,t){var n=t[pi];void 0===n&&(n=t[pi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var Fr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Fr]){e[Fr]=!0,i.forEach((function(t){"selectionchange"!==t&&(Nr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fr]||(t[Fr]=!0,Br("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Yt(t)){case 1:var i=Gt;break;case 4:i=Vt;break;default:i=Wt}n=i.bind(null,t,n,e),i=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=gi(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}ke((function(){var r=o,i=be(n),s=[];e:{var a=Ir.get(e);if(void 0!==a){var l=ln,c=e;switch(e){case"keypress":if(0===Qt(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":c="focus",l=fn;break;case"focusout":c="blur",l=fn;break;case"beforeblur":case"afterblur":l=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case wr:case xr:case Mr:l=mn;break;case Cr:l=In;break;case"scroll":l=un;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Re(f,d))&&u.push(Gr(f,m,p)))),h)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!gi(c)&&!c[di])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?gi(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=dn,m="onMouseLeave",d="onMouseEnter",f="mouse",("pointerout"===e||"pointerover"===e)&&(u=Mn,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:_i(l),p=null==c?a:_i(c),(a=new u(m,f+"leave",l,n,i)).target=h,a.relatedTarget=p,m=null,gi(i)===r&&((u=new u(d,f+"enter",c,n,i)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Wr(p))f++;for(p=0,m=d;m;m=Wr(m))p++;for(;0<f-p;)u=Wr(u),f--;for(;0<p-f;)d=Wr(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wr(u),d=Wr(d)}u=null}else u=null;null!==l&&jr(s,a,l,u,!1),null!==c&&null!==h&&jr(s,h,c,u,!0)}if("select"===(l=(a=r?_i(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yn;else if(Hn(a))if(Kn)g=ir;else{g=nr;var v=tr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=rr);switch(g&&(g=g(e,r))?Gn(s,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&Z(a,"number",a.value)),v=r?_i(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(fr=v,mr=r,gr=null);break;case"focusout":gr=mr=fr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,_r(s,n,i);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":_r(s,n,i)}var _;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Pn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(_=Zt()):(qt="value"in(Kt=i)?Kt.value:Kt.textContent,Un=!0)),0<(v=Vr(r,b)).length&&(b=new _n(b,e,null,n,i),s.push({event:b,listeners:v}),_?b.data=_:null!==(_=Fn(n))&&(b.data=_))),(_=Nn?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:($n=!0,Dn);case"textInput":return(e=t.data)===Dn&&$n?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Ln&&Bn(e,t)?(e=Zt(),Jt=qt=Kt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=_))}Dr(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Re(e,n))&&r.unshift(Gr(e,o,i)),null!=(o=Re(e,t))&&r.push(Gr(e,o,i))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function jr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Re(n,o))&&s.unshift(Gr(n,l,a)):i||null!=(l=Re(n,o))&&s.push(Gr(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Kr(e){return("string"==typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function qr(e,t,n){if(t=Kr(t),Kr(e)!==t&&n)throw Error(r(425))}function Jr(){}var Zr=null,Qr=null;function ei(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ti="function"==typeof setTimeout?setTimeout:void 0,ni="function"==typeof clearTimeout?clearTimeout:void 0,ri="function"==typeof Promise?Promise:void 0,ii="function"==typeof queueMicrotask?queueMicrotask:typeof ri<"u"?function(e){return ri.resolve(null).then(e).catch(oi)}:ti;function oi(e){setTimeout((function(){throw e}))}function si(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ut(t)}function ai(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ci=Math.random().toString(36).slice(2),ui="__reactFiber$"+ci,hi="__reactProps$"+ci,di="__reactContainer$"+ci,pi="__reactEvents$"+ci,fi="__reactListeners$"+ci,mi="__reactHandles$"+ci;function gi(e){var t=e[ui];if(t)return t;for(var n=e.parentNode;n;){if(t=n[di]||n[ui]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[ui])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function vi(e){return!(e=e[ui]||e[di])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function bi(e){return e[hi]||null}var yi=[],Ti=-1;function Ei(e){return{current:e}}function Si(e){0>Ti||(e.current=yi[Ti],yi[Ti]=null,Ti--)}function wi(e,t){Ti++,yi[Ti]=e.current,e.current=t}var xi={},Mi=Ei(xi),Ci=Ei(!1),Ii=xi;function ki(e,t){var n=e.type.contextTypes;if(!n)return xi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ri(e){return null!=(e=e.childContextTypes)}function Ai(){Si(Ci),Si(Mi)}function Li(e,t,n){if(Mi.current!==xi)throw Error(r(168));wi(Mi,t),wi(Ci,n)}function Oi(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var o in i=i.getChildContext())if(!(o in t))throw Error(r(108,z(e)||"Unknown",o));return P({},n,i)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xi,Ii=Mi.current,wi(Mi,e),wi(Ci,Ci.current),!0}function Pi(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Oi(e,t,Ii),i.__reactInternalMemoizedMergedChildContext=e,Si(Ci),Si(Mi),wi(Mi,e)):Si(Ci),wi(Ci,n)}var Di=null,$i=!1,Bi=!1;function Fi(e){null===Di?Di=[e]:Di.push(e)}function Ui(){if(!Bi&&null!==Di){Bi=!0;var e=0,t=vt;try{var n=Di;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Di=null,$i=!1}catch(i){throw null!==Di&&(Di=Di.slice(e+1)),We(Je,Ui),i}finally{vt=t,Bi=!1}}return null}var zi=[],Hi=0,Gi=null,Vi=0,Wi=[],ji=0,Xi=null,Yi=1,Ki="";function qi(e,t){zi[Hi++]=Vi,zi[Hi++]=Gi,Gi=e,Vi=t}function Ji(e,t,n){Wi[ji++]=Yi,Wi[ji++]=Ki,Wi[ji++]=Xi,Xi=e;var r=Yi;e=Ki;var i=32-it(r)-1;r&=~(1<<i),n+=1;var o=32-it(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Yi=1<<32-it(t)+i|n<<i|r,Ki=o+e}else Yi=1<<o|n<<i|r,Ki=e}function Zi(e){null!==e.return&&(qi(e,1),Ji(e,1,0))}function Qi(e){for(;e===Gi;)Gi=zi[--Hi],zi[Hi]=null,Vi=zi[--Hi],zi[Hi]=null;for(;e===Xi;)Xi=Wi[--ji],Wi[ji]=null,Ki=Wi[--ji],Wi[ji]=null,Yi=Wi[--ji],Wi[ji]=null}var eo=null,to=null,no=!1,ro=null;function io(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,eo=e,to=ai(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,eo=e,to=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xi?{id:Yi,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,eo=e,to=null,!0);default:return!1}}function so(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ao(e){if(no){var t=to;if(t){var n=t;if(!oo(e,t)){if(so(e))throw Error(r(418));t=ai(n.nextSibling);var i=eo;t&&oo(e,t)?io(i,n):(e.flags=-4097&e.flags|2,no=!1,eo=e)}}else{if(so(e))throw Error(r(418));e.flags=-4097&e.flags|2,no=!1,eo=e}}}function lo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;eo=e}function co(e){if(e!==eo)return!1;if(!no)return lo(e),no=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ei(e.type,e.memoizedProps)),t&&(t=to)){if(so(e))throw uo(),Error(r(418));for(;t;)io(e,t),t=ai(t.nextSibling)}if(lo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){to=ai(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}to=null}}else to=eo?ai(e.stateNode.nextSibling):null;return!0}function uo(){for(var e=to;e;)e=ai(e.nextSibling)}function ho(){to=eo=null,no=!1}function po(e){null===ro?ro=[e]:ro.push(e)}var fo=_.ReactCurrentBatchConfig;function mo(e,t){if(e&&e.defaultProps){for(var n in t=P({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var go=Ei(null),vo=null,_o=null,bo=null;function yo(){bo=_o=vo=null}function To(e){var t=go.current;Si(go),e._currentValue=t}function Eo(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function So(e,t){vo=e,bo=_o=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_a=!0),e.firstContext=null)}function wo(e){var t=e._currentValue;if(bo!==e)if(e={context:e,memoizedValue:t,next:null},null===_o){if(null===vo)throw Error(r(308));_o=e,vo.dependencies={lanes:0,firstContext:e}}else _o=_o.next=e;return t}var xo=null;function Mo(e){null===xo?xo=[e]:xo.push(e)}function Co(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Mo(t)):(n.next=i.next,i.next=n),t.interleaved=n,Io(e,r)}function Io(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var ko=!1;function Ro(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ao(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Io(e,n)}return null===(i=r.interleaved)?(t.next=t,Mo(r)):(t.next=i.next,i.next=t),r.interleaved=t,Io(e,n)}function No(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Po(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Do(e,t,n,r){var i=e.updateQueue;ko=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(s=0,u=c=l=null,a=o;;){var d=a.lane,p=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(d=t,p=n,m.tag){case 1:if("function"==typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=m.payload)?f.call(p,h,d):f))break e;h=P({},h,d);break e;case 2:ko=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Pl|=s,e.lanes=s,e.memoizedState=h}}function $o(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(null!==o){if(i.callback=null,i=n,"function"!=typeof o)throw Error(r(191,o));o.call(i)}}}var Bo=(new t.Component).refs;function Fo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:P({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Uo={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=ec(e),o=Lo(r,i);o.payload=t,null!=n&&(o.callback=n),null!==(t=Oo(e,o,i))&&(tc(t,e,i,r),No(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=ec(e),o=Lo(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=Oo(e,o,i))&&(tc(t,e,i,r),No(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),r=ec(e),i=Lo(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=Oo(e,i,r))&&(tc(t,e,r,n),No(t,e,r))}};function zo(e,t,n,r,i,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(i,o))}function Ho(e,t,n){var r=!1,i=xi,o=t.contextType;return"object"==typeof o&&null!==o?o=wo(o):(i=Ri(t)?Ii:Mi.current,o=(r=null!=(r=t.contextTypes))?ki(e,i):xi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Uo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Go(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Uo.enqueueReplaceState(t,t.state,null)}function Vo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Bo,Ro(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=wo(o):(o=Ri(t)?Ii:Mi.current,i.context=ki(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(Fo(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Uo.enqueueReplaceState(i,i.state,null),Do(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function Wo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var o=i,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=o.refs;t===Bo&&(t=o.refs={}),null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function jo(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xo(e){return(0,e._init)(e._payload)}function Yo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Dc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===T?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===R&&Xo(i)===t.type)?((r=o(t,n.props)).ref=Wo(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=Wo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=$c(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Nc(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Dc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=Wo(e,null,t),n.return=e,n;case y:return(t=$c(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(Q(t)||O(t))return(t=Nc(t,e.mode,n,null)).return=e,t;jo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?c(e,t,n,r):null;case y:return n.key===i?u(e,t,n,r):null;case R:return p(e,t,(i=n._init)(n._payload),r)}if(Q(n)||O(n))return null!==i?null:h(e,t,n,r,null);jo(e,n)}return null}function f(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case y:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return f(e,t,n,(0,r._init)(r._payload),i)}if(Q(r)||O(r))return h(t,e=e.get(n)||null,r,i,null);jo(t,r)}return null}return function l(c,u,h,m){if("object"==typeof h&&null!==h&&h.type===T&&null===h.key&&(h=h.props.children),"object"==typeof h&&null!==h){switch(h.$$typeof){case b:e:{for(var g=h.key,v=u;null!==v;){if(v.key===g){if((g=h.type)===T){if(7===v.tag){n(c,v.sibling),(u=o(v,h.props.children)).return=c,c=u;break e}}else if(v.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===R&&Xo(g)===v.type){n(c,v.sibling),(u=o(v,h.props)).ref=Wo(c,v,h),u.return=c,c=u;break e}n(c,v);break}t(c,v),v=v.sibling}h.type===T?((u=Nc(h.props.children,c.mode,m,h.key)).return=c,c=u):((m=Oc(h.type,h.key,h.props,null,c.mode,m)).ref=Wo(c,u,h),m.return=c,c=m)}return a(c);case y:e:{for(v=h.key;null!==u;){if(u.key===v){if(4===u.tag&&u.stateNode.containerInfo===h.containerInfo&&u.stateNode.implementation===h.implementation){n(c,u.sibling),(u=o(u,h.children||[])).return=c,c=u;break e}n(c,u);break}t(c,u),u=u.sibling}(u=$c(h,c.mode,m)).return=c,c=u}return a(c);case R:return l(c,u,(v=h._init)(h._payload),m)}if(Q(h))return function(r,o,a,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(r,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(r,h),o=s(v,o,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===a.length)return n(r,h),no&&qi(r,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(r,a[m],l))&&(o=s(h,o,m),null===u?c=h:u.sibling=h,u=h);return no&&qi(r,m),c}for(h=i(r,h);m<a.length;m++)null!==(g=f(h,r,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(r,e)})),no&&qi(r,m),c}(c,u,h,m);if(O(h))return function(o,a,l,c){var u=O(l);if("function"!=typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var h=u=null,m=a,g=a=0,v=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(o,m,_.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(o,m),a=s(b,a,g),null===h?u=b:h.sibling=b,h=b,m=v}if(_.done)return n(o,m),no&&qi(o,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(o,_.value,c))&&(a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return no&&qi(o,g),u}for(m=i(o,m);!_.done;g++,_=l.next())null!==(_=f(m,o,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),a=s(_,a,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(o,e)})),no&&qi(o,g),u}(c,u,h,m);jo(c,h)}return"string"==typeof h&&""!==h||"number"==typeof h?(h=""+h,null!==u&&6===u.tag?(n(c,u.sibling),(u=o(u,h)).return=c,c=u):(n(c,u),(u=Dc(h,c.mode,m)).return=c,c=u),a(c)):n(c,u)}}var Ko=Yo(!0),qo=Yo(!1),Jo={},Zo=Ei(Jo),Qo=Ei(Jo),es=Ei(Jo);function ts(e){if(e===Jo)throw Error(r(174));return e}function ns(e,t){switch(wi(es,t),wi(Qo,e),wi(Zo,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Zo),wi(Zo,t)}function rs(){Si(Zo),Si(Qo),Si(es)}function is(e){ts(es.current);var t=ts(Zo.current),n=se(t,e.type);t!==n&&(wi(Qo,e),wi(Zo,n))}function os(e){Qo.current===e&&(Si(Zo),Si(Qo))}var ss=Ei(0);function as(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ls=[];function cs(){for(var e=0;e<ls.length;e++)ls[e]._workInProgressVersionPrimary=null;ls.length=0}var us=_.ReactCurrentDispatcher,hs=_.ReactCurrentBatchConfig,ds=0,ps=null,fs=null,ms=null,gs=!1,vs=!1,_s=0,bs=0;function ys(){throw Error(r(321))}function Ts(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function Es(e,t,n,i,o,s){if(ds=s,ps=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,us.current=null===e||null===e.memoizedState?oa:sa,e=n(i,o),vs){s=0;do{if(vs=!1,_s=0,25<=s)throw Error(r(301));s+=1,ms=fs=null,t.updateQueue=null,us.current=aa,e=n(i,o)}while(vs)}if(us.current=ia,t=null!==fs&&null!==fs.next,ds=0,ms=fs=ps=null,gs=!1,t)throw Error(r(300));return e}function Ss(){var e=0!==_s;return _s=0,e}function ws(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ms?ps.memoizedState=ms=e:ms=ms.next=e,ms}function xs(){if(null===fs){var e=ps.alternate;e=null!==e?e.memoizedState:null}else e=fs.next;var t=null===ms?ps.memoizedState:ms.next;if(null!==t)ms=t,fs=e;else{if(null===e)throw Error(r(310));e={memoizedState:(fs=e).memoizedState,baseState:fs.baseState,baseQueue:fs.baseQueue,queue:fs.queue,next:null},null===ms?ps.memoizedState=ms=e:ms=ms.next=e}return ms}function Ms(e,t){return"function"==typeof t?t(e):t}function Cs(e){var t=xs(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=fs,o=i.baseQueue,s=n.pending;if(null!==s){if(null!==o){var a=o.next;o.next=s.next,s.next=a}i.baseQueue=o=s,n.pending=null}if(null!==o){s=o.next,i=i.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((ds&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,ps.lanes|=h,Pl|=h}u=u.next}while(null!==u&&u!==s);null===c?a=i:c.next=l,or(i,t.memoizedState)||(_a=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){o=e;do{s=o.lane,ps.lanes|=s,Pl|=s,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Is(e){var t=xs(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,s=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{s=e(s,a.action),a=a.next}while(a!==o);or(s,t.memoizedState)||(_a=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function ks(){}function Rs(e,t){var n=ps,i=xs(),o=t(),s=!or(i.memoizedState,o);if(s&&(i.memoizedState=o,_a=!0),i=i.queue,Hs(Os.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==ms&&1&ms.memoizedState.tag){if(n.flags|=2048,$s(9,Ls.bind(null,n,i,o,t),void 0,null),null===Il)throw Error(r(349));0!==(30&ds)||As(n,t,o)}return o}function As(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ls(e,t,n,r){t.value=n,t.getSnapshot=r,Ns(t)&&Ps(e)}function Os(e,t,n){return n((function(){Ns(t)&&Ps(e)}))}function Ns(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch{return!0}}function Ps(e){var t=Io(e,1);null!==t&&tc(t,e,1,-1)}function Ds(e){var t=ws();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:e},t.queue=e,e=e.dispatch=ea.bind(null,ps,e),[t.memoizedState,e]}function $s(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bs(){return xs().memoizedState}function Fs(e,t,n,r){var i=ws();ps.flags|=e,i.memoizedState=$s(1|t,n,void 0,void 0===r?null:r)}function Us(e,t,n,r){var i=xs();r=void 0===r?null:r;var o=void 0;if(null!==fs){var s=fs.memoizedState;if(o=s.destroy,null!==r&&Ts(r,s.deps))return void(i.memoizedState=$s(t,n,o,r))}ps.flags|=e,i.memoizedState=$s(1|t,n,o,r)}function zs(e,t){return Fs(8390656,8,e,t)}function Hs(e,t){return Us(2048,8,e,t)}function Gs(e,t){return Us(4,2,e,t)}function Vs(e,t){return Us(4,4,e,t)}function Ws(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function js(e,t,n){return n=null!=n?n.concat([e]):null,Us(4,4,Ws.bind(null,t,e),n)}function Xs(){}function Ys(e,t){var n=xs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ks(e,t){var n=xs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qs(e,t,n){return 0===(21&ds)?(e.baseState&&(e.baseState=!1,_a=!0),e.memoizedState=n):(or(n,t)||(n=pt(),ps.lanes|=n,Pl|=n,e.baseState=!0),t)}function Js(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=hs.transition;hs.transition={};try{e(!1),t()}finally{vt=n,hs.transition=r}}function Zs(){return xs().memoizedState}function Qs(e,t,n){var r=ec(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ta(e))na(t,n);else if(null!==(n=Co(e,t,n,r))){tc(n,e,r,Ql()),ra(n,t,r)}}function ea(e,t,n){var r=ec(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ta(e))na(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,or(a,s)){var l=t.interleaved;return null===l?(i.next=i,Mo(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch{}null!==(n=Co(e,t,i,r))&&(tc(n,e,r,i=Ql()),ra(n,t,r))}}function ta(e){var t=e.alternate;return e===ps||null!==t&&t===ps}function na(e,t){vs=gs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ra(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var ia={readContext:wo,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},oa={readContext:wo,useCallback:function(e,t){return ws().memoizedState=[e,void 0===t?null:t],e},useContext:wo,useEffect:zs,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Fs(4194308,4,Ws.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fs(4,2,e,t)},useMemo:function(e,t){var n=ws();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ws();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qs.bind(null,ps,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ws().memoizedState=e},useState:Ds,useDebugValue:Xs,useDeferredValue:function(e){return ws().memoizedState=e},useTransition:function(){var e=Ds(!1),t=e[0];return e=Js.bind(null,e[1]),ws().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=ps,o=ws();if(no){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Il)throw Error(r(349));0!==(30&ds)||As(i,t,n)}o.memoizedState=n;var s={value:n,getSnapshot:t};return o.queue=s,zs(Os.bind(null,i,s,e),[e]),i.flags|=2048,$s(9,Ls.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=ws(),t=Il.identifierPrefix;if(no){var n=Ki;t=":"+t+"R"+(n=(Yi&~(1<<32-it(Yi)-1)).toString(32)+n),0<(n=_s++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=bs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sa={readContext:wo,useCallback:Ys,useContext:wo,useEffect:Hs,useImperativeHandle:js,useInsertionEffect:Gs,useLayoutEffect:Vs,useMemo:Ks,useReducer:Cs,useRef:Bs,useState:function(){return Cs(Ms)},useDebugValue:Xs,useDeferredValue:function(e){return qs(xs(),fs.memoizedState,e)},useTransition:function(){return[Cs(Ms)[0],xs().memoizedState]},useMutableSource:ks,useSyncExternalStore:Rs,useId:Zs,unstable_isNewReconciler:!1},aa={readContext:wo,useCallback:Ys,useContext:wo,useEffect:Hs,useImperativeHandle:js,useInsertionEffect:Gs,useLayoutEffect:Vs,useMemo:Ks,useReducer:Is,useRef:Bs,useState:function(){return Is(Ms)},useDebugValue:Xs,useDeferredValue:function(e){var t=xs();return null===fs?t.memoizedState=e:qs(t,fs.memoizedState,e)},useTransition:function(){return[Is(Ms)[0],xs().memoizedState]},useMutableSource:ks,useSyncExternalStore:Rs,useId:Zs,unstable_isNewReconciler:!1};function la(e,t){try{var n="",r=t;do{n+=F(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ca(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ua(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function da(e,t,n){(n=Lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gl||(Gl=!0,Vl=r),ua(0,t)},n}function pa(e,t,n){(n=Lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ua(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){ua(0,t),"function"!=typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fa(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=wc.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ga(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Lo(-1,1)).tag=2,Oo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var va=_.ReactCurrentOwner,_a=!1;function ba(e,t,n,r){t.child=null===e?qo(t,null,n,r):Ko(t,e.child,n,r)}function ya(e,t,n,r,i){n=n.render;var o=t.ref;return So(t,i),r=Es(e,t,n,r,o,i),n=Ss(),null===e||_a?(no&&n&&Zi(t),t.flags|=1,ba(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i))}function Ta(e,t,n,r,i){if(null===e){var o=n.type;return"function"!=typeof o||Ac(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ea(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(s,r)&&e.ref===t.ref)return Ga(e,t,i)}return t.flags|=1,(e=Lc(o,r)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(sr(o,r)&&e.ref===t.ref){if(_a=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Ga(e,t,i);0!==(131072&e.flags)&&(_a=!0)}}return xa(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wi(Ll,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wi(Ll,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,wi(Ll,Al),Al|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,wi(Ll,Al),Al|=r;return ba(e,t,i,n),t.child}function wa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xa(e,t,n,r,i){var o=Ri(n)?Ii:Mi.current;return o=ki(t,o),So(t,i),n=Es(e,t,n,r,o,i),r=Ss(),null===e||_a?(no&&r&&Zi(t),t.flags|=1,ba(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i))}function Ma(e,t,n,r,i){if(Ri(n)){var o=!0;Ni(t)}else o=!1;if(So(t,i),null===t.stateNode)Ha(e,t),Ho(t,n,r),Vo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"==typeof c&&null!==c?c=wo(c):c=ki(t,c=Ri(n)?Ii:Mi.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&Go(t,s,r,c),ko=!1;var d=t.memoizedState;s.state=d,Do(t,r,s,i),l=t.memoizedState,a!==r||d!==l||Ci.current||ko?("function"==typeof u&&(Fo(t,n,u,r),l=t.memoizedState),(a=ko||zo(t,n,a,r,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Ao(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:mo(t.type,a),s.props=c,h=t.pendingProps,d=s.context,"object"==typeof(l=n.contextType)&&null!==l?l=wo(l):l=ki(t,l=Ri(n)?Ii:Mi.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==h||d!==l)&&Go(t,s,r,l),ko=!1,d=t.memoizedState,s.state=d,Do(t,r,s,i);var f=t.memoizedState;a!==h||d!==f||Ci.current||ko?("function"==typeof p&&(Fo(t,n,p,r),f=t.memoizedState),(c=ko||zo(t,n,c,r,d,f,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ca(e,t,n,r,o,i)}function Ca(e,t,n,r,i,o){wa(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Pi(t,n,!1),Ga(e,t,o);r=t.stateNode,va.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Ko(t,e.child,null,o),t.child=Ko(t,null,a,o)):ba(e,t,a,o),t.memoizedState=r.state,i&&Pi(t,n,!0),t.child}function Ia(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ns(e,t.containerInfo)}function ka(e,t,n,r,i){return ho(),po(i),t.flags|=256,ba(e,t,n,r),t.child}var Ra,Aa,La,Oa,Na={dehydrated:null,treeContext:null,retryLane:0};function Pa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Da(e,t,n){var i,o=t.pendingProps,s=ss.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(a=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(s|=1),wi(ss,1&s),null===e)return ao(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=o.children,e=o.fallback,a?(o=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&o)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Pc(l,o,0,null),e=Nc(e,o,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Pa(n),t.memoizedState=Na,e):$a(t,l));if(null!==(s=e.memoizedState)&&null!==(i=s.dehydrated))return function(e,t,n,i,o,s,a){if(n)return 256&t.flags?(t.flags&=-257,i=ca(Error(r(422))),Ba(e,t,a,i)):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,o=t.mode,i=Pc({mode:"visible",children:i.children},o,0,null),s=Nc(s,o,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!==(1&t.mode)&&Ko(t,e.child,null,a),t.child.memoizedState=Pa(a),t.memoizedState=Na,s);if(0===(1&t.mode))return Ba(e,t,a,null);if("$!"===o.data){if(i=o.nextSibling&&o.nextSibling.dataset)var l=i.dgst;return i=l,Ba(e,t,a,i=ca(s=Error(r(419)),i,void 0))}if(l=0!==(a&e.childLanes),_a||l){if(null!==(i=Il)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(i.suspendedLanes|a))?0:o)&&o!==s.retryLane&&(s.retryLane=o,Io(e,o),tc(i,e,o,-1))}return fc(),Ba(e,t,a,i=ca(Error(r(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,to=ai(o.nextSibling),eo=t,no=!0,ro=null,null!==e&&(Wi[ji++]=Yi,Wi[ji++]=Ki,Wi[ji++]=Xi,Yi=e.id,Ki=e.overflow,Xi=t),t=$a(t,i.children),t.flags|=4096,t)}(e,t,l,o,i,s,n);if(a){a=o.fallback,l=t.mode,i=(s=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&l)&&t.child!==s?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Lc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?a=Lc(i,a):(a=Nc(a,l,n,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,l=null===(l=e.child.memoizedState)?Pa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Na,o}return e=(a=e.child).sibling,o=Lc(a,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function $a(e,t){return(t=Pc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ba(e,t,n,r){return null!==r&&po(r),Ko(t,e.child,null,n),(e=$a(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Eo(e.return,t,n)}function Ua(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function za(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(ba(e,t,r.children,n),0!==(2&(r=ss.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fa(e,n,t);else if(19===e.tag)Fa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(wi(ss,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===as(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ua(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===as(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ua(t,!0,n,null,o);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Pl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Va(e,t){if(!no)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ja(e,t,n){var i=t.pendingProps;switch(Qi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(t),null;case 1:case 17:return Ri(t.type)&&Ai(),Wa(t),null;case 3:return i=t.stateNode,rs(),Si(Ci),Si(Mi),cs(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(null===e||null===e.child)&&(co(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ro&&(oc(ro),ro=null))),Aa(e,t),Wa(t),null;case 5:os(t);var s=ts(es.current);if(n=t.type,null!==e&&null!=t.stateNode)La(e,t,n,i,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return Wa(t),null}if(e=ts(Zo.current),co(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[ui]=t,i[hi]=a,e=0!==(1&t.mode),n){case"dialog":$r("cancel",i),$r("close",i);break;case"iframe":case"object":case"embed":$r("load",i);break;case"video":case"audio":for(s=0;s<Or.length;s++)$r(Or[s],i);break;case"source":$r("error",i);break;case"img":case"image":case"link":$r("error",i),$r("load",i);break;case"details":$r("toggle",i);break;case"input":Y(i,a),$r("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},$r("invalid",i);break;case"textarea":ne(i,a),$r("invalid",i)}for(var l in ge(n,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&qr(i.textContent,c,e),s=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&qr(i.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&$r("scroll",i)}switch(n){case"input":V(i),J(i,a,!0);break;case"textarea":V(i),ie(i);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(i.onclick=Jr)}i=s,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[ui]=t,e[hi]=i,Ra(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,i),n){case"dialog":$r("cancel",e),$r("close",e),s=i;break;case"iframe":case"object":case"embed":$r("load",e),s=i;break;case"video":case"audio":for(s=0;s<Or.length;s++)$r(Or[s],e);s=i;break;case"source":$r("error",e),s=i;break;case"img":case"image":case"link":$r("error",e),$r("load",e),s=i;break;case"details":$r("toggle",e),s=i;break;case"input":Y(e,i),s=X(e,i),$r("invalid",e);break;case"option":default:s=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=P({},i,{value:void 0}),$r("invalid",e);break;case"textarea":ne(e,i),s=te(e,i),$r("invalid",e)}for(a in ge(n,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?fe(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ce(e,u):"children"===a?"string"==typeof u?("textarea"!==n||""!==u)&&ue(e,u):"number"==typeof u&&ue(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&$r("scroll",e):null!=u&&v(e,a,u,l))}switch(n){case"input":V(e),J(e,i,!1);break;case"textarea":V(e),ie(e);break;case"option":null!=i.value&&e.setAttribute("value",""+H(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ee(e,!!i.multiple,a,!1):null!=i.defaultValue&&ee(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wa(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(r(166));if(n=ts(es.current),ts(Zo.current),co(t)){if(i=t.stateNode,n=t.memoizedProps,i[ui]=t,(a=i.nodeValue!==n)&&null!==(e=eo))switch(e.tag){case 3:qr(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qr(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[ui]=t,t.stateNode=i}return Wa(t),null;case 13:if(Si(ss),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(no&&null!==to&&0!==(1&t.mode)&&0===(128&t.flags))uo(),ho(),t.flags|=98560,a=!1;else if(a=co(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(r(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(r(317));a[ui]=t}else ho(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wa(t),a=!1}else null!==ro&&(oc(ro),ro=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ss.current)?0===Ol&&(Ol=3):fc())),null!==t.updateQueue&&(t.flags|=4),Wa(t),null);case 4:return rs(),Aa(e,t),null===e&&Ur(t.stateNode.containerInfo),Wa(t),null;case 10:return To(t.type._context),Wa(t),null;case 19:if(Si(ss),null===(a=t.memoizedState))return Wa(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)Va(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=as(e))){for(t.flags|=128,Va(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return wi(ss,1&ss.current|2),t.child}e=e.sibling}null!==a.tail&&Ke()>zl&&(t.flags|=128,i=!0,Va(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=as(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Va(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!no)return Wa(t),null}else 2*Ke()-a.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,i=!0,Va(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ke(),t.sibling=null,n=ss.current,wi(ss,i?1&n|2:1&n),t):(Wa(t),null);case 22:case 23:return uc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Wa(t),6&t.subtreeFlags&&(t.flags|=8192)):Wa(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Xa(e,t){switch(Qi(t),t.tag){case 1:return Ri(t.type)&&Ai(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return rs(),Si(Ci),Si(Mi),cs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return os(t),null;case 13:if(Si(ss),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));ho()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(ss),null;case 4:return rs(),null;case 10:return To(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ra=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Aa=function(){},La=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ts(Zo.current);var s,a=null;switch(n){case"input":i=X(e,i),r=X(e,r),a=[];break;case"select":i=P({},i,{value:void 0}),r=P({},r,{value:void 0}),a=[];break;case"textarea":i=te(e,i),r=te(e,r),a=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Jr)}for(u in ge(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&$r("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oa=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ya=!1,Ka=!1,qa="function"==typeof WeakSet?WeakSet:Set,Ja=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function Qa(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var el=!1;function tl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&Qa(t,n,o)}i=i.next}while(i!==r)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ui],delete t[hi],delete t[pi],delete t[fi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(al(e,t,n),e=e.sibling;null!==e;)al(e,t,n),e=e.sibling}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)dl(e,t,n),n=n.sibling}function dl(e,t,n){if(rt&&"function"==typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(nt,n)}catch{}switch(n.tag){case 5:Ka||Za(n,t);case 6:var r=cl,i=ul;cl=null,hl(e,t,n),ul=i,null!==(cl=r)&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?si(e.parentNode,n):1===e.nodeType&&si(e,n),Ut(e)):si(cl,n.stateNode));break;case 4:r=cl,i=ul,cl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),cl=r,ul=i;break;case 0:case 11:case 14:case 15:if(!Ka&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&Qa(n,t,s),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Ka&&(Za(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Sc(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ka=(r=Ka)||null!==n.memoizedState,hl(e,t,n),Ka=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new qa),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function fl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var o=n[i];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===cl)throw Error(r(160));dl(s,a,o),cl=null,ul=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(u){Sc(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&i){try{tl(3,e,e.return),nl(3,e)}catch(g){Sc(e,e.return,g)}try{tl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:fl(t,e),gl(e),512&i&&null!==n&&Za(n,n.return);break;case 5:if(fl(t,e),gl(e),512&i&&null!==n&&Za(n,n.return),32&e.flags){var o=e.stateNode;try{ue(o,"")}catch(g){Sc(e,e.return,g)}}if(4&i&&null!=(o=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(o,s),ve(l,a);var u=ve(l,s);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?fe(o,d):"dangerouslySetInnerHTML"===h?ce(o,d):"children"===h?ue(o,d):v(o,h,d,u)}switch(l){case"input":q(o,s);break;case"textarea":re(o,s);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ee(o,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ee(o,!!s.multiple,s.defaultValue,!0):ee(o,!!s.multiple,s.multiple?[]:"",!1))}o[hi]=s}catch(g){Sc(e,e.return,g)}}break;case 6:if(fl(t,e),gl(e),4&i){if(null===e.stateNode)throw Error(r(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(g){Sc(e,e.return,g)}}break;case 3:if(fl(t,e),gl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(o=e.child).flags&&(s=null!==o.memoizedState,o.stateNode.isHidden=s,!s||null!==o.alternate&&null!==o.alternate.memoizedState||(Ul=Ke())),4&i&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ka=(u=Ka)||h,fl(t,e),Ka=u):fl(t,e),gl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Ja=e,h=e.child;null!==h;){for(d=Ja=h;null!==Ja;){switch(f=(p=Ja).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Za(p,p.return);var m=p.stateNode;if("function"==typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Sc(i,n,g)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){yl(d);continue}}null!==f?(f.return=p,Ja=f):yl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{o=d.stateNode,u?"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,a=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",a))}catch(g){Sc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:fl(t,e),gl(e),4&i&&pl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var o=i.stateNode;32&i.flags&&(ue(o,""),i.flags&=-33),ll(e,sl(e),o);break;case 3:case 4:var s=i.stateNode.containerInfo;al(e,sl(e),s);break;default:throw Error(r(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Ja=e,_l(e)}function _l(e,t,n){for(var r=0!==(1&e.mode);null!==Ja;){var i=Ja,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Ya;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ka;a=Ya;var c=Ka;if(Ya=s,(Ka=l)&&!c)for(Ja=i;null!==Ja;)l=(s=Ja).child,22===s.tag&&null!==s.memoizedState?Tl(i):null!==l?(l.return=s,Ja=l):Tl(i);for(;null!==o;)Ja=o,_l(o),o=o.sibling;Ja=i,Ya=a,Ka=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Ja=o):bl(e)}}function bl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ka||nl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ka)if(null===n)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:mo(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&$o(t,s,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$o(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(r(163))}Ka||512&t.flags&&rl(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function yl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function Tl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Sc(t,i,l)}}var o=t.return;try{rl(t)}catch(l){Sc(t,o,l)}break;case 5:var s=t.return;try{rl(t)}catch(l){Sc(t,s,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var El,Sl=Math.ceil,wl=_.ReactCurrentDispatcher,xl=_.ReactCurrentOwner,Ml=_.ReactCurrentBatchConfig,Cl=0,Il=null,kl=null,Rl=0,Al=0,Ll=Ei(0),Ol=0,Nl=null,Pl=0,Dl=0,$l=0,Bl=null,Fl=null,Ul=0,zl=1/0,Hl=null,Gl=!1,Vl=null,Wl=null,jl=!1,Xl=null,Yl=0,Kl=0,ql=null,Jl=-1,Zl=0;function Ql(){return 0!==(6&Cl)?Ke():-1!==Jl?Jl:Jl=Ke()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Rl?Rl&-Rl:null!==fo.transition?(0===Zl&&(Zl=pt()),Zl):(0!==(e=vt)||(e=void 0===(e=window.event)?16:Yt(e.type)),e)}function tc(e,t,n,i){if(50<Kl)throw Kl=0,ql=null,Error(r(185));mt(e,n,i),(0===(2&Cl)||e!==Il)&&(e===Il&&(0===(2&Cl)&&(Dl|=n),4===Ol&&sc(e,Rl)),nc(e,i),1===n&&0===Cl&&0===(1&t.mode)&&(zl=Ke()+500,$i&&Ui()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-it(o),a=1<<s,l=i[s];-1===l?(0===(a&n)||0!==(a&r))&&(i[s]=ht(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=ut(e,e===Il?Rl:0);if(0===r)null!==n&&je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&je(n),1===t)0===e.tag?function(e){$i=!0,Fi(e)}(ac.bind(null,e)):Fi(ac.bind(null,e)),ii((function(){0===(6&Cl)&&Ui()})),n=null;else{switch(_t(r)){case 1:n=Je;break;case 4:n=Ze;break;case 16:default:n=Qe;break;case 536870912:n=tt}n=Ic(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Jl=-1,Zl=0,0!==(6&Cl))throw Error(r(327));var n=e.callbackNode;if(Tc()&&e.callbackNode!==n)return null;var i=ut(e,e===Il?Rl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=mc(e,i);else{t=i;var o=Cl;Cl|=2;var s=pc();for((Il!==e||Rl!==t)&&(Hl=null,zl=Ke()+500,hc(e,t));;)try{vc();break}catch(l){dc(e,l)}yo(),wl.current=s,Cl=o,null!==kl?t=0:(Il=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(o=dt(e))&&(i=o,t=ic(e,o))),1===t)throw n=Nl,hc(e,0),sc(e,i),nc(e,Ke()),n;if(6===t)sc(e,i);else{if(o=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!or(o(),i))return!1}catch{return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=mc(e,i))&&(0!==(s=dt(e))&&(i=s,t=ic(e,s))),1===t))throw n=Nl,hc(e,0),sc(e,i),nc(e,Ke()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:case 5:yc(e,Fl,Hl);break;case 3:if(sc(e,i),(130023424&i)===i&&10<(t=Ul+500-Ke())){if(0!==ut(e,0))break;if(((o=e.suspendedLanes)&i)!==i){Ql(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ti(yc.bind(null,e,Fl,Hl),t);break}yc(e,Fl,Hl);break;case 4:if(sc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,o=-1;0<i;){var a=31-it(i);s=1<<a,(a=t[a])>o&&(o=a),i&=~s}if(i=o,10<(i=(120>(i=Ke()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Sl(i/1960))-i)){e.timeoutHandle=ti(yc.bind(null,e,Fl,Hl),i);break}yc(e,Fl,Hl);break;default:throw Error(r(329))}}}return nc(e,Ke()),e.callbackNode===n?rc.bind(null,e):null}function ic(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Fl,Fl=n,null!==t&&oc(t)),e}function oc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function sc(e,t){for(t&=~$l,t&=~Dl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function ac(e){if(0!==(6&Cl))throw Error(r(327));Tc();var t=ut(e,0);if(0===(1&t))return nc(e,Ke()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var i=dt(e);0!==i&&(t=i,n=ic(e,i))}if(1===n)throw n=Nl,hc(e,0),sc(e,t),nc(e,Ke()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yc(e,Fl,Hl),nc(e,Ke()),null}function lc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(zl=Ke()+500,$i&&Ui())}}function cc(e){null!==Xl&&0===Xl.tag&&0===(6&Cl)&&Tc();var t=Cl;Cl|=1;var n=Ml.transition,r=vt;try{if(Ml.transition=null,vt=1,e)return e()}finally{vt=r,Ml.transition=n,0===(6&(Cl=t))&&Ui()}}function uc(){Al=Ll.current,Si(Ll)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ni(n)),null!==kl)for(n=kl.return;null!==n;){var r=n;switch(Qi(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ai();break;case 3:rs(),Si(Ci),Si(Mi),cs();break;case 5:os(r);break;case 4:rs();break;case 13:case 19:Si(ss);break;case 10:To(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Il=e,kl=e=Lc(e.current,null),Rl=Al=t,Ol=0,Nl=null,$l=Dl=Pl=0,Fl=Bl=null,null!==xo){for(t=0;t<xo.length;t++)if(null!==(r=(n=xo[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}xo=null}return e}function dc(e,t){for(;;){var n=kl;try{if(yo(),us.current=ia,gs){for(var i=ps.memoizedState;null!==i;){var o=i.queue;null!==o&&(o.pending=null),i=i.next}gs=!1}if(ds=0,ms=fs=ps=null,vs=!1,_s=0,xl.current=null,null===n||null===n.return){Ol=1,Nl=t,kl=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=ma(a);if(null!==f){f.flags&=-257,ga(f,a,l,0,t),1&f.mode&&fa(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){fa(s,u,t),fc();break e}c=Error(r(426))}else if(no&&1&l.mode){var v=ma(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ga(v,a,l,0,t),po(la(c,l));break e}}s=c=la(c,l),4!==Ol&&(Ol=2),null===Bl?Bl=[s]:Bl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Po(s,da(0,c,t));break e;case 1:l=c;var _=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"==typeof _.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Po(s,pa(s,l,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(y){t=y,kl===n&&null!==n&&(kl=n=n.return);continue}break}}function pc(){var e=wl.current;return wl.current=ia,null===e?ia:e}function fc(){(0===Ol||3===Ol||2===Ol)&&(Ol=4),null===Il||0===(268435455&Pl)&&0===(268435455&Dl)||sc(Il,Rl)}function mc(e,t){var n=Cl;Cl|=2;var i=pc();for((Il!==e||Rl!==t)&&(Hl=null,hc(e,t));;)try{gc();break}catch(o){dc(e,o)}if(yo(),Cl=n,wl.current=i,null!==kl)throw Error(r(261));return Il=null,Rl=0,Ol}function gc(){for(;null!==kl;)_c(kl)}function vc(){for(;null!==kl&&!Xe();)_c(kl)}function _c(e){var t=El(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?bc(e):kl=t,xl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=ja(n,t,Al)))return void(kl=n)}else{if(null!==(n=Xa(n,t)))return n.flags&=32767,void(kl=n);if(null===e)return Ol=6,void(kl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(kl=t);kl=t=e}while(null!==t);0===Ol&&(Ol=5)}function yc(e,t,n){var i=vt,o=Ml.transition;try{Ml.transition=null,vt=1,function(e,t,n,i){do{Tc()}while(null!==Xl);if(0!==(6&Cl))throw Error(r(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-it(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Il&&(kl=Il=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||jl||(jl=!0,Ic(Qe,(function(){return Tc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Ml.transition,Ml.transition=null;var a=vt;vt=1;var l=Cl;Cl|=4,xl.current=null,function(e,t){if(Zr=Ht,hr(e=ur())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var o=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==o&&3!==d.nodeType||(l=a+o),d!==s||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===o&&(l=a),p===s&&++h===i&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qr={focusedElem:e,selectionRange:n},Ht=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:mo(t.type,g),v);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(r(163))}}catch(T){Sc(t,t.return,T)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}m=el,el=!1}(e,n),ml(n,e),dr(Qr),Ht=!!Zr,Qr=Zr=null,e.current=n,vl(n),Ye(),Cl=l,vt=a,Ml.transition=s}else e.current=n;if(jl&&(jl=!1,Xl=e,Yl=o),s=e.pendingLanes,0===s&&(Wl=null),function(e){if(rt&&"function"==typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch{}}(n.stateNode),nc(e,Ke()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(Gl)throw Gl=!1,e=Vl,Vl=null,e;0!==(1&Yl)&&0!==e.tag&&Tc(),s=e.pendingLanes,0!==(1&s)?e===ql?Kl++:(Kl=0,ql=e):Kl=0,Ui()}(e,t,n,i)}finally{Ml.transition=o,vt=i}return null}function Tc(){if(null!==Xl){var e=_t(Yl),t=Ml.transition,n=vt;try{if(Ml.transition=null,vt=16>e?16:e,null===Xl)var i=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&Cl))throw Error(r(331));var o=Cl;for(Cl|=4,Ja=e.current;null!==Ja;){var s=Ja,a=s.child;if(0!==(16&Ja.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ja=u;null!==Ja;){var h=Ja;switch(h.tag){case 0:case 11:case 15:tl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Ja=d;else for(;null!==Ja;){var p=(h=Ja).sibling,f=h.return;if(il(h),h===u){Ja=null;break}if(null!==p){p.return=f,Ja=p;break}Ja=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ja=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:tl(9,s,s.return)}var _=s.sibling;if(null!==_){_.return=s.return,Ja=_;break e}Ja=s.return}}var b=e.current;for(Ja=b;null!==Ja;){var y=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,Ja=y;else e:for(a=b;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(E){Sc(l,l.return,E)}if(l===a){Ja=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,Ja=T;break e}Ja=l.return}}if(Cl=o,Ui(),rt&&"function"==typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(nt,e)}catch{}i=!0}return i}finally{vt=n,Ml.transition=t}}return!1}function Ec(e,t,n){e=Oo(e,t=da(0,t=la(n,t),1),1),t=Ql(),null!==e&&(mt(e,1,t),nc(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Oo(t,e=pa(t,e=la(n,e),1),1),e=Ql(),null!==t&&(mt(t,1,e),nc(t,e));break}}t=t.return}}function wc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ql(),e.pingedLanes|=e.suspendedLanes&n,Il===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Ke()-Ul?hc(e,0):$l|=n),nc(e,t)}function xc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=Ql();null!==(e=Io(e,t))&&(mt(e,t,n),nc(e,n))}function Mc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),xc(e,n)}function Ic(e,t){return We(e,t)}function kc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new kc(e,t,n,r)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,i,o,s){var a=2;if(i=e,"function"==typeof e)Ac(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case T:return Nc(n.children,o,s,t);case E:a=8,o|=8;break;case S:return(e=Rc(12,n,t,2|o)).elementType=S,e.lanes=s,e;case C:return(e=Rc(13,n,t,o)).elementType=C,e.lanes=s,e;case I:return(e=Rc(19,n,t,o)).elementType=I,e.lanes=s,e;case A:return Pc(n,o,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case w:a=10;break e;case x:a=9;break e;case M:a=11;break e;case k:a=14;break e;case R:a=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,o)).elementType=e,t.type=i,t.lanes=s,t}function Nc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Pc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Dc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function $c(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,i,o,s,a,l){return e=new Bc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Rc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ro(o),e}function Uc(e){if(!e)return xi;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Oi(e,n,t)}return t}function zc(e,t,n,r,i,o,s,a,l){return(e=Fc(n,r,!0,e,0,o,0,a,l)).context=Uc(null),n=e.current,(o=Lo(r=Ql(),i=ec(n))).callback=null!=t?t:null,Oo(n,o,i),e.current.lanes=i,mt(e,i,r),nc(e,r),e}function Hc(e,t,n,r){var i=t.current,o=Ql(),s=ec(i);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Lo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oo(i,t,s))&&(tc(e,i,s,o),No(e,i,s)),s}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)_a=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _a=!1,function(e,t,n){switch(t.tag){case 3:Ia(t),ho();break;case 5:is(t);break;case 1:Ri(t.type)&&Ni(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;wi(go,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(wi(ss,1&ss.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Da(e,t,n):(wi(ss,1&ss.current),null!==(e=Ga(e,t,n))?e.sibling:null);wi(ss,1&ss.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return za(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),wi(ss,ss.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ga(e,t,n)}(e,t,n);_a=0!==(131072&e.flags)}else _a=!1,no&&0!==(1048576&t.flags)&&Ji(t,Vi,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ha(e,t),e=t.pendingProps;var o=ki(t,Mi.current);So(t,n),o=Es(null,t,i,e,o,n);var s=Ss();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(i)?(s=!0,Ni(t)):s=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Ro(t),o.updater=Uo,t.stateNode=o,o._reactInternals=t,Vo(t,i,e,n),t=Ca(null,t,i,!0,s,n)):(t.tag=0,no&&s&&Zi(t),ba(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,i=(o=i._init)(i._payload),t.type=i,o=t.tag=function(e){if("function"==typeof e)return Ac(e)?1:0;if(null!=e){if((e=e.$$typeof)===M)return 11;if(e===k)return 14}return 2}(i),e=mo(i,e),o){case 0:t=xa(null,t,i,e,n);break e;case 1:t=Ma(null,t,i,e,n);break e;case 11:t=ya(null,t,i,e,n);break e;case 14:t=Ta(null,t,i,mo(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,xa(e,t,i,o=t.elementType===i?o:mo(i,o),n);case 1:return i=t.type,o=t.pendingProps,Ma(e,t,i,o=t.elementType===i?o:mo(i,o),n);case 3:e:{if(Ia(t),null===e)throw Error(r(387));i=t.pendingProps,o=(s=t.memoizedState).element,Ao(e,t),Do(t,i,null,n);var a=t.memoizedState;if(i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=ka(e,t,i,n,o=la(Error(r(423)),t));break e}if(i!==o){t=ka(e,t,i,n,o=la(Error(r(424)),t));break e}for(to=ai(t.stateNode.containerInfo.firstChild),eo=t,no=!0,ro=null,n=qo(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ho(),i===o){t=Ga(e,t,n);break e}ba(e,t,i,n)}t=t.child}return t;case 5:return is(t),null===e&&ao(t),i=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,a=o.children,ei(i,o)?a=null:null!==s&&ei(i,s)&&(t.flags|=32),wa(e,t),ba(e,t,a,n),t.child;case 6:return null===e&&ao(t),null;case 13:return Da(e,t,n);case 4:return ns(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Ko(t,null,i,n):ba(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,ya(e,t,i,o=t.elementType===i?o:mo(i,o),n);case 7:return ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,s=t.memoizedProps,a=o.value,wi(go,i._currentValue),i._currentValue=a,null!==s)if(or(s.value,a)){if(s.children===o.children&&!Ci.current){t=Ga(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Lo(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Eo(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(r(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Eo(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}ba(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,So(t,n),i=i(o=wo(o)),t.flags|=1,ba(e,t,i,n),t.child;case 14:return o=mo(i=t.type,t.pendingProps),Ta(e,t,i,o=mo(i.type,o),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:mo(i,o),Ha(e,t),t.tag=1,Ri(i)?(e=!0,Ni(t)):e=!1,So(t,n),Ho(t,i,o),Vo(t,i,o,n),Ca(null,t,i,!0,e,n);case 19:return za(e,t,n);case 22:return Sa(e,t,n)}throw Error(r(156,t.tag))};var jc="function"==typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof i){var a=i;i=function(){var e=Gc(s);a.call(e)}}Hc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"==typeof r){var o=r;r=function(){var e=Gc(s);o.call(e)}}var s=zc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[di]=s.current,Ur(8===e.nodeType?e.parentNode:e),cc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var a=r;r=function(){var e=Gc(l);a.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[di]=l.current,Ur(8===e.nodeType?e.parentNode:e),cc((function(){Hc(t,l,n,r)})),l}(n,t,e,i,r);return Gc(s)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Hc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){Hc(null,e,null,null)})),t[di]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Pt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ct(t.pendingLanes);0!==n&&(gt(t,1|n),nc(t,Ke()),0===(6&Cl)&&(zl=Ke()+500,Ui()))}break;case 13:cc((function(){var t=Io(e,1);if(null!==t){var n=Ql();tc(t,e,1,n)}})),Wc(e,1)}},yt=function(e){if(13===e.tag){var t=Io(e,134217728);if(null!==t)tc(t,e,134217728,Ql());Wc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=ec(e),n=Io(e,t);if(null!==n)tc(n,e,t,Ql());Wc(e,t)}},Et=function(){return vt},St=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},ye=function(e,t,n){switch(t){case"input":if(q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=bi(i);if(!o)throw Error(r(90));W(i),q(i,o)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ee(e,!!n.multiple,t,!1)}},Me=lc,Ce=cc;var Qc={usingClientEntryPoint:!1,Events:[vi,_i,bi,we,xe,lc]},eu={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{nt=nu.inject(tu),rt=nu}catch{}}return cf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qc,cf.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(r(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:y,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},cf.createRoot=function(e,t){if(!Kc(e))throw Error(r(299));var n=!1,i="",o=jc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,i,o),e[di]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Xc(t)},cf.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=null===(e=Ge(t))?null:e.stateNode},cf.flushSync=function(e){return cc(e)},cf.hydrate=function(e,t,n){if(!qc(t))throw Error(r(200));return Zc(null,e,t,!0,n)},cf.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,o=!1,s="",a=jc;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,o,0,s,a),e[di]=t.current,Ur(e),i)for(e=0;e<i.length;e++)o=(o=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Yc(t)},cf.render=function(e,t,n){if(!qc(t))throw Error(r(200));return Zc(null,e,t,!1,n)},cf.unmountComponentAtNode=function(e){if(!qc(e))throw Error(r(40));return!!e._reactRootContainer&&(cc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[di]=null}))})),!0)},cf.unstable_batchedUpdates=lc,cf.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!qc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,n,!1,i)},cf.version="18.2.0-next-9e3b772b8-20220608",cf}!function(e){(function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||"function"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}})(),e.exports=mf()}(lf);var gf,vf=lf.exports;gf=vf.createRoot,vf.hydrateRoot;const _f=new yn,bf=new yn,yf=new yn;function Tf(e,t,n){const r=_f.setFromMatrixPosition(e.matrixWorld);r.project(t);const i=n.width/2,o=n.height/2;return[r.x*i+i,-r.y*o+o]}const Ef=e=>Math.abs(e)<1e-10?0:e;function Sf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="matrix3d(";for(let i=0;16!==i;i++)r+=Ef(t[i]*e.elements[i])+(15!==i?",":")");return n+r}const wf=(e=>t=>Sf(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),xf=(e,t)=>Sf(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)");const Mf=e.forwardRef(((t,n)=>{let{children:r,eps:i=.001,style:o,className:s,prepend:a,center:l,fullscreen:c,portal:u,distanceFactor:h,sprite:d=!1,transform:p=!1,occlude:f,onOcclude:g,castShadow:v,receiveShadow:_,material:b,geometry:y,zIndexRange:T=[16777271,0],calculatePosition:E=Tf,as:S="div",wrapperClass:w,pointerEvents:x="auto",...M}=t;const{gl:C,camera:I,scene:k,size:R,raycaster:A,events:L,viewport:O}=yp(),[N]=e.useState((()=>document.createElement(S))),P=e.useRef(),D=e.useRef(null),$=e.useRef(0),B=e.useRef([0,0]),F=e.useRef(null),U=e.useRef(null),z=(null==u?void 0:u.current)||L.connected||C.domElement.parentNode,H=e.useRef(null),G=e.useRef(!1),V=e.useMemo((()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"==typeof e&&"current"in e}(f[0])),[f]);e.useLayoutEffect((()=>{const e=C.domElement;f&&"blending"===f?(e.style.zIndex="".concat(Math.floor(T[0]/2)),e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[f]),e.useLayoutEffect((()=>{if(D.current){const e=P.current=gf(N);if(k.updateMatrixWorld(),p)N.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=E(D.current,I,R);N.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return z&&(a?z.prepend(N):z.appendChild(N)),()=>{z&&z.removeChild(N),e.unmount()}}}),[z,p]),e.useLayoutEffect((()=>{w&&(N.className=w)}),[w]);const W=e.useMemo((()=>p?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:l?"translate3d(-50%,-50%,0)":"none",...c&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...o}),[o,l,c,R,p]),j=e.useMemo((()=>({position:"absolute",pointerEvents:x})),[x]);e.useLayoutEffect((()=>{var e,t;(G.current=!1,p)?null==(e=P.current)||e.render(Ld("div",{ref:F,style:W,children:Ld("div",{ref:U,style:j,children:Ld("div",{ref:n,className:s,style:o,children:r})})})):null==(t=P.current)||t.render(Ld("div",{ref:n,style:W,className:s,children:r}))}));const X=e.useRef(!0);Tp((e=>{if(D.current){I.updateMatrixWorld(),D.current.updateWorldMatrix(!0,!1);const e=p?B.current:E(D.current,I,R);if(p||Math.abs($.current-I.zoom)>i||Math.abs(B.current[0]-e[0])>i||Math.abs(B.current[1]-e[1])>i){const t=function(e,t){const n=_f.setFromMatrixPosition(e.matrixWorld),r=bf.setFromMatrixPosition(t.matrixWorld),i=n.sub(r),o=t.getWorldDirection(yf);return i.angleTo(o)>Math.PI/2}(D.current,I);let n=!1;V&&("blending"!==f?n=[k]:Array.isArray(f)&&(n=f.map((e=>e.current))));const r=X.current;if(n){const e=function(e,t,n,r){const i=_f.setFromMatrixPosition(e.matrixWorld),o=i.clone();o.project(t),n.setFromCamera(o,t);const s=n.intersectObjects(r,!0);if(s.length){const e=s[0].distance;return i.distanceTo(n.ray.origin)<e}return!0}(D.current,I,A,n);X.current=e&&!t}else X.current=!t;r!==X.current&&(g?g(!X.current):N.style.display=X.current?"block":"none");const i=Math.floor(T[0]/2),o=f?V?[T[0],i]:[i-1,0]:T;if(N.style.zIndex="".concat(function(e,t,n){if(t instanceof Ei||t instanceof ji){const r=_f.setFromMatrixPosition(e.matrixWorld),i=bf.setFromMatrixPosition(t.matrixWorld),o=r.distanceTo(i),s=(n[1]-n[0])/(t.far-t.near),a=n[1]-s*t.far;return Math.round(s*o+a)}}(D.current,I,o)),p){const[e,t]=[R.width/2,R.height/2],n=I.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:i,left:o,bottom:s,right:a}=I,l=wf(I.matrixWorldInverse),c=r?"scale(".concat(n,")translate(").concat(Ef(-(a+o)/2),"px,").concat(Ef((i+s)/2),"px)"):"translateZ(".concat(n,"px)");let u=D.current.matrixWorld;d&&(u=I.matrixWorldInverse.clone().transpose().copyPosition(u).scale(D.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),N.style.width=R.width+"px",N.style.height=R.height+"px",N.style.perspective=r?"":"".concat(n,"px"),F.current&&U.current&&(F.current.style.transform="".concat(c).concat(l,"translate(").concat(e,"px,").concat(t,"px)"),U.current.style.transform=xf(u,1/((h||10)/400)))}else{const t=void 0===h?1:function(e,t){if(t instanceof ji)return t.zoom;if(t instanceof Ei){const n=_f.setFromMatrixPosition(e.matrixWorld),r=bf.setFromMatrixPosition(t.matrixWorld),i=t.fov*Math.PI/180,o=n.distanceTo(r);return 1/(2*Math.tan(i/2)*o)}return 1}(D.current,I)*h;N.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}B.current=e,$.current=I.zoom}}if(!V&&H.current&&!G.current)if(p){if(F.current){const e=F.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=I;if(t||y)M.scale&&(Array.isArray(M.scale)?M.scale instanceof yn?H.current.scale.copy(M.scale.clone().divideScalar(1)):H.current.scale.set(1/M.scale[0],1/M.scale[1],1/M.scale[2]):H.current.scale.setScalar(1/M.scale));else{const t=(h||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;H.current.scale.set(n,r,1)}G.current=!0}}}else{const t=N.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/O.factor,n=t.clientWidth*e,r=t.clientHeight*e;H.current.scale.set(n,r,1),G.current=!0}H.current.lookAt(e.camera.position)}}));const Y=e.useMemo((()=>({vertexShader:p?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom" \n            is false. \n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n            \n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[p]);return Ld("group",{...M,ref:D,children:f&&!V&&Od("mesh",{castShadow:v,receiveShadow:_,ref:H,children:[y||Ld("planeGeometry",{}),b||Ld("shaderMaterial",{side:m,vertexShader:Y.vertexShader,fragmentShader:Y.fragmentShader})]})})}));function Cf(e){return function(t){e.forEach((function(e){"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const If=new yn,kf=new zh,Rf=new Ri,Af=new yn,Lf=new Or;class Of{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new $f,this.unassigned=new $f,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.vertices.push(new Df(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse((function(e){const n=e.geometry;if(void 0!==n){if(n.isGeometry)return void console.error("THREE.ConvexHull no longer supports Geometry. Use THREE.BufferGeometry instead.");if(n.isBufferGeometry){const r=n.attributes.position;if(void 0!==r)for(let n=0,i=r.count;n<i;n++){const i=new yn;i.fromBufferAttribute(r,n).applyMatrix4(e.matrixWorld),t.push(i)}}}})),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let n=0,r=t.length;n<r;n++)if(t[n].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const n=this.faces;let r=-1/0,i=1/0;for(let o=0,s=n.length;o<s;o++){const t=n[o],s=t.distanceToPoint(e.origin),a=t.normal.dot(e.direction);if(s>0&&a>=0)return null;const l=0!==a?-s/a:0;if(!(l<=0)&&(a>0?i=Math.min(l,i):r=Math.max(l,r),r>i))return null}return r!==-1/0?e.at(r,t):e.at(i,t),t}intersectsRay(e){return null!==this.intersectRay(e,If)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let n=e.outside;for(;null!==n.next&&n.next.face===e;)n=n.next;return this.assigned.removeSubList(t,n),t.prev=n.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const n=this.removeAllVerticesFromFace(e);if(void 0!==n)if(void 0===t)this.unassigned.appendChain(n);else{let e=n;do{const n=e.next;t.distanceToPoint(e.point)>this.tolerance?this.addVertexToFace(e,t):this.unassigned.append(e),e=n}while(null!==e)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const n=t.next;let r=this.tolerance,i=null;for(let o=0;o<e.length;o++){const n=e[o];if(0===n.mark){const e=n.distanceToPoint(t.point);if(e>r&&(r=e,i=n),r>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(t,i),t=n}while(null!==t)}return this}computeExtremes(){const e=new yn,t=new yn,n=[],r=[];for(let i=0;i<3;i++)n[i]=r[i]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let i=0,o=this.vertices.length;i<o;i++){const o=this.vertices[i],s=o.point;for(let t=0;t<3;t++)s.getComponent(t)<e.getComponent(t)&&(e.setComponent(t,s.getComponent(t)),n[t]=o);for(let e=0;e<3;e++)s.getComponent(e)>t.getComponent(e)&&(t.setComponent(e,s.getComponent(e)),r[e]=o)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:n,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),n=t.min,r=t.max;let i=0,o=0;for(let h=0;h<3;h++){const e=r[h].point.getComponent(h)-n[h].point.getComponent(h);e>i&&(i=e,o=h)}const s=n[o],a=r[o];let l,c;i=0,kf.set(s.point,a.point);for(let h=0,d=this.vertices.length;h<d;h++){const t=e[h];if(t!==s&&t!==a){kf.closestPointToPoint(t.point,!0,Af);const e=Af.distanceToSquared(t.point);e>i&&(i=e,l=t)}}i=-1,Rf.setFromCoplanarPoints(s.point,a.point,l.point);for(let h=0,d=this.vertices.length;h<d;h++){const t=e[h];if(t!==s&&t!==a&&t!==l){const e=Math.abs(Rf.distanceToPoint(t.point));e>i&&(i=e,c=t)}}const u=[];if(Rf.distanceToPoint(c.point)<0){u.push(Nf.create(s,a,l),Nf.create(c,a,s),Nf.create(c,l,a),Nf.create(c,s,l));for(let e=0;e<3;e++){const t=(e+1)%3;u[e+1].getEdge(2).setTwin(u[0].getEdge(t)),u[e+1].getEdge(1).setTwin(u[t+1].getEdge(0))}}else{u.push(Nf.create(s,l,a),Nf.create(c,s,a),Nf.create(c,a,l),Nf.create(c,l,s));for(let e=0;e<3;e++){const t=(e+1)%3;u[e+1].getEdge(2).setTwin(u[0].getEdge((3-e)%3)),u[e+1].getEdge(0).setTwin(u[t+1].getEdge(1))}}for(let h=0;h<4;h++)this.faces.push(u[h]);for(let h=0,d=e.length;h<d;h++){const t=e[h];if(t!==s&&t!==a&&t!==l&&t!==c){i=this.tolerance;let e=null;for(let n=0;n<4;n++){const r=this.faces[n].distanceToPoint(t.point);r>i&&(i=r,e=this.faces[n])}null!==e&&this.addVertexToFace(t,e)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const n=this.faces[t];0===n.mark&&e.push(n)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const n=this.assigned.first().face;let r=n.outside;do{const i=n.distanceToPoint(r.point);i>t&&(t=i,e=r),r=r.next}while(null!==r&&r.face===n);return e}}computeHorizon(e,t,n,r){let i;this.deleteFaceVertices(n),n.mark=1,i=null===t?t=n.getEdge(0):t.next;do{const t=i.twin,n=t.face;0===n.mark&&(n.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,t,n,r):r.push(i)),i=i.next}while(i!==t);return this}addAdjoiningFace(e,t){const n=Nf.create(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setTwin(t.twin),n.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let n=null,r=null;for(let i=0;i<t.length;i++){const o=t[i],s=this.addAdjoiningFace(e,o);null===n?n=s:s.next.setTwin(r),this.newFaces.push(s.face),r=s}return n.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class Nf{constructor(){this.normal=new yn,this.midpoint=new yn,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,n){const r=new Nf,i=new Pf(e,r),o=new Pf(t,r),s=new Pf(n,r);return i.next=s.prev=o,o.next=i.prev=s,s.next=o.prev=i,r.edge=i,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),n=this.edge.next.head();return Lf.set(e.point,t.point,n.point),Lf.getNormal(this.normal),Lf.getMidpoint(this.midpoint),this.area=Lf.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class Pf{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class Df{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class $f{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class Bf extends qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super();const t=[],n=[];void 0===Of&&console.error("THREE.ConvexGeometry: ConvexGeometry relies on ConvexHull");const r=(new Of).setFromPoints(e).faces;for(let i=0;i<r.length;i++){const e=r[i];let o=e.edge;do{const r=o.head().point;t.push(r.x,r.y,r.z),n.push(e.normal.x,e.normal.y,e.normal.z),o=o.next}while(o!==e.edge)}this.setAttribute("position",new Hr(t,3)),this.setAttribute("normal",new Hr(n,3))}}function Ff(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Uf=(e,t)=>{const n=null!==e[0].index,r=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),o={},s={},a=e[0].morphTargetsRelative,l=new qr;let c=0;if(e.forEach(((e,u)=>{let h=0;if(n!==(null!==e.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let t in e.attributes){if(!r.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[t]&&(o[t]=[]),o[t].push(e.attributes[t]),h++}if(h!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==e.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let t in e.morphAttributes){if(!i.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[t]&&(s[t]=[]),s[t].push(e.morphAttributes[t])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(e.userData),t){let t;if(e.index)t=e.index.count;else{if(void 0===e.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;t=e.attributes.position.count}l.addGroup(c,t,u),c+=t}})),n){let t=0;const n=[];e.forEach((e=>{const r=e.index;for(let i=0;i<r.count;++i)n.push(r.getX(i)+t);t+=e.attributes.position.count})),l.setIndex(n)}for(let u in o){const e=zf(o[u]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,e)}for(let u in s){const e=s[u][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let t=0;t<e;++t){const e=[];for(let r=0;r<s[u].length;++r)e.push(s[u][r][t]);const n=zf(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(n)}}return l},zf=e=>{let t,n,r,i=0;if(e.forEach((e=>(void 0===t&&(t=e.array.constructor),t!==e.array.constructor?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null):(void 0===n&&(n=e.itemSize),n!==e.itemSize?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null):(void 0===r&&(r=e.normalized),r!==e.normalized?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null):void(i+=e.array.length)))))),t&&n){const o=new t(i);let s=0;return e.forEach((e=>{o.set(e.array,s),s+=e.array.length})),new Fr(o,n,r)}},Hf=(e,t)=>(e%t+t)%t;class Gf extends Lt{constructor(e,t){super(),Ff(this,"object",void 0),Ff(this,"domElement",void 0),Ff(this,"enabled",!0),Ff(this,"target",new yn),Ff(this,"minDistance",0),Ff(this,"maxDistance",1/0),Ff(this,"minZoom",0),Ff(this,"maxZoom",1/0),Ff(this,"minPolarAngle",0),Ff(this,"maxPolarAngle",Math.PI),Ff(this,"minAzimuthAngle",-1/0),Ff(this,"maxAzimuthAngle",1/0),Ff(this,"enableDamping",!1),Ff(this,"dampingFactor",.05),Ff(this,"enableZoom",!0),Ff(this,"zoomSpeed",1),Ff(this,"enableRotate",!0),Ff(this,"rotateSpeed",1),Ff(this,"enablePan",!0),Ff(this,"panSpeed",1),Ff(this,"screenSpacePanning",!0),Ff(this,"keyPanSpeed",7),Ff(this,"autoRotate",!1),Ff(this,"autoRotateSpeed",2),Ff(this,"reverseOrbit",!1),Ff(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ff(this,"mouseButtons",{LEFT:o.ROTATE,MIDDLE:o.DOLLY,RIGHT:o.PAN}),Ff(this,"touches",{ONE:s.ROTATE,TWO:s.DOLLY_PAN}),Ff(this,"target0",void 0),Ff(this,"position0",void 0),Ff(this,"zoom0",void 0),Ff(this,"_domElementKeyEvents",null),Ff(this,"getPolarAngle",void 0),Ff(this,"getAzimuthalAngle",void 0),Ff(this,"setPolarAngle",void 0),Ff(this,"setAzimuthalAngle",void 0),Ff(this,"getDistance",void 0),Ff(this,"listenToKeyEvents",void 0),Ff(this,"saveState",void 0),Ff(this,"reset",void 0),Ff(this,"update",void 0),Ff(this,"connect",void 0),Ff(this,"dispose",void 0),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof Ei?this.object.zoom:1,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=e=>{let t=Hf(e,2*Math.PI),r=h.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=Hf(e,2*Math.PI),r=h.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",Y),this._domElementKeyEvents=e},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object instanceof Ei?n.object.zoom:1},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object instanceof Ei&&(n.object.zoom=n.zoom0,n.object.updateProjectionMatrix()),n.dispatchEvent(r),n.update(),c=l.NONE},this.update=(()=>{const t=new yn,i=(new bn).setFromUnitVectors(e.up,new yn(0,1,0)),o=i.clone().invert(),s=new yn,a=new bn,g=2*Math.PI;return function(){const e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(i),h.setFromVector3(t),n.autoRotate&&c===l.NONE&&I(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(h.theta+=d.theta*n.dampingFactor,h.phi+=d.phi*n.dampingFactor):(h.theta+=d.theta,h.phi+=d.phi);let v=n.minAzimuthAngle,_=n.maxAzimuthAngle;return isFinite(v)&&isFinite(_)&&(v<-Math.PI?v+=g:v>Math.PI&&(v-=g),_<-Math.PI?_+=g:_>Math.PI&&(_-=g),h.theta=v<=_?Math.max(v,Math.min(_,h.theta)):h.theta>(v+_)/2?Math.max(v,h.theta):Math.min(_,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=p,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),!0===n.enableDamping?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),t.setFromSpherical(h),t.applyQuaternion(o),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),f.set(0,0,0)),p=1,!!(m||s.distanceToSquared(n.object.position)>u||8*(1-a.dot(n.object.quaternion))>u)&&(n.dispatchEvent(r),s.copy(n.object.position),a.copy(n.object.quaternion),m=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",K),n.domElement.addEventListener("pointerdown",G),n.domElement.addEventListener("pointercancel",j),n.domElement.addEventListener("wheel",X)},this.dispose=()=>{var e,t,r,i,o,s;null===(e=n.domElement)||void 0===e||e.removeEventListener("contextmenu",K),null===(t=n.domElement)||void 0===t||t.removeEventListener("pointerdown",G),null===(r=n.domElement)||void 0===r||r.removeEventListener("pointercancel",j),null===(i=n.domElement)||void 0===i||i.removeEventListener("wheel",X),null===(o=n.domElement)||void 0===o||o.ownerDocument.removeEventListener("pointermove",V),null===(s=n.domElement)||void 0===s||s.ownerDocument.removeEventListener("pointerup",W),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Y)};const n=this,r={type:"change"},i={type:"start"},a={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=l.NONE;const u=1e-6,h=new $h,d=new $h;let p=1;const f=new yn;let m=!1;const g=new Wt,v=new Wt,_=new Wt,b=new Wt,y=new Wt,T=new Wt,E=new Wt,S=new Wt,w=new Wt,x=[],M={};function C(){return Math.pow(.95,n.zoomSpeed)}function I(e){n.reverseOrbit?d.theta+=e:d.theta-=e}function k(e){n.reverseOrbit?d.phi+=e:d.phi-=e}const R=(()=>{const e=new yn;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),f.add(e)}})(),A=(()=>{const e=new yn;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),f.add(e)}})(),L=(()=>{const e=new yn;return function(t,r){const i=n.domElement;if(i&&n.object instanceof Ei&&n.object.isPerspectiveCamera){const o=n.object.position;e.copy(o).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),R(2*t*s/i.clientHeight,n.object.matrix),A(2*r*s/i.clientHeight,n.object.matrix)}else i&&n.object instanceof ji&&n.object.isOrthographicCamera?(R(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),A(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function O(e){n.object instanceof Ei&&n.object.isPerspectiveCamera?p/=e:n.object instanceof ji&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(e){n.object instanceof Ei&&n.object.isPerspectiveCamera?p*=e:n.object instanceof ji&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function P(e){g.set(e.clientX,e.clientY)}function D(e){b.set(e.clientX,e.clientY)}function $(){if(1==x.length)g.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);g.set(e,t)}}function B(){if(1==x.length)b.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);b.set(e,t)}}function F(){const e=x[0].pageX-x[1].pageX,t=x[0].pageY-x[1].pageY,n=Math.sqrt(e*e+t*t);E.set(0,n)}function U(e){if(1==x.length)v.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);v.set(n,r)}_.subVectors(v,g).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(I(2*Math.PI*_.x/t.clientHeight),k(2*Math.PI*_.y/t.clientHeight)),g.copy(v)}function z(e){if(1==x.length)y.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}T.subVectors(y,b).multiplyScalar(n.panSpeed),L(T.x,T.y),b.copy(y)}function H(e){const t=Z(e),r=e.pageX-t.x,i=e.pageY-t.y,o=Math.sqrt(r*r+i*i);S.set(0,o),w.set(0,Math.pow(S.y/E.y,n.zoomSpeed)),O(w.y),E.copy(S)}function G(e){if(!1!==n.enabled){var t,r;if(0===x.length)null===(t=n.domElement)||void 0===t||t.ownerDocument.addEventListener("pointermove",V),null===(r=n.domElement)||void 0===r||r.ownerDocument.addEventListener("pointerup",W);(function(e){x.push(e)})(e),"touch"===e.pointerType?function(e){switch(J(e),x.length){case 1:switch(n.touches.ONE){case s.ROTATE:if(!1===n.enableRotate)return;$(),c=l.TOUCH_ROTATE;break;case s.PAN:if(!1===n.enablePan)return;B(),c=l.TOUCH_PAN;break;default:c=l.NONE}break;case 2:switch(n.touches.TWO){case s.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&F(),n.enablePan&&B(),c=l.TOUCH_DOLLY_PAN;break;case s.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&F(),n.enableRotate&&$(),c=l.TOUCH_DOLLY_ROTATE;break;default:c=l.NONE}break;default:c=l.NONE}c!==l.NONE&&n.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case o.DOLLY:if(!1===n.enableZoom)return;(function(e){E.set(e.clientX,e.clientY)})(e),c=l.DOLLY;break;case o.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;D(e),c=l.PAN}else{if(!1===n.enableRotate)return;P(e),c=l.ROTATE}break;case o.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;P(e),c=l.ROTATE}else{if(!1===n.enablePan)return;D(e),c=l.PAN}break;default:c=l.NONE}c!==l.NONE&&n.dispatchEvent(i)}(e)}}function V(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(J(e),c){case l.TOUCH_ROTATE:if(!1===n.enableRotate)return;U(e),n.update();break;case l.TOUCH_PAN:if(!1===n.enablePan)return;z(e),n.update();break;case l.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(e){n.enableZoom&&H(e),n.enablePan&&z(e)})(e),n.update();break;case l.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(e){n.enableZoom&&H(e),n.enableRotate&&U(e)})(e),n.update();break;default:c=l.NONE}}(e):function(e){if(!1!==n.enabled)switch(c){case l.ROTATE:if(!1===n.enableRotate)return;!function(e){v.set(e.clientX,e.clientY),_.subVectors(v,g).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(I(2*Math.PI*_.x/t.clientHeight),k(2*Math.PI*_.y/t.clientHeight)),g.copy(v),n.update()}(e);break;case l.DOLLY:if(!1===n.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),w.subVectors(S,E),w.y>0?O(C()):w.y<0&&N(C()),E.copy(S),n.update()}(e);break;case l.PAN:if(!1===n.enablePan)return;!function(e){y.set(e.clientX,e.clientY),T.subVectors(y,b).multiplyScalar(n.panSpeed),L(T.x,T.y),b.copy(y),n.update()}(e)}}(e))}function W(e){var t,r,i;(q(e),0===x.length)&&(null===(t=n.domElement)||void 0===t||t.releasePointerCapture(e.pointerId),null===(r=n.domElement)||void 0===r||r.ownerDocument.removeEventListener("pointermove",V),null===(i=n.domElement)||void 0===i||i.ownerDocument.removeEventListener("pointerup",W));n.dispatchEvent(a),c=l.NONE}function j(e){q(e)}function X(e){!1===n.enabled||!1===n.enableZoom||c!==l.NONE&&c!==l.ROTATE||(e.preventDefault(),n.dispatchEvent(i),function(e){e.deltaY<0?N(C()):e.deltaY>0&&O(C()),n.update()}(e),n.dispatchEvent(a))}function Y(e){!1===n.enabled||!1===n.enablePan||function(e){let t=!1;switch(e.code){case n.keys.UP:L(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:L(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:L(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:L(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function K(e){!1!==n.enabled&&e.preventDefault()}function q(e){delete M[e.pointerId];for(let t=0;t<x.length;t++)if(x[t].pointerId==e.pointerId)return void x.splice(t,1)}function J(e){let t=M[e.pointerId];void 0===t&&(t=new Wt,M[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){const t=e.pointerId===x[0].pointerId?x[1]:x[0];return M[t.pointerId]}void 0!==t&&this.connect(t),this.update()}}const Vf=new yn;function Wf(e,t,n,r,i,o){const s=2*Math.PI*i/4,a=Math.max(o-2*i,0),l=Math.PI/4;Vf.copy(t),Vf[r]=0,Vf.normalize();const c=.5*s/(s+a),u=1-Vf.angleTo(e)/l;return 1===Math.sign(Vf[n])?u*c:a/(s+a)+c+c*(1-u)}class jf extends gi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1;if(r=2*r+1,i=Math.min(e/2,t/2,n/2,i),super(1,1,1,r,r,r),1===r)return;const o=this.toNonIndexed();this.index=null,this.attributes.position=o.attributes.position,this.attributes.normal=o.attributes.normal,this.attributes.uv=o.attributes.uv;const s=new yn,a=new yn,l=new yn(e,t,n).divideScalar(2).subScalar(i),c=this.attributes.position.array,u=this.attributes.normal.array,h=this.attributes.uv.array,d=c.length/6,p=new yn,f=.5/r;for(let m=0,g=0;m<c.length;m+=3,g+=2)switch(s.fromArray(c,m),a.copy(s),a.x-=Math.sign(a.x)*f,a.y-=Math.sign(a.y)*f,a.z-=Math.sign(a.z)*f,a.normalize(),c[m+0]=l.x*Math.sign(s.x)+a.x*i,c[m+1]=l.y*Math.sign(s.y)+a.y*i,c[m+2]=l.z*Math.sign(s.z)+a.z*i,u[m+0]=a.x,u[m+1]=a.y,u[m+2]=a.z,Math.floor(m/d)){case 0:p.set(1,0,0),h[g+0]=Wf(p,a,"z","y",i,n),h[g+1]=1-Wf(p,a,"y","z",i,t);break;case 1:p.set(-1,0,0),h[g+0]=1-Wf(p,a,"z","y",i,n),h[g+1]=1-Wf(p,a,"y","z",i,t);break;case 2:p.set(0,1,0),h[g+0]=1-Wf(p,a,"x","z",i,e),h[g+1]=Wf(p,a,"z","x",i,n);break;case 3:p.set(0,-1,0),h[g+0]=1-Wf(p,a,"x","z",i,e),h[g+1]=1-Wf(p,a,"z","x",i,n);break;case 4:p.set(0,0,1),h[g+0]=1-Wf(p,a,"x","y",i,e),h[g+1]=1-Wf(p,a,"y","x",i,t);break;case 5:p.set(0,0,-1),h[g+0]=Wf(p,a,"x","y",i,e),h[g+1]=1-Wf(p,a,"y","x",i,t)}}}const Xf=new Sn,Yf=new yn;class Kf extends eh{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new Hr([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new Hr([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Oh(t,6,1);return this.setAttribute("instanceStart",new Sa(n,3,0)),this.setAttribute("instanceEnd",new Sa(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Oh(t,6,1);return this.setAttribute("instanceColorStart",new Sa(n,3,0)),this.setAttribute("instanceColorEnd",new Sa(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Wc(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Sn);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Xf.setFromBufferAttribute(t),this.boundingBox.union(Xf))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Hn),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let i=0,o=e.count;i<o;i++)Yf.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Yf)),Yf.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(Yf));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class qf extends Kf{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setColors(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}Bi.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Wt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},Fi.line={uniforms:bi.merge([Bi.common,Bi.fog,Bi.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 offset;\n\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t}\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t#endif\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t// set the world position\n\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class Jf extends yi{constructor(e){super({type:"LineMaterial",uniforms:bi.clone(Fi.line.uniforms),vertexShader:Fi.line.vertexShader,fragmentShader:Fi.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(e){Boolean(e)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)},set:function(e){Boolean(e)!==Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const Zf=new yn,Qf=new yn,em=new mn,tm=new mn,nm=new mn,rm=new yn,im=new Jn,om=new zh,sm=new yn,am=new Sn,lm=new Hn,cm=new mn;let um,hm,dm,pm;function fm(e,t,n){return cm.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),cm.multiplyScalar(1/cm.w),cm.x=pm/n.width,cm.y=pm/n.height,cm.applyMatrix4(e.projectionMatrixInverse),cm.multiplyScalar(1/cm.w),Math.abs(Math.max(cm.x,cm.y))}class mm extends fi{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kf,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Jf({color:16777215*Math.random()})),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,s=0,a=t.count;o<a;o++,s+=2)Zf.fromBufferAttribute(t,o),Qf.fromBufferAttribute(n,o),r[s]=0===s?0:r[s-1],r[s+1]=r[s]+Zf.distanceTo(Qf);const i=new Oh(r,2,1);return e.setAttribute("instanceDistanceStart",new Sa(i,1,0)),e.setAttribute("instanceDistanceEnd",new Sa(i,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;null===r&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const i=void 0!==e.params.Line2&&e.params.Line2.threshold||0;um=e.ray;const o=this.matrixWorld,s=this.geometry,a=this.material;let l,c;if(pm=a.linewidth+i,hm=s.attributes.instanceStart,dm=s.attributes.instanceEnd,null===s.boundingSphere&&s.computeBoundingSphere(),lm.copy(s.boundingSphere).applyMatrix4(o),n)l=.5*pm;else{l=fm(r,Math.max(r.near,lm.distanceToPoint(um.origin)),a.resolution)}if(lm.radius+=l,!1!==um.intersectsSphere(lm)){if(null===s.boundingBox&&s.computeBoundingBox(),am.copy(s.boundingBox).applyMatrix4(o),n)c=.5*pm;else{c=fm(r,Math.max(r.near,am.distanceToPoint(um.origin)),a.resolution)}am.expandByScalar(c),!1!==um.intersectsBox(am)&&(n?function(e,t){for(let n=0,r=hm.count;n<r;n++){om.start.fromBufferAttribute(hm,n),om.end.fromBufferAttribute(dm,n);const r=new yn,i=new yn;um.distanceSqToSegment(om.start,om.end,i,r),i.distanceTo(r)<.5*pm&&t.push({point:i,pointOnLine:r,distance:um.origin.distanceTo(i),object:e,face:null,faceIndex:n,uv:null,uv2:null})}}(this,t):function(e,t,n){const r=t.projectionMatrix,i=e.material.resolution,o=e.matrixWorld,s=e.geometry,a=s.attributes.instanceStart,l=s.attributes.instanceEnd,c=-t.near;um.at(1,nm),nm.w=1,nm.applyMatrix4(t.matrixWorldInverse),nm.applyMatrix4(r),nm.multiplyScalar(1/nm.w),nm.x*=i.x/2,nm.y*=i.y/2,nm.z=0,rm.copy(nm),im.multiplyMatrices(t.matrixWorldInverse,o);for(let u=0,h=a.count;u<h;u++){if(em.fromBufferAttribute(a,u),tm.fromBufferAttribute(l,u),em.w=1,tm.w=1,em.applyMatrix4(im),tm.applyMatrix4(im),em.z>c&&tm.z>c)continue;if(em.z>c){const e=em.z-tm.z,t=(em.z-c)/e;em.lerp(tm,t)}else if(tm.z>c){const e=tm.z-em.z,t=(tm.z-c)/e;tm.lerp(em,t)}em.applyMatrix4(r),tm.applyMatrix4(r),em.multiplyScalar(1/em.w),tm.multiplyScalar(1/tm.w),em.x*=i.x/2,em.y*=i.y/2,tm.x*=i.x/2,tm.y*=i.y/2,om.start.copy(em),om.start.z=0,om.end.copy(tm),om.end.z=0;const t=om.closestPointToPointParameter(rm,!0);om.at(t,sm);const s=Vt.lerp(em.z,tm.z,t),h=s>=-1&&s<=1,d=rm.distanceTo(sm)<.5*pm;if(h&&d){om.start.fromBufferAttribute(a,u),om.end.fromBufferAttribute(l,u),om.start.applyMatrix4(o),om.end.applyMatrix4(o);const t=new yn,r=new yn;um.distanceSqToSegment(om.start,om.end,r,t),n.push({point:r,pointOnLine:t,distance:um.origin.distanceTo(r),object:e,face:null,faceIndex:u,uv:null,uv2:null})}}}(this,r,t))}}}class gm extends mm{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qf,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Jf({color:16777215*Math.random()})),this.isLine2=!0,this.type="Line2"}}const vm=e.forwardRef((function(t,n){let{follow:r=!0,lockX:i=!1,lockY:o=!1,lockZ:s=!1,...a}=t;const l=e.useRef();return Tp((e=>{let{camera:t}=e;if(!r||!l.current)return;const n=l.current.rotation.clone();t.getWorldQuaternion(l.current.quaternion),i&&(l.current.rotation.x=n.x),o&&(l.current.rotation.y=n.y),s&&(l.current.rotation.z=n.z)})),Ld("group",{ref:Cf([l,n]),...a})})),_m=e.forwardRef((function(t,n){let{points:r,color:i="black",vertexColors:o,linewidth:s,lineWidth:a,segments:l,dashed:c,...u}=t;const h=yp((e=>e.size)),d=e.useMemo((()=>l?new mm:new gm),[l]),[p]=e.useState((()=>new Jf)),f=e.useMemo((()=>{const e=l?new Kf:new qf,t=r.map((e=>{const t=Array.isArray(e);return e instanceof yn?[e.x,e.y,e.z]:e instanceof Wt?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(e.setPositions(t.flat()),o){const t=o.map((e=>e instanceof ln?e.toArray():e));e.setColors(t.flat())}return e}),[r,l,o]);return e.useLayoutEffect((()=>{d.computeLineDistances()}),[r,d]),e.useLayoutEffect((()=>{c?p.defines.USE_DASH="":delete p.defines.USE_DASH,p.needsUpdate=!0}),[c,p]),e.useEffect((()=>()=>f.dispose()),[f]),Od("primitive",{object:d,ref:n,...u,children:[Ld("primitive",{object:f,attach:"geometry"}),Ld("primitive",{object:p,attach:"material",color:i,vertexColors:Boolean(o),resolution:[h.width,h.height],linewidth:null!=s?s:a,dashed:c,...u})]})}));function bm(){var e=Object.create(null);function t(r,i){var o=r.id,s=r.name,a=r.dependencies;void 0===a&&(a=[]);var l=r.init;void 0===l&&(l=function(){});var c=r.getTransferables;if(void 0===c&&(c=null),!e[o])try{a=a.map((function(n){return n&&n.isWorkerModule&&(t(n,(function(e){if(e instanceof Error)throw e})),n=e[n.id].value),n})),l=n("<"+s+">.init",l),c&&(c=n("<"+s+">.getTransferables",c));var u=null;"function"==typeof l?u=l.apply(void 0,a):console.error("worker module init function failed to rehydrate"),e[o]={id:o,value:u,getTransferables:c},i(u)}catch(h){h&&h.noLog||console.error(h),i(h)}}function n(e,t){var n=void 0;self.troikaDefine=function(e){return n=e};var r=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(r)}catch(i){console.error(i)}return URL.revokeObjectURL(r),delete self.troikaDefine,n}self.addEventListener("message",(function(n){var r=n.data,i=r.messageId,o=r.action,s=r.data;try{"registerModule"===o&&t(s,(function(e){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:{isCallable:"function"==typeof e}})})),"callModule"===o&&function(t,n){var r,i=t.id,o=t.args;(!e[i]||"function"!=typeof e[i].value)&&n(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var s=(r=e[i]).value.apply(r,o);s&&"function"==typeof s.then?s.then(a,(function(e){return n(e instanceof Error?e:new Error(""+e))})):a(s)}catch(l){n(l)}function a(t){try{var r=e[i].getTransferables&&e[i].getTransferables(t);(!r||!Array.isArray(r)||!r.length)&&(r=void 0),n(t,r)}catch(o){console.error(o),n(o)}}}(s,(function(e,t){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:e},t||void 0)}))}catch(a){postMessage({messageId:i,success:!1,error:a.stack})}}))}var ym=function(){var e=!1;if(typeof window<"u"&&typeof window.document<"u")try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return ym=function(){return e},e},Tm=0,Em=0,Sm=!1,wm=Object.create(null),xm=Object.create(null),Mm=Object.create(null);function Cm(e){if((!e||"function"!=typeof e.init)&&!Sm)throw new Error("requires `options.init` function");var t=e.dependencies,n=e.init,r=e.getTransferables,i=e.workerId;if(!ym())return function(e){var t=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return t._getInitResult().then((function(t){if("function"==typeof t)return t.apply(void 0,e);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return t._getInitResult=function(){var n=e.dependencies,r=e.init;n=Array.isArray(n)?n.map((function(e){return e&&e._getInitResult?e._getInitResult():e})):[];var i=Promise.all(n).then((function(e){return r.apply(null,e)}));return t._getInitResult=function(){return i},i},t}(e);null==i&&(i="#default");var o="workerModule"+ ++Tm,s=e.name||o,a=null;function l(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!a){a=km(i,"registerModule",l.workerModuleData);var n=function(){a=null,xm[i].delete(n)};(xm[i]||(xm[i]=new Set)).add(n)}return a.then((function(t){if(t.isCallable)return km(i,"callModule",{id:o,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return t=t&&t.map((function(e){return"function"==typeof e&&!e.workerModuleData&&(Sm=!0,e=Cm({workerId:i,name:"<"+s+"> function dependency: "+e.name,init:"function(){return (\n"+Im(e)+"\n)}"}),Sm=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e})),l.workerModuleData={isWorkerModule:!0,id:o,name:s,dependencies:t,init:Im(n),getTransferables:r&&Im(r)},l}function Im(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function km(e,t,n){return new Promise((function(r,i){var o=++Em;Mm[o]=function(e){e.success?r(e.result):i(new Error("Error in worker "+t+" call: "+e.error))},function(e){var t=wm[e];if(!t){var n=Im(bm);(t=wm[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+n+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,n=t.messageId,r=Mm[n];if(!r)throw new Error("WorkerModule response with empty or unknown messageId");delete Mm[n],r(t)}}return t}(e).postMessage({messageId:o,action:t,data:n})}))}function Rm(){var e=function(e){function t(e,t,n,r,i,o,s,a){var l=1-s;a.x=l*l*e+2*l*s*n+s*s*i,a.y=l*l*t+2*l*s*r+s*s*o}function n(e,t,n,r,i,o,s,a,l,c){var u=1-l;c.x=u*u*u*e+3*u*u*l*n+3*u*l*l*i+l*l*l*s,c.y=u*u*u*t+3*u*u*l*r+3*u*l*l*o+l*l*l*a}function r(e,t){for(var n,r,i,o,s,a=/([MLQCZ])([^MLQCZ]*)/g;n=a.exec(e);){var l=n[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map((function(e){return parseFloat(e)}));switch(n[1]){case"M":o=r=l[0],s=i=l[1];break;case"L":(l[0]!==o||l[1]!==s)&&t("L",o,s,o=l[0],s=l[1]);break;case"Q":t("Q",o,s,o=l[2],s=l[3],l[0],l[1]);break;case"C":t("C",o,s,o=l[4],s=l[5],l[0],l[1],l[2],l[3]);break;case"Z":(o!==r||s!==i)&&t("L",o,s,r,i)}}}function i(e,i,o){void 0===o&&(o=16);var s={x:0,y:0};r(e,(function(e,r,a,l,c,u,h,d,p){switch(e){case"L":i(r,a,l,c);break;case"Q":for(var f=r,m=a,g=1;g<o;g++)t(r,a,u,h,l,c,g/(o-1),s),i(f,m,s.x,s.y),f=s.x,m=s.y;break;case"C":for(var v=r,_=a,b=1;b<o;b++)n(r,a,u,h,d,p,l,c,b/(o-1),s),i(v,_,s.x,s.y),v=s.x,_=s.y}}))}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",s="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",a=new WeakMap,l={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function c(e,t){var n=e.getContext?e.getContext("webgl",l):e,r=a.get(n);if(!r){let e=function(e){var t=o[e];if(!t&&!(t=o[e]=n.getExtension(e)))throw new Error(e+" not supported");return t},t=function(e,t){var r=n.createShader(t);return n.shaderSource(r,e),n.compileShader(r),r},l=function(r,o,a,l){if(!s[r]){var c={},u={},h=n.createProgram();n.attachShader(h,t(o,n.VERTEX_SHADER)),n.attachShader(h,t(a,n.FRAGMENT_SHADER)),n.linkProgram(h),s[r]={program:h,transaction:function(t){n.useProgram(h),t({setUniform:function(e,t){for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];var o=u[t]||(u[t]=n.getUniformLocation(h,t));n["uniform"+e].apply(n,[o].concat(r))},setAttribute:function(t,r,o,s,a){var l=c[t];l||(l=c[t]={buf:n.createBuffer(),loc:n.getAttribLocation(h,t),data:null}),n.bindBuffer(n.ARRAY_BUFFER,l.buf),n.vertexAttribPointer(l.loc,r,n.FLOAT,!1,0,0),n.enableVertexAttribArray(l.loc),i?n.vertexAttribDivisor(l.loc,s):e("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(l.loc,s),a!==l.data&&(n.bufferData(n.ARRAY_BUFFER,a,o),l.data=a)}})}}}s[r].transaction(l)},d=function(e,t){u++;try{n.activeTexture(n.TEXTURE0+u);var r=c[e];r||(r=c[e]=n.createTexture(),n.bindTexture(n.TEXTURE_2D,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)),n.bindTexture(n.TEXTURE_2D,r),t(r,u)}finally{u--}},p=function(e,t,r){var i=n.createFramebuffer();h.push(i),n.bindFramebuffer(n.FRAMEBUFFER,i),n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,e),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);try{r(i)}finally{n.deleteFramebuffer(i),n.bindFramebuffer(n.FRAMEBUFFER,h[--h.length-1]||null)}},f=function(){o={},s={},c={},u=-1,h.length=0};var i=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext,o={},s={},c={},u=-1,h=[];n.canvas.addEventListener("webglcontextlost",(function(e){f(),e.preventDefault()}),!1),a.set(n,r={gl:n,isWebGL2:i,getExtension:e,withProgram:l,withTexture:d,withTextureFramebuffer:p,handleContextLoss:f})}t(r)}function u(e,t,n,r,i,a,l,u){void 0===l&&(l=15),void 0===u&&(u=null),c(e,(function(e){var c=e.gl,h=e.withProgram;(0,e.withTexture)("copy",(function(e,d){c.texImage2D(c.TEXTURE_2D,0,c.RGBA,i,a,0,c.RGBA,c.UNSIGNED_BYTE,t),h("copy",o,s,(function(e){var t=e.setUniform;(0,e.setAttribute)("aUV",2,c.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t("1i","image",d),c.bindFramebuffer(c.FRAMEBUFFER,u||null),c.disable(c.BLEND),c.colorMask(8&l,4&l,2&l,1&l),c.viewport(n,r,i,a),c.scissor(n,r,i,a),c.drawArrays(c.TRIANGLES,0,3)}))}))}))}var h=Object.freeze({__proto__:null,withWebGLContext:c,renderImageData:u,resizeWebGLCanvasWithoutClearing:function(e,t,n){var r=e.width,i=e.height;c(e,(function(o){var s=o.gl,a=new Uint8Array(r*i*4);s.readPixels(0,0,r,i,s.RGBA,s.UNSIGNED_BYTE,a),e.width=t,e.height=n,u(s,a,0,0,r,i)}))}});function d(e,t,n,r,o,s){void 0===s&&(s=1);var a=new Uint8Array(e*t),l=r[2]-r[0],c=r[3]-r[1],u=[];i(n,(function(e,t,n,r){u.push({x1:e,y1:t,x2:n,y2:r,minX:Math.min(e,n),minY:Math.min(t,r),maxX:Math.max(e,n),maxY:Math.max(t,r)})})),u.sort((function(e,t){return e.maxX-t.maxX}));for(var h=0;h<e;h++)for(var d=0;d<t;d++){var p=g(r[0]+l*(h+.5)/e,r[1]+c*(d+.5)/t),f=Math.pow(1-Math.abs(p)/o,s)/2;p<0&&(f=1-f),f=Math.max(0,Math.min(255,Math.round(255*f))),a[d*e+h]=f}return a;function g(e,t){for(var n=1/0,r=1/0,i=u.length;i--;){var o=u[i];if(o.maxX+r<=e)break;if(e+r>o.minX&&t-r<o.maxY&&t+r>o.minY){var s=m(e,t,o.x1,o.y1,o.x2,o.y2);s<n&&(n=s,r=Math.sqrt(n))}}return function(e,t){for(var n=0,r=u.length;r--;){var i=u[r];if(i.maxX<=e)break;i.y1>t!=i.y2>t&&e<(i.x2-i.x1)*(t-i.y1)/(i.y2-i.y1)+i.x1&&(n+=i.y1<i.y2?1:-1)}return 0!==n}(e,t)&&(r=-r),r}}function p(e,t,n,r,i,o,s,a,l,c){void 0===o&&(o=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0),f(e,t,n,r,i,o,s,null,a,l,c)}function f(e,t,n,r,i,o,s,a,l,c,h){void 0===o&&(o=1),void 0===l&&(l=0),void 0===c&&(c=0),void 0===h&&(h=0);for(var p=d(e,t,n,r,i,o),f=new Uint8Array(4*p.length),m=0;m<p.length;m++)f[4*m+h]=p[m];u(s,f,l,c,e,t,1<<3-h,a)}function m(e,t,n,r,i,o){var s=i-n,a=o-r,l=s*s+a*a,c=l?Math.max(0,Math.min(1,((e-n)*s+(t-r)*a)/l)):0,u=e-(n+c*s),h=t-(r+c*a);return u*u+h*h}var g=Object.freeze({__proto__:null,generate:d,generateIntoCanvas:p,generateIntoFramebuffer:f}),v="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",_="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",b="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",y=new Float32Array([0,0,2,0,0,2]),T=null,E=!1,S={},w=new WeakMap;function x(e){if(!E&&!k(e))throw new Error("WebGL generation not supported")}function M(e,t,n,r,i,o,s){if(void 0===o&&(o=1),void 0===s&&(s=null),!s&&!(s=T)){var a="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!a)throw new Error("OffscreenCanvas or DOM canvas not supported");s=T=a.getContext("webgl",{depth:!1})}x(s);var l=new Uint8Array(e*t*4);c(s,(function(s){var a=s.gl,c=s.withTexture,u=s.withTextureFramebuffer;c("readable",(function(s,c){a.texImage2D(a.TEXTURE_2D,0,a.RGBA,e,t,0,a.RGBA,a.UNSIGNED_BYTE,null),u(s,c,(function(s){I(e,t,n,r,i,o,a,s,0,0,0),a.readPixels(0,0,e,t,a.RGBA,a.UNSIGNED_BYTE,l)}))}))}));for(var u=new Uint8Array(e*t),h=0,d=0;h<l.length;h+=4)u[d++]=l[h];return u}function C(e,t,n,r,i,o,s,a,l,c){void 0===o&&(o=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0),I(e,t,n,r,i,o,s,null,a,l,c)}function I(e,t,n,r,s,a,l,u,h,d,p){void 0===a&&(a=1),void 0===h&&(h=0),void 0===d&&(d=0),void 0===p&&(p=0),x(l);var f=[];i(n,(function(e,t,n,r){f.push(e,t,n,r)})),f=new Float32Array(f),c(l,(function(n){var i=n.gl,l=n.isWebGL2,c=n.getExtension,m=n.withProgram,g=n.withTexture,T=n.withTextureFramebuffer,E=n.handleContextLoss;if(g("rawDistances",(function(n,g){(e!==n._lastWidth||t!==n._lastHeight)&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,n._lastWidth=e,n._lastHeight=t,0,i.RGBA,i.UNSIGNED_BYTE,null),m("main",v,_,(function(o){var u=o.setAttribute,h=o.setUniform,d=!l&&c("ANGLE_instanced_arrays"),p=!l&&c("EXT_blend_minmax");u("aUV",2,i.STATIC_DRAW,0,y),u("aLineSegment",4,i.DYNAMIC_DRAW,1,f),h.apply(void 0,["4f","uGlyphBounds"].concat(r)),h("1f","uMaxDistance",s),h("1f","uExponent",a),T(n,g,(function(n){i.enable(i.BLEND),i.colorMask(!0,!0,!0,!0),i.viewport(0,0,e,t),i.scissor(0,0,e,t),i.blendFunc(i.ONE,i.ONE),i.blendEquationSeparate(i.FUNC_ADD,l?i.MAX:p.MAX_EXT),i.clear(i.COLOR_BUFFER_BIT),l?i.drawArraysInstanced(i.TRIANGLES,0,3,f.length/4):d.drawArraysInstancedANGLE(i.TRIANGLES,0,3,f.length/4)}))})),m("post",o,b,(function(n){n.setAttribute("aUV",2,i.STATIC_DRAW,0,y),n.setUniform("1i","tex",g),i.bindFramebuffer(i.FRAMEBUFFER,u),i.disable(i.BLEND),i.colorMask(0===p,1===p,2===p,3===p),i.viewport(h,d,e,t),i.scissor(h,d,e,t),i.drawArrays(i.TRIANGLES,0,3)}))})),i.isContextLost())throw E(),new Error("webgl context lost")}))}function k(e){var t=e&&e!==T?e.canvas||e:S,n=w.get(t);if(void 0===n){E=!0;var r=null;try{var i=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],o=M(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,e);(n=o&&i.length===o.length&&o.every((function(e,t){return e===i[t]})))||(r="bad trial run results",console.info(i,o))}catch(s){n=!1,r=s.message}r&&console.warn("WebGL SDF generation not supported:",r),E=!1,w.set(t,n)}return n}var R=Object.freeze({__proto__:null,generate:M,generateIntoCanvas:C,generateIntoFramebuffer:I,isSupported:k});return e.forEachPathCommand=r,e.generate=function(e,t,n,r,i,o){void 0===i&&(i=Math.max(r[2]-r[0],r[3]-r[1])/2),void 0===o&&(o=1);try{return M.apply(R,arguments)}catch(s){return console.info("WebGL SDF generation failed, falling back to JS",s),d.apply(g,arguments)}},e.generateIntoCanvas=function(e,t,n,r,i,o,s,a,l,c){void 0===i&&(i=Math.max(r[2]-r[0],r[3]-r[1])/2),void 0===o&&(o=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0);try{return C.apply(R,arguments)}catch(u){return console.info("WebGL SDF generation failed, falling back to JS",u),p.apply(g,arguments)}},e.javascript=g,e.pathToLineSegments=i,e.webgl=R,e.webglUtils=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e}const Am=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Lm(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){let n=$i[t];return n?Lm(n):e}))}const Om=[];for(let dA=0;dA<256;dA++)Om[dA]=(dA<16?"0":"")+dA.toString(16);const Nm=Object.assign||function(){let e=arguments[0];for(let t=1,n=arguments.length;t<n;t++){let n=arguments[t];if(n)for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e},Pm=Date.now(),Dm=new WeakMap,$m=new Map;let Bm=1e10;function Fm(e,t){const n=function(e){const t=JSON.stringify(e,zm);let n=Gm.get(t);return null==n&&Gm.set(t,n=++Hm),n}(t);let r=Dm.get(e);if(r||Dm.set(e,r=Object.create(null)),r[n])return new r[n];const i="_onBeforeCompile".concat(n),o=function(r){e.onBeforeCompile.call(this,r);const o=this.customProgramCacheKey()+"|"+r.vertexShader+"|"+r.fragmentShader;let s=$m[o];if(!s){const e=function(e,t,n){let{vertexShader:r,fragmentShader:i}=e,{vertexDefs:o,vertexMainIntro:s,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:p,timeUniform:f}=t;if(o=o||"",s=s||"",a=a||"",c=c||"",u=u||"",h=h||"",(l||p)&&(r=Lm(r)),(d||p)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"),i=Lm(i)),p){let e=p({vertexShader:r,fragmentShader:i});r=e.vertexShader,i=e.fragmentShader}if(d){let e=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(t=>(e.push(t),""))),h="".concat(d,"\n").concat(e.join("\n"),"\n").concat(h)}if(f){const e="\nuniform float ".concat(f,";\n");o=e+o,c=e+c}return l&&(r="vec3 troika_position_".concat(n,";\nvec3 troika_normal_").concat(n,";\nvec2 troika_uv_").concat(n,";\n").concat(r,"\n"),o="".concat(o,"\nvoid troikaVertexTransform").concat(n,"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ").concat(l,"\n}\n"),s="\ntroika_position_".concat(n," = vec3(position);\ntroika_normal_").concat(n," = vec3(normal);\ntroika_uv_").concat(n," = vec2(uv);\ntroikaVertexTransform").concat(n,"(troika_position_").concat(n,", troika_normal_").concat(n,", troika_uv_").concat(n,");\n").concat(s,"\n"),r=r.replace(/\b(position|normal|uv)\b/g,((e,t,r,i)=>/\battribute\s+vec[23]\s+$/.test(i.substr(0,r))?t:"troika_".concat(t,"_").concat(n)))),r=Um(r,n,o,s,a),i=Um(i,n,c,u,h),{vertexShader:r,fragmentShader:i}}(r,t,n);s=$m[o]=e}r.vertexShader=s.vertexShader,r.fragmentShader=s.fragmentShader,Nm(r.uniforms,this.uniforms),t.timeUniform&&(r.uniforms[t.timeUniform]={get value(){return Date.now()-Pm}}),this[i]&&this[i](r)},s=function(){return a(t.chained?e:e.clone())},a=function(r){const i=Object.create(r,l);return Object.defineProperty(i,"baseMaterial",{value:e}),Object.defineProperty(i,"id",{value:Bm++}),i.uuid=function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Om[255&e]+Om[e>>8&255]+Om[e>>16&255]+Om[e>>24&255]+"-"+Om[255&t]+Om[t>>8&255]+"-"+Om[t>>16&15|64]+Om[t>>24&255]+"-"+Om[63&n|128]+Om[n>>8&255]+"-"+Om[n>>16&255]+Om[n>>24&255]+Om[255&r]+Om[r>>8&255]+Om[r>>16&255]+Om[r>>24&255]).toUpperCase()}(),i.uniforms=Nm({},r.uniforms,t.uniforms),i.defines=Nm({},r.defines,t.defines),i.defines["TROIKA_DERIVED_MATERIAL_".concat(n)]="",i.extensions=Nm({},r.extensions,t.extensions),i._listeners=void 0,i},l={constructor:{value:s},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return e.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get:()=>o,set(e){this[i]=e}},copy:{writable:!0,configurable:!0,value:function(t){return e.copy.call(this,t),!e.isShaderMaterial&&!e.isDerivedMaterial&&(Nm(this.extensions,t.extensions),Nm(this.defines,t.defines),Nm(this.uniforms,bi.clone(t.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const t=new e.constructor;return a(t).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||(n=this._depthMaterial=Fm(e.isDerivedMaterial?e.getDepthMaterial():new ea({depthPacking:Et}),t),n.defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||(n=this._distanceMaterial=Fm(e.isDerivedMaterial?e.getDistanceMaterial():new ta,t),n.defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:t,_distanceMaterial:n}=this;t&&t.dispose(),n&&n.dispose(),e.dispose.call(this)}}};return r[n]=s,new s}function Um(e,t,n,r,i){return(r||i||n)&&(e=e.replace(Am,"\n".concat(n,"\nvoid troikaOrigMain").concat(t,"() {")),e+="\nvoid main() {\n  ".concat(r,"\n  troikaOrigMain").concat(t,"();\n  ").concat(i,"\n}")),e}function zm(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let Hm=0;const Gm=new Map;const Vm=()=>(self.performance||Date).now(),Wm=Rm();let jm;const Xm=[];let Ym=0;function Km(){const e=Vm();for(;Xm.length&&Vm()-e<5;)Xm.shift()();Ym=Xm.length?setTimeout(Km,0):0}const qm=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise(((e,n)=>{Xm.push((()=>{const r=Vm();try{Wm.webgl.generateIntoCanvas(...t),e({timing:Vm()-r})}catch(i){n(i)}})),Ym||(Ym=setTimeout(Km,0))}))},Jm=4,Zm=2e3,Qm={};let eg=0;function tg(e,t,n,r,i,o,s,a,l,c){const u="TroikaTextSDFGenerator_JS_"+eg++%Jm;let h=Qm[u];return h||(h=Qm[u]={workerModule:Cm({name:u,workerId:u,dependencies:[Rm,Vm],init(e,t){const n=e().javascript.generate;return function(){const e=t();return{textureData:n(...arguments),timing:t()-e}}},getTransferables:e=>[e.textureData.buffer]}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(e,t,n,r,i,o).then((n=>{let{textureData:r,timing:i}=n;const o=Vm(),d=new Uint8Array(4*r.length);for(let e=0;e<r.length;e++)d[4*e+c]=r[e];return Wm.webglUtils.renderImageData(s,d,a,l,e,t,1<<3-c),i+=Vm()-o,0===--h.requests&&(h.idleTimer=setTimeout((()=>{!function(e){xm[e]&&xm[e].forEach((function(e){e()})),wm[e]&&(wm[e].terminate(),delete wm[e])}(u)}),Zm)),{timing:i}}))}const ng=Wm.webglUtils.resizeWebGLCanvasWithoutClearing;const rg=Cm({name:"Typr Font Parser",dependencies:[function(){return typeof window>"u"&&(self.window=self),function(e){var t={parse:function(e){var n=t._bin,r=new Uint8Array(e);if("ttcf"==n.readASCII(r,0,4)){var i=4;n.readUshort(r,i),i+=2,n.readUshort(r,i),i+=2;var o=n.readUint(r,i);i+=4;for(var s=[],a=0;a<o;a++){var l=n.readUint(r,i);i+=4,s.push(t._readFont(r,l))}return s}return[t._readFont(r,0)]},_readFont:function(e,n){var r=t._bin,i=n;r.readFixed(e,n),n+=4;var o=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2;for(var s=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],a={_data:e,_offset:i},l={},c=0;c<o;c++){var u=r.readASCII(e,n,4);n+=4,r.readUint(e,n),n+=4;var h=r.readUint(e,n);n+=4;var d=r.readUint(e,n);n+=4,l[u]={offset:h,length:d}}for(c=0;c<s.length;c++){var p=s[c];l[p]&&(a[p.trim()]=t[p.trim()].parse(e,l[p].offset,l[p].length,a))}return a},_tabOffset:function(e,n,r){for(var i=t._bin,o=i.readUshort(e,r+4),s=r+12,a=0;a<o;a++){var l=i.readASCII(e,s,4);s+=4,i.readUint(e,s),s+=4;var c=i.readUint(e,s);if(s+=4,i.readUint(e,s),s+=4,l==n)return c}return 0}};t._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,n){return t._bin.readShort(e,n)/16384},readInt:function(e,n){return t._bin._view(e).getInt32(n)},readInt8:function(e,n){return t._bin._view(e).getInt8(n)},readShort:function(e,n){return t._bin._view(e).getInt16(n)},readUshort:function(e,n){return t._bin._view(e).getUint16(n)},readUshorts:function(e,n,r){for(var i=[],o=0;o<r;o++)i.push(t._bin.readUshort(e,n+2*o));return i},readUint:function(e,n){return t._bin._view(e).getUint32(n)},readUint64:function(e,n){return 4294967296*t._bin.readUint(e,n)+t._bin.readUint(e,n+4)},readASCII:function(e,t,n){for(var r="",i=0;i<n;i++)r+=String.fromCharCode(e[t+i]);return r},readUnicode:function(e,t,n){for(var r="",i=0;i<n;i++){var o=e[t++]<<8|e[t++];r+=String.fromCharCode(o)}return r},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,n,r){var i=t._bin._tdec;return i&&0==n&&r==e.length?i.decode(e):t._bin.readASCII(e,n,r)},readBytes:function(e,t,n){for(var r=[],i=0;i<n;i++)r.push(e[t+i]);return r},readASCIIArray:function(e,t,n){for(var r=[],i=0;i<n;i++)r.push(String.fromCharCode(e[t+i]));return r},_view:function(e){return e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))}},t._lctf={},t._lctf.parse=function(e,n,r,i,o){var s=t._bin,a={},l=n;s.readFixed(e,n),n+=4;var c=s.readUshort(e,n);n+=2;var u=s.readUshort(e,n);n+=2;var h=s.readUshort(e,n);return n+=2,a.scriptList=t._lctf.readScriptList(e,l+c),a.featureList=t._lctf.readFeatureList(e,l+u),a.lookupList=t._lctf.readLookupList(e,l+h,o),a},t._lctf.readLookupList=function(e,n,r){var i=t._bin,o=n,s=[],a=i.readUshort(e,n);n+=2;for(var l=0;l<a;l++){var c=i.readUshort(e,n);n+=2;var u=t._lctf.readLookupTable(e,o+c,r);s.push(u)}return s},t._lctf.readLookupTable=function(e,n,r){var i=t._bin,o=n,s={tabs:[]};s.ltype=i.readUshort(e,n),n+=2,s.flag=i.readUshort(e,n),n+=2;var a=i.readUshort(e,n);n+=2;for(var l=s.ltype,c=0;c<a;c++){var u=i.readUshort(e,n);n+=2;var h=r(e,l,o+u,s);s.tabs.push(h)}return s},t._lctf.numOfOnes=function(e){for(var t=0,n=0;n<32;n++)0!=(e>>>n&1)&&t++;return t},t._lctf.readClassDef=function(e,n){var r=t._bin,i=[],o=r.readUshort(e,n);if(n+=2,1==o){var s=r.readUshort(e,n);n+=2;var a=r.readUshort(e,n);n+=2;for(var l=0;l<a;l++)i.push(s+l),i.push(s+l),i.push(r.readUshort(e,n)),n+=2}if(2==o){var c=r.readUshort(e,n);for(n+=2,l=0;l<c;l++)i.push(r.readUshort(e,n)),n+=2,i.push(r.readUshort(e,n)),n+=2,i.push(r.readUshort(e,n)),n+=2}return i},t._lctf.getInterval=function(e,t){for(var n=0;n<e.length;n+=3){var r=e[n],i=e[n+1];if(e[n+2],r<=t&&t<=i)return n}return-1},t._lctf.readCoverage=function(e,n){var r=t._bin,i={};i.fmt=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);return n+=2,1==i.fmt&&(i.tab=r.readUshorts(e,n,o)),2==i.fmt&&(i.tab=r.readUshorts(e,n,3*o)),i},t._lctf.coverageIndex=function(e,n){var r=e.tab;if(1==e.fmt)return r.indexOf(n);if(2==e.fmt){var i=t._lctf.getInterval(r,n);if(-1!=i)return r[i+2]+(n-r[i])}return-1},t._lctf.readFeatureList=function(e,n){var r=t._bin,i=n,o=[],s=r.readUshort(e,n);n+=2;for(var a=0;a<s;a++){var l=r.readASCII(e,n,4);n+=4;var c=r.readUshort(e,n);n+=2;var u=t._lctf.readFeatureTable(e,i+c);u.tag=l.trim(),o.push(u)}return o},t._lctf.readFeatureTable=function(e,n){var r=t._bin,i=n,o={},s=r.readUshort(e,n);n+=2,s>0&&(o.featureParams=i+s);var a=r.readUshort(e,n);n+=2,o.tab=[];for(var l=0;l<a;l++)o.tab.push(r.readUshort(e,n+2*l));return o},t._lctf.readScriptList=function(e,n){var r=t._bin,i=n,o={},s=r.readUshort(e,n);n+=2;for(var a=0;a<s;a++){var l=r.readASCII(e,n,4);n+=4;var c=r.readUshort(e,n);n+=2,o[l.trim()]=t._lctf.readScriptTable(e,i+c)}return o},t._lctf.readScriptTable=function(e,n){var r=t._bin,i=n,o={},s=r.readUshort(e,n);n+=2,o.default=t._lctf.readLangSysTable(e,i+s);var a=r.readUshort(e,n);n+=2;for(var l=0;l<a;l++){var c=r.readASCII(e,n,4);n+=4;var u=r.readUshort(e,n);n+=2,o[c.trim()]=t._lctf.readLangSysTable(e,i+u)}return o},t._lctf.readLangSysTable=function(e,n){var r=t._bin,i={};r.readUshort(e,n),n+=2,i.reqFeature=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);return n+=2,i.features=r.readUshorts(e,n,o),i},t.CFF={},t.CFF.parse=function(e,n,r){var i=t._bin;(e=new Uint8Array(e.buffer,n,r))[n=0],e[++n],e[++n],e[++n],n++;var o=[];n=t.CFF.readIndex(e,n,o);for(var s=[],a=0;a<o.length-1;a++)s.push(i.readASCII(e,n+o[a],o[a+1]-o[a]));n+=o[o.length-1];var l=[];n=t.CFF.readIndex(e,n,l);var c=[];for(a=0;a<l.length-1;a++)c.push(t.CFF.readDict(e,n+l[a],n+l[a+1]));n+=l[l.length-1];var u=c[0],h=[];n=t.CFF.readIndex(e,n,h);var d=[];for(a=0;a<h.length-1;a++)d.push(i.readASCII(e,n+h[a],h[a+1]-h[a]));if(n+=h[h.length-1],t.CFF.readSubrs(e,n,u),u.CharStrings){n=u.CharStrings,h=[],n=t.CFF.readIndex(e,n,h);var p=[];for(a=0;a<h.length-1;a++)p.push(i.readBytes(e,n+h[a],h[a+1]-h[a]));u.CharStrings=p}if(u.ROS){n=u.FDArray;var f=[];for(n=t.CFF.readIndex(e,n,f),u.FDArray=[],a=0;a<f.length-1;a++){var m=t.CFF.readDict(e,n+f[a],n+f[a+1]);t.CFF._readFDict(e,m,d),u.FDArray.push(m)}n+=f[f.length-1],n=u.FDSelect,u.FDSelect=[];var g=e[n];if(n++,3!=g)throw g;var v=i.readUshort(e,n);for(n+=2,a=0;a<v+1;a++)u.FDSelect.push(i.readUshort(e,n),e[n+2]),n+=3}return u.Encoding&&(u.Encoding=t.CFF.readEncoding(e,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=t.CFF.readCharset(e,u.charset,u.CharStrings.length)),t.CFF._readFDict(e,u,d),u},t.CFF._readFDict=function(e,n,r){var i;for(var o in n.Private&&(i=n.Private[1],n.Private=t.CFF.readDict(e,i,i+n.Private[0]),n.Private.Subrs&&t.CFF.readSubrs(e,i+n.Private.Subrs,n.Private)),n)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)&&(n[o]=r[n[o]-426+35])},t.CFF.readSubrs=function(e,n,r){var i=t._bin,o=[];n=t.CFF.readIndex(e,n,o);var s,a=o.length;s=a<1240?107:a<33900?1131:32768,r.Bias=s,r.Subrs=[];for(var l=0;l<o.length-1;l++)r.Subrs.push(i.readBytes(e,n+o[l],o[l+1]-o[l]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(e,t){for(var n=0;n<e.charset.length;n++)if(e.charset[n]==t)return n;return-1},t.CFF.glyphBySE=function(e,n){return n<0||n>255?-1:t.CFF.glyphByUnicode(e,t.CFF.tableSE[n])},t.CFF.readEncoding=function(e,n,r){t._bin;var i=[".notdef"],o=e[n];if(n++,0!=o)throw"error: unknown encoding format: "+o;var s=e[n];n++;for(var a=0;a<s;a++)i.push(e[n+a]);return i},t.CFF.readCharset=function(e,n,r){var i=t._bin,o=[".notdef"],s=e[n];if(n++,0==s)for(var a=0;a<r;a++){var l=i.readUshort(e,n);n+=2,o.push(l)}else{if(1!=s&&2!=s)throw"error: format: "+s;for(;o.length<r;){l=i.readUshort(e,n),n+=2;var c=0;for(1==s?(c=e[n],n++):(c=i.readUshort(e,n),n+=2),a=0;a<=c;a++)o.push(l),l++}}return o},t.CFF.readIndex=function(e,n,r){var i=t._bin,o=i.readUshort(e,n)+1,s=e[n+=2];if(n++,1==s)for(var a=0;a<o;a++)r.push(e[n+a]);else if(2==s)for(a=0;a<o;a++)r.push(i.readUshort(e,n+2*a));else if(3==s)for(a=0;a<o;a++)r.push(16777215&i.readUint(e,n+3*a-1));else if(1!=o)throw"unsupported offset size: "+s+", count: "+o;return(n+=o*s)-1},t.CFF.getCharString=function(e,n,r){var i=t._bin,o=e[n],s=e[n+1];e[n+2],e[n+3],e[n+4];var a=1,l=null,c=null;o<=20&&(l=o,a=1),12==o&&(l=100*o+s,a=2),21<=o&&o<=27&&(l=o,a=1),28==o&&(c=i.readShort(e,n+1),a=3),29<=o&&o<=31&&(l=o,a=1),32<=o&&o<=246&&(c=o-139,a=1),247<=o&&o<=250&&(c=256*(o-247)+s+108,a=2),251<=o&&o<=254&&(c=256*-(o-251)-s-108,a=2),255==o&&(c=i.readInt(e,n+1)/65535,a=5),r.val=null!=c?c:"o"+l,r.size=a},t.CFF.readCharString=function(e,n,r){for(var i=n+r,o=t._bin,s=[];n<i;){var a=e[n],l=e[n+1];e[n+2],e[n+3],e[n+4];var c=1,u=null,h=null;a<=20&&(u=a,c=1),12==a&&(u=100*a+l,c=2),19!=a&&20!=a||(u=a,c=2),21<=a&&a<=27&&(u=a,c=1),28==a&&(h=o.readShort(e,n+1),c=3),29<=a&&a<=31&&(u=a,c=1),32<=a&&a<=246&&(h=a-139,c=1),247<=a&&a<=250&&(h=256*(a-247)+l+108,c=2),251<=a&&a<=254&&(h=256*-(a-251)-l-108,c=2),255==a&&(h=o.readInt(e,n+1)/65535,c=5),s.push(null!=h?h:"o"+u),n+=c}return s},t.CFF.readDict=function(e,n,r){for(var i=t._bin,o={},s=[];n<r;){var a=e[n],l=e[n+1];e[n+2],e[n+3],e[n+4];var c=1,u=null,h=null;if(28==a&&(h=i.readShort(e,n+1),c=3),29==a&&(h=i.readInt(e,n+1),c=5),32<=a&&a<=246&&(h=a-139,c=1),247<=a&&a<=250&&(h=256*(a-247)+l+108,c=2),251<=a&&a<=254&&(h=256*-(a-251)-l-108,c=2),255==a)throw h=i.readInt(e,n+1)/65535,c=5,"unknown number";if(30==a){var d=[];for(c=1;;){var p=e[n+c];c++;var f=p>>4,m=15&p;if(15!=f&&d.push(f),15!=m&&d.push(m),15==m)break}for(var g="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],_=0;_<d.length;_++)g+=v[d[_]];h=parseFloat(g)}a<=21&&(u=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][a],c=1,12==a&&(u=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],c=2)),null!=u?(o[u]=1==s.length?s[0]:s,s=[]):s.push(h),n+=c}return o},t.cmap={},t.cmap.parse=function(e,n,r){e=new Uint8Array(e.buffer,n,r),n=0;var i=t._bin,o={};i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2;var a=[];o.tables=[];for(var l=0;l<s;l++){var c=i.readUshort(e,n);n+=2;var u=i.readUshort(e,n);n+=2;var h=i.readUint(e,n);n+=4;var d="p"+c+"e"+u,p=a.indexOf(h);if(-1==p){var f;p=o.tables.length,a.push(h);var m=i.readUshort(e,h);0==m?f=t.cmap.parse0(e,h):4==m?f=t.cmap.parse4(e,h):6==m?f=t.cmap.parse6(e,h):12==m?f=t.cmap.parse12(e,h):console.debug("unknown format: "+m,c,u,h),o.tables.push(f)}if(null!=o[d])throw"multiple tables for one platform+encoding";o[d]=p}return o},t.cmap.parse0=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2,i.map=[];for(var s=0;s<o-6;s++)i.map.push(e[n+s]);return i},t.cmap.parse4=function(e,n){var r=t._bin,i=n,o={};o.format=r.readUshort(e,n),n+=2;var s=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);n+=2;var l=a/2;o.searchRange=r.readUshort(e,n),n+=2,o.entrySelector=r.readUshort(e,n),n+=2,o.rangeShift=r.readUshort(e,n),n+=2,o.endCount=r.readUshorts(e,n,l),n+=2*l,n+=2,o.startCount=r.readUshorts(e,n,l),n+=2*l,o.idDelta=[];for(var c=0;c<l;c++)o.idDelta.push(r.readShort(e,n)),n+=2;for(o.idRangeOffset=r.readUshorts(e,n,l),n+=2*l,o.glyphIdArray=[];n<i+s;)o.glyphIdArray.push(r.readUshort(e,n)),n+=2;return o},t.cmap.parse6=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,i.firstCode=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2,i.glyphIdArray=[];for(var s=0;s<o;s++)i.glyphIdArray.push(r.readUshort(e,n)),n+=2;return i},t.cmap.parse12=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2,n+=2,r.readUint(e,n),n+=4,r.readUint(e,n),n+=4;var o=r.readUint(e,n);n+=4,i.groups=[];for(var s=0;s<o;s++){var a=n+12*s,l=r.readUint(e,a+0),c=r.readUint(e,a+4),u=r.readUint(e,a+8);i.groups.push([l,c,u])}return i},t.glyf={},t.glyf.parse=function(e,t,n,r){for(var i=[],o=0;o<r.maxp.numGlyphs;o++)i.push(null);return i},t.glyf._parseGlyf=function(e,n){var r=t._bin,i=e._data,o=t._tabOffset(i,"glyf",e._offset)+e.loca[n];if(e.loca[n]==e.loca[n+1])return null;var s={};if(s.noc=r.readShort(i,o),o+=2,s.xMin=r.readShort(i,o),o+=2,s.yMin=r.readShort(i,o),o+=2,s.xMax=r.readShort(i,o),o+=2,s.yMax=r.readShort(i,o),o+=2,s.xMin>=s.xMax||s.yMin>=s.yMax)return null;if(s.noc>0){s.endPts=[];for(var a=0;a<s.noc;a++)s.endPts.push(r.readUshort(i,o)),o+=2;var l=r.readUshort(i,o);if(o+=2,i.length-o<l)return null;s.instructions=r.readBytes(i,o,l),o+=l;var c=s.endPts[s.noc-1]+1;for(s.flags=[],a=0;a<c;a++){var u=i[o];if(o++,s.flags.push(u),0!=(8&u)){var h=i[o];o++;for(var d=0;d<h;d++)s.flags.push(u),a++}}for(s.xs=[],a=0;a<c;a++){var p=0!=(2&s.flags[a]),f=0!=(16&s.flags[a]);p?(s.xs.push(f?i[o]:-i[o]),o++):f?s.xs.push(0):(s.xs.push(r.readShort(i,o)),o+=2)}for(s.ys=[],a=0;a<c;a++)p=0!=(4&s.flags[a]),f=0!=(32&s.flags[a]),p?(s.ys.push(f?i[o]:-i[o]),o++):f?s.ys.push(0):(s.ys.push(r.readShort(i,o)),o+=2);var m=0,g=0;for(a=0;a<c;a++)m+=s.xs[a],g+=s.ys[a],s.xs[a]=m,s.ys[a]=g}else{var v;s.parts=[];do{v=r.readUshort(i,o),o+=2;var _={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(s.parts.push(_),_.glyphIndex=r.readUshort(i,o),o+=2,1&v){var b=r.readShort(i,o);o+=2;var y=r.readShort(i,o);o+=2}else b=r.readInt8(i,o),o++,y=r.readInt8(i,o),o++;2&v?(_.m.tx=b,_.m.ty=y):(_.p1=b,_.p2=y),8&v?(_.m.a=_.m.d=r.readF2dot14(i,o),o+=2):64&v?(_.m.a=r.readF2dot14(i,o),o+=2,_.m.d=r.readF2dot14(i,o),o+=2):128&v&&(_.m.a=r.readF2dot14(i,o),o+=2,_.m.b=r.readF2dot14(i,o),o+=2,_.m.c=r.readF2dot14(i,o),o+=2,_.m.d=r.readF2dot14(i,o),o+=2)}while(32&v);if(256&v){var T=r.readUshort(i,o);for(o+=2,s.instr=[],a=0;a<T;a++)s.instr.push(i[o]),o++}}return s},t.GPOS={},t.GPOS.parse=function(e,n,r,i){return t._lctf.parse(e,n,r,i,t.GPOS.subt)},t.GPOS.subt=function(e,n,r,i){var o=t._bin,s=r,a={};if(a.fmt=o.readUshort(e,r),r+=2,1==n||2==n||3==n||7==n||8==n&&a.fmt<=2){var l=o.readUshort(e,r);r+=2,a.coverage=t._lctf.readCoverage(e,l+s)}if(1==n&&1==a.fmt){var c=o.readUshort(e,r);r+=2;var u=t._lctf.numOfOnes(c);0!=c&&(a.pos=t.GPOS.readValueRecord(e,r,c))}else if(2==n&&a.fmt>=1&&a.fmt<=2){c=o.readUshort(e,r),r+=2;var h=o.readUshort(e,r);r+=2,u=t._lctf.numOfOnes(c);var d=t._lctf.numOfOnes(h);if(1==a.fmt){a.pairsets=[];var p=o.readUshort(e,r);r+=2;for(var f=0;f<p;f++){var m=s+o.readUshort(e,r);r+=2;var g=o.readUshort(e,m);m+=2;for(var v=[],_=0;_<g;_++){var b=o.readUshort(e,m);m+=2,0!=c&&(x=t.GPOS.readValueRecord(e,m,c),m+=2*u),0!=h&&(M=t.GPOS.readValueRecord(e,m,h),m+=2*d),v.push({gid2:b,val1:x,val2:M})}a.pairsets.push(v)}}if(2==a.fmt){var y=o.readUshort(e,r);r+=2;var T=o.readUshort(e,r);r+=2;var E=o.readUshort(e,r);r+=2;var S=o.readUshort(e,r);for(r+=2,a.classDef1=t._lctf.readClassDef(e,s+y),a.classDef2=t._lctf.readClassDef(e,s+T),a.matrix=[],f=0;f<E;f++){var w=[];for(_=0;_<S;_++){var x=null,M=null;0!=c&&(x=t.GPOS.readValueRecord(e,r,c),r+=2*u),0!=h&&(M=t.GPOS.readValueRecord(e,r,h),r+=2*d),w.push({val1:x,val2:M})}a.matrix.push(w)}}}else{if(9==n&&1==a.fmt){var C=o.readUshort(e,r);r+=2;var I=o.readUint(e,r);if(r+=4,9==i.ltype)i.ltype=C;else if(i.ltype!=C)throw"invalid extension substitution";return t.GPOS.subt(e,i.ltype,s+I)}console.debug("unsupported GPOS table LookupType",n,"format",a.fmt)}return a},t.GPOS.readValueRecord=function(e,n,r){var i=t._bin,o=[];return o.push(1&r?i.readShort(e,n):0),n+=1&r?2:0,o.push(2&r?i.readShort(e,n):0),n+=2&r?2:0,o.push(4&r?i.readShort(e,n):0),n+=4&r?2:0,o.push(8&r?i.readShort(e,n):0),n+=8&r?2:0,o},t.GSUB={},t.GSUB.parse=function(e,n,r,i){return t._lctf.parse(e,n,r,i,t.GSUB.subt)},t.GSUB.subt=function(e,n,r,i){var o=t._bin,s=r,a={};if(a.fmt=o.readUshort(e,r),r+=2,1!=n&&4!=n&&5!=n&&6!=n)return null;if(1==n||4==n||5==n&&a.fmt<=2||6==n&&a.fmt<=2){var l=o.readUshort(e,r);r+=2,a.coverage=t._lctf.readCoverage(e,s+l)}if(1==n&&a.fmt>=1&&a.fmt<=2){if(1==a.fmt)a.delta=o.readShort(e,r),r+=2;else if(2==a.fmt){var c=o.readUshort(e,r);r+=2,a.newg=o.readUshorts(e,r,c),r+=2*a.newg.length}}else if(4==n){a.vals=[],c=o.readUshort(e,r),r+=2;for(var u=0;u<c;u++){var h=o.readUshort(e,r);r+=2,a.vals.push(t.GSUB.readLigatureSet(e,s+h))}}else if(5==n&&2==a.fmt){if(2==a.fmt){var d=o.readUshort(e,r);r+=2,a.cDef=t._lctf.readClassDef(e,s+d),a.scset=[];var p=o.readUshort(e,r);for(r+=2,u=0;u<p;u++){var f=o.readUshort(e,r);r+=2,a.scset.push(0==f?null:t.GSUB.readSubClassSet(e,s+f))}}}else if(6==n&&3==a.fmt){if(3==a.fmt){for(u=0;u<3;u++){c=o.readUshort(e,r),r+=2;for(var m=[],g=0;g<c;g++)m.push(t._lctf.readCoverage(e,s+o.readUshort(e,r+2*g)));r+=2*c,0==u&&(a.backCvg=m),1==u&&(a.inptCvg=m),2==u&&(a.ahedCvg=m)}c=o.readUshort(e,r),r+=2,a.lookupRec=t.GSUB.readSubstLookupRecords(e,r,c)}}else{if(7==n&&1==a.fmt){var v=o.readUshort(e,r);r+=2;var _=o.readUint(e,r);if(r+=4,9==i.ltype)i.ltype=v;else if(i.ltype!=v)throw"invalid extension substitution";return t.GSUB.subt(e,i.ltype,s+_)}console.debug("unsupported GSUB table LookupType",n,"format",a.fmt)}return a},t.GSUB.readSubClassSet=function(e,n){var r=t._bin.readUshort,i=n,o=[],s=r(e,n);n+=2;for(var a=0;a<s;a++){var l=r(e,n);n+=2,o.push(t.GSUB.readSubClassRule(e,i+l))}return o},t.GSUB.readSubClassRule=function(e,n){var r=t._bin.readUshort,i={},o=r(e,n),s=r(e,n+=2);n+=2,i.input=[];for(var a=0;a<o-1;a++)i.input.push(r(e,n)),n+=2;return i.substLookupRecords=t.GSUB.readSubstLookupRecords(e,n,s),i},t.GSUB.readSubstLookupRecords=function(e,n,r){for(var i=t._bin.readUshort,o=[],s=0;s<r;s++)o.push(i(e,n),i(e,n+2)),n+=4;return o},t.GSUB.readChainSubClassSet=function(e,n){var r=t._bin,i=n,o=[],s=r.readUshort(e,n);n+=2;for(var a=0;a<s;a++){var l=r.readUshort(e,n);n+=2,o.push(t.GSUB.readChainSubClassRule(e,i+l))}return o},t.GSUB.readChainSubClassRule=function(e,n){for(var r=t._bin,i={},o=["backtrack","input","lookahead"],s=0;s<o.length;s++){var a=r.readUshort(e,n);n+=2,1==s&&a--,i[o[s]]=r.readUshorts(e,n,a),n+=2*i[o[s]].length}return a=r.readUshort(e,n),n+=2,i.subst=r.readUshorts(e,n,2*a),n+=2*i.subst.length,i},t.GSUB.readLigatureSet=function(e,n){var r=t._bin,i=n,o=[],s=r.readUshort(e,n);n+=2;for(var a=0;a<s;a++){var l=r.readUshort(e,n);n+=2,o.push(t.GSUB.readLigature(e,i+l))}return o},t.GSUB.readLigature=function(e,n){var r=t._bin,i={chain:[]};i.nglyph=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2;for(var s=0;s<o-1;s++)i.chain.push(r.readUshort(e,n)),n+=2;return i},t.head={},t.head.parse=function(e,n,r){var i=t._bin,o={};return i.readFixed(e,n),n+=4,o.fontRevision=i.readFixed(e,n),n+=4,i.readUint(e,n),n+=4,i.readUint(e,n),n+=4,o.flags=i.readUshort(e,n),n+=2,o.unitsPerEm=i.readUshort(e,n),n+=2,o.created=i.readUint64(e,n),n+=8,o.modified=i.readUint64(e,n),n+=8,o.xMin=i.readShort(e,n),n+=2,o.yMin=i.readShort(e,n),n+=2,o.xMax=i.readShort(e,n),n+=2,o.yMax=i.readShort(e,n),n+=2,o.macStyle=i.readUshort(e,n),n+=2,o.lowestRecPPEM=i.readUshort(e,n),n+=2,o.fontDirectionHint=i.readShort(e,n),n+=2,o.indexToLocFormat=i.readShort(e,n),n+=2,o.glyphDataFormat=i.readShort(e,n),n+=2,o},t.hhea={},t.hhea.parse=function(e,n,r){var i=t._bin,o={};return i.readFixed(e,n),n+=4,o.ascender=i.readShort(e,n),n+=2,o.descender=i.readShort(e,n),n+=2,o.lineGap=i.readShort(e,n),n+=2,o.advanceWidthMax=i.readUshort(e,n),n+=2,o.minLeftSideBearing=i.readShort(e,n),n+=2,o.minRightSideBearing=i.readShort(e,n),n+=2,o.xMaxExtent=i.readShort(e,n),n+=2,o.caretSlopeRise=i.readShort(e,n),n+=2,o.caretSlopeRun=i.readShort(e,n),n+=2,o.caretOffset=i.readShort(e,n),n+=2,n+=8,o.metricDataFormat=i.readShort(e,n),n+=2,o.numberOfHMetrics=i.readUshort(e,n),n+=2,o},t.hmtx={},t.hmtx.parse=function(e,n,r,i){for(var o=t._bin,s={aWidth:[],lsBearing:[]},a=0,l=0,c=0;c<i.maxp.numGlyphs;c++)c<i.hhea.numberOfHMetrics&&(a=o.readUshort(e,n),n+=2,l=o.readShort(e,n),n+=2),s.aWidth.push(a),s.lsBearing.push(l);return s},t.kern={},t.kern.parse=function(e,n,r,i){var o=t._bin,s=o.readUshort(e,n);if(n+=2,1==s)return t.kern.parseV1(e,n-2,r,i);var a=o.readUshort(e,n);n+=2;for(var l={glyph1:[],rval:[]},c=0;c<a;c++){n+=2,r=o.readUshort(e,n),n+=2;var u=o.readUshort(e,n);n+=2;var h=u>>>8;if(0!=(h&=15))throw"unknown kern table format: "+h;n=t.kern.readFormat0(e,n,l)}return l},t.kern.parseV1=function(e,n,r,i){var o=t._bin;o.readFixed(e,n),n+=4;var s=o.readUint(e,n);n+=4;for(var a={glyph1:[],rval:[]},l=0;l<s;l++){o.readUint(e,n),n+=4;var c=o.readUshort(e,n);n+=2,o.readUshort(e,n),n+=2;var u=c>>>8;if(0!=(u&=15))throw"unknown kern table format: "+u;n=t.kern.readFormat0(e,n,a)}return a},t.kern.readFormat0=function(e,n,r){var i=t._bin,o=-1,s=i.readUshort(e,n);n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2;for(var a=0;a<s;a++){var l=i.readUshort(e,n);n+=2;var c=i.readUshort(e,n);n+=2;var u=i.readShort(e,n);n+=2,l!=o&&(r.glyph1.push(l),r.rval.push({glyph2:[],vals:[]}));var h=r.rval[r.rval.length-1];h.glyph2.push(c),h.vals.push(u),o=l}return n},t.loca={},t.loca.parse=function(e,n,r,i){var o=t._bin,s=[],a=i.head.indexToLocFormat,l=i.maxp.numGlyphs+1;if(0==a)for(var c=0;c<l;c++)s.push(o.readUshort(e,n+(c<<1))<<1);if(1==a)for(c=0;c<l;c++)s.push(o.readUint(e,n+(c<<2)));return s},t.maxp={},t.maxp.parse=function(e,n,r){var i=t._bin,o={},s=i.readUint(e,n);return n+=4,o.numGlyphs=i.readUshort(e,n),n+=2,65536==s&&(o.maxPoints=i.readUshort(e,n),n+=2,o.maxContours=i.readUshort(e,n),n+=2,o.maxCompositePoints=i.readUshort(e,n),n+=2,o.maxCompositeContours=i.readUshort(e,n),n+=2,o.maxZones=i.readUshort(e,n),n+=2,o.maxTwilightPoints=i.readUshort(e,n),n+=2,o.maxStorage=i.readUshort(e,n),n+=2,o.maxFunctionDefs=i.readUshort(e,n),n+=2,o.maxInstructionDefs=i.readUshort(e,n),n+=2,o.maxStackElements=i.readUshort(e,n),n+=2,o.maxSizeOfInstructions=i.readUshort(e,n),n+=2,o.maxComponentElements=i.readUshort(e,n),n+=2,o.maxComponentDepth=i.readUshort(e,n),n+=2),o},t.name={},t.name.parse=function(e,n,r){var i=t._bin,o={};i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2,i.readUshort(e,n);for(var a,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=n+=2,u=0;u<s;u++){var h=i.readUshort(e,n);n+=2;var d=i.readUshort(e,n);n+=2;var p=i.readUshort(e,n);n+=2;var f=i.readUshort(e,n);n+=2;var m=i.readUshort(e,n);n+=2;var g=i.readUshort(e,n);n+=2;var v,_=l[f],b=c+12*s+g;if(0==h)v=i.readUnicode(e,b,m/2);else if(3==h&&0==d)v=i.readUnicode(e,b,m/2);else if(0==d)v=i.readASCII(e,b,m);else if(1==d)v=i.readUnicode(e,b,m/2);else if(3==d)v=i.readUnicode(e,b,m/2);else{if(1!=h)throw"unknown encoding "+d+", platformID: "+h;v=i.readASCII(e,b,m),console.debug("reading unknown MAC encoding "+d+" as ASCII")}var y="p"+h+","+p.toString(16);null==o[y]&&(o[y]={}),o[y][void 0!==_?_:f]=v,o[y]._lang=p}for(var T in o)if(null!=o[T].postScriptName&&1033==o[T]._lang)return o[T];for(var T in o)if(null!=o[T].postScriptName&&0==o[T]._lang)return o[T];for(var T in o)if(null!=o[T].postScriptName&&3084==o[T]._lang)return o[T];for(var T in o)if(null!=o[T].postScriptName)return o[T];for(var T in o){a=T;break}return console.debug("returning name table with languageID "+o[a]._lang),o[a]},t["OS/2"]={},t["OS/2"].parse=function(e,n,r){var i=t._bin.readUshort(e,n);n+=2;var o={};if(0==i)t["OS/2"].version0(e,n,o);else if(1==i)t["OS/2"].version1(e,n,o);else if(2==i||3==i||4==i)t["OS/2"].version2(e,n,o);else{if(5!=i)throw"unknown OS/2 table version: "+i;t["OS/2"].version5(e,n,o)}return o},t["OS/2"].version0=function(e,n,r){var i=t._bin;return r.xAvgCharWidth=i.readShort(e,n),n+=2,r.usWeightClass=i.readUshort(e,n),n+=2,r.usWidthClass=i.readUshort(e,n),n+=2,r.fsType=i.readUshort(e,n),n+=2,r.ySubscriptXSize=i.readShort(e,n),n+=2,r.ySubscriptYSize=i.readShort(e,n),n+=2,r.ySubscriptXOffset=i.readShort(e,n),n+=2,r.ySubscriptYOffset=i.readShort(e,n),n+=2,r.ySuperscriptXSize=i.readShort(e,n),n+=2,r.ySuperscriptYSize=i.readShort(e,n),n+=2,r.ySuperscriptXOffset=i.readShort(e,n),n+=2,r.ySuperscriptYOffset=i.readShort(e,n),n+=2,r.yStrikeoutSize=i.readShort(e,n),n+=2,r.yStrikeoutPosition=i.readShort(e,n),n+=2,r.sFamilyClass=i.readShort(e,n),n+=2,r.panose=i.readBytes(e,n,10),n+=10,r.ulUnicodeRange1=i.readUint(e,n),n+=4,r.ulUnicodeRange2=i.readUint(e,n),n+=4,r.ulUnicodeRange3=i.readUint(e,n),n+=4,r.ulUnicodeRange4=i.readUint(e,n),n+=4,r.achVendID=[i.readInt8(e,n),i.readInt8(e,n+1),i.readInt8(e,n+2),i.readInt8(e,n+3)],n+=4,r.fsSelection=i.readUshort(e,n),n+=2,r.usFirstCharIndex=i.readUshort(e,n),n+=2,r.usLastCharIndex=i.readUshort(e,n),n+=2,r.sTypoAscender=i.readShort(e,n),n+=2,r.sTypoDescender=i.readShort(e,n),n+=2,r.sTypoLineGap=i.readShort(e,n),n+=2,r.usWinAscent=i.readUshort(e,n),n+=2,r.usWinDescent=i.readUshort(e,n),n+2},t["OS/2"].version1=function(e,n,r){var i=t._bin;return n=t["OS/2"].version0(e,n,r),r.ulCodePageRange1=i.readUint(e,n),n+=4,r.ulCodePageRange2=i.readUint(e,n),n+4},t["OS/2"].version2=function(e,n,r){var i=t._bin;return n=t["OS/2"].version1(e,n,r),r.sxHeight=i.readShort(e,n),n+=2,r.sCapHeight=i.readShort(e,n),n+=2,r.usDefault=i.readUshort(e,n),n+=2,r.usBreak=i.readUshort(e,n),n+=2,r.usMaxContext=i.readUshort(e,n),n+2},t["OS/2"].version5=function(e,n,r){var i=t._bin;return n=t["OS/2"].version2(e,n,r),r.usLowerOpticalPointSize=i.readUshort(e,n),n+=2,r.usUpperOpticalPointSize=i.readUshort(e,n),n+2},t.post={},t.post.parse=function(e,n,r){var i=t._bin,o={};return o.version=i.readFixed(e,n),n+=4,o.italicAngle=i.readFixed(e,n),n+=4,o.underlinePosition=i.readShort(e,n),n+=2,o.underlineThickness=i.readShort(e,n),n+=2,o},null==t&&(t={}),null==t.U&&(t.U={}),t.U.codeToGlyph=function(e,t){var n=e.cmap,r=-1;if(null!=n.p0e4?r=n.p0e4:null!=n.p3e1?r=n.p3e1:null!=n.p1e0?r=n.p1e0:null!=n.p0e3&&(r=n.p0e3),-1==r)throw"no familiar platform and encoding!";var i=n.tables[r];if(0==i.format)return t>=i.map.length?0:i.map[t];if(4==i.format){for(var o=-1,s=0;s<i.endCount.length;s++)if(t<=i.endCount[s]){o=s;break}return-1==o||i.startCount[o]>t?0:65535&(0!=i.idRangeOffset[o]?i.glyphIdArray[t-i.startCount[o]+(i.idRangeOffset[o]>>1)-(i.idRangeOffset.length-o)]:t+i.idDelta[o])}if(12==i.format){if(t>i.groups[i.groups.length-1][1])return 0;for(s=0;s<i.groups.length;s++){var a=i.groups[s];if(a[0]<=t&&t<=a[1])return a[2]+(t-a[0])}return 0}throw"unknown cmap table format "+i.format},t.U.glyphToPath=function(e,n){var r={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[n]){var i=e.SVG.entries[n];return null==i?r:("string"==typeof i&&(i=t.SVG.toPath(i),e.SVG.entries[n]=i),i)}if(e.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},s=e.CFF,a=e.CFF.Private;if(s.ROS){for(var l=0;s.FDSelect[l+2]<=n;)l+=2;a=s.FDArray[s.FDSelect[l+1]].Private}t.U._drawCFF(e.CFF.CharStrings[n],o,s,a,r)}else e.glyf&&t.U._drawGlyf(n,e,r);return r},t.U._drawGlyf=function(e,n,r){var i=n.glyf[e];null==i&&(i=n.glyf[e]=t.glyf._parseGlyf(n,e)),null!=i&&(i.noc>-1?t.U._simpleGlyph(i,r):t.U._compoGlyph(i,n,r))},t.U._simpleGlyph=function(e,n){for(var r=0;r<e.noc;r++){for(var i=0==r?0:e.endPts[r-1]+1,o=e.endPts[r],s=i;s<=o;s++){var a=s==i?o:s-1,l=s==o?i:s+1,c=1&e.flags[s],u=1&e.flags[a],h=1&e.flags[l],d=e.xs[s],p=e.ys[s];if(s==i)if(c){if(!u){t.U.P.moveTo(n,d,p);continue}t.U.P.moveTo(n,e.xs[a],e.ys[a])}else u?t.U.P.moveTo(n,e.xs[a],e.ys[a]):t.U.P.moveTo(n,(e.xs[a]+d)/2,(e.ys[a]+p)/2);c?u&&t.U.P.lineTo(n,d,p):h?t.U.P.qcurveTo(n,d,p,e.xs[l],e.ys[l]):t.U.P.qcurveTo(n,d,p,(d+e.xs[l])/2,(p+e.ys[l])/2)}t.U.P.closePath(n)}},t.U._compoGlyph=function(e,n,r){for(var i=0;i<e.parts.length;i++){var o={cmds:[],crds:[]},s=e.parts[i];t.U._drawGlyf(s.glyphIndex,n,o);for(var a=s.m,l=0;l<o.crds.length;l+=2){var c=o.crds[l],u=o.crds[l+1];r.crds.push(c*a.a+u*a.b+a.tx),r.crds.push(c*a.c+u*a.d+a.ty)}for(l=0;l<o.cmds.length;l++)r.cmds.push(o.cmds[l])}},t.U._getGlyphClass=function(e,n){var r=t._lctf.getInterval(n,e);return-1==r?0:n[r+2]},t.U.getPairAdjustment=function(e,n,r){var i=!1;if(e.GPOS)for(var o=e.GPOS,s=o.lookupList,a=o.featureList,l=[],c=0;c<a.length;c++){var u=a[c];if("kern"==u.tag){i=!0;for(var h=0;h<u.tab.length;h++)if(!l[u.tab[h]]){l[u.tab[h]]=!0;for(var d=s[u.tab[h]],p=0;p<d.tabs.length;p++)if(null!=d.tabs[p]){var f,m=d.tabs[p];if((!m.coverage||-1!=(f=t._lctf.coverageIndex(m.coverage,n)))&&1!=d.ltype&&2==d.ltype){var g=null;if(1==m.fmt){var v=m.pairsets[f];for(c=0;c<v.length;c++)v[c].gid2==r&&(g=v[c])}else if(2==m.fmt){var _=t.U._getGlyphClass(n,m.classDef1),b=t.U._getGlyphClass(r,m.classDef2);g=m.matrix[_][b]}if(g){var y=0;return g.val1&&g.val1[2]&&(y+=g.val1[2]),g.val2&&g.val2[0]&&(y+=g.val2[0]),y}}}}}}if(e.kern&&!i){var T=e.kern.glyph1.indexOf(n);if(-1!=T){var E=e.kern.rval[T].glyph2.indexOf(r);if(-1!=E)return e.kern.rval[T].vals[E]}}return 0},t.U._applySubs=function(e,n,r,i){for(var o=e.length-n-1,s=0;s<r.tabs.length;s++)if(null!=r.tabs[s]){var a,l=r.tabs[s];if(!l.coverage||-1!=(a=t._lctf.coverageIndex(l.coverage,e[n])))if(1==r.ltype)e[n],1==l.fmt?e[n]=e[n]+l.delta:e[n]=l.newg[a];else if(4==r.ltype)for(var c=l.vals[a],u=0;u<c.length;u++){var h=c[u],d=h.chain.length;if(!(d>o)){for(var p=!0,f=0,m=0;m<d;m++){for(;-1==e[n+f+(1+m)];)f++;h.chain[m]!=e[n+f+(1+m)]&&(p=!1)}if(p){for(e[n]=h.nglyph,m=0;m<d+f;m++)e[n+m+1]=-1;break}}}else if(5==r.ltype&&2==l.fmt)for(var g=t._lctf.getInterval(l.cDef,e[n]),v=l.cDef[g+2],_=l.scset[v],b=0;b<_.length;b++){var y=_[b],T=y.input;if(!(T.length>o)){for(p=!0,m=0;m<T.length;m++){var E=t._lctf.getInterval(l.cDef,e[n+1+m]);if(-1==g&&l.cDef[E+2]!=T[m]){p=!1;break}}if(p){var S=y.substLookupRecords;for(u=0;u<S.length;u+=2)S[u],S[u+1]}}}else if(6==r.ltype&&3==l.fmt){if(!t.U._glsCovered(e,l.backCvg,n-l.backCvg.length)||!t.U._glsCovered(e,l.inptCvg,n)||!t.U._glsCovered(e,l.ahedCvg,n+l.inptCvg.length))continue;var w=l.lookupRec;for(b=0;b<w.length;b+=2){g=w[b];var x=i[w[b+1]];t.U._applySubs(e,n+g,x,i)}}}},t.U._glsCovered=function(e,n,r){for(var i=0;i<n.length;i++)if(-1==t._lctf.coverageIndex(n[i],e[r+i]))return!1;return!0},t.U.glyphsToPath=function(e,n,r){for(var i={cmds:[],crds:[]},o=0,s=0;s<n.length;s++){var a=n[s];if(-1!=a){for(var l=s<n.length-1&&-1!=n[s+1]?n[s+1]:0,c=t.U.glyphToPath(e,a),u=0;u<c.crds.length;u+=2)i.crds.push(c.crds[u]+o),i.crds.push(c.crds[u+1]);for(r&&i.cmds.push(r),u=0;u<c.cmds.length;u++)i.cmds.push(c.cmds[u]);r&&i.cmds.push("X"),o+=e.hmtx.aWidth[a],s<n.length-1&&(o+=t.U.getPairAdjustment(e,a,l))}}return i},t.U.P={},t.U.P.moveTo=function(e,t,n){e.cmds.push("M"),e.crds.push(t,n)},t.U.P.lineTo=function(e,t,n){e.cmds.push("L"),e.crds.push(t,n)},t.U.P.curveTo=function(e,t,n,r,i,o,s){e.cmds.push("C"),e.crds.push(t,n,r,i,o,s)},t.U.P.qcurveTo=function(e,t,n,r,i){e.cmds.push("Q"),e.crds.push(t,n,r,i)},t.U.P.closePath=function(e){e.cmds.push("Z")},t.U._drawCFF=function(e,n,r,i,o){for(var s=n.stack,a=n.nStems,l=n.haveWidth,c=n.width,u=n.open,h=0,d=n.x,p=n.y,f=0,m=0,g=0,v=0,_=0,b=0,y=0,T=0,E=0,S=0,w={val:0,size:0};h<e.length;){t.CFF.getCharString(e,h,w);var x=w.val;if(h+=w.size,"o1"==x||"o18"==x)s.length%2!=0&&!l&&(c=s.shift()+i.nominalWidthX),a+=s.length>>1,s.length=0,l=!0;else if("o3"==x||"o23"==x)s.length%2!=0&&!l&&(c=s.shift()+i.nominalWidthX),a+=s.length>>1,s.length=0,l=!0;else if("o4"==x)s.length>1&&!l&&(c=s.shift()+i.nominalWidthX,l=!0),u&&t.U.P.closePath(o),p+=s.pop(),t.U.P.moveTo(o,d,p),u=!0;else if("o5"==x)for(;s.length>0;)d+=s.shift(),p+=s.shift(),t.U.P.lineTo(o,d,p);else if("o6"==x||"o7"==x)for(var M=s.length,C="o6"==x,I=0;I<M;I++){var k=s.shift();C?d+=k:p+=k,C=!C,t.U.P.lineTo(o,d,p)}else if("o8"==x||"o24"==x){M=s.length;for(var R=0;R+6<=M;)f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v+s.shift(),t.U.P.curveTo(o,f,m,g,v,d,p),R+=6;"o24"==x&&(d+=s.shift(),p+=s.shift(),t.U.P.lineTo(o,d,p))}else{if("o11"==x)break;if("o1234"==x||"o1235"==x||"o1236"==x||"o1237"==x)"o1234"==x&&(m=p,g=(f=d+s.shift())+s.shift(),S=v=m+s.shift(),b=v,T=p,d=(y=(_=(E=g+s.shift())+s.shift())+s.shift())+s.shift(),t.U.P.curveTo(o,f,m,g,v,E,S),t.U.P.curveTo(o,_,b,y,T,d,p)),"o1235"==x&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),E=g+s.shift(),S=v+s.shift(),_=E+s.shift(),b=S+s.shift(),y=_+s.shift(),T=b+s.shift(),d=y+s.shift(),p=T+s.shift(),s.shift(),t.U.P.curveTo(o,f,m,g,v,E,S),t.U.P.curveTo(o,_,b,y,T,d,p)),"o1236"==x&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),S=v=m+s.shift(),b=v,y=(_=(E=g+s.shift())+s.shift())+s.shift(),T=b+s.shift(),d=y+s.shift(),t.U.P.curveTo(o,f,m,g,v,E,S),t.U.P.curveTo(o,_,b,y,T,d,p)),"o1237"==x&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),E=g+s.shift(),S=v+s.shift(),_=E+s.shift(),b=S+s.shift(),y=_+s.shift(),T=b+s.shift(),Math.abs(y-d)>Math.abs(T-p)?d=y+s.shift():p=T+s.shift(),t.U.P.curveTo(o,f,m,g,v,E,S),t.U.P.curveTo(o,_,b,y,T,d,p));else if("o14"==x){if(s.length>0&&!l&&(c=s.shift()+r.nominalWidthX,l=!0),4==s.length){var A=s.shift(),L=s.shift(),O=s.shift(),N=s.shift(),P=t.CFF.glyphBySE(r,O),D=t.CFF.glyphBySE(r,N);t.U._drawCFF(r.CharStrings[P],n,r,i,o),n.x=A,n.y=L,t.U._drawCFF(r.CharStrings[D],n,r,i,o)}u&&(t.U.P.closePath(o),u=!1)}else if("o19"==x||"o20"==x)s.length%2!=0&&!l&&(c=s.shift()+i.nominalWidthX),a+=s.length>>1,s.length=0,l=!0,h+=a+7>>3;else if("o21"==x)s.length>2&&!l&&(c=s.shift()+i.nominalWidthX,l=!0),p+=s.pop(),d+=s.pop(),u&&t.U.P.closePath(o),t.U.P.moveTo(o,d,p),u=!0;else if("o22"==x)s.length>1&&!l&&(c=s.shift()+i.nominalWidthX,l=!0),d+=s.pop(),u&&t.U.P.closePath(o),t.U.P.moveTo(o,d,p),u=!0;else if("o25"==x){for(;s.length>6;)d+=s.shift(),p+=s.shift(),t.U.P.lineTo(o,d,p);f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v+s.shift(),t.U.P.curveTo(o,f,m,g,v,d,p)}else if("o26"==x)for(s.length%2&&(d+=s.shift());s.length>0;)f=d,m=p+s.shift(),d=g=f+s.shift(),p=(v=m+s.shift())+s.shift(),t.U.P.curveTo(o,f,m,g,v,d,p);else if("o27"==x)for(s.length%2&&(p+=s.shift());s.length>0;)m=p,g=(f=d+s.shift())+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v,t.U.P.curveTo(o,f,m,g,v,d,p);else if("o10"==x||"o29"==x){var $="o10"==x?i:r;if(0==s.length)console.debug("error: empty stack");else{var B=s.pop(),F=$.Subrs[B+$.Bias];n.x=d,n.y=p,n.nStems=a,n.haveWidth=l,n.width=c,n.open=u,t.U._drawCFF(F,n,r,i,o),d=n.x,p=n.y,a=n.nStems,l=n.haveWidth,c=n.width,u=n.open}}else if("o30"==x||"o31"==x){var U=s.length,z=(R=0,"o31"==x);for(R+=U-(M=-3&U);R<M;)z?(m=p,g=(f=d+s.shift())+s.shift(),p=(v=m+s.shift())+s.shift(),M-R==5?(d=g+s.shift(),R++):d=g,z=!1):(f=d,m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),M-R==5?(p=v+s.shift(),R++):p=v,z=!0),t.U.P.curveTo(o,f,m,g,v,d,p),R+=4}else{if("o"==(x+"").charAt(0))throw console.debug("Unknown operation: "+x,e),x;s.push(x)}}}n.x=d,n.y=p,n.nStems=a,n.haveWidth=l,n.width=c,n.open=u};var n=t,r={Typr:n};return e.Typr=n,e.default=r,Object.defineProperty(e,"__esModule",{value:!0}),e}({}).Typr},function(){return function(e){var t=Uint8Array,n=Uint16Array,r=Uint32Array,i=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(e,t){for(var i=new n(31),o=0;o<31;++o)i[o]=t+=1<<e[o-1];var s=new r(i[30]);for(o=1;o<30;++o)for(var a=i[o];a<i[o+1];++a)s[a]=a-i[o]<<5|o;return[i,s]},l=a(i,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var h=a(o,0)[0],d=new n(32768),p=0;p<32768;++p){var f=(43690&p)>>>1|(21845&p)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[p]=((65280&f)>>>8|(255&f)<<8)>>>1}var m=function(e,t,r){for(var i=e.length,o=0,s=new n(t);o<i;++o)++s[e[o]-1];var a,l=new n(t);for(o=0;o<t;++o)l[o]=l[o-1]+s[o-1]<<1;if(r){a=new n(1<<t);var c=15-t;for(o=0;o<i;++o)if(e[o])for(var u=o<<4|e[o],h=t-e[o],p=l[e[o]-1]++<<h,f=p|(1<<h)-1;p<=f;++p)a[d[p]>>>c]=u}else for(a=new n(i),o=0;o<i;++o)e[o]&&(a[o]=d[l[e[o]-1]++]>>>15-e[o]);return a},g=new t(288);for(p=0;p<144;++p)g[p]=8;for(p=144;p<256;++p)g[p]=9;for(p=256;p<280;++p)g[p]=7;for(p=280;p<288;++p)g[p]=8;var v=new t(32);for(p=0;p<32;++p)v[p]=5;var _=m(g,9,1),b=m(v,5,1),y=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},T=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},E=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],w=function(e,t,n){var r=new Error(t||S[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,w),!n)throw r;return r},x=new t(0),M=typeof TextDecoder<"u"&&new TextDecoder;try{M.decode(x,{stream:!0})}catch{}return e.convert_streams=function(e){var a=new DataView(e),l=0;function u(){var e=a.getUint16(l);return l+=2,e}function d(){var e=a.getUint32(l);return l+=4,e}function p(e){L.setUint16(O,e),O+=2}function f(e){L.setUint32(O,e),O+=4}for(var g={signature:d(),flavor:d(),length:d(),numTables:u(),reserved:u(),totalSfntSize:d(),majorVersion:u(),minorVersion:u(),metaOffset:d(),metaLength:d(),metaOrigLength:d(),privOffset:d(),privLength:d()},v=0;Math.pow(2,v)<=g.numTables;)v++;v--;for(var S=16*Math.pow(2,v),x=16*g.numTables-S,M=12,C=[],I=0;I<g.numTables;I++)C.push({tag:d(),offset:d(),compLength:d(),origLength:d(),origChecksum:d()}),M+=16;var k,R=new Uint8Array(12+16*C.length+C.reduce((function(e,t){return e+t.origLength+4}),0)),A=R.buffer,L=new DataView(A),O=0;return f(g.flavor),p(g.numTables),p(S),p(v),p(x),C.forEach((function(e){f(e.tag),f(e.origChecksum),f(M),f(e.origLength),e.outOffset=M,(M+=e.origLength)%4!=0&&(M+=4-M%4)})),C.forEach((function(a){var l=e.slice(a.offset,a.offset+a.compLength);if(a.compLength!=a.origLength){var u=new Uint8Array(a.origLength);(function(e,a,l){var u=e.length;if(!u||l&&!l.l&&u<5)return a||new t(0);var d=!a||l,p=!l||l.i;l||(l={}),a||(a=new t(3*u));var f,g=function(e){var n=a.length;if(e>n){var r=new t(Math.max(2*n,e));r.set(a),a=r}},v=l.f||0,S=l.p||0,x=l.b||0,M=l.l,C=l.d,I=l.m,k=l.n,R=8*u;do{if(!M){l.f=v=T(e,S,1);var A=T(e,S+1,3);if(S+=3,!A){var L=e[(G=((f=S)/8|0)+(7&f&&1)+4)-4]|e[G-3]<<8,O=G+L;if(O>u){p&&w(0);break}d&&g(x+L),a.set(e.subarray(G,O),x),l.b=x+=L,l.p=S=8*O;continue}if(1==A)M=_,C=b,I=9,k=5;else if(2==A){var N=T(e,S,31)+257,P=T(e,S+10,15)+4,D=N+T(e,S+5,31)+1;S+=14;for(var $=new t(D),B=new t(19),F=0;F<P;++F)B[s[F]]=T(e,S+3*F,7);S+=3*P;var U=y(B),z=(1<<U)-1,H=m(B,U,1);for(F=0;F<D;){var G,V=H[T(e,S,z)];if(S+=15&V,(G=V>>>4)<16)$[F++]=G;else{var W=0,j=0;for(16==G?(j=3+T(e,S,3),S+=2,W=$[F-1]):17==G?(j=3+T(e,S,7),S+=3):18==G&&(j=11+T(e,S,127),S+=7);j--;)$[F++]=W}}var X=$.subarray(0,N),Y=$.subarray(N);I=y(X),k=y(Y),M=m(X,I,1),C=m(Y,k,1)}else w(1);if(S>R){p&&w(0);break}}d&&g(x+131072);for(var K=(1<<I)-1,q=(1<<k)-1,J=S;;J=S){var Z=(W=M[E(e,S)&K])>>>4;if((S+=15&W)>R){p&&w(0);break}if(W||w(2),Z<256)a[x++]=Z;else{if(256==Z){J=S,M=null;break}var Q=Z-254;if(Z>264){var ee=i[F=Z-257];Q=T(e,S,(1<<ee)-1)+c[F],S+=ee}var te=C[E(e,S)&q],ne=te>>>4;if(te||w(3),S+=15&te,Y=h[ne],ne>3&&(ee=o[ne],Y+=E(e,S)&(1<<ee)-1,S+=ee),S>R){p&&w(0);break}d&&g(x+131072);for(var re=x+Q;x<re;x+=4)a[x]=a[x-Y],a[x+1]=a[x+1-Y],a[x+2]=a[x+2-Y],a[x+3]=a[x+3-Y];x=re}}l.l=M,l.p=J,l.b=x,M&&(v=1,l.m=I,l.d=C,l.n=k)}while(!v);x==a.length||function(e,i,o){(null==i||i<0)&&(i=0),(null==o||o>e.length)&&(o=e.length);var s=new(e instanceof n?n:e instanceof r?r:t)(o-i);s.set(e.subarray(i,o))}(a,0,x)})(new Uint8Array(l,2),u)}else u=new Uint8Array(l);R.set(u,a.outOffset);var d=0;(M=a.outOffset+a.origLength)%4!=0&&(d=4-M%4),R.set(new Uint8Array(d).buffer,a.outOffset+a.origLength),k=M+d})),A.slice(0,k)},Object.defineProperty(e,"__esModule",{value:!0}),e}({}).convert_streams},function(e,t){const n={M:2,L:2,Q:4,C:6,Z:0},r={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,o=2,s=4,a=8,l=16,c=32;let u;function h(e){if(!u){const e={R:o,L:i,D:s,C:l,U:c,T:a};u=new Map;for(let t in r){let n=0;r[t].split(",").forEach((r=>{let[i,o]=r.split("+");i=parseInt(i,36),o=o?parseInt(o,36):0,u.set(n+=i,e[t]);for(let s=o;s--;)u.set(++n,e[t])}))}}return u.get(e)||c}const d=1,p=2,f=3,m=4,g=[null,"isol","init","fina","medi"];function v(e){const t=new Uint8Array(e.length);let n=c,r=d,u=-1;for(let g=0;g<e.length;g++){const v=e.codePointAt(g);let _=0|h(v),b=d;_&a||(n&(i|s|l)?_&(o|s|l)?(b=f,(r===d||r===f)&&t[u]++):_&(i|c)&&(r===p||r===m)&&t[u]--:n&(o|c)&&(r===p||r===m)&&t[u]--,r=t[g]=b,n=_,u=g,v>65535&&g++)}return t}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;r++)if("number"==typeof t[r])return t[r]}function b(t){const r=Object.create(null),i=t["OS/2"],o=t.hhea,s=t.head.unitsPerEm,a=_(i&&i.sTypoAscender,o&&o.ascender,s),l={unitsPerEm:s,ascender:a,descender:_(i&&i.sTypoDescender,o&&o.descender,0),capHeight:_(i&&i.sCapHeight,a),xHeight:_(i&&i.sxHeight,a),lineGap:_(i&&i.sTypoLineGap,o&&o.lineGap),forEachGlyph(i,o,s,a){let c=0;const u=1/l.unitsPerEm*o,h=function(t,n){const r=[];for(let o=0;o<n.length;o++){const i=n.codePointAt(o);i>65535&&o++,r.push(e.U.codeToGlyph(t,i))}const i=t.GSUB;if(i){const{lookupList:t,featureList:o}=i;let s;const a=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,l=[];o.forEach((i=>{if(a.test(i.tag))for(let o=0;o<i.tab.length;o++){if(l[i.tab[o]])continue;l[i.tab[o]]=!0;const a=t[i.tab[o]],c=/^(isol|init|fina|medi)$/.test(i.tag);c&&!s&&(s=v(n));for(let n=0;n<r.length;n++)(!s||!c||g[s[n]]===i.tag)&&e.U._applySubs(r,n,a,t)}}))}return r}(t,i);let d=0,p=-1;return h.forEach(((l,h)=>{if(-1!==l){let i=r[l];if(!i){const{cmds:o,crds:s}=e.U.glyphToPath(t,l);let a,c,u,h,d="",p=0;for(let e=0,t=o.length;e<t;e++){const t=n[o[e]];d+=o[e];for(let e=1;e<=t;e++)d+=(e>1?",":"")+s[p++]}if(s.length){a=c=1/0,u=h=-1/0;for(let e=0,t=s.length;e<t;e+=2){let t=s[e],n=s[e+1];t<a&&(a=t),n<c&&(c=n),t>u&&(u=t),n>h&&(h=n)}}else a=u=c=h=0;i=r[l]={index:l,advanceWidth:t.hmtx.aWidth[l],xMin:a,yMin:c,xMax:u,yMax:h,path:d,pathCommandCount:o.length}}-1!==p&&(c+=e.U.getPairAdjustment(t,p,l)*u),a.call(null,i,c,d),i.advanceWidth&&(c+=i.advanceWidth*u),s&&(c+=s*o),p=l}d+=i.codePointAt(d)>65535?2:1})),c}};return l}return function(n){const r=new Uint8Array(n,0,4),i=e._bin.readASCII(r,0,4);if("wOFF"===i)n=t(n);else if("wOF2"===i)throw new Error("woff2 fonts not supported");return b(e.parse(n)[0])}}],init:(e,t,n)=>n(e(),t())}),ig={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},og=new ln;function sg(){return(self.performance||Date).now()}const ag=Object.create(null);function lg(e,t){e=function(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}({},e);const n=sg();if(e.font=function(e){return ug||(ug=typeof document>"u"?{}:document.createElement("a")),ug.href=e,ug.href}(e.font||ig.defaultFontURL),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||ig.sdfGlyphSize,null!=e.colorRanges){let t={};for(let n in e.colorRanges)if(e.colorRanges.hasOwnProperty(n)){let r=e.colorRanges[n];"number"!=typeof r&&(r=og.set(r).getHex()),t[n]=r}e.colorRanges=t}Object.freeze(e);const{textureWidth:r,sdfExponent:i}=ig,{sdfGlyphSize:o}=e,s=r/o*4;let a=ag[o];if(!a){const e=document.createElement("canvas");e.width=r,e.height=256*o/s,a=ag[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:e,sdfTexture:new fn(e,void 0,void 0,void 0,pe,pe),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,function(e){const t=e.sdfCanvas;t.addEventListener("webglcontextlost",(t=>{console.log("Context Lost",t),t.preventDefault(),e.contextLost=!0})),t.addEventListener("webglcontextrestored",(t=>{console.log("Context Restored",t),e.contextLost=!1;const n=[];e.glyphsByFont.forEach((t=>{t.forEach((t=>{n.push(cg(t,e,!0))}))})),Promise.all(n).then((()=>{hg(e),e.sdfTexture.needsUpdate=!0}))}))}(a)}const{sdfTexture:l,sdfCanvas:c}=a;let u=a.glyphsByFont.get(e.font);u||a.glyphsByFont.set(e.font,u=new Map),pg(e).then((h=>{const{glyphIds:d,glyphPositions:p,fontSize:f,unitsPerEm:m,timings:g}=h,v=[],_=new Float32Array(4*d.length),b=f/m;let y=0,T=0;const E=sg();d.forEach(((e,t)=>{let n=u.get(e);if(!n){const{path:t,pathBounds:r}=h.glyphData[e],i=Math.max(r[2]-r[0],r[3]-r[1])/o*(ig.sdfMargin*o+.5),s=a.glyphCount++,l=[r[0]-i,r[1]-i,r[2]+i,r[3]+i];u.set(e,n={path:t,atlasIndex:s,sdfViewBox:l}),v.push(n)}const{sdfViewBox:r}=n,i=p[T++],s=p[T++];_[y++]=i+r[0]*b,_[y++]=s+r[1]*b,_[y++]=i+r[2]*b,_[y++]=s+r[3]*b,d[t]=n.atlasIndex})),g.quads=(g.quads||0)+(sg()-E);const S=sg();g.sdf={};const w=c.height,x=Math.ceil(a.glyphCount/s),M=Math.pow(2,Math.ceil(Math.log2(x*o)));M>w&&(console.info("Increasing SDF texture size ".concat(w,"->").concat(M)),ng(c,r,M),l.dispose()),Promise.all(v.map((t=>cg(t,a,e.gpuAccelerateSDF).then((e=>{let{timing:n}=e;g.sdf[t.atlasIndex]=n}))))).then((()=>{v.length&&!a.contextLost&&(hg(a),l.needsUpdate=!0),g.sdfTotal=sg()-S,g.total=sg()-n,t(Object.freeze({parameters:e,sdfTexture:l,sdfGlyphSize:o,sdfExponent:i,glyphBounds:_,glyphAtlasIndices:d,glyphColors:h.glyphColors,caretPositions:h.caretPositions,caretHeight:h.caretHeight,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))}))})),Promise.resolve().then((()=>{a.contextLost||function(e){e._warm||(Wm.webgl.isSupported(e),e._warm=!0)}(c)}))}function cg(e,t,n){let{path:r,atlasIndex:i,sdfViewBox:o}=e,{sdfGlyphSize:s,sdfCanvas:a,contextLost:l}=t;if(l)return Promise.resolve({timing:-1});const{textureWidth:c,sdfExponent:u}=ig,h=Math.max(o[2]-o[0],o[3]-o[1]),d=Math.floor(i/4);return function(e,t,n,r,i,o,s,a,l,c){return arguments.length>10&&void 0!==arguments[10]&&!arguments[10]?tg(e,t,n,r,i,o,s,a,l,c):qm(e,t,n,r,i,o,s,a,l,c).then(null,(u=>(jm||(console.warn("WebGL SDF generation failed, falling back to JS",u),jm=!0),tg(e,t,n,r,i,o,s,a,l,c))))}(s,s,r,o,h,u,a,d%(c/s)*s,Math.floor(d/(c/s))*s,i%4,n)}let ug;function hg(e){if("function"!=typeof createImageBitmap){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:n}=e,{width:r,height:i}=t,o=e.sdfCanvas.getContext("webgl");let s=n.image.data;(!s||s.length!==r*i*4)&&(s=new Uint8Array(r*i*4),n.image={width:r,height:i,data:s},n.flipY=!1,n.isDataTexture=!0),o.readPixels(0,0,r,i,o.RGBA,o.UNSIGNED_BYTE,s)}}const dg=Cm({name:"Typesetter",dependencies:[ig,rg,function(e,t,n){const{defaultFontURL:r}=n,i=Object.create(null),o=1/0,s=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",l=new RegExp("".concat(a,"|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]"));function c(t,n){t||(t=r);let o=i[t];o?o.pending?o.pending.push(n):n(o):(i[t]={pending:[n]},function(t,n){!function i(){const o=e=>{console.error("Failure loading font ".concat(t).concat(t===r?"":"; trying fallback"),e),t!==r&&(t=r,i())};try{const r=new XMLHttpRequest;r.open("get",t,!0),r.responseType="arraybuffer",r.onload=function(){if(r.status>=400)o(new Error(r.statusText));else if(r.status>0)try{const t=e(r.response);n(t)}catch(t){o(t)}},r.onerror=o,r.send()}catch(s){o(s)}}()}(t,(e=>{let n=i[t].pending;i[t]=e,n.forEach((t=>t(e)))})))}function u(e,n){let{text:i="",font:u=r,sdfGlyphSize:m=64,fontSize:g=1,letterSpacing:v=0,lineHeight:_="normal",maxWidth:b=o,direction:y,textAlign:T="left",textIndent:E=0,whiteSpace:S="normal",overflowWrap:w="normal",anchorX:x=0,anchorY:M=0,includeCaretPositions:C=!1,chunkedBoundsSize:I=8192,colorRanges:k=null}=e,R=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const A=p(),L={fontLoad:0,typesetting:0};i.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),i=i.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),g=+g,v=+v,b=+b,_=_||"normal",E=+E,c(u,(e=>{const r=isFinite(b);let c=null,u=null,m=null,O=null,N=null,P=null,D=null,$=0,B=0,F="nowrap"!==S;const{ascender:U,descender:z,unitsPerEm:H,lineGap:G,capHeight:V,xHeight:W}=e;L.fontLoad=p()-A;const j=p(),X=g/H;"normal"===_&&(_=(U-z+G)/H),_*=g;const Y=(_-(U-z)*X)/2,K=-(U*X+Y),q=Math.min(_,(U-z)*X),J=(U+z)/2*X-q/2;let Z=E,Q=new f;const ee=[Q];e.forEachGlyph(i,g,v,((e,t,n)=>{const o=i.charAt(n),c=e.advanceWidth*X,u=Q.count;let h;if("isEmpty"in e||(e.isWhitespace=!!o&&new RegExp(a).test(o),e.canBreakAfter=!!o&&l.test(o),e.isEmpty=e.xMin===e.xMax||e.yMin===e.yMax||s.test(o)),!e.isWhitespace&&!e.isEmpty&&B++,F&&r&&!e.isWhitespace&&t+c+Z>b&&u){if(Q.glyphAt(u-1).glyphObj.canBreakAfter)h=new f,Z=-t;else for(let e=u;e--;){if(0===e&&"break-word"===w){h=new f,Z=-t;break}if(Q.glyphAt(e).glyphObj.canBreakAfter){h=Q.splitAt(e+1);const t=h.glyphAt(0).x;Z-=t;for(let e=h.count;e--;)h.glyphAt(e).x-=t;break}}h&&(Q.isSoftWrapped=!0,Q=h,ee.push(Q),$=b)}let d=Q.glyphAt(Q.count);d.glyphObj=e,d.x=t+Z,d.width=c,d.charIndex=n,"\n"===o&&(Q=new f,ee.push(Q),Z=-(t+c+v*g)+E)})),ee.forEach((e=>{for(let t=e.count;t--;){let{glyphObj:n,x:r,width:i}=e.glyphAt(t);if(!n.isWhitespace)return e.width=r+i,void(e.width>$&&($=e.width))}}));let te=0,ne=0;if(x&&("number"==typeof x?te=-x:"string"==typeof x&&(te=-$*("left"===x?0:"center"===x?.5:"right"===x?1:h(x)))),M)if("number"==typeof M)ne=-M;else if("string"==typeof M){let e=ee.length*_;ne="top"===M?0:"top-baseline"===M?-K:"top-cap"===M?-K-V*X:"top-ex"===M?-K-W*X:"middle"===M?e/2:"bottom"===M?e:"bottom-baseline"===M?e-Y+z*X:h(M)*e}if(!R){const n=t.getEmbeddingLevels(i,y);c=new Uint16Array(B),u=new Float32Array(2*B),m={},P=[o,o,-o,-o],D=[];let r=K;C&&(N=new Float32Array(3*i.length)),k&&(O=new Uint8Array(3*B));let s,a,l=0,h=-1,p=-1;if(ee.forEach(((f,g)=>{let{count:v,width:b}=f;if(v>0){let g=0;for(let e=v;e--&&f.glyphAt(e).glyphObj.isWhitespace;)g++;let _=0,y=0;if("center"===T)_=($-b)/2;else if("right"===T)_=$-b;else if("justify"===T&&f.isSoftWrapped){let e=0;for(let t=v-g;t--;)f.glyphAt(t).glyphObj.isWhitespace&&e++;y=($-b)/e}if(y||_){let e=0;for(let t=0;t<v;t++){let n=f.glyphAt(t);const r=n.glyphObj;n.x+=_+e,0!==y&&r.isWhitespace&&t<v-g&&(e+=y,n.width+=y)}}const E=t.getReorderSegments(i,n,f.glyphAt(0).charIndex,f.glyphAt(f.count-1).charIndex);for(let e=0;e<E.length;e++){const[t,n]=E[e];let r=1/0,i=-1/0;for(let e=0;e<v;e++)if(f.glyphAt(e).charIndex>=t){let t=e,o=e;for(;o<v;o++){let e=f.glyphAt(o);if(e.charIndex>n)break;o<v-g&&(r=Math.min(r,e.x),i=Math.max(i,e.x+e.width))}for(let e=t;e<o;e++){const t=f.glyphAt(e);t.x=i-(t.x+t.width-r)}break}}let S;const w=e=>S=e;for(let b=0;b<v;b++){let g=f.glyphAt(b);S=g.glyphObj;const v=S.index,_=1&n.levels[g.charIndex];if(_){const n=t.getMirroredCharacter(i[g.charIndex]);n&&e.forEachGlyph(n,0,0,w)}if(C){const{charIndex:e}=g,t=g.x+te,n=g.x+g.width+te;N[3*e]=_?n:t,N[3*e+1]=_?t:n,N[3*e+2]=r+J+ne;const i=e-h;i>1&&d(N,h,i),h=e}if(k){const{charIndex:e}=g;for(;e>p;)p++,k.hasOwnProperty(p)&&(a=k[p])}if(!S.isWhitespace&&!S.isEmpty){const e=l++;m[v]||(m[v]={path:S.path,pathBounds:[S.xMin,S.yMin,S.xMax,S.yMax]});const t=g.x+te,n=r+ne;u[2*e]=t,u[2*e+1]=n;const i=t+S.xMin*X,h=n+S.yMin*X,d=t+S.xMax*X,p=n+S.yMax*X;i<P[0]&&(P[0]=i),h<P[1]&&(P[1]=h),d>P[2]&&(P[2]=d),p>P[3]&&(P[3]=p),e%I===0&&(s={start:e,end:e,rect:[o,o,-o,-o]},D.push(s)),s.end++;const f=s.rect;if(i<f[0]&&(f[0]=i),h<f[1]&&(f[1]=h),d>f[2]&&(f[2]=d),p>f[3]&&(f[3]=p),c[e]=v,k){const t=3*e;O[t]=a>>16&255,O[t+1]=a>>8&255,O[t+2]=255&a}}}}r-=_})),N){const e=i.length-h;e>1&&d(N,h,e)}}L.typesetting=p()-j,n({glyphIds:c,glyphPositions:u,glyphData:m,caretPositions:N,caretHeight:q,glyphColors:O,chunkedBounds:D,fontSize:g,unitsPerEm:H,ascender:U*X,descender:z*X,capHeight:V*X,xHeight:W*X,lineHeight:_,topBaseline:K,blockBounds:[te,ne-ee.length*_,te+$,ne],visibleBounds:P,timings:L})}))}function h(e){let t=e.match(/^([\d.]+)%$/),n=t?parseFloat(t[1]):NaN;return isNaN(n)?0:n/100}function d(e,t,n){const r=e[3*t],i=e[3*t+1],o=e[3*t+2],s=(i-r)/n;for(let a=0;a<n;a++){const n=3*(t+a);e[n]=r+s*a,e[n+1]=r+s*(a+1),e[n+2]=o}}function p(){return(self.performance||Date).now()}function f(){this.data=[]}const m=["glyphObj","x","width","charIndex"];return f.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(e){let t=f.flyweight;return t.data=this.data,t.index=e,t},splitAt(e){let t=new f;return t.data=this.data.splice(e*m.length),t}},f.flyweight=m.reduce(((e,t,n,r)=>(Object.defineProperty(e,t,{get(){return this.data[this.index*m.length+n]},set(e){this.data[this.index*m.length+n]=e}}),e)),{data:null,index:0}),{typeset:u,measure:function(e,t){u(e,(e=>{const[n,r,i,o]=e.blockBounds;t({width:i-n,height:o-r})}),{metricsOnly:!0})},loadFont:c}},function(){var e=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},r={};n.L=1,r[1]="L",Object.keys(t).forEach((function(e,t){n[e]=1<<t+1,r[n[e]]=e})),Object.freeze(n);var i=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,s=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,a=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,l=n.S|n.WS|n.B|i|n.PDI|a,c=null;function u(e){return function(){if(!c){c=new Map;var e=function(e){if(t.hasOwnProperty(e)){var r=0;t[e].split(",").forEach((function(t){var i=t.split("+"),o=i[0],s=i[1];o=parseInt(o,36),s=s?parseInt(s,36):0,c.set(r+=o,n[e]);for(var a=0;a<s;a++)c.set(++r,n[e])}))}};for(var r in t)e(r)}}(),c.get(e.codePointAt(0))||n.L}var h,d,p,f={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(e,t){var n,r=0,i=new Map,o=t&&new Map;return e.split(",").forEach((function e(s){if(-1!==s.indexOf("+"))for(var a=+s;a--;)e(n);else{n=s;var l=s.split(">"),c=l[0],u=l[1];c=String.fromCodePoint(r+=parseInt(c,36)),u=String.fromCodePoint(r+=parseInt(u,36)),i.set(c,u),t&&o.set(u,c)}})),{map:i,reverseMap:o}}function g(){if(!h){var e=m(f.pairs,!0),t=e.map,n=e.reverseMap;h=t,d=n,p=m(f.canonical,!1).map}}function v(e){return g(),h.get(e)||null}function _(e){return g(),d.get(e)||null}function b(e){return g(),p.get(e)||null}var y=n.L,T=n.R,E=n.EN,S=n.ES,w=n.ET,x=n.AN,M=n.CS,C=n.B,I=n.S,k=n.ON,R=n.BN,A=n.NSM,L=n.AL,O=n.LRO,N=n.RLO,P=n.LRE,D=n.RLE,$=n.PDF,B=n.LRI,F=n.RLI,U=n.FSI,z=n.PDI;var H,G="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1";function V(e){return function(){if(!H){var e=m(G,!0),t=e.map;e.reverseMap.forEach((function(e,n){t.set(n,e)})),H=t}}(),H.get(e)||null}function W(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);var o=[];return t.paragraphs.forEach((function(i){var s=Math.max(n,i.start),a=Math.min(r,i.end);if(s<a){for(var c=t.levels.slice(s,a+1),h=a;h>=s&&u(e[h])&l;h--)c[h]=i.level;for(var d=i.level,p=1/0,f=0;f<c.length;f++){var m=c[f];m>d&&(d=m),m<p&&(p=1|m)}for(var g=d;g>=p;g--)for(var v=0;v<c.length;v++)if(c[v]>=g){for(var _=v;v+1<c.length&&c[v+1]>=g;)v++;v>_&&o.push([_+n,v+n])}}})),o}function j(e,t,n,r){for(var i=W(e,t,n,r),o=[],s=0;s<e.length;s++)o[s]=s;return i.forEach((function(e){for(var t=e[0],n=e[1],r=o.slice(t,n+1),i=r.length;i--;)o[n-i]=r[i]})),o}return e.closingToOpeningBracket=_,e.getBidiCharType=u,e.getBidiCharTypeName=function(e){return r[u(e)]},e.getCanonicalBracket=b,e.getEmbeddingLevels=function(e,t){for(var n=new Uint32Array(e.length),r=0;r<e.length;r++)n[r]=u(e[r]);var c=new Map;function h(e,t){var r=n[e];n[e]=t,c.set(r,c.get(r)-1),r&s&&c.set(s,c.get(s)-1),c.set(t,(c.get(t)||0)+1),t&s&&c.set(s,(c.get(s)||0)+1)}for(var d=new Uint8Array(e.length),p=new Map,f=[],m=null,g=0;g<e.length;g++)m||f.push(m={start:g,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:zt(g,!1)}),n[g]&C&&(m.end=g,m=null);for(var H=D|P|N|O|i|z|$|C,G=function(e){return e+(1&e?1:2)},V=function(e){return e+(1&e?2:1)},W=0;W<f.length;W++){var j=[{_level:(m=f[W]).level,_override:0,_isolate:0}],X=void 0,Y=0,K=0,q=0;c.clear();for(var J=m.start;J<=m.end;J++){var Z=n[J];if(X=j[j.length-1],c.set(Z,(c.get(Z)||0)+1),Z&s&&c.set(s,(c.get(s)||0)+1),Z&H)if(Z&(D|P)){d[J]=X._level;var Q=(Z===D?V:G)(X._level);Q<=125&&!Y&&!K?j.push({_level:Q,_override:0,_isolate:0}):Y||K++}else if(Z&(N|O)){d[J]=X._level;var ee=(Z===N?V:G)(X._level);ee<=125&&!Y&&!K?j.push({_level:ee,_override:Z&N?T:y,_isolate:0}):Y||K++}else if(Z&i){Z&U&&(Z=1===zt(J+1,!0)?F:B),d[J]=X._level,X._override&&h(J,X._override);var te=(Z===F?V:G)(X._level);te<=125&&0===Y&&0===K?(q++,j.push({_level:te,_override:0,_isolate:1,_isolInitIndex:J})):Y++}else if(Z&z){if(Y>0)Y--;else if(q>0){for(K=0;!j[j.length-1]._isolate;)j.pop();var ne=j[j.length-1]._isolInitIndex;null!=ne&&(p.set(ne,J),p.set(J,ne)),j.pop(),q--}X=j[j.length-1],d[J]=X._level,X._override&&h(J,X._override)}else Z&$?(0===Y&&(K>0?K--:!X._isolate&&j.length>1&&(j.pop(),X=j[j.length-1])),d[J]=X._level):Z&C&&(d[J]=m.level);else d[J]=X._level,X._override&&Z!==R&&h(J,X._override)}for(var re=[],ie=null,oe=m.start;oe<=m.end;oe++){var se=n[oe];if(!(se&a)){var ae=d[oe],le=se&i,ce=se===z;ie&&ae===ie._level?(ie._end=oe,ie._endsWithIsolInit=le):re.push(ie={_start:oe,_end:oe,_level:ae,_startsWithPDI:ce,_endsWithIsolInit:le})}}for(var ue=[],he=0;he<re.length;he++){var de=re[he];if(!de._startsWithPDI||de._startsWithPDI&&!p.has(de._start)){for(var pe=[ie=de],fe=void 0;ie&&ie._endsWithIsolInit&&null!=(fe=p.get(ie._end));)for(var me=he+1;me<re.length;me++)if(re[me]._start===fe){pe.push(ie=re[me]);break}for(var ge=[],ve=0;ve<pe.length;ve++)for(var _e=pe[ve],be=_e._start;be<=_e._end;be++)ge.push(be);for(var ye=d[ge[0]],Te=m.level,Ee=ge[0]-1;Ee>=0;Ee--)if(!(n[Ee]&a)){Te=d[Ee];break}var Se=ge[ge.length-1],we=d[Se],xe=m.level;if(!(n[Se]&i))for(var Me=Se+1;Me<=m.end;Me++)if(!(n[Me]&a)){xe=d[Me];break}ue.push({_seqIndices:ge,_sosType:Math.max(Te,ye)%2?T:y,_eosType:Math.max(xe,we)%2?T:y})}}for(var Ce=0;Ce<ue.length;Ce++){var Ie=ue[Ce],ke=Ie._seqIndices,Re=Ie._sosType,Ae=Ie._eosType;if(c.get(A))for(var Le=0;Le<ke.length;Le++){var Oe=ke[Le];if(n[Oe]&A){for(var Ne=Re,Pe=Le-1;Pe>=0;Pe--)if(!(n[ke[Pe]]&a)){Ne=n[ke[Pe]];break}h(Oe,Ne&(i|z)?k:Ne)}}if(c.get(E))for(var De=0;De<ke.length;De++){var $e=ke[De];if(n[$e]&E)for(var Be=De-1;Be>=-1;Be--){var Fe=-1===Be?Re:n[ke[Be]];if(Fe&o){Fe===L&&h($e,x);break}}}if(c.get(L))for(var Ue=0;Ue<ke.length;Ue++){var ze=ke[Ue];n[ze]&L&&h(ze,T)}if(c.get(S)||c.get(M))for(var He=1;He<ke.length-1;He++){var Ge=ke[He];if(n[Ge]&(S|M)){for(var Ve=0,We=0,je=He-1;je>=0&&(Ve=n[ke[je]])&a;je--);for(var Xe=He+1;Xe<ke.length&&(We=n[ke[Xe]])&a;Xe++);Ve===We&&(n[Ge]===S?Ve===E:Ve&(E|x))&&h(Ge,Ve)}}if(c.get(E))for(var Ye=0;Ye<ke.length;Ye++){var Ke=ke[Ye];if(n[Ke]&E){for(var qe=Ye-1;qe>=0&&n[ke[qe]]&(w|a);qe--)h(ke[qe],E);for(var Je=Ye+1;Je<ke.length&&n[ke[Je]]&(w|a);Je++)h(ke[Je],E)}}if(c.get(w)||c.get(S)||c.get(M))for(var Ze=0;Ze<ke.length;Ze++){var Qe=ke[Ze];if(n[Qe]&(w|S|M)){h(Qe,k);for(var et=Ze-1;et>=0&&n[ke[et]]&a;et--)h(ke[et],k);for(var tt=Ze+1;tt<ke.length&&n[ke[tt]]&a;tt++)h(ke[tt],k)}}if(c.get(E))for(var nt=0,rt=Re;nt<ke.length;nt++){var it=ke[nt],ot=n[it];ot&E?rt===y&&h(it,y):ot&o&&(rt=ot)}if(c.get(s)){for(var st=T|E|x,at=st|y,lt=[],ct=[],ut=0;ut<ke.length;ut++)if(n[ke[ut]]&s){var ht=e[ke[ut]],dt=void 0;if(null!==v(ht)){if(!(ct.length<63))break;ct.push({char:ht,seqIndex:ut})}else if(null!==(dt=_(ht)))for(var pt=ct.length-1;pt>=0;pt--){var ft=ct[pt].char;if(ft===dt||ft===_(b(ht))||v(b(ft))===ht){lt.push([ct[pt].seqIndex,ut]),ct.length=pt;break}}}lt.sort((function(e,t){return e[0]-t[0]}));for(var mt=0;mt<lt.length;mt++){for(var gt=lt[mt],vt=gt[0],_t=gt[1],bt=!1,yt=0,Tt=vt+1;Tt<_t;Tt++){var Et=ke[Tt];if(n[Et]&at){bt=!0;var St=n[Et]&st?T:y;if(St===Gt(Et)){yt=St;break}}}if(bt&&!yt){yt=Re;for(var wt=vt-1;wt>=0;wt--){var xt=ke[wt];if(n[xt]&at){var Mt=n[xt]&st?T:y;yt=Mt!==Gt(xt)?Mt:Gt(xt);break}}}if(yt){if(n[ke[vt]]=n[ke[_t]]=yt,yt!==Gt(ke[vt]))for(var Ct=vt+1;Ct<ke.length;Ct++)if(!(n[ke[Ct]]&a)){u(e[ke[Ct]])&A&&(n[ke[Ct]]=yt);break}if(yt!==Gt(ke[_t]))for(var It=_t+1;It<ke.length;It++)if(!(n[ke[It]]&a)){u(e[ke[It]])&A&&(n[ke[It]]=yt);break}}}for(var kt=0;kt<ke.length;kt++)if(n[ke[kt]]&s){for(var Rt=kt,At=kt,Lt=Re,Ot=kt-1;Ot>=0;Ot--){if(!(n[ke[Ot]]&a)){Lt=n[ke[Ot]]&st?T:y;break}Rt=Ot}for(var Nt=Ae,Pt=kt+1;Pt<ke.length;Pt++){if(!(n[ke[Pt]]&(s|a))){Nt=n[ke[Pt]]&st?T:y;break}At=Pt}for(var Dt=Rt;Dt<=At;Dt++)n[ke[Dt]]=Lt===Nt?Lt:Gt(ke[Dt]);kt=At}}}for(var $t=m.start;$t<=m.end;$t++){var Bt=d[$t],Ft=n[$t];if(1&Bt?Ft&(y|E|x)&&d[$t]++:Ft&T?d[$t]++:Ft&(x|E)&&(d[$t]+=2),Ft&a&&(d[$t]=0===$t?m.level:d[$t-1]),$t===m.end||u(e[$t])&(I|C))for(var Ut=$t;Ut>=0&&u(e[Ut])&l;Ut--)d[Ut]=m.level}}return{levels:d,paragraphs:f};function zt(t,r){for(var o=t;o<e.length;o++){var s=n[o];if(s&(T|L))return 1;if(s&(C|y)||r&&s===z)return 0;if(s&i){var a=Ht(o);o=-1===a?e.length:a}}return 0}function Ht(t){for(var r=1,o=t+1;o<e.length;o++){var s=n[o];if(s&C)break;if(s&z){if(0===--r)return o}else s&i&&r++}return-1}function Gt(e){return 1&d[e]?T:y}},e.getMirroredCharacter=V,e.getMirroredCharactersMap=function(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);for(var o=new Map,s=n;s<=r;s++)if(1&t[s]){var a=V(e[s]);null!==a&&o.set(s,a)}return o},e.getReorderSegments=W,e.getReorderedIndices=j,e.getReorderedString=function(e,t,n,r){var i=j(e,t,n,r),o=[].concat(e);return i.forEach((function(n,r){o[r]=(1&t.levels[n]?V(e[n]):null)||e[n]})),o.join("")},e.openingToClosingBracket=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e}],init(e,t,n,r){const{defaultFontURL:i}=e;return n(t,r(),{defaultFontURL:i})}}),pg=Cm({name:"Typesetter",dependencies:[dg],init:e=>function(t){return new Promise((n=>{e.typeset(t,n)}))},getTransferables(e){const t=[e.glyphPositions.buffer,e.glyphIds.buffer];return e.caretPositions&&t.push(e.caretPositions.buffer),e.glyphColors&&t.push(e.glyphColors.buffer),t}}),fg={};const mg="aTroikaGlyphIndex";class gg extends eh{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Hn,this.boundingBox=new Sn}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const t=this.getIndex().count;this.setDrawRange(e===f?t/2:0,e===m?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,("number"!=typeof e||e<1)&&(e=1);let t=function(e){let t=fg[e];if(!t){const n=new Di(1,1,e,e),r=n.clone(),i=n.attributes,o=r.attributes,s=new qr,a=i.uv.count;for(let e=0;e<a;e++)o.position.array[3*e]*=-1,o.normal.array[3*e+2]*=-1;["position","normal","uv"].forEach((e=>{s.setAttribute(e,new Hr([...i[e].array,...o[e].array],i[e].itemSize))})),s.setIndex([...n.index.array,...r.index.array.map((e=>e+a))]),s.translate(.5,.5,0),t=fg[e]=s}return t}(e);["position","normal","uv"].forEach((e=>{this.attributes[e]=t.attributes[e].clone()})),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,r,i){vg(this,"aTroikaGlyphBounds",e,4),vg(this,mg,t,1),vg(this,"aTroikaGlyphColor",i,3),this._blockBounds=n,this._chunkedBounds=r,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:r,floor:i,min:o,max:s,sin:a,cos:l}=Math,c=r/2,u=2*r,h=Math.abs(t),d=e[0]/h,p=e[2]/h,f=i((d+c)/u)!==i((p+c)/u)?-h:o(a(d)*h,a(p)*h),m=i((d-c)/u)!==i((p-c)/u)?h:s(a(d)*h,a(p)*h),g=i((d+r)/u)!==i((p+r)/u)?2*h:s(h-l(d)*h,h-l(p)*h);n.min.set(f,e[1],t<0?-g:0),n.max.set(m,e[3],t<0?0:g)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(mg).count,n=this._chunkedBounds;if(n)for(let r=n.length;r--;){t=n[r].end;let i=n[r].rect;if(i[1]<e.w&&i[3]>e.y&&i[0]<e.z&&i[2]>e.x)break}this.instanceCount=t}}function vg(e,t,n,r){const i=e.getAttribute(t);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(e.setAttribute(t,new el(n,r)),delete e._maxInstanceCount,e.dispose()):i&&e.deleteAttribute(t)}const _g=new Dr({color:16777215,side:m,transparent:!0}),bg=8421504,yg=new Jn,Tg=new yn,Eg=new yn,Sg=[],wg=new yn,xg="+x+y";function Mg(e){return Array.isArray(e)?e[0]:e}let Cg=()=>{const e=new fi(new Di(1,1),_g);return Cg=()=>e,e},Ig=()=>{const e=new fi(new Di(1,1,32,1),_g);return Ig=()=>e,e};const kg={type:"syncstart"},Rg={type:"synccomplete"},Ag=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Lg=Ag.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class Og extends fi{constructor(){super(new gg,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=bg,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=xg,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(kg),lg({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},(t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync((()=>{n.forEach((e=>e&&e()))}))),this.dispatchEvent(Rg),e&&e()}))))}onBeforeRender(e,t,n,r,i,o){this.sync(),i.isTroikaTextMaterial&&this._prepareForRender(i),i._hadOwnSide=i.hasOwnProperty("side"),this.geometry.setSide(i._actualSide=i.side),i.side=p}onAfterRender(e,t,n,r,i,o){i._hadOwnSide?i.side=i._actualSide:delete i.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=_g.clone());if((!e||e.baseMaterial!==t)&&(e=this._derivedMaterial=function(e){const t=Fm(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Wt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new mn(0,0,0,0)},uTroikaClipRect:{value:new mn(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Wt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new ln},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new jt},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of exponential encoding in webgl-sdf-generator\n  \n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  \n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n",fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat fragDistance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  fragDistance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter(e){let{vertexShader:t,fragmentShader:n}=e,r=/\buniform\s+vec3\s+diffuse\b/;return r.test(n)&&(n=n.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(t)||(t=t.replace(Am,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:t,fragmentShader:n}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}(t),t.addEventListener("dispose",(function n(){t.removeEventListener("dispose",n),e.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let t=e._outlineMtl;return t||(t=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),t.isTextOutlineMaterial=!0,t.depthWrite=!1,t.map=null,e.addEventListener("dispose",(function n(){e.removeEventListener("dispose",n),t.dispose()}))),[t,e]}return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Mg(this.material).getDepthMaterial()}get customDistanceMaterial(){return Mg(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:e,blockBounds:i}=r;n.uTroikaSDFTexture.value=e,n.uTroikaSDFTextureSize.value.set(e.image.width,e.image.height),n.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,n.uTroikaSDFExponent.value=r.sdfExponent,n.uTroikaTotalBounds.value.fromArray(i),n.uTroikaUseGlyphColors.value=!t&&!!r.glyphColors;let o,s,a,l=0,c=0,u=0,h=0,d=0;if(t){let{outlineWidth:e,outlineOffsetX:t,outlineOffsetY:n,outlineBlur:r,outlineOpacity:i}=this;l=this._parsePercent(e)||0,c=Math.max(0,this._parsePercent(r)||0),o=i,h=this._parsePercent(t)||0,d=this._parsePercent(n)||0}else u=Math.max(0,this._parsePercent(this.strokeWidth)||0),u&&(a=this.strokeColor,n.uTroikaStrokeColor.value.set(null==a?bg:a),s=this.strokeOpacity,null==s&&(s=1)),o=this.fillOpacity;n.uTroikaDistanceOffset.value=l,n.uTroikaPositionOffset.value.set(h,d),n.uTroikaBlurRadius.value=c,n.uTroikaStrokeWidth.value=u,n.uTroikaStrokeOpacity.value=s,n.uTroikaFillOpacity.value=null==o?1:o,n.uTroikaCurveRadius.value=this.curveRadius||0;let p=this.clipRect;if(p&&Array.isArray(p)&&4===p.length)n.uTroikaClipRect.value.fromArray(p);else{const e=100*(this.fontSize||.1);n.uTroikaClipRect.value.set(i[0]-e,i[1]-e,i[2]+e,i[3]+e)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const i=t?this.outlineColor||0:this.color;if(null==i)delete e.color;else{const t=e.hasOwnProperty("color")?e.color:e.color=new ln;(i!==t._input||"object"==typeof i)&&t.set(t._input=i)}let o=this.orientation||xg;if(o!==e._orientation){let t=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let r=o!==xg&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(r){let[,e,n,i,o]=r;Tg.set(0,0,0)[n]="-"===e?1:-1,Eg.set(0,0,0)[o]="-"===i?-1:1,yg.lookAt(wg,Tg.cross(Eg),Eg),t.setFromMatrix4(yg)}else t.identity();e._orientation=o}}_parsePercent(e){if("string"==typeof e){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;return Tg.copy(e),this.localPositionToTextCoords(this.worldToLocal(Tg),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:r}=this;if(n){const i=n.blockBounds,o=r?Ig():Cg(),s=o.geometry,{position:a,uv:l}=s.attributes;for(let e=0;e<l.count;e++){let t=i[0]+l.getX(e)*(i[2]-i[0]);const n=i[1]+l.getY(e)*(i[3]-i[1]);let o=0;r&&(o=r-Math.cos(t/r)*r,t=Math.sin(t/r)*r),a.setXYZ(e,t,n,o)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Sg.length=0,o.raycast(e,Sg);for(let e=0;e<Sg.length;e++)Sg[e].object=this,t.push(Sg[e])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Lg.forEach((t=>{this[t]=e[t]})),this}clone(){return(new this.constructor).copy(this)}}Ag.forEach((e=>{const t="_private_"+e;Object.defineProperty(Og.prototype,e,{get(){return this[t]},set(e){e!==this[t]&&(this[t]=e,this._needsSync=!0)}})}));const Ng=e.forwardRef(((t,n)=>{let{anchorX:r="center",anchorY:i="middle",font:o,fontSize:s=1,children:a,characters:l,onSync:c,...u}=t;const h=yp((e=>{let{invalidate:t}=e;return t})),[d]=e.useState((()=>new Og)),[p,f]=e.useMemo((()=>{const t=[];let n="";return e.Children.forEach(a,(e=>{"string"==typeof e||"number"==typeof e?n+=e:t.push(e)})),[t,n]}),[a]);return Cd((()=>new Promise((e=>function(e,t){let{font:n,characters:r,sdfGlyphSize:i}=e;lg({font:n,sdfGlyphSize:i,text:Array.isArray(r)?r.join("\n"):""+r},t)}({font:o,characters:l},e)))),["troika-text",o,l]),e.useLayoutEffect((()=>{d.sync((()=>{h(),c&&c(d)}))})),e.useEffect((()=>()=>d.dispose()),[d]),Ld("primitive",{object:d,ref:n,font:o,text:f,anchorX:r,anchorY:i,fontSize:s,...u,children:p})}));var Pg=9007199254740991,Dg="[object Arguments]",$g="[object Function]",Bg="[object GeneratorFunction]",Fg="[object Symbol]",Ug="object"==typeof ud&&ud&&ud.Object===Object&&ud,zg="object"==typeof self&&self&&self.Object===Object&&self,Hg=Ug||zg||Function("return this")();function Gg(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Vg=Object.prototype,Wg=Vg.hasOwnProperty,jg=Vg.toString,Xg=Hg.Symbol,Yg=Vg.propertyIsEnumerable,Kg=Xg?Xg.isConcatSpreadable:void 0,qg=Math.max;function Jg(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=Zg),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?Jg(a,t-1,n,r,i):Gg(i,a):r||(i[i.length]=a)}return i}function Zg(e){return ev(e)||function(e){return function(e){return tv(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Pg}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?jg.call(e):"";return t==$g||t==Bg}(e)}(e)}(e)&&Wg.call(e,"callee")&&(!Yg.call(e,"callee")||jg.call(e)==Dg)}(e)||!!(Kg&&e&&e[Kg])}function Qg(e){if("string"==typeof e||function(e){return"symbol"==typeof e||tv(e)&&jg.call(e)==Fg}(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}var ev=Array.isArray;function tv(e){return!!e&&"object"==typeof e}var nv=function(e,t){return t=qg(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,i=qg(n.length-t,0),o=Array(i);++r<i;)o[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=o,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}((function(e,t){return null==e?{}:function(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=e[s];n(a,s)&&(o[s]=a)}return o}(e=Object(e),t,(function(t,n){return n in e}))}(e,function(e,t){for(var n=-1,r=e?e.length:0,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(Jg(t,1),Qg))})),rv=nv;const iv=e.forwardRef(((t,n)=>{let{makeDefault:r,camera:i,regress:o,domElement:s,enableDamping:a=!0,onChange:l,onStart:c,onEnd:u,...h}=t;const d=yp((e=>e.invalidate)),p=yp((e=>e.camera)),f=yp((e=>e.gl)),m=yp((e=>e.events)),g=yp((e=>e.setEvents)),v=yp((e=>e.set)),_=yp((e=>e.get)),b=yp((e=>e.performance)),y=i||p,T=s||m.connected||f.domElement,E=e.useMemo((()=>new Gf(y)),[y]);return Tp((()=>{E.enabled&&E.update()}),-1),e.useEffect((()=>(E.connect(T),()=>{E.dispose()})),[T,o,E,d]),e.useEffect((()=>{const e=e=>{d(),o&&b.regress(),l&&l(e)},t=e=>{c&&c(e)},n=e=>{u&&u(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}}),[l,c,u,E,d,g]),e.useEffect((()=>{if(r){const e=_().controls;return v({controls:E}),()=>v({controls:e})}}),[r,E]),Ld("primitive",{ref:n,object:E,enableDamping:a,...h})}));class ov extends vl{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:n}=t.capabilities;e.fragmentShader=e.fragmentShader.replace("#include <output_fragment>","\n        ".concat(n?"#include <output_fragment>":"#extension GL_OES_standard_derivatives : enable\n#include <output_fragment>","\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <encodings_fragment>\n      "))}}}const sv=e.forwardRef(((t,n)=>{const[r]=e.useState((()=>new ov(null)));return Ld("primitive",{...t,object:r,ref:n,attach:"material"})}));const av=function(t){const n=t+"Geometry";return e.forwardRef(((e,t)=>{let{args:r,children:i,...o}=e;return Od("mesh",{ref:t,...o,children:[Ld(n,{attach:"geometry",args:r}),i]})}))}("circle");let lv,cv;const uv=e.createContext(null),hv=new Jn,dv=new yn,pv=e.forwardRef(((t,n)=>{let{children:r,range:i,limit:o=1e3,...s}=t;const a=e.useRef(null),[l,c]=e.useState([]),[[u,h,d]]=e.useState((()=>[new Float32Array(3*o),Float32Array.from({length:3*o},(()=>1)),Float32Array.from({length:o},(()=>1))]));e.useEffect((()=>{a.current.geometry.attributes.position.needsUpdate=!0})),Tp((()=>{for(a.current.updateMatrix(),a.current.updateMatrixWorld(),hv.copy(a.current.matrixWorld).invert(),a.current.geometry.drawRange.count=Math.min(o,void 0!==i?i:o,l.length),lv=0;lv<l.length;lv++)cv=l[lv].current,cv.getWorldPosition(dv).applyMatrix4(hv),dv.toArray(u,3*lv),a.current.geometry.attributes.position.needsUpdate=!0,cv.matrixWorldNeedsUpdate=!0,cv.color.toArray(h,3*lv),a.current.geometry.attributes.color.needsUpdate=!0,d.set([cv.size],lv),a.current.geometry.attributes.size.needsUpdate=!0}));const p=e.useMemo((()=>({getParent:()=>a,subscribe:e=>(c((t=>[...t,e])),()=>c((t=>t.filter((t=>t.current!==e.current)))))})),[]);return e.createElement("points",Lp({userData:{instances:l},matrixAutoUpdate:!1,ref:Cf([n,a]),raycast:()=>null},s),Od("bufferGeometry",{children:[Ld("bufferAttribute",{attach:"attributes-position",count:u.length/3,array:u,itemSize:3,usage:kt}),Ld("bufferAttribute",{attach:"attributes-color",count:h.length/3,array:h,itemSize:3,usage:kt}),Ld("bufferAttribute",{attach:"attributes-size",count:d.length,array:d,itemSize:1,usage:kt})]}),e.createElement(uv.Provider,{value:p},r))})),fv=e.forwardRef(((t,n)=>{let{children:r,positions:i,colors:o,sizes:s,stride:a=3,...l}=t;const c=e.useRef(null);return Tp((()=>{const e=c.current.geometry.attributes;e.position.needsUpdate=!0,o&&(e.color.needsUpdate=!0),s&&(e.size.needsUpdate=!0)})),Od("points",{ref:Cf([n,c]),...l,children:[Od("bufferGeometry",{children:[Ld("bufferAttribute",{attach:"attributes-position",count:i.length/a,array:i,itemSize:a,usage:kt}),o&&Ld("bufferAttribute",{attach:"attributes-color",count:o.length/a,array:o,itemSize:3,usage:kt}),s&&Ld("bufferAttribute",{attach:"attributes-size",count:s.length/a,array:s,itemSize:1,usage:kt})]}),r]})})),mv=e.forwardRef(((e,t)=>e.positions instanceof Float32Array?Ld(fv,{...e,ref:t}):Ld(pv,{...e,ref:t}))),gv=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!=typeof i)?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!==({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(r,i,o),o};var vv,_v={exports:{}},bv={},yv={exports:{}},Tv={};var Ev,Sv;function wv(){return Ev||(Ev=1,function(t){t.exports=function(){if(vv)return Tv;vv=1;var t=e,n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function a(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch{return!0}}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?function(e,t){return t()}:function(e,t){var n=t(),l=r({inst:{value:n,getSnapshot:t}}),c=l[0].inst,u=l[1];return o((function(){c.value=n,c.getSnapshot=t,a(c)&&u({inst:c})}),[e,n,t]),i((function(){return a(c)&&u({inst:c}),e((function(){a(c)&&u({inst:c})}))}),[e]),s(n),n};return Tv.useSyncExternalStore=void 0!==t.useSyncExternalStore?t.useSyncExternalStore:l,Tv}()}(yv)),yv.exports}!function(t){t.exports=function(){if(Sv)return bv;Sv=1;var t=e,n=wv(),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=n.useSyncExternalStore,o=t.useRef,s=t.useEffect,a=t.useMemo,l=t.useDebugValue;return bv.useSyncExternalStoreWithSelector=function(e,t,n,c,u){var h=o(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=a((function(){function e(e){if(!s){if(s=!0,i=e,e=c(e),void 0!==u&&d.hasValue){var t=d.value;if(u(t,e))return o=t}return o=e}if(t=o,r(i,e))return t;var n=c(e);return void 0!==u&&u(t,n)?t:(i=e,o=n)}var i,o,s=!1,a=void 0===n?null:n;return[function(){return e(t())},null===a?void 0:function(){return e(a())}]}),[t,n,c,u]);var p=i(e,h[0],h[1]);return s((function(){d.hasValue=!0,d.value=p}),[p]),l(p),p},bv}()}(_v);const xv=hd(_v.exports),{useSyncExternalStoreWithSelector:Mv}=xv;function Cv(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getState,r=arguments.length>2?arguments[2]:void 0;const i=Mv(t.subscribe,t.getState,t.getServerState||t.getState,n,r);return(0,e.useDebugValue)(i),i}const Iv=e=>{"production"!==({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?gv(e):gv)(e):e,n=(e,n)=>Cv(t,e,n);return Object.assign(n,t),n},kv=e=>(t,n,r)=>{const i=r.subscribe;return r.subscribe=(e,t,n)=>{let o=e;if(t){const i=(null==n?void 0:n.equalityFn)||Object.is;let s=e(r.getState());o=n=>{const r=e(n);if(!i(s,r)){const e=s;t(s=r,e)}},null!=n&&n.fireImmediately&&t(s,s)}return i(o)},e(t,n,r)};function Rv(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Av(e){return!!e&&!!e[g_]}function Lv(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===v_}(e)||Array.isArray(e)||!!e[m_]||!!e.constructor[m_]||$v(e)||Bv(e))}function Ov(e,t,n){void 0===n&&(n=!1),0===Nv(e)?(n?Object.keys:__)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function Nv(e){var t=e[g_];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:$v(e)?2:Bv(e)?3:0}function Pv(e,t){return 2===Nv(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Dv(e,t,n){var r=Nv(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function $v(e){return h_&&e instanceof Map}function Bv(e){return d_&&e instanceof Set}function Fv(e){return e.o||e.t}function Uv(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=b_(e);delete t[g_];for(var n=__(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function zv(e,t){return void 0===t&&(t=!1),Gv(e)||Av(e)||!Lv(e)||(Nv(e)>1&&(e.set=e.add=e.clear=e.delete=Hv),Object.freeze(e),t&&Ov(e,(function(e,t){return zv(t,!0)}),!0)),e}function Hv(){Rv(2)}function Gv(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Vv(e){var t=y_[e];return t||Rv(18,e),t}function Wv(){return c_}function jv(e,t){t&&(Vv("Patches"),e.u=[],e.s=[],e.v=t)}function Xv(e){Yv(e),e.p.forEach(qv),e.p=null}function Yv(e){e===c_&&(c_=e.l)}function Kv(e){return c_={p:[],l:c_,h:e,m:!0,_:0}}function qv(e){var t=e[g_];0===t.i||1===t.i?t.j():t.O=!0}function Jv(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||Vv("ES5").S(t,e,r),r?(n[g_].P&&(Xv(t),Rv(4)),Lv(e)&&(e=Zv(t,e),t.l||e_(t,e)),t.u&&Vv("Patches").M(n[g_].t,e,t.u,t.s)):e=Zv(t,n,[]),Xv(t),t.u&&t.v(t.u,t.s),e!==f_?e:void 0}function Zv(e,t,n){if(Gv(t))return t;var r=t[g_];if(!r)return Ov(t,(function(i,o){return Qv(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return e_(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=Uv(r.k):r.o;Ov(3===r.i?new Set(i):i,(function(t,o){return Qv(e,r,i,t,o,n)})),e_(e,i,!1),n&&e.u&&Vv("Patches").R(r,n,e.u,e.s)}return r.o}function Qv(e,t,n,r,i,o){if(Av(i)){var s=Zv(e,i,o&&t&&3!==t.i&&!Pv(t.D,r)?o.concat(r):void 0);if(Dv(n,r,s),!Av(s))return;e.m=!1}if(Lv(i)&&!Gv(i)){if(!e.h.F&&e._<1)return;Zv(e,i),t&&t.A.l||e_(e,i)}}function e_(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&zv(t,n)}function t_(e,t){var n=e[g_];return(n?Fv(n):e)[t]}function n_(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function r_(e){e.P||(e.P=!0,e.l&&r_(e.l))}function i_(e){e.o||(e.o=Uv(e.t))}function o_(e,t,n){var r=$v(t)?Vv("MapSet").N(t,n):Bv(t)?Vv("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Wv(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=T_;n&&(i=[r],o=E_);var s=Proxy.revocable(i,o),a=s.revoke,l=s.proxy;return r.k=l,r.j=a,l}(t,n):Vv("ES5").J(t,n);return(n?n.A:Wv()).p.push(r),r}function s_(e){return Av(e)||Rv(22,e),function e(t){if(!Lv(t))return t;var n,r=t[g_],i=Nv(t);if(r){if(!r.P&&(r.i<4||!Vv("ES5").K(r)))return r.t;r.I=!0,n=a_(t,i),r.I=!1}else n=a_(t,i);return Ov(n,(function(t,i){r&&function(e,t){return 2===Nv(e)?e.get(t):e[t]}(r.t,t)===i||Dv(n,t,e(i))})),3===i?new Set(n):n}(e)}function a_(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Uv(e)}var l_,c_,u_=typeof Symbol<"u"&&"symbol"==typeof Symbol("x"),h_=typeof Map<"u",d_=typeof Set<"u",p_=typeof Proxy<"u"&&void 0!==Proxy.revocable&&typeof Reflect<"u",f_=u_?Symbol.for("immer-nothing"):((l_={})["immer-nothing"]=!0,l_),m_=u_?Symbol.for("immer-draftable"):"__$immer_draftable",g_=u_?Symbol.for("immer-state"):"__$immer_state",v_=""+Object.prototype.constructor,__=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,b_=Object.getOwnPropertyDescriptors||function(e){var t={};return __(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},y_={},T_={get:function(e,t){if(t===g_)return e;var n=Fv(e);if(!Pv(n,t))return function(e,t,n){var r,i=n_(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Lv(r)?r:r===t_(e.t,t)?(i_(e),e.o[t]=o_(e.A.h,r,e)):r},has:function(e,t){return t in Fv(e)},ownKeys:function(e){return Reflect.ownKeys(Fv(e))},set:function(e,t,n){var r=n_(Fv(e),t);if(null!=r&&r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=t_(Fv(e),t),o=null==i?void 0:i[g_];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||Pv(e.t,t)))return!0;i_(e),r_(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==t_(e.t,t)||t in e.t?(e.D[t]=!1,i_(e),r_(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Fv(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}},defineProperty:function(){Rv(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Rv(12)}},E_={};Ov(T_,(function(e,t){E_[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),E_.deleteProperty=function(e,t){return E_.set.call(this,e,t,void 0)},E_.set=function(e,t,n){return T_.set.call(this,e[0],t,n,e[0])};var S_=function(){function e(e){var t=this;this.g=p_,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,s=Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&Rv(6),void 0!==r&&"function"!=typeof r&&Rv(7),Lv(e)){var a=Kv(t),l=o_(t,e,void 0),c=!0;try{s=n(l),c=!1}finally{c?Xv(a):Yv(a)}return typeof Promise<"u"&&s instanceof Promise?s.then((function(e){return jv(a,r),Jv(e,a)}),(function(e){throw Xv(a),e})):(jv(a,r),Jv(s,a))}if(!e||"object"!=typeof e){if(void 0===(s=n(e))&&(s=e),s===f_&&(s=void 0),t.F&&zv(s,!0),r){var u=[],h=[];Vv("Patches").M(e,s,u,h),r(u,h)}return s}Rv(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var r,i,o=t.produce(e,n,(function(e,t){r=e,i=t}));return typeof Promise<"u"&&o instanceof Promise?o.then((function(e){return[e,r,i]})):[o,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Lv(e)||Rv(8),Av(e)&&(e=s_(e));var t=Kv(this),n=o_(this,e,void 0);return n[g_].C=!0,Yv(t),n},t.finishDraft=function(e,t){var n=(e&&e[g_]).A;return jv(n,t),Jv(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!p_&&Rv(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=Vv("Patches").$;return Av(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),w_=new S_,x_=w_.produce;w_.produceWithPatches.bind(w_),w_.setAutoFreeze.bind(w_),w_.setUseProxies.bind(w_),w_.applyPatches.bind(w_),w_.createDraft.bind(w_),w_.finishDraft.bind(w_);const M_=e=>(t,n,r)=>(r.setState=function(e,n){const r="function"==typeof e?x_(e):e;for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];return t(r,n,...o)},e(r.setState,n,r));class C_{constructor(){this._previousTime=0,this._currentTime=0,this._delta=0,this._elapsed=0,this._timescale=1,this._useFixedDelta=!1,this._fixedDelta=16.67,this._usePageVisibilityAPI=typeof document<"u"&&void 0!==document.hidden,!0===this._usePageVisibilityAPI&&(this._pageVisibilityHandler=I_.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disableFixedDelta(){return this._useFixedDelta=!1,this}dispose(){return!0===this._usePageVisibilityAPI&&document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this}enableFixedDelta(){return this._useFixedDelta=!0,this}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getFixedDelta(){return this._fixedDelta/1e3}getTimescale(){return this._timescale}reset(){return this._currentTime=this._now(),this}setFixedDelta(e){return this._fixedDelta=1e3*e,this}setTimescale(e){return this._timescale=e,this}update(){return!0===this._useFixedDelta?this._delta=this._fixedDelta:(this._previousTime=this._currentTime,this._currentTime=this._now(),this._delta=this._currentTime-this._previousTime),this._delta*=this._timescale,this._elapsed+=this._delta,this}_now(){return(typeof performance>"u"?Date:performance).now()}}function I_(){!1===document.hidden&&this.reset()}var k_={exports:{}};!function(e,t){(function(){var n,r="Expected a function",i="__lodash_hash_undefined__",o="__lodash_placeholder__",s=16,a=32,l=64,c=128,u=256,h=1/0,d=9007199254740991,p=NaN,f=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",a],["partialRight",l],["rearg",u]],g="[object Arguments]",v="[object Array]",_="[object Boolean]",b="[object Date]",y="[object Error]",T="[object Function]",E="[object GeneratorFunction]",S="[object Map]",w="[object Number]",x="[object Object]",M="[object Promise]",C="[object RegExp]",I="[object Set]",k="[object String]",R="[object Symbol]",A="[object WeakMap]",L="[object ArrayBuffer]",O="[object DataView]",N="[object Float32Array]",P="[object Float64Array]",D="[object Int8Array]",$="[object Int16Array]",B="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",G=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,X=/[&<>"']/g,Y=RegExp(j.source),K=RegExp(X.source),q=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,re=RegExp(ne.source),ie=/^\s+/,oe=/\s/,se=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,he=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ye=/($^)/,Te=/['\n\r\u2028\u2029\\]/g,Ee="\\ud800-\\udfff",Se="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",xe="a-z\\xdf-\\xf6\\xf8-\\xff",Me="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\ufe0e\\ufe0f",Ie="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ke="['\u2019]",Re="["+Ee+"]",Ae="["+Ie+"]",Le="["+Se+"]",Oe="\\d+",Ne="["+we+"]",Pe="["+xe+"]",De="[^"+Ee+Ie+Oe+we+xe+Me+"]",$e="\\ud83c[\\udffb-\\udfff]",Be="[^"+Ee+"]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ue="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+Me+"]",He="\\u200d",Ge="(?:"+Pe+"|"+De+")",Ve="(?:"+ze+"|"+De+")",We="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",je="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Xe="(?:"+Le+"|"+$e+")"+"?",Ye="["+Ce+"]?",Ke=Ye+Xe+("(?:"+He+"(?:"+[Be,Fe,Ue].join("|")+")"+Ye+Xe+")*"),qe="(?:"+[Ne,Fe,Ue].join("|")+")"+Ke,Je="(?:"+[Be+Le+"?",Le,Fe,Ue,Re].join("|")+")",Ze=RegExp(ke,"g"),Qe=RegExp(Le,"g"),et=RegExp($e+"(?="+$e+")|"+Je+Ke,"g"),tt=RegExp([ze+"?"+Pe+"+"+We+"(?="+[Ae,ze,"$"].join("|")+")",Ve+"+"+je+"(?="+[Ae,ze+Ge,"$"].join("|")+")",ze+"?"+Ge+"+"+We,ze+"+"+je,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oe,qe].join("|"),"g"),nt=RegExp("["+He+Ee+Se+Ce+"]"),rt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,it=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ot=-1,st={};st[N]=st[P]=st[D]=st[$]=st[B]=st[F]=st[U]=st[z]=st[H]=!0,st[g]=st[v]=st[L]=st[_]=st[O]=st[b]=st[y]=st[T]=st[S]=st[w]=st[x]=st[C]=st[I]=st[k]=st[A]=!1;var at={};at[g]=at[v]=at[L]=at[O]=at[_]=at[b]=at[N]=at[P]=at[D]=at[$]=at[B]=at[S]=at[w]=at[x]=at[C]=at[I]=at[k]=at[R]=at[F]=at[U]=at[z]=at[H]=!0,at[y]=at[T]=at[A]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,ut=parseInt,ht="object"==typeof ud&&ud&&ud.Object===Object&&ud,dt="object"==typeof self&&self&&self.Object===Object&&self,pt=ht||dt||Function("return this")(),ft=t&&!t.nodeType&&t,mt=ft&&e&&!e.nodeType&&e,gt=mt&&mt.exports===ft,vt=gt&&ht.process,_t=function(){try{return mt&&mt.require&&mt.require("util").types||vt&&vt.binding&&vt.binding("util")}catch{}}(),bt=_t&&_t.isArrayBuffer,yt=_t&&_t.isDate,Tt=_t&&_t.isMap,Et=_t&&_t.isRegExp,St=_t&&_t.isSet,wt=_t&&_t.isTypedArray;function xt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Mt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function Ct(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function It(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Rt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function At(e,t){return!!(null==e?0:e.length)&&zt(e,t,0)>-1}function Lt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Ot(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Nt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Pt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Dt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function $t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Bt=Wt("length");function Ft(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Ut(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function zt(e,t,n){return t===t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Ut(e,Gt,n)}function Ht(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Gt(e){return e!==e}function Vt(e,t){var n=null==e?0:e.length;return n?Yt(e,t)/n:p}function Wt(e){return function(t){return null==t?n:t[e]}}function jt(e){return function(t){return null==e?n:e[t]}}function Xt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Yt(e,t){for(var r,i=-1,o=e.length;++i<o;){var s=t(e[i]);s!==n&&(r=r===n?s:r+s)}return r}function Kt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function qt(e){return e&&e.slice(0,pn(e)+1).replace(ie,"")}function Jt(e){return function(t){return e(t)}}function Zt(e,t){return Ot(t,(function(t){return e[t]}))}function Qt(e,t){return e.has(t)}function en(e,t){for(var n=-1,r=e.length;++n<r&&zt(t,e[n],0)>-1;);return n}function tn(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}var nn=jt({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),rn=jt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function on(e){return"\\"+lt[e]}function sn(e){return nt.test(e)}function an(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,r=e.length,i=0,s=[];++n<r;){var a=e[n];(a===t||a===o)&&(e[n]=o,s[i++]=n)}return s}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function hn(e){return sn(e)?function(e){for(var t=et.lastIndex=0;et.test(e);)++t;return t}(e):Bt(e)}function dn(e){return sn(e)?function(e){return e.match(et)||[]}(e):function(e){return e.split("")}(e)}function pn(e){for(var t=e.length;t--&&oe.test(e.charAt(t)););return t}var fn=jt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var mn=function e(t){var oe=(t=null==t?pt:mn.defaults(pt.Object(),t,mn.pick(pt,it))).Array,Ee=t.Date,Se=t.Error,we=t.Function,xe=t.Math,Me=t.Object,Ce=t.RegExp,Ie=t.String,ke=t.TypeError,Re=oe.prototype,Ae=we.prototype,Le=Me.prototype,Oe=t["__core-js_shared__"],Ne=Ae.toString,Pe=Le.hasOwnProperty,De=0,$e=function(){var e=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Be=Le.toString,Fe=Ne.call(Me),Ue=pt._,ze=Ce("^"+Ne.call(Pe).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=gt?t.Buffer:n,Ge=t.Symbol,Ve=t.Uint8Array,We=He?He.allocUnsafe:n,je=ln(Me.getPrototypeOf,Me),Xe=Me.create,Ye=Le.propertyIsEnumerable,Ke=Re.splice,qe=Ge?Ge.isConcatSpreadable:n,Je=Ge?Ge.iterator:n,et=Ge?Ge.toStringTag:n,nt=function(){try{var e=uo(Me,"defineProperty");return e({},"",{}),e}catch{}}(),lt=t.clearTimeout!==pt.clearTimeout&&t.clearTimeout,ht=Ee&&Ee.now!==pt.Date.now&&Ee.now,dt=t.setTimeout!==pt.setTimeout&&t.setTimeout,ft=xe.ceil,mt=xe.floor,vt=Me.getOwnPropertySymbols,_t=He?He.isBuffer:n,Bt=t.isFinite,jt=Re.join,gn=ln(Me.keys,Me),vn=xe.max,_n=xe.min,bn=Ee.now,yn=t.parseInt,Tn=xe.random,En=Re.reverse,Sn=uo(t,"DataView"),wn=uo(t,"Map"),xn=uo(t,"Promise"),Mn=uo(t,"Set"),Cn=uo(t,"WeakMap"),In=uo(Me,"create"),kn=Cn&&new Cn,Rn={},An=$o(Sn),Ln=$o(wn),On=$o(xn),Nn=$o(Mn),Pn=$o(Cn),Dn=Ge?Ge.prototype:n,$n=Dn?Dn.valueOf:n,Bn=Dn?Dn.toString:n;function Fn(e){if(ea(e)&&!Gs(e)&&!(e instanceof Gn)){if(e instanceof Hn)return e;if(Pe.call(e,"__wrapped__"))return Bo(e)}return new Hn(e)}var Un=function(){function e(){}return function(t){if(!Qs(t))return{};if(Xe)return Xe(t);e.prototype=t;var r=new e;return e.prototype=n,r}}();function zn(){}function Hn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function Gn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new jn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Wn(e);this.size=t.size}function Kn(e,t){var n=Gs(e),r=!n&&Hs(e),i=!n&&!r&&Xs(e),o=!n&&!r&&!i&&la(e),s=n||r||i||o,a=s?Kt(e.length,Ie):[],l=a.length;for(var c in e)(t||Pe.call(e,c))&&(!s||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_o(c,l)))&&a.push(c);return a}function qn(e){var t=e.length;return t?e[Xr(0,t-1)]:n}function Jn(e,t){return No(Ii(e),sr(t,0,e.length))}function Zn(e){return No(Ii(e))}function Qn(e,t,r){(r!==n&&!Fs(e[t],r)||r===n&&!(t in e))&&ir(e,t,r)}function er(e,t,r){var i=e[t];(!Pe.call(e,t)||!Fs(i,r)||r===n&&!(t in e))&&ir(e,t,r)}function tr(e,t){for(var n=e.length;n--;)if(Fs(e[n][0],t))return n;return-1}function nr(e,t,n,r){return hr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function rr(e,t){return e&&ki(t,Ra(t),e)}function ir(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function or(e,t){for(var r=-1,i=t.length,o=oe(i),s=null==e;++r<i;)o[r]=s?n:xa(e,t[r]);return o}function sr(e,t,r){return e===e&&(r!==n&&(e=e<=r?e:r),t!==n&&(e=e>=t?e:t)),e}function ar(e,t,r,i,o,s){var a,l=1&t,c=2&t,u=4&t;if(r&&(a=o?r(e,i,o,s):r(e)),a!==n)return a;if(!Qs(e))return e;var h=Gs(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Pe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Ii(e,a)}else{var d=fo(e),p=d==T||d==E;if(Xs(e))return Ei(e,l);if(d==x||d==g||p&&!o){if(a=c||p?{}:go(e),!l)return c?function(e,t){return ki(e,po(e),t)}(e,function(e,t){return e&&ki(t,Aa(t),e)}(a,e)):function(e,t){return ki(e,ho(e),t)}(e,rr(a,e))}else{if(!at[d])return o?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case L:return Si(e);case _:case b:return new r(+e);case O:return function(e,t){var n=t?Si(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case N:case P:case D:case $:case B:case F:case U:case z:case H:return wi(e,n);case S:return new r;case w:case k:return new r(e);case C:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case I:return new r;case R:return function(e){return $n?Me($n.call(e)):{}}(e)}}(e,d,l)}}s||(s=new Yn);var f=s.get(e);if(f)return f;s.set(e,a),oa(e)?e.forEach((function(n){a.add(ar(n,t,r,n,e,s))})):ta(e)&&e.forEach((function(n,i){a.set(i,ar(n,t,r,i,e,s))}));var m=h?n:(u?c?ro:no:c?Aa:Ra)(e);return Ct(m||e,(function(n,i){m&&(n=e[i=n]),er(a,i,ar(n,t,r,i,e,s))})),a}function lr(e,t,r){var i=r.length;if(null==e)return!i;for(e=Me(e);i--;){var o=r[i],s=t[o],a=e[o];if(a===n&&!(o in e)||!s(a))return!1}return!0}function cr(e,t,i){if("function"!=typeof e)throw new ke(r);return Ro((function(){e.apply(n,i)}),t)}function ur(e,t,n,r){var i=-1,o=At,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;n&&(t=Ot(t,Jt(n))),r?(o=Lt,s=!1):t.length>=200&&(o=Qt,s=!1,t=new Xn(t));e:for(;++i<a;){var u=e[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h===h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,r)||l.push(u)}return l}Fn.templateSettings={escape:q,evaluate:J,interpolate:Z,variable:"",imports:{_:Fn}},Fn.prototype=zn.prototype,Fn.prototype.constructor=Fn,Hn.prototype=Un(zn.prototype),Hn.prototype.constructor=Hn,Gn.prototype=Un(zn.prototype),Gn.prototype.constructor=Gn,Vn.prototype.clear=function(){this.__data__=In?In(null):{},this.size=0},Vn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vn.prototype.get=function(e){var t=this.__data__;if(In){var r=t[e];return r===i?n:r}return Pe.call(t,e)?t[e]:n},Vn.prototype.has=function(e){var t=this.__data__;return In?t[e]!==n:Pe.call(t,e)},Vn.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=In&&t===n?i:t,this},Wn.prototype.clear=function(){this.__data__=[],this.size=0},Wn.prototype.delete=function(e){var t=this.__data__,n=tr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ke.call(t,n,1),--this.size,!0)},Wn.prototype.get=function(e){var t=this.__data__,r=tr(t,e);return r<0?n:t[r][1]},Wn.prototype.has=function(e){return tr(this.__data__,e)>-1},Wn.prototype.set=function(e,t){var n=this.__data__,r=tr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},jn.prototype.clear=function(){this.size=0,this.__data__={hash:new Vn,map:new(wn||Wn),string:new Vn}},jn.prototype.delete=function(e){var t=lo(this,e).delete(e);return this.size-=t?1:0,t},jn.prototype.get=function(e){return lo(this,e).get(e)},jn.prototype.has=function(e){return lo(this,e).has(e)},jn.prototype.set=function(e,t){var n=lo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Xn.prototype.add=Xn.prototype.push=function(e){return this.__data__.set(e,i),this},Xn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Wn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Wn){var r=n.__data__;if(!wn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new jn(r)}return n.set(e,t),this.size=n.size,this};var hr=Li(br),dr=Li(yr,!0);function pr(e,t){var n=!0;return hr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function fr(e,t,r){for(var i=-1,o=e.length;++i<o;){var s=e[i],a=t(s);if(null!=a&&(l===n?a===a&&!aa(a):r(a,l)))var l=a,c=s}return c}function mr(e,t){var n=[];return hr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function gr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=vo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?gr(a,t-1,n,r,i):Nt(i,a):r||(i[i.length]=a)}return i}var vr=Oi(),_r=Oi(!0);function br(e,t){return e&&vr(e,t,Ra)}function yr(e,t){return e&&_r(e,t,Ra)}function Tr(e,t){return Rt(t,(function(t){return qs(e[t])}))}function Er(e,t){for(var r=0,i=(t=_i(t,e)).length;null!=e&&r<i;)e=e[Do(t[r++])];return r&&r==i?e:n}function Sr(e,t,n){var r=t(e);return Gs(e)?r:Nt(r,n(e))}function wr(e){return null==e?e===n?"[object Undefined]":"[object Null]":et&&et in Me(e)?function(e){var t=Pe.call(e,et),r=e[et];try{e[et]=n;var i=!0}catch{}var o=Be.call(e);return i&&(t?e[et]=r:delete e[et]),o}(e):function(e){return Be.call(e)}(e)}function xr(e,t){return e>t}function Mr(e,t){return null!=e&&Pe.call(e,t)}function Cr(e,t){return null!=e&&t in Me(e)}function Ir(e,t,r){for(var i=r?Lt:At,o=e[0].length,s=e.length,a=s,l=oe(s),c=1/0,u=[];a--;){var h=e[a];a&&t&&(h=Ot(h,Jt(t))),c=_n(h.length,c),l[a]=!r&&(t||o>=120&&h.length>=120)?new Xn(a&&h):n}h=e[0];var d=-1,p=l[0];e:for(;++d<o&&u.length<c;){var f=h[d],m=t?t(f):f;if(f=r||0!==f?f:0,!(p?Qt(p,m):i(u,m,r))){for(a=s;--a;){var g=l[a];if(!(g?Qt(g,m):i(e[a],m,r)))continue e}p&&p.push(m),u.push(f)}}return u}function kr(e,t,r){var i=null==(e=Co(e,t=_i(t,e)))?e:e[Do(Ko(t))];return null==i?n:xt(i,e,r)}function Rr(e){return ea(e)&&wr(e)==g}function Ar(e,t,r,i,o){return e===t||(null==e||null==t||!ea(e)&&!ea(t)?e!==e&&t!==t:function(e,t,r,i,o,s){var a=Gs(e),l=Gs(t),c=a?v:fo(e),u=l?v:fo(t),h=(c=c==g?x:c)==x,d=(u=u==g?x:u)==x,p=c==u;if(p&&Xs(e)){if(!Xs(t))return!1;a=!0,h=!1}if(p&&!h)return s||(s=new Yn),a||la(e)?eo(e,t,r,i,o,s):function(e,t,n,r,i,o,s){switch(n){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case L:return!(e.byteLength!=t.byteLength||!o(new Ve(e),new Ve(t)));case _:case b:case w:return Fs(+e,+t);case y:return e.name==t.name&&e.message==t.message;case C:case k:return e==t+"";case S:var a=an;case I:var l=1&r;if(a||(a=un),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var u=eo(a(e),a(t),r,i,o,s);return s.delete(e),u;case R:if($n)return $n.call(e)==$n.call(t)}return!1}(e,t,c,r,i,o,s);if(!(1&r)){var f=h&&Pe.call(e,"__wrapped__"),m=d&&Pe.call(t,"__wrapped__");if(f||m){var T=f?e.value():e,E=m?t.value():t;return s||(s=new Yn),o(T,E,r,i,s)}}return!!p&&(s||(s=new Yn),function(e,t,r,i,o,s){var a=1&r,l=no(e),c=l.length,u=no(t),h=u.length;if(c!=h&&!a)return!1;for(var d=c;d--;){var p=l[d];if(!(a?p in t:Pe.call(t,p)))return!1}var f=s.get(e),m=s.get(t);if(f&&m)return f==t&&m==e;var g=!0;s.set(e,t),s.set(t,e);for(var v=a;++d<c;){var _=e[p=l[d]],b=t[p];if(i)var y=a?i(b,_,p,t,e,s):i(_,b,p,e,t,s);if(!(y===n?_===b||o(_,b,r,i,s):y)){g=!1;break}v||(v="constructor"==p)}if(g&&!v){var T=e.constructor,E=t.constructor;T!=E&&"constructor"in e&&"constructor"in t&&!("function"==typeof T&&T instanceof T&&"function"==typeof E&&E instanceof E)&&(g=!1)}return s.delete(e),s.delete(t),g}(e,t,r,i,o,s))}(e,t,r,i,Ar,o))}function Lr(e,t,r,i){var o=r.length,s=o,a=!i;if(null==e)return!s;for(e=Me(e);o--;){var l=r[o];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var c=(l=r[o])[0],u=e[c],h=l[1];if(a&&l[2]){if(u===n&&!(c in e))return!1}else{var d=new Yn;if(i)var p=i(u,h,c,e,t,d);if(!(p===n?Ar(h,u,3,i,d):p))return!1}}return!0}function Or(e){return!(!Qs(e)||function(e){return!!$e&&$e in e}(e))&&(qs(e)?ze:ge).test($o(e))}function Nr(e){return"function"==typeof e?e:null==e?nl:"object"==typeof e?Gs(e)?Ur(e[0],e[1]):Fr(e):hl(e)}function Pr(e){if(!So(e))return gn(e);var t=[];for(var n in Me(e))Pe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Dr(e){if(!Qs(e))return function(e){var t=[];if(null!=e)for(var n in Me(e))t.push(n);return t}(e);var t=So(e),n=[];for(var r in e)"constructor"==r&&(t||!Pe.call(e,r))||n.push(r);return n}function $r(e,t){return e<t}function Br(e,t){var n=-1,r=Ws(e)?oe(e.length):[];return hr(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}function Fr(e){var t=co(e);return 1==t.length&&t[0][2]?xo(t[0][0],t[0][1]):function(n){return n===e||Lr(n,e,t)}}function Ur(e,t){return yo(e)&&wo(t)?xo(Do(e),t):function(r){var i=xa(r,e);return i===n&&i===t?Ma(r,e):Ar(t,i,3)}}function zr(e,t,r,i,o){e!==t&&vr(t,(function(s,a){if(o||(o=new Yn),Qs(s))!function(e,t,r,i,o,s,a){var l=Io(e,r),c=Io(t,r),u=a.get(c);if(u)return void Qn(e,r,u);var h=s?s(l,c,r+"",e,t,a):n,d=h===n;if(d){var p=Gs(c),f=!p&&Xs(c),m=!p&&!f&&la(c);h=c,p||f||m?Gs(l)?h=l:js(l)?h=Ii(l):f?(d=!1,h=Ei(c,!0)):m?(d=!1,h=wi(c,!0)):h=[]:ra(c)||Hs(c)?(h=l,Hs(l)?h=ga(l):(!Qs(l)||qs(l))&&(h=go(c))):d=!1}d&&(a.set(c,h),o(h,c,i,s,a),a.delete(c)),Qn(e,r,h)}(e,t,a,r,zr,i,o);else{var l=i?i(Io(e,a),s,a+"",e,t,o):n;l===n&&(l=s),Qn(e,a,l)}}),Aa)}function Hr(e,t){var r=e.length;if(r)return _o(t+=t<0?r:0,r)?e[t]:n}function Gr(e,t,n){t=t.length?Ot(t,(function(e){return Gs(e)?function(t){return Er(t,1===e.length?e[0]:e)}:e})):[nl];var r=-1;return t=Ot(t,Jt(ao())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Br(e,(function(e,n,i){return{criteria:Ot(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var l=xi(i[r],o[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Vr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Er(e,s);n(a,s)&&Zr(o,_i(s,e),a)}return o}function Wr(e,t,n,r){var i=r?Ht:zt,o=-1,s=t.length,a=e;for(e===t&&(t=Ii(t)),n&&(a=Ot(e,Jt(n)));++o<s;)for(var l=0,c=t[o],u=n?n(c):c;(l=i(a,u,l,r))>-1;)a!==e&&Ke.call(a,l,1),Ke.call(e,l,1);return e}function jr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;_o(i)?Ke.call(e,i,1):ui(e,i)}}return e}function Xr(e,t){return e+mt(Tn()*(t-e+1))}function Yr(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=mt(t/2))&&(e+=e)}while(t);return n}function Kr(e,t){return Ao(Mo(e,t,nl),e+"")}function qr(e){return qn(Fa(e))}function Jr(e,t){var n=Fa(e);return No(n,sr(t,0,n.length))}function Zr(e,t,r,i){if(!Qs(e))return e;for(var o=-1,s=(t=_i(t,e)).length,a=s-1,l=e;null!=l&&++o<s;){var c=Do(t[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var h=l[c];(u=i?i(h,c,l):n)===n&&(u=Qs(h)?h:_o(t[o+1])?[]:{})}er(l,c,u),l=l[c]}return e}var Qr=kn?function(e,t){return kn.set(e,t),e}:nl,ei=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:Qa(t),writable:!0})}:nl;function ti(e){return No(Fa(e))}function ni(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=oe(i);++r<i;)o[r]=e[r+t];return o}function ri(e,t){var n;return hr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ii(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t===t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!aa(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return oi(e,t,nl,n)}function oi(e,t,r,i){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=r(t))!==t,l=null===t,c=aa(t),u=t===n;o<s;){var h=mt((o+s)/2),d=r(e[h]),p=d!==n,f=null===d,m=d===d,g=aa(d);if(a)var v=i||m;else v=u?m&&(i||p):l?m&&p&&(i||!f):c?m&&p&&!f&&(i||!g):!f&&!g&&(i?d<=t:d<t);v?o=h+1:s=h}return _n(s,4294967294)}function si(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Fs(a,l)){var l=a;o[i++]=0===s?0:s}}return o}function ai(e){return"number"==typeof e?e:aa(e)?p:+e}function li(e){if("string"==typeof e)return e;if(Gs(e))return Ot(e,li)+"";if(aa(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-h?"-0":t}function ci(e,t,n){var r=-1,i=At,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=Lt;else if(o>=200){var c=t?null:Yi(e);if(c)return un(c);s=!1,i=Qt,l=new Xn}else l=t?[]:a;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}function ui(e,t){return null==(e=Co(e,t=_i(t,e)))||delete e[Do(Ko(t))]}function hi(e,t,n,r){return Zr(e,t,n(Er(e,t)),r)}function di(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ni(e,r?0:o,r?o+1:i):ni(e,r?o+1:0,r?i:o)}function pi(e,t){var n=e;return n instanceof Gn&&(n=n.value()),Pt(t,(function(e,t){return t.func.apply(t.thisArg,Nt([e],t.args))}),n)}function fi(e,t,n){var r=e.length;if(r<2)return r?ci(e[0]):[];for(var i=-1,o=oe(r);++i<r;)for(var s=e[i],a=-1;++a<r;)a!=i&&(o[i]=ur(o[i]||s,e[a],t,n));return ci(gr(o,1),t,n)}function mi(e,t,r){for(var i=-1,o=e.length,s=t.length,a={};++i<o;){var l=i<s?t[i]:n;r(a,e[i],l)}return a}function gi(e){return js(e)?e:[]}function vi(e){return"function"==typeof e?e:nl}function _i(e,t){return Gs(e)?e:yo(e,t)?[e]:Po(va(e))}var bi=Kr;function yi(e,t,r){var i=e.length;return r=r===n?i:r,!t&&r>=i?e:ni(e,t,r)}var Ti=lt||function(e){return pt.clearTimeout(e)};function Ei(e,t){if(t)return e.slice();var n=e.length,r=We?We(n):new e.constructor(n);return e.copy(r),r}function Si(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function wi(e,t){var n=t?Si(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function xi(e,t){if(e!==t){var r=e!==n,i=null===e,o=e===e,s=aa(e),a=t!==n,l=null===t,c=t===t,u=aa(t);if(!l&&!u&&!s&&e>t||s&&a&&c&&!l&&!u||i&&a&&c||!r&&c||!o)return 1;if(!i&&!s&&!u&&e<t||u&&r&&o&&!i&&!s||l&&r&&o||!a&&o||!c)return-1}return 0}function Mi(e,t,n,r){for(var i=-1,o=e.length,s=n.length,a=-1,l=t.length,c=vn(o-s,0),u=oe(l+c),h=!r;++a<l;)u[a]=t[a];for(;++i<s;)(h||i<o)&&(u[n[i]]=e[i]);for(;c--;)u[a++]=e[i++];return u}function Ci(e,t,n,r){for(var i=-1,o=e.length,s=-1,a=n.length,l=-1,c=t.length,u=vn(o-a,0),h=oe(u+c),d=!r;++i<u;)h[i]=e[i];for(var p=i;++l<c;)h[p+l]=t[l];for(;++s<a;)(d||i<o)&&(h[p+n[s]]=e[i++]);return h}function Ii(e,t){var n=-1,r=e.length;for(t||(t=oe(r));++n<r;)t[n]=e[n];return t}function ki(e,t,r,i){var o=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=i?i(r[l],e[l],l,r,e):n;c===n&&(c=e[l]),o?ir(r,l,c):er(r,l,c)}return r}function Ri(e,t){return function(n,r){var i=Gs(n)?Mt:nr,o=t?t():{};return i(n,e,ao(r,2),o)}}function Ai(e){return Kr((function(t,r){var i=-1,o=r.length,s=o>1?r[o-1]:n,a=o>2?r[2]:n;for(s=e.length>3&&"function"==typeof s?(o--,s):n,a&&bo(r[0],r[1],a)&&(s=o<3?n:s,o=1),t=Me(t);++i<o;){var l=r[i];l&&e(t,l,i,s)}return t}))}function Li(e,t){return function(n,r){if(null==n)return n;if(!Ws(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Me(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Oi(e){return function(t,n,r){for(var i=-1,o=Me(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===n(o[l],l,o))break}return t}}function Ni(e){return function(t){var r=sn(t=va(t))?dn(t):n,i=r?r[0]:t.charAt(0),o=r?yi(r,1).join(""):t.slice(1);return i[e]()+o}}function Pi(e){return function(t){return Pt(qa(Ha(t).replace(Ze,"")),e,"")}}function Di(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Un(e.prototype),r=e.apply(n,t);return Qs(r)?r:n}}function $i(e){return function(t,r,i){var o=Me(t);if(!Ws(t)){var s=ao(r,3);t=Ra(t),r=function(e){return s(o[e],e,o)}}var a=e(t,r,i);return a>-1?o[s?t[a]:a]:n}}function Bi(e){return to((function(t){var i=t.length,o=i,s=Hn.prototype.thru;for(e&&t.reverse();o--;){var a=t[o];if("function"!=typeof a)throw new ke(r);if(s&&!l&&"wrapper"==oo(a))var l=new Hn([],!0)}for(o=l?o:i;++o<i;){var c=oo(a=t[o]),u="wrapper"==c?io(a):n;l=u&&To(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[oo(u[0])].apply(l,u[3]):1==a.length&&To(a)?l[c]():l.thru(a)}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&Gs(n))return l.plant(n).value();for(var r=0,o=i?t[r].apply(this,e):n;++r<i;)o=t[r].call(this,o);return o}}))}function Fi(e,t,r,i,o,s,a,l,u,h){var d=t&c,p=1&t,f=2&t,m=24&t,g=512&t,v=f?n:Di(e);return function c(){for(var _=arguments.length,b=oe(_),y=_;y--;)b[y]=arguments[y];if(m)var T=so(c),E=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,T);if(i&&(b=Mi(b,i,o,m)),s&&(b=Ci(b,s,a,m)),_-=E,m&&_<h){var S=cn(b,T);return ji(e,t,Fi,c.placeholder,r,b,S,l,u,h-_)}var w=p?r:this,x=f?w[e]:e;return _=b.length,l?b=function(e,t){for(var r=e.length,i=_n(t.length,r),o=Ii(e);i--;){var s=t[i];e[i]=_o(s,r)?o[s]:n}return e}(b,l):g&&_>1&&b.reverse(),d&&u<_&&(b.length=u),this&&this!==pt&&this instanceof c&&(x=v||Di(x)),x.apply(w,b)}}function Ui(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function zi(e,t){return function(r,i){var o;if(r===n&&i===n)return t;if(r!==n&&(o=r),i!==n){if(o===n)return i;"string"==typeof r||"string"==typeof i?(r=li(r),i=li(i)):(r=ai(r),i=ai(i)),o=e(r,i)}return o}}function Hi(e){return to((function(t){return t=Ot(t,Jt(ao())),Kr((function(n){var r=this;return e(t,(function(e){return xt(e,r,n)}))}))}))}function Gi(e,t){var r=(t=t===n?" ":li(t)).length;if(r<2)return r?Yr(t,e):t;var i=Yr(t,ft(e/hn(t)));return sn(t)?yi(dn(i),0,e).join(""):i.slice(0,e)}function Vi(e){return function(t,r,i){return i&&"number"!=typeof i&&bo(t,r,i)&&(r=i=n),t=da(t),r===n?(r=t,t=0):r=da(r),function(e,t,n,r){for(var i=-1,o=vn(ft((t-e)/(n||1)),0),s=oe(o);o--;)s[r?o:++i]=e,e+=n;return s}(t,r,i=i===n?t<r?1:-1:da(i),e)}}function Wi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ma(t),n=ma(n)),e(t,n)}}function ji(e,t,r,i,o,s,c,u,h,d){var p=8&t;t|=p?a:l,4&(t&=~(p?l:a))||(t&=-4);var f=[e,t,o,p?s:n,p?c:n,p?n:s,p?n:c,u,h,d],m=r.apply(n,f);return To(e)&&ko(m,f),m.placeholder=i,Lo(m,e,t)}function Xi(e){var t=xe[e];return function(e,n){if(e=ma(e),(n=null==n?0:_n(pa(n),292))&&Bt(e)){var r=(va(e)+"e").split("e");return+((r=(va(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Yi=Mn&&1/un(new Mn([,-0]))[1]==h?function(e){return new Mn(e)}:al;function Ki(e){return function(t){var n=fo(t);return n==S?an(t):n==I?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Ot(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function qi(e,t,i,h,d,p,f,m){var g=2&t;if(!g&&"function"!=typeof e)throw new ke(r);var v=h?h.length:0;if(v||(t&=-97,h=d=n),f=f===n?f:vn(pa(f),0),m=m===n?m:pa(m),v-=d?d.length:0,t&l){var _=h,b=d;h=d=n}var y=g?n:io(e),T=[e,t,i,h,d,_,b,p,f,m];if(y&&function(e,t){var n=e[1],r=t[1],i=n|r,s=i<131,a=r==c&&8==n||r==c&&n==u&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var h=e[3];e[3]=h?Mi(h,l,t[4]):l,e[4]=h?cn(e[3],o):t[4]}l=t[5],l&&(h=e[5],e[5]=h?Ci(h,l,t[6]):l,e[6]=h?cn(e[5],o):t[6]),l=t[7],l&&(e[7]=l),r&c&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(T,y),e=T[0],t=T[1],i=T[2],h=T[3],d=T[4],!(m=T[9]=T[9]===n?g?0:e.length:vn(T[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)E=8==t||t==s?function(e,t,r){var i=Di(e);return function o(){for(var s=arguments.length,a=oe(s),l=s,c=so(o);l--;)a[l]=arguments[l];var u=s<3&&a[0]!==c&&a[s-1]!==c?[]:cn(a,c);return(s-=u.length)<r?ji(e,t,Fi,o.placeholder,n,a,u,n,n,r-s):xt(this&&this!==pt&&this instanceof o?i:e,this,a)}}(e,t,m):t!=a&&33!=t||d.length?Fi.apply(n,T):function(e,t,n,r){var i=1&t,o=Di(e);return function t(){for(var s=-1,a=arguments.length,l=-1,c=r.length,u=oe(c+a),h=this&&this!==pt&&this instanceof t?o:e;++l<c;)u[l]=r[l];for(;a--;)u[l++]=arguments[++s];return xt(h,i?n:this,u)}}(e,t,i,h);else var E=function(e,t,n){var r=1&t,i=Di(e);return function t(){return(this&&this!==pt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,i);return Lo((y?Qr:ko)(E,T),e,t)}function Ji(e,t,r,i){return e===n||Fs(e,Le[r])&&!Pe.call(i,r)?t:e}function Zi(e,t,r,i,o,s){return Qs(e)&&Qs(t)&&(s.set(t,e),zr(e,t,n,Zi,s),s.delete(t)),e}function Qi(e){return ra(e)?n:e}function eo(e,t,r,i,o,s){var a=1&r,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var d=-1,p=!0,f=2&r?new Xn:n;for(s.set(e,t),s.set(t,e);++d<l;){var m=e[d],g=t[d];if(i)var v=a?i(g,m,d,t,e,s):i(m,g,d,e,t,s);if(v!==n){if(v)continue;p=!1;break}if(f){if(!$t(t,(function(e,t){if(!Qt(f,t)&&(m===e||o(m,e,r,i,s)))return f.push(t)}))){p=!1;break}}else if(m!==g&&!o(m,g,r,i,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function to(e){return Ao(Mo(e,n,Vo),e+"")}function no(e){return Sr(e,Ra,ho)}function ro(e){return Sr(e,Aa,po)}var io=kn?function(e){return kn.get(e)}:al;function oo(e){for(var t=e.name+"",n=Rn[t],r=Pe.call(Rn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function so(e){return(Pe.call(Fn,"placeholder")?Fn:e).placeholder}function ao(){var e=Fn.iteratee||rl;return e=e===rl?Nr:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function co(e){for(var t=Ra(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,wo(i)]}return t}function uo(e,t){var r=function(e,t){return null==e?n:e[t]}(e,t);return Or(r)?r:n}var ho=vt?function(e){return null==e?[]:(e=Me(e),Rt(vt(e),(function(t){return Ye.call(e,t)})))}:fl,po=vt?function(e){for(var t=[];e;)Nt(t,ho(e)),e=je(e);return t}:fl,fo=wr;function mo(e,t,n){for(var r=-1,i=(t=_i(t,e)).length,o=!1;++r<i;){var s=Do(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Zs(i)&&_o(s,i)&&(Gs(e)||Hs(e))}function go(e){return"function"!=typeof e.constructor||So(e)?{}:Un(je(e))}function vo(e){return Gs(e)||Hs(e)||!!(qe&&e&&e[qe])}function _o(e,t){var n=typeof e;return!!(t=null==t?d:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function bo(e,t,n){if(!Qs(n))return!1;var r=typeof t;return!!("number"==r?Ws(n)&&_o(t,n.length):"string"==r&&t in n)&&Fs(n[t],e)}function yo(e,t){if(Gs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!aa(e))||(ee.test(e)||!Q.test(e)||null!=t&&e in Me(t))}function To(e){var t=oo(e),n=Fn[t];if("function"!=typeof n||!(t in Gn.prototype))return!1;if(e===n)return!0;var r=io(n);return!!r&&e===r[0]}(Sn&&fo(new Sn(new ArrayBuffer(1)))!=O||wn&&fo(new wn)!=S||xn&&fo(xn.resolve())!=M||Mn&&fo(new Mn)!=I||Cn&&fo(new Cn)!=A)&&(fo=function(e){var t=wr(e),r=t==x?e.constructor:n,i=r?$o(r):"";if(i)switch(i){case An:return O;case Ln:return S;case On:return M;case Nn:return I;case Pn:return A}return t});var Eo=Oe?qs:ml;function So(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Le)}function wo(e){return e===e&&!Qs(e)}function xo(e,t){return function(r){return null!=r&&(r[e]===t&&(t!==n||e in Me(r)))}}function Mo(e,t,r){return t=vn(t===n?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=vn(n.length-t,0),s=oe(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=oe(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),xt(e,this,a)}}function Co(e,t){return t.length<2?e:Er(e,ni(t,0,-1))}function Io(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ko=Oo(Qr),Ro=dt||function(e,t){return pt.setTimeout(e,t)},Ao=Oo(ei);function Lo(e,t,n){var r=t+"";return Ao(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(se,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Ct(m,(function(n){var r="_."+n[0];t&n[1]&&!At(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(le):[]}(r),n)))}function Oo(e){var t=0,r=0;return function(){var i=bn(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function No(e,t){var r=-1,i=e.length,o=i-1;for(t=t===n?i:t;++r<t;){var s=Xr(r,o),a=e[s];e[s]=e[r],e[r]=a}return e.length=t,e}var Po=function(e){var t=Os(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,r,i){t.push(r?i.replace(he,"$1"):n||e)})),t}));function Do(e){if("string"==typeof e||aa(e))return e;var t=e+"";return"0"==t&&1/e==-h?"-0":t}function $o(e){if(null!=e){try{return Ne.call(e)}catch{}try{return e+""}catch{}}return""}function Bo(e){if(e instanceof Gn)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=Ii(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Fo=Kr((function(e,t){return js(e)?ur(e,gr(t,1,js,!0)):[]})),Uo=Kr((function(e,t){var r=Ko(t);return js(r)&&(r=n),js(e)?ur(e,gr(t,1,js,!0),ao(r,2)):[]})),zo=Kr((function(e,t){var r=Ko(t);return js(r)&&(r=n),js(e)?ur(e,gr(t,1,js,!0),n,r):[]}));function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=vn(r+i,0)),Ut(e,ao(t,3),i)}function Go(e,t,r){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return r!==n&&(o=pa(r),o=r<0?vn(i+o,0):_n(o,i-1)),Ut(e,ao(t,3),o,!0)}function Vo(e){return(null==e?0:e.length)?gr(e,1):[]}function Wo(e){return e&&e.length?e[0]:n}var jo=Kr((function(e){var t=Ot(e,gi);return t.length&&t[0]===e[0]?Ir(t):[]})),Xo=Kr((function(e){var t=Ko(e),r=Ot(e,gi);return t===Ko(r)?t=n:r.pop(),r.length&&r[0]===e[0]?Ir(r,ao(t,2)):[]})),Yo=Kr((function(e){var t=Ko(e),r=Ot(e,gi);return(t="function"==typeof t?t:n)&&r.pop(),r.length&&r[0]===e[0]?Ir(r,n,t):[]}));function Ko(e){var t=null==e?0:e.length;return t?e[t-1]:n}var qo=Kr(Jo);function Jo(e,t){return e&&e.length&&t&&t.length?Wr(e,t):e}var Zo=to((function(e,t){var n=null==e?0:e.length,r=or(e,t);return jr(e,Ot(t,(function(e){return _o(e,n)?+e:e})).sort(xi)),r}));function Qo(e){return null==e?e:En.call(e)}var es=Kr((function(e){return ci(gr(e,1,js,!0))})),ts=Kr((function(e){var t=Ko(e);return js(t)&&(t=n),ci(gr(e,1,js,!0),ao(t,2))})),ns=Kr((function(e){var t=Ko(e);return t="function"==typeof t?t:n,ci(gr(e,1,js,!0),n,t)}));function rs(e){if(!e||!e.length)return[];var t=0;return e=Rt(e,(function(e){if(js(e))return t=vn(e.length,t),!0})),Kt(t,(function(t){return Ot(e,Wt(t))}))}function is(e,t){if(!e||!e.length)return[];var r=rs(e);return null==t?r:Ot(r,(function(e){return xt(t,n,e)}))}var os=Kr((function(e,t){return js(e)?ur(e,t):[]})),ss=Kr((function(e){return fi(Rt(e,js))})),as=Kr((function(e){var t=Ko(e);return js(t)&&(t=n),fi(Rt(e,js),ao(t,2))})),ls=Kr((function(e){var t=Ko(e);return t="function"==typeof t?t:n,fi(Rt(e,js),n,t)})),cs=Kr(rs);var us=Kr((function(e){var t=e.length,r=t>1?e[t-1]:n;return r="function"==typeof r?(e.pop(),r):n,is(e,r)}));function hs(e){var t=Fn(e);return t.__chain__=!0,t}function ds(e,t){return t(e)}var ps=to((function(e){var t=e.length,r=t?e[0]:0,i=this.__wrapped__,o=function(t){return or(t,e)};return!(t>1||this.__actions__.length)&&i instanceof Gn&&_o(r)?((i=i.slice(r,+r+(t?1:0))).__actions__.push({func:ds,args:[o],thisArg:n}),new Hn(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(o)}));var fs=Ri((function(e,t,n){Pe.call(e,n)?++e[n]:ir(e,n,1)}));var ms=$i(Ho),gs=$i(Go);function vs(e,t){return(Gs(e)?Ct:hr)(e,ao(t,3))}function _s(e,t){return(Gs(e)?It:dr)(e,ao(t,3))}var bs=Ri((function(e,t,n){Pe.call(e,n)?e[n].push(t):ir(e,n,[t])}));var ys=Kr((function(e,t,n){var r=-1,i="function"==typeof t,o=Ws(e)?oe(e.length):[];return hr(e,(function(e){o[++r]=i?xt(t,e,n):kr(e,t,n)})),o})),Ts=Ri((function(e,t,n){ir(e,n,t)}));function Es(e,t){return(Gs(e)?Ot:Br)(e,ao(t,3))}var Ss=Ri((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ws=Kr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&bo(e,t[0],t[1])?t=[]:n>2&&bo(t[0],t[1],t[2])&&(t=[t[0]]),Gr(e,gr(t,1),[])})),xs=ht||function(){return pt.Date.now()};function Ms(e,t,r){return t=r?n:t,t=e&&null==t?e.length:t,qi(e,c,n,n,n,n,t)}function Cs(e,t){var i;if("function"!=typeof t)throw new ke(r);return e=pa(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=n),i}}var Is=Kr((function(e,t,n){var r=1;if(n.length){var i=cn(n,so(Is));r|=a}return qi(e,r,t,n,i)})),ks=Kr((function(e,t,n){var r=3;if(n.length){var i=cn(n,so(ks));r|=a}return qi(t,r,e,n,i)}));function Rs(e,t,i){var o,s,a,l,c,u,h=0,d=!1,p=!1,f=!0;if("function"!=typeof e)throw new ke(r);function m(t){var r=o,i=s;return o=s=n,h=t,l=e.apply(i,r)}function g(e){var r=e-u;return u===n||r>=t||r<0||p&&e-h>=a}function v(){var e=xs();if(g(e))return _(e);c=Ro(v,function(e){var n=t-(e-u);return p?_n(n,a-(e-h)):n}(e))}function _(e){return c=n,f&&o?m(e):(o=s=n,l)}function b(){var e=xs(),r=g(e);if(o=arguments,s=this,u=e,r){if(c===n)return function(e){return h=e,c=Ro(v,t),d?m(e):l}(u);if(p)return Ti(c),c=Ro(v,t),m(u)}return c===n&&(c=Ro(v,t)),l}return t=ma(t)||0,Qs(i)&&(d=!!i.leading,a=(p="maxWait"in i)?vn(ma(i.maxWait)||0,t):a,f="trailing"in i?!!i.trailing:f),b.cancel=function(){c!==n&&Ti(c),h=0,o=u=s=c=n},b.flush=function(){return c===n?l:_(xs())},b}var As=Kr((function(e,t){return cr(e,1,t)})),Ls=Kr((function(e,t,n){return cr(e,ma(t)||0,n)}));function Os(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ke(r);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Os.Cache||jn),n}function Ns(e){if("function"!=typeof e)throw new ke(r);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Os.Cache=jn;var Ps=bi((function(e,t){var n=(t=1==t.length&&Gs(t[0])?Ot(t[0],Jt(ao())):Ot(gr(t,1),Jt(ao()))).length;return Kr((function(r){for(var i=-1,o=_n(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return xt(e,this,r)}))})),Ds=Kr((function(e,t){var r=cn(t,so(Ds));return qi(e,a,n,t,r)})),$s=Kr((function(e,t){var r=cn(t,so($s));return qi(e,l,n,t,r)})),Bs=to((function(e,t){return qi(e,u,n,n,n,t)}));function Fs(e,t){return e===t||e!==e&&t!==t}var Us=Wi(xr),zs=Wi((function(e,t){return e>=t})),Hs=Rr(function(){return arguments}())?Rr:function(e){return ea(e)&&Pe.call(e,"callee")&&!Ye.call(e,"callee")},Gs=oe.isArray,Vs=bt?Jt(bt):function(e){return ea(e)&&wr(e)==L};function Ws(e){return null!=e&&Zs(e.length)&&!qs(e)}function js(e){return ea(e)&&Ws(e)}var Xs=_t||ml,Ys=yt?Jt(yt):function(e){return ea(e)&&wr(e)==b};function Ks(e){if(!ea(e))return!1;var t=wr(e);return t==y||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ra(e)}function qs(e){if(!Qs(e))return!1;var t=wr(e);return t==T||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Js(e){return"number"==typeof e&&e==pa(e)}function Zs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function Qs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ea(e){return null!=e&&"object"==typeof e}var ta=Tt?Jt(Tt):function(e){return ea(e)&&fo(e)==S};function na(e){return"number"==typeof e||ea(e)&&wr(e)==w}function ra(e){if(!ea(e)||wr(e)!=x)return!1;var t=je(e);if(null===t)return!0;var n=Pe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ne.call(n)==Fe}var ia=Et?Jt(Et):function(e){return ea(e)&&wr(e)==C};var oa=St?Jt(St):function(e){return ea(e)&&fo(e)==I};function sa(e){return"string"==typeof e||!Gs(e)&&ea(e)&&wr(e)==k}function aa(e){return"symbol"==typeof e||ea(e)&&wr(e)==R}var la=wt?Jt(wt):function(e){return ea(e)&&Zs(e.length)&&!!st[wr(e)]};var ca=Wi($r),ua=Wi((function(e,t){return e<=t}));function ha(e){if(!e)return[];if(Ws(e))return sa(e)?dn(e):Ii(e);if(Je&&e[Je])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Je]());var t=fo(e);return(t==S?an:t==I?un:Fa)(e)}function da(e){return e?(e=ma(e))===h||e===-h?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}function pa(e){var t=da(e),n=t%1;return t===t?n?t-n:t:0}function fa(e){return e?sr(pa(e),0,f):0}function ma(e){if("number"==typeof e)return e;if(aa(e))return p;if(Qs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Qs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=qt(e);var n=me.test(e);return n||ve.test(e)?ut(e.slice(2),n?2:8):fe.test(e)?p:+e}function ga(e){return ki(e,Aa(e))}function va(e){return null==e?"":li(e)}var _a=Ai((function(e,t){if(So(t)||Ws(t))ki(t,Ra(t),e);else for(var n in t)Pe.call(t,n)&&er(e,n,t[n])})),ba=Ai((function(e,t){ki(t,Aa(t),e)})),ya=Ai((function(e,t,n,r){ki(t,Aa(t),e,r)})),Ta=Ai((function(e,t,n,r){ki(t,Ra(t),e,r)})),Ea=to(or);var Sa=Kr((function(e,t){e=Me(e);var r=-1,i=t.length,o=i>2?t[2]:n;for(o&&bo(t[0],t[1],o)&&(i=1);++r<i;)for(var s=t[r],a=Aa(s),l=-1,c=a.length;++l<c;){var u=a[l],h=e[u];(h===n||Fs(h,Le[u])&&!Pe.call(e,u))&&(e[u]=s[u])}return e})),wa=Kr((function(e){return e.push(n,Zi),xt(Oa,n,e)}));function xa(e,t,r){var i=null==e?n:Er(e,t);return i===n?r:i}function Ma(e,t){return null!=e&&mo(e,t,Cr)}var Ca=Ui((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),e[t]=n}),Qa(nl)),Ia=Ui((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),Pe.call(e,t)?e[t].push(n):e[t]=[n]}),ao),ka=Kr(kr);function Ra(e){return Ws(e)?Kn(e):Pr(e)}function Aa(e){return Ws(e)?Kn(e,!0):Dr(e)}var La=Ai((function(e,t,n){zr(e,t,n)})),Oa=Ai((function(e,t,n,r){zr(e,t,n,r)})),Na=to((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ot(t,(function(t){return t=_i(t,e),r||(r=t.length>1),t})),ki(e,ro(e),n),r&&(n=ar(n,7,Qi));for(var i=t.length;i--;)ui(n,t[i]);return n}));var Pa=to((function(e,t){return null==e?{}:function(e,t){return Vr(e,t,(function(t,n){return Ma(e,n)}))}(e,t)}));function Da(e,t){if(null==e)return{};var n=Ot(ro(e),(function(e){return[e]}));return t=ao(t),Vr(e,n,(function(e,n){return t(e,n[0])}))}var $a=Ki(Ra),Ba=Ki(Aa);function Fa(e){return null==e?[]:Zt(e,Ra(e))}var Ua=Pi((function(e,t,n){return t=t.toLowerCase(),e+(n?za(t):t)}));function za(e){return Ka(va(e).toLowerCase())}function Ha(e){return(e=va(e))&&e.replace(be,nn).replace(Qe,"")}var Ga=Pi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Va=Pi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Wa=Ni("toLowerCase");var ja=Pi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Xa=Pi((function(e,t,n){return e+(n?" ":"")+Ka(t)}));var Ya=Pi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Ni("toUpperCase");function qa(e,t,r){return e=va(e),(t=r?n:t)===n?function(e){return rt.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Ja=Kr((function(e,t){try{return xt(e,n,t)}catch(r){return Ks(r)?r:new Se(r)}})),Za=to((function(e,t){return Ct(t,(function(t){t=Do(t),ir(e,t,Is(e[t],e))})),e}));function Qa(e){return function(){return e}}var el=Bi(),tl=Bi(!0);function nl(e){return e}function rl(e){return Nr("function"==typeof e?e:ar(e,1))}var il=Kr((function(e,t){return function(n){return kr(n,e,t)}})),ol=Kr((function(e,t){return function(n){return kr(e,n,t)}}));function sl(e,t,n){var r=Ra(t),i=Tr(t,r);null==n&&(!Qs(t)||!i.length&&r.length)&&(n=t,t=e,e=this,i=Tr(t,Ra(t)));var o=!(Qs(n)&&"chain"in n)||!!n.chain,s=qs(e);return Ct(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ii(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Nt([this.value()],arguments))})})),e}function al(){}var ll=Hi(Ot),cl=Hi(kt),ul=Hi($t);function hl(e){return yo(e)?Wt(Do(e)):function(e){return function(t){return Er(t,e)}}(e)}var dl=Vi(),pl=Vi(!0);function fl(){return[]}function ml(){return!1}var gl=zi((function(e,t){return e+t}),0),vl=Xi("ceil"),_l=zi((function(e,t){return e/t}),1),bl=Xi("floor");var yl=zi((function(e,t){return e*t}),1),Tl=Xi("round"),El=zi((function(e,t){return e-t}),0);return Fn.after=function(e,t){if("function"!=typeof t)throw new ke(r);return e=pa(e),function(){if(--e<1)return t.apply(this,arguments)}},Fn.ary=Ms,Fn.assign=_a,Fn.assignIn=ba,Fn.assignInWith=ya,Fn.assignWith=Ta,Fn.at=Ea,Fn.before=Cs,Fn.bind=Is,Fn.bindAll=Za,Fn.bindKey=ks,Fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Gs(e)?e:[e]},Fn.chain=hs,Fn.chunk=function(e,t,r){t=(r?bo(e,t,r):t===n)?1:vn(pa(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,a=oe(ft(i/t));o<i;)a[s++]=ni(e,o,o+=t);return a},Fn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=oe(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Nt(Gs(n)?Ii(n):[n],gr(t,1))},Fn.cond=function(e){var t=null==e?0:e.length,n=ao();return e=t?Ot(e,(function(e){if("function"!=typeof e[1])throw new ke(r);return[n(e[0]),e[1]]})):[],Kr((function(n){for(var r=-1;++r<t;){var i=e[r];if(xt(i[0],this,n))return xt(i[1],this,n)}}))},Fn.conforms=function(e){return function(e){var t=Ra(e);return function(n){return lr(n,e,t)}}(ar(e,1))},Fn.constant=Qa,Fn.countBy=fs,Fn.create=function(e,t){var n=Un(e);return null==t?n:rr(n,t)},Fn.curry=function e(t,r,i){var o=qi(t,8,n,n,n,n,n,r=i?n:r);return o.placeholder=e.placeholder,o},Fn.curryRight=function e(t,r,i){var o=qi(t,s,n,n,n,n,n,r=i?n:r);return o.placeholder=e.placeholder,o},Fn.debounce=Rs,Fn.defaults=Sa,Fn.defaultsDeep=wa,Fn.defer=As,Fn.delay=Ls,Fn.difference=Fo,Fn.differenceBy=Uo,Fn.differenceWith=zo,Fn.drop=function(e,t,r){var i=null==e?0:e.length;return i?ni(e,(t=r||t===n?1:pa(t))<0?0:t,i):[]},Fn.dropRight=function(e,t,r){var i=null==e?0:e.length;return i?ni(e,0,(t=i-(t=r||t===n?1:pa(t)))<0?0:t):[]},Fn.dropRightWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!0,!0):[]},Fn.dropWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!0):[]},Fn.fill=function(e,t,r,i){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&bo(e,t,r)&&(r=0,i=o),function(e,t,r,i){var o=e.length;for((r=pa(r))<0&&(r=-r>o?0:o+r),(i=i===n||i>o?o:pa(i))<0&&(i+=o),i=r>i?0:fa(i);r<i;)e[r++]=t;return e}(e,t,r,i)):[]},Fn.filter=function(e,t){return(Gs(e)?Rt:mr)(e,ao(t,3))},Fn.flatMap=function(e,t){return gr(Es(e,t),1)},Fn.flatMapDeep=function(e,t){return gr(Es(e,t),h)},Fn.flatMapDepth=function(e,t,r){return r=r===n?1:pa(r),gr(Es(e,t),r)},Fn.flatten=Vo,Fn.flattenDeep=function(e){return(null==e?0:e.length)?gr(e,h):[]},Fn.flattenDepth=function(e,t){return(null==e?0:e.length)?gr(e,t=t===n?1:pa(t)):[]},Fn.flip=function(e){return qi(e,512)},Fn.flow=el,Fn.flowRight=tl,Fn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Fn.functions=function(e){return null==e?[]:Tr(e,Ra(e))},Fn.functionsIn=function(e){return null==e?[]:Tr(e,Aa(e))},Fn.groupBy=bs,Fn.initial=function(e){return(null==e?0:e.length)?ni(e,0,-1):[]},Fn.intersection=jo,Fn.intersectionBy=Xo,Fn.intersectionWith=Yo,Fn.invert=Ca,Fn.invertBy=Ia,Fn.invokeMap=ys,Fn.iteratee=rl,Fn.keyBy=Ts,Fn.keys=Ra,Fn.keysIn=Aa,Fn.map=Es,Fn.mapKeys=function(e,t){var n={};return t=ao(t,3),br(e,(function(e,r,i){ir(n,t(e,r,i),e)})),n},Fn.mapValues=function(e,t){var n={};return t=ao(t,3),br(e,(function(e,r,i){ir(n,r,t(e,r,i))})),n},Fn.matches=function(e){return Fr(ar(e,1))},Fn.matchesProperty=function(e,t){return Ur(e,ar(t,1))},Fn.memoize=Os,Fn.merge=La,Fn.mergeWith=Oa,Fn.method=il,Fn.methodOf=ol,Fn.mixin=sl,Fn.negate=Ns,Fn.nthArg=function(e){return e=pa(e),Kr((function(t){return Hr(t,e)}))},Fn.omit=Na,Fn.omitBy=function(e,t){return Da(e,Ns(ao(t)))},Fn.once=function(e){return Cs(2,e)},Fn.orderBy=function(e,t,r,i){return null==e?[]:(Gs(t)||(t=null==t?[]:[t]),Gs(r=i?n:r)||(r=null==r?[]:[r]),Gr(e,t,r))},Fn.over=ll,Fn.overArgs=Ps,Fn.overEvery=cl,Fn.overSome=ul,Fn.partial=Ds,Fn.partialRight=$s,Fn.partition=Ss,Fn.pick=Pa,Fn.pickBy=Da,Fn.property=hl,Fn.propertyOf=function(e){return function(t){return null==e?n:Er(e,t)}},Fn.pull=qo,Fn.pullAll=Jo,Fn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Wr(e,t,ao(n,2)):e},Fn.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Wr(e,t,n,r):e},Fn.pullAt=Zo,Fn.range=dl,Fn.rangeRight=pl,Fn.rearg=Bs,Fn.reject=function(e,t){return(Gs(e)?Rt:mr)(e,Ns(ao(t,3)))},Fn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=ao(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return jr(e,i),n},Fn.rest=function(e,t){if("function"!=typeof e)throw new ke(r);return Kr(e,t=t===n?t:pa(t))},Fn.reverse=Qo,Fn.sampleSize=function(e,t,r){return t=(r?bo(e,t,r):t===n)?1:pa(t),(Gs(e)?Jn:Jr)(e,t)},Fn.set=function(e,t,n){return null==e?e:Zr(e,t,n)},Fn.setWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:Zr(e,t,r,i)},Fn.shuffle=function(e){return(Gs(e)?Zn:ti)(e)},Fn.slice=function(e,t,r){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&bo(e,t,r)?(t=0,r=i):(t=null==t?0:pa(t),r=r===n?i:pa(r)),ni(e,t,r)):[]},Fn.sortBy=ws,Fn.sortedUniq=function(e){return e&&e.length?si(e):[]},Fn.sortedUniqBy=function(e,t){return e&&e.length?si(e,ao(t,2)):[]},Fn.split=function(e,t,r){return r&&"number"!=typeof r&&bo(e,t,r)&&(t=r=n),(r=r===n?f:r>>>0)?(e=va(e))&&("string"==typeof t||null!=t&&!ia(t))&&(!(t=li(t))&&sn(e))?yi(dn(e),0,r):e.split(t,r):[]},Fn.spread=function(e,t){if("function"!=typeof e)throw new ke(r);return t=null==t?0:vn(pa(t),0),Kr((function(n){var r=n[t],i=yi(n,0,t);return r&&Nt(i,r),xt(e,this,i)}))},Fn.tail=function(e){var t=null==e?0:e.length;return t?ni(e,1,t):[]},Fn.take=function(e,t,r){return e&&e.length?ni(e,0,(t=r||t===n?1:pa(t))<0?0:t):[]},Fn.takeRight=function(e,t,r){var i=null==e?0:e.length;return i?ni(e,(t=i-(t=r||t===n?1:pa(t)))<0?0:t,i):[]},Fn.takeRightWhile=function(e,t){return e&&e.length?di(e,ao(t,3),!1,!0):[]},Fn.takeWhile=function(e,t){return e&&e.length?di(e,ao(t,3)):[]},Fn.tap=function(e,t){return t(e),e},Fn.throttle=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new ke(r);return Qs(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Rs(e,t,{leading:i,maxWait:t,trailing:o})},Fn.thru=ds,Fn.toArray=ha,Fn.toPairs=$a,Fn.toPairsIn=Ba,Fn.toPath=function(e){return Gs(e)?Ot(e,Do):aa(e)?[e]:Ii(Po(va(e)))},Fn.toPlainObject=ga,Fn.transform=function(e,t,n){var r=Gs(e),i=r||Xs(e)||la(e);if(t=ao(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Qs(e)&&qs(o)?Un(je(e)):{}}return(i?Ct:br)(e,(function(e,r,i){return t(n,e,r,i)})),n},Fn.unary=function(e){return Ms(e,1)},Fn.union=es,Fn.unionBy=ts,Fn.unionWith=ns,Fn.uniq=function(e){return e&&e.length?ci(e):[]},Fn.uniqBy=function(e,t){return e&&e.length?ci(e,ao(t,2)):[]},Fn.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?ci(e,n,t):[]},Fn.unset=function(e,t){return null==e||ui(e,t)},Fn.unzip=rs,Fn.unzipWith=is,Fn.update=function(e,t,n){return null==e?e:hi(e,t,vi(n))},Fn.updateWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:hi(e,t,vi(r),i)},Fn.values=Fa,Fn.valuesIn=function(e){return null==e?[]:Zt(e,Aa(e))},Fn.without=os,Fn.words=qa,Fn.wrap=function(e,t){return Ds(vi(t),e)},Fn.xor=ss,Fn.xorBy=as,Fn.xorWith=ls,Fn.zip=cs,Fn.zipObject=function(e,t){return mi(e||[],t||[],er)},Fn.zipObjectDeep=function(e,t){return mi(e||[],t||[],Zr)},Fn.zipWith=us,Fn.entries=$a,Fn.entriesIn=Ba,Fn.extend=ba,Fn.extendWith=ya,sl(Fn,Fn),Fn.add=gl,Fn.attempt=Ja,Fn.camelCase=Ua,Fn.capitalize=za,Fn.ceil=vl,Fn.clamp=function(e,t,r){return r===n&&(r=t,t=n),r!==n&&(r=(r=ma(r))===r?r:0),t!==n&&(t=(t=ma(t))===t?t:0),sr(ma(e),t,r)},Fn.clone=function(e){return ar(e,4)},Fn.cloneDeep=function(e){return ar(e,5)},Fn.cloneDeepWith=function(e,t){return ar(e,5,t="function"==typeof t?t:n)},Fn.cloneWith=function(e,t){return ar(e,4,t="function"==typeof t?t:n)},Fn.conformsTo=function(e,t){return null==t||lr(e,t,Ra(t))},Fn.deburr=Ha,Fn.defaultTo=function(e,t){return null==e||e!==e?t:e},Fn.divide=_l,Fn.endsWith=function(e,t,r){e=va(e),t=li(t);var i=e.length,o=r=r===n?i:sr(pa(r),0,i);return(r-=t.length)>=0&&e.slice(r,o)==t},Fn.eq=Fs,Fn.escape=function(e){return(e=va(e))&&K.test(e)?e.replace(X,rn):e},Fn.escapeRegExp=function(e){return(e=va(e))&&re.test(e)?e.replace(ne,"\\$&"):e},Fn.every=function(e,t,r){var i=Gs(e)?kt:pr;return r&&bo(e,t,r)&&(t=n),i(e,ao(t,3))},Fn.find=ms,Fn.findIndex=Ho,Fn.findKey=function(e,t){return Ft(e,ao(t,3),br)},Fn.findLast=gs,Fn.findLastIndex=Go,Fn.findLastKey=function(e,t){return Ft(e,ao(t,3),yr)},Fn.floor=bl,Fn.forEach=vs,Fn.forEachRight=_s,Fn.forIn=function(e,t){return null==e?e:vr(e,ao(t,3),Aa)},Fn.forInRight=function(e,t){return null==e?e:_r(e,ao(t,3),Aa)},Fn.forOwn=function(e,t){return e&&br(e,ao(t,3))},Fn.forOwnRight=function(e,t){return e&&yr(e,ao(t,3))},Fn.get=xa,Fn.gt=Us,Fn.gte=zs,Fn.has=function(e,t){return null!=e&&mo(e,t,Mr)},Fn.hasIn=Ma,Fn.head=Wo,Fn.identity=nl,Fn.includes=function(e,t,n,r){e=Ws(e)?e:Fa(e),n=n&&!r?pa(n):0;var i=e.length;return n<0&&(n=vn(i+n,0)),sa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&zt(e,t,n)>-1},Fn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=vn(r+i,0)),zt(e,t,i)},Fn.inRange=function(e,t,r){return t=da(t),r===n?(r=t,t=0):r=da(r),function(e,t,n){return e>=_n(t,n)&&e<vn(t,n)}(e=ma(e),t,r)},Fn.invoke=ka,Fn.isArguments=Hs,Fn.isArray=Gs,Fn.isArrayBuffer=Vs,Fn.isArrayLike=Ws,Fn.isArrayLikeObject=js,Fn.isBoolean=function(e){return!0===e||!1===e||ea(e)&&wr(e)==_},Fn.isBuffer=Xs,Fn.isDate=Ys,Fn.isElement=function(e){return ea(e)&&1===e.nodeType&&!ra(e)},Fn.isEmpty=function(e){if(null==e)return!0;if(Ws(e)&&(Gs(e)||"string"==typeof e||"function"==typeof e.splice||Xs(e)||la(e)||Hs(e)))return!e.length;var t=fo(e);if(t==S||t==I)return!e.size;if(So(e))return!Pr(e).length;for(var n in e)if(Pe.call(e,n))return!1;return!0},Fn.isEqual=function(e,t){return Ar(e,t)},Fn.isEqualWith=function(e,t,r){var i=(r="function"==typeof r?r:n)?r(e,t):n;return i===n?Ar(e,t,n,r):!!i},Fn.isError=Ks,Fn.isFinite=function(e){return"number"==typeof e&&Bt(e)},Fn.isFunction=qs,Fn.isInteger=Js,Fn.isLength=Zs,Fn.isMap=ta,Fn.isMatch=function(e,t){return e===t||Lr(e,t,co(t))},Fn.isMatchWith=function(e,t,r){return r="function"==typeof r?r:n,Lr(e,t,co(t),r)},Fn.isNaN=function(e){return na(e)&&e!=+e},Fn.isNative=function(e){if(Eo(e))throw new Se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Or(e)},Fn.isNil=function(e){return null==e},Fn.isNull=function(e){return null===e},Fn.isNumber=na,Fn.isObject=Qs,Fn.isObjectLike=ea,Fn.isPlainObject=ra,Fn.isRegExp=ia,Fn.isSafeInteger=function(e){return Js(e)&&e>=-d&&e<=d},Fn.isSet=oa,Fn.isString=sa,Fn.isSymbol=aa,Fn.isTypedArray=la,Fn.isUndefined=function(e){return e===n},Fn.isWeakMap=function(e){return ea(e)&&fo(e)==A},Fn.isWeakSet=function(e){return ea(e)&&"[object WeakSet]"==wr(e)},Fn.join=function(e,t){return null==e?"":jt.call(e,t)},Fn.kebabCase=Ga,Fn.last=Ko,Fn.lastIndexOf=function(e,t,r){var i=null==e?0:e.length;if(!i)return-1;var o=i;return r!==n&&(o=(o=pa(r))<0?vn(i+o,0):_n(o,i-1)),t===t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ut(e,Gt,o,!0)},Fn.lowerCase=Va,Fn.lowerFirst=Wa,Fn.lt=ca,Fn.lte=ua,Fn.max=function(e){return e&&e.length?fr(e,nl,xr):n},Fn.maxBy=function(e,t){return e&&e.length?fr(e,ao(t,2),xr):n},Fn.mean=function(e){return Vt(e,nl)},Fn.meanBy=function(e,t){return Vt(e,ao(t,2))},Fn.min=function(e){return e&&e.length?fr(e,nl,$r):n},Fn.minBy=function(e,t){return e&&e.length?fr(e,ao(t,2),$r):n},Fn.stubArray=fl,Fn.stubFalse=ml,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=yl,Fn.nth=function(e,t){return e&&e.length?Hr(e,pa(t)):n},Fn.noConflict=function(){return pt._===this&&(pt._=Ue),this},Fn.noop=al,Fn.now=xs,Fn.pad=function(e,t,n){e=va(e);var r=(t=pa(t))?hn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Gi(mt(i),n)+e+Gi(ft(i),n)},Fn.padEnd=function(e,t,n){e=va(e);var r=(t=pa(t))?hn(e):0;return t&&r<t?e+Gi(t-r,n):e},Fn.padStart=function(e,t,n){e=va(e);var r=(t=pa(t))?hn(e):0;return t&&r<t?Gi(t-r,n)+e:e},Fn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(va(e).replace(ie,""),t||0)},Fn.random=function(e,t,r){if(r&&"boolean"!=typeof r&&bo(e,t,r)&&(t=r=n),r===n&&("boolean"==typeof t?(r=t,t=n):"boolean"==typeof e&&(r=e,e=n)),e===n&&t===n?(e=0,t=1):(e=da(e),t===n?(t=e,e=0):t=da(t)),e>t){var i=e;e=t,t=i}if(r||e%1||t%1){var o=Tn();return _n(e+o*(t-e+ct("1e-"+((o+"").length-1))),t)}return Xr(e,t)},Fn.reduce=function(e,t,n){var r=Gs(e)?Pt:Xt,i=arguments.length<3;return r(e,ao(t,4),n,i,hr)},Fn.reduceRight=function(e,t,n){var r=Gs(e)?Dt:Xt,i=arguments.length<3;return r(e,ao(t,4),n,i,dr)},Fn.repeat=function(e,t,r){return t=(r?bo(e,t,r):t===n)?1:pa(t),Yr(va(e),t)},Fn.replace=function(){var e=arguments,t=va(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Fn.result=function(e,t,r){var i=-1,o=(t=_i(t,e)).length;for(o||(o=1,e=n);++i<o;){var s=null==e?n:e[Do(t[i])];s===n&&(i=o,s=r),e=qs(s)?s.call(e):s}return e},Fn.round=Tl,Fn.runInContext=e,Fn.sample=function(e){return(Gs(e)?qn:qr)(e)},Fn.size=function(e){if(null==e)return 0;if(Ws(e))return sa(e)?hn(e):e.length;var t=fo(e);return t==S||t==I?e.size:Pr(e).length},Fn.snakeCase=ja,Fn.some=function(e,t,r){var i=Gs(e)?$t:ri;return r&&bo(e,t,r)&&(t=n),i(e,ao(t,3))},Fn.sortedIndex=function(e,t){return ii(e,t)},Fn.sortedIndexBy=function(e,t,n){return oi(e,t,ao(n,2))},Fn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ii(e,t);if(r<n&&Fs(e[r],t))return r}return-1},Fn.sortedLastIndex=function(e,t){return ii(e,t,!0)},Fn.sortedLastIndexBy=function(e,t,n){return oi(e,t,ao(n,2),!0)},Fn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=ii(e,t,!0)-1;if(Fs(e[n],t))return n}return-1},Fn.startCase=Xa,Fn.startsWith=function(e,t,n){return e=va(e),n=null==n?0:sr(pa(n),0,e.length),t=li(t),e.slice(n,n+t.length)==t},Fn.subtract=El,Fn.sum=function(e){return e&&e.length?Yt(e,nl):0},Fn.sumBy=function(e,t){return e&&e.length?Yt(e,ao(t,2)):0},Fn.template=function(e,t,r){var i=Fn.templateSettings;r&&bo(e,t,r)&&(t=n),e=va(e),t=ya({},t,i,Ji);var o,s,a=ya({},t.imports,i.imports,Ji),l=Ra(a),c=Zt(a,l),u=0,h=t.interpolate||ye,d="__p += '",p=Ce((t.escape||ye).source+"|"+h.source+"|"+(h===Z?de:ye).source+"|"+(t.evaluate||ye).source+"|$","g"),f="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ot+"]")+"\n";e.replace(p,(function(t,n,r,i,a,l){return r||(r=i),d+=e.slice(u,l).replace(Te,on),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var m=Pe.call(t,"variable")&&t.variable;if(m){if(ue.test(m))throw new Se("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(G,""):d).replace(V,"$1").replace(W,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Ja((function(){return we(l,f+"return "+d).apply(n,c)}));if(g.source=d,Ks(g))throw g;return g},Fn.times=function(e,t){if((e=pa(e))<1||e>d)return[];var n=f,r=_n(e,f);t=ao(t),e-=f;for(var i=Kt(r,t);++n<e;)t(n);return i},Fn.toFinite=da,Fn.toInteger=pa,Fn.toLength=fa,Fn.toLower=function(e){return va(e).toLowerCase()},Fn.toNumber=ma,Fn.toSafeInteger=function(e){return e?sr(pa(e),-d,d):0===e?e:0},Fn.toString=va,Fn.toUpper=function(e){return va(e).toUpperCase()},Fn.trim=function(e,t,r){if((e=va(e))&&(r||t===n))return qt(e);if(!e||!(t=li(t)))return e;var i=dn(e),o=dn(t);return yi(i,en(i,o),tn(i,o)+1).join("")},Fn.trimEnd=function(e,t,r){if((e=va(e))&&(r||t===n))return e.slice(0,pn(e)+1);if(!e||!(t=li(t)))return e;var i=dn(e);return yi(i,0,tn(i,dn(t))+1).join("")},Fn.trimStart=function(e,t,r){if((e=va(e))&&(r||t===n))return e.replace(ie,"");if(!e||!(t=li(t)))return e;var i=dn(e);return yi(i,en(i,dn(t))).join("")},Fn.truncate=function(e,t){var r=30,i="...";if(Qs(t)){var o="separator"in t?t.separator:o;r="length"in t?pa(t.length):r,i="omission"in t?li(t.omission):i}var s=(e=va(e)).length;if(sn(e)){var a=dn(e);s=a.length}if(r>=s)return e;var l=r-hn(i);if(l<1)return i;var c=a?yi(a,0,l).join(""):e.slice(0,l);if(o===n)return c+i;if(a&&(l+=c.length-l),ia(o)){if(e.slice(l).search(o)){var u,h=c;for(o.global||(o=Ce(o.source,va(pe.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var d=u.index;c=c.slice(0,d===n?l:d)}}else if(e.indexOf(li(o),l)!=l){var p=c.lastIndexOf(o);p>-1&&(c=c.slice(0,p))}return c+i},Fn.unescape=function(e){return(e=va(e))&&Y.test(e)?e.replace(j,fn):e},Fn.uniqueId=function(e){var t=++De;return va(e)+t},Fn.upperCase=Ya,Fn.upperFirst=Ka,Fn.each=vs,Fn.eachRight=_s,Fn.first=Wo,sl(Fn,function(){var e={};return br(Fn,(function(t,n){Pe.call(Fn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Fn.VERSION="4.17.21",Ct(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Fn[e].placeholder=Fn})),Ct(["drop","take"],(function(e,t){Gn.prototype[e]=function(r){r=r===n?1:vn(pa(r),0);var i=this.__filtered__&&!t?new Gn(this):this.clone();return i.__filtered__?i.__takeCount__=_n(r,i.__takeCount__):i.__views__.push({size:_n(r,f),type:e+(i.__dir__<0?"Right":"")}),i},Gn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ct(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Gn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ao(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Ct(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Gn.prototype[e]=function(){return this[n](1).value()[0]}})),Ct(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Gn.prototype[e]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(nl)},Gn.prototype.find=function(e){return this.filter(e).head()},Gn.prototype.findLast=function(e){return this.reverse().find(e)},Gn.prototype.invokeMap=Kr((function(e,t){return"function"==typeof e?new Gn(this):this.map((function(n){return kr(n,e,t)}))})),Gn.prototype.reject=function(e){return this.filter(Ns(ao(e)))},Gn.prototype.slice=function(e,t){e=pa(e);var r=this;return r.__filtered__&&(e>0||t<0)?new Gn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==n&&(r=(t=pa(t))<0?r.dropRight(-t):r.take(t-e)),r)},Gn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gn.prototype.toArray=function(){return this.take(f)},br(Gn.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=Fn[i?"take"+("last"==t?"Right":""):t],s=i||/^find/.test(t);!o||(Fn.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,l=t instanceof Gn,c=a[0],u=l||Gs(t),h=function(e){var t=o.apply(Fn,Nt([e],a));return i&&d?t[0]:t};u&&r&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,f=s&&!d,m=l&&!p;if(!s&&u){t=m?t:new Gn(this);var g=e.apply(t,a);return g.__actions__.push({func:ds,args:[h],thisArg:n}),new Hn(g,d)}return f&&m?e.apply(this,a):(g=this.thru(h),f?i?g.value()[0]:g.value():g)})})),Ct(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Fn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Gs(i)?i:[],e)}return this[n]((function(n){return t.apply(Gs(n)?n:[],e)}))}})),br(Gn.prototype,(function(e,t){var n=Fn[t];if(n){var r=n.name+"";Pe.call(Rn,r)||(Rn[r]=[]),Rn[r].push({name:t,func:n})}})),Rn[Fi(n,2).name]=[{name:"wrapper",func:n}],Gn.prototype.clone=function(){var e=new Gn(this.__wrapped__);return e.__actions__=Ii(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ii(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ii(this.__views__),e},Gn.prototype.reverse=function(){if(this.__filtered__){var e=new Gn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Gn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Gs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=_n(t,e+s);break;case"takeRight":e=vn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,l=a-s,c=r?a:s-1,u=this.__iteratees__,h=u.length,d=0,p=_n(l,this.__takeCount__);if(!n||!r&&i==l&&p==l)return pi(e,this.__actions__);var f=[];e:for(;l--&&d<p;){for(var m=-1,g=e[c+=t];++m<h;){var v=u[m],_=v.iteratee,b=v.type,y=_(g);if(2==b)g=y;else if(!y){if(1==b)continue e;break e}}f[d++]=g}return f},Fn.prototype.at=ps,Fn.prototype.chain=function(){return hs(this)},Fn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===n&&(this.__values__=ha(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Fn.prototype.plant=function(e){for(var t,r=this;r instanceof zn;){var i=Bo(r);i.__index__=0,i.__values__=n,t?o.__wrapped__=i:t=i;var o=i;r=r.__wrapped__}return o.__wrapped__=e,t},Fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Gn){var t=e;return this.__actions__.length&&(t=new Gn(this)),(t=t.reverse()).__actions__.push({func:ds,args:[Qo],thisArg:n}),new Hn(t,this.__chain__)}return this.thru(Qo)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return pi(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,Je&&(Fn.prototype[Je]=function(){return this}),Fn}();mt?((mt.exports=mn)._=mn,ft._=mn):pt._=mn}).call(ud)}(k_,k_.exports);const R_=k_.exports,A_=M_(kv(((e,t)=>({clock:new C_,items:{},tfs:{},hulls:{},lines:{},texts:{},points:{},widgets:{},onMove:(t,n,r,i)=>e((e=>{console.log(i),e[n][t].position={...i.position},e[n][t].rotation=i.quaternion,e[n][t].rotation.x=i.quaternion.x,e[n][t].rotation.y=i.quaternion.y,e[n][t].rotation.z=i.quaternion.z,e[n][t].rotation.w=i.quaternion.w,e[n][t].scale={...i.scale}})),onClick:(e,n,r,i)=>{n||console.log("id: ".concat(e," clicked!"),r),t().items[e]&&!n&&i.stopPropagation()},onPointerOver:(e,t,n)=>{},onPointerOut:(e,t,n)=>{},pause:()=>e((e=>{e.clock.setTimescale(0)})),play:t=>e((e=>{e.clock.setTimescale(t||1)})),reset:t=>e((e=>{console.log("setting time to ".concat(t)),e.clock._elapsed=t?1e3*t:0})),clearItems:()=>e((e=>({items:{}}))),clearLines:()=>e((e=>({lines:{}}))),clearTfs:()=>e((e=>({tfs:{}}))),clearHulls:()=>e((e=>({hulls:{}}))),clearTexts:()=>e((e=>({texts:{}}))),clearPoints:()=>e((e=>({points:{}}))),setItems:t=>e((e=>({items:t}))),setLines:t=>e((e=>({lines:t}))),setTfs:t=>e((e=>({tfs:t}))),setHulls:t=>e((e=>({hulls:t}))),setTexts:t=>e((e=>({texts:t}))),setPoints:t=>e((e=>({points:t}))),removeItem:t=>e((e=>{delete e.items[t]})),removeLine:t=>e((e=>{delete e.lines[t]})),removeTf:t=>e((e=>{delete e.tfs[t]})),removeHull:t=>e((e=>{delete e.hulls[t]})),removeText:t=>e((e=>{delete e.texts[t]})),removePoint:t=>e((e=>{delete e.points[t]})),setItem:(t,n)=>e((e=>{e.items[t]=n})),setLine:(t,n)=>e((e=>{e.lines[t]=n})),setTf:(t,n)=>e((e=>{e.tfs[t]=n})),setHull:(t,n)=>e((e=>{e.hulls[t]=n})),setText:(t,n)=>e((e=>{e.texts[t]=n})),setPoint:(t,n)=>e((e=>{e.points[t]=n})),setProperty:(t,n)=>e((e=>{R_.set(e,t,n)}))})))),L_=(e=>e?Iv(e):Iv)(A_),O_=(0,e.createContext)(),N_=(t,n)=>Cv((0,e.useContext)(O_),t,n),P_=e=>{let{store:t,children:n,debug:r=!1}=e;return r&&console.log("SceneProvider regenerated"),Ld(O_.Provider,{value:t||L_,children:n})},D_=e.forwardRef(((e,t)=>Ld("ambientLight",{ref:t,...e})));e.forwardRef(((e,t)=>Ld("pointLight",{ref:t,...e})));const $_=e.forwardRef(((e,t)=>Ld("directionalLight",{ref:t,...e}))),B_=(e,t,n,r)=>{var i=new ln;return i.setRGB(e/255,t/255,n/255),new qc(r<=.99?{color:i.getHex(),opacity:r+.1,transparent:!0,depthWrite:!0,blendSrc:A,blendDst:L,blendEquation:w,blending:v}:{color:i.getHex(),opacity:r,blending:v})},F_=k_.exports.memoize((e=>{var t=new ln(e);return new yi({uniforms:{coeficient:{type:"f",value:1.2},power:{type:"f",value:4},glowColor:{type:"c",value:t}},vertexShader:"\n\t\tvarying vec3\tvVertexWorldPosition;\n\t\tvarying vec3\tvVertexNormal;\n\n\t\t// varying vec4\tvFragColor;\n\n\t\tvoid main(){\n\t\t\tvVertexNormal\t= normalize(normalMatrix * normal);\n\n\t\t\tvVertexWorldPosition\t= (modelMatrix * vec4(position, 1.0)).xyz;\n\n\t\t\t// set gl_Position\n\t\t\tgl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t}",fragmentShader:"\n\t\tuniform vec3\tglowColor;\n\t\tuniform float\tcoeficient;\n\t\tuniform float\tpower;\n\n\t\tvarying vec3\tvVertexNormal;\n\t\tvarying vec3\tvVertexWorldPosition;\n\n\t\t// varying vec4\tvFragColor;\n\n\t\tvoid main(){\n\t\t\tvec3 worldCameraToVertex= vVertexWorldPosition - cameraPosition;\n\t\t\tvec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n\t\t\tviewCameraToVertex\t= normalize(viewCameraToVertex);\n\t\t\tfloat intensity\t\t= pow(coeficient + dot(vVertexNormal, viewCameraToVertex), power);\n\t\t\tgl_FragColor\t\t= vec4(glowColor, intensity);\n\t\t}",blending:_,transparent:!0,depthWrite:!1,depthTest:!1})}));const U_=new Nh,z_=new yn,H_=new yn,G_=new bn,V_={X:new yn(1,0,0),Y:new yn(0,1,0),Z:new yn(0,0,1)},W_={type:"change"},j_={type:"mouseDown"},X_={type:"mouseUp",mode:null},Y_={type:"objectChange"};class K_ extends Er{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new gb;this._gizmo=n,this.add(n);const r=new vb;this._plane=r,this.add(r);const i=this;function o(e,t){let o=t;Object.defineProperty(i,e,{get:function(){return void 0!==o?o:t},set:function(t){o!==t&&(o=t,r[e]=t,n[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(W_))}}),i[e]=t,r[e]=t,n[e]=t}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const s=new yn,a=new yn,l=new bn,c=new bn,u=new yn,h=new bn,d=new yn,p=new yn,f=new yn,m=new yn;o("worldPosition",s),o("worldPositionStart",a),o("worldQuaternion",l),o("worldQuaternionStart",c),o("cameraPosition",u),o("cameraQuaternion",h),o("pointStart",d),o("pointEnd",p),o("rotationAxis",f),o("rotationAngle",0),o("eye",m),this._offset=new yn,this._startNorm=new yn,this._endNorm=new yn,this._cameraScale=new yn,this._parentPosition=new yn,this._parentQuaternion=new bn,this._parentQuaternionInv=new bn,this._parentScale=new yn,this._worldScaleStart=new yn,this._worldQuaternionInv=new bn,this._worldScale=new yn,this._positionStart=new yn,this._quaternionStart=new bn,this._scaleStart=new yn,this._getPointer=q_.bind(this),this._onPointerDown=Z_.bind(this),this._onPointerHover=J_.bind(this),this._onPointerMove=Q_.bind(this),this._onPointerUp=eb.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye):this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;U_.setFromCamera(e,this.camera);const t=tb(this._gizmo.picker[this.mode],U_);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){U_.setFromCamera(e,this.camera);const t=tb(this._plane,U_,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,j_.mode=this.mode,this.dispatchEvent(j_)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let i=this.space;if("scale"===n?i="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(i="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;U_.setFromCamera(e,this.camera);const o=tb(this._plane,U_,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===i&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===i&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===i&&(r.position.applyQuaternion(G_.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===i&&(r.parent&&r.position.add(z_.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(z_.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),H_.set(e,e,e)}else z_.copy(this.pointStart),H_.copy(this.pointEnd),z_.applyQuaternion(this._worldQuaternionInv),H_.applyQuaternion(this._worldQuaternionInv),H_.divide(z_),-1===t.search("X")&&(H_.x=1),-1===t.search("Y")&&(H_.y=1),-1===t.search("Z")&&(H_.z=1);r.scale.copy(this._scaleStart).multiply(H_),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(z_.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(z_.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(V_[t]),z_.copy(V_[t]),"local"===i&&z_.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(z_.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(G_.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(G_.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(W_),this.dispatchEvent(Y_)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(X_.mode=this.mode,this.dispatchEvent(X_)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(W_),this.dispatchEvent(Y_),this.pointStart.copy(this.pointEnd))}getRaycaster(){return U_}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function q_(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function J_(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function Z_(e){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function Q_(e){!this.enabled||this.pointerMove(this._getPointer(e))}function eb(e){!this.enabled||(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function tb(e,t,n){const r=t.intersectObject(e,!0);for(let i=0;i<r.length;i++)if(r[i].object.visible||n)return r[i];return!1}const nb=new ar,rb=new yn(0,1,0),ib=new yn(0,0,0),ob=new Jn,sb=new bn,ab=new bn,lb=new yn,cb=new Jn,ub=new yn(1,0,0),hb=new yn(0,1,0),db=new yn(0,0,1),pb=new yn,fb=new yn,mb=new yn;class gb extends Er{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Dr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new sl({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const i=e.clone();i.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const s=e.clone();s.color.setHex(255);const a=e.clone();a.color.setHex(16711680),a.opacity=.5;const l=e.clone();l.color.setHex(65280),l.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const u=e.clone();u.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const d=e.clone();d.color.setHex(7895160);const p=new ql(0,.04,.1,12);p.translate(0,.05,0);const f=new gi(.08,.08,.08);f.translate(0,.04,0);const m=new qr;m.setAttribute("position",new Hr([0,0,0,1,0,0],3));const g=new ql(.0075,.0075,.5,3);function v(e,t){const n=new Hc(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}g.translate(0,.25,0);const _={X:[[new fi(p,i),[.5,0,0],[0,0,-Math.PI/2]],[new fi(p,i),[-.5,0,0],[0,0,Math.PI/2]],[new fi(g,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new fi(p,o),[0,.5,0]],[new fi(p,o),[0,-.5,0],[Math.PI,0,0]],[new fi(g,o)]],Z:[[new fi(p,s),[0,0,.5],[Math.PI/2,0,0]],[new fi(p,s),[0,0,-.5],[-Math.PI/2,0,0]],[new fi(g,s),null,[Math.PI/2,0,0]]],XYZ:[[new fi(new $c(.1,0),u.clone()),[0,0,0]]],XY:[[new fi(new gi(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new fi(new gi(.15,.15,.01),a.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fi(new gi(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},b={X:[[new fi(new ql(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fi(new ql(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fi(new ql(.2,0,.6,4),n),[0,.3,0]],[new fi(new ql(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fi(new ql(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fi(new ql(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new fi(new $c(.2,0),n)]],XY:[[new fi(new gi(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fi(new gi(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fi(new gi(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},y={START:[[new fi(new $c(.01,2),r),null,null,null,"helper"]],END:[[new fi(new $c(.01,2),r),null,null,null,"helper"]],DELTA:[[new dl(function(){const e=new qr;return e.setAttribute("position",new Hr([0,0,0,1,1,1],3)),e}(),r),null,null,null,"helper"]],X:[[new dl(m,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new dl(m,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new dl(m,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},T={XYZE:[[new fi(v(.5,1),d),null,[0,Math.PI/2,0]]],X:[[new fi(v(.5,.5),i)]],Y:[[new fi(v(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new fi(v(.5,.5),s),null,[0,Math.PI/2,0]]],E:[[new fi(v(.75,1),h),null,[0,Math.PI/2,0]]]},E={AXIS:[[new dl(m,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},S={XYZE:[[new fi(new Uc(.25,10,8),n)]],X:[[new fi(new Hc(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new fi(new Hc(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new fi(new Hc(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new fi(new Hc(.75,.1,2,24),n)]]},w={X:[[new fi(f,i),[.5,0,0],[0,0,-Math.PI/2]],[new fi(g,i),[0,0,0],[0,0,-Math.PI/2]],[new fi(f,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new fi(f,o),[0,.5,0]],[new fi(g,o)],[new fi(f,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new fi(f,s),[0,0,.5],[Math.PI/2,0,0]],[new fi(g,s),[0,0,0],[Math.PI/2,0,0]],[new fi(f,s),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new fi(new gi(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new fi(new gi(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fi(new gi(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fi(new gi(.1,.1,.1),u.clone())]]},x={X:[[new fi(new ql(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fi(new ql(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fi(new ql(.2,0,.6,4),n),[0,.3,0]],[new fi(new ql(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fi(new ql(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fi(new ql(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new fi(new gi(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fi(new gi(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fi(new gi(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fi(new gi(.2,.2,.2),n),[0,0,0]]]},M={X:[[new dl(m,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new dl(m,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new dl(m,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function C(e){const t=new Er;for(const n in e)for(let r=e[n].length;r--;){const i=e[n][r][0].clone(),o=e[n][r][1],s=e[n][r][2],a=e[n][r][3],l=e[n][r][4];i.name=n,i.tag=l,o&&i.position.set(o[0],o[1],o[2]),s&&i.rotation.set(s[0],s[1],s[2]),a&&i.scale.set(a[0],a[1],a[2]),i.updateMatrix();const c=i.geometry.clone();c.applyMatrix4(i.matrix),i.geometry=c,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=C(_)),this.add(this.gizmo.rotate=C(T)),this.add(this.gizmo.scale=C(w)),this.add(this.picker.translate=C(b)),this.add(this.picker.rotate=C(S)),this.add(this.picker.scale=C(x)),this.add(this.helper.translate=C(y)),this.add(this.helper.rotate=C(E)),this.add(this.helper.scale=C(M)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:ab;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let r=0;r<n.length;r++){const e=n[r];let i;e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),(i=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(i*this.size/4),"helper"!==e.tag)?(e.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===e.name&&Math.abs(rb.copy(ub).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Y"===e.name&&Math.abs(rb.copy(hb).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Z"===e.name&&Math.abs(rb.copy(db).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(rb.copy(db).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(rb.copy(ub).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(rb.copy(hb).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1)):"rotate"===this.mode&&(sb.copy(t),rb.copy(this.eye).applyQuaternion(G_.copy(t).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(ob.lookAt(this.eye,ib,hb)),"X"===e.name&&(G_.setFromAxisAngle(ub,Math.atan2(-rb.y,rb.z)),G_.multiplyQuaternions(sb,G_),e.quaternion.copy(G_)),"Y"===e.name&&(G_.setFromAxisAngle(hb,Math.atan2(rb.x,rb.z)),G_.multiplyQuaternions(sb,G_),e.quaternion.copy(G_)),"Z"===e.name&&(G_.setFromAxisAngle(db,Math.atan2(rb.y,rb.x)),G_.multiplyQuaternions(sb,G_),e.quaternion.copy(G_))),e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material._color=e.material._color||e.material.color.clone(),e.material._opacity=e.material._opacity||e.material.opacity,e.material.color.copy(e.material._color),e.material.opacity=e.material._opacity,this.enabled&&this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t})))&&(e.material.color.setHex(16776960),e.material.opacity=1)):(e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(G_.setFromEuler(nb.set(0,0,0)),e.quaternion.copy(t).multiply(G_),Math.abs(rb.copy(ub).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(G_.setFromEuler(nb.set(0,0,Math.PI/2)),e.quaternion.copy(t).multiply(G_),Math.abs(rb.copy(hb).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(G_.setFromEuler(nb.set(0,Math.PI/2,0)),e.quaternion.copy(t).multiply(G_),Math.abs(rb.copy(db).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(G_.setFromEuler(nb.set(0,Math.PI/2,0)),rb.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(ob.lookAt(ib,rb,hb)),e.quaternion.multiply(G_),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),z_.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),z_.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(z_),e.visible=this.dragging):(e.quaternion.copy(t),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name))))}super.updateMatrixWorld(e)}}class vb extends fi{constructor(){super(new Di(1e5,1e5,2,2),new Dr({visible:!1,wireframe:!0,side:m,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),pb.copy(ub).applyQuaternion("local"===t?this.worldQuaternion:ab),fb.copy(hb).applyQuaternion("local"===t?this.worldQuaternion:ab),mb.copy(db).applyQuaternion("local"===t?this.worldQuaternion:ab),rb.copy(fb),this.mode){case"translate":case"scale":switch(this.axis){case"X":rb.copy(this.eye).cross(pb),lb.copy(pb).cross(rb);break;case"Y":rb.copy(this.eye).cross(fb),lb.copy(fb).cross(rb);break;case"Z":rb.copy(this.eye).cross(mb),lb.copy(mb).cross(rb);break;case"XY":lb.copy(mb);break;case"YZ":lb.copy(pb);break;case"XZ":rb.copy(mb),lb.copy(fb);break;case"XYZ":case"E":lb.set(0,0,0)}break;default:lb.set(0,0,0)}0===lb.length()?this.quaternion.copy(this.cameraQuaternion):(cb.lookAt(z_.set(0,0,0),lb,rb),this.quaternion.setFromRotationMatrix(cb)),super.updateMatrixWorld(e)}}const _b=e=>{let{length:t,radius:n}=void 0===e?{}:e;t=void 0===t?1:t,n=void 0===n?1:n;const r=.4*t,i=new ql(0,.1*n,r,32,1),o=.6*t,s=.025*n,a=new ql(s,s,o,32,1);var l=new Jn;return l.setPosition(new yn(0,.5*o,0)),a.applyMatrix4(l),l.setPosition(new yn(0,o+.5*r,0)),i.applyMatrix4(l),Uf([i,a])},bb=(e,t,n)=>{if(e.current&&t){const r="function"==typeof t.r?t.r(n)/255:t.r/255,i="function"==typeof t.g?t.g(n)/255:t.g/255,o="function"==typeof t.b?t.b(n)/255:t.b/255,s="function"==typeof t.a?t.a(n):t.a;e.current.material.color.setRGB(r,i,o),e.current.material.opacity=s,e.current.material.transparent=1!==s}},yb=e=>{let t=null;return e.shape?("cube"===e.shape?t=(e=>{let{x:t,y:n,z:r}=void 0===e?{}:e;return t=void 0===t?1:t,n=void 0===n?1:n,r=void 0===r?1:r,new jf(t,n,r,2,.05)})(e.shapeParams):"cylinder"===e.shape?t=(e=>{let{radius:t,height:n}=void 0===e?{}:e;return t=void 0===t?.5:t,n=void 0===n?1:n,new ql(t,t,n,32,1,!1)})(e.shapeParams):"sphere"===e.shape?t=(e=>{let{radius:t}=void 0===e?{}:e;return t=void 0===t?.5:t,new Uc(t,32,32)})(e.shapeParams):"capsule"===e.shape?t=(e=>{let{radius:t,height:n}=void 0===e?{}:e;t=void 0===t?.5:t,n=void 0===n?1:n;const r=new ql(t,t,n,32,1,!0),i=new Uc(t,32,32,Math.PI,Math.PI),o=new Uc(t,32,32,Math.PI,Math.PI);var s=new Jn;s.makeRotationX(Math.PI/2),s.setPosition(0,n/2,0);var a=new Jn;return a.makeRotationX(-Math.PI/2),a.setPosition(0,-n/2,0),i.applyMatrix4(s),o.applyMatrix4(a),Uf([r,i,o])})(e.shapeParams):"arrow"===e.shape&&(t=_b(e.shapeParams)),[{geometry:t,type:"part"}]):[]};function Tb(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const i=(0,e.useRef)();return(0,e.useEffect)((()=>{n.forEach((e=>{!e||("function"==typeof e?e(i.current):e.current=i.current)}))}),[n]),i}function Eb(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const Sb=(0,e.forwardRef)(((t,n)=>{let{objectKey:r,displayTfs:i,position:o,rotation:s,scale:a,ghost:l,highlightColor:c,children:u}=t;const h=Tb(n,(0,e.useRef)(null)),d=N_((0,e.useCallback)((e=>e.tfs[r]),[r]),Eb),p=N_((e=>e.clock));Tp((0,e.useCallback)((()=>{const e=1e3*p.getElapsed();h.current&&(h.current.position.set(o?o.x:"function"==typeof d.position.x?d.position.x(e):d.position.x,o?o.y:"function"==typeof d.position.y?d.position.y(e):d.position.y,o?o.z:"function"==typeof d.position.z?d.position.z(e):d.position.z),h.current.quaternion.set(s?s.x:"function"==typeof d.rotation.x?d.rotation.x(e):d.rotation.x,s?s.y:"function"==typeof d.rotation.y?d.rotation.y(e):d.rotation.y,s?s.z:"function"==typeof d.rotation.z?d.rotation.z(e):d.rotation.z,s?s.w:"function"==typeof d.rotation.w?d.rotation.w(e):d.rotation.w),h.current.scale.set(a?a.x:d.scale?"function"==typeof d.scale.x?d.scale.x(e):d.scale.x:0,a?a.y:d.scale?"function"==typeof d.scale.y?d.scale.y(e):d.scale.y:0,a?a.z:d.scale?"function"==typeof d.scale.z?d.scale.z(e):d.scale.z:0))}),[d,o,s,a,h,p]));const f=_b();return Od("group",{ref:h,dispose:null,up:[0,0,1],children:[i&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:f,material:l?F_(c):B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"".concat(r,"ArrowX")),Ld("mesh",{geometry:f,material:l?F_(c):B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"".concat(r,"ArrowY")),Ld("mesh",{geometry:f,material:l?F_(c):B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"".concat(r,"ArrowZ"))]}),u]})}));function wb(e){let{displayTfs:t,children:n}=e;const r=_b();return Od("group",{dispose:null,up:[0,0,1],children:[t&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:r,material:B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"$WorldArrowX"),Ld("mesh",{geometry:r,material:B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"$WorldArrowY"),Ld("mesh",{geometry:r,material:B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"$WorldArrowZ")]}),n]})}function xb(e){let{displayTfs:t,children:n}=e;const r=_b();return Od("group",{dispose:null,up:[0,0,1],children:[t&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:r,material:B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"$WorldArrowX"),Ld("mesh",{geometry:r,material:B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"$WorldArrowY"),Ld("mesh",{geometry:r,material:B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"$WorldArrowZ")]}),n]})}var Mb="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Cb=class extends yi{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{THREE_REVISION:i.replace(/\D+/g,""),MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new Ah(null),luminanceBuffer1:new Ah(null),minLuminance:new Ah(.01),deltaTime:new Ah(0),tau:new Ah(1)},extensions:{shaderTextureLOD:!0},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\nuniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));\n#if __VERSION__ < 300\nfloat l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;\n#else\nfloat l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;\n#endif\nl0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}",vertexShader:Mb}),this.toneMapped=!1}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}};function Ib(e,t){let n="texel";if(null!==e){const r=Number.parseInt(i);if(!(t&&r>=133&&135!==r&&e.format===ke&&e.type===ge&&e.encoding===yt))switch(e.encoding){case yt:n="sRGBToLinear(texel)";break;case bt:n="texel";break;default:throw new Error("Unsupported encoding: ".concat(e.encoding))}}return n}var kb={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Rb={NONE:0,DEPTH:1,CONVOLUTION:2},Ab={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Lb={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Ob={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},Nb={DEFAULT:0,ESKIL:1},Pb=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Db=class extends yi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new mn;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new mn),scale:new Ah(1),kernel:new Ah(0)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n}",vertexShader:"uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernelSize=Lb.MEDIUM}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return Pb[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,.5*e,.5*t)}setSize(e,t){const n=1/e,r=1/t;this.uniforms.texelSize.value.set(n,r,.5*n,.5*r)}},$b=class extends yi{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ah(null),opacity:new Ah(1)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:Mb}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},Bb=class extends yi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;super({name:"DepthComparisonMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ah(null),cameraNear:new Ah(.3),cameraFar:new Ah(1e3)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#include <clipping_planes_pars_fragment>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float cameraNear;uniform float cameraFar;varying float vViewZ;varying vec4 vProjTexCoord;void main(){\n#include <clipping_planes_fragment>\nvec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);\n#if DEPTH_PACKING == 3201\nfloat fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));\n#else\nfloat fragCoordZ=texture2D(depthBuffer,projTexCoord).r;\n#endif\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\n#else\nfloat viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\n#endif\nfloat depthTest=(-vViewZ>-viewZ)?1.0:0.0;gl_FragColor.rg=vec2(0.0,depthTest);}",vertexShader:"#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying float vViewZ;varying vec4 vProjTexCoord;void main(){\n#include <skinbase_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\nvViewZ=mvPosition.z;vProjTexCoord=gl_Position;\n#include <clipping_planes_vertex>\n}"}),this.toneMapped=!1,this.depthBuffer=e,this.depthPacking=Et,this.copyCameraSettings(t)}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et;this.depthBuffer=e,this.depthPacking=t}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Ei?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Fb=class extends yi{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ah(null),normalBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\n#ifdef DOWNSAMPLE_NORMALS\nuniform lowp sampler2D normalBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[]=float[4](abs(c-samples[0]),abs(c-samples[1]),abs(c-samples[2]),abs(c-samples[3]));float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[]=float[4](readDepth(vUv0),readDepth(vUv1),readDepth(vUv2),readDepth(vUv3));int index=findBestDepth(d);\n#ifdef DOWNSAMPLE_NORMALS\nvec3 n[]=vec3[4](texture2D(normalBuffer,vUv0).rgb,texture2D(normalBuffer,vUv1).rgb,texture2D(normalBuffer,vUv2).rgb,texture2D(normalBuffer,vUv3).rgb);\n#else\nvec3 n[]=vec3[4](vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));\n#endif\ngl_FragColor=vec4(n[index],d[index]);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.depthBuffer=e,this.depthPacking=t}set normalBuffer(e){this.uniforms.normalBuffer.value=e,null!==e?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(e){this.normalBuffer=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Ub=class extends yi{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#define WEIGHT_INNER 0.125\n#define WEIGHT_OUTER 0.0555555\nvarying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;\n#include <encodings_fragment>\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},zb=class extends yi{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:i.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ah(null),depthBuffer:new Ah(null),resolution:new Ah(new Wt),texelSize:new Ah(new Wt),cameraNear:new Ah(.3),cameraFar:new Ah(1e3),aspect:new Ah(1),time:new Ah(0)},blending:g,depthWrite:!1,depthTest:!1,dithering:o}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(r)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){var t,n,r,i,o;return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#if DEPTH_PACKING == 3201\nuniform lowp sampler2D depthBuffer;\n#elif defined(GL_FRAGMENT_PRECISION_HIGH)\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(Ab.FRAGMENT_HEAD,null!=(t=e.get(Ab.FRAGMENT_HEAD))?t:"").replace(Ab.FRAGMENT_MAIN_UV,null!=(n=e.get(Ab.FRAGMENT_MAIN_UV))?n:"").replace(Ab.FRAGMENT_MAIN_IMAGE,null!=(r=e.get(Ab.FRAGMENT_MAIN_IMAGE))?r:""),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(Ab.VERTEX_HEAD,null!=(i=e.get(Ab.VERTEX_HEAD))?i:"").replace(Ab.VERTEX_MAIN_SUPPORT,null!=(o=e.get(Ab.VERTEX_MAIN_SUPPORT))?o:""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Ei?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return Ab}},Hb=class extends yi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:i.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ah(null),threshold:new Ah(0),smoothing:new Ah(1),range:new Ah(null)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:Mb}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},Gb=class extends yi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt;super({name:"OutlineMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"uniform lowp sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)?vec2(d,0.0):vec2(0.0,d);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.uniforms.texelSize.value.set(e.x,e.y),this.uniforms.maskTexture=this.uniforms.inputBuffer}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Vb=class extends Db{constructor(){let{kernelSize:e=Lb.MEDIUM,offset:t=0,rotation:n=0,focusArea:r=.4,feather:i=.3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.fragmentShader="#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform vec4 maskParams;varying vec2 vUv;varying vec2 vUv2;varying vec2 vOffset;float linearGradientMask(const in float x){return smoothstep(maskParams.x,maskParams.y,x)-smoothstep(maskParams.w,maskParams.z,x);}void main(){vec2 dUv=vOffset*(1.0-linearGradientMask(vUv2.y));vec4 sum=texture2D(inputBuffer,vec2(vUv.x-dUv.x,vUv.y+dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x+dUv.x,vUv.y+dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x+dUv.x,vUv.y-dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x-dUv.x,vUv.y-dUv.y));gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n}",this.vertexShader="uniform vec4 texelSize;uniform float kernel;uniform float scale;uniform float aspect;uniform vec2 rotation;varying vec2 vUv;varying vec2 vUv2;varying vec2 vOffset;void main(){vec2 uv=position.xy*0.5+0.5;vUv=uv;vUv2=(uv-0.5)*2.0*vec2(aspect,1.0);vUv2=vec2(dot(rotation,vUv2),dot(rotation,vec2(vUv2.y,-vUv2.x)));vOffset=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;gl_Position=vec4(position.xy,1.0,1.0);}",this.kernelSize=e,this.uniforms.aspect=new Ah(1),this.uniforms.rotation=new Ah(new Wt),this.uniforms.maskParams=new Ah(new mn),this._offset=t,this._focusArea=r,this._feather=i,this.rotation=n,this.updateParams()}updateParams(){const e=this.uniforms.maskParams.value,t=Math.max(this.focusArea,0),n=Math.max(t-this.feather,0);e.set(this.offset-t,this.offset-n,this.offset+t,this.offset+n)}get rotation(){return Math.acos(this.uniforms.rotation.value.x)}set rotation(e){this.uniforms.rotation.value.set(Math.cos(e),Math.sin(e))}get offset(){return this._offset}set offset(e){this._offset=e,this.updateParams()}get focusArea(){return this._focusArea}set focusArea(e){this._focusArea=e,this.updateParams()}get feather(){return this._feather}set feather(e){this._feather=e,this.updateParams()}setSize(e,t){super.setSize(e,t),this.uniforms.aspect.value=e/t}},Wb=class extends yi{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Ah(null),supportBuffer:new Ah(null),texelSize:new Ah(new Wt),radius:new Ah(.85)},blending:g,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;\n#else\nuniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;\n#endif\nuniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);\n#include <encodings_fragment>\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},jb=new Ti,Xb=null;var Yb=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ya,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jb;this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;null!==t&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new fi(function(){if(null===Xb){const e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Xb=new qr).setAttribute?(Xb.setAttribute("position",new Fr(e,3)),Xb.setAttribute("uv",new Fr(t,2))):(Xb.addAttribute("position",new Fr(e,3)),Xb.addAttribute("uv",new Fr(t,2)))}return Xb}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new ya),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,n,r,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof gn||t instanceof Pr||t instanceof fn||t instanceof Yb)&&this[e].dispose()}}},Kb=class extends Yb{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new $b,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new gn(1,1,{minFilter:pe,magFilter:pe,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,r,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTarget.texture.type=n,n!==ge?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},qb=class extends Yb{constructor(e){let{minLuminance:t=.01,adaptationRate:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("AdaptiveLuminancePass"),this.fullscreenMaterial=new Cb,this.needsSwap=!1,this.renderTargetPrevious=new gn(1,1,{minFilter:ue,magFilter:ue,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const r=this.fullscreenMaterial;r.luminanceBuffer0=this.renderTargetPrevious.texture,r.luminanceBuffer1=e,r.minLuminance=t,r.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new Kb(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,r,i){this.fullscreenMaterial.deltaTime=r,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}},Jb=class extends Yb{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,r,i){const o=e.state.buffers.stencil;o.setLocked(!1),o.setTest(!1)}},Zb=new ln,Qb=class extends Yb{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,r,i){const o=this.overrideClearColor,s=this.overrideClearAlpha,a=e.getClearAlpha(),l=null!==o,c=s>=0;l?(e.getClearColor(Zb),e.setClearColor(o,c?s:a)):c&&e.setClearAlpha(s),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Zb,a):c&&e.setClearAlpha(a)}},ey=-1,ty=class extends Lt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ey,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ey,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.baseSize=new Wt(1,1),this.preferredSize=new Wt(t,n),this.target=this.preferredSize,this.s=r,this.effectiveSize=new Wt,this.addEventListener("change",(()=>this.updateEffectiveSize())),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,r=this.scale;t.width!==ey?n.width=t.width:t.height!==ey?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*r),t.height!==ey?n.height=t.height:t.width!==ey?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*r)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(ey),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.baseSize.width!==e||this.baseSize.height!==t)&&(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferredSize.width!==e||this.preferredSize.height!==t)&&(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ey}},ny=!1,ry=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case m:t=this.materialsFlatShadedDoubleSide;break;case f:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case m:t=this.materialsDoubleSide;break;case f:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){const t=this.materials=[e.clone(),e.clone(),e.clone()];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=p;t[2].skinning=!0,this.materialsBackSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=f,n})),this.materialsDoubleSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=m,n})),this.materialsFlatShaded=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n})),this.materialsFlatShadedBackSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=f,n})),this.materialsFlatShadedDoubleSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=m,n}))}}render(e,t,n){const r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,ny){const r=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const e of r)e[0].material=e[1];this.meshCount!==r.size&&r.clear()}else{const r=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=r}e.shadowMap.enabled=r}disposeMaterials(){if(null!==this.material){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return ny}static set workaroundEnabled(e){ny=e}},iy=class extends Yb{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Qb,this.overrideMaterialManager=null===n?null:new ry(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new ry(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,r,i){const o=this.scene,s=this.camera,a=this.selection,l=s.layers.mask,c=o.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;null!==a&&s.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(o.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,o,s):e.render(o,s),s.layers.mask=l,o.background=c,e.shadowMap.autoUpdate=u}},oy=class extends Yb{constructor(e,t){let{renderTarget:n,resolutionScale:r=1,width:i=ty.AUTO_SIZE,height:o=ty.AUTO_SIZE,resolutionX:s=i,resolutionY:a=o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new iy(e,t,new ea({depthPacking:Et}));const l=this.renderPass;l.skipShadowMapUpdate=!0,l.ignoreBackground=!0;const c=l.getClearPass();c.overrideClearColor=new ln(16777215),c.overrideClearAlpha=1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new gn(1,1,{minFilter:ue,magFilter:ue}),this.renderTarget.texture.name="DepthPass.Target");const u=this.resolution=new ty(this,s,a,r);u.addEventListener("change",(e=>this.setSize(u.baseWidth,u.baseHeight)))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,i){const o=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,o)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},sy=class extends Yb{constructor(){let{normalBuffer:e=null,resolutionScale:t=.5,width:n=ty.AUTO_SIZE,height:r=ty.AUTO_SIZE,resolutionX:i=n,resolutionY:o=r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DepthDownsamplingPass");const s=new Fb;s.normalBuffer=e,this.fullscreenMaterial=s,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new gn(1,1,{minFilter:ue,magFilter:ue,depthBuffer:!1,type:Ee}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const a=this.resolution=new ty(this,i,o,t);a.addEventListener("change",(e=>this.setSize(a.baseWidth,a.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t}render(e,t,n,r,i){e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){const r=e.getContext();if(!r.getExtension("EXT_color_buffer_float")&&!r.getExtension("EXT_color_buffer_half_float"))throw new Error("Rendering to float texture is not supported.")}};function ay(e,t,n){for(const r of t){const t="$1"+e+r.charAt(0).toUpperCase()+r.slice(1),i=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const e of n.entries())null!==e[1]&&n.set(e[0],e[1].replace(i,t))}}function ly(e,t,n){var r,i,o,s,a;let l=t.getFragmentShader(),c=t.getVertexShader();const u=void 0!==l&&/mainImage/.test(l),h=void 0!==l&&/mainUv/.test(l);if(n.attributes|=t.getAttributes(),void 0===l)throw new Error("Missing fragment shader (".concat(t.name,")"));if(h&&0!==(n.attributes&Rb.CONVOLUTION))throw new Error("Effects that transform UVs are incompatible with convolution effects (".concat(t.name,")"));if(!u&&!h)throw new Error("Could not find mainImage or mainUv function (".concat(t.name,")"));{const d=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,p=n.shaderParts;let f=null!=(r=p.get(Ab.FRAGMENT_HEAD))?r:"",m=null!=(i=p.get(Ab.FRAGMENT_MAIN_UV))?i:"",g=null!=(o=p.get(Ab.FRAGMENT_MAIN_IMAGE))?o:"",v=null!=(s=p.get(Ab.VERTEX_HEAD))?s:"",_=null!=(a=p.get(Ab.VERTEX_MAIN_SUPPORT))?a:"";const b=new Set,y=new Set;if(h&&(m+="\t".concat(e,"MainUv(UV);\n"),n.uvTransformation=!0),null!==c&&/mainSupport/.test(c)){const t=/mainSupport *\([\w\s]*?uv\s*?\)/.test(c);_+="\t".concat(e,"MainSupport("),_+=t?"vUv);\n":");\n";for(const e of c.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const t of e[1].split(/\s*,\s*/))n.varyings.add(t),b.add(t),y.add(t);for(const e of c.matchAll(d))y.add(e[1])}for(const e of l.matchAll(d))y.add(e[1]);for(const e of t.defines.keys())y.add(e.replace(/\([\w\s,]*\)/g,""));for(const e of t.uniforms.keys())y.add(e);y.delete("while"),y.delete("for"),y.delete("if"),t.uniforms.forEach(((t,r)=>n.uniforms.set(e+r.charAt(0).toUpperCase()+r.slice(1),t))),t.defines.forEach(((t,r)=>n.defines.set(e+r.charAt(0).toUpperCase()+r.slice(1),t)));const T=new Map([["fragment",l],["vertex",c]]);ay(e,y,n.defines),ay(e,y,T),l=T.get("fragment"),c=T.get("vertex");const E=t.blendMode;if(n.blendModes.set(E.blendFunction,E),u){null!==t.inputColorSpace&&t.inputColorSpace!==n.colorSpace&&(g+=t.inputColorSpace===yt?"color0 = LinearTosRGB(color0);\n\t":"color0 = sRGBToLinear(color0);\n\t"),null!==t.outputColorSpace?n.colorSpace=t.outputColorSpace:null!==t.inputColorSpace&&(n.colorSpace=t.inputColorSpace);const r=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;g+="".concat(e,"MainImage(color0, UV, "),0!==(n.attributes&Rb.DEPTH)&&r.test(l)&&(g+="depth, ",n.readDepth=!0),g+="color1);\n\t";const i=e+"BlendOpacity";n.uniforms.set(i,E.opacity),g+="color0 = blend".concat(E.blendFunction,"(color0, color1, ").concat(i,");\n\n\t"),f+="uniform float ".concat(i,";\n\n")}if(f+=l+"\n",null!==c&&(v+=c+"\n"),p.set(Ab.FRAGMENT_HEAD,f),p.set(Ab.FRAGMENT_MAIN_UV,m),p.set(Ab.FRAGMENT_MAIN_IMAGE,g),p.set(Ab.VERTEX_HEAD,v),p.set(Ab.VERTEX_MAIN_SUPPORT,_),null!==t.extensions)for(const e of t.extensions)n.extensions.add(e)}}var cy=class extends Yb{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super("EffectPass"),this.fullscreenMaterial=new zb(null,null,null,e),this.listener=e=>this.handleEvent(e),this.effects=[],this.setEffects(n),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort(((e,t)=>t.attributes-e.attributes));for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new yy;let t=0;for(const s of this.effects)if(s.blendMode.blendFunction===kb.DST)e.attributes|=s.getAttributes()&Rb.DEPTH;else{if(0!==(e.attributes&s.getAttributes()&Rb.CONVOLUTION))throw new Error("Convolution effects cannot be merged (".concat(s.name,")"));ly("e"+t++,s,e)}let n=e.shaderParts.get(Ab.FRAGMENT_HEAD),r=e.shaderParts.get(Ab.FRAGMENT_MAIN_IMAGE),i=e.shaderParts.get(Ab.FRAGMENT_MAIN_UV);const o=/\bblend\b/g;for(const s of e.blendModes.values())n+=s.getShaderCode().replace(o,"blend".concat(s.blendFunction))+"\n";0!==(e.attributes&Rb.DEPTH)?(e.readDepth&&(r="float depth = readDepth(UV);\n\n\t"+r),this.needsDepthTexture=null===this.getDepthTexture()):this.needsDepthTexture=!1,e.colorSpace===yt&&(r+="color0 = sRGBToLinear(color0);\n\t"),e.uvTransformation?(i="vec2 transformedUv = vUv;\n"+i,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(Ab.FRAGMENT_HEAD,n),e.shaderParts.set(Ab.FRAGMENT_MAIN_IMAGE,r),e.shaderParts.set(Ab.FRAGMENT_MAIN_UV,i),e.shaderParts.forEach(((e,t,n)=>n.set(t,null==e?void 0:e.trim().replace(/^#/,"\n#")))),this.skipRendering=0===t,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,r,i){for(const o of this.effects)o.update(e,t,r);if(!this.skipRendering||this.renderToScreen){const i=this.fullscreenMaterial;i.inputBuffer=t.texture,i.time+=r*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const r of this.effects)r.initialize(e,t,n);this.updateMaterial(),void 0!==n&&n!==ge&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},uy=class extends Yb{constructor(){let{kernelSize:e=Lb.MEDIUM,resolutionScale:t=.5,width:n=ty.AUTO_SIZE,height:r=ty.AUTO_SIZE,resolutionX:i=n,resolutionY:o=r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new gn(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const s=this.resolution=new ty(this,i,o,t);s.addEventListener("change",(e=>this.setSize(s.baseWidth,s.baseHeight))),this._blurMaterial=new Db,this._blurMaterial.kernelSize=e,this.copyMaterial=new $b}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,i){const o=this.scene,s=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,u=c.kernelSequence;let h=t;this.fullscreenMaterial=c;for(let d=0,p=u.length;d<p;++d){const t=0===(1&d)?a:l;c.kernel=u[d],c.inputBuffer=h.texture,e.setRenderTarget(t),e.render(o,s),h=t}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(o,s)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const r=n.width,i=n.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==ge?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===yt&&(this.renderTargetA.texture.encoding=yt,this.renderTargetB.texture.encoding=yt))}static get AUTO_SIZE(){return ty.AUTO_SIZE}},hy=class extends Yb{constructor(){let{renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:r=1,width:i=ty.AUTO_SIZE,height:o=ty.AUTO_SIZE,resolutionX:s=i,resolutionY:a=o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new Hb(n,t),this.needsSwap=!1,this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new gn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new ty(this,s,a,r);l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,r,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){void 0!==n&&n!==ge&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},dy=class extends Yb{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Qb(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,r,i){const o=e.getContext(),s=e.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;s.color.setMask(!1),s.depth.setMask(!1),s.color.setLocked(!0),s.depth.setLocked(!0),s.stencil.setTest(!0),s.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),s.stencil.setFunc(o.ALWAYS,u,4294967295),s.stencil.setClear(h),s.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(a,l)):(e.setRenderTarget(t),e.render(a,l),e.setRenderTarget(n),e.render(a,l)),s.color.setLocked(!1),s.depth.setLocked(!1),s.stencil.setLocked(!1),s.stencil.setFunc(o.EQUAL,1,4294967295),s.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),s.stencil.setLocked(!0)}},py=class extends Yb{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new gn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Ub,this.upsamplingMaterial=new Wb,this.resolution=new Wt}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<e;++n){const e=t.clone();e.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(e)}this.upsamplingMipmaps.push(t);for(let n=1,r=e-1;n<r;++n){const e=t.clone();e.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(e)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,n,r,i){const{scene:o,camera:s}=this,{downsamplingMaterial:a,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:u}=this;let h=t;this.fullscreenMaterial=a;for(let d=0,p=c.length;d<p;++d){const t=c[d];a.setSize(h.width,h.height),a.inputBuffer=h.texture,e.setRenderTarget(t),e.render(o,s),h=t}this.fullscreenMaterial=l;for(let d=u.length-1;d>=0;--d){const t=u[d];l.setSize(h.width,h.height),l.inputBuffer=h.texture,l.supportBuffer=c[d].texture,e.setRenderTarget(t),e.render(o,s),h=t}}setSize(e,t){const n=this.resolution;n.set(e,t);let r=n.width,i=n.height;for(let o=0,s=this.downsamplingMipmaps.length;o<s;++o)r=Math.round(.5*r),i=Math.round(.5*i),this.downsamplingMipmaps[o].setSize(r,i),o<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[o].setSize(r,i)}initialize(e,t,n){if(void 0!==n){const t=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const e of t)e.texture.type=n;if(n!==ge)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(e.outputEncoding===yt)for(const e of t)e.texture.encoding=yt}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}},fy=class extends Yb{constructor(e,t){let{renderTarget:n,resolutionScale:r=1,width:i=ty.AUTO_SIZE,height:o=ty.AUTO_SIZE,resolutionX:s=i,resolutionY:a=o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("NormalPass"),this.needsSwap=!1,this.renderPass=new iy(e,t,new eu);const l=this.renderPass;l.ignoreBackground=!0,l.skipShadowMapUpdate=!0;const c=l.getClearPass();c.overrideClearColor=new ln(7829503),c.overrideClearAlpha=1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new gn(1,1,{minFilter:ue,magFilter:ue}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new ty(this,s,a,r);u.addEventListener("change",(e=>this.setSize(u.baseWidth,u.baseHeight)))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,i){const o=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,o,o)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},my=class extends Yb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.input=t}setInput(e){this.input=e}render(e,t,n,r,i){const o=this.fullscreenMaterial.uniforms;null!==t&&void 0!==o&&void 0!==o[this.input]&&(o[this.input].value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){void 0!==n&&n!==ge&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},gy=class extends uy{constructor(){let{offset:e=0,rotation:t=0,focusArea:n=.4,feather:r=.3,kernelSize:i=Lb.MEDIUM,resolutionScale:o=.5,resolutionX:s=ty.AUTO_SIZE,resolutionY:a=ty.AUTO_SIZE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({kernelSize:i,resolutionScale:o,resolutionX:s,resolutionY:a}),this.blurMaterial=new Vb({kernelSize:i,offset:e,rotation:t,focusArea:n,feather:r})}},vy=.001,_y=class{constructor(){this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*vy}get fixedDelta(){return this._fixedDelta*vy}set fixedDelta(e){this._fixedDelta=1e3*e}get elapsed(){return this._elapsed*vy}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.autoReset=!1}},by=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:r=0,frameBufferType:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=null,this.inputBuffer=this.createBuffer(t,n,i,r),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Kb,this.depthTexture=null,this.passes=[],this.timer=new _y,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){const t=e.getSize(new Wt),n=e.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===ge&&e.outputEncoding===yt&&(this.inputBuffer.texture.encoding=yt,this.outputBuffer.texture.encoding=yt,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const i of this.passes)i.initialize(e,n,r)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.renderer,r=n.domElement.parentNode;return this.setRenderer(e),t&&null!==r&&(r.removeChild(n.domElement),r.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new da;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Oe,e.type=Me):e.type=Te,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,r){const i=this.renderer,o=null===i?new Wt:i.getDrawingBufferSize(new Wt),s={minFilter:pe,magFilter:pe,stencilBuffer:t,depthBuffer:e,type:n},a=new gn(o.width,o.height,s);return r>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=r),n===ge&&null!==i&&i.outputEncoding===yt&&(a.texture.encoding=yt),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new Wt),o=r.getContext().getContextAttributes().alpha,s=this.inputBuffer.texture.type;if(e.setRenderer(r),e.setSize(i.width,i.height),e.initialize(r,o,s),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){const t=this.createDepthTexture();for(e of n)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(-1!==n&&t.splice(n,1).length>0){if(null!==this.depthTexture){const n=(e,t)=>e||t.needsDepthTexture;t.reduce(n,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let r,i,o,s=this.inputBuffer,a=this.outputBuffer,l=!1;void 0===e&&(this.timer.update(),e=this.timer.delta);for(const c of this.passes)c.enabled&&(c.render(t,s,a,e,l),c.needsSwap&&(l&&(n.renderToScreen=c.renderToScreen,r=t.getContext(),i=t.state.buffers.stencil,i.setFunc(r.NOTEQUAL,1,4294967295),n.render(t,s,a,e,l),i.setFunc(r.EQUAL,1,4294967295)),o=s,s=a,a=o),c instanceof dy?l=!0:c instanceof Jb&&(l=!1))}setSize(e,t,n){const r=this.renderer,i=r.getSize(new Wt);(void 0===e||void 0===t)&&(e=i.width,t=i.height),(i.width!==e||i.height!==t)&&r.setSize(e,t,n);const o=r.getDrawingBufferSize(new Wt);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const s of this.passes)s.setSize(o.width,o.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},yy=class{constructor(){this.shaderParts=new Map([[Ab.FRAGMENT_HEAD,null],[Ab.FRAGMENT_MAIN_UV,null],[Ab.FRAGMENT_MAIN_IMAGE,null],[Ab.VERTEX_HEAD,null],[Ab.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Rb.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=bt}},Ty=class extends Set{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;super(),this.l=t,this.exclusive=!1,void 0!==e&&this.set(e)}get layer(){return this.l}set layer(e){const t=this.l;for(const n of this)n.layers.disable(t),n.layers.enable(e);this.l=e}getLayer(){return this.layer}setLayer(e){this.layer=e}isExclusive(){return this.exclusive}setExclusive(e){this.exclusive=e}clear(){const e=this.layer;for(const t of this)t.layers.disable(e);return super.clear()}set(e){this.clear();for(const t of e)this.add(t);return this}indexOf(e){return this.has(e)?0:-1}add(e){return this.exclusive?e.layers.set(this.layer):e.layers.enable(this.layer),super.add(e)}delete(e){return this.has(e)&&e.layers.disable(this.layer),super.delete(e)}toggle(e){let t;return this.has(e)?(this.delete(e),t=!1):(this.add(e),t=!0),t}setVisible(e){for(const t of this)e?t.layers.enable(0):t.layers.disable(0);return this}},Ey=new Map([[kb.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}"],[kb.ALPHA,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}"],[kb.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}"],[kb.COLOR,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.COLOR_BURN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}"],[kb.COLOR_DODGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}"],[kb.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}"],[kb.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}"],[kb.DIVIDE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}"],[kb.DST,null],[kb.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}"],[kb.HARD_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}"],[kb.HARD_MIX,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}"],[kb.HUE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.INVERT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}"],[kb.INVERT_RGB,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}"],[kb.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}"],[kb.LINEAR_BURN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}"],[kb.LINEAR_DODGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}"],[kb.LINEAR_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}"],[kb.LUMINOSITY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}"],[kb.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}"],[kb.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}"],[kb.OVERLAY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}"],[kb.PIN_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}"],[kb.REFLECT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}"],[kb.SATURATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}"],[kb.SOFT_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}"],[kb.SRC,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}"],[kb.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}"],[kb.VIVID_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}"]]),Sy=class extends Lt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this._blendFunction=e,this.opacity=new Ah(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Ey.get(this.blendFunction)}},wy=class extends Lt{constructor(e,t){let{attributes:n=Rb.NONE,blendFunction:r=kb.NORMAL,defines:i=new Map,uniforms:o=new Map,extensions:s=null,vertexShader:a=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=a,this.defines=i,this.uniforms=o,this.extensions=s,this.blendMode=new Sy(r),this.blendMode.addEventListener("change",(e=>this.setChanged())),this._inputColorSpace=bt,this._outputColorSpace=null}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof gn||t instanceof Pr||t instanceof fn||t instanceof Yb)&&this[e].dispose()}}};new yn,new Jn;new ln;var xy=class extends wy{constructor(e,t){let{blendFunction:n=kb.SCREEN,patternTexture:r=null,patternScale:i=1,edgeStrength:o=1,pulseSpeed:s=0,visibleEdgeColor:a=16777215,hiddenEdgeColor:l=2230538,kernelSize:c=Lb.VERY_SMALL,blur:u=!1,xRay:h=!0,multisampling:d=0,resolutionScale:p=.5,width:f=ty.AUTO_SIZE,height:m=ty.AUTO_SIZE,resolutionX:g=f,resolutionY:v=m}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("OutlineEffect","uniform lowp sampler2D edgeTexture;uniform lowp sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;\n#ifdef USE_PATTERN\nuniform lowp sampler2D patternTexture;varying vec2 vUvPattern;\n#endif\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;\n#ifndef X_RAY\nedge.y=0.0;\n#endif\nedge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;\n#ifdef USE_PATTERN\nvec4 patternColor=texelToLinear(texture2D(patternTexture,vUvPattern));\n#ifdef X_RAY\nfloat hiddenFactor=0.5;\n#else\nfloat hiddenFactor=0.0;\n#endif\nvisibilityFactor=(1.0-mask.y>0.0)?1.0:hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;\n#endif\nfloat alpha=max(max(edge.x,edge.y),visibilityFactor);\n#ifdef ALPHA\noutputColor=vec4(color,alpha);\n#else\noutputColor=vec4(color,max(alpha,inputColor.a));\n#endif\n}",{uniforms:new Map([["maskTexture",new Ah(null)],["edgeTexture",new Ah(null)],["edgeStrength",new Ah(o)],["visibleEdgeColor",new Ah(new ln(a))],["hiddenEdgeColor",new Ah(new ln(l))],["pulse",new Ah(1)],["patternScale",new Ah(i)],["patternTexture",new Ah(null)]])}),this.blendMode.addEventListener("change",(e=>{this.blendMode.getBlendFunction()===kb.ALPHA?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA"),this.setChanged()})),this.blendMode.setBlendFunction(n),this.patternTexture=r,this.xRay=h,this.scene=e,this.camera=t,this.renderTargetMask=new gn(1,1),this.renderTargetMask.samples=d,this.renderTargetMask.texture.name="Outline.Mask",this.uniforms.get("maskTexture").value=this.renderTargetMask.texture,this.renderTargetOutline=new gn(1,1,{depthBuffer:!1}),this.renderTargetOutline.texture.name="Outline.Edges",this.uniforms.get("edgeTexture").value=this.renderTargetOutline.texture,this.clearPass=new Qb,this.clearPass.overrideClearColor=new ln(0),this.clearPass.overrideClearAlpha=1,this.depthPass=new oy(e,t),this.maskPass=new iy(e,t,new Bb(this.depthPass.texture,t));const _=this.maskPass.clearPass;_.overrideClearColor=new ln(16777215),_.overrideClearAlpha=1,this.blurPass=new uy({resolutionScale:p,resolutionX:g,resolutionY:v,kernelSize:c}),this.blurPass.enabled=u;const b=this.blurPass.resolution;b.addEventListener("change",(e=>this.setSize(b.baseWidth,b.baseHeight))),this.outlinePass=new my(new Gb);this.outlinePass.fullscreenMaterial.inputBuffer=this.renderTargetMask.texture,this.time=0,this.active=!1,this.selection=new Ty,this.selection.layer=10,this.pulseSpeed=s}set mainScene(e){this.scene=e,this.depthPass.mainScene=e,this.maskPass.mainScene=e}set mainCamera(e){this.camera=e,this.depthPass.mainCamera=e,this.maskPass.mainCamera=e,this.maskPass.overrideMaterial.copyCameraSettings(e)}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.getResolution()}get multisampling(){return this.renderTargetMask.samples}set multisampling(e){this.renderTargetMask.samples=e,this.renderTargetMask.dispose()}get patternScale(){return this.uniforms.get("patternScale").value}set patternScale(e){this.uniforms.get("patternScale").value=e}get edgeStrength(){return this.uniforms.get("edgeStrength").value}set edgeStrength(e){this.uniforms.get("edgeStrength").value=e}get visibleEdgeColor(){return this.uniforms.get("visibleEdgeColor").value}set visibleEdgeColor(e){this.uniforms.get("visibleEdgeColor").value=e}get hiddenEdgeColor(){return this.uniforms.get("hiddenEdgeColor").value}set hiddenEdgeColor(e){this.uniforms.get("hiddenEdgeColor").value=e}getBlurPass(){return this.blurPass}getSelection(){return this.selection}getPulseSpeed(){return this.pulseSpeed}setPulseSpeed(e){this.pulseSpeed=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get selectionLayer(){return this.selection.layer}set selectionLayer(e){this.selection.layer=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get blur(){return this.blurPass.enabled}set blur(e){this.blurPass.enabled=e}get xRay(){return this.defines.has("X_RAY")}set xRay(e){this.xRay!==e&&(e?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY"),this.setChanged())}isXRayEnabled(){return this.xRay}setXRayEnabled(e){this.xRay=e}get patternTexture(){return this.uniforms.get("patternTexture").value}set patternTexture(e){if(null!==e?(e.wrapS=e.wrapT=ae,this.defines.set("USE_PATTERN","1"),this.setVertexShader("uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}")):(this.defines.delete("USE_PATTERN"),this.setVertexShader(null)),null!==this.renderer){const t=Ib(e,this.renderer.capabilities.isWebGL2);this.defines.set("texelToLinear(texel)",t)}this.uniforms.get("patternTexture").value=e,this.setChanged()}setPatternTexture(e){this.patternTexture=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}setSelection(e){return this.selection.set(e),this}clearSelection(){return this.selection.clear(),this}selectObject(e){return this.selection.add(e),this}deselectObject(e){return this.selection.delete(e),this}update(e,t,n){const r=this.scene,i=this.camera,o=this.selection,s=this.uniforms.get("pulse"),a=r.background,l=i.layers.mask;o.size>0?(r.background=null,s.value=1,this.pulseSpeed>0&&(s.value=.375*Math.cos(this.time*this.pulseSpeed*10)+.625),this.active=!0,this.time+=n,o.setVisible(!1),this.depthPass.render(e),o.setVisible(!0),i.layers.set(o.layer),this.maskPass.render(e,this.renderTargetMask),i.layers.mask=l,r.background=a,this.outlinePass.render(e,null,this.renderTargetOutline),this.blurPass.enabled&&this.blurPass.render(e,this.renderTargetOutline,this.renderTargetOutline)):this.active&&(this.clearPass.render(e,this.renderTargetOutline),this.active=!1)}setSize(e,t){this.blurPass.setSize(e,t),this.renderTargetMask.setSize(e,t);const n=this.resolution;n.setBaseSize(e,t);const r=n.width,i=n.height;this.depthPass.setSize(r,i),this.renderTargetOutline.setSize(r,i),this.outlinePass.fullscreenMaterial.setSize(r,i)}initialize(e,t,n){const r=Ib(this.patternTexture,e.capabilities.isWebGL2);this.defines.set("texelToLinear(texel)",r),this.blurPass.initialize(e,t,ge),void 0!==n&&(this.depthPass.initialize(e,t,n),this.maskPass.initialize(e,t,n),this.outlinePass.initialize(e,t,n))}},My=.5*Math.PI,Cy=new yn,Iy=new yn;let ky;const Ry=e=>(e=>!!e.current)(e)?e.current:e,Ay=function(t,n){return void 0===n&&(n=kb.NORMAL),(0,e.forwardRef)((function(r,i){let{blendFunction:o,opacity:s,...a}=r;const l=yp((e=>e.invalidate)),c=(0,e.useMemo)((()=>new t(a)),[a]);return(0,e.useLayoutEffect)((()=>{c.blendMode.blendFunction=o||0===o?o:n,void 0!==s&&(c.blendMode.opacity.value=s),l()}),[o,c.blendMode,s]),Ld("primitive",{ref:i,object:c,dispose:null})}))};Ay(class extends wy{constructor(){let{blendFunction:e=kb.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,mipmapBlur:r=!1,intensity:i=1,radius:o=.85,levels:s=8,kernelSize:a=Lb.LARGE,resolutionScale:l=.5,width:c=ty.AUTO_SIZE,height:u=ty.AUTO_SIZE,resolutionX:h=c,resolutionY:d=u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}",{blendFunction:e,uniforms:new Map([["map",new Ah(null)],["intensity",new Ah(i)]])}),this.renderTarget=new gn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new uy({kernelSize:a}),this.luminancePass=new hy({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new py,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=o,this.mipmapBlurPass.levels=s,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const p=this.resolution=new ty(this,h,d,l);p.addEventListener("change",(e=>this.setSize(p.baseWidth,p.baseHeight)))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,i.renderTarget):this.blurPass.render(e,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,r)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,n){this.blurPass.initialize(e,t,n),this.luminancePass.initialize(e,t,n),this.mipmapBlurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},kb.ADD),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,brightness:t=0,contrast:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(color+vec3(0.5),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new Ah(t)],["contrast",new Ah(n)]])}),this.inputColorSpace=yt}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}}),Ay(class extends wy{constructor(){let{blendFunction:e,bits:t=16}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ColorDepthEffect","uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}",{blendFunction:e,uniforms:new Map([["factor",new Ah(1)]])}),this.bits=0,this.bitDepth=t}get bitDepth(){return this.bits}set bitDepth(e){this.bits=e,this.uniforms.get("factor").value=Math.pow(2,e/3)}getBitDepth(){return this.bitDepth}setBitDepth(e){this.bitDepth=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,inverted:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DepthEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\n#ifdef INVERTED\nvec3 color=vec3(1.0-depth);\n#else\nvec3 color=vec3(depth);\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,attributes:Rb.DEPTH}),this.inverted=t}get inverted(){return this.defines.has("INVERTED")}set inverted(e){this.inverted!==e&&(e?this.defines.set("INVERTED","1"):this.defines.delete("INVERTED"),this.setChanged())}isInverted(){return this.inverted}setInverted(e){this.inverted=e}});const Ly=(0,e.createContext)(null),Oy=e.memo((0,e.forwardRef)(((t,n)=>{let{children:r,camera:i,scene:o,resolutionScale:s,enabled:a=!0,renderPriority:l=1,autoClear:c=!0,depthBuffer:u,disableNormalPass:h,stencilBuffer:d,multisampling:p=8,frameBufferType:f=Se}=t;const{gl:m,scene:g,camera:v,size:_}=yp();o=o||g,i=i||v;const[b,y,T]=(0,e.useMemo)((()=>{const e=function(){if(void 0!==ky)return ky;try{var e;let t;const n=document.createElement("canvas");return ky=!(!window.WebGL2RenderingContext||!(t=n.getContext("webgl2"))),t&&(null===(e=t.getExtension("WEBGL_lose_context"))||void 0===e||e.loseContext()),ky}catch{return ky=!1}}(),t=new by(m,{depthBuffer:u,stencilBuffer:d,multisampling:p>0&&e?p:0,frameBufferType:f});t.addPass(new iy(o,i));let n=null,r=null;return h||(r=new fy(o,i),r.enabled=!1,t.addPass(r),void 0!==s&&e&&(n=new sy({normalBuffer:r.texture,resolutionScale:s}),n.enabled=!1,t.addPass(n))),[t,r,n]}),[i,m,u,d,p,f,o,h,s]);(0,e.useEffect)((()=>null==b?void 0:b.setSize(_.width,_.height)),[b,_]),Tp(((e,t)=>{a&&(m.autoClear=c,b.render(t))}),a?l:0);const E=(0,e.useRef)(null);(0,e.useLayoutEffect)((()=>{let e;return E.current&&E.current.__r3f&&b&&(e=new cy(i,...E.current.__r3f.objects),e.renderToScreen=!0,b.addPass(e),y&&(y.enabled=!0),T&&(T.enabled=!0)),()=>{e&&(null==b||b.removePass(e)),y&&(y.enabled=!1),T&&(T.enabled=!1)}}),[b,r,i,y,T]);const S=(0,e.useMemo)((()=>({composer:b,normalPass:y,downSamplingPass:T,resolutionScale:s,camera:i,scene:o})),[b,y,T,s,i,o]);return(0,e.useImperativeHandle)(n,(()=>b),[b]),Ld(Ly.Provider,{value:S,children:Ld("group",{ref:E,children:r})})})));Ay(class extends wy{constructor(){let{blendFunction:e,angle:t=.5*Math.PI,scale:n=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DotScreenEffect","uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}",{blendFunction:e,uniforms:new Map([["angle",new Ah(new Wt)],["scale",new Ah(n)]])}),this.angle=t}get angle(){return Math.acos(this.uniforms.get("angle").value.y)}set angle(e){this.uniforms.get("angle").value.set(Math.sin(e),Math.cos(e))}getAngle(){return this.angle}setAngle(e){this.angle=e}get scale(){return this.uniforms.get("scale").value}set scale(e){this.uniforms.get("scale").value=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,hue:t=0,saturation:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new Ah(new yn)],["saturation",new Ah(n)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){const e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){const t=Math.sin(e),n=Math.cos(e);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},kb.COLOR_DODGE);const Ny=(0,e.createContext)(null);function Py(t){let{children:n,enabled:r=!0}=t;const[i,o]=(0,e.useState)([]),s=(0,e.useMemo)((()=>({selected:i,select:o,enabled:r})),[i,o,r]);return e.createElement(Ny.Provider,{value:s},n)}function Dy(t){let{enabled:n=!1,children:r,...i}=t;const o=(0,e.useRef)(null),s=(0,e.useContext)(Ny);return(0,e.useEffect)((()=>{if(s&&n){let e=!1;const t=[];if(o.current.traverse((n=>{"Mesh"===n.type&&t.push(n),-1===s.selected.indexOf(n)&&(e=!0)})),e)return s.select((e=>[...e,...t])),()=>{s.select((e=>e.filter((e=>!t.includes(e)))))}}}),[n,r]),Ld("group",{ref:o,...i,children:r})}const $y=(0,e.forwardRef)((function(t,n){let{selection:r=[],selectionLayer:i=10,blendFunction:o,patternTexture:s,edgeStrength:a,pulseSpeed:l,visibleEdgeColor:c,hiddenEdgeColor:u,width:h,height:d,kernelSize:p,blur:f,xRay:m,...g}=t;const v=yp((e=>e.invalidate)),{scene:_,camera:b}=(0,e.useContext)(Ly),y=(0,e.useMemo)((()=>new xy(_,b,{blendFunction:o,patternTexture:s,edgeStrength:a,pulseSpeed:l,visibleEdgeColor:c,hiddenEdgeColor:u,width:h,height:d,kernelSize:p,blur:f,xRay:m,...g})),[o,f,b,a,d,u,p,s,l,_,c,h,m]),T=(0,e.useContext)(Ny);return(0,e.useEffect)((()=>{if(!T&&r)return y.selection.set(Array.isArray(r)?r.map(Ry):[Ry(r)]),v(),()=>{y.selection.clear(),v()}}),[y,r,T]),(0,e.useEffect)((()=>{y.selectionLayer=i,v()}),[y,i]),(0,e.useRef)(),(0,e.useEffect)((()=>{var e;if(T&&T.enabled&&(null!=(e=T.selected)&&e.length))return y.selection.set(T.selected),v(),()=>{y.selection.clear(),v()}}),[T]),Ld("primitive",{ref:n,object:y})}));Ay(class extends wy{constructor(){let{blendFunction:e=kb.OVERLAY,density:t=1.25,scrollSpeed:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ScanlineEffect","uniform float count;\n#ifdef SCROLL\nuniform float scrollSpeed;\n#endif\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float y=uv.y;\n#ifdef SCROLL\ny+=time*scrollSpeed;\n#endif\nvec2 sl=vec2(sin(y*count),cos(y*count));outputColor=vec4(sl.xyx,inputColor.a);}",{blendFunction:e,uniforms:new Map([["count",new Ah(0)],["scrollSpeed",new Ah(0)]])}),this.resolution=new Wt,this.d=t,this.scrollSpeed=n}get density(){return this.d}set density(e){this.d=e,this.setSize(this.resolution.width,this.resolution.height)}getDensity(){return this.density}setDensity(e){this.density=e}get scrollSpeed(){return this.uniforms.get("scrollSpeed").value}set scrollSpeed(e){this.uniforms.get("scrollSpeed").value=e,0===e?this.defines.delete("SCROLL")&&this.setChanged():this.defines.has("SCROLL")||(this.defines.set("SCROLL","1"),this.setChanged())}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("count").value=Math.round(t*this.density)}},kb.OVERLAY),Ay(class extends wy{constructor(){let{blendFunction:e,intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SepiaEffect","uniform vec3 weightsR;uniform vec3 weightsG;uniform vec3 weightsB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,weightsR),dot(inputColor.rgb,weightsG),dot(inputColor.rgb,weightsB));outputColor=vec4(color,inputColor.a);}",{blendFunction:e,uniforms:new Map([["weightsR",new Ah(new yn(.393,.769,.189))],["weightsG",new Ah(new yn(.349,.686,.168))],["weightsB",new Ah(new yn(.272,.534,.131))]])})}get intensity(){return this.blendMode.opacity.value}set intensity(e){this.blendMode.opacity.value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}get weightsR(){return this.uniforms.get("weightsR").value}get weightsG(){return this.uniforms.get("weightsG").value}get weightsB(){return this.uniforms.get("weightsB").value}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,adaptive:t=!0,mode:n=(t?Ob.REINHARD2_ADAPTIVE:Ob.REINHARD2),resolution:r=256,maxLuminance:i=16,whitePoint:o=i,middleGrey:s=.6,minLuminance:a=.01,averageLuminance:l=1,adaptationRate:c=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ToneMappingEffect","#include <tonemapping_pars_fragment>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\nuniform lowp sampler2D luminanceBuffer;uniform float whitePoint;uniform float middleGrey;\n#if TONE_MAPPING_MODE != 2\nuniform float averageLuminance;\n#endif\nvec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=luminance(color);\n#if TONE_MAPPING_MODE == 2\nfloat lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));\n#else\nfloat lumAvg=averageLuminance;\n#endif\nfloat lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){\n#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2\noutputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);\n#else\noutputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);\n#endif\n}",{blendFunction:e,uniforms:new Map([["luminanceBuffer",new Ah(null)],["maxLuminance",new Ah(i)],["whitePoint",new Ah(o)],["middleGrey",new Ah(s)],["averageLuminance",new Ah(l)]])}),this.renderTargetLuminance=new gn(1,1,{minFilter:me,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new hy({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new qb(this.luminancePass.texture,{minLuminance:a,adaptationRate:c}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=r,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case Ob.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case Ob.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case Ob.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel")}this.adaptiveLuminancePass.enabled=e===Ob.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===Ob.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?Ob.REINHARD2_ADAPTIVE:Ob.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}}),Ay(class extends wy{constructor(){let{blendFunction:e,technique:t=Nb.DEFAULT,eskil:n=!1,offset:r=.5,darkness:i=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ah(r)],["darkness",new Ah(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Nb.ESKIL}set eskil(e){this.technique=e?Nb.ESKIL:Nb.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}}),Ay(class extends wy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,{speed:n=2,maxRadius:r=1,waveSize:i=.2,amplitude:o=.05}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("ShockWaveEffect","uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}",{vertexShader:"uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}",uniforms:new Map([["active",new Ah(!1)],["center",new Ah(new Wt(.5,.5))],["cameraDistance",new Ah(1)],["size",new Ah(1)],["radius",new Ah(-i)],["maxRadius",new Ah(r)],["waveSize",new Ah(i)],["amplitude",new Ah(o)]])}),this.position=t,this.speed=n,this.camera=e,this.screenPosition=this.uniforms.get("center").value,this.time=0,this.active=!1}set mainCamera(e){this.camera=e}get amplitude(){return this.uniforms.get("amplitude").value}set amplitude(e){this.uniforms.get("amplitude").value=e}get waveSize(){return this.uniforms.get("waveSize").value}set waveSize(e){this.uniforms.get("waveSize").value=e}get maxRadius(){return this.uniforms.get("maxRadius").value}set maxRadius(e){this.uniforms.get("maxRadius").value=e}get epicenter(){return this.position}set epicenter(e){this.position=e}getPosition(){return this.position}setPosition(e){this.position=e}getSpeed(){return this.speed}setSpeed(e){this.speed=e}explode(){this.time=0,this.active=!0,this.uniforms.get("active").value=!0}update(e,t,n){const r=this.position,i=this.camera,o=this.uniforms,s=o.get("active");if(this.active){const e=o.get("waveSize").value;i.getWorldDirection(Cy),Iy.copy(i.position).sub(r),s.value=Cy.angleTo(Iy)>My,s.value&&(o.get("cameraDistance").value=i.position.distanceTo(r),Cy.copy(r).project(i),this.screenPosition.set(.5*(Cy.x+1),.5*(Cy.y+1))),this.time+=n*this.speed;const t=this.time-e;o.get("radius").value=t,t>=2*(o.get("maxRadius").value+e)&&(this.active=!1,s.value=!1)}}}),Ay(class extends wy{constructor(){let{blendFunction:e,offset:t=0,rotation:n=0,focusArea:r=.4,feather:i=.3,kernelSize:o=Lb.MEDIUM,resolutionScale:s=.5,resolutionX:a=ty.AUTO_SIZE,resolutionY:l=ty.AUTO_SIZE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("TiltShiftEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform vec2 maskParams;varying vec2 vUv2;float linearGradientMask(const in float x){return step(maskParams.x,x)-step(maskParams.y,x);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float mask=linearGradientMask(vUv2.y);vec4 texel=texture2D(map,uv);outputColor=mix(texel,inputColor,mask);}",{vertexShader:"uniform vec2 rotation;varying vec2 vUv2;void mainSupport(const in vec2 uv){vUv2=(uv-0.5)*2.0*vec2(aspect,1.0);vUv2=vec2(dot(rotation,vUv2),dot(rotation,vec2(vUv2.y,-vUv2.x)));}",blendFunction:e,uniforms:new Map([["rotation",new Ah(new Wt)],["maskParams",new Ah(new Wt)],["map",new Ah(null)]])}),this._offset=t,this._focusArea=r,this._feather=i,this.renderTarget=new gn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="TiltShift.Target",this.uniforms.get("map").value=this.renderTarget.texture,this.blurPass=new gy({kernelSize:o,resolutionScale:s,resolutionX:a,resolutionY:l,offset:t,rotation:n,focusArea:r,feather:i});const c=this.resolution=new ty(this,a,l,s);c.addEventListener("change",(e=>this.setSize(c.baseWidth,c.baseHeight))),this.rotation=n,this.updateParams()}updateParams(){const e=this.uniforms.get("maskParams").value,t=Math.max(this.focusArea-this.feather,0);e.set(this.offset-t,this.offset+t)}get rotation(){return Math.acos(this.uniforms.get("rotation").value.x)}set rotation(e){this.uniforms.get("rotation").value.set(Math.cos(e),Math.sin(e)),this.blurPass.blurMaterial.rotation=e}get offset(){return this._offset}set offset(e){this._offset=e,this.blurPass.blurMaterial.offset=e,this.updateParams()}get focusArea(){return this._focusArea}set focusArea(e){this._focusArea=e,this.blurPass.blurMaterial.focusArea=e,this.updateParams()}get feather(){return this._feather}set feather(e){this._feather=e,this.blurPass.blurMaterial.feather=e,this.updateParams()}get bias(){return 0}set bias(e){}update(e,t,n){this.blurPass.render(e,t,this.renderTarget)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n)}initialize(e,t,n){this.blurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},kb.ADD);const By=["cube","cylinder","sphere","capsule","arrow"],Fy=(0,e.createContext)(),Uy=e=>{let{meshes:t,children:n}=e;return Ld(Fy.Provider,{value:t,children:n})},zy=(0,e.memo)((0,e.forwardRef)(((t,n)=>{let{objectKey:r,highlightColor:i,position:o,rotation:s,scale:a,ghost:l}=t;const c=Tb(n,(0,e.useRef)(null)),u=N_((e=>e.onClick),Eb),h=N_((e=>e.onPointerOver),Eb),d=N_((e=>e.onPointerOut),Eb),p=N_((e=>e.clock)),f=N_((0,e.useCallback)((e=>e.items[r]),[r]),Eb),m=(t=>{const n=(0,e.useContext)(Fy)[t.shape];return By.includes(t.shape)?yb(t):n&&"function"==typeof n?n():(console.warn("Shape not loaded: ".concat(t.shape," (reading property 'shape' of item)"),t),[])})(f);return Tp((0,e.useCallback)((()=>{const e=1e3*p.getElapsed();c.current&&(c.current.position.set(o?o.x:"function"==typeof f.position.x?f.position.x(e):f.position.x,o?o.y:"function"==typeof f.position.y?f.position.y(e):f.position.y,o?o.z:"function"==typeof f.position.z?f.position.z(e):f.position.z),c.current.quaternion.set(s?s.x:"function"==typeof f.rotation.x?f.rotation.x(e):f.rotation.x,s?s.y:"function"==typeof f.rotation.y?f.rotation.y(e):f.rotation.y,s?s.z:"function"==typeof f.rotation.z?f.rotation.z(e):f.rotation.z,s?s.w:"function"==typeof f.rotation.w?f.rotation.w(e):f.rotation.w),c.current.scale.set(a?a.x:"function"==typeof f.scale.x?f.scale.x(e):f.scale.x,a?a.y:"function"==typeof f.scale.y?f.scale.y(e):f.scale.y,a?a.z:"function"==typeof f.scale.z?f.scale.z(e):f.scale.z),c.current.visible="function"==typeof f.hidden?!f.hidden(e):!f.hidden)}),[f,o,s,a,c,p])),Ld(Dy,{enabled:f.highlighted,children:Od("group",{ref:c,up:[0,0,1],children:[Ld("group",{up:[0,0,1],rotation:[Math.PI/2,0,0],onPointerDown:e=>{u(r,!c.current.visible,{local:{position:c.current.position,rotation:c.current.quaternion},world:{position:c.current.getWorldPosition(new yn),rotation:c.current.getWorldQuaternion(new bn)}},e)},onPointerOver:e=>{h(r,!c.current.visible,e)},onPointerOut:e=>{d(r,!c.current.visible,e)},children:m.map(((e,t)=>Ld(Gy,{idx:t,groupOrPart:e,objectKey:r,ghost:l,highlightColor:i},t)))}),f.showName&&Ld(Mf,{distanceFactor:3,position:[0,0,.2],children:Ld("div",{style:{opacity:.75,borderRadius:2,backgroundColor:"lightgrey",padding:5,userSelect:"none"},children:f.name})})]})})}))),Hy=(0,e.memo)((t=>{let{part:n,objectKey:r,ghost:i,highlightColor:o}=t;const s=N_((0,e.useCallback)((e=>e.items[r].wireframe),[r])),a=N_((0,e.useCallback)((e=>e.items[r].color),[r])),l=void 0!==a,c=(0,e.useRef)(),u=(0,e.useRef)(),h=N_((e=>e.clock));return Tp((0,e.useCallback)((()=>{const e=1e3*h.getElapsed();i||(bb(u,a,e),bb(c,a,e))}),[i,c,u,h,a])),i?Ld("mesh",{ref:u,geometry:n.geometry,material:F_(o),scale:n.scale,castShadow:!1,receiveShadow:!1},"B"):l?Od("group",{up:[0,0,1],children:[Ld("mesh",{ref:u,geometry:n.geometry,scale:n.scale,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,wireframe:s,attach:"material",opacity:1,side:f})},"B"),Ld("mesh",{ref:c,geometry:n.geometry,scale:n.scale,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,attach:"material",wireframe:s,opacity:1,side:p})},"F")]}):Ld(Ad,{children:Ld("mesh",{ref:c,geometry:n.geometry,material:n.material,scale:n.scale,castShadow:!0,receiveShadow:!0,wireframe:s},"I")})})),Gy=(0,e.memo)((e=>{let{idx:t,groupOrPart:n,ghost:r,objectKey:i,highlightColor:o}=e;return"group"===n.type?Ld("group",{up:[0,0,1],position:n.position,rotation:n.rotation,scale:n.scale,children:n.children.map(((e,t)=>Ld(Gy,{idx:t,groupOrPart:e,objectKey:i,ghost:r,highlightColor:o},t)))},t):Ld(Hy,{part:n,objectKey:i,highlightColor:o,ghost:r},t)})),Vy=(0,e.forwardRef)(((t,n)=>{let{objectKey:r}=t;const i=Tb(n,(0,e.useRef)(null)),{vertices:o,width:s,hidden:a}=N_((0,e.useCallback)((e=>({vertices:e.lines[r].vertices,width:e.lines[r].width,hidden:e.lines[r].hidden})),[r]),Eb);return o.length<=1?null:Ld(_m,{ref:i,visible:!a,points:o.map((e=>[e.position.x,e.position.y,e.position.z])),color:"white",vertexColors:o.map((e=>[e.color.r/255,e.color.g/255,e.color.b/255])),lineWidth:s})})),Wy=(0,e.forwardRef)(((t,n)=>{let{objectKey:r}=t;const i=Tb(n,(0,e.useRef)(null)),o=N_((e=>e.onClick),Eb),s=N_((e=>e.onPointerOver),Eb),a=N_((e=>e.onPointerOut),Eb),l=N_((0,e.useCallback)((e=>e.hulls[r]),[r]),Eb),c=N_((0,e.useCallback)((e=>e.hulls[r].vertices),[r]),Eb),u=N_((e=>e.clock)),h=(0,e.useRef)(),d=(0,e.useRef)(),m="function"==typeof c?c(0):c,g=new Bf(m.map((e=>new yn(e.x,e.y,e.z))));return Tp((0,e.useCallback)((()=>{const e=1e3*u.getElapsed();bb(d,l.color,e),bb(h,l.color,e);const t="function"==typeof c?c(e):c;if(t!==m){const e=new Bf(t.map((e=>new yn(e.x,e.y,e.z))));h.current.geometry=e,d.current.geometry=e}const n="function"==typeof l.hidden?!l.hidden(e):!l.hidden;h.current.visible=n,d.current.visible=n}),[h,d,m,l,u,c])),Ld(Dy,{enabled:l.highlighted,children:Od("group",{ref:i,up:[0,0,1],children:[Od("group",{up:[0,0,1],onPointerDown:e=>{o(r,h.current.visible,e)},onPointerOver:e=>{s(r,h.current.visible,e)},onPointerOut:e=>{a(r,h.current.visible,e)},children:[Ld("mesh",{ref:d,geometry:g,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,wireframe:l.wireframe,attach:"material",side:f})},"".concat(r,"B")),Ld("mesh",{ref:h,geometry:g,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,attach:"material",wireframe:l.wireframe,side:p})},"".concat(r,"F"))]}),l.showName&&Ld(Mf,{distanceFactor:2,position:[0,0,.5],children:Ld("div",{style:{opacity:.75,borderRadius:2,backgroundColor:"lightgrey"},className:"disable-text-selection",children:l.name})})]})})})),jy=(0,e.forwardRef)(((t,n)=>{let{objectKey:r}=t;const i=Tb(n,(0,e.useRef)(null)),o=(0,e.useRef)(),s=N_((e=>e.clock)),a=N_((0,e.useCallback)((e=>e.texts[r]),[r]));return Tp((0,e.useCallback)((()=>{const e=1e3*s.getElapsed();i.current&&(i.current.position.set("function"==typeof a.position.x?a.position.x(e):a.position.x,"function"==typeof a.position.y?a.position.y(e):a.position.y,"function"==typeof a.position.z?a.position.z(e):a.position.z),i.current.visible="function"==typeof a.hidden?!a.hidden(e):!a.hidden),o.current&&bb(o,a.color,e)}),[a,i,s])),Ld("group",{ref:i,children:Ld(vm,{follow:!0,children:Ld(Ng,{ref:o,depthOffset:2,scale:[.2,.2,.2],children:a.value})})})})),Xy=(0,e.forwardRef)(((t,n)=>{let{objectKey:r}=t;const i=Tb(n,(0,e.useRef)(null)),o=N_((e=>e.clock)),{points:s,scale:a,hidden:l}=N_((0,e.useCallback)((e=>({points:e.points[r].points,scale:e.points[r].scale,hidden:e.points[r].hidden})),[r]),Eb),[{positions:c,colors:u}]=(0,e.useState)((()=>({positions:new Float32Array(3*s.length),colors:new Float32Array(3*s.length)})));return Tp((()=>{const e=1e3*o.getElapsed();if(i.current)for(let t=0;t<s.length;t++){let n=3*t;c[n]="function"==typeof s[t].position.x?s[t].position.x(e):s[t].position.x,c[n+1]="function"==typeof s[t].position.y?s[t].position.y(e):s[t].position.y,c[n+2]="function"==typeof s[t].position.z?s[t].position.z(e):s[t].position.z,u[n]="function"==typeof s[t].color.r?s[t].color.r(e)/255:s[t].color.r/255,u[n+1]="function"==typeof s[t].color.g?s[t].color.g(e)/255:s[t].color.g/255,u[n+2]="function"==typeof s[t].color.b?s[t].color.b(e)/255:s[t].color.b/255}})),s.length<=1?null:Ld(mv,{ref:i,hidden:l,positions:c,colors:u,children:Ld(sv,{transparent:!0,vertexColors:!0,sizeAttenuation:!0,depthWrite:!0,size:.1*a})})})),Yy=(0,e.memo)((e=>{let{activeTf:t,displayTfs:n,allTfs:r,allItems:i,allLines:o,allHulls:s,allTexts:a,allPoints:l,highlightColor:c,ghosts:u,targetRef:h,targetId:d,targetSource:p,filterActive:f,tfFilter:m,customProps:g}=e;const v="world"===t?wb:"gizmo"===t?xb:Sb,_=t===d?g:{},b=f?r.filter((e=>m.includes(e.key))):r,y=f&&t!==h;return Od(v,{objectKey:t,displayTfs:n,ref:d===t?h:null,..._,ghost:u,highlightColor:c,children:[b.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>Ld(Yy,{activeTf:e.key,displayTfs:n,allTfs:r,allItems:i,allLines:o,allHulls:s,allTexts:a,allPoints:l,highlightColor:c,ghosts:u,targetRef:h,targetSource:p,targetId:d,filterActive:y,tfFilter:m,customProps:g},e.key))),i.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"items"===p?g:{};return f&&e.key!==d&&t!==d?null:Ld(zy,{objectKey:e.key,highlightColor:c,ghost:u,ref:e.key===d?h:null,...n},e.key)})),o.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"lines"===p?g:{};return f&&e.key!==d&&t!==d?null:Ld(Vy,{objectKey:e.key,ref:e.lineKey===d?h:null,...n},e.key)})),s.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"hulls"===p?g:{};return f&&e.key!==d&&t!==d?null:Ld(Wy,{objectKey:e.key,highlightColor:c,ghost:u,ref:e.key===d?h:null,...n},e.key)})),a.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"texts"===p?g:{};return f&&e.key!==d&&t!==d?null:Ld(jy,{objectKey:e.key,highlightColor:c,ref:e.key===d?h:null,...n},e.key)})),l.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"points"===p?g:{};return f&&e.key!==d&&t!==d?null:Ld(Xy,{objectKey:e.key,highlightColor:c,ref:e.key===d?h:null,...n},e.key)}))]})})),Ky=["enabled","axis","translationSnap","rotationSnap","scaleSnap","space","size"],qy=["displayTfs","allTfs","allItems","allLines","allHulls","allTexts","allPoints","highlightColor"],Jy=(0,e.memo)((t=>{let{camera:n,objectInfo:r,highlightColor:i,translateSnap:o,rotateSnap:s,scaleSnap:a,onDragStart:l,onDragEnd:c,mode:u,...h}=t;const d=rv(h,Ky),p=rv(h,qy),f=N_((0,e.useCallback)((e=>{let t=[];"tfs"===r.source&&t.push(r.key);let n=e[r.source][r.key].frame;for(;n&&"world"!==n&&"gizmo"!==n;){let r=e.tfs[n];t.push(n),n=r.frame}return t}),[r]),Eb),m=(0,e.useRef)(),g=(0,e.useRef)(),v=N_((e=>rv(e[r.source][r.key],["position","rotation","scale"])),Eb),_=yp((e=>{let{gl:t}=e;return t})),b=yp((e=>{let{camera:t}=e;return t})),y=yp((e=>{let{invalidate:t}=e;return t})),T=n||b,[E]=(0,e.useState)((()=>new K_(T,_.domElement)));E.translationSnap=o,E.rotationSnap=s,E.scaleSnap=a,null!=u&&u.includes("translate")?E.mode="translate":null!=u&&u.includes("rotate")?E.mode="rotate":null!=u&&u.includes("scale")&&(E.mode="scale"),null!=u&&u.includes("-x")?(E.showY=!1,E.showZ=!1):null!=u&&u.includes("-y")?(E.showX=!1,E.showZ=!1):null!=u&&u.includes("-z")&&(E.showX=!1,E.showY=!1);const[S,w]=(0,e.useState)(!1),[x,M]=(0,e.useState)(v),[C,I]=(0,e.useState)(!1);(0,e.useEffect)((()=>{console.log("refreshing transform"),M(v)}),[v,C]);const k=N_((e=>e.onMove),Eb);return(0,e.useEffect)((()=>{const e=e=>{var t,n,i;const o=null==(t=null==g?void 0:g.current)?void 0:t.position,s=null==(n=null==g?void 0:g.current)?void 0:n.quaternion,a=null==(i=null==g?void 0:g.current)?void 0:i.scale;e.value&&!S?(console.log("starting transform"),w(!0),M({position:o,rotation:s,scale:a}),l&&l()):!e.value&&S&&(console.log("stopping transform"),w(!1),c&&c(),k(r.key,r.source,{position:E.worldPosition,quaternion:E.worldQuaternion,scale:E._worldScale},{position:o?{x:o.x,y:o.y,z:o.z}:null,quaternion:s?{x:s.x,y:s.y,z:s.z,w:s.w}:null,scale:a?{x:a.x,y:a.y,z:a.z}:null}),I(!C))};return E&&E.addEventListener("dragging-changed",e),()=>{E.removeEventListener("dragging-changed",e)}}),[v,S,r]),(0,e.useEffect)((()=>{null==E||E.attach(g.current)}),[g,E]),(0,e.useEffect)((()=>(E&&E.addEventListener("change",y),()=>{var e;return null==(e=null==E?void 0:E.removeEventListener)?void 0:e.call(E,"change",y)})),[E,y]),E?Od(Ad,{children:[Ld("primitive",{ref:m,object:E,...d}),Ld(Yy,{...p,activeTf:"world",tfFilter:f,ghosts:!0,targetRef:g,targetSource:r.source,targetId:r.key,filterActive:!0,customProps:{...x}})]}):null})),Zy=(e,t)=>e.length===t.length&&!e.some(((e,n)=>!k_.exports.isEqual(t[n],e)));function Qy(t){let{displayTfs:n=!1,displayGrid:r=!0,isPolar:i=!1,backgroundColor:o="#d0d0d0",planeColor:s="#a8a8a8",highlightColor:a="#00ffff",plane:l=0,translateSnap:c=0,rotateSnap:u=0,scaleSnap:h=0,debug:d=!1}=t;d&&console.log("content rerender");const p=yp((e=>e.camera)),f=N_((e=>e.clock),Eb);Tp((()=>{f.update()}));const m=N_((e=>k_.exports.sortBy(Object.entries(e.tfs).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,transformMode:n.transformMode,source:"tfs"}})),(e=>e.key))),Zy),g=N_((e=>k_.exports.sortBy(Object.entries(e.items).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,transformMode:n.transformMode,source:"items"}})),(e=>e.key))),Zy),v=N_((e=>k_.exports.sortBy(Object.entries(e.lines).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"lines"}})),(e=>e.key))),Zy),_=N_((e=>k_.exports.sortBy(Object.entries(e.hulls).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"hulls"}})),(e=>e.key))),Zy),b=N_((e=>k_.exports.sortBy(Object.entries(e.texts).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"texts"}})),(e=>e.key))),Zy),y=N_((e=>k_.exports.sortBy(Object.entries(e.points).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"points"}})),(e=>e.key))),Zy),T=N_((e=>k_.exports.sortBy(Object.entries(e.widgets).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"widgets"}})),(e=>e.key))),Zy),E=[...g,...m].filter((e=>["translate","rotate","scale","translate-x","translate-y","translate-z","rotate-x","rotate-y","rotate-z","scale-x","scale-y","scale-z"].includes(e.transformMode))),S=(0,e.useRef)(),w=(0,e.useRef)(),x=(0,e.useRef)(),M=(0,e.useRef)(),C=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(s),I=[C.r,C.g,C.b,.5];return Od(e.Fragment,{children:[Ld(iv,{ref:M,makeDefault:!0,camera:p}),Ld("pointLight",{ref:w,intensity:.5,position:[-1,-3,3],color:"#FFFAEE"}),Ld(D_,{ref:S,intensity:.7,color:"white"}),Ld($_,{ref:x,castShadow:!0,position:[5,15,15],intensity:.6,color:"#FFFAEE"}),Ld("spotLight",{penumbra:1,position:[-1,-1,4],intensity:.3,castShadow:!0,color:"#FFFAEE"}),Ld("color",{attach:"background",args:[o]}),Ld("fogExp2",{attach:"fog",args:[o,.01]}),Ld(av,{receiveShadow:!0,scale:1e3,position:[0,0,l-.01],material:B_(...I)}),Od(Py,{children:[Ld(Oy,{autoClear:!1,children:Ld($y,{visibleEdgeColor:a,hiddenEdgeColor:a,blur:!0,kernelSize:1,edgeStrength:50,pulseSpeed:.25,xRay:!0})}),Ld(Yy,{activeTf:"world",displayTfs:n,allTfs:m,allItems:g,allLines:v,allHulls:_,allTexts:b,allPoints:y,allWidgets:T,highlightColor:a})]}),Ld("group",{position:[0,0,l],rotation:[Math.PI/2,0,0],up:[0,0,1],children:r&&(i?Ld("polarGridHelper",{args:[10,16,8,64,"white","gray"]}):Ld("gridHelper",{args:[20,20,"white","gray"]}))}),E.map((e=>Ld(Jy,{objectInfo:e,mode:e.transformMode,displayTfs:n,allTfs:m,allItems:g,allLines:v,allHulls:_,allTexts:b,allPoints:y,allWidgets:T,translateSnap:c,rotateSnap:u,scaleSnap:h,highlightColor:a,onDragEnd:()=>{M.current&&(M.current.enabled=!0)},onDragStart:()=>{M.current&&(M.current.enabled=!1)}},"movableObjectTransform-".concat(e.key))))]})}Er.DefaultUp.set(0,0,1);function eT(t){let{backgroundColor:n="#d0d0d0",store:r,fov:i=60,onPointerMissed:o=(()=>{}),meshLookup:s={},debug:a=!1,...l}=t;return a&&console.log("Scene rerender"),Ld(sf,{camera:{up:[0,0,1],fov:i,position:[0,-3,3]},shadows:!0,style:{background:n||"#d0d0d0"},onPointerMissed:o||(()=>{}),children:Ld(P_,{store:r,debug:a,children:Ld(Uy,{meshes:s,children:Ld(e.Suspense,{children:Ld(Qy,{...l,backgroundColor:n,debug:a})})})})})}var tT=__webpack_require__(222),nT=__webpack_require__(691),rT=__webpack_require__(505),iT=__webpack_require__(464);function oT(){return oT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oT.apply(this,arguments)}function sT(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function aT(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=aT(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const lT=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=aT(e))&&(r&&(r+=" "),r+=t);return r};function cT(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var uT=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,hT=cT((function(e){return uT.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));var dT=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),pT=Math.abs,fT=String.fromCharCode,mT=Object.assign;function gT(e){return e.trim()}function vT(e,t,n){return e.replace(t,n)}function _T(e,t){return e.indexOf(t)}function bT(e,t){return 0|e.charCodeAt(t)}function yT(e,t,n){return e.slice(t,n)}function TT(e){return e.length}function ET(e){return e.length}function ST(e,t){return t.push(e),e}var wT=1,xT=1,MT=0,CT=0,IT=0,kT="";function RT(e,t,n,r,i,o,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:wT,column:xT,length:s,return:""}}function AT(e,t){return mT(RT("",null,null,"",null,null,0),e,{length:-e.length},t)}function LT(){return IT=CT>0?bT(kT,--CT):0,xT--,10===IT&&(xT=1,wT--),IT}function OT(){return IT=CT<MT?bT(kT,CT++):0,xT++,10===IT&&(xT=1,wT++),IT}function NT(){return bT(kT,CT)}function PT(){return CT}function DT(e,t){return yT(kT,e,t)}function $T(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function BT(e){return wT=xT=1,MT=TT(kT=e),CT=0,[]}function FT(e){return kT="",e}function UT(e){return gT(DT(CT-1,GT(91===e?e+2:40===e?e+1:e)))}function zT(e){for(;(IT=NT())&&IT<33;)OT();return $T(e)>2||$T(IT)>3?"":" "}function HT(e,t){for(;--t&&OT()&&!(IT<48||IT>102||IT>57&&IT<65||IT>70&&IT<97););return DT(e,PT()+(t<6&&32==NT()&&32==OT()))}function GT(e){for(;OT();)switch(IT){case e:return CT;case 34:case 39:34!==e&&39!==e&&GT(IT);break;case 40:41===e&&GT(e);break;case 92:OT()}return CT}function VT(e,t){for(;OT()&&e+IT!==57&&(e+IT!==84||47!==NT()););return"/*"+DT(t,CT-1)+"*"+fT(47===e?e:OT())}function WT(e){for(;!$T(NT());)OT();return DT(e,CT)}var jT="-ms-",XT="-moz-",YT="-webkit-",KT="comm",qT="rule",JT="decl",ZT="@keyframes";function QT(e,t){for(var n="",r=ET(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function eE(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case JT:return e.return=e.return||e.value;case KT:return"";case ZT:return e.return=e.value+"{"+QT(e.children,r)+"}";case qT:e.value=e.props.join(",")}return TT(n=QT(e.children,r))?e.return=e.value+"{"+n+"}":""}function tE(e){return FT(nE("",null,null,null,[""],e=BT(e),0,[0],e))}function nE(e,t,n,r,i,o,s,a,l){for(var c=0,u=0,h=s,d=0,p=0,f=0,m=1,g=1,v=1,_=0,b="",y=i,T=o,E=r,S=b;g;)switch(f=_,_=OT()){case 40:if(108!=f&&58==bT(S,h-1)){-1!=_T(S+=vT(UT(_),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:S+=UT(_);break;case 9:case 10:case 13:case 32:S+=zT(f);break;case 92:S+=HT(PT()-1,7);continue;case 47:switch(NT()){case 42:case 47:ST(iE(VT(OT(),PT()),t,n),l);break;default:S+="/"}break;case 123*m:a[c++]=TT(S)*v;case 125*m:case 59:case 0:switch(_){case 0:case 125:g=0;case 59+u:-1==v&&(S=vT(S,/\f/g,"")),p>0&&TT(S)-h&&ST(p>32?oE(S+";",r,n,h-1):oE(vT(S," ","")+";",r,n,h-2),l);break;case 59:S+=";";default:if(ST(E=rE(S,t,n,c,u,i,a,b,y=[],T=[],h),o),123===_)if(0===u)nE(S,t,E,E,y,o,h,a,T);else switch(99===d&&110===bT(S,3)?100:d){case 100:case 108:case 109:case 115:nE(e,E,E,r&&ST(rE(e,E,E,0,0,i,a,b,i,y=[],h),T),i,T,h,a,r?y:T);break;default:nE(S,E,E,E,[""],T,0,a,T)}}c=u=p=0,m=v=1,b=S="",h=s;break;case 58:h=1+TT(S),p=f;default:if(m<1)if(123==_)--m;else if(125==_&&0==m++&&125==LT())continue;switch(S+=fT(_),_*m){case 38:v=u>0?1:(S+="\f",-1);break;case 44:a[c++]=(TT(S)-1)*v,v=1;break;case 64:45===NT()&&(S+=UT(OT())),d=NT(),u=h=TT(b=S+=WT(PT())),_++;break;case 45:45===f&&2==TT(S)&&(m=0)}}return o}function rE(e,t,n,r,i,o,s,a,l,c,u){for(var h=i-1,d=0===i?o:[""],p=ET(d),f=0,m=0,g=0;f<r;++f)for(var v=0,_=yT(e,h+1,h=pT(m=s[f])),b=e;v<p;++v)(b=gT(m>0?d[v]+" "+_:vT(_,/&\f/g,d[v])))&&(l[g++]=b);return RT(e,t,n,0===i?qT:a,l,c,u)}function iE(e,t,n){return RT(e,t,n,KT,fT(IT),yT(e,2,-2),0)}function oE(e,t,n,r){return RT(e,t,n,JT,yT(e,0,r),yT(e,r+1,-1),r)}var sE=function(e,t,n){for(var r=0,i=0;r=i,i=NT(),38===r&&12===i&&(t[n]=1),!$T(i);)OT();return DT(e,CT)},aE=function(e,t){return FT(function(e,t){var n=-1,r=44;do{switch($T(r)){case 0:38===r&&12===NT()&&(t[n]=1),e[n]+=sE(CT-1,t,n);break;case 2:e[n]+=UT(r);break;case 4:if(44===r){e[++n]=58===NT()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=fT(r)}}while(r=OT());return e}(BT(e),t))},lE=new WeakMap,cE=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||lE.get(n))&&!r){lE.set(e,!0);for(var i=[],o=aE(t,i),s=n.props,a=0,l=0;a<o.length;a++)for(var c=0;c<s.length;c++,l++)e.props[l]=i[a]?o[a].replace(/&\f/g,s[c]):s[c]+" "+o[a]}}},uE=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function hE(e,t){switch(function(e,t){return 45^bT(e,0)?(((t<<2^bT(e,0))<<2^bT(e,1))<<2^bT(e,2))<<2^bT(e,3):0}(e,t)){case 5103:return YT+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return YT+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return YT+e+XT+e+jT+e+e;case 6828:case 4268:return YT+e+jT+e+e;case 6165:return YT+e+jT+"flex-"+e+e;case 5187:return YT+e+vT(e,/(\w+).+(:[^]+)/,YT+"box-$1$2"+jT+"flex-$1$2")+e;case 5443:return YT+e+jT+"flex-item-"+vT(e,/flex-|-self/,"")+e;case 4675:return YT+e+jT+"flex-line-pack"+vT(e,/align-content|flex-|-self/,"")+e;case 5548:return YT+e+jT+vT(e,"shrink","negative")+e;case 5292:return YT+e+jT+vT(e,"basis","preferred-size")+e;case 6060:return YT+"box-"+vT(e,"-grow","")+YT+e+jT+vT(e,"grow","positive")+e;case 4554:return YT+vT(e,/([^-])(transform)/g,"$1"+YT+"$2")+e;case 6187:return vT(vT(vT(e,/(zoom-|grab)/,YT+"$1"),/(image-set)/,YT+"$1"),e,"")+e;case 5495:case 3959:return vT(e,/(image-set\([^]*)/,YT+"$1$`$1");case 4968:return vT(vT(e,/(.+:)(flex-)?(.*)/,YT+"box-pack:$3"+jT+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+YT+e+e;case 4095:case 3583:case 4068:case 2532:return vT(e,/(.+)-inline(.+)/,YT+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(TT(e)-1-t>6)switch(bT(e,t+1)){case 109:if(45!==bT(e,t+4))break;case 102:return vT(e,/(.+:)(.+)-([^]+)/,"$1"+YT+"$2-$3$1"+XT+(108==bT(e,t+3)?"$3":"$2-$3"))+e;case 115:return~_T(e,"stretch")?hE(vT(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==bT(e,t+1))break;case 6444:switch(bT(e,TT(e)-3-(~_T(e,"!important")&&10))){case 107:return vT(e,":",":"+YT)+e;case 101:return vT(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+YT+(45===bT(e,14)?"inline-":"")+"box$3$1"+YT+"$2$3$1"+jT+"$2box$3")+e}break;case 5936:switch(bT(e,t+11)){case 114:return YT+e+jT+vT(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return YT+e+jT+vT(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return YT+e+jT+vT(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return YT+e+jT+e+e}return e}var dE=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case JT:e.return=hE(e.value,e.length);break;case ZT:return QT([AT(e,{value:vT(e.value,"@","@"+YT)})],r);case qT:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return QT([AT(e,{props:[vT(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return QT([AT(e,{props:[vT(t,/:(plac\w+)/,":"+YT+"input-$1")]}),AT(e,{props:[vT(t,/:(plac\w+)/,":-moz-$1")]}),AT(e,{props:[vT(t,/:(plac\w+)/,jT+"input-$1")]})],r)}return""}))}}],pE=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||dE;var i,o,s={},a=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)}));var l,c,u=[eE,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=ET(e);return function(n,r,i,o){for(var s="",a=0;a<t;a++)s+=e[a](n,r,i,o)||"";return s}}([cE,uE].concat(r,u));o=function(e,t,n,r){l=n,function(e){QT(tE(e),h)}(e?e+"{"+t.styles+"}":t.styles),r&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new dT({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:o};return d.sheet.hydrate(a),d};var fE={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},mE=/[A-Z]|^ms/g,gE=/_EMO_([^_]+?)_([^]*?)_EMO_/g,vE=function(e){return 45===e.charCodeAt(1)},_E=function(e){return null!=e&&"boolean"!==typeof e},bE=cT((function(e){return vE(e)?e:e.replace(mE,"-$&").toLowerCase()})),yE=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(gE,(function(e,t,n){return EE={name:t,styles:n,next:EE},t}))}return 1===fE[e]||vE(e)||"number"!==typeof t||0===t?t:t+"px"};function TE(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return EE={name:n.name,styles:n.styles,next:EE},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)EE={name:r.name,styles:r.styles,next:EE},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=TE(e,t,n[i])+";";else for(var o in n){var s=n[o];if("object"!==typeof s)null!=t&&void 0!==t[s]?r+=o+"{"+t[s]+"}":_E(s)&&(r+=bE(o)+":"+yE(o,s)+";");else if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var a=TE(e,t,s);switch(o){case"animation":case"animationName":r+=bE(o)+":"+a+";";break;default:r+=o+"{"+a+"}"}}else for(var l=0;l<s.length;l++)_E(s[l])&&(r+=bE(o)+":"+yE(o,s[l])+";")}return r}(e,t,n);case"function":if(void 0!==e){var i=EE,o=n(e);return EE=i,TE(e,t,o)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var EE,SE=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var wE=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";EE=void 0;var o=e[0];null==o||void 0===o.raw?(r=!1,i+=TE(n,t,o)):i+=o[0];for(var s=1;s<e.length;s++)i+=TE(n,t,e[s]),r&&(i+=o[s]);SE.lastIndex=0;for(var a,l="";null!==(a=SE.exec(i));)l+="-"+a[1];var c=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(i)+l;return{name:c,styles:i,next:EE}},xE=!!t.useInsertionEffect&&t.useInsertionEffect,ME=xE||function(e){return e()},CE=xE||e.useLayoutEffect,IE=e.createContext("undefined"!==typeof HTMLElement?pE({key:"css"}):null);IE.Provider;var kE=function(t){return(0,e.forwardRef)((function(n,r){var i=(0,e.useContext)(IE);return t(n,i,r)}))};var RE=e.createContext({});var AE=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},LE=function(e,t,n){AE(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}},OE=hT,NE=function(e){return"theme"!==e},PE=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?OE:NE},DE=function(e,t,n){var r;if(t){var i=t.shouldForwardProp;r=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},$E=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return AE(t,n,r),ME((function(){return LE(t,n,r)})),null},BE=function t(n,r){var i,o,s=n.__emotion_real===n,a=s&&n.__emotion_base||n;void 0!==r&&(i=r.label,o=r.target);var l=DE(n,r,s),c=l||PE(a),u=!c("as");return function(){var h=arguments,d=s&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==i&&d.push("label:"+i+";"),null==h[0]||void 0===h[0].raw)d.push.apply(d,h);else{0,d.push(h[0][0]);for(var p=h.length,f=1;f<p;f++)d.push(h[f],h[0][f])}var m=kE((function(t,n,r){var i=u&&t.as||a,s="",h=[],p=t;if(null==t.theme){for(var f in p={},t)p[f]=t[f];p.theme=e.useContext(RE)}"string"===typeof t.className?s=function(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}(n.registered,h,t.className):null!=t.className&&(s=t.className+" ");var m=wE(d.concat(h),n.registered,p);s+=n.key+"-"+m.name,void 0!==o&&(s+=" "+o);var g=u&&void 0===l?PE(i):c,v={};for(var _ in t)u&&"as"===_||g(_)&&(v[_]=t[_]);return v.className=s,v.ref=r,e.createElement(e.Fragment,null,e.createElement($E,{cache:n,serialized:m,isStringTag:"string"===typeof i}),e.createElement(i,v))}));return m.displayName=void 0!==i?i:"Styled("+("string"===typeof a?a:a.displayName||a.name||"Component")+")",m.defaultProps=n.defaultProps,m.__emotion_real=m,m.__emotion_base=a,m.__emotion_styles=d,m.__emotion_forwardProp=l,Object.defineProperty(m,"toString",{value:function(){return"."+o}}),m.withComponent=function(e,n){return t(e,oT({},r,n,{shouldForwardProp:DE(m,n,!0)})).apply(void 0,d)},m}}.bind();function FE(e,t){return BE(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){BE[e]=BE(e)}));function UE(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function zE(e){if("string"!==typeof e)throw new Error(UE(7));return e.charAt(0).toUpperCase()+e.slice(1)}function HE(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function GE(e){if(!HE(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=GE(e[n])})),t}function VE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const r=n.clone?oT({},e):e;return HE(e)&&HE(t)&&Object.keys(t).forEach((i=>{"__proto__"!==i&&(HE(t[i])&&i in e&&HE(e[i])?r[i]=VE(e[i],t[i],n):n.clone?r[i]=HE(t[i])?GE(t[i]):t[i]:r[i]=t[i])})),r}const WE=function(e,t){return t?VE(e,t,{clone:!1}):e},jE={xs:0,sm:600,md:900,lg:1200,xl:1536},XE={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(jE[e],"px)")};function YE(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||XE;return t.reduce(((r,i,o)=>(r[e.up(e.keys[o])]=n(t[o]),r)),{})}if("object"===typeof t){const e=r.breakpoints||XE;return Object.keys(t).reduce(((r,i)=>{if(-1!==Object.keys(e.values||jE).indexOf(i)){r[e.up(i)]=n(t[i],i)}else{const e=i;r[e]=t[e]}return r}),{})}return n(t)}function KE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,n)=>(t[e.up(n)]={},t)),{}))||{}}function qE(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function JE(e){let{values:t,breakpoints:n,base:r}=e;const i=r||function(e,t){if("object"!==typeof e)return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach(((t,r)=>{r<e.length&&(n[t]=!0)})):r.forEach((t=>{null!=e[t]&&(n[t]=!0)})),n}(t,n),o=Object.keys(i);if(0===o.length)return t;let s;return o.reduce(((e,n,r)=>(Array.isArray(t)?(e[n]=null!=t[r]?t[r]:t[s],s=r):"object"===typeof t?(e[n]=null!=t[n]?t[n]:t[s],s=n):e[n]=t,e)),{})}function ZE(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n="vars.".concat(t).split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function QE(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||i:ZE(e,n)||i,t&&(r=t(r,i,e)),r}const eS=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,o=e=>{if(null==e[t])return null;const o=e[t],s=ZE(e.theme,r)||{};return YE(e,o,(e=>{let r=QE(s,i,e);return e===r&&"string"===typeof e&&(r=QE(s,i,"".concat(t).concat("default"===e?"":zE(e)),e)),!1===n?r:{[n]:r}}))};return o.propTypes={},o.filterProps=[t],o};const tS={m:"margin",p:"padding"},nS={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},rS={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},iS=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!rS[e])return[e];e=rS[e]}const[t,n]=e.split(""),r=tS[t],i=nS[n]||"";return Array.isArray(i)?i.map((e=>r+e)):[r+i]})),oS=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],sS=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],aS=[...oS,...sS];function lS(e,t,n,r){var i;const o=null!=(i=ZE(e,t,!1))?i:n;return"number"===typeof o?e=>"string"===typeof e?e:o*e:Array.isArray(o)?e=>"string"===typeof e?e:o[e]:"function"===typeof o?o:()=>{}}function cS(e){return lS(e,"spacing",8)}function uS(e,t){if("string"===typeof t||null==t)return t;const n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function hS(e,t,n,r){if(-1===t.indexOf(n))return null;const i=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=uS(t,n),e)),{})}(iS(n),r);return YE(e,e[n],i)}function dS(e,t){const n=cS(e.theme);return Object.keys(e).map((r=>hS(e,t,r,n))).reduce(WE,{})}function pS(e){return dS(e,oS)}function fS(e){return dS(e,sS)}function mS(e){return dS(e,aS)}pS.propTypes={},pS.filterProps=oS,fS.propTypes={},fS.filterProps=sS,mS.propTypes={},mS.filterProps=aS;const gS=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),i=e=>Object.keys(e).reduce(((t,n)=>r[n]?WE(t,r[n](e)):t),{});return i.propTypes={},i.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),i};function vS(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function _S(e,t){return eS({prop:e,themeKey:"borders",transform:t})}const bS=_S("border",vS),yS=_S("borderTop",vS),TS=_S("borderRight",vS),ES=_S("borderBottom",vS),SS=_S("borderLeft",vS),wS=_S("borderColor"),xS=_S("borderTopColor"),MS=_S("borderRightColor"),CS=_S("borderBottomColor"),IS=_S("borderLeftColor"),kS=_S("outline",vS),RS=_S("outlineColor"),AS=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=lS(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:uS(t,e)});return YE(e,e.borderRadius,n)}return null};AS.propTypes={},AS.filterProps=["borderRadius"];gS(bS,yS,TS,ES,SS,wS,xS,MS,CS,IS,AS,kS,RS);const LS=e=>{if(void 0!==e.gap&&null!==e.gap){const t=lS(e.theme,"spacing",8),n=e=>({gap:uS(t,e)});return YE(e,e.gap,n)}return null};LS.propTypes={},LS.filterProps=["gap"];const OS=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=lS(e.theme,"spacing",8),n=e=>({columnGap:uS(t,e)});return YE(e,e.columnGap,n)}return null};OS.propTypes={},OS.filterProps=["columnGap"];const NS=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=lS(e.theme,"spacing",8),n=e=>({rowGap:uS(t,e)});return YE(e,e.rowGap,n)}return null};NS.propTypes={},NS.filterProps=["rowGap"];gS(LS,OS,NS,eS({prop:"gridColumn"}),eS({prop:"gridRow"}),eS({prop:"gridAutoFlow"}),eS({prop:"gridAutoColumns"}),eS({prop:"gridAutoRows"}),eS({prop:"gridTemplateColumns"}),eS({prop:"gridTemplateRows"}),eS({prop:"gridTemplateAreas"}),eS({prop:"gridArea"}));function PS(e,t){return"grey"===t?t:e}gS(eS({prop:"color",themeKey:"palette",transform:PS}),eS({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:PS}),eS({prop:"backgroundColor",themeKey:"palette",transform:PS}));function DS(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const $S=eS({prop:"width",transform:DS}),BS=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,r;const i=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||jE[t];return i?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:"".concat(i).concat(e.theme.breakpoints.unit)}:{maxWidth:i}:{maxWidth:DS(t)}};return YE(e,e.maxWidth,t)}return null};BS.filterProps=["maxWidth"];const FS=eS({prop:"minWidth",transform:DS}),US=eS({prop:"height",transform:DS}),zS=eS({prop:"maxHeight",transform:DS}),HS=eS({prop:"minHeight",transform:DS}),GS=(eS({prop:"size",cssProperty:"width",transform:DS}),eS({prop:"size",cssProperty:"height",transform:DS}),gS($S,BS,FS,US,zS,HS,eS({prop:"boxSizing"})),{border:{themeKey:"borders",transform:vS},borderTop:{themeKey:"borders",transform:vS},borderRight:{themeKey:"borders",transform:vS},borderBottom:{themeKey:"borders",transform:vS},borderLeft:{themeKey:"borders",transform:vS},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:vS},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:AS},color:{themeKey:"palette",transform:PS},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:PS},backgroundColor:{themeKey:"palette",transform:PS},p:{style:fS},pt:{style:fS},pr:{style:fS},pb:{style:fS},pl:{style:fS},px:{style:fS},py:{style:fS},padding:{style:fS},paddingTop:{style:fS},paddingRight:{style:fS},paddingBottom:{style:fS},paddingLeft:{style:fS},paddingX:{style:fS},paddingY:{style:fS},paddingInline:{style:fS},paddingInlineStart:{style:fS},paddingInlineEnd:{style:fS},paddingBlock:{style:fS},paddingBlockStart:{style:fS},paddingBlockEnd:{style:fS},m:{style:pS},mt:{style:pS},mr:{style:pS},mb:{style:pS},ml:{style:pS},mx:{style:pS},my:{style:pS},margin:{style:pS},marginTop:{style:pS},marginRight:{style:pS},marginBottom:{style:pS},marginLeft:{style:pS},marginX:{style:pS},marginY:{style:pS},marginInline:{style:pS},marginInlineStart:{style:pS},marginInlineEnd:{style:pS},marginBlock:{style:pS},marginBlockStart:{style:pS},marginBlockEnd:{style:pS},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:LS},rowGap:{style:NS},columnGap:{style:OS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:DS},maxWidth:{style:BS},minWidth:{transform:DS},height:{transform:DS},maxHeight:{transform:DS},minHeight:{transform:DS},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const VS=function(){function e(e,t,n,r){const i={[e]:t,theme:n},o=r[e];if(!o)return{[e]:t};const{cssProperty:s=e,themeKey:a,transform:l,style:c}=o;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=ZE(n,a)||{};if(c)return c(i);return YE(i,t,(t=>{let n=QE(u,l,t);return t===n&&"string"===typeof t&&(n=QE(u,l,"".concat(e).concat("default"===t?"":zE(t)),t)),!1===s?n:{[s]:n}}))}return function t(n){var r;const{sx:i,theme:o={}}=n||{};if(!i)return null;const s=null!=(r=o.unstable_sxConfig)?r:GS;function a(n){let r=n;if("function"===typeof n)r=n(o);else if("object"!==typeof n)return n;if(!r)return null;const i=KE(o.breakpoints),a=Object.keys(i);let l=i;return Object.keys(r).forEach((n=>{const i=(a=r[n],c=o,"function"===typeof a?a(c):a);var a,c;if(null!==i&&void 0!==i)if("object"===typeof i)if(s[n])l=WE(l,e(n,i,o,s));else{const e=YE({theme:o},i,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),i=new Set(r);return t.every((e=>i.size===Object.keys(e).length))}(e,i)?l=WE(l,e):l[n]=t({sx:i,theme:o})}else l=WE(l,e(n,i,o,s))})),qE(a,l)}return Array.isArray(i)?i.map(a):a(i)}}();VS.filterProps=["sx"];const WS=VS,jS=["sx"],XS=e=>{var t,n;const r={systemProps:{},otherProps:{}},i=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:GS;return Object.keys(e).forEach((t=>{i[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function YS(e){const{sx:t}=e,n=sT(e,jS),{systemProps:r,otherProps:i}=XS(n);let o;return o=Array.isArray(t)?[r,...t]:"function"===typeof t?function(){const e=t(...arguments);return HE(e)?oT({},r,e):r}:oT({},r,t),oT({},i,{sx:o})}const KS=["values","unit","step"],qS=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>oT({},e,{[t.key]:t.val})),{})};const JS={borderRadius:4};function ZS(e,t){const n=this;if(n.vars&&"function"===typeof n.getColorSchemeSelector){return{[n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}}return n.palette.mode===e?t:{}}const QS=["breakpoints","palette","spacing","shape"];const ew=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:r,shape:i={}}=e,o=sT(e,QS),s=function(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=e,i=sT(e,KS),o=qS(t),s=Object.keys(o);function a(e){const r="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(r).concat(n,")")}function l(e){const i="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(i-r/100).concat(n,")")}function c(e,i){const o=s.indexOf(i);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(n,") and ")+"(max-width:".concat((-1!==o&&"number"===typeof t[s[o]]?t[s[o]]:i)-r/100).concat(n,")")}return oT({keys:s,values:o,up:a,down:l,between:c,only:function(e){return s.indexOf(e)+1<s.length?c(e,s[s.indexOf(e)+1]):a(e)},not:function(e){const t=s.indexOf(e);return 0===t?a(s[1]):t===s.length-1?l(s[t]):c(e,s[s.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},i)}(t),a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=cS({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}(r);let l=VE({breakpoints:s,direction:"ltr",components:{},palette:oT({mode:"light"},n),spacing:a,shape:oT({},JS,i)},o);l.applyStyles=ZS;for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return l=u.reduce(((e,t)=>VE(e,t)),l),l.unstable_sxConfig=oT({},GS,null==o?void 0:o.unstable_sxConfig),l.unstable_sx=function(e){return WS({sx:e,theme:this})},l};const tw=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const n=e.useContext(RE);return n&&(r=n,0!==Object.keys(r).length)?n:t;var r},nw=ew();const rw=function(){return tw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:nw)};var iw=__webpack_require__(184);const ow=["className","component"];const sw=e=>e,aw=(()=>{let e=sw;return{configure(t){e=t},generate:t=>e(t),reset(){e=sw}}})();function lw(e,t){return oT({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const cw=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))};function uw(e){return cw(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function hw(e){if(e.type)return e;if("#"===e.charAt(0))return hw(function(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", "),")"):""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(UE(9,e));let r,i=e.substring(t+1,e.length-1);if("color"===n){if(i=i.split(" "),r=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(UE(10,r))}else i=i.split(",");return i=i.map((e=>parseFloat(e))),{type:n,values:i,colorSpace:r}}function dw(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function pw(e){let t="hsl"===(e=hw(e)).type||"hsla"===e.type?hw(function(e){e=hw(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,o=r*Math.min(i,1-i),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return i-o*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const l=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),dw({type:a,values:l})}(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function fw(e,t){return e=hw(e),t=uw(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,dw(e)}function mw(e,t){if(e=hw(e),t=uw(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return dw(e)}function gw(e,t){if(e=hw(e),t=uw(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return dw(e)}const vw={black:"#000",white:"#fff"},_w={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},bw={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},yw={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Tw={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ew={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Sw={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},ww={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},xw=["mode","contrastThreshold","tonalOffset"],Mw={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:vw.white,default:vw.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Cw={text:{primary:vw.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:vw.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Iw(e,t,n,r){const i=r.light||r,o=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=gw(e.main,i):"dark"===t&&(e.dark=mw(e.main,o)))}function kw(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2}=e,i=sT(e,xw),o=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Ew[200],light:Ew[50],dark:Ew[400]}:{main:Ew[700],light:Ew[400],dark:Ew[800]}}(t),s=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:bw[200],light:bw[50],dark:bw[400]}:{main:bw[500],light:bw[300],dark:bw[700]}}(t),a=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:yw[500],light:yw[300],dark:yw[700]}:{main:yw[700],light:yw[400],dark:yw[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Sw[400],light:Sw[300],dark:Sw[700]}:{main:Sw[700],light:Sw[500],dark:Sw[900]}}(t),c=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:ww[400],light:ww[300],dark:ww[700]}:{main:ww[800],light:ww[500],dark:ww[900]}}(t),u=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Tw[400],light:Tw[300],dark:Tw[700]}:{main:"#ed6c02",light:Tw[500],dark:Tw[900]}}(t);function h(e){const t=function(e,t){const n=pw(e),r=pw(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,Cw.text.primary)>=n?Cw.text.primary:Mw.text.primary;return t}const d=e=>{let{color:t,name:n,mainShade:i=500,lightShade:o=300,darkShade:s=700}=e;if(t=oT({},t),!t.main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(UE(11,n?" (".concat(n,")"):"",i));if("string"!==typeof t.main)throw new Error(UE(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return Iw(t,"light",o,r),Iw(t,"dark",s,r),t.contrastText||(t.contrastText=h(t.main)),t},p={dark:Cw,light:Mw};return VE(oT({common:oT({},vw),mode:t,primary:d({color:o,name:"primary"}),secondary:d({color:s,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:a,name:"error"}),warning:d({color:u,name:"warning"}),info:d({color:l,name:"info"}),success:d({color:c,name:"success"}),grey:_w,contrastThreshold:n,getContrastText:h,augmentColor:d,tonalOffset:r},p[t]),i)}const Rw=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const Aw={textTransform:"uppercase"},Lw='"Roboto", "Helvetica", "Arial", sans-serif';function Ow(e,t){const n="function"===typeof t?t(e):t,{fontFamily:r=Lw,fontSize:i=14,fontWeightLight:o=300,fontWeightRegular:s=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:h}=n,d=sT(n,Rw);const p=i/14,f=h||(e=>"".concat(e/c*p,"rem")),m=(e,t,n,i,o)=>{return oT({fontFamily:r,fontWeight:e,fontSize:f(t),lineHeight:n},r===Lw?{letterSpacing:"".concat((s=i/t,Math.round(1e5*s)/1e5),"em")}:{},o,u);var s},g={h1:m(o,96,1.167,-1.5),h2:m(o,60,1.2,-.5),h3:m(s,48,1.167,0),h4:m(s,34,1.235,.25),h5:m(s,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(s,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(s,16,1.5,.15),body2:m(s,14,1.43,.15),button:m(a,14,1.75,.4,Aw),caption:m(s,12,1.66,.4),overline:m(s,12,2.66,1,Aw),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return VE(oT({htmlFontSize:c,pxToRem:f,fontFamily:r,fontSize:i,fontWeightLight:o,fontWeightRegular:s,fontWeightMedium:a,fontWeightBold:l},g),d,{clone:!1})}function Nw(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const Pw=["none",Nw(0,2,1,-1,0,1,1,0,0,1,3,0),Nw(0,3,1,-2,0,2,2,0,0,1,5,0),Nw(0,3,3,-2,0,3,4,0,0,1,8,0),Nw(0,2,4,-1,0,4,5,0,0,1,10,0),Nw(0,3,5,-1,0,5,8,0,0,1,14,0),Nw(0,3,5,-1,0,6,10,0,0,1,18,0),Nw(0,4,5,-2,0,7,10,1,0,2,16,1),Nw(0,5,5,-3,0,8,10,1,0,3,14,2),Nw(0,5,6,-3,0,9,12,1,0,3,16,2),Nw(0,6,6,-3,0,10,14,1,0,4,18,3),Nw(0,6,7,-4,0,11,15,1,0,4,20,3),Nw(0,7,8,-4,0,12,17,2,0,5,22,4),Nw(0,7,8,-4,0,13,19,2,0,5,24,4),Nw(0,7,9,-4,0,14,21,2,0,5,26,4),Nw(0,8,9,-5,0,15,22,2,0,6,28,5),Nw(0,8,10,-5,0,16,24,2,0,6,30,5),Nw(0,8,11,-5,0,17,26,2,0,6,32,5),Nw(0,9,11,-5,0,18,28,2,0,7,34,6),Nw(0,9,12,-6,0,19,29,2,0,7,36,6),Nw(0,10,13,-6,0,20,31,3,0,8,38,7),Nw(0,10,13,-6,0,21,33,3,0,8,40,7),Nw(0,10,14,-6,0,22,35,3,0,8,42,7),Nw(0,11,14,-7,0,23,36,3,0,9,44,8),Nw(0,11,15,-7,0,24,38,3,0,9,46,8)],Dw=["duration","easing","delay"],$w={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Bw={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Fw(e){return"".concat(Math.round(e),"ms")}function Uw(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function zw(e){const t=oT({},$w,e.easing),n=oT({},Bw,e.duration);return oT({getAutoHeightDuration:Uw,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:i=n.standard,easing:o=t.easeInOut,delay:s=0}=r;sT(r,Dw);return(Array.isArray(e)?e:[e]).map((e=>"".concat(e," ").concat("string"===typeof i?i:Fw(i)," ").concat(o," ").concat("string"===typeof s?s:Fw(s)))).join(",")}},e,{easing:t,duration:n})}const Hw={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Gw=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Vw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:n={},transitions:r={},typography:i={}}=e,o=sT(e,Gw);if(e.vars)throw new Error(UE(18));const s=kw(n),a=ew(e);let l=VE(a,{mixins:lw(a.breakpoints,t),palette:s,shadows:Pw.slice(),typography:Ow(s,i),transitions:zw(r),zIndex:oT({},Hw)});l=VE(l,o);for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return l=u.reduce(((e,t)=>VE(e,t)),l),l.unstable_sxConfig=oT({},GS,null==o?void 0:o.unstable_sxConfig),l.unstable_sx=function(e){return WS({sx:e,theme:this})},l}const Ww=Vw,jw="$$material",Xw={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Yw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r=Xw[t];return r?"".concat(n,"-").concat(r):"".concat(aw.generate(e),"-").concat(t)}function Kw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=Yw(e,t,n)})),r}const qw=Kw("MuiBox",["root"]),Jw=Ww(),Zw=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:n,defaultTheme:r,defaultClassName:i="MuiBox-root",generateClassName:o}=t,s=FE("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(WS);return e.forwardRef((function(e,t){const a=rw(r),l=YS(e),{className:c,component:u="div"}=l,h=sT(l,ow);return(0,iw.jsx)(s,oT({as:u,ref:t,className:lT(c,o?o(i):i),theme:n&&a[n]||a},h))}))}({themeId:jw,defaultTheme:Jw,defaultClassName:qw.root,generateClassName:aw.generate}),Qw=Zw;function ex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};return Object.keys(e).forEach((i=>{r[i]=e[i].reduce(((e,r)=>{if(r){const i=t(r);""!==i&&e.push(i),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}function tx(e,t){const n=oT({},t);return Object.keys(e).forEach((r=>{if(r.toString().match(/^(components|slots)$/))n[r]=oT({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=e[r]||{},o=t[r];n[r]={},o&&Object.keys(o)?i&&Object.keys(i)?(n[r]=oT({},o),Object.keys(i).forEach((e=>{n[r][e]=tx(i[e],o[e])}))):n[r]=o:n[r]=i}else void 0===n[r]&&(n[r]=e[r])})),n}function nx(e){let{props:t,name:n,defaultTheme:r,themeId:i}=e,o=rw(r);i&&(o=o[i]||o);const s=function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?tx(t.components[n].defaultProps,r):r}({theme:o,name:n,props:t});return s}const rx=["ownerState"],ix=["variants"],ox=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function sx(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const ax=ew(),lx=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function cx(e){let{defaultTheme:t,theme:n,themeId:r}=e;return i=n,0===Object.keys(i).length?t:n[r]||n;var i}function ux(e){return e?(t,n)=>n[e]:null}function hx(e,t){let{ownerState:n}=t,r=sT(t,rx);const i="function"===typeof e?e(oT({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap((e=>hx(e,oT({ownerState:n},r))));if(i&&"object"===typeof i&&Array.isArray(i.variants)){const{variants:e=[]}=i;let t=sT(i,ix);return e.forEach((e=>{let i=!0;"function"===typeof e.props?i=e.props(oT({ownerState:n},r)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(i=!1)})),i&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style(oT({ownerState:n},r)):e.style))})),t}return i}function dx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=ax,rootShouldForwardProp:r=sx,slotShouldForwardProp:i=sx}=e,o=e=>WS(oT({},e,{theme:cx(oT({},e,{defaultTheme:n,themeId:t}))}));return o.__mui_systemSx=!0,function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};((e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))})(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:a,slot:l,skipVariantsResolver:c,skipSx:u,overridesResolver:h=ux(lx(l))}=s,d=sT(s,ox),p=void 0!==c?c:l&&"Root"!==l&&"root"!==l||!1,f=u||!1;let m=sx;"Root"===l||"root"===l?m=r:l?m=i:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(m=void 0);const g=FE(e,oT({shouldForwardProp:m,label:undefined},d)),v=e=>"function"===typeof e&&e.__emotion_real!==e||HE(e)?r=>hx(e,oT({},r,{theme:cx({theme:r.theme,defaultTheme:n,themeId:t})})):e,_=function(r){let i=v(r);for(var s=arguments.length,l=new Array(s>1?s-1:0),c=1;c<s;c++)l[c-1]=arguments[c];const u=l?l.map(v):[];a&&h&&u.push((e=>{const r=cx(oT({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[a]||!r.components[a].styleOverrides)return null;const i=r.components[a].styleOverrides,o={};return Object.entries(i).forEach((t=>{let[n,i]=t;o[n]=hx(i,oT({},e,{theme:r}))})),h(e,o)})),a&&!p&&u.push((e=>{var r;const i=cx(oT({},e,{defaultTheme:n,themeId:t}));return hx({variants:null==i||null==(r=i.components)||null==(r=r[a])?void 0:r.variants},oT({},e,{theme:i}))})),f||u.push(o);const d=u.length-l.length;if(Array.isArray(r)&&d>0){const e=new Array(d).fill("");i=[...r,...e],i.raw=[...r.raw,...e]}const m=g(i,...u);return e.muiName&&(m.muiName=e.muiName),m};return g.withConfig&&(_.withConfig=g.withConfig),_}}const px=dx(),fx=["className","component","disableGutters","fixed","maxWidth","classes"],mx=ew(),gx=px("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat(zE(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),vx=e=>nx({props:e,name:"MuiContainer",defaultTheme:mx});const _x=zE,bx=Ww(),yx=e=>sx(e)&&"classes"!==e,Tx=sx,Ex=dx({themeId:jw,defaultTheme:bx,rootShouldForwardProp:yx});function Sx(e){let{props:t,name:n}=e;return nx({props:t,name:n,defaultTheme:bx,themeId:jw})}const wx=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:n=gx,useThemeProps:r=vx,componentName:i="MuiContainer"}=t,o=n((e=>{let{theme:t,ownerState:n}=e;return oT({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:n}=e;return n.fixed&&Object.keys(t.breakpoints.values).reduce(((e,n)=>{const r=n,i=t.breakpoints.values[r];return 0!==i&&(e[t.breakpoints.up(r)]={maxWidth:"".concat(i).concat(t.breakpoints.unit)}),e}),{})}),(e=>{let{theme:t,ownerState:n}=e;return oT({},"xs"===n.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},n.maxWidth&&"xs"!==n.maxWidth&&{[t.breakpoints.up(n.maxWidth)]:{maxWidth:"".concat(t.breakpoints.values[n.maxWidth]).concat(t.breakpoints.unit)}})})),s=e.forwardRef((function(e,t){const n=r(e),{className:s,component:a="div",disableGutters:l=!1,fixed:c=!1,maxWidth:u="lg"}=n,h=sT(n,fx),d=oT({},n,{component:a,disableGutters:l,fixed:c,maxWidth:u}),p=((e,t)=>{const{classes:n,fixed:r,disableGutters:i,maxWidth:o}=e;return ex({root:["root",o&&"maxWidth".concat(zE(String(o))),r&&"fixed",i&&"disableGutters"]},(e=>Yw(t,e)),n)})(d,i);return(0,iw.jsx)(o,oT({as:a,ownerState:d,className:lT(p.root,s),ref:t},h))}));return s}({createStyledComponent:Ex("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat(_x(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>Sx({props:e,name:"MuiContainer"})}),xx=wx;function Mx(e){return Yw("MuiTypography",e)}Kw("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Cx=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Ix=Ex("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t["align".concat(_x(n.align))],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((e=>{let{theme:t,ownerState:n}=e;return oT({margin:0},"inherit"===n.variant&&{font:"inherit"},"inherit"!==n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),kx={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Rx={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ax=e.forwardRef((function(e,t){const n=Sx({props:e,name:"MuiTypography"}),r=(e=>Rx[e]||e)(n.color),i=YS(oT({},n,{color:r})),{align:o="inherit",className:s,component:a,gutterBottom:l=!1,noWrap:c=!1,paragraph:u=!1,variant:h="body1",variantMapping:d=kx}=i,p=sT(i,Cx),f=oT({},i,{align:o,color:r,className:s,component:a,gutterBottom:l,noWrap:c,paragraph:u,variant:h,variantMapping:d}),m=a||(u?"p":d[h]||kx[h])||"span",g=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:i,variant:o,classes:s}=e;return ex({root:["root",o,"inherit"!==e.align&&"align".concat(_x(t)),n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]},Mx,s)})(f);return(0,iw.jsx)(Ix,oT({as:m,ref:t,ownerState:f,className:lT(g.root,s)},p))})),Lx=Ax;let Ox=0;const Nx=t["useId".toString()];function Px(t){if(void 0!==Nx){const e=Nx();return null!=t?t:e}return function(t){const[n,r]=e.useState(t),i=t||n;return e.useEffect((()=>{null==n&&(Ox+=1,r("mui-".concat(Ox)))}),[n]),i}(t)}var Dx=__webpack_require__(164);function $x(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Bx(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.useMemo((()=>n.every((e=>null==e))?null:e=>{n.forEach((t=>{$x(t,e)}))}),n)}function Fx(e){return e&&e.ownerDocument||document}function Ux(e){return Fx(e).defaultView||window}const zx="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Hx(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];clearTimeout(t),t=setTimeout((()=>{e.apply(this,i)}),n)}return r.clear=()=>{clearTimeout(t)},r}const Gx=["onChange","maxRows","minRows","style","value"];function Vx(e){return parseInt(e,10)||0}const Wx={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function jx(e){return void 0===e||null===e||0===Object.keys(e).length||0===e.outerHeightStyle&&!e.overflow}const Xx=e.forwardRef((function(t,n){const{onChange:r,maxRows:i,minRows:o=1,style:s,value:a}=t,l=sT(t,Gx),{current:c}=e.useRef(null!=a),u=e.useRef(null),h=Bx(n,u),d=e.useRef(null),p=e.useRef(0),[f,m]=e.useState({outerHeightStyle:0}),g=e.useCallback((()=>{const e=u.current,n=Ux(e).getComputedStyle(e);if("0px"===n.width)return{outerHeightStyle:0};const r=d.current;r.style.width=n.width,r.value=e.value||t.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");const s=n.boxSizing,a=Vx(n.paddingBottom)+Vx(n.paddingTop),l=Vx(n.borderBottomWidth)+Vx(n.borderTopWidth),c=r.scrollHeight;r.value="x";const h=r.scrollHeight;let p=c;o&&(p=Math.max(Number(o)*h,p)),i&&(p=Math.min(Number(i)*h,p)),p=Math.max(p,h);return{outerHeightStyle:p+("border-box"===s?a+l:0),overflow:Math.abs(p-c)<=1}}),[i,o,t.placeholder]),v=(e,t)=>{const{outerHeightStyle:n,overflow:r}=t;return p.current<20&&(n>0&&Math.abs((e.outerHeightStyle||0)-n)>1||e.overflow!==r)?(p.current+=1,{overflow:r,outerHeightStyle:n}):e},_=e.useCallback((()=>{const e=g();jx(e)||m((t=>v(t,e)))}),[g]);zx((()=>{const e=()=>{p.current=0,(()=>{const e=g();jx(e)||Dx.flushSync((()=>{m((t=>v(t,e)))}))})()};let t;const n=Hx(e),r=u.current,i=Ux(r);let o;return i.addEventListener("resize",n),"undefined"!==typeof ResizeObserver&&(o=new ResizeObserver(e),o.observe(r)),()=>{n.clear(),cancelAnimationFrame(t),i.removeEventListener("resize",n),o&&o.disconnect()}}),[g]),zx((()=>{_()})),e.useEffect((()=>{p.current=0}),[a]);return(0,iw.jsxs)(e.Fragment,{children:[(0,iw.jsx)("textarea",oT({value:a,onChange:e=>{p.current=0,c||_(),r&&r(e)},ref:h,rows:o,style:oT({height:f.outerHeightStyle,overflow:f.overflow?"hidden":void 0},s)},l)),(0,iw.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:d,tabIndex:-1,style:oT({},Wx,s,{paddingTop:0,paddingBottom:0})})]})}));function Yx(e){return"string"===typeof e}function Kx(e){let{props:t,states:n,muiFormControl:r}=e;return n.reduce(((e,n)=>(e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e)),{})}const qx=e.createContext(void 0);function Jx(){return e.useContext(qx)}const Zx=Bx,Qx=zx;__webpack_require__(110);var eM=kE((function(t,n){var r=t.styles,i=wE([r],void 0,e.useContext(RE)),o=e.useRef();return CE((function(){var e=n.key+"-global",t=new n.sheet.constructor({key:e,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),r=!1,s=document.querySelector('style[data-emotion="'+e+" "+i.name+'"]');return n.sheet.tags.length&&(t.before=n.sheet.tags[0]),null!==s&&(r=!0,s.setAttribute("data-emotion",e),t.hydrate([s])),o.current=[t,r],function(){t.flush()}}),[n]),CE((function(){var e=o.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==i.next&&LE(n,i.next,!0),t.tags.length){var r=t.tags[t.tags.length-1].nextElementSibling;t.before=r,t.flush()}n.insert("",i,t,!1)}}),[n,i.name]),null}));function tM(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wE(t)}var nM=function(){var e=tM.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function rM(e){const{styles:t,defaultTheme:n={}}=e,r="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?n:e);var r}:t;return(0,iw.jsx)(eM,{styles:r})}const iM=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e;const i=rw(r),o="function"===typeof t?t(n&&i[n]||i):t;return(0,iw.jsx)(rM,{styles:o})};const oM=function(e){return(0,iw.jsx)(iM,oT({},e,{defaultTheme:bx,themeId:jw}))};function sM(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function aM(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(sM(e.value)&&""!==e.value||t&&sM(e.defaultValue)&&""!==e.defaultValue)}function lM(e){return Yw("MuiInputBase",e)}const cM=Kw("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),uM=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],hM=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t["color".concat(_x(n.color))],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},dM=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},pM=Ex("div",{name:"MuiInputBase",slot:"Root",overridesResolver:hM})((e=>{let{theme:t,ownerState:n}=e;return oT({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",["&.".concat(cM.disabled)]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},n.multiline&&oT({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),fM=Ex("input",{name:"MuiInputBase",slot:"Input",overridesResolver:dM})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode,i=oT({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),o={opacity:"0 !important"},s=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return oT({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},["label[data-shrink=false] + .".concat(cM.formControl," &")]:{"&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus:-ms-input-placeholder":s,"&:focus::-ms-input-placeholder":s},["&.".concat(cM.disabled)]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===n.size&&{paddingTop:1},n.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===n.type&&{MozAppearance:"textfield"})})),mM=(0,iw.jsx)(oM,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),gM=e.forwardRef((function(t,n){var r;const i=Sx({props:t,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:s,autoFocus:a,className:l,components:c={},componentsProps:u={},defaultValue:h,disabled:d,disableInjectingGlobalStyles:p,endAdornment:f,fullWidth:m=!1,id:g,inputComponent:v="input",inputProps:_={},inputRef:b,maxRows:y,minRows:T,multiline:E=!1,name:S,onBlur:w,onChange:x,onClick:M,onFocus:C,onKeyDown:I,onKeyUp:k,placeholder:R,readOnly:A,renderSuffix:L,rows:O,slotProps:N={},slots:P={},startAdornment:D,type:$="text",value:B}=i,F=sT(i,uM),U=null!=_.value?_.value:B,{current:z}=e.useRef(null!=U),H=e.useRef(),G=e.useCallback((e=>{0}),[]),V=Zx(H,b,_.ref,G),[W,j]=e.useState(!1),X=Jx();const Y=Kx({props:i,muiFormControl:X,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Y.focused=X?X.focused:W,e.useEffect((()=>{!X&&d&&W&&(j(!1),w&&w())}),[X,d,W,w]);const K=X&&X.onFilled,q=X&&X.onEmpty,J=e.useCallback((e=>{aM(e)?K&&K():q&&q()}),[K,q]);Qx((()=>{z&&J({value:U})}),[U,J,z]);e.useEffect((()=>{J(H.current)}),[]);let Z=v,Q=_;E&&"input"===Z&&(Q=oT(O?{type:void 0,minRows:O,maxRows:O}:{type:void 0,maxRows:y,minRows:T},Q),Z=Xx);e.useEffect((()=>{X&&X.setAdornedStart(Boolean(D))}),[X,D]);const ee=oT({},i,{color:Y.color||"primary",disabled:Y.disabled,endAdornment:f,error:Y.error,focused:Y.focused,formControl:X,fullWidth:m,hiddenLabel:Y.hiddenLabel,multiline:E,size:Y.size,startAdornment:D,type:$}),te=(e=>{const{classes:t,color:n,disabled:r,error:i,endAdornment:o,focused:s,formControl:a,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:h,size:d,startAdornment:p,type:f}=e;return ex({root:["root","color".concat(_x(n)),r&&"disabled",i&&"error",l&&"fullWidth",s&&"focused",a&&"formControl",d&&"medium"!==d&&"size".concat(_x(d)),u&&"multiline",p&&"adornedStart",o&&"adornedEnd",c&&"hiddenLabel",h&&"readOnly"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",u&&"inputMultiline","small"===d&&"inputSizeSmall",c&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",h&&"readOnly"]},lM,t)})(ee),ne=P.root||c.Root||pM,re=N.root||u.root||{},ie=P.input||c.Input||fM;return Q=oT({},Q,null!=(r=N.input)?r:u.input),(0,iw.jsxs)(e.Fragment,{children:[!p&&mM,(0,iw.jsxs)(ne,oT({},re,!Yx(ne)&&{ownerState:oT({},ee,re.ownerState)},{ref:n,onClick:e=>{H.current&&e.currentTarget===e.target&&H.current.focus(),M&&M(e)}},F,{className:lT(te.root,re.className,l,A&&"MuiInputBase-readOnly"),children:[D,(0,iw.jsx)(qx.Provider,{value:null,children:(0,iw.jsx)(ie,oT({ownerState:ee,"aria-invalid":Y.error,"aria-describedby":o,autoComplete:s,autoFocus:a,defaultValue:h,disabled:Y.disabled,id:g,onAnimationStart:e=>{J("mui-auto-fill-cancel"===e.animationName?H.current:{value:"x"})},name:S,placeholder:R,readOnly:A,required:Y.required,rows:O,value:U,onKeyDown:I,onKeyUp:k,type:$},Q,!Yx(ie)&&{as:Z,ownerState:oT({},ee,Q.ownerState)},{ref:V,className:lT(te.input,Q.className,A&&"MuiInputBase-readOnly"),onBlur:e=>{w&&w(e),_.onBlur&&_.onBlur(e),X&&X.onBlur?X.onBlur(e):j(!1)},onChange:function(e){if(!z){const t=e.target||H.current;if(null==t)throw new Error(UE(1));J({value:t.value})}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];_.onChange&&_.onChange(e,...n),x&&x(e,...n)},onFocus:e=>{Y.disabled?e.stopPropagation():(C&&C(e),_.onFocus&&_.onFocus(e),X&&X.onFocus?X.onFocus(e):j(!0))}}))}),f,L?L(oT({},Y,{startAdornment:D})):null]}))]})})),vM=gM;function _M(e){return Yw("MuiInput",e)}const bM=oT({},cM,Kw("MuiInput",["root","underline","input"])),yM=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],TM=Ex(pM,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...hM(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r="rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")")),oT({position:"relative"},n.formControl&&{"label + &":{marginTop:16}},!n.disableUnderline&&{"&::after":{borderBottom:"2px solid ".concat((t.vars||t).palette[n.color].main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(bM.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(bM.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(bM.disabled,", .").concat(bM.error,"):before")]:{borderBottom:"2px solid ".concat((t.vars||t).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}},["&.".concat(bM.disabled,":before")]:{borderBottomStyle:"dotted"}})})),EM=Ex(fM,{name:"MuiInput",slot:"Input",overridesResolver:dM})({}),SM=e.forwardRef((function(e,t){var n,r,i,o;const s=Sx({props:e,name:"MuiInput"}),{disableUnderline:a,components:l={},componentsProps:c,fullWidth:u=!1,inputComponent:h="input",multiline:d=!1,slotProps:p,slots:f={},type:m="text"}=s,g=sT(s,yM),v=(e=>{const{classes:t,disableUnderline:n}=e;return oT({},t,ex({root:["root",!n&&"underline"],input:["input"]},_M,t))})(s),_={root:{ownerState:{disableUnderline:a}}},b=(null!=p?p:c)?VE(null!=p?p:c,_):_,y=null!=(n=null!=(r=f.root)?r:l.Root)?n:TM,T=null!=(i=null!=(o=f.input)?o:l.Input)?i:EM;return(0,iw.jsx)(vM,oT({slots:{root:y,input:T},slotProps:b,fullWidth:u,inputComponent:h,multiline:d,ref:t,type:m},g,{classes:v}))}));SM.muiName="Input";const wM=SM;function xM(e){return Yw("MuiFilledInput",e)}const MM=oT({},cM,Kw("MuiFilledInput",["root","underline","input"])),CM=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],IM=Ex(pM,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...hM(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;var r;const i="light"===t.palette.mode,o=i?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",s=i?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=i?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=i?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return oT({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:s,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:s}},["&.".concat(MM.focused)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:s},["&.".concat(MM.disabled)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!n.disableUnderline&&{"&::after":{borderBottom:"2px solid ".concat(null==(r=(t.vars||t).palette[n.color||"primary"])?void 0:r.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(MM.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(MM.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")"):o),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(MM.disabled,", .").concat(MM.error,"):before")]:{borderBottom:"1px solid ".concat((t.vars||t).palette.text.primary)},["&.".concat(MM.disabled,":before")]:{borderBottomStyle:"dotted"}},n.startAdornment&&{paddingLeft:12},n.endAdornment&&{paddingRight:12},n.multiline&&oT({padding:"25px 12px 8px"},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9}))})),kM=Ex(fM,{name:"MuiFilledInput",slot:"Input",overridesResolver:dM})((e=>{let{theme:t,ownerState:n}=e;return oT({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})})),RM=e.forwardRef((function(e,t){var n,r,i,o;const s=Sx({props:e,name:"MuiFilledInput"}),{components:a={},componentsProps:l,fullWidth:c=!1,inputComponent:u="input",multiline:h=!1,slotProps:d,slots:p={},type:f="text"}=s,m=sT(s,CM),g=oT({},s,{fullWidth:c,inputComponent:u,multiline:h,type:f}),v=(e=>{const{classes:t,disableUnderline:n}=e;return oT({},t,ex({root:["root",!n&&"underline"],input:["input"]},xM,t))})(s),_={root:{ownerState:g},input:{ownerState:g}},b=(null!=d?d:l)?VE(_,null!=d?d:l):_,y=null!=(n=null!=(r=p.root)?r:a.Root)?n:IM,T=null!=(i=null!=(o=p.input)?o:a.Input)?i:kM;return(0,iw.jsx)(vM,oT({slots:{root:y,input:T},componentsProps:b,fullWidth:c,inputComponent:u,multiline:h,ref:t,type:f},m,{classes:v}))}));RM.muiName="Input";const AM=RM;var LM;const OM=["children","classes","className","label","notched"],NM=Ex("fieldset",{shouldForwardProp:yx})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),PM=Ex("legend",{shouldForwardProp:yx})((e=>{let{ownerState:t,theme:n}=e;return oT({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},t.withLabel&&oT({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function DM(e){return Yw("MuiOutlinedInput",e)}const $M=oT({},cM,Kw("MuiOutlinedInput",["root","notchedOutline","input"])),BM=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],FM=Ex(pM,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:hM})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return oT({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,["&:hover .".concat($M.notchedOutline)]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{["&:hover .".concat($M.notchedOutline)]:{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):r}},["&.".concat($M.focused," .").concat($M.notchedOutline)]:{borderColor:(t.vars||t).palette[n.color].main,borderWidth:2},["&.".concat($M.error," .").concat($M.notchedOutline)]:{borderColor:(t.vars||t).palette.error.main},["&.".concat($M.disabled," .").concat($M.notchedOutline)]:{borderColor:(t.vars||t).palette.action.disabled}},n.startAdornment&&{paddingLeft:14},n.endAdornment&&{paddingRight:14},n.multiline&&oT({padding:"16.5px 14px"},"small"===n.size&&{padding:"8.5px 14px"}))})),UM=Ex((function(e){const{className:t,label:n,notched:r}=e,i=sT(e,OM),o=null!=n&&""!==n,s=oT({},e,{notched:r,withLabel:o});return(0,iw.jsx)(NM,oT({"aria-hidden":!0,className:t,ownerState:s},i,{children:(0,iw.jsx)(PM,{ownerState:s,children:o?(0,iw.jsx)("span",{children:n}):LM||(LM=(0,iw.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):n}})),zM=Ex(fM,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:dM})((e=>{let{theme:t,ownerState:n}=e;return oT({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),HM=e.forwardRef((function(t,n){var r,i,o,s,a;const l=Sx({props:t,name:"MuiOutlinedInput"}),{components:c={},fullWidth:u=!1,inputComponent:h="input",label:d,multiline:p=!1,notched:f,slots:m={},type:g="text"}=l,v=sT(l,BM),_=(e=>{const{classes:t}=e;return oT({},t,ex({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},DM,t))})(l),b=Jx(),y=Kx({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),T=oT({},l,{color:y.color||"primary",disabled:y.disabled,error:y.error,focused:y.focused,formControl:b,fullWidth:u,hiddenLabel:y.hiddenLabel,multiline:p,size:y.size,type:g}),E=null!=(r=null!=(i=m.root)?i:c.Root)?r:FM,S=null!=(o=null!=(s=m.input)?s:c.Input)?o:zM;return(0,iw.jsx)(vM,oT({slots:{root:E,input:S},renderSuffix:t=>(0,iw.jsx)(UM,{ownerState:T,className:_.notchedOutline,label:null!=d&&""!==d&&y.required?a||(a=(0,iw.jsxs)(e.Fragment,{children:[d,"\u2009","*"]})):d,notched:"undefined"!==typeof f?f:Boolean(t.startAdornment||t.filled||t.focused)}),fullWidth:u,inputComponent:h,multiline:p,ref:n,type:g},v,{classes:oT({},_,{notchedOutline:null})}))}));HM.muiName="Input";const GM=HM;function VM(e){return Yw("MuiFormLabel",e)}const WM=Kw("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),jM=["children","className","color","component","disabled","error","filled","focused","required"],XM=Ex("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return oT({},t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled)}})((e=>{let{theme:t,ownerState:n}=e;return oT({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",["&.".concat(WM.focused)]:{color:(t.vars||t).palette[n.color].main},["&.".concat(WM.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(WM.error)]:{color:(t.vars||t).palette.error.main}})})),YM=Ex("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{["&.".concat(WM.error)]:{color:(t.vars||t).palette.error.main}}})),KM=e.forwardRef((function(e,t){const n=Sx({props:e,name:"MuiFormLabel"}),{children:r,className:i,component:o="label"}=n,s=sT(n,jM),a=Kx({props:n,muiFormControl:Jx(),states:["color","required","focused","disabled","error","filled"]}),l=oT({},n,{color:a.color||"primary",component:o,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),c=(e=>{const{classes:t,color:n,focused:r,disabled:i,error:o,filled:s,required:a}=e;return ex({root:["root","color".concat(_x(n)),i&&"disabled",o&&"error",s&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]},VM,t)})(l);return(0,iw.jsxs)(XM,oT({as:o,ownerState:l,className:lT(c.root,i),ref:t},s,{children:[r,a.required&&(0,iw.jsxs)(YM,{ownerState:l,"aria-hidden":!0,className:c.asterisk,children:["\u2009","*"]})]}))})),qM=KM;function JM(e){return Yw("MuiInputLabel",e)}Kw("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const ZM=["disableAnimation","margin","shrink","variant","className"],QM=Ex(qM,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["& .".concat(WM.asterisk)]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return oT({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===n.variant&&oT({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&oT({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&oT({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),eC=e.forwardRef((function(e,t){const n=Sx({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:i,className:o}=n,s=sT(n,ZM),a=Jx();let l=i;"undefined"===typeof l&&a&&(l=a.filled||a.focused||a.adornedStart);const c=Kx({props:n,muiFormControl:a,states:["size","variant","required","focused"]}),u=oT({},n,{disableAnimation:r,formControl:a,shrink:l,size:c.size,variant:c.variant,required:c.required,focused:c.focused}),h=(e=>{const{classes:t,formControl:n,size:r,shrink:i,disableAnimation:o,variant:s,required:a}=e;return oT({},t,ex({root:["root",n&&"formControl",!o&&"animated",i&&"shrink",r&&"normal"!==r&&"size".concat(_x(r)),s],asterisk:[a&&"asterisk"]},JM,t))})(u);return(0,iw.jsx)(QM,oT({"data-shrink":l,ownerState:u,ref:t,className:lT(h.root,o)},s,{classes:h}))}));const tC=function(t,n){var r,i;return e.isValidElement(t)&&-1!==n.indexOf(null!=(r=t.type.muiName)?r:null==(i=t.type)||null==(i=i._payload)||null==(i=i.value)?void 0:i.muiName)};function nC(e){return Yw("MuiFormControl",e)}Kw("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const rC=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],iC=Ex("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return oT({},t.root,t["margin".concat(_x(n.margin))],n.fullWidth&&t.fullWidth)}})((e=>{let{ownerState:t}=e;return oT({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),oC=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiFormControl"}),{children:i,className:o,color:s="primary",component:a="div",disabled:l=!1,error:c=!1,focused:u,fullWidth:h=!1,hiddenLabel:d=!1,margin:p="none",required:f=!1,size:m="medium",variant:g="outlined"}=r,v=sT(r,rC),_=oT({},r,{color:s,component:a,disabled:l,error:c,fullWidth:h,hiddenLabel:d,margin:p,required:f,size:m,variant:g}),b=(e=>{const{classes:t,margin:n,fullWidth:r}=e;return ex({root:["root","none"!==n&&"margin".concat(_x(n)),r&&"fullWidth"]},nC,t)})(_),[y,T]=e.useState((()=>{let t=!1;return i&&e.Children.forEach(i,(e=>{if(!tC(e,["Input","Select"]))return;const n=tC(e,["Select"])?e.props.input:e;n&&n.props.startAdornment&&(t=!0)})),t})),[E,S]=e.useState((()=>{let t=!1;return i&&e.Children.forEach(i,(e=>{tC(e,["Input","Select"])&&(aM(e.props,!0)||aM(e.props.inputProps,!0))&&(t=!0)})),t})),[w,x]=e.useState(!1);l&&w&&x(!1);const M=void 0===u||l?w:u;let C;const I=e.useMemo((()=>({adornedStart:y,setAdornedStart:T,color:s,disabled:l,error:c,filled:E,focused:M,fullWidth:h,hiddenLabel:d,size:m,onBlur:()=>{x(!1)},onEmpty:()=>{S(!1)},onFilled:()=>{S(!0)},onFocus:()=>{x(!0)},registerEffect:C,required:f,variant:g})),[y,s,l,c,E,M,h,d,C,f,m,g]);return(0,iw.jsx)(qx.Provider,{value:I,children:(0,iw.jsx)(iC,oT({as:a,ownerState:_,className:lT(b.root,o),ref:n},v,{children:i}))})})),sC=oC;function aC(e){return Yw("MuiFormHelperText",e)}const lC=Kw("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var cC;const uC=["children","className","component","disabled","error","filled","focused","margin","required","variant"],hC=Ex("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t["size".concat(_x(n.size))],n.contained&&t.contained,n.filled&&t.filled]}})((e=>{let{theme:t,ownerState:n}=e;return oT({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,["&.".concat(lC.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(lC.error)]:{color:(t.vars||t).palette.error.main}},"small"===n.size&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})})),dC=e.forwardRef((function(e,t){const n=Sx({props:e,name:"MuiFormHelperText"}),{children:r,className:i,component:o="p"}=n,s=sT(n,uC),a=Kx({props:n,muiFormControl:Jx(),states:["variant","size","disabled","error","filled","focused","required"]}),l=oT({},n,{component:o,contained:"filled"===a.variant||"outlined"===a.variant,variant:a.variant,size:a.size,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),c=(e=>{const{classes:t,contained:n,size:r,disabled:i,error:o,filled:s,focused:a,required:l}=e;return ex({root:["root",i&&"disabled",o&&"error",r&&"size".concat(_x(r)),n&&"contained",a&&"focused",s&&"filled",l&&"required"]},aC,t)})(l);return(0,iw.jsx)(hC,oT({as:o,ownerState:l,className:lT(c.root,i),ref:t},s,{children:" "===r?cC||(cC=(0,iw.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))}));__webpack_require__(457);const pC=Fx;function fC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n}function mC(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t}const gC=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function vC(e){var t;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:o=!1}=e,s=sT(e,gC),a=o?{}:function(e,t,n){return"function"===typeof e?e(t,n):e}(r,i),{props:l,internalRef:c}=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:o}=e;if(!t){const e=lT(null==n?void 0:n.className,o,null==i?void 0:i.className,null==r?void 0:r.className),t=oT({},null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),s=oT({},n,i,r);return e.length>0&&(s.className=e),Object.keys(t).length>0&&(s.style=t),{props:s,internalRef:void 0}}const s=fC(oT({},i,r)),a=mC(r),l=mC(i),c=t(s),u=lT(null==c?void 0:c.className,null==n?void 0:n.className,o,null==i?void 0:i.className,null==r?void 0:r.className),h=oT({},null==c?void 0:c.style,null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),d=oT({},c,n,l,a);return u.length>0&&(d.className=u),Object.keys(h).length>0&&(d.style=h),{props:d,internalRef:c.ref}}(oT({},s,{externalSlotProps:a})),u=function(e,t,n){return void 0===e||Yx(e)?t:oT({},t,{ownerState:oT({},t.ownerState,n)})}(n,oT({},l,{ref:Bx(c,null==a?void 0:a.ref,null==(t=e.additionalProps)?void 0:t.ref)}),i);return u}const _C=e.createContext({});function bC(e){return Yw("MuiList",e)}Kw("MuiList",["root","padding","dense","subheader"]);const yC=["children","className","component","dense","disablePadding","subheader"],TC=Ex("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})((e=>{let{ownerState:t}=e;return oT({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),EC=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiList"}),{children:i,className:o,component:s="ul",dense:a=!1,disablePadding:l=!1,subheader:c}=r,u=sT(r,yC),h=e.useMemo((()=>({dense:a})),[a]),d=oT({},r,{component:s,dense:a,disablePadding:l}),p=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:i}=e;return ex({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},bC,t)})(d);return(0,iw.jsx)(_C.Provider,{value:h,children:(0,iw.jsxs)(TC,oT({as:s,className:lT(p.root,o),ref:n,ownerState:d},u,{children:[c,i]}))})}));function SC(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const wC=SC,xC=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function MC(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function CC(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function IC(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:0===n.indexOf(t.keys.join("")))}function kC(e,t,n,r,i,o){let s=!1,a=i(e,t,!!t&&n);for(;a;){if(a===e.firstChild){if(s)return!1;s=!0}const t=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&IC(a,o)&&!t)return a.focus(),!0;a=i(e,a,n)}return!1}const RC=e.forwardRef((function(t,n){const{actions:r,autoFocus:i=!1,autoFocusItem:o=!1,children:s,className:a,disabledItemsFocusable:l=!1,disableListWrap:c=!1,onKeyDown:u,variant:h="selectedMenu"}=t,d=sT(t,xC),p=e.useRef(null),f=e.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Qx((()=>{i&&p.current.focus()}),[i]),e.useImperativeHandle(r,(()=>({adjustStyleForScrollbar:(e,t)=>{const n=!p.current.style.width;if(e.clientHeight<p.current.clientHeight&&n){const n="".concat(wC(pC(e)),"px");p.current.style["rtl"===t.direction?"paddingLeft":"paddingRight"]=n,p.current.style.width="calc(100% + ".concat(n,")")}return p.current}})),[]);const m=Zx(p,n);let g=-1;e.Children.forEach(s,((t,n)=>{e.isValidElement(t)?(t.props.disabled||("selectedMenu"===h&&t.props.selected||-1===g)&&(g=n),g===n&&(t.props.disabled||t.props.muiSkipListHighlight||t.type.muiSkipListHighlight)&&(g+=1,g>=s.length&&(g=-1))):g===n&&(g+=1,g>=s.length&&(g=-1))}));const v=e.Children.map(s,((t,n)=>{if(n===g){const n={};return o&&(n.autoFocus=!0),void 0===t.props.tabIndex&&"selectedMenu"===h&&(n.tabIndex=0),e.cloneElement(t,n)}return t}));return(0,iw.jsx)(EC,oT({role:"menu",ref:m,className:a,onKeyDown:e=>{const t=p.current,n=e.key,r=pC(t).activeElement;if("ArrowDown"===n)e.preventDefault(),kC(t,r,c,l,MC);else if("ArrowUp"===n)e.preventDefault(),kC(t,r,c,l,CC);else if("Home"===n)e.preventDefault(),kC(t,null,c,l,MC);else if("End"===n)e.preventDefault(),kC(t,null,c,l,CC);else if(1===n.length){const i=f.current,o=n.toLowerCase(),s=performance.now();i.keys.length>0&&(s-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&o!==i.keys[0]&&(i.repeating=!1)),i.lastTime=s,i.keys.push(o);const a=r&&!i.repeating&&IC(r,i);i.previousKeyMatched&&(a||kC(t,r,!1,l,MC,i))?e.preventDefault():i.previousKeyMatched=!1}u&&u(e)},tabIndex:i?0:-1},d,{children:v}))})),AC=Hx,LC=Ux,OC={};const NC=[];class PC{constructor(){this.currentId=0,this.clear=()=>{0!==this.currentId&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new PC}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=0,t()}),e)}}function DC(){const t=function(t,n){const r=e.useRef(OC);return r.current===OC&&(r.current=t(n)),r}(PC.create).current;var n;return n=t.disposeEffect,e.useEffect(n,NC),t}function $C(e,t){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$C(e,t)}function BC(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,$C(e,t)}const FC=!1,UC=e.createContext(null);var zC="unmounted",HC="exited",GC="entering",VC="entered",WC="exiting",jC=function(t){function n(e,n){var r;r=t.call(this,e,n)||this;var i,o=n&&!n.isMounting?e.enter:e.appear;return r.appearStatus=null,e.in?o?(i=HC,r.appearStatus=GC):i=VC:i=e.unmountOnExit||e.mountOnEnter?zC:HC,r.state={status:i},r.nextCallback=null,r}BC(n,t),n.getDerivedStateFromProps=function(e,t){return e.in&&t.status===zC?{status:HC}:null};var r=n.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==GC&&n!==VC&&(t=GC):n!==GC&&n!==VC||(t=WC)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===GC){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:Dx.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===HC&&this.setState({status:zC})},r.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[Dx.findDOMNode(this),r],o=i[0],s=i[1],a=this.getTimeouts(),l=r?a.appear:a.enter;!e&&!n||FC?this.safeSetState({status:VC},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,s),this.safeSetState({status:GC},(function(){t.props.onEntering(o,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:VC},(function(){t.props.onEntered(o,s)}))}))})))},r.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:Dx.findDOMNode(this);t&&!FC?(this.props.onExit(r),this.safeSetState({status:WC},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:HC},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:HC},(function(){e.props.onExited(r)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:Dx.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=i[0],s=i[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var t=this.state.status;if(t===zC)return null;var n=this.props,r=n.children,i=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,sT(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return e.createElement(UC.Provider,{value:null},"function"===typeof r?r(t,i):e.cloneElement(e.Children.only(r),i))},n}(e.Component);function XC(){}jC.contextType=UC,jC.propTypes={},jC.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:XC,onEntering:XC,onEntered:XC,onExit:XC,onExiting:XC,onExited:XC},jC.UNMOUNTED=zC,jC.EXITED=HC,jC.ENTERING=GC,jC.ENTERED=VC,jC.EXITING=WC;const YC=jC;function KC(){const e=rw(bx);return e[jw]||e}const qC=e=>e.scrollTop;function JC(e,t){var n,r;const{timeout:i,easing:o,style:s={}}=e;return{duration:null!=(n=s.transitionDuration)?n:"number"===typeof i?i:i[t.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"===typeof o?o[t.mode]:o,delay:s.transitionDelay}}const ZC=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function QC(e){return"scale(".concat(e,", ").concat(e**2,")")}const eI={entering:{opacity:1,transform:QC(1)},entered:{opacity:1,transform:"none"}},tI="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),nI=e.forwardRef((function(t,n){const{addEndListener:r,appear:i=!0,children:o,easing:s,in:a,onEnter:l,onEntered:c,onEntering:u,onExit:h,onExited:d,onExiting:p,style:f,timeout:m="auto",TransitionComponent:g=YC}=t,v=sT(t,ZC),_=DC(),b=e.useRef(),y=KC(),T=e.useRef(null),E=Zx(T,o.ref,n),S=e=>t=>{if(e){const n=T.current;void 0===t?e(n):e(n,t)}},w=S(u),x=S(((e,t)=>{qC(e);const{duration:n,delay:r,easing:i}=JC({style:f,timeout:m,easing:s},{mode:"enter"});let o;"auto"===m?(o=y.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=n,e.style.transition=[y.transitions.create("opacity",{duration:o,delay:r}),y.transitions.create("transform",{duration:tI?o:.666*o,delay:r,easing:i})].join(","),l&&l(e,t)})),M=S(c),C=S(p),I=S((e=>{const{duration:t,delay:n,easing:r}=JC({style:f,timeout:m,easing:s},{mode:"exit"});let i;"auto"===m?(i=y.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=t,e.style.transition=[y.transitions.create("opacity",{duration:i,delay:n}),y.transitions.create("transform",{duration:tI?i:.666*i,delay:tI?n:n||.333*i,easing:r})].join(","),e.style.opacity=0,e.style.transform=QC(.75),h&&h(e)})),k=S(d);return(0,iw.jsx)(g,oT({appear:i,in:a,nodeRef:T,onEnter:x,onEntered:M,onEntering:w,onExit:I,onExited:k,onExiting:C,addEndListener:e=>{"auto"===m&&_.start(b.current||0,e),r&&r(T.current,e)},timeout:"auto"===m?null:m},v,{children:(t,n)=>e.cloneElement(o,oT({style:oT({opacity:0,transform:QC(.75),visibility:"exited"!==t||a?void 0:"hidden"},eI[t],f,o.props.style),ref:E},n))}))}));nI.muiSupportAuto=!0;const rI=nI;const iI=function(t){const n=e.useRef(t);return zx((()=>{n.current=t})),e.useRef((function(){return(0,n.current)(...arguments)})).current};function oI(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>null==t?e:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r),t.apply(this,r)}),(()=>{}))}function sI(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function aI(e){return parseInt(Ux(e).getComputedStyle(e).paddingRight,10)||0}function lI(e,t,n,r,i){const o=[t,n,...r];[].forEach.call(e.children,(e=>{const t=-1===o.indexOf(e),n=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&sI(e,i)}))}function cI(e,t){let n=-1;return e.some(((e,r)=>!!t(e)&&(n=r,!0))),n}function uI(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=Fx(e);return t.body===e?Ux(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=SC(Fx(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight="".concat(aI(r)+e,"px");const t=Fx(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight="".concat(aI(t)+e,"px")}))}let e;if(r.parentNode instanceof DocumentFragment)e=Fx(r).body;else{const t=r.parentElement,n=Ux(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach((e=>{let{value:t,el:n,property:r}=e;t?n.style.setProperty(r,t):n.style.removeProperty(r)}))}}const hI=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&sI(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);lI(t,e.mount,e.modalRef,r,!0);const i=cI(this.containers,(e=>e.container===t));return-1!==i?(this.containers[i].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=cI(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[n];r.restore||(r.restore=uI(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.modals.indexOf(e);if(-1===n)return n;const r=cI(this.containers,(t=>-1!==t.modals.indexOf(e))),i=this.containers[r];if(i.modals.splice(i.modals.indexOf(e),1),this.modals.splice(n,1),0===i.modals.length)i.restore&&i.restore(),e.modalRef&&sI(e.modalRef,t),lI(i.container,e.mount,e.modalRef,i.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=i.modals[i.modals.length-1];e.modalRef&&sI(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};function dI(t){const{container:n,disableEscapeKeyDown:r=!1,disableScrollLock:i=!1,manager:o=hI,closeAfterTransition:s=!1,onTransitionEnter:a,onTransitionExited:l,children:c,onClose:u,open:h,rootRef:d}=t,p=e.useRef({}),f=e.useRef(null),m=e.useRef(null),g=Bx(m,d),[v,_]=e.useState(!h),b=function(e){return!!e&&e.props.hasOwnProperty("in")}(c);let y=!0;"false"!==t["aria-hidden"]&&!1!==t["aria-hidden"]||(y=!1);const T=()=>(p.current.modalRef=m.current,p.current.mount=f.current,p.current),E=()=>{o.mount(T(),{disableScrollLock:i}),m.current&&(m.current.scrollTop=0)},S=iI((()=>{const e=function(e){return"function"===typeof e?e():e}(n)||Fx(f.current).body;o.add(T(),e),m.current&&E()})),w=e.useCallback((()=>o.isTopModal(T())),[o]),x=iI((e=>{f.current=e,e&&(h&&w()?E():m.current&&sI(m.current,y))})),M=e.useCallback((()=>{o.remove(T(),y)}),[y,o]);e.useEffect((()=>()=>{M()}),[M]),e.useEffect((()=>{h?S():b&&s||M()}),[h,M,b,s,S]);const C=e=>t=>{var n;null==(n=e.onKeyDown)||n.call(e,t),"Escape"===t.key&&229!==t.which&&w()&&(r||(t.stopPropagation(),u&&u(t,"escapeKeyDown")))},I=e=>t=>{var n;null==(n=e.onClick)||n.call(e,t),t.target===t.currentTarget&&u&&u(t,"backdropClick")};return{getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=fC(t);delete n.onTransitionEnter,delete n.onTransitionExited;const r=oT({},n,e);return oT({role:"presentation"},r,{onKeyDown:C(r),ref:g})},getBackdropProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return oT({"aria-hidden":!0},e,{onClick:I(e),open:h})},getTransitionProps:()=>({onEnter:oI((()=>{_(!1),a&&a()}),null==c?void 0:c.props.onEnter),onExited:oI((()=>{_(!0),l&&l(),s&&M()}),null==c?void 0:c.props.onExited)}),rootRef:g,portalRef:x,isTopModal:w,exited:v,hasTransition:b}}const pI=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function fI(e){const t=[],n=[];return Array.from(e.querySelectorAll(pI)).forEach(((e,r)=>{const i=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==i&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector('input[type="radio"]'.concat(t));let n=t('[name="'.concat(e.name,'"]:checked'));return n||(n=t('[name="'.concat(e.name,'"]'))),n!==e}(e))}(e)&&(0===i?t.push(e):n.push({documentOrder:r,tabIndex:i,node:e}))})),n.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function mI(){return!0}function gI(t){const{children:n,disableAutoFocus:r=!1,disableEnforceFocus:i=!1,disableRestoreFocus:o=!1,getTabbable:s=fI,isEnabled:a=mI,open:l}=t,c=e.useRef(!1),u=e.useRef(null),h=e.useRef(null),d=e.useRef(null),p=e.useRef(null),f=e.useRef(!1),m=e.useRef(null),g=Bx(n.ref,m),v=e.useRef(null);e.useEffect((()=>{l&&m.current&&(f.current=!r)}),[r,l]),e.useEffect((()=>{if(!l||!m.current)return;const e=Fx(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),f.current&&m.current.focus()),()=>{o||(d.current&&d.current.focus&&(c.current=!0,d.current.focus()),d.current=null)}}),[l]),e.useEffect((()=>{if(!l||!m.current)return;const e=Fx(m.current),t=t=>{v.current=t,!i&&a()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(c.current=!0,h.current&&h.current.focus())},n=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!a()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(i&&e.activeElement!==u.current&&e.activeElement!==h.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!f.current)return;let n=[];if(e.activeElement!==u.current&&e.activeElement!==h.current||(n=s(m.current)),n.length>0){var r,o;const e=Boolean((null==(r=v.current)?void 0:r.shiftKey)&&"Tab"===(null==(o=v.current)?void 0:o.key)),t=n[0],i=n[n.length-1];"string"!==typeof t&&"string"!==typeof i&&(e?i.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const r=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()}),50);return()=>{clearInterval(r),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}}),[r,i,o,a,l,s]);const _=e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0};return(0,iw.jsxs)(e.Fragment,{children:[(0,iw.jsx)("div",{tabIndex:l?0:-1,onFocus:_,ref:u,"data-testid":"sentinelStart"}),e.cloneElement(n,{ref:g,onFocus:e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0,p.current=e.target;const t=n.props.onFocus;t&&t(e)}}),(0,iw.jsx)("div",{tabIndex:l?0:-1,onFocus:_,ref:h,"data-testid":"sentinelEnd"})]})}const vI=e.forwardRef((function(t,n){const{children:r,container:i,disablePortal:o=!1}=t,[s,a]=e.useState(null),l=Bx(e.isValidElement(r)?r.ref:null,n);if(zx((()=>{o||a(function(e){return"function"===typeof e?e():e}(i)||document.body)}),[i,o]),zx((()=>{if(s&&!o)return $x(n,s),()=>{$x(n,null)}}),[n,s,o]),o){if(e.isValidElement(r)){const t={ref:l};return e.cloneElement(r,t)}return(0,iw.jsx)(e.Fragment,{children:r})}return(0,iw.jsx)(e.Fragment,{children:s?Dx.createPortal(r,s):s})}));const _I=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],bI={entering:{opacity:1},entered:{opacity:1}},yI=e.forwardRef((function(t,n){const r=KC(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:s=!0,children:a,easing:l,in:c,onEnter:u,onEntered:h,onEntering:d,onExit:p,onExited:f,onExiting:m,style:g,timeout:v=i,TransitionComponent:_=YC}=t,b=sT(t,_I),y=e.useRef(null),T=Zx(y,a.ref,n),E=e=>t=>{if(e){const n=y.current;void 0===t?e(n):e(n,t)}},S=E(d),w=E(((e,t)=>{qC(e);const n=JC({style:g,timeout:v,easing:l},{mode:"enter"});e.style.webkitTransition=r.transitions.create("opacity",n),e.style.transition=r.transitions.create("opacity",n),u&&u(e,t)})),x=E(h),M=E(m),C=E((e=>{const t=JC({style:g,timeout:v,easing:l},{mode:"exit"});e.style.webkitTransition=r.transitions.create("opacity",t),e.style.transition=r.transitions.create("opacity",t),p&&p(e)})),I=E(f);return(0,iw.jsx)(_,oT({appear:s,in:c,nodeRef:y,onEnter:w,onEntered:x,onEntering:S,onExit:C,onExited:I,onExiting:M,addEndListener:e=>{o&&o(y.current,e)},timeout:v},b,{children:(t,n)=>e.cloneElement(a,oT({style:oT({opacity:0,visibility:"exited"!==t||c?void 0:"hidden"},bI[t],g,a.props.style),ref:T},n))}))})),TI=yI;function EI(e){return Yw("MuiBackdrop",e)}Kw("MuiBackdrop",["root","invisible"]);const SI=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],wI=Ex("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})((e=>{let{ownerState:t}=e;return oT({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),xI=e.forwardRef((function(e,t){var n,r,i;const o=Sx({props:e,name:"MuiBackdrop"}),{children:s,className:a,component:l="div",components:c={},componentsProps:u={},invisible:h=!1,open:d,slotProps:p={},slots:f={},TransitionComponent:m=TI,transitionDuration:g}=o,v=sT(o,SI),_=oT({},o,{component:l,invisible:h}),b=(e=>{const{classes:t,invisible:n}=e;return ex({root:["root",n&&"invisible"]},EI,t)})(_),y=null!=(n=p.root)?n:u.root;return(0,iw.jsx)(m,oT({in:d,timeout:g},v,{children:(0,iw.jsx)(wI,oT({"aria-hidden":!0},y,{as:null!=(r=null!=(i=f.root)?i:c.Root)?r:l,className:lT(b.root,a,null==y?void 0:y.className),ownerState:oT({},_,null==y?void 0:y.ownerState),classes:b,ref:t,children:s}))}))}));function MI(e){return Yw("MuiModal",e)}Kw("MuiModal",["root","hidden","backdrop"]);const CI=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],II=Ex("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})((e=>{let{theme:t,ownerState:n}=e;return oT({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),kI=Ex(xI,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),RI=e.forwardRef((function(t,n){var r,i,o,s,a,l;const c=Sx({name:"MuiModal",props:t}),{BackdropComponent:u=kI,BackdropProps:h,className:d,closeAfterTransition:p=!1,children:f,container:m,component:g,components:v={},componentsProps:_={},disableAutoFocus:b=!1,disableEnforceFocus:y=!1,disableEscapeKeyDown:T=!1,disablePortal:E=!1,disableRestoreFocus:S=!1,disableScrollLock:w=!1,hideBackdrop:x=!1,keepMounted:M=!1,onBackdropClick:C,open:I,slotProps:k,slots:R}=c,A=sT(c,CI),L=oT({},c,{closeAfterTransition:p,disableAutoFocus:b,disableEnforceFocus:y,disableEscapeKeyDown:T,disablePortal:E,disableRestoreFocus:S,disableScrollLock:w,hideBackdrop:x,keepMounted:M}),{getRootProps:O,getBackdropProps:N,getTransitionProps:P,portalRef:D,isTopModal:$,exited:B,hasTransition:F}=dI(oT({},L,{rootRef:n})),U=oT({},L,{exited:B}),z=(e=>{const{open:t,exited:n,classes:r}=e;return ex({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},MI,r)})(U),H={};if(void 0===f.props.tabIndex&&(H.tabIndex="-1"),F){const{onEnter:e,onExited:t}=P();H.onEnter=e,H.onExited=t}const G=null!=(r=null!=(i=null==R?void 0:R.root)?i:v.Root)?r:II,V=null!=(o=null!=(s=null==R?void 0:R.backdrop)?s:v.Backdrop)?o:u,W=null!=(a=null==k?void 0:k.root)?a:_.root,j=null!=(l=null==k?void 0:k.backdrop)?l:_.backdrop,X=vC({elementType:G,externalSlotProps:W,externalForwardedProps:A,getSlotProps:O,additionalProps:{ref:n,as:g},ownerState:U,className:lT(d,null==W?void 0:W.className,null==z?void 0:z.root,!U.open&&U.exited&&(null==z?void 0:z.hidden))}),Y=vC({elementType:V,externalSlotProps:j,additionalProps:h,getSlotProps:e=>N(oT({},e,{onClick:t=>{C&&C(t),null!=e&&e.onClick&&e.onClick(t)}})),className:lT(null==j?void 0:j.className,null==h?void 0:h.className,null==z?void 0:z.backdrop),ownerState:U});return M||I||F&&!B?(0,iw.jsx)(vI,{ref:D,container:m,disablePortal:E,children:(0,iw.jsxs)(G,oT({},X,{children:[!x&&u?(0,iw.jsx)(V,oT({},Y)):null,(0,iw.jsx)(gI,{disableEnforceFocus:y,disableAutoFocus:b,disableRestoreFocus:S,isEnabled:$,open:I,children:e.cloneElement(f,H)})]}))}):null})),AI=RI,LI=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function OI(e){return Yw("MuiPaper",e)}Kw("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const NI=["className","component","elevation","square","variant"],PI=Ex("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t["elevation".concat(n.elevation)]]}})((e=>{let{theme:t,ownerState:n}=e;var r;return oT({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!n.square&&{borderRadius:t.shape.borderRadius},"outlined"===n.variant&&{border:"1px solid ".concat((t.vars||t).palette.divider)},"elevation"===n.variant&&oT({boxShadow:(t.vars||t).shadows[n.elevation]},!t.vars&&"dark"===t.palette.mode&&{backgroundImage:"linear-gradient(".concat(fw("#fff",LI(n.elevation)),", ").concat(fw("#fff",LI(n.elevation)),")")},t.vars&&{backgroundImage:null==(r=t.vars.overlays)?void 0:r[n.elevation]}))})),DI=e.forwardRef((function(e,t){const n=Sx({props:e,name:"MuiPaper"}),{className:r,component:i="div",elevation:o=1,square:s=!1,variant:a="elevation"}=n,l=sT(n,NI),c=oT({},n,{component:i,elevation:o,square:s,variant:a}),u=(e=>{const{square:t,elevation:n,variant:r,classes:i}=e;return ex({root:["root",r,!t&&"rounded","elevation"===r&&"elevation".concat(n)]},OI,i)})(c);return(0,iw.jsx)(PI,oT({as:i,ownerState:c,className:lT(u.root,r),ref:t},l))}));function $I(e){return Yw("MuiPopover",e)}Kw("MuiPopover",["root","paper"]);const BI=["onEntering"],FI=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],UI=["slotProps"];function zI(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function HI(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function GI(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?"".concat(e,"px"):e)).join(" ")}function VI(e){return"function"===typeof e?e():e}const WI=Ex(AI,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),jI=Ex(DI,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),XI=e.forwardRef((function(t,n){var r,i,o;const s=Sx({props:t,name:"MuiPopover"}),{action:a,anchorEl:l,anchorOrigin:c={vertical:"top",horizontal:"left"},anchorPosition:u,anchorReference:h="anchorEl",children:d,className:p,container:f,elevation:m=8,marginThreshold:g=16,open:v,PaperProps:_={},slots:b,slotProps:y,transformOrigin:T={vertical:"top",horizontal:"left"},TransitionComponent:E=rI,transitionDuration:S="auto",TransitionProps:{onEntering:w}={},disableScrollLock:x=!1}=s,M=sT(s.TransitionProps,BI),C=sT(s,FI),I=null!=(r=null==y?void 0:y.paper)?r:_,k=e.useRef(),R=Zx(k,I.ref),A=oT({},s,{anchorOrigin:c,anchorReference:h,elevation:m,marginThreshold:g,externalPaperSlotProps:I,transformOrigin:T,TransitionComponent:E,transitionDuration:S,TransitionProps:M}),L=(e=>{const{classes:t}=e;return ex({root:["root"],paper:["paper"]},$I,t)})(A),O=e.useCallback((()=>{if("anchorPosition"===h)return u;const e=VI(l),t=(e&&1===e.nodeType?e:pC(k.current).body).getBoundingClientRect();return{top:t.top+zI(t,c.vertical),left:t.left+HI(t,c.horizontal)}}),[l,c.horizontal,c.vertical,u,h]),N=e.useCallback((e=>({vertical:zI(e,T.vertical),horizontal:HI(e,T.horizontal)})),[T.horizontal,T.vertical]),P=e.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=N(t);if("none"===h)return{top:null,left:null,transformOrigin:GI(n)};const r=O();let i=r.top-n.vertical,o=r.left-n.horizontal;const s=i+t.height,a=o+t.width,c=LC(VI(l)),u=c.innerHeight-g,d=c.innerWidth-g;if(null!==g&&i<g){const e=i-g;i-=e,n.vertical+=e}else if(null!==g&&s>u){const e=s-u;i-=e,n.vertical+=e}if(null!==g&&o<g){const e=o-g;o-=e,n.horizontal+=e}else if(a>d){const e=a-d;o-=e,n.horizontal+=e}return{top:"".concat(Math.round(i),"px"),left:"".concat(Math.round(o),"px"),transformOrigin:GI(n)}}),[l,h,O,N,g]),[D,$]=e.useState(v),B=e.useCallback((()=>{const e=k.current;if(!e)return;const t=P(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,$(!0)}),[P]);e.useEffect((()=>(x&&window.addEventListener("scroll",B),()=>window.removeEventListener("scroll",B))),[l,x,B]);e.useEffect((()=>{v&&B()})),e.useImperativeHandle(a,(()=>v?{updatePosition:()=>{B()}}:null),[v,B]),e.useEffect((()=>{if(!v)return;const e=AC((()=>{B()})),t=LC(l);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[l,v,B]);let F=S;"auto"!==S||E.muiSupportAuto||(F=void 0);const U=f||(l?pC(VI(l)).body:void 0),z=null!=(i=null==b?void 0:b.root)?i:WI,H=null!=(o=null==b?void 0:b.paper)?o:jI,G=vC({elementType:H,externalSlotProps:oT({},I,{style:D?I.style:oT({},I.style,{opacity:0})}),additionalProps:{elevation:m,ref:R},ownerState:A,className:lT(L.paper,null==I?void 0:I.className)}),V=vC({elementType:z,externalSlotProps:(null==y?void 0:y.root)||{},externalForwardedProps:C,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:U,open:v},ownerState:A,className:lT(L.root,p)}),{slotProps:W}=V,j=sT(V,UI);return(0,iw.jsx)(z,oT({},j,!Yx(z)&&{slotProps:W,disableScrollLock:x},{children:(0,iw.jsx)(E,oT({appear:!0,in:v,onEntering:(e,t)=>{w&&w(e,t),B()},onExited:()=>{$(!1)},timeout:F},M,{children:(0,iw.jsx)(H,oT({},G,{children:d}))}))}))}));function YI(e){return Yw("MuiMenu",e)}Kw("MuiMenu",["root","paper","list"]);const KI=["onEntering"],qI=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],JI={vertical:"top",horizontal:"right"},ZI={vertical:"top",horizontal:"left"},QI=Ex(XI,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),ek=Ex(jI,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),tk=Ex(RC,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),nk=e.forwardRef((function(t,n){var r,i;const o=Sx({props:t,name:"MuiMenu"}),{autoFocus:s=!0,children:a,className:l,disableAutoFocusItem:c=!1,MenuListProps:u={},onClose:h,open:d,PaperProps:p={},PopoverClasses:f,transitionDuration:m="auto",TransitionProps:{onEntering:g}={},variant:v="selectedMenu",slots:_={},slotProps:b={}}=o,y=sT(o.TransitionProps,KI),T=sT(o,qI),E=KC(),S="rtl"===E.direction,w=oT({},o,{autoFocus:s,disableAutoFocusItem:c,MenuListProps:u,onEntering:g,PaperProps:p,transitionDuration:m,TransitionProps:y,variant:v}),x=(e=>{const{classes:t}=e;return ex({root:["root"],paper:["paper"],list:["list"]},YI,t)})(w),M=s&&!c&&d,C=e.useRef(null);let I=-1;e.Children.map(a,((t,n)=>{e.isValidElement(t)&&(t.props.disabled||("selectedMenu"===v&&t.props.selected||-1===I)&&(I=n))}));const k=null!=(r=_.paper)?r:ek,R=null!=(i=b.paper)?i:p,A=vC({elementType:_.root,externalSlotProps:b.root,ownerState:w,className:[x.root,l]}),L=vC({elementType:k,externalSlotProps:R,ownerState:w,className:x.paper});return(0,iw.jsx)(QI,oT({onClose:h,anchorOrigin:{vertical:"bottom",horizontal:S?"right":"left"},transformOrigin:S?JI:ZI,slots:{paper:k,root:_.root},slotProps:{root:A,paper:L},open:d,ref:n,transitionDuration:m,TransitionProps:oT({onEntering:(e,t)=>{C.current&&C.current.adjustStyleForScrollbar(e,E),g&&g(e,t)}},y),ownerState:w},T,{classes:f,children:(0,iw.jsx)(tk,oT({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),h&&h(e,"tabKeyDown"))},actions:C,autoFocus:s&&(-1===I||c),autoFocusItem:M,variant:v},u,{className:lT(x.list,u.className),children:a}))}))}));function rk(e){return Yw("MuiNativeSelect",e)}const ik=Kw("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),ok=["className","disabled","error","IconComponent","inputRef","variant"],sk=e=>{let{ownerState:t,theme:n}=e;return oT({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":oT({},n.vars?{backgroundColor:"rgba(".concat(n.vars.palette.common.onBackgroundChannel," / 0.05)")}:{backgroundColor:"light"===n.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},["&.".concat(ik.disabled)]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}})},ak=Ex("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:yx,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{["&.".concat(ik.multiple)]:t.multiple}]}})(sk),lk=e=>{let{ownerState:t,theme:n}=e;return oT({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,["&.".concat(ik.disabled)]:{color:(n.vars||n).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},ck=Ex("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t["icon".concat(_x(n.variant))],n.open&&t.iconOpen]}})(lk),uk=e.forwardRef((function(t,n){const{className:r,disabled:i,error:o,IconComponent:s,inputRef:a,variant:l="standard"}=t,c=sT(t,ok),u=oT({},t,{disabled:i,variant:l,error:o}),h=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:o,error:s}=e;return ex({select:["select",n,r&&"disabled",i&&"multiple",s&&"error"],icon:["icon","icon".concat(_x(n)),o&&"iconOpen",r&&"disabled"]},rk,t)})(u);return(0,iw.jsxs)(e.Fragment,{children:[(0,iw.jsx)(ak,oT({ownerState:u,className:lT(h.select,r),disabled:i,ref:a||n},c)),t.multiple?null:(0,iw.jsx)(ck,{as:s,ownerState:u,className:h.icon})]})}));const hk=function(t){let{controlled:n,default:r,name:i,state:o="value"}=t;const{current:s}=e.useRef(void 0!==n),[a,l]=e.useState(r);return[s?n:a,e.useCallback((e=>{s||l(e)}),[])]};function dk(e){return Yw("MuiSelect",e)}const pk=Kw("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var fk;const mk=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],gk=Ex("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["&.".concat(pk.select)]:t.select},{["&.".concat(pk.select)]:t[n.variant]},{["&.".concat(pk.error)]:t.error},{["&.".concat(pk.multiple)]:t.multiple}]}})(sk,{["&.".concat(pk.select)]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),vk=Ex("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t["icon".concat(_x(n.variant))],n.open&&t.iconOpen]}})(lk),_k=Ex("input",{shouldForwardProp:e=>Tx(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function bk(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function yk(e){return null==e||"string"===typeof e&&!e.trim()}const Tk=e.forwardRef((function(t,n){var r;const{"aria-describedby":i,"aria-label":o,autoFocus:s,autoWidth:a,children:l,className:c,defaultOpen:u,defaultValue:h,disabled:d,displayEmpty:p,error:f=!1,IconComponent:m,inputRef:g,labelId:v,MenuProps:_={},multiple:b,name:y,onBlur:T,onChange:E,onClose:S,onFocus:w,onOpen:x,open:M,readOnly:C,renderValue:I,SelectDisplayProps:k={},tabIndex:R,value:A,variant:L="standard"}=t,O=sT(t,mk),[N,P]=hk({controlled:A,default:h,name:"Select"}),[D,$]=hk({controlled:M,default:u,name:"Select"}),B=e.useRef(null),F=e.useRef(null),[U,z]=e.useState(null),{current:H}=e.useRef(null!=M),[G,V]=e.useState(),W=Zx(n,g),j=e.useCallback((e=>{F.current=e,e&&z(e)}),[]),X=null==U?void 0:U.parentNode;e.useImperativeHandle(W,(()=>({focus:()=>{F.current.focus()},node:B.current,value:N})),[N]),e.useEffect((()=>{u&&D&&U&&!H&&(V(a?null:X.clientWidth),F.current.focus())}),[U,a]),e.useEffect((()=>{s&&F.current.focus()}),[s]),e.useEffect((()=>{if(!v)return;const e=pC(F.current).getElementById(v);if(e){const t=()=>{getSelection().isCollapsed&&F.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[v]);const Y=(e,t)=>{e?x&&x(t):S&&S(t),H||(V(a?null:X.clientWidth),$(e))},K=e.Children.toArray(l),q=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(b){n=Array.isArray(N)?N.slice():[];const t=N.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),N!==n&&(P(n),E)){const r=t.nativeEvent||t,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:n,name:y}}),E(i,e)}b||Y(!1,t)}},J=null!==U&&D;let Z,Q;delete O["aria-invalid"];const ee=[];let te=!1,ne=!1;(aM({value:N})||p)&&(I?Z=I(N):te=!0);const re=K.map((t=>{if(!e.isValidElement(t))return null;let n;if(b){if(!Array.isArray(N))throw new Error(UE(2));n=N.some((e=>bk(e,t.props.value))),n&&te&&ee.push(t.props.children)}else n=bk(N,t.props.value),n&&te&&(Q=t.props.children);return n&&(ne=!0),e.cloneElement(t,{"aria-selected":n?"true":"false",onClick:q(t),onKeyUp:e=>{" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:n,value:void 0,"data-value":t.props.value})}));te&&(Z=b?0===ee.length?null:ee.reduce(((e,t,n)=>(e.push(t),n<ee.length-1&&e.push(", "),e)),[]):Q);let ie,oe=G;!a&&H&&U&&(oe=X.clientWidth),ie="undefined"!==typeof R?R:d?null:0;const se=k.id||(y?"mui-component-select-".concat(y):void 0),ae=oT({},t,{variant:L,value:N,open:J,error:f}),le=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:o,error:s}=e;return ex({select:["select",n,r&&"disabled",i&&"multiple",s&&"error"],icon:["icon","icon".concat(_x(n)),o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},dk,t)})(ae),ce=oT({},_.PaperProps,null==(r=_.slotProps)?void 0:r.paper),ue=Px();return(0,iw.jsxs)(e.Fragment,{children:[(0,iw.jsx)(gk,oT({ref:j,tabIndex:ie,role:"combobox","aria-controls":ue,"aria-disabled":d?"true":void 0,"aria-expanded":J?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[v,se].filter(Boolean).join(" ")||void 0,"aria-describedby":i,onKeyDown:e=>{if(!C){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),Y(!0,e))}},onMouseDown:d||C?null:e=>{0===e.button&&(e.preventDefault(),F.current.focus(),Y(!0,e))},onBlur:e=>{!J&&T&&(Object.defineProperty(e,"target",{writable:!0,value:{value:N,name:y}}),T(e))},onFocus:w},k,{ownerState:ae,className:lT(k.className,le.select,c),id:se,children:yk(Z)?fk||(fk=(0,iw.jsx)("span",{className:"notranslate",children:"\u200b"})):Z})),(0,iw.jsx)(_k,oT({"aria-invalid":f,value:Array.isArray(N)?N.join(","):N,name:y,ref:B,"aria-hidden":!0,onChange:e=>{const t=K.find((t=>t.props.value===e.target.value));void 0!==t&&(P(t.props.value),E&&E(e,t))},tabIndex:-1,disabled:d,className:le.nativeInput,autoFocus:s,ownerState:ae},O)),(0,iw.jsx)(vk,{as:m,className:le.icon,ownerState:ae}),(0,iw.jsx)(nk,oT({id:"menu-".concat(y||""),anchorEl:X,open:J,onClose:e=>{Y(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},_,{MenuListProps:oT({"aria-labelledby":v,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:ue},_.MenuListProps),slotProps:oT({},_.slotProps,{paper:oT({},ce,{style:oT({minWidth:oe},null!=ce?ce.style:null)})}),children:re}))]})})),Ek=Tk;function Sk(e){return Yw("MuiSvgIcon",e)}Kw("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const wk=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],xk=Ex("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t["color".concat(_x(n.color))],t["fontSize".concat(_x(n.fontSize))]]}})((e=>{let{theme:t,ownerState:n}=e;var r,i,o,s,a,l,c,u,h,d,p,f,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=t.transitions)||null==(i=r.create)?void 0:i.call(r,"fill",{duration:null==(o=t.transitions)||null==(o=o.duration)?void 0:o.shorter}),fontSize:{inherit:"inherit",small:(null==(s=t.typography)||null==(a=s.pxToRem)?void 0:a.call(s,20))||"1.25rem",medium:(null==(l=t.typography)||null==(c=l.pxToRem)?void 0:c.call(l,24))||"1.5rem",large:(null==(u=t.typography)||null==(h=u.pxToRem)?void 0:h.call(u,35))||"2.1875rem"}[n.fontSize],color:null!=(d=null==(p=(t.vars||t).palette)||null==(p=p[n.color])?void 0:p.main)?d:{action:null==(f=(t.vars||t).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(m=(t.vars||t).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0}[n.color]}})),Mk=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiSvgIcon"}),{children:i,className:o,color:s="inherit",component:a="svg",fontSize:l="medium",htmlColor:c,inheritViewBox:u=!1,titleAccess:h,viewBox:d="0 0 24 24"}=r,p=sT(r,wk),f=e.isValidElement(i)&&"svg"===i.type,m=oT({},r,{color:s,component:a,fontSize:l,instanceFontSize:t.fontSize,inheritViewBox:u,viewBox:d,hasSvgAsChild:f}),g={};u||(g.viewBox=d);const v=(e=>{const{color:t,fontSize:n,classes:r}=e;return ex({root:["root","inherit"!==t&&"color".concat(_x(t)),"fontSize".concat(_x(n))]},Sk,r)})(m);return(0,iw.jsxs)(xk,oT({as:a,className:lT(v.root,o),focusable:"false",color:c,"aria-hidden":!h||void 0,role:h?"img":void 0,ref:n},g,p,f&&i.props,{ownerState:m,children:[f?i.props.children:i,h?(0,iw.jsx)("title",{children:h}):null]}))}));Mk.muiName="SvgIcon";const Ck=Mk;const Ik=function(t,n){function r(e,r){return(0,iw.jsx)(Ck,oT({"data-testid":"".concat(n,"Icon"),ref:r},e,{children:t}))}return r.muiName=Ck.muiName,e.memo(e.forwardRef(r))}((0,iw.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),kk=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Rk=["root"],Ak={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>yx(e)&&"variant"!==e,slot:"Root"},Lk=Ex(wM,Ak)(""),Ok=Ex(GM,Ak)(""),Nk=Ex(AM,Ak)(""),Pk=e.forwardRef((function(t,n){const r=Sx({name:"MuiSelect",props:t}),{autoWidth:i=!1,children:o,classes:s={},className:a,defaultOpen:l=!1,displayEmpty:c=!1,IconComponent:u=Ik,id:h,input:d,inputProps:p,label:f,labelId:m,MenuProps:g,multiple:v=!1,native:_=!1,onClose:b,onOpen:y,open:T,renderValue:E,SelectDisplayProps:S,variant:w="outlined"}=r,x=sT(r,kk),M=_?uk:Ek,C=Kx({props:r,muiFormControl:Jx(),states:["variant","error"]}),I=C.variant||w,k=oT({},r,{variant:I,classes:s}),R=(e=>{const{classes:t}=e;return t})(k),A=sT(R,Rk),L=d||{standard:(0,iw.jsx)(Lk,{ownerState:k}),outlined:(0,iw.jsx)(Ok,{label:f,ownerState:k}),filled:(0,iw.jsx)(Nk,{ownerState:k})}[I],O=Zx(n,L.ref);return(0,iw.jsx)(e.Fragment,{children:e.cloneElement(L,oT({inputComponent:M,inputProps:oT({children:o,error:C.error,IconComponent:u,variant:I,type:void 0,multiple:v},_?{id:h}:{autoWidth:i,defaultOpen:l,displayEmpty:c,labelId:m,MenuProps:g,onClose:b,onOpen:y,open:T,renderValue:E,SelectDisplayProps:oT({id:h},S)},p,{classes:p?VE(A,p.classes):A},d?d.props.inputProps:{})},(v&&_||c)&&"outlined"===I?{notched:!0}:{},{ref:O,className:lT(L.props.className,a,R.root)},!d&&{variant:I},x))})}));Pk.muiName="Select";const Dk=Pk;function $k(e){return Yw("MuiTextField",e)}Kw("MuiTextField",["root"]);const Bk=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Fk={standard:wM,filled:AM,outlined:GM},Uk=Ex(sC,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),zk=e.forwardRef((function(e,t){const n=Sx({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:i=!1,children:o,className:s,color:a="primary",defaultValue:l,disabled:c=!1,error:u=!1,FormHelperTextProps:h,fullWidth:d=!1,helperText:p,id:f,InputLabelProps:m,inputProps:g,InputProps:v,inputRef:_,label:b,maxRows:y,minRows:T,multiline:E=!1,name:S,onBlur:w,onChange:x,onFocus:M,placeholder:C,required:I=!1,rows:k,select:R=!1,SelectProps:A,type:L,value:O,variant:N="outlined"}=n,P=sT(n,Bk),D=oT({},n,{autoFocus:i,color:a,disabled:c,error:u,fullWidth:d,multiline:E,required:I,select:R,variant:N}),$=(e=>{const{classes:t}=e;return ex({root:["root"]},$k,t)})(D);const B={};"outlined"===N&&(m&&"undefined"!==typeof m.shrink&&(B.notched=m.shrink),B.label=b),R&&(A&&A.native||(B.id=void 0),B["aria-describedby"]=void 0);const F=Px(f),U=p&&F?"".concat(F,"-helper-text"):void 0,z=b&&F?"".concat(F,"-label"):void 0,H=Fk[N],G=(0,iw.jsx)(H,oT({"aria-describedby":U,autoComplete:r,autoFocus:i,defaultValue:l,fullWidth:d,multiline:E,name:S,rows:k,maxRows:y,minRows:T,type:L,value:O,id:F,inputRef:_,onBlur:w,onChange:x,onFocus:M,placeholder:C,inputProps:g},B,v));return(0,iw.jsxs)(Uk,oT({className:lT($.root,s),disabled:c,error:u,fullWidth:d,ref:t,required:I,color:a,variant:N,ownerState:D},P,{children:[null!=b&&""!==b&&(0,iw.jsx)(eC,oT({htmlFor:F,id:z},m,{children:b})),R?(0,iw.jsx)(Dk,oT({"aria-describedby":U,id:F,labelId:z,value:O,input:G},A,{children:o})):G,p&&(0,iw.jsx)(dC,oT({id:U},h,{children:p}))]}))})),Hk=zk,Gk=iI;let Vk=!0,Wk=!1;const jk=new PC,Xk={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Yk(e){e.metaKey||e.altKey||e.ctrlKey||(Vk=!0)}function Kk(){Vk=!1}function qk(){"hidden"===this.visibilityState&&Wk&&(Vk=!0)}function Jk(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(n){}return Vk||function(e){const{type:t,tagName:n}=e;return!("INPUT"!==n||!Xk[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}const Zk=function(){const t=e.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",Yk,!0),t.addEventListener("mousedown",Kk,!0),t.addEventListener("pointerdown",Kk,!0),t.addEventListener("touchstart",Kk,!0),t.addEventListener("visibilitychange",qk,!0))}),[]),n=e.useRef(!1);return{isFocusVisibleRef:n,onFocus:function(e){return!!Jk(e)&&(n.current=!0,!0)},onBlur:function(){return!!n.current&&(Wk=!0,jk.start(100,(()=>{Wk=!1})),n.current=!1,!0)},ref:t}};function Qk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function eR(t,n){var r=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){r[t.key]=function(t){return n&&(0,e.isValidElement)(t)?n(t):t}(t)})),r}function tR(e,t,n){return null!=n[t]?n[t]:e.props[t]}function nR(t,n,r){var i=eR(t.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),o=[];for(var s in e)s in t?o.length&&(i[s]=o,o=[]):o.push(s);var a={};for(var l in t){if(i[l])for(r=0;r<i[l].length;r++){var c=i[l][r];a[i[l][r]]=n(c)}a[l]=n(l)}for(r=0;r<o.length;r++)a[o[r]]=n(o[r]);return a}(n,i);return Object.keys(o).forEach((function(s){var a=o[s];if((0,e.isValidElement)(a)){var l=s in n,c=s in i,u=n[s],h=(0,e.isValidElement)(u)&&!u.props.in;!c||l&&!h?c||!l||h?c&&l&&(0,e.isValidElement)(u)&&(o[s]=(0,e.cloneElement)(a,{onExited:r.bind(null,a),in:u.props.in,exit:tR(a,"exit",t),enter:tR(a,"enter",t)})):o[s]=(0,e.cloneElement)(a,{in:!1}):o[s]=(0,e.cloneElement)(a,{onExited:r.bind(null,a),in:!0,exit:tR(a,"exit",t),enter:tR(a,"enter",t)})}})),o}var rR=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},iR=function(t){function n(e,n){var r,i=(r=t.call(this,e,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}BC(n,t);var r=n.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(t,n){var r,i,o=n.children,s=n.handleExited;return{children:n.firstRender?(r=t,i=s,eR(r.children,(function(t){return(0,e.cloneElement)(t,{onExited:i.bind(null,t),in:!0,appear:tR(t,"appear",r),enter:tR(t,"enter",r),exit:tR(t,"exit",r)})}))):nR(t,o,s),firstRender:!1}},r.handleExited=function(e,t){var n=eR(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=oT({},t.children);return delete n[e.key],{children:n}})))},r.render=function(){var t=this.props,n=t.component,r=t.childFactory,i=sT(t,["component","childFactory"]),o=this.state.contextValue,s=rR(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,null===n?e.createElement(UC.Provider,{value:o},s):e.createElement(UC.Provider,{value:o},e.createElement(n,i,s))},n}(e.Component);iR.propTypes={},iR.defaultProps={component:"div",childFactory:function(e){return e}};const oR=iR;const sR=function(t){const{className:n,classes:r,pulsate:i=!1,rippleX:o,rippleY:s,rippleSize:a,in:l,onExited:c,timeout:u}=t,[h,d]=e.useState(!1),p=lT(n,r.ripple,r.rippleVisible,i&&r.ripplePulsate),f={width:a,height:a,top:-a/2+s,left:-a/2+o},m=lT(r.child,h&&r.childLeaving,i&&r.childPulsate);return l||h||d(!0),e.useEffect((()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}}),[c,l,u]),(0,iw.jsx)("span",{className:p,style:f,children:(0,iw.jsx)("span",{className:m})})};const aR=Kw("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);var lR,cR,uR,hR;const dR=["center","classes","className"];let pR,fR,mR,gR;const vR=nM(pR||(pR=lR||(lR=Qk(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),_R=nM(fR||(fR=cR||(cR=Qk(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),bR=nM(mR||(mR=uR||(uR=Qk(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),yR=Ex("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TR=Ex(sR,{name:"MuiTouchRipple",slot:"Ripple"})(gR||(gR=hR||(hR=Qk(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),aR.rippleVisible,vR,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),aR.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),aR.child,aR.childLeaving,_R,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),aR.childPulsate,bR,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),ER=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiTouchRipple"}),{center:i=!1,classes:o={},className:s}=r,a=sT(r,dR),[l,c]=e.useState([]),u=e.useRef(0),h=e.useRef(null);e.useEffect((()=>{h.current&&(h.current(),h.current=null)}),[l]);const d=e.useRef(!1),p=DC(),f=e.useRef(null),m=e.useRef(null),g=e.useCallback((e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:i,cb:s}=e;c((e=>[...e,(0,iw.jsx)(TR,{classes:{ripple:lT(o.ripple,aR.ripple),rippleVisible:lT(o.rippleVisible,aR.rippleVisible),ripplePulsate:lT(o.ripplePulsate,aR.ripplePulsate),child:lT(o.child,aR.child),childLeaving:lT(o.childLeaving,aR.childLeaving),childPulsate:lT(o.childPulsate,aR.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:i},u.current)])),u.current+=1,h.current=s}),[o]),v=e.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:r=!1,center:o=i||t.pulsate,fakeElement:s=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&d.current)return void(d.current=!1);"touchstart"===(null==e?void 0:e.type)&&(d.current=!0);const a=s?null:m.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,u,h;if(o||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),u=Math.round(l.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),u=Math.round(n-l.top)}if(o)h=Math.sqrt((2*l.width**2+l.height**2)/3),h%2===0&&(h+=1);else{const e=2*Math.max(Math.abs((a?a.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((a?a.clientHeight:0)-u),u)+2;h=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===f.current&&(f.current=()=>{g({pulsate:r,rippleX:c,rippleY:u,rippleSize:h,cb:n})},p.start(80,(()=>{f.current&&(f.current(),f.current=null)}))):g({pulsate:r,rippleX:c,rippleY:u,rippleSize:h,cb:n})}),[i,g,p]),_=e.useCallback((()=>{v({},{pulsate:!0})}),[v]),b=e.useCallback(((e,t)=>{if(p.clear(),"touchend"===(null==e?void 0:e.type)&&f.current)return f.current(),f.current=null,void p.start(0,(()=>{b(e,t)}));f.current=null,c((e=>e.length>0?e.slice(1):e)),h.current=t}),[p]);return e.useImperativeHandle(n,(()=>({pulsate:_,start:v,stop:b})),[_,v,b]),(0,iw.jsx)(yR,oT({className:lT(aR.root,o.root,s),ref:m},a,{children:(0,iw.jsx)(oR,{component:null,exit:!0,children:l})}))})),SR=ER;function wR(e){return Yw("MuiButtonBase",e)}const xR=Kw("MuiButtonBase",["root","disabled","focusVisible"]),MR=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],CR=Ex("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(xR.disabled)]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),IR=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiButtonBase"}),{action:i,centerRipple:o=!1,children:s,className:a,component:l="button",disabled:c=!1,disableRipple:u=!1,disableTouchRipple:h=!1,focusRipple:d=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:g,onDragLeave:v,onFocus:_,onFocusVisible:b,onKeyDown:y,onKeyUp:T,onMouseDown:E,onMouseLeave:S,onMouseUp:w,onTouchEnd:x,onTouchMove:M,onTouchStart:C,tabIndex:I=0,TouchRippleProps:k,touchRippleRef:R,type:A}=r,L=sT(r,MR),O=e.useRef(null),N=e.useRef(null),P=Zx(N,R),{isFocusVisibleRef:D,onFocus:$,onBlur:B,ref:F}=Zk(),[U,z]=e.useState(!1);c&&U&&z(!1),e.useImperativeHandle(i,(()=>({focusVisible:()=>{z(!0),O.current.focus()}})),[]);const[H,G]=e.useState(!1);e.useEffect((()=>{G(!0)}),[]);const V=H&&!u&&!c;function W(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;return Gk((r=>{t&&t(r);return!n&&N.current&&N.current[e](r),!0}))}e.useEffect((()=>{U&&d&&!u&&H&&N.current.pulsate()}),[u,d,U,H]);const j=W("start",E),X=W("stop",g),Y=W("stop",v),K=W("stop",w),q=W("stop",(e=>{U&&e.preventDefault(),S&&S(e)})),J=W("start",C),Z=W("stop",x),Q=W("stop",M),ee=W("stop",(e=>{B(e),!1===D.current&&z(!1),f&&f(e)}),!1),te=Gk((e=>{O.current||(O.current=e.currentTarget),$(e),!0===D.current&&(z(!0),b&&b(e)),_&&_(e)})),ne=()=>{const e=O.current;return l&&"button"!==l&&!("A"===e.tagName&&e.href)},re=e.useRef(!1),ie=Gk((e=>{d&&!re.current&&U&&N.current&&" "===e.key&&(re.current=!0,N.current.stop(e,(()=>{N.current.start(e)}))),e.target===e.currentTarget&&ne()&&" "===e.key&&e.preventDefault(),y&&y(e),e.target===e.currentTarget&&ne()&&"Enter"===e.key&&!c&&(e.preventDefault(),m&&m(e))})),oe=Gk((e=>{d&&" "===e.key&&N.current&&U&&!e.defaultPrevented&&(re.current=!1,N.current.stop(e,(()=>{N.current.pulsate(e)}))),T&&T(e),m&&e.target===e.currentTarget&&ne()&&" "===e.key&&!e.defaultPrevented&&m(e)}));let se=l;"button"===se&&(L.href||L.to)&&(se=p);const ae={};"button"===se?(ae.type=void 0===A?"button":A,ae.disabled=c):(L.href||L.to||(ae.role="button"),c&&(ae["aria-disabled"]=c));const le=Zx(n,F,O);const ce=oT({},r,{centerRipple:o,component:l,disabled:c,disableRipple:u,disableTouchRipple:h,focusRipple:d,tabIndex:I,focusVisible:U}),ue=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:i}=e,o=ex({root:["root",t&&"disabled",n&&"focusVisible"]},wR,i);return n&&r&&(o.root+=" ".concat(r)),o})(ce);return(0,iw.jsxs)(CR,oT({as:se,className:lT(ue.root,a),ownerState:ce,onBlur:ee,onClick:m,onContextMenu:X,onFocus:te,onKeyDown:ie,onKeyUp:oe,onMouseDown:j,onMouseLeave:q,onMouseUp:K,onDragLeave:Y,onTouchEnd:Z,onTouchMove:Q,onTouchStart:J,ref:le,tabIndex:c?-1:I,type:A},ae,L,{children:[s,V?(0,iw.jsx)(SR,oT({ref:P,center:o},k)):null]}))})),kR=IR;function RR(e){return Yw("MuiButton",e)}const AR=Kw("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const LR=e.createContext({});const OR=e.createContext(void 0),NR=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],PR=e=>oT({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),DR=Ex(kR,{shouldForwardProp:e=>yx(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["".concat(n.variant).concat(_x(n.color))],t["size".concat(_x(n.size))],t["".concat(n.variant,"Size").concat(_x(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:n}=e;var r,i;const o="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],s="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return oT({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":oT({textDecoration:"none",backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):fw(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===n.variant&&"inherit"!==n.color&&{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):fw(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===n.variant&&"inherit"!==n.color&&{border:"1px solid ".concat((t.vars||t).palette[n.color].main),backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):fw(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===n.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:s,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===n.variant&&"inherit"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[n.color].main}}),"&:active":oT({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[8]}),["&.".concat(AR.focusVisible)]:oT({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[6]}),["&.".concat(AR.disabled)]:oT({color:(t.vars||t).palette.action.disabled},"outlined"===n.variant&&{border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)},"contained"===n.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===n.variant&&{padding:"6px 8px"},"text"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main},"outlined"===n.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:t.vars?"1px solid rgba(".concat(t.vars.palette[n.color].mainChannel," / 0.5)"):"1px solid ".concat(fw(t.palette[n.color].main,.5))},"contained"===n.variant&&{color:t.vars?t.vars.palette.text.primary:null==(r=(i=t.palette).getContrastText)?void 0:r.call(i,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:o,boxShadow:(t.vars||t).shadows[2]},"contained"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].contrastText,backgroundColor:(t.vars||t).palette[n.color].main},"inherit"===n.color&&{color:"inherit",borderColor:"currentColor"},"small"===n.size&&"text"===n.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"text"===n.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"outlined"===n.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"outlined"===n.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"contained"===n.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"contained"===n.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(AR.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(AR.disabled)]:{boxShadow:"none"}}})),$R=Ex("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t["iconSize".concat(_x(n.size))]]}})((e=>{let{ownerState:t}=e;return oT({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},PR(t))})),BR=Ex("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t["iconSize".concat(_x(n.size))]]}})((e=>{let{ownerState:t}=e;return oT({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},PR(t))})),FR=e.forwardRef((function(t,n){const r=e.useContext(LR),i=e.useContext(OR),o=Sx({props:tx(r,t),name:"MuiButton"}),{children:s,color:a="primary",component:l="button",className:c,disabled:u=!1,disableElevation:h=!1,disableFocusRipple:d=!1,endIcon:p,focusVisibleClassName:f,fullWidth:m=!1,size:g="medium",startIcon:v,type:_,variant:b="text"}=o,y=sT(o,NR),T=oT({},o,{color:a,component:l,disabled:u,disableElevation:h,disableFocusRipple:d,fullWidth:m,size:g,type:_,variant:b}),E=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:i,variant:o,classes:s}=e;return oT({},s,ex({root:["root",o,"".concat(o).concat(_x(t)),"size".concat(_x(i)),"".concat(o,"Size").concat(_x(i)),"inherit"===t&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat(_x(i))],endIcon:["endIcon","iconSize".concat(_x(i))]},RR,s))})(T),S=v&&(0,iw.jsx)($R,{className:E.startIcon,ownerState:T,children:v}),w=p&&(0,iw.jsx)(BR,{className:E.endIcon,ownerState:T,children:p}),x=i||"";return(0,iw.jsxs)(DR,oT({ownerState:T,className:lT(r.className,E.root,c,x),component:l,disabled:u,focusRipple:!d,focusVisibleClassName:lT(E.focusVisible,f),ref:n,type:_},y,{classes:E,children:[S,s,w]}))})),UR=FR;function zR(t){const[n,r]=(0,e.useState)(""),i=(0,iT.Z)((e=>e.setIp));(0,iT.Z)((e=>e.ip)),(0,iT.Z)((e=>e.blocks));return(0,iw.jsxs)(Qw,{style:{backgroundColor:"#333",color:"#FFFFFF",paddingLeft:"10px",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,iw.jsx)(xx,{children:(0,iw.jsx)(Lx,{variant:"h5",children:"University of Wisconsin - Grandparents University Programming"})}),(0,iw.jsxs)(xx,{style:{textAlign:"center",display:"flex",justifyContent:"right",alignItems:"center",width:"100%",margin:"5px"},children:[(0,iw.jsx)(Hk,{id:"robotIpAddress",label:"IP",variant:"filled",style:{backgroundColor:"#FFFFFF50",borderRadius:"5px"},defaultValue:"",onChange:e=>r(e.target.value)}),(0,iw.jsx)(UR,{style:{color:"#FFFFFF"},onClick:()=>{i(n),alert("Confirmed IP Address: "+n)},children:"Confirm"}),(0,iw.jsx)(UR,{style:{color:"#FFFFFF"},id:"runButton",children:"Run"})]})]})}var HR=__webpack_require__(959);const GR=e.createContext();function VR(e){return Yw("MuiGrid",e)}const WR=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],jR=Kw("MuiGrid",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map((e=>"spacing-xs-".concat(e))),...["column-reverse","column","row-reverse","row"].map((e=>"direction-xs-".concat(e))),...["nowrap","wrap-reverse","wrap"].map((e=>"wrap-xs-".concat(e))),...WR.map((e=>"grid-xs-".concat(e))),...WR.map((e=>"grid-sm-".concat(e))),...WR.map((e=>"grid-md-".concat(e))),...WR.map((e=>"grid-lg-".concat(e))),...WR.map((e=>"grid-xl-".concat(e)))]),XR=jR,YR=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function KR(e){const t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}function qR(e){let{breakpoints:t,values:n}=e,r="";Object.keys(n).forEach((e=>{""===r&&0!==n[e]&&(r=e)}));const i=Object.keys(t).sort(((e,n)=>t[e]-t[n]));return i.slice(0,i.indexOf(r))}const JR=Ex("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{container:r,direction:i,item:o,spacing:s,wrap:a,zeroMinWidth:l,breakpoints:c}=n;let u=[];r&&(u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n["spacing-xs-".concat(String(e))]];const r=[];return t.forEach((t=>{const i=e[t];Number(i)>0&&r.push(n["spacing-".concat(t,"-").concat(String(i))])})),r}(s,c,t));const h=[];return c.forEach((e=>{const r=n[e];r&&h.push(t["grid-".concat(e,"-").concat(String(r))])})),[t.root,r&&t.container,o&&t.item,l&&t.zeroMinWidth,...u,"row"!==i&&t["direction-xs-".concat(String(i))],"wrap"!==a&&t["wrap-xs-".concat(String(a))],...h]}})((e=>{let{ownerState:t}=e;return oT({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){let{theme:t,ownerState:n}=e;return YE({theme:t},JE({values:n.direction,breakpoints:t.breakpoints.values}),(e=>{const t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(XR.item)]={maxWidth:"none"}),t}))}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,rowSpacing:i}=n;let o={};if(r&&0!==i){const e=JE({values:i,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=qR({breakpoints:t.breakpoints.values,values:e})),o=YE({theme:t},e,((e,r)=>{var i;const o=t.spacing(e);return"0px"!==o?{marginTop:"-".concat(KR(o)),["& > .".concat(XR.item)]:{paddingTop:KR(o)}}:null!=(i=n)&&i.includes(r)?{}:{marginTop:0,["& > .".concat(XR.item)]:{paddingTop:0}}}))}return o}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,columnSpacing:i}=n;let o={};if(r&&0!==i){const e=JE({values:i,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=qR({breakpoints:t.breakpoints.values,values:e})),o=YE({theme:t},e,((e,r)=>{var i;const o=t.spacing(e);return"0px"!==o?{width:"calc(100% + ".concat(KR(o),")"),marginLeft:"-".concat(KR(o)),["& > .".concat(XR.item)]:{paddingLeft:KR(o)}}:null!=(i=n)&&i.includes(r)?{}:{width:"100%",marginLeft:0,["& > .".concat(XR.item)]:{paddingLeft:0}}}))}return o}),(function(e){let t,{theme:n,ownerState:r}=e;return n.breakpoints.keys.reduce(((e,i)=>{let o={};if(r[i]&&(t=r[i]),!t)return e;if(!0===t)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const s=JE({values:r.columns,breakpoints:n.breakpoints.values}),a="object"===typeof s?s[i]:s;if(void 0===a||null===a)return e;const l="".concat(Math.round(t/a*1e8)/1e6,"%");let c={};if(r.container&&r.item&&0!==r.columnSpacing){const e=n.spacing(r.columnSpacing);if("0px"!==e){const t="calc(".concat(l," + ").concat(KR(e),")");c={flexBasis:t,maxWidth:t}}}o=oT({flexBasis:l,flexGrow:0,maxWidth:l},c)}return 0===n.breakpoints.values[i]?Object.assign(e,o):e[n.breakpoints.up(i)]=o,e}),{})}));const ZR=e=>{const{classes:t,container:n,direction:r,item:i,spacing:o,wrap:s,zeroMinWidth:a,breakpoints:l}=e;let c=[];n&&(c=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return["spacing-xs-".concat(String(e))];const n=[];return t.forEach((t=>{const r=e[t];if(Number(r)>0){const e="spacing-".concat(t,"-").concat(String(r));n.push(e)}})),n}(o,l));const u=[];l.forEach((t=>{const n=e[t];n&&u.push("grid-".concat(t,"-").concat(String(n)))}));return ex({root:["root",n&&"container",i&&"item",a&&"zeroMinWidth",...c,"row"!==r&&"direction-xs-".concat(String(r)),"wrap"!==s&&"wrap-xs-".concat(String(s)),...u]},VR,t)},QR=e.forwardRef((function(t,n){const r=Sx({props:t,name:"MuiGrid"}),{breakpoints:i}=KC(),o=YS(r),{className:s,columns:a,columnSpacing:l,component:c="div",container:u=!1,direction:h="row",item:d=!1,rowSpacing:p,spacing:f=0,wrap:m="wrap",zeroMinWidth:g=!1}=o,v=sT(o,YR),_=p||f,b=l||f,y=e.useContext(GR),T=u?a||12:y,E={},S=oT({},v);i.keys.forEach((e=>{null!=v[e]&&(E[e]=v[e],delete S[e])}));const w=oT({},o,{columns:T,container:u,direction:h,item:d,rowSpacing:_,columnSpacing:b,wrap:m,zeroMinWidth:g,spacing:f},E,{breakpoints:i.keys}),x=ZR(w);return(0,iw.jsx)(GR.Provider,{value:T,children:(0,iw.jsx)(JR,oT({ownerState:w,className:lT(x.root,s),as:c,ref:n},S))})}));const eA=QR,tA=["component","direction","spacing","divider","children","className","useFlexGap"],nA=ew(),rA=px("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function iA(e){return nx({props:e,name:"MuiStack",defaultTheme:nA})}function oA(t,n){const r=e.Children.toArray(t).filter(Boolean);return r.reduce(((t,i,o)=>(t.push(i),o<r.length-1&&t.push(e.cloneElement(n,{key:"separator-".concat(o)})),t)),[])}const sA=e=>{let{ownerState:t,theme:n}=e,r=oT({display:"flex",flexDirection:"column"},YE({theme:n},JE({values:t.direction,breakpoints:n.breakpoints.values}),(e=>({flexDirection:e}))));if(t.spacing){const e=cS(n),i=Object.keys(n.breakpoints.values).reduce(((e,n)=>(("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e)),{}),o=JE({values:t.direction,base:i}),s=JE({values:t.spacing,base:i});"object"===typeof o&&Object.keys(o).forEach(((e,t,n)=>{if(!o[e]){const r=t>0?o[n[t-1]]:"column";o[e]=r}}));r=VE(r,YE({theme:n},s,((n,r)=>{return t.useFlexGap?{gap:uS(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat((i=r?o[r]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[i]))]:uS(e,n)}};var i})))}return r=function(e){const t=KE(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=[t,...r].reduce(((e,t)=>VE(e,t)),{});return qE(Object.keys(t),o)}(n.breakpoints,r),r};const aA=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:n=rA,useThemeProps:r=iA,componentName:i="MuiStack"}=t,o=n(sA),s=e.forwardRef((function(e,t){const n=YS(r(e)),{component:s="div",direction:a="column",spacing:l=0,divider:c,children:u,className:h,useFlexGap:d=!1}=n,p=sT(n,tA),f={direction:a,spacing:l,useFlexGap:d},m=ex({root:["root"]},(e=>Yw(i,e)),{});return(0,iw.jsx)(o,oT({as:s,ownerState:f,ref:t,className:lT(m.root,h)},p,{children:c?oA(u,c):u}))}));return s}({createStyledComponent:Ex("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>Sx({props:e,name:"MuiStack"})}),lA=aA,cA=Ex("div")((e=>{let{theme:t}=e;return{textAlign:"center"}}));r.common.defineBlocks(tT.K),Object.assign(rT.javascriptGenerator.forBlock,nT.Z);const uA=function(){return(0,iw.jsxs)("div",{children:[(0,iw.jsx)(zR,{}),(0,iw.jsx)(Qw,{display:"flex",minHeight:"90vh",children:(0,iw.jsxs)(eA,{display:"flex",container:!0,spacing:2,children:[(0,iw.jsx)(eA,{item:!0,xs:12,sm:12,md:9,lg:9,children:(0,iw.jsx)(cA,{style:{width:"100%",height:"100%",paddingLeft:"2px"},children:(0,iw.jsx)(HR.Z,{})})}),(0,iw.jsx)(eA,{item:!0,xs:12,sm:12,md:3,lg:3,children:(0,iw.jsx)(lA,{style:{height:"100%",paddingRight:"5px"},children:(0,iw.jsx)(cA,{style:{height:"30%"},children:(0,iw.jsx)(eT,{})})})})]})})]})},hA=e=>{e&&e instanceof Function&&__webpack_require__.e(787).then(__webpack_require__.bind(__webpack_require__,787)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:s}=t;n(e),r(e),i(e),o(e),s(e)}))};n.createRoot(document.getElementById("root")).render((0,iw.jsx)(e.StrictMode,{children:(0,iw.jsx)(uA,{})})),hA()})()})();
//# sourceMappingURL=main.b2a4601e.js.map