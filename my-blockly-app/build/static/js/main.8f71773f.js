/*! For license information please see main.8f71773f.js.LICENSE.txt */
(()=>{var __webpack_modules__={494:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>BlocklyInterface});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(791),blockly__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(271),blockly__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_1__),_blocks_text__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(222),_generators_javascript__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(691),blockly_javascript__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(505),blockly_javascript__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(blockly_javascript__WEBPACK_IMPORTED_MODULE_4__),_serialization__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(110),_toolbox__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25),_index_css__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(174),_Store__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(464),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(184);function BlocklyInterface(props){const addBlock=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.addBlock)),blocks=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.blocks)),removeBlock=(0,_Store__WEBPACK_IMPORTED_MODULE_8__.Z)((e=>e.removeBlock));return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{console.log(blocks)}),[blocks]),blockly__WEBPACK_IMPORTED_MODULE_1__.common.defineBlocks(blocks),Object.assign(blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.forBlock,_generators_javascript__WEBPACK_IMPORTED_MODULE_3__.Z),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!document.querySelector(".blocklySvg")){const ws=blockly__WEBPACK_IMPORTED_MODULE_1__.inject("blocklyDiv",{toolbox:_toolbox__WEBPACK_IMPORTED_MODULE_6__.k}),initialBlock=ws.newBlock("Start");initialBlock.moveBy(50,50),(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.a)(ws),(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.z)(ws),blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.addReservedWords("code");const runCode=()=>{console.log("runcode clicked");const code=blockly_javascript__WEBPACK_IMPORTED_MODULE_4__.javascriptGenerator.workspaceToCode(ws);eval(code)};document.getElementById("runButton").addEventListener("click",runCode),ws.addChangeListener((e=>{if(!e.isUiEvent){if("create"===e.type){let t={id:e.json.id,type:e.json.type};e.json.fields&&(t.fields=e.json.fields),e.json.inputs&&(t.inputs=e.json.inputs),addBlock(e.json.id,t)}if("move"===e.type){ws.getBlockById(e.blockId)||removeBlock(e.blockId)}(0,_serialization__WEBPACK_IMPORTED_MODULE_5__.a)(ws)}}))}}),[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{id:"pageContainer",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{id:"blocklyDiv",style:{height:"480px",width:"800px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("xml",{id:"toolbox",style:{display:"none"}})]})}blockly__WEBPACK_IMPORTED_MODULE_1__.Blocks.Start={init:function(){this.appendDummyInput().appendField("Program starts here"),this.setColour(345),this.setTooltip("This is the starting block"),this.setNextStatement(!0,null),this.setHelpUrl("")}}},464:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});const i=e=>{let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=i?i:"object"!==typeof r||null===r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=t=e(i,r,s);return s},r=e=>e?i(e):i;var s=n(791),o=n(327);const{useDebugValue:a}=s,{useSyncExternalStoreWithSelector:l}=o;let c=!1;const u=e=>e;const h=e=>{"function"!==typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"===typeof e?r(e):e,n=(e,n)=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=arguments.length>2?arguments[2]:void 0;n&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);const i=l(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a(i),i}(t,e,n);return Object.assign(n,t),n},d=e=>e?h(e):h;const p=d((e=>({ip:"",blocks:{},setIp:t=>e({ip:t}),addBlock:(t,n)=>e((e=>({blocks:{...e.blocks,[t]:n}}))),removeBlock:t=>e((e=>({blocks:Object.keys(e.blocks).reduce(((n,i)=>(i!==t&&(n[i]=e.blocks[i]),n)),{})})))})))},222:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var i=n(30);i.Blocks.ChangeLED={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Change the LED color to").appendField(new i.FieldColour("#FF0000"),"FIELD_ChangeLED"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setOutput(!1),this.setTooltip("Changes Misty's LED to a specified color")}},i.Blocks.DisplayImage={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Change face expression to: ").appendField(new i.FieldTextInput("default"),"FIELD_DisplayImage_Filename"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Displays an image on Misty's screen, Alpha specifies transparency (0 is completely transparent, 1 is completely opaque) ***WARNING: MUST connect with ListFilesAvailable to select the image file to display***")}},i.Blocks.MoveHead={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move head").appendField(new i.FieldDropdown([["Up","U"],["Down","D"]]),"FIELD_MoveHead_Pitch"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head Up or Down"),this.setHelpUrl("MoveHead")}},i.Blocks.MoveHead2={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move head").appendField("Pitch (-40 to 25):").appendField(new i.FieldNumber(0,-40,25,1),"FIELD_MoveHead_Pitch").appendField("Roll (-42 to 42):").appendField(new i.FieldNumber(0,-42,42,1),"FIELD_MoveHead_Roll").appendField("Yaw (-90 to 90):").appendField(new i.FieldNumber(0,-90,90,1),"FIELD_MoveHead_Yaw"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head a specified amount of degrees with roll, pitch, and/or yaw"),this.setHelpUrl("MoveHead")}},i.Blocks.MoveArm={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move ").appendField(new i.FieldDropdown([["Right","Right"],["Left","Left"]]),"FIELD_MoveArm_Arm").appendField("arm to position").appendField(new i.FieldNumber(0,0,10,1),"FIELD_MoveArm_Position").appendField("at a speed of (0 to 100)").appendField(new i.FieldNumber(50,0,100,1),"FIELD_MoveArm_Velocity"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves one of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArm")}},i.Blocks.MoveArm2={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move both arms to position").appendField(new i.FieldNumber(0),"FIELD_MoveArm2_Position").appendField("at a speed of (0 to 100)").appendField(new i.FieldNumber(50,0,100,1),"FIELD_MoveArm2_Velocity"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves both of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArm2")}},i.Blocks.MoveArms={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move left arm to position").appendField(new i.FieldNumber(0,-29,90,1),"FIELD_MoveArm_LeftPosition").appendField("at a speed of (0 to 100)").appendField(new i.FieldNumber(50,0,100,1),"FIELD_MoveArm_LeftVelocity").appendField("and move right arm to position").appendField(new i.FieldNumber(0,-29,90,1),"FIELD_MoveArm_RightPosition").appendField("at a speed of (0 to 100)").appendField(new i.FieldNumber(50,0,100,1),"FIELD_MoveArm_RightVelocity"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves both of Misty's arms to a specified position (expects a value from 0-10, 5 points the arm straight forward) at a specified speed (between 0 and 100)"),this.setHelpUrl("MoveArms")}},i.Blocks.DriveTime={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Move ").appendField(new i.FieldDropdown([["Forward","F"],["Backward","B"]]),"FIELD_DriveTime_Direction").appendField("at a speed of (0 to 100)").appendField(new i.FieldNumber(25,0,100,1),"FIELD_DriveTime_Velocity").appendField("for a duration of").appendField(new i.FieldNumber(1500,100,1e4,100),"FIELD_DriveTime_TimeMs").appendField("ms"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Drives Misty straight in a specified direction at a specified speed for a specified amount of time (1000ms = 1 second)"),this.setHelpUrl("DriveTime")}},i.Blocks.MoveHead3={init:function(){var e=this.workspace.newBlock("math_number");e.setShadow(!0),e.initSvg(),e.render();var t=e.outputConnection,n=this.workspace.newBlock("math_number");n.setShadow(!0),n.initSvg(),n.render();var i=n.outputConnection,r=this.workspace.newBlock("math_number");r.setShadow(!0),r.initSvg(),r.render();var s=r.outputConnection;this.setColour("#ff0000"),this.appendValueInput("FIELD_MoveHead_Pitch").setCheck("Number").appendField("Move head").appendField("Pitch (-40 to 25):"),this.getInput("FIELD_MoveHead_Pitch").connection.connect(t),this.appendValueInput("FIELD_MoveHead_Roll").setCheck("Number").appendField("Roll (-42 to 42):"),this.getInput("FIELD_MoveHead_Roll").connection.connect(i),this.appendValueInput("FIELD_MoveHead_Yaw").setCheck("Number").appendField("Yaw (-90 to 90):"),this.getInput("FIELD_MoveHead_Yaw").connection.connect(s),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Moves Misty's head a specified amount of degrees with roll, pitch, and/or yaw"),this.setHelpUrl("MoveHead")}},i.Blocks.DriveTime2={init:function(){var e=this.workspace.newBlock("math_number");e.setShadow(!0),e.initSvg(),e.render();var t=e.outputConnection,n=this.workspace.newBlock("math_number");n.setShadow(!0),n.initSvg(),n.render();var i=n.outputConnection,r=this.workspace.newBlock("math_number");r.setShadow(!0),r.initSvg(),r.render();var s=r.outputConnection;this.setColour("#ff0000"),this.appendValueInput("FIELD_DriveTime_Velocity").setCheck("Number").appendField("Move at a speed of (-100 to 100)"),this.getInput("FIELD_DriveTime_Velocity").connection.connect(t),this.appendValueInput("FIELD_DriveTime_Angular").setCheck("Number").appendField("with angular velocity of (-100 CW to 100 CCW)"),this.getInput("FIELD_DriveTime_Angular").connection.connect(i),this.appendValueInput("FIELD_DriveTime_TimeMs").setCheck("Number").appendField("for a duration of (ms)"),this.getInput("FIELD_DriveTime_TimeMs").connection.connect(s),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Drives Misty forward (positive speed) or backward (negative speed) with possible turning using angular velocity (0 for straight) for the specified duration (1000 ms = 1 second)"),this.setHelpUrl("DriveTime")}},i.Blocks.Turn={init:function(){this.setColour("#ff0000"),this.appendDummyInput().appendField("Turn").appendField(new i.FieldDropdown([["Left","L"],["Right","R"]]),"FIELD_Turn_Direction").appendField("for time of").appendField(new i.FieldNumber(4500),"FIELD_Turn_Duration").appendField("milliseconds"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Turns Misty in the specified direction (1000ms = 1 second and 4500ms is approximately 90 degrees)"),this.setHelpUrl("Turn")}};const r=i.common.createBlockDefinitionsFromJsonArray([{type:"add_text",message0:"Add text %1 with color %2",args0:[{type:"input_value",name:"TEXT",check:"String"},{type:"input_value",name:"COLOR",check:"Colour"}],previousStatement:null,nextStatement:null,colour:160,tooltip:"",helpUrl:""}])},691:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(505);const r=Object.create(null);r.add_text=function(e,t){const n=t.valueToCode(e,"TEXT",i.Order.NONE)||"''",r=t.valueToCode(e,"COLOR",i.Order.ATOMIC)||"'#ffffff'",s=t.provideFunction_("addText","function ".concat(t.FUNCTION_NAME_PLACEHOLDER_,"(text, color) {\n\n  // Add text to the output area.\n  const outputDiv = document.getElementById('output');\n  const textEl = document.createElement('p');\n  textEl.innerText = text;\n  textEl.style.color = color;\n  outputDiv.appendChild(textEl);\n}"));return"".concat(s,"(").concat(n,", ").concat(r,");\n")},r.ChangeLED=function(e){var t=function(e){e=e.replace(/^#/,"");var t=parseInt(e,16);return{red:t>>16&255,green:t>>8&255,blue:255&t}}(e.getFieldValue("FIELD_ChangeLED"));return'sendPostRequestToRobot("led",'+JSON.stringify(t)+");"},r.DisplayImage=function(e){var t={FileName:e.getFieldValue("FIELD_DisplayImage_Filename"),Alpha:1};return'sendPostRequestToRobot("images/display",'+JSON.stringify(t)+");"},r.MoveHead=function(e){var t,n="D"===e.getFieldValue("FIELD_MoveHead_Pitch")?5:-5;parseInt(e.getFieldValue("FIELD_MoveHead_Velocity"));return t={Pitch:n,Yaw:0,Roll:0,Units:"position"},'sendPostRequestToRobot("head",'+JSON.stringify(t)+");"},r.MoveHead2=function(e){var t,n;t=e.getFieldValue("FIELD_MoveHead_Pitch"),n=e.getFieldValue("FIELD_MoveHead_Roll");return'sendPostRequestToRobot("head",'+('{"Pitch":'+t+',"Yaw":'+e.getFieldValue("FIELD_MoveHead_Yaw")+',"Roll":'+n+',"Units": "degrees"}')+");"},r.MoveArm=function(e){return'sendPostRequestToRobot("arms",'+('{"Arm":"'+("Right"===e.getFieldValue("FIELD_MoveArm_Arm")?"Right":"Left")+'","Position":'+parseInt(e.getFieldValue("FIELD_MoveArm_Position"))+',"Velocity":'+parseInt(e.getFieldValue("FIELD_MoveArm_Velocity"))+',"Units":"Position"}')+");"},r.MoveArm2=function(e){return'sendPostRequestToRobot("arms",'+('{"Arm": "both", "Position":'+parseInt(e.getFieldValue("FIELD_MoveArm2_Position"))+',"Velocity":'+parseInt(e.getFieldValue("FIELD_MoveArm2_Velocity"))+',"Units":"Position"}')+");"},r.MoveArms=function(e){var t=parseInt(e.getFieldValue("FIELD_MoveArm_LeftPosition")),n=parseInt(e.getFieldValue("FIELD_MoveArm_LeftVelocity"));return'sendPostRequestToRobot("arms/set",'+('{"LeftArmPosition":'+t+',"RightArmPosition":'+parseInt(e.getFieldValue("FIELD_MoveArm_RightPosition"))+',"LeftArmVelocity":'+n+',"RightArmVelocity":'+parseInt(e.getFieldValue("FIELD_MoveArm_RightVelocity"))+"}")+");"},r.DriveTime=function(e){var t=e.getFieldValue("FIELD_DriveTime_Direction"),n=parseInt(e.getFieldValue("FIELD_DriveTime_Velocity"));return'sendPostRequestToRobot("drive/time",'+('{"LinearVelocity":'+("F"===t?n:-n)+',"AngularVelocity":0,"TimeMs":'+parseInt(e.getFieldValue("FIELD_DriveTime_TimeMs"))+"}")+");"},r.Turn=function(e){var t=e.getFieldValue("FIELD_Turn_Direction");return'sendPostRequestToRobot("drive/time",'+('{"LinearVelocity":0,"AngularVelocity":100,"TimeMs":'+parseInt(e.getFieldValue("FIELD_Turn_Duration"))+',"Degree":'+("L"===t?90:-90)+"}")+");"},r.Start=function(e){return""}},110:(e,t,n)=>{"use strict";n.d(t,{a:()=>s,z:()=>o});var i=n(30);const r="mainWorkspace",s=function(e){var t;const n=i.serialization.workspaces.save(e);null===(t=window.localStorage)||void 0===t||t.setItem(r,JSON.stringify(n))},o=function(e){var t;const n=null===(t=window.localStorage)||void 0===t?void 0:t.getItem(r);n&&(i.Events.disable(),i.serialization.workspaces.load(JSON.parse(n),e,!1),i.Events.enable())}},25:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={kind:"categoryToolbox",contents:[{kind:"category",name:"Logic",categorystyle:"logic_category",contents:[{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_negate"},{kind:"block",type:"logic_boolean"},{kind:"block",type:"logic_null"},{kind:"block",type:"logic_ternary"}]},{kind:"category",name:"Loops",categorystyle:"loop_category",contents:[{kind:"block",type:"controls_repeat_ext",inputs:{TIMES:{shadow:{type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"controls_whileUntil"},{kind:"block",type:"controls_for",inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:10}}},BY:{shadow:{type:"math_number",fields:{NUM:1}}}}},{kind:"block",type:"controls_forEach"},{kind:"block",type:"controls_flow_statements"}]},{kind:"category",name:"Math",categorystyle:"math_category",contents:[{kind:"block",type:"math_number",fields:{NUM:123}},{kind:"block",type:"math_arithmetic",inputs:{A:{shadow:{type:"math_number",fields:{NUM:1}}},B:{shadow:{type:"math_number",fields:{NUM:1}}}}},{kind:"block",type:"math_single",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:9}}}}},{kind:"block",type:"math_trig",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:45}}}}},{kind:"block",type:"math_constant"},{kind:"block",type:"math_number_property",inputs:{NUMBER_TO_CHECK:{shadow:{type:"math_number",fields:{NUM:0}}}}},{kind:"block",type:"math_round",fields:{OP:"ROUND"},inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:3.1}}}}},{kind:"block",type:"math_on_list",fields:{OP:"SUM"}},{kind:"block",type:"math_modulo",inputs:{DIVIDEND:{shadow:{type:"math_number",fields:{NUM:64}}},DIVISOR:{shadow:{type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"math_constrain",inputs:{VALUE:{shadow:{type:"math_number",fields:{NUM:50}}},LOW:{shadow:{type:"math_number",fields:{NUM:1}}},HIGH:{shadow:{type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_int",inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_float"},{kind:"block",type:"math_atan2",inputs:{X:{shadow:{type:"math_number",fields:{NUM:1}}},Y:{shadow:{type:"math_number",fields:{NUM:1}}}}}]},{kind:"category",name:"Text",categorystyle:"text_category",contents:[{kind:"block",type:"text"},{kind:"block",type:"text_multiline"},{kind:"block",type:"text_join"},{kind:"block",type:"text_append",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{kind:"block",type:"text_length",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_isEmpty",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:""}}}}},{kind:"block",type:"text_indexOf",inputs:{VALUE:{block:{type:"variables_get"}},FIND:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_charAt",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"text_getSubstring",inputs:{STRING:{block:{type:"variables_get"}}}},{kind:"block",type:"text_changeCase",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_trim",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{kind:"block",type:"text_count",inputs:{SUB:{shadow:{type:"text"}},TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"text_replace",inputs:{FROM:{shadow:{type:"text"}},TO:{shadow:{type:"text"}},TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"text_reverse",inputs:{TEXT:{shadow:{type:"text"}}}},{kind:"block",type:"add_text",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}},COLOR:{shadow:{type:"colour_picker",fields:{COLOUR:"#aa00cc"}}}}}]},{kind:"category",name:"Color",categorystyle:"colour_category",contents:[{kind:"block",type:"colour_picker"},{kind:"block",type:"colour_random"},{kind:"block",type:"colour_rgb",inputs:{RED:{shadow:{type:"math_number",fields:{NUM:100}}},GREEN:{shadow:{type:"math_number",fields:{NUM:50}}},BLUE:{shadow:{type:"math_number",fields:{NUM:0}}}}},{kind:"block",type:"colour_blend",inputs:{COLOUR1:{shadow:{type:"colour_picker",fields:{COLOUR:"#ff0000"}}},COLOUR2:{shadow:{type:"colour_picker",fields:{COLOUR:"#3333ff"}}},RATIO:{shadow:{type:"math_number",fields:{NUM:.5}}}}}]},{kind:"sep"},{kind:"category",name:"Variables",categorystyle:"variable_category",custom:"VARIABLE"},{kind:"category",name:"Functions",categorystyle:"procedure_category",custom:"PROCEDURE"},{kind:"category",name:"Misty",categorystyle:"list_category",contents:[{kind:"block",type:"lists_length"},{kind:"block",type:"ChangeLED"},{kind:"block",type:"DisplayImage"},{kind:"block",type:"MoveArm"},{kind:"block",type:"MoveArm2"},{kind:"block",type:"MoveArms"},{kind:"block",type:"MoveHead"},{kind:"block",type:"MoveHead2"},{kind:"block",type:"MoveHead3"},{kind:"block",type:"DriveTime"},{kind:"block",type:"DriveTime2"},{kind:"block",type:"Turn"},{kind:"block",type:"lists_indexOf",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_getIndex",inputs:{VALUE:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_setIndex",inputs:{LIST:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_getSublist",inputs:{LIST:{block:{type:"variables_get"}}}},{kind:"block",type:"lists_split",inputs:{DELIM:{shadow:{type:"text",fields:{TEXT:","}}}}}]}]}},478:function(e,t,n){var i,r,s;r=[n(363)],void 0===(s="function"===typeof(i=function(e){return e})?i.apply(t,r):i)||(e.exports=s)},363:function(e,t,n){var i,r,s;r=[],i=function(){var e,t,i,r,s,o,a,l,c,u,h,d,p,f,g,m,v,_,b,y,T,E,S,w,x,M,I,C,k,R,A,L,O,N,D,P,$,B,F,U,z,H,G,V,W,j,X,Y,K,q,J,Z,Q,ee,te,ne,ie,re,se,oe,ae,le,ce,ue,he,de,pe,fe,ge,me,ve,_e,be,ye,Te,Ee,Se,we,xe,Me,Ie,Ce,ke,Re,Ae,Le,Oe,Ne,De,Pe,$e,Be,Fe,Ue,ze,He,Ge,Ve,We,je,Xe,Ye,Ke,qe,Je,Ze,Qe,et,tt,nt,it,rt,st,ot,at,lt,ct,ut,ht,dt,pt,ft,gt,mt,vt,_t,bt,yt,Tt,Et,St,wt,xt,Mt,It,Ct,kt,Rt,At,Lt,Ot,Nt,Dt,Pt,$t,Bt,Ft,Ut,zt,Ht,Gt,Vt,Wt,jt,Xt,Yt,Kt,qt,Jt,Zt,Qt,en,tn,nn,rn,sn,on,an,ln,cn,un,hn,dn,pn,fn,gn,mn,vn,_n,bn,yn,Tn,En,Sn,wn,xn,Mn,In,Cn,kn,Rn,An,Ln,On,Nn,Dn,Pn,$n,Bn,Fn,Un,zn,Hn,Gn,Vn,Wn,jn,Xn,Yn,Kn,qn,Jn,Zn,Qn,ei,ti,ni,ii,ri,si,oi,ai,li,ci,ui,hi,di,pi,fi,gi,mi,vi,_i,bi,yi,Ti,Ei,Si,wi,xi,Mi,Ii,Ci,ki,Ri,Ai,Li,Oi,Ni,Di,Pi,$i,Bi,Fi,Ui,zi,Hi,Gi,Vi,Wi,ji,Xi,Yi,Ki,qi,Ji,Zi,Qi,er,tr,nr,ir,rr,sr,or,ar,lr,cr,ur,hr,dr,pr,fr,gr,mr,vr,_r,br,yr,Tr,Er,Sr,wr,xr,Mr,Ir,Cr,kr,Rr,Ar,Lr,Or,Nr,Dr,Pr,$r,Br,Fr,Ur,zr,Hr,Gr,Vr,Wr,jr,Xr,Yr,Kr,qr,Jr,Zr,Qr,es,ts,ns,is,rs,ss,os,as,ls,cs,us,hs,ds,ps,fs,gs,ms,vs,_s,bs,ys,Ts,Es,Ss,ws,xs,Ms,Is,Cs,ks,Rs,As,Ls,Os,Ns,Ds,Ps,$s,Bs,Fs,Us,zs,Hs,Gs,Vs,Ws,js,Xs,Ys,Ks,qs,Js,Zs,Qs,eo,to,no,io,ro,so,oo,ao,lo,co,uo,ho,po,fo,go,mo,vo,_o,bo,yo,To,Eo,So,wo,xo,Mo,Io,Co,ko,Ro,Ao,Lo,Oo={};e=function(e,n,i,r){if(!(e instanceof Bo)&&"string"!==typeof e||""==="".concat(e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e="".concat(e).toLowerCase(),"string"!==typeof n||""===n.trim())throw Error('Invalid name "'+n+'". The name must be a non-empty string.');const s=n.toLowerCase();if(!i)throw Error("Can not register a null value");let o=No[e],a=Po[e];if(o||(o=No[e]=Object.create(null),a=Po[e]=Object.create(null)),t(e,i),!r&&o[s])throw Error('Name "'+s+'" with type "'+e+'" already registered.');o[s]=i,a[s]=n},t=function(e,t){if(e===String(Bo.FIELD)&&"function"!==typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},i=function(e,t){e="".concat(e).toLowerCase(),t=t.toLowerCase();const n=No[e];n&&n[t]?(delete No[e][t],delete Po[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},r=function(e,t,n){e="".concat(e).toLowerCase(),t=t.toLowerCase();const i=No[e];if(!i||!i[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",n)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return i[t]},s=function(e,t){return e="".concat(e).toLowerCase(),t=t.toLowerCase(),!!(e=No[e])&&!!e[t]},o=function(e,t,n){return r(e,t,n)},a=function(e,t,n){return r(e,t,n)},l=function(e,t,n){e="".concat(e).toLowerCase();var i=No[e];if(!i){if(i="Unable to find [".concat(e,"] in the registry."),n)throw Error("".concat(i," You must require or register a ").concat(e," plugin."));return console.warn(i),null}if(!t)return i;e=Po[e],n=Object.create(null);for(const r of Object.keys(i))n[e[r]]=i[r];return n},c=function(e,t,n){return"function"===typeof(t=t.plugins[String(e)]||$o)?t:o(e,t,n)},u=function(e){return Go[e]||null},h=function(){const e=[];for(const t in Go)e.push(Go[t]);return e},d=function(e){Go[e.id]=e},p=function(e){delete Go[e.id]},f=function(){return Uo},g=function(e){Uo=e},m=function(){return Vo},v=function(e){Vo=e},_=function(){return zo},b=function(e){zo=e},y=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),n=e.getCachedParentSvgSize();var i=t.parentElement;if(i instanceof HTMLElement){var r=i.offsetWidth;i=i.offsetHeight,n.width!==r&&(t.setAttribute("width",r+"px"),e.setCachedParentSvgSize(r,null)),n.height!==i&&(t.setAttribute("height",i+"px"),e.setCachedParentSvgSize(null,i)),e.resize()}},T=function(e,t){const n=Object.create(null),i=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=i.indexOf(e),i.splice(e,i.length-e));for(let r,s=0;r=i[s];s++)n[r.type]?n[r.type]++:n[r.type]=1;return n},E=function(e){return function(){this.jsonInit(e)}},S=function(e){jo.defineBlocksWithJsonArrayInternal(e)},w=function(e){Oo.defineBlocks$$module$build$src$core$common(Oo.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},Oo.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n];if(!i){console.warn("Block definition #".concat(n," in JSON array is ").concat(i,". Skipping"));continue}const r=i.type;r?t[r]={init:E(i)}:console.warn("Block definition #".concat(n," in JSON array is missing a type attribute. ")+"Skipping.")}return t},Oo.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const n=e[t];t in Ho&&console.warn('Block definiton "'.concat(t,'" overwrites previous definition.')),Ho[t]=n}},x=function(){return"blockly-"+(Ea++).toString(36)},M=function(){return Ta.genUid()},I=function(e){Ko=e},C=function(){return Ko},k=function(e){_a.fireInternal(e)},R=function(e){if(N()){if(!va.length)try{requestAnimationFrame((()=>{setTimeout(A,0)}))}catch(t){setTimeout(A,0)}va.push(e)}},A=function(){var e=L(va,!0);va.length=0;for(let n,i=0;n=e[i];i++)if(n.workspaceId){var t=u(n.workspaceId);t&&t.fireChangeListener(n)}e=new Set(e.map((e=>e.workspaceId)));for(const n of e){if(!n)continue;if(!(e=u(n)))continue;let i;for(t=(e=e.getUndoStack()).length;0<t;t--){const n=e[t-1];if(""===n.group)break;if(void 0===i)i=n.group;else if(n.group!==i)break}i&&t!=e.length-1&&(t=e.splice(t,e.length-t),t=L(t,!0),e.push(...t))}},L=function(e,t){e=e.slice(),t||e.reverse();const n=[],i=Object.create(null);for(let o,a=0;o=e[a];a++)if(!o.isNull()){var r=[o.isUiEvent?ta:o.type,o.blockId,o.workspaceId].join(" "),s=i[r];const e=s?s.event:null;s?o.type===Oo.MOVE$$module$build$src$core$events$utils&&s.index===a-1?(r=o,e.newParentId=r.newParentId,e.newInputName=r.newInputName,e.newCoordinate=r.newCoordinate,r.reason&&(e.reason?(r=new Set(r.reason.concat(e.reason)),e.reason=Array.from(r)):e.reason=r.reason),s.index=a):o.type===Oo.CHANGE$$module$build$src$core$events$utils&&o.element===e.element&&o.name===e.name?e.newValue=o.newValue:o.type===ua?(s=o,e.viewTop=s.viewTop,e.viewLeft=s.viewLeft,e.scale=s.scale,e.oldScale=s.oldScale):o.type===ra&&e.type===oa||(i[r]={event:o,index:a},n.push(o)):(i[r]={event:o,index:a},n.push(o))}e=n.filter((function(e){return!e.isNull()})),t||e.reverse();for(let o,a=1;o=e[a];a++)o.type===Oo.CHANGE$$module$build$src$core$events$utils&&"mutation"===o.element&&e.unshift(e.splice(a,1)[0]);return e},O=function(){for(let e,t=0;e=va[t];t++)e.recordUndo=!1},Oo.disable$$module$build$src$core$events$utils=function(){qo++},Oo.enable$$module$build$src$core$events$utils=function(){qo--},N=function(){return 0===qo},Oo.getGroup$$module$build$src$core$events$utils=function(){return Yo},Oo.setGroup$$module$build$src$core$events$utils=function(e){_a.setGroupInternal(e)},D=function(e){Yo="boolean"===typeof e?e?M():"":e},P=function(e){const t=[];e=e.getDescendants(!1);for(let n,i=0;n=e[i];i++)t[i]=n.id;return t},$=function(e,t){const n=B(e.type);if(!n)throw Error("Unknown event type.");return n.fromJson(e,t)},B=function(e){const t=o(Bo.EVENT,e);if(!t)throw Error("Event type ".concat(e," not found in registry."));return t},F=function(e){if((e.type===Oo.MOVE$$module$build$src$core$events$utils||e.type===Oo.CREATE$$module$build$src$core$events$utils)&&e.workspaceId){var t=u(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const n=Ko;try{Ko=!1;const n=e.getParent();if(n&&n.isEnabled()){const t=e.getDescendants(!1);for(let e,n=0;e=t[n];n++)e.setEnabled(!0)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setEnabled(!1),e=e.getNextBlock()}while(e)}finally{Ko=n}}}},U=function(e,t){z(),Va=setTimeout((function(){t&&t.handleRightClick(e)}),Ua)},z=function(){Va&&(clearTimeout(Va),Va=0)},H=function(){Ha=null},G=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&W(e)},V=function(e){return"".concat(e.pointerId)},W=function(e){const t=V(e);return Ha?Ha===t:"pointerdown"===e.type&&(Ha=t,!0)},j=function(e,t,n,i,r){function s(e){(r||G(e))&&(n?i.call(n,e):i(e))}const o=[];if(t in Ga)for(let a=0;a<Ga[t].length;a++){const n=Ga[t][a];e.addEventListener(n,s,!1),o.push([e,n,s])}else e.addEventListener(t,s,!1),o.push([e,t,s]);return o},X=function(e,t,n,i){function r(e){n?i.call(n,e):i(e)}const s=[];if(t in Ga)for(let o=0;o<Ga[t].length;o++){const n=Ga[t][o];e.addEventListener(n,r,!1),s.push([e,n,r])}else e.addEventListener(t,r,!1),s.push([e,t,r]);return s},Y=function(e){const t=e[e.length-1][2];for(;e.length;){const[t,n,i]=e.pop();t.removeEventListener(n,i,!1)}return t},K=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},q=function(e){return!(!e.ctrlKey||!Ja)||2===e.button},J=function(e,t,n){const i=t.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,n||(n=t.getScreenCTM().inverse()),i.matrixTransform(n)},Z=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*el,y:e.deltaY*el};case 2:return{x:e.deltaX*tl,y:e.deltaY*tl}}},Q=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},ee=function(e){if(ol)throw Error("CSS already injected");al+="\n"+e},te=function(e,t){ol||(ol=!0,e&&(e=t.replace(/[\\/]$/,""),t=al.replace(/<<<PATH>>>/g,e),al="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},ne=function(e,t,n,i){e=e+" was deprecated in "+t+" and will be deleted in "+n+".",i&&(e+="\nUse "+i+" instead."),console.warn(e)},ie=function(e,t,n){e=document.createElementNS(dl,"".concat(e));for(const i in t)e.setAttribute(i,"".concat(t[i]));return n&&n.appendChild(e),e},re=function(e,t){return!(t=t.split(" ")).every((t=>e.classList.contains(t)))&&(e.classList.add(...t),!0)},se=function(e,t){e.classList.remove(...t.split(" "))},oe=function(e,t){return!(t=t.split(" ")).every((t=>!e.classList.contains(t)))&&(e.classList.remove(...t),!0)},ae=function(e,t){return e.classList.contains(t)},le=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},ce=function(e,t){const n=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");n?t.insertBefore(e,n):t.appendChild(e)},ue=function(e,t){return ne("Blockly.utils.dom.containsNode","version 10","version 11",'Use native "contains" DOM method'),e.contains(t)},he=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},de=function(){ml++,gl||(gl=Object.create(null))},pe=function(){--ml||(gl=null)},fe=function(e){const t=e.textContent+"\n"+e.className.baseVal;let n;if(gl&&(n=gl[t]))return n;try{n=e.getComputedTextLength()}catch(i){return 8*e.textContent.length}return gl&&(gl[t]=n),n},ge=function(e,t,n,i){return me(e,t+"pt",n,i)},me=function(e,t,n,i){const r=e.textContent;var s;return e=r+"\n"+e.className.baseVal,gl&&(s=gl[e])||(vl||((s=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(s),vl=s.getContext("2d")),vl.font=n+" "+t+" "+i,s=r?vl.measureText(r).width:0,gl&&(gl[e]=s)),s},ve=function(e,t,n,i){const r=document.createElement("span");r.style.font=n+" "+t+" "+i,r.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(r),t.appendChild(e),document.body.appendChild(t),n={height:0,baseline:0};try{t.style.alignItems="baseline",n.baseline=e.offsetTop-r.offsetTop,t.style.alignItems="flex-end",n.height=e.offsetTop-r.offsetTop}finally{document.body.removeChild(t)}return n},_e=function(e){return El.getSizeInternal(e)},be=function(e){if("none"!==Te(e,"display"))return ye(e);const t=e.style,n=t.display,i=t.visibility,r=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const s=e.offsetWidth;return e=e.offsetHeight,t.display=n,t.position=r,t.visibility=i,new Tl(s,e)},ye=function(e){return new Tl(e.offsetWidth,e.offsetHeight)},Te=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},Ee=function(e){const t=new cl(0,0);e=e.getBoundingClientRect();var n=document.documentElement;return n=new cl(window.pageXOffset||n.scrollLeft,window.pageYOffset||n.scrollTop),t.x=e.left+n.x,t.y=e.top+n.y,t},Se=function(){const e=document.body,t=document.documentElement;return new cl(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},we=function(e){const t=parseFloat(Te(e,"borderLeftWidth")),n=parseFloat(Te(e,"borderRightWidth")),i=parseFloat(Te(e,"borderTopWidth"));return e=parseFloat(Te(e,"borderBottomWidth")),new yl(i,e,t,n)},xe=function(e,t,n){e=Me(e,t,n),t.scrollLeft=e.x,t.scrollTop=e.y},Me=function(e,t,n){var i=Ee(e),r=Ee(t),s=we(t);const o=i.x-r.x-s.left;return i=i.y-r.y-s.top,r=ye(e),e=t.clientWidth-r.width,r=t.clientHeight-r.height,s=t.scrollLeft,t=t.scrollTop,n?(s+=o-e/2,t+=i-r/2):(s+=Math.min(o,Math.max(o-e,0)),t+=Math.min(i,Math.max(i-r,0))),new cl(s,t)},Ie=function(e){const t=new cl(0,0);var n=e.x&&e.getAttribute("x");const i=e.y&&e.getAttribute("y");return n&&(t.x=parseInt(n)),i&&(t.y=parseInt(i)),(n=(n=e.getAttribute("transform"))&&n.match(wl))&&(t.x+=Number(n[1]),n[3]&&(t.y+=Number(n[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(xl))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Ce=function(e){let t=0,n=0;for(;e;){const i=Ie(e);if(t+=i.x,n+=i.y,-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new cl(t,n)},ke=function(){const e=Se();return new yl(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Re=function(){const e=document.documentElement,t=window;return new cl(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Ae=function(e,t){var n=t.x;t=t.y;const i=e.getInjectionDiv().getBoundingClientRect();return n=new cl(n-i.left,t-i.top),t=e.getOriginOffsetInPixels(),cl.difference(n,t).scale(1/e.scale)},Le=function(e,t){var n=t.scale(e.scale);t=n.x,n=n.y;const i=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new cl(t+i.left+e.x,n+i.top+e.y)},Oe=function(e){({document:Rl=Rl,DOMParser:Al=Al,XMLSerializer:Ll=Ll}=e),Cl=new Al,kl=new Ll},Oo.createElement$$module$build$src$core$utils$xml=function(e){return Rl.createElementNS(Ol,e)},Oo.createTextNode$$module$build$src$core$utils$xml=function(e){return Rl.createTextNode(e)},Oo.textToDom$$module$build$src$core$utils$xml=function(e){let t=Cl.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=Cl.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error("DOMParser was unable to parse: ".concat(e))},Ne=function(e){return De(kl.serializeToString(e))},De=function(e){return e.replace(Nl,(e=>"&#".concat(e.charCodeAt(0),";")))},Pe=function(e){return e?((e instanceof Element||"string"===typeof e)&&(e=We(e),e=He(e)),$e(e),e):null},$e=function(e){const t=e.kind;if(e=e.contents,t&&t!==Bl&&t!==$l)throw Error("Invalid toolbox kind "+t+". Please supply either "+Bl+" or "+$l);if(!e)throw Error("Toolbox must have a contents attribute.")},Be=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Ge(e):[]},Fe=function(e){return Hl.hasCategoriesInternal(e)},Ue=function(e){if(!e)return!1;const t=e.kind;return t?t===$l:!!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length},ze=function(e){return!(!e||!e.contents)&&!!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length},He=function(e){const t={contents:Ge(e)};return e instanceof Node&&Ve(e,t),t},Ge=function(e){const t=[];let n=e.childNodes;n||(n=e);for(let i,r=0;i=n[r];r++){if(!i.tagName)continue;e={};const n=i.tagName.toUpperCase();e.kind=n,"BLOCK"===n?e.blockxml=i:i.childNodes&&0<i.childNodes.length&&(e.contents=Ge(i)),Ve(i,e),t.push(e)}return t},Ve=function(e,t){for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n];-1<i.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[i.nodeName.replace("css-","")]=i.value):t[i.nodeName]=i.value}},We=function(e){let t=null;if(e)if("string"===typeof e){if(t=Oo.textToDom$$module$build$src$core$utils$xml(e),"xml"!==t.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},je=function(e,t,n,i,r,s){const o=s.scrollbar&&s.scrollbar.canScrollVertically();return e.horizontal===Ul.LEFT?(n=r.absoluteMetrics.left+n,o&&s.RTL&&(n+=Il.scrollbarThickness)):(n=r.absoluteMetrics.left+r.viewMetrics.width-t.width-n,o&&!s.RTL&&(n-=Il.scrollbarThickness)),e.vertical===Fl.TOP?e=r.absoluteMetrics.top+i:(e=r.absoluteMetrics.top+r.viewMetrics.height-t.height-i,s.scrollbar&&s.scrollbar.canScrollHorizontally()&&(e-=Il.scrollbarThickness)),new yl(e,e+t.height,n,n+t.width)},Xe=function(e,t){return{horizontal:t.toolboxMetrics.position===Pl.LEFT||e.horizontalLayout&&!e.RTL?Ul.RIGHT:Ul.LEFT,vertical:t.toolboxMetrics.position===Pl.BOTTOM?Fl.TOP:Fl.BOTTOM}},Ye=function(e,t,n,i){const r=e.left,s=e.right-e.left,o=e.bottom-e.top;for(let a=0;a<i.length;a++){const l=i[a];e.intersects(l)&&(e=n===zl.UP?l.top-o-t:l.bottom+t,e=new yl(e,e+o,r,r+s),a=-1)}return e},Ke=function(e,t){ql(e,t)},qe=function(e){ql=e},Je=function(e,t){Ql.confirmInternal(e,t)},Ze=function(e,t){Jl(e,t)},Qe=function(e){Jl=e},et=function(e,t,n){Zl(e,t,n)},tt=function(e){Zl=e},nt=function(e){return void 0!==e.getVariableModel},it=function(e){return void 0!==e.getProcedureDef},rt=function(e){return void 0!==e.getProcedureCall&&void 0!==e.renameProcedure},Oo.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n=0;n<e.length;n++){const i=e[n].getVarModels();if(i)for(let e=0;e<i.length;e++){const n=i[e];n.getId()&&t.add(n)}}return Array.from(t.values())},Oo.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let i,r=0;i=e[r];r++){var n=i.getDeveloperVariables;if(n){n=n();for(let e=0;e<n.length;e++)t.add(n[e])}}return Array.from(t.values())},st=function(e){let t=[];const n=document.createElement("button");return n.setAttribute("text","%{BKY_NEW_VARIABLE}"),n.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",(function(e){ut(e.getTargetWorkspace())})),t.push(n),e=ot(e),t.concat(e)},ot=function(e){const t=[];if(0<(e=e.getVariablesOfType("")).length){var n=e[e.length-1];if(Ho.variables_set){var i=Oo.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","variables_set"),i.setAttribute("gap",Ho.math_change?"8":"24"),i.appendChild(vt(n)),t.push(i)}if(Ho.math_change&&((i=Oo.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),i.setAttribute("gap",Ho.variables_get?"20":"8"),i.appendChild(vt(n)),n=Oo.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),i.appendChild(n),t.push(i)),Ho.variables_get){e.sort(rc.compareByName);for(let i,r=0;i=e[r];r++)(n=Oo.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),n.setAttribute("gap","8"),n.appendChild(vt(i)),t.push(n)}}return t},at=function(e){return ac.generateUniqueNameInternal(e)},lt=function(e){return ct(oc.charAt(0),e.getAllVariableNames())},ct=function(e,t){if(!t.length)return e;const n=oc;let i="",r=n.indexOf(e);for(;;){let s=!1;for(let n=0;n<t.length;n++)if(t[n].toLowerCase()===e){s=!0;break}if(!s)break;r++,r===n.length&&(r=0,i="".concat(Number(i)+1)),e=n.charAt(r)+i}return e},ut=function(e,t,n){function i(n){ht(Oo.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,n,(function(n){if(n){var s=pt(n,e);if(s){if(s.type===r)var o=Oo.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",s.name);else o=(o=Oo.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s.name).replace("%2",s.type);Ke(o,(function(){i(n)}))}else e.createVariable(n,r),t&&t(n)}else t&&t(null)}))}const r=n||"";i("")},Oo.renameVariable$$module$build$src$core$variables=function(e,t,n){function i(r){const s=Oo.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);ht(s,r,(function(r){if(r){var s=dt(r,t.type,e),o=ft(t.name,r,e);if(s||o){var a="";s?a=Oo.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",s.name).replace("%2",s.type):o&&(a=Oo.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",r).replace("%2",o)),Ke(a,(function(){i(r)}))}else e.renameVariableById(t.getId(),r),n&&n(r)}else n&&n(null)}))}i("")},ht=function(e,t,n){et(e,t,(function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").trim())===Oo.Msg$$module$build$src$core$msg.RENAME_VARIABLE||e===Oo.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(e=null),n(e)}))},dt=function(e,t,n){n=n.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let i,r=0;i=n[r];r++)if(i.name.toLowerCase()===e&&i.type!==t)return i;return null},pt=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,i=0;n=t[i];i++)if(n.name.toLowerCase()===e)return n;return null},ft=function(e,t,n){return n.getProcedureMap().getProcedures().length?gt(e,t,n):mt(e,t,n)},gt=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getProcedureMap().getProcedures();for(const r of n){var i=r.getParameters().filter(nt).map((e=>e.getVariableModel().name));if(i&&(n=i.some((t=>t.toLowerCase()===e)),i=i.some((e=>e.toLowerCase()===t)),n&&i))return r.getName()}return null},mt=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getAllBlocks(!1);for(const r of n){if(!it(r))continue;var i=(n=r.getProcedureDef())[1];const s=i.some((t=>t.toLowerCase()===e));if(i=i.some((e=>e.toLowerCase()===t)),s&&i)return n[0]}return null},vt=function(e){const t=Oo.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=Oo.createTextNode$$module$build$src$core$utils$xml(e.name),t.appendChild(e),t},Oo.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,n,i){let r=Oo.getVariable$$module$build$src$core$variables(e,t,n,i);return r||(r=_t(e,t,n,i)),r},Oo.getVariable$$module$build$src$core$variables=function(e,t,n,i){const r=e.getPotentialVariableMap();let s=null;if(t&&(s=e.getVariableById(t),!s&&r&&(s=r.getVariableById(t)),s))return s;if(n){if(void 0===i)throw Error("Tried to look up a variable by name without a type");s=e.getVariable(n,i),!s&&r&&(s=r.getVariable(n,i))}return s},_t=function(e,t,n,i){const r=e.getPotentialVariableMap();return n||(n=at(e.isFlyout?e.targetWorkspace:e)),r?r.createVariable(n,i,t):e.createVariable(n,i,t)},bt=function(e,t){e=e.getAllVariables();const n=[];if(t.length!==e.length)for(let i=0;i<e.length;i++){const r=e[i];-1===t.indexOf(r)&&n.push(r)}return n},yt=function(t,n){e(Bo.PASTER,t,n)},Tt=function(e){i(Bo.PASTER,e)},Et=function(e){return Mt(e),xt()?(It(),Promise.resolve()):(bc||(bc=new Promise((e=>{yc=e,Tc=window.requestAnimationFrame((()=>{It(),e()}))}))),bc)},St=function(){return bc||Promise.resolve()},wt=function(e){e||window.cancelAnimationFrame(Tc),It(e),!e&&yc&&yc()},xt=function(){return ja},Mt=function(e){_c.add(e);const t=e.getParent();t?Mt(t):vc.add(e)},It=function(e){const t=e?new Set([e]):new Set([...vc].map((e=>e.workspace))),n=[...vc].filter(kt).filter((e=>t.has(e.workspace)));for(var i of n)Rt(i);for(const r of t)r.resizeContents();for(const r of n)i=r.getRelativeToSurfaceXY(),r.updateComponentLocations(i);for(const r of n)Ct(r);e||(bc=null)},Ct=function(e){vc.delete(e),_c.delete(e);for(const t of e.getChildren(!1))Ct(t)},kt=function(e){return!e.isDisposed()&&!e.getParent()},Rt=function(e){if(_c.has(e)){for(const t of e.getChildren(!1))Rt(t);e.renderEfficiently()}},At=function(e,t){const n=Oo.createElement$$module$build$src$core$utils$xml("xml");var i=Lt(Oo.allUsedVarModels$$module$build$src$core$variables(e));i.hasChildNodes()&&n.appendChild(i),i=e.getTopComments(!0);for(let r=0;r<i.length;r++)n.appendChild(i[r].toXmlWithXY(t));for(e=e.getTopBlocks(!0),i=0;i<e.length;i++)n.appendChild(Ot(e[i],t));return n},Lt=function(e){const t=Oo.createElement$$module$build$src$core$utils$xml("variables");for(let n=0;n<e.length;n++){const i=e[n],r=Oo.createElement$$module$build$src$core$utils$xml("variable");r.appendChild(Oo.createTextNode$$module$build$src$core$utils$xml(i.name)),i.type&&r.setAttribute("type",i.type),r.id=i.getId(),t.appendChild(r)}return t},Ot=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let n=0;if(e.workspace.RTL&&(n=e.workspace.getWidth()),t=Pt(e,t),tn(t)){const i=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?n-i.x:i.x))),t.setAttribute("y",String(Math.round(i.y)))}return t},Nt=function(e){if(e.isSerializable()){const t=Oo.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},Dt=function(e,t){for(let n=0;n<e.inputList.length;n++){const i=e.inputList[n];for(let e=0;e<i.fieldRow.length;e++){const n=Nt(i.fieldRow[e]);n&&t.appendChild(n)}}},Pt=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Pt(t):new DocumentFragment;const n=Oo.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(n.setAttribute("type",e.type),t||(n.id=e.id),e.mutationToDom){var i=e.mutationToDom();i&&(i.hasChildNodes()||i.hasAttributes())&&n.appendChild(i)}if(Dt(e,n),i=e.getCommentText()){var r=e.getIcon(Xl.COMMENT),s=r.getBubbleSize();r=r.bubbleIsVisible();var o=Oo.createElement$$module$build$src$core$utils$xml("comment");o.appendChild(Oo.createTextNode$$module$build$src$core$utils$xml(i)),o.setAttribute("pinned","".concat(r)),o.setAttribute("h",String(s.height)),o.setAttribute("w",String(s.width)),n.appendChild(o)}for(e.data&&((i=Oo.createElement$$module$build$src$core$utils$xml("data")).appendChild(Oo.createTextNode$$module$build$src$core$utils$xml(e.data)),n.appendChild(i)),i=0;i<e.inputList.length;i++){var a=void 0;if(r=!0,(s=e.inputList[i]).type!==Oo.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&s.type!==Oo.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){o=s.connection.targetBlock(),s.type===Oo.inputTypes$$module$build$src$core$inputs$input_types.VALUE?a=Oo.createElement$$module$build$src$core$utils$xml("value"):s.type===Oo.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(a=Oo.createElement$$module$build$src$core$utils$xml("statement"));const e=s.connection.getShadowDom();!e||o&&o.isShadow()||a.appendChild($t(e,t)),o&&(o=Pt(o,t)).nodeType===hl.ELEMENT_NODE&&(a.appendChild(o),r=!1),a.setAttribute("name",s.name),r||n.appendChild(a)}}let l;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&n.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&n.setAttribute("collapsed","true"),e.isEnabled()||n.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||n.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||n.setAttribute("movable","false"),e.isEditable()||n.setAttribute("editable","false"),(a=e.getNextBlock())&&(i=Pt(a,t)).nodeType===hl.ELEMENT_NODE&&(l=Oo.createElement$$module$build$src$core$utils$xml("next"),l.appendChild(i),n.appendChild(l)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||a&&a.isShadow()||l.appendChild($t(e,t)),n},$t=function(e,t){let n,i=e=e.cloneNode(!0);for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let e;n=i,i=i.parentNode,n.nodeType===hl.TEXT_NODE&&""===n.data.trim()&&(null==(e=i)?void 0:e.firstChild)!==n&&le(n)}i&&(n=i,i=i.nextSibling,n.nodeType===hl.TEXT_NODE&&""===n.data.trim()&&le(n))}return e},Bt=function(e){return Ne(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Ft=function(e){e=Bt(e).split("<");let t="";for(let n=1;n<e.length;n++){const i=e[n];"/"===i[0]&&(t=t.substring(2)),e[n]=t+"<"+i,"/"!==i[0]&&"/>"!==i.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Ut=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=Oo.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},Oo.domToWorkspace$$module$build$src$core$xml=function(e,t){let n=0;t.RTL&&(n=t.getWidth());const i=[];de();const r=Oo.getGroup$$module$build$src$core$events$utils();r||Oo.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let s=!0;try{for(let r,o=0;r=e.childNodes[o];o++){const e=r.nodeName.toLowerCase(),o=r;if("block"===e||"shadow"===e&&!C()){const e=Ht(o,t);let r;i.push(e.id);const a=parseInt(null!=(r=o.getAttribute("x"))?r:"10",10);let l;const c=parseInt(null!=(l=o.getAttribute("y"))?l:"10",10);isNaN(a)||isNaN(c)||e.moveBy(t.RTL?n-a:a,c,["create"]),s=!1}else{if("shadow"===e)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===e)t.rendered?mc.fromXmlRendered(o,t,n):cc.fromXml(o,t);else if("variables"===e){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Gt(o,t),s=!1}}}}finally{Oo.setGroup$$module$build$src$core$events$utils(r),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&wt(),pe()}return k(new(B(ga))(t)),i},zt=function(e,t){if(!t.getBlocksBoundingBox)return Oo.domToWorkspace$$module$build$src$core$xml(e,t);var n=t.getBlocksBoundingBox();if(e=Oo.domToWorkspace$$module$build$src$core$xml(e,t),n&&n.top!==n.bottom){var i=n.bottom;n=t.RTL?n.right:n.left;var r=1/0;let s=-1/0,o=1/0;for(let n=0;n<e.length;n++){const i=t.getBlockById(e[n]).getRelativeToSurfaceXY();i.y<o&&(o=i.y),i.x<r&&(r=i.x),i.x>s&&(s=i.x)}for(i=i-o+10,n=t.RTL?n-s:n-r,r=0;r<e.length;r++)t.getBlockById(e[r]).moveBy(n,i,["create"])}return e},Oo.domToBlock$$module$build$src$core$xml=function(e,t){return e=Ht(e,t),t.rendered&&wt(),e},Ht=function(e,t){Oo.disable$$module$build$src$core$events$utils();var n=t.getAllVariables();let i;try{if(i=Zt(e,t),t.rendered){const e=i,n=i.getDescendants(!1);e.setConnectionTracking(!1);for(let t=n.length-1;0<=t;t--)n[t].initSvg();for(let t=n.length-1;0<=t;t--)n[t].queueRender();setTimeout((function(){e.disposed||e.setConnectionTracking(!0)}),1),t.resizeContents()}else{const e=i.getDescendants(!1);for(let t=e.length-1;0<=t;t--)e[t].initModel()}}finally{Oo.enable$$module$build$src$core$events$utils()}if(N()){for(e=bt(t,n),t=0;t<e.length;t++)n=e[t],k(new(B(Zo))(n));k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(i))}return i},Gt=function(e,t){for(let i=0;i<e.children.length;i++){var n=e.children[i];const r=n.getAttribute("type"),s=n.getAttribute("id");if(!(n=n.textContent))break;t.createVariable(n,r,s)}},Vt=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let n=0;n<e.children.length;n++){const i=e.children[n];if(i.nodeType!==hl.TEXT_NODE)switch(i.nodeName.toLowerCase()){case"mutation":t.mutation.push(i);break;case"comment":t.comment.push(i);break;case"data":t.data.push(i);break;case"title":case"field":t.field.push(i);break;case"value":case"statement":t.input.push(i);break;case"next":t.next.push(i);break;default:console.warn("Ignoring unknown tag: "+i.nodeName)}}return t},Wt=function(e,t){let n=!1;for(let i=0;i<e.length;i++){const r=e[i];t.domToMutation&&(t.domToMutation(r),t.initSvg&&(n=!0))}return n},jt=function(e,t){for(let i=0;i<e.length;i++){var n=e[i];const r=n.textContent,s="true"===n.getAttribute("pinned");let o;const a=parseInt(null!=(o=n.getAttribute("w"))?o:"50",10);let l;n=parseInt(null!=(l=n.getAttribute("h"))?l:"50",10),t.setCommentText(r);const c=t.getIcon(Xl.COMMENT);isNaN(a)||isNaN(n)||c.setBubbleSize(new Tl(a,n)),c.setBubbleVisible(s),setTimeout((()=>c.setBubbleVisible(s)),1)}},Xt=function(e,t){for(let n=0;n<e.length;n++)t.data=e[n].textContent},Yt=function(e,t){for(let n=0;n<e.length;n++){const i=e[n],r=i.getAttribute("name");r?Qt(t,r,i):console.warn("Ignoring unnamed field in block ".concat(t.type))}},Kt=function(e){let t=null,n=null;for(let i=0;i<e.childNodes.length;i++){const r=e.childNodes[i];tn(r)&&("block"===r.nodeName.toLowerCase()?t=r:"shadow"===r.nodeName.toLowerCase()&&(n=r))}return{childBlockElement:t,childShadowElement:n}},qt=function(e,t,n,i){for(let s=0;s<e.length;s++){var r=e[s];const o=r.getAttribute("name"),a=o?n.getInput(o):null;if(!a){console.warn("Ignoring non-existent input "+o+" in block "+i);break}if((r=Kt(r)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");Zt(r.childBlockElement,t,a.connection,!1)}if(r.childShadowElement){let e;null==(e=a.connection)||e.setShadowDom(r.childShadowElement)}}},Jt=function(e,t,n){for(let i=0;i<e.length;i++){const r=Kt(e[i]);if(r.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Zt(r.childBlockElement,t,n.nextConnection,!0)}r.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(r.childShadowElement)}},Zt=function(e,t,n,i){var r;const s=e.getAttribute("type");if(!s)throw TypeError("Block type unspecified: "+e.outerHTML);var o=null!=(r=e.getAttribute("id"))?r:void 0;r=t.newBlock(s,o),o=Vt(e);const a=Wt(o.mutation,r);if(jt(o.comment,r),Xt(o.data,r),n)if(i){if(!r.previousConnection)throw TypeError("Next block does not have previous statement.");n.connect(r.previousConnection)}else if(r.outputConnection)n.connect(r.outputConnection);else{if(!r.previousConnection)throw TypeError("Child block does not have output or previous statement.");n.connect(r.previousConnection)}if(Yt(o.field,r),qt(o.input,t,r,s),Jt(o.next,t,r),a&&r.initSvg(),(t=e.getAttribute("inline"))&&r.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&r.setEnabled("true"!==t&&"disabled"!==t),(t=e.getAttribute("deletable"))&&r.setDeletable("true"===t),(t=e.getAttribute("movable"))&&r.setMovable("true"===t),(t=e.getAttribute("editable"))&&r.setEditable("true"===t),(t=e.getAttribute("collapsed"))&&r.setCollapsed("true"===t),"shadow"===e.nodeName.toLowerCase()){for(e=r.getChildren(!1),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(r.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");r.setShadow(!0)}return r},Qt=function(e,t,n){const i=e.getField(t);i?i.fromXml(n):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},en=function(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if("next"===n.nodeName.toLowerCase()){e.removeChild(n);break}}},tn=function(e){return e.nodeType===hl.ELEMENT_NODE},nn=function(e){return void 0!==e.saveState&&void 0!==e.loadState},rn=function(t,n){e(Bo.SERIALIZER,t,n)},sn=function(e){i(Bo.SERIALIZER,e)},on=function(e){let{addCoordinates:t=!1,addInputBlocks:n=!0,addNextBlocks:i=!0,doFullSerialization:r=!0,saveIds:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.isInsertionMarker())return null;const o={type:e.type,id:s?e.id:void 0};return t&&ln(e,o),an(e,o),cn(e,o,r),un(e,o,r),hn(e,o,r),n&&dn(e,o,r,s),i&&pn(e,o,r,s),o},an=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.enabled=!1),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},ln=function(e,t){const n=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(n.RTL?n.getWidth()-e.x:e.x),t.y=Math.round(e.y)},cn=function(e,t,n){e.saveExtraState?null!==(e=e.saveExtraState(n))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=Bt(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},un=function(e,t,n){const i=Object.create(null);for(const r of e.getIcons())nn(r)&&(e=r.saveState(n))&&(i[r.getType().toString()]=e);Object.keys(i).length&&(t.icons=i)},hn=function(e,t,n){const i=Object.create(null);for(let r=0;r<e.inputList.length;r++){const t=e.inputList[r];for(let e=0;e<t.fieldRow.length;e++){const r=t.fieldRow[e];r.isSerializable()&&(i[r.name]=r.saveState(n))}}Object.keys(i).length&&(t.fields=i)},dn=function(e,t,n,i){const r=Object.create(null);for(let s=0;s<e.inputList.length;s++){const t=e.inputList[s];if(!t.connection)continue;const o=fn(t.connection,n,i);o&&(r[t.name]=o)}Object.keys(r).length&&(t.inputs=r)},pn=function(e,t,n,i){e.nextConnection&&(e=fn(e.nextConnection,n,i))&&(t.next=e)},fn=function(e,t,n){const i=e.getShadowState(!0);if(e=e.targetBlock(),!i&&!e)return null;const r=Object.create(null);return i&&(r.shadow=i),e&&!e.isShadow()&&(r.block=on(e,{doFullSerialization:t,saveIds:n})),r},gn=function(e,t){let{recordUndo:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=mn(e,t,{recordUndo:n}),t.rendered&&wt(),e},mn=function(e,t){let{parentConnection:n,isShadow:i=!1,recordUndo:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=C();let o;I(r),(r=Oo.getGroup$$module$build$src$core$events$utils())||Oo.setGroup$$module$build$src$core$events$utils(!0),Oo.disable$$module$build$src$core$events$utils();try{o=vn(e,t,{parentConnection:n,isShadow:i})}finally{Oo.enable$$module$build$src$core$events$utils()}if(N()&&k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(o)),Oo.setGroup$$module$build$src$core$events$utils(r),I(s),t.rendered){const e=o;setTimeout((()=>{e.disposed||e.setConnectionTracking(!0)}),1)}return o},vn=function(e,t){let{parentConnection:n,isShadow:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.type)throw new xc(e);const r=t.newBlock(e.type,e.id);return r.setShadow(i),_n(r,e),bn(r,e),yn(r,e),Tn(n,r,e),En(r,e),Sn(r,e),wn(r,e),xn(r,e),In(r,t.rendered),r},_n=function(e,t){let n=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const i=e.workspace;n=i.RTL?i.getWidth()-n:n,e.moveBy(n,t)},bn=function(e,t){t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setEnabled(!1),void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},yn=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(Oo.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Tn=function(e,t,n){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Cc(n);if(e.type===Oo.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var i=t.outputConnection;if(!i)throw new Mc("output",t,n)}else if(!(i=t.previousConnection))throw new Mc("previous",t,n);if(!e.connect(i)){const r=t.workspace.connectionChecker;throw new Ic(r.getErrorMessage(r.canConnectWithReason(i,e,!1),i,e),e.type===Oo.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,n)}}},En=function(e,t){if(t.icons){var n=Object.keys(t.icons);for(const r of n){n=t.icons[r];var i=e.getIcon(r);if(!i){if(!(i=o(Bo.ICON,r,!1)))throw new kc(r,e,t);i=new i(e),e.addIcon(i)}nn(i)&&i.loadState(n)}}},Sn=function(e,t){if(t.fields){var n=Object.keys(t.fields);for(let i=0;i<n.length;i++){const r=n[i],s=t.fields[r],o=e.getField(r);o?o.loadState(s):console.warn("Ignoring non-existant field ".concat(r," in block ").concat(e.type))}}},wn=function(e,t){if(t.inputs){var n=Object.keys(t.inputs);for(let i=0;i<n.length;i++){const r=n[i],s=e.getInput(r);if(!s||!s.connection)throw new Mc(r,e,t);Mn(s.connection,t.inputs[r])}}},xn=function(e,t){if(t.next){if(!e.nextConnection)throw new Mc("next",e,t);Mn(e.nextConnection,t.next)}},Mn=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&vn(t.block,e.getSourceBlock().workspace,{parentConnection:e})},In=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const t of e.getIcons())t.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Cn=function(e){const t=e.workspace,n=Oo.config$$module$build$src$core$config.snapRadius,i=e.getRelativeToSurfaceXY(),r=new cl(0,0),s=t.getAllBlocks(!1).filter((t=>t.id!=e.id)).map((e=>e.getRelativeToSurfaceXY()));for(;kn(cl.sum(i,r),s)||Rn(e,r,n);)t.RTL?r.translate(-n,2*n):r.translate(n,2*n);e.moveTo(cl.sum(i,r))},kn=function(e,t){return t.some((t=>1>=Math.abs(t.x-e.x)&&1>=Math.abs(t.y-e.y)))},Rn=function(e,t,n){return e.getConnections_(!1).some((e=>!!e.closest(n,t).connection))},An=function(e){return ne("Blockly.clipboard.copy","v11","v12","myCopyable.toCopyData()"),qc.copyInternal(e)},Ln=function(e){const t=e.toCopyData();let n;return Yc=t,Kc=null!=(n=e.workspace)?n:null,t},On=function(e,t,n){return e&&t?Nn(e,t,n):Yc&&Kc?Nn(Yc,Kc):null},Nn=function(e,t,n){let i,r,s;return t=null!=(i=t.getRootWorkspace())?i:t,null!=(s=null==(r=a(Bo.PASTER,e.paster,!1))?void 0:r.paste(e,t,n))?s:null},Dn=function(e){return ne("Blockly.clipboard.duplicate","v11","v12","Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)"),qc.duplicateInternal(e)},Pn=function(e){const t=e.toCopyData();return t?On(t,e.workspace):null},$n=function(e,t){e.setAttribute(tu,t)},Bn=function(e,t,n){Array.isArray(n)&&(n=n.join(" ")),e.setAttribute(eu+t,"".concat(n))},Fn=function(){return iu},Un=function(e){if(iu=e,null===e){let e;null==(e=document.querySelector("."+lu))||e.remove()}},zn=function(){document.querySelector("."+lu)||((iu=document.createElement("div")).className=lu,(_()||document.body).appendChild(iu))},Hn=function(e,t,n){Gn(),ou=e,au=n,(e=iu)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=f(),cu=t.getRenderer().getClassName(),uu=t.getTheme().getClassName(),cu&&re(e,cu),uu&&re(e,uu))},Gn=function(){if(Vn()){ou=null;var e=iu;e&&(e.style.display="none",e.style.left="",e.style.top="",au&&au(),au=null,e.textContent="",cu&&(oe(e,cu),cu=""),uu&&(oe(e,uu),uu=""),f().markFocused())}},Vn=function(){return!!ou},Wn=function(e){ou===e&&Gn()},jn=function(e,t,n){iu.style.left=e+"px",iu.style.top=t+"px",iu.style.height=n+"px"},Xn=function(e,t,n,i){const r=Kn(e,t,n);e=Yn(e,t,n,i),0>r?jn(e,0,n.height+r):jn(e,r,n.height)},Yn=function(e,t,n,i){return i?Math.min(Math.max(t.right-n.width,e.left),e.right-n.width):Math.max(Math.min(t.left,e.right-n.width),e.left)},Kn=function(e,t,n){return t.bottom+n.height>=e.bottom?t.top-n.height:t.bottom},qn=function(e){return!(null==e||!e.repositionForWindowResize)},Jn=function(){qn(ou)&&ou.repositionForWindowResize()||Gn()},Zn=function(){return du},Qn=function(e){du=e},ei=function(e,t,n){if(Hn(pu,n,oi),t.length){var i=ti(t,n);fu=i,ni(i,e,n),setTimeout((function(){i.focus()}),1),du=null}else si()},ti=function(e,t){const n=new ru;n.setRole(Zc.MENU);for(let i=0;i<e.length;i++){const r=e[i],s=new su(r.text);s.setRightToLeft(t),s.setRole(Zc.MENUITEM),n.addChild(s),s.setEnabled(r.enabled),r.enabled&&s.onAction((function(){si(),requestAnimationFrame((()=>{setTimeout((()=>{r.callback(r.scope)}),0)}))}),{})}return n},ni=function(e,t,n){const i=ke();t=new yl(t.clientY+i.top,t.clientY+i.top,t.clientX+i.left,t.clientX+i.left),ii(e);const r=e.getSize();n&&(t.left+=r.width,t.right+=r.width,i.left+=r.width,i.right+=r.width),Xn(i,t,r,n),e.focus()},ii=function(e){var t=Fn();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),re(t,"blocklyContextMenu"),j(t,"contextmenu",null,ri),e.focus()},ri=function(e){e.preventDefault(),e.stopPropagation()},si=function(){Wn(pu),du=null},oi=function(){fu&&(fu.dispose(),fu=null)},Oo.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let n;Oo.disable$$module$build$src$core$events$utils();try{n=t instanceof Element?Ht(t,e.workspace):mn(t,e.workspace);const i=e.getRelativeToSurfaceXY();i.x=e.RTL?i.x-Oo.config$$module$build$src$core$config.snapRadius:i.x+Oo.config$$module$build$src$core$config.snapRadius,i.y+=2*Oo.config$$module$build$src$core$config.snapRadius,n.moveBy(i.x,i.y)}finally{Oo.enable$$module$build$src$core$events$utils()}return N()&&!n.isShadow()&&k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}},ai=function(e){return{text:Oo.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){Oo.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),Oo.setGroup$$module$build$src$core$events$utils(!1)}}},li=function(e){return{text:Oo.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const t=e.toCopyData();t&&On(t,e.workspace)}}},ci=function(e,t){const n={enabled:!0};return n.text=Oo.Msg$$module$build$src$core$msg.ADD_COMMENT,n.callback=function(){const n=new mc(e,Oo.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,mc.DEFAULT_SIZE,mc.DEFAULT_SIZE);var i=e.getInjectionDiv().getBoundingClientRect();i=new cl(t.clientX-i.left,t.clientY-i.top);const r=e.getOriginOffsetInPixels();(i=cl.difference(i,r)).scale(1/e.scale),n.moveBy(i.x,i.y),e.rendered&&(n.initSvg(),n.render(),n.select())},n},ui=function(e){return e*Math.PI/180},hi=function(e){return 180*e/Math.PI},di=function(e,t,n){if(n<e){const t=n;n=e,e=t}return Math.max(e,Math.min(t,n))},pi=function(){document.querySelector(".blocklyDropDownDiv")||((yu=document.createElement("div")).className="blocklyDropDownDiv",(_()||document.body).appendChild(yu),(Tu=document.createElement("div")).className="blocklyDropDownContent",yu.appendChild(Tu),(Eu=document.createElement("div")).className="blocklyDropDownArrow",yu.appendChild(Eu),yu.style.opacity="0",yu.style.transition="transform "+Iu+"s, opacity "+Iu+"s",yu.addEventListener("focusin",(function(){re(yu,"blocklyFocused")})),yu.addEventListener("focusout",(function(){oe(yu,"blocklyFocused")})))},fi=function(e){Lu=e},gi=function(){return Ou},mi=function(){return Tu},vi=function(){Tu.textContent="",Tu.style.width=""},_i=function(e,t){yu.style.backgroundColor=e,yu.style.borderColor=t},bi=function(e,t,n,i){return Si(Ti(t),e,n,i)},yi=function(e,t,n){return Nu=!0,Si(Ei(e),e,t,n)},Ti=function(e){var t=e.getSvgRoot();const n=e.workspace.scale,i=e.height*n;return e=e.width*n,t=Ee(t),new yl(t.y,t.y+i,t.x,t.x+e)},Ei=function(e){return e=e.getScaledBBox(),new yl(e.top,e.bottom,e.left,e.right)},Si=function(e,t,n,i){const r=e.left+(e.right-e.left)/2,s=e.bottom;e=e.top,i&&(e+=i);let o=(i=t.getSourceBlock()).workspace;for(;o.options.parentWorkspace;)o=o.options.parentWorkspace;return fi(o.getParentSvg().parentNode),wi(t,i.RTL,r,s,r,e,n)},wi=function(e,t,n,i,r,s,o){return Ou=e,ku=o||null,yu.style.direction=t?"rtl":"ltr",e=f(),Ru=e.getRenderer().getClassName(),Au=e.getTheme().getClassName(),Ru&&re(yu,Ru),Au&&re(yu,Au),Oi(n,i,r,s)},xi=function(e,t,n,i){return{initialX:(e=Ci(e,n.left,n.right,i.width)).divX,initialY:t,finalX:e.divX,finalY:t+Mu,arrowX:e.arrowX,arrowY:-(Su/2+wu),arrowAtTop:!0,arrowVisible:!0}},Mi=function(e,t,n,i){return{initialX:(e=Ci(e,n.left,n.right,i.width)).divX,initialY:t-i.height,finalX:e.divX,finalY:t-i.height-Mu,arrowX:e.arrowX,arrowY:i.height-2*wu-Su/2,arrowAtTop:!1,arrowVisible:!0}},Ii=function(e,t,n){return{initialX:(e=Ci(e,t.left,t.right,n.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Ci=function(e,t,n,i){return t=di(t,e-i/2,n-i),{arrowX:e=di(n=xu,e=e-Su/2-t,i-n-Su),divX:t}},ki=function(){return!!Ou},Ri=function(e,t){return Ou===e&&(t?Li():Ai(),!0)},Ai=function(){yu.style.transform="translate(0, 0)",yu.style.opacity="0",Cu=setTimeout((function(){Li()}),1e3*Iu),ku&&(ku(),ku=null)},Li=function(){ki()&&(Cu&&clearTimeout(Cu),yu.style.transform="",yu.style.left="",yu.style.top="",yu.style.opacity="0",yu.style.display="none",yu.style.backgroundColor="",yu.style.borderColor="",ku&&(ku(),ku=null),vi(),Ou=null,Ru&&(oe(yu,Ru),Ru=""),Au&&(oe(yu,Au),Au=""),f().markFocused())},Oi=function(e,t,n,i){(e=Du.getPositionMetrics(e,t,n,i)).arrowVisible?(Eu.style.display="",Eu.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Eu.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):Eu.style.display="none",t=Math.floor(e.initialX),n=Math.floor(e.initialY),i=Math.floor(e.finalX);const r=Math.floor(e.finalY);return yu.style.left=t+"px",yu.style.top=n+"px",yu.style.display="block",yu.style.opacity="1",yu.style.transform="translate("+(i-t)+"px,"+(r-n)+"px)",!!e.arrowAtTop},Ni=function(){if(Ou){var e=Ou.getSourceBlock();const t=(e=Nu?Ei(Ou):Ti(e)).left+(e.right-e.left)/2;Oi(t,e.bottom,t,e.top)}else Ai()},Di=function(e){if(!(100<e.getDescendants(!1).length)){var t=e.workspace,n=e.getSvgRoot();t.getAudioManager().play("delete");var i=t.getSvgXY(n);(n=n.cloneNode(!0)).setAttribute("transform","translate("+i.x+","+i.y+")"),t.getParentSvg().appendChild(n),Pi(n,{x:i.x,y:i.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)}},Pi=function(e,t,n,i,r){const s=((new Date).getTime()-i.getTime())/150;1<s?le(e):(e.setAttribute("transform","translate("+(t.x+(n?-1:1)*t.width*r/2*s)+","+(t.y+t.height*r*s)+") scale("+(1-s)*r+")"),setTimeout(Pi,10,e,t,n,i,r))},$i=function(e){var t=e.workspace;const n=t.scale;if(t.getAudioManager().play("click"),!(1>n)){var i=t.getSvgXY(e.getSvgRoot());e.outputConnection?(i.x+=(e.RTL?3:-3)*n,i.y+=13*n):e.previousConnection&&(i.x+=(e.RTL?-23:23)*n,i.y+=3*n);var r=ie(bl.CIRCLE,{cx:i.x,cy:i.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=ie(bl.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*n},r),t=ie(bl.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},r),e.beginElement(),t.beginElement(),setTimeout((()=>{le(r)}),150)}},Bi=function(e){if(Ui(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Bu=e,Fi(e,t,new Date)}},Fi=function(e,t,n){const i=((new Date).getTime()-n.getTime())/200;let r="";1>=i&&(r="skewX(".concat(Math.round(Math.sin(i*Math.PI*3)*(1-i)*t),")"),$u=setTimeout(Fi,10,e,t,n)),e.getSvgRoot().setAttribute("transform","".concat(e.getTranslation()," ").concat(r))},Ui=function(){Bu&&($u&&(clearTimeout($u),$u=null),Bu.getSvgRoot().setAttribute("transform",Bu.getTranslation()),Bu=null)},zi=function(e,t){return ne("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},Hi=function(e){return e.length?e.reduce((function(e,t){return e.length<t.length?e:t})).length:0},Gi=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,i=0;for(t=t||Hi(e),n=0;n<t;n++){for(var r=e[0][n],s=1;s<e.length;s++)if(r!==e[s][n])return i;" "===r&&(i=n+1)}for(r=1;r<e.length;r++)if((s=e[r][n])&&" "!==s)return i;return t},Vi=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,i=0;for(t=t||Hi(e),n=0;n<t;n++){for(var r=e[0].substr(-n-1,1),s=1;s<e.length;s++)if(r!==e[s].substr(-n-1,1))return i;" "===r&&(i=n+1)}for(r=1;r<e.length;r++)if((s=e[r].charAt(e[r].length-n-1))&&" "!==s)return i;return t},Oo.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let n=0;n<e.length;n++)e[n]=Wi(e[n],t);return e.join("\n")},Wi=function(e,t){if(e.length<=t)return e;const n=e.trim().split(/\s+/);for(var i=0;i<n.length;i++)n[i].length>t&&(t=n[i].length);var r=-1/0;let s,o=1;do{i=r,s=e,e=[],r=n.length/o;let a=1;for(let t=0;t<n.length-1;t++)a<(t+1.5)/r?(a++,e[t]=!0):e[t]=!1;e=Xi(n,e,t),r=ji(n,e,t),e=Yi(n,e),o++}while(r>i);return s},ji=function(e,t,n){const i=[0],r=[];for(var s=0;s<e.length;s++)i[i.length-1]+=e[s].length,!0===t[s]?(i.push(0),r.push(e[s].charAt(e[s].length-1))):!1===t[s]&&i[i.length-1]++;for(e=Math.max(...i),t=0,s=0;s<i.length;s++)t-=2*Math.pow(Math.abs(n-i[s]),1.5),t-=Math.pow(e-i[s],1.5),-1!==".?!".indexOf(r[s])?t+=n/3:-1!==",;)]}".indexOf(r[s])&&(t+=n/4);return 1<i.length&&i[i.length-1]<=i[i.length-2]&&(t+=.5),t},Xi=function(e,t,n){let i,r=ji(e,t,n);for(let s=0;s<t.length-1;s++){if(t[s]===t[s+1])continue;const o=[].concat(t);o[s]=!o[s],o[s+1]=!o[s+1];const a=ji(e,o,n);a>r&&(r=a,i=o)}return i?Xi(e,i,n):t},Yi=function(e,t){const n=[];for(let i=0;i<e.length;i++)n.push(e[i]),void 0!==t[i]&&n.push(t[i]?"\n":" ");return n.join("")},Oo.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Ki=function(e){Ku=e},qi=function(){return Ku},Ji=function(){return qu},Zi=function(){return uh},Qi=function(e){if(e=er(e)){for(e=e.tooltip;"function"===typeof e;)e=e();if("string"!==typeof e)throw Error("Tooltip function must return a string.");return e}return""},er=function(e){for(;e&&e.tooltip;){if("string"===typeof e.tooltip||"function"===typeof e.tooltip)return e;e=e.tooltip}return null},tr=function(){document.querySelector(".blocklyTooltipDiv")||((uh=document.createElement("div")).className="blocklyTooltipDiv",(_()||document.body).appendChild(uh))},nr=function(e){e.mouseOverWrapper_=X(e,"pointerover",null,rr),e.mouseOutWrapper_=X(e,"pointerout",null,sr),e.addEventListener("pointermove",or,!1)},ir=function(e){e&&(Y(e.mouseOverWrapper_),Y(e.mouseOutWrapper_),e.removeEventListener("pointermove",or))},rr=function(e){Ju||(e=er(e.currentTarget),ih!==e&&(lr(),rh=null,ih=e),clearTimeout(Qu))},sr=function(e){Ju||(Qu=setTimeout((function(){rh=ih=null,lr()}),1),clearTimeout(eh),eh=0)},or=function(e){if(ih&&ih.tooltip&&!Ju)if(qu){const t=th-e.pageX;e=nh-e.pageY,Math.sqrt(t*t+e*e)>ah&&lr()}else rh!==ih&&(clearTimeout(eh),th=e.pageX,nh=e.pageY,eh=setTimeout(fr,lh))},ar=function(){rh=ih=null,lr()},lr=function(){qu&&(qu=!1,uh&&(uh.style.display="none")),eh&&(clearTimeout(eh),eh=0)},cr=function(){lr(),Ju=!0},ur=function(){Ju=!1},hr=function(){uh&&ih&&("function"===typeof Ku?Ku(uh,ih):dr())},dr=function(){var e=Qi(ih);e=(e=Oo.wrap$$module$build$src$core$utils$string(e,Zu)).split("\n");for(let t=0;t<e.length;t++){const n=document.createElement("div");n.appendChild(document.createTextNode(e[t])),uh.appendChild(n)}},pr=function(e){const t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;let i=th;i=e?i-(sh+uh.offsetWidth):i+sh;let r=nh+oh;return r+uh.offsetHeight>n+window.scrollY&&(r-=uh.offsetHeight+2*oh),e?i=Math.max(ch-window.scrollX,i):i+uh.offsetWidth>t+window.scrollX-2*ch&&(i=t-uh.offsetWidth-2*ch),{x:i,y:r}},fr=function(){if(!Ju&&(rh=ih,uh)){uh.textContent="",hr();var e=ih.RTL;uh.style.direction=e?"rtl":"ltr",uh.style.display="block",qu=!0;var{x:t,y:n}=pr(e);uh.style.left=t+"px",uh.style.top=n+"px"}},gr=function(e,t){for(const n in t)e[n]=null!==t[n]&&"object"===typeof t[n]?gr(e[n]||Object.create(null),t[n]):t[n];return e},mr=function(e){return void 0!==e.bubbleIsVisible&&void 0!==e.setBubbleVisible},vr=function(){return Sh},_r=function(e){Sh=e},br=function(){return wh},yr=function(e){wh=e},Tr=function(e){e="".concat(e).toLowerCase().trim();var t=xh[e];if(t)return t;if(t="#"===(t="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?t:"#"+t,/^#[0-9a-f]{6}$/.test(t))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var n=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return n&&(e=Number(n[1]),t=Number(n[2]),n=Number(n[3]),0<=e&&256>e&&0<=t&&256>t&&0<=n&&256>n)?Er(e,t,n):null},Er=function(e,t,n){return t=e<<16|t<<8|n,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Sr=function(e){return(e=Tr(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},wr=function(e,t,n){let i=0,r=0,s=0;if(0===t)s=r=i=n;else{const o=Math.floor(e/60),a=e/60-o;e=n*(1-t);const l=n*(1-t*a);switch(t=n*(1-t*(1-a)),o){case 1:i=l,r=n,s=e;break;case 2:i=e,r=n,s=t;break;case 3:i=e,r=l,s=n;break;case 4:i=t,r=e,s=n;break;case 5:i=n,r=e,s=l;break;case 6:case 0:i=n,r=t,s=e}}return Er(Math.floor(i),Math.floor(r),Math.floor(s))},xr=function(e,t,n){return(e=Tr(e))&&(t=Tr(t))?(e=Sr(e),t=Sr(t),Er(Math.round(t[0]+n*(e[0]-t[0])),Math.round(t[1]+n*(e[1]-t[1])),Math.round(t[2]+n*(e[2]-t[2])))):null},Mr=function(e){return wr(e,Sh,255*wh)},Ir=function(e,t,n){const i=[];var r=e.split("");r.push("");var s=0;e=[];let o=null;for(let c=0;c<r.length;c++){var a=r[c];if(0===s)if("%"===a)(s=e.join(""))&&i.push(s),e.length=0,s=1;else if(n&&"\n"===a){const t=e.join("");t&&i.push(t),e.length=0,i.push(a)}else e.push(a);else if(1===s)"%"===a?(e.push(a),s=0):t&&"0"<=a&&"9">=a?(s=2,o=a,(a=e.join(""))&&i.push(a),e.length=0):"{"===a?s=3:(e.push("%",a),s=0);else if(2===s)if("0"<=a&&"9">=a)o+=a;else{var l=void 0;i.push(parseInt(null!=(l=o)?l:"",10)),c--,s=0}else 3===s&&(""===a?(e.splice(0,0,"%{"),c--,s=0):"}"!==a?e.push(a):(s=e.join(""),/[A-Z]\w*/i.test(s)&&(a=(a=s.toUpperCase()).startsWith("BKY_")?a.substring(4):null)&&a in Oo.Msg$$module$build$src$core$msg?"string"===typeof(s=Oo.Msg$$module$build$src$core$msg[a])?Array.prototype.push.apply(i,Ir(s,t,n)):t?i.push("".concat(s)):i.push(s):i.push("%{"+s+"}"),s=e.length=0))}for((t=e.join(""))&&i.push(t),l=[],e.length=0,r=0;r<i.length;r++)"string"!==typeof i[r]||n&&"\n"===i[r]?((t=e.join(""))&&l.push(t),e.length=0,l.push(i[r])):e.push(i[r]);return(t=e.join(""))&&l.push(t),e.length=0,l},Cr=function(e){return Ir(e,!0,!0)},kr=function(e){return"string"!==typeof e?e:(e=Ir(e,!1,!1)).length?String(e[0]):""},Rr=function(e){let t=!0;const n=Oo.Msg$$module$build$src$core$msg,i=e.match(/%{BKY_[A-Z]\w*}/gi);if(i)for(let r=0;r<i.length;r++)void 0===n[i[r].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+i[r]+" in "+e),t=!1);return t},Ar=function(e){const t="string"===typeof e?kr(e):e;var n=Number(t);if(!isNaN(n)&&0<=n&&360>=n)return{hue:n,hex:wr(n,vr(),255*br())};if(n=Tr(t))return{hue:null,hex:n};throw n='Invalid colour: "'+t+'"',e!==t&&(n+=' (from "'+e+'")'),Error(n)},Lr=function(e){return void 0!==e.getProcedureModel&&void 0!==e.doProcedureUpdate&&void 0!==e.isProcedureDef},Or=function(e){return void 0!==e.startPublishing&&void 0!==e.stopPublishing},Nr=function(t,n){e(Bo.FIELD,t,n)},Dr=function(e){i(Bo.FIELD,e)},Oo.fromJson$$module$build$src$core$field_registry=function(e){return Oh.fromJsonInternal(e)},Pr=function(e){const t=a(Bo.FIELD,e.type);if(t){if("function"!==typeof t.fromJson)throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},$r=function(e){let t=!1;const n=e.map((e=>{let[n,i]=e;return"string"===typeof n?[kr(n),i]:(t=!0,[null!==n.alt?Object.assign({},n,{alt:kr(n.alt)}):Object.assign({},n),i])}));if(t||2>e.length)return{options:n};var i=n.map((e=>{let[t]=e;return t})),r=Hi(i);e=Gi(i,r);const s=Vi(i,r);return!e&&!s||r<=e+s?{options:n}:(r=e?i[0].substring(0,e-1):void 0,i=s?i[0].substr(1-s):void 0,{options:Br(n,e,s),prefix:r,suffix:i})},Br=function(e,t,n){return e.map((e=>{let[i,r]=e;return[i.substring(t,i.length-n),r]}))},Fr=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)?"string"!==typeof i[1]?(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+i[1]+" in: ",i)):i[0]&&"string"!==typeof i[0]&&"string"!==typeof i[0].src&&(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+i[0]+" in: ",i)):(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",i))}if(t)throw TypeError("Found invalid FieldDropdown options.")},Oo.register$$module$build$src$core$extensions=function(e,t){if("string"!==typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Hh[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!==typeof t)throw Error('Error: Extension "'+e+'" must be a function');Hh[e]=t},Oo.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!==typeof t)throw Error('Error: Mixin "'+e+'" must be a object');Oo.register$$module$build$src$core$extensions(e,(function(){this.mixin(t)}))},Oo.registerMutator$$module$build$src$core$extensions=function(e,t,n,i){const r='Error when registering mutator "'+e+'": ';Yr(r,t);const s=jr(t,r);if(n&&"function"!==typeof n)throw Error(r+'Extension "'+e+'" is not a function');Oo.register$$module$build$src$core$extensions(e,(function(){s&&this.setMutator(new Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon(i||[],this)),this.mixin(t),n&&n.apply(this)}))},Ur=function(e){zr(e)?delete Hh[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},zr=function(e){return!!Hh[e]},Hr=function(e,t,n){const i=Hh[e];if("function"!==typeof i)throw Error('Error: Extension "'+e+'" not found.');let r;if(n?Gr(e,t):r=Kr(t),i.apply(t),n)Yr('Error after applying mutator "'+e+'": ',t);else if(!qr(r,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},Gr=function(e,t){if(Kr(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},Vr=function(e,t){return Xr(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},Wr=function(e,t){return Xr(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},jr=function(e,t){return Xr(e.compose,e.decompose,t+" compose/decompose")},Xr=function(e,t,n){if(e&&t){if("function"!==typeof e||"function"!==typeof t)throw Error(n+" must be a function");return!0}if(!e&&!t)return!1;throw Error(n+"Must have both or neither functions")},Yr=function(e,t){const n=Vr(t,e),i=Wr(t,e);if(!n&&!i)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");jr(t,e)},Kr=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},qr=function(e,t){if((t=Kr(t)).length!==e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},Jr=function(e){if("object"!==typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval((function(){"complete"===document.readyState&&(clearInterval(t),e())}),10)}},Oo.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const n=[];return function(){-1===n.indexOf(this.type)&&(Zr(this,e,t),n.push(this.type)),this.setTooltip(function(){const n=String(this.getFieldValue(e));return kr(t[n])}.bind(this))}},Zr=function(e,t,n){var i=e.getField(t);if(i instanceof Dh&&!i.isOptionListDynamic()){i=i.getOptions();for(const[,r]of i)void 0===n[r]&&console.warn("No tooltip mapping for value ".concat(r," of field ")+"".concat(t," of block type ").concat(e.type,"."))}},Oo.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const n=this.getField(t);return kr(e).replace("%1",n?n.getText():"")}.bind(this))}},Qr=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},es=function(e,t){return" "+e+","+t+" "},ts=function(e,t){return" "+e+t.join("")},ns=function(e,t){return" M "+e+","+t+" "},is=function(e,t){return" m "+e+","+t+" "},rs=function(e,t){return" l "+e+","+t+" "},ss=function(e){return" l"+e.join("")},os=function(e,t){return" "+e+" "+t+" "},as=function(e,t,n,i){return e+" "+n+" "+n+" "+t+i},ls=function(t,n){e(Bo.ICON,t.toString(),n)},cs=function(e){i(Bo.ICON,e)},us=function(e){const t=e.getProcedureMap().getProcedures().filter((e=>!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!1]));e.getBlocksByType("procedures_defnoreturn",!1).forEach((e=>{!Lr(e)&&it(e)&&t.push(e.getProcedureDef())}));const n=e.getProcedureMap().getProcedures().filter((e=>!!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!0]));return e.getBlocksByType("procedures_defreturn",!1).forEach((e=>{!Lr(e)&&it(e)&&n.push(e.getProcedureDef())})),t.sort(hs),n.sort(hs),[t,n]},hs=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},Oo.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||Oo.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!ds(e,t.workspace,t);){const t=e.match(/^(.*?)(\d+)$/);e=t?t[1]+(parseInt(t[2])+1):e+"2"}return e},ds=function(e,t,n){return!ps(e,t,n)},ps=function(e,t,n){for(const i of t.getAllBlocks(!1))if(i!==n&&it(i)&&Oo.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return!0;n=n&&Lr(n)?null==n?void 0:n.getProcedureModel():void 0;for(const i of t.getProcedureMap().getProcedures())if(i!==n&&Oo.Names$$module$build$src$core$names.equals(i.getName(),e))return!0;return!1},Oo.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new kh;e=e.trim();const n=Oo.findLegalName$$module$build$src$core$procedures(e,t);Lr(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(n);const i=this.getValue();if(i!==e&&i!==n)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const r=e[t];r.renameProcedure&&r.renameProcedure(i,n)}return n},fs=function(e){function t(e,t){for(let r=0;r<e.length;r++){var i=e[r][0];const s=e[r][1],o=Oo.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type",t),o.setAttribute("gap","16");const a=Oo.createElement$$module$build$src$core$utils$xml("mutation");for(a.setAttribute("name",i),o.appendChild(a),i=0;i<s.length;i++){const e=Oo.createElement$$module$build$src$core$utils$xml("arg");e.setAttribute("name",s[i]),a.appendChild(e)}n.push(o)}}const n=[];if(Ho.procedures_defnoreturn){var i=Oo.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_defnoreturn"),i.setAttribute("gap","16");var r=Oo.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME"),r.appendChild(Oo.createTextNode$$module$build$src$core$utils$xml(Oo.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),i.appendChild(r),n.push(i)}return Ho.procedures_defreturn&&((i=Oo.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),i.setAttribute("gap","16"),(r=Oo.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),r.appendChild(Oo.createTextNode$$module$build$src$core$utils$xml(Oo.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),i.appendChild(r),n.push(i)),Ho.procedures_ifreturn&&((i=Oo.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),i.setAttribute("gap","16"),n.push(i)),n.length&&n[n.length-1].setAttribute("gap","24"),t((e=us(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),n},gs=function(e){var t=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let s,o=0;s=n[o];o++)t.push(s.getFieldValue("NAME"));n=Oo.createElement$$module$build$src$core$utils$xml("xml");const i=Oo.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorarg");const r=Oo.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME"),t=ct(Oo.DEFAULT_ARG$$module$build$src$core$procedures,t),t=Oo.createTextNode$$module$build$src$core$utils$xml(t),r.appendChild(t),i.appendChild(r),n.appendChild(i),e.updateToolbox(n)},ms=function(e){if(e.type===oa&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=u(e.workspaceId).getBlockById(e.blockId)).type;"procedures_defnoreturn"!==t&&"procedures_defreturn"!==t||(e=e.getIcon(Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),gs(e),e.addChangeListener(vs))}},vs=function(e){e.type!==Oo.CREATE$$module$build$src$core$events$utils&&e.type!==Oo.DELETE$$module$build$src$core$events$utils&&e.type!==Oo.CHANGE$$module$build$src$core$events$utils&&e.type!==Jo||(e=u(e.workspaceId),gs(e))},_s=function(e,t){return t.getAllBlocks(!1).filter((t=>bs(t,e)||rt(t)&&Oo.Names$$module$build$src$core$names.equals(t.getProcedureCall(),e)))},bs=function(e,t){return Lr(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&Oo.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},Oo.mutateCallers$$module$build$src$core$procedures=function(e){const t=C();var n=e.getProcedureDef()[0];const i=e.mutationToDom(!0);e=_s(n,e.workspace);for(let s,o=0;s=e[o];o++){n=(n=s.mutationToDom())&&Ne(n),s.domToMutation&&s.domToMutation(i);var r=s.mutationToDom();n!==(r=r&&Ne(r))&&(I(!1),k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(s,"mutation",null,n,r)),I(t))}},Oo.getDefinition$$module$build$src$core$procedures=function(e,t){for(const n of t.getAllBlocks(!1))if(Lr(n)&&n.isProcedureDef()&&Oo.Names$$module$build$src$core$names.equals(n.getProcedureModel().getName(),e)||it(n)&&Oo.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return n;return null},ys=function(e){return e.isDynamic},Ts=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},Es=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Ss=function(e,t){let n=null;const i=null==(t=t.outputConnection)?void 0:t.getConnectionChecker();for(let r,s=0;r=e.inputList[s];s++){const e=r.connection;let s;if(e&&null!=(s=i)&&s.canConnect(t,e,!1)){if(n)return null;n=e}}return n},ws=function(e,t){let n;for(;n=Ss(e,t);)if(!(e=n.targetBlock())||e.isShadow())return n;return null},xs=function(t,n){e(Bo.RENDERER,t,n)},Ms=function(e){i(Bo.RENDERER,e)},Is=function(e,t,n){return(e=new(o(Bo.RENDERER,e))(e)).init(t,n),e},Cs=function(e){ut(e.getTargetWorkspace(),void 0,"String")},ks=function(e){ut(e.getTargetWorkspace(),void 0,"Number")},Rs=function(e){ut(e.getTargetWorkspace(),void 0,"Colour")},As=function(e){let t=[],n=document.createElement("button");return n.setAttribute("text",Oo.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Oo.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Oo.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(n),e.registerButtonCallback("CREATE_VARIABLE_STRING",Cs),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",ks),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Rs),e=Ls(e),t.concat(e)},Ls=function(e){const t=[];if(0<(e=e.getAllVariables()).length){if(Ho.variables_set_dynamic){var n=e[e.length-1];const i=Oo.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","variables_set_dynamic"),i.setAttribute("gap","24"),i.appendChild(vt(n)),t.push(i)}if(Ho.variables_get_dynamic){e.sort(rc.compareByName);for(let i,r=0;i=e[r];r++)(n=Oo.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(vt(i)),t.push(n)}}return t},Os=function(e){e.resizeContents()},Ns=function(e){return void 0!==e.toCopyData},Ds=function(){jp.registry.register({name:Cp.ESCAPE,preconditionFn:e=>!e.options.readOnly,callback:e=>(e.hideChaff(),!0),keyCodes:[Vh.ESC]})},Ps=function(){jp.registry.register({name:Cp.DELETE,preconditionFn(e){const t=m();return!e.options.readOnly&&null!=t&&t.isDeletable()},callback:(e,t)=>(t.preventDefault(),!gh.inProgress()&&(m().checkAndDelete(),!0)),keyCodes:[Vh.DELETE,Vh.BACKSPACE]})},$s=function(){const e=jp.registry.createSerializedKey(Vh.C,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.C,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.C,[Vh.META]);jp.registry.register({name:Cp.COPY,preconditionFn(e){const t=m();return!e.options.readOnly&&!gh.inProgress()&&null!=t&&t.isDeletable()&&t.isMovable()&&Ns(t)},callback:(e,t)=>(t.preventDefault(),e.hideChaff(),!(!(t=m())||!Ns(t))&&(Xp=t.toCopyData(),Yp=e,!!Xp)),keyCodes:[e,t,n]})},Bs=function(){const e=jp.registry.createSerializedKey(Vh.X,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.X,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.X,[Vh.META]);jp.registry.register({name:Cp.CUT,preconditionFn(e){const t=m();return!e.options.readOnly&&!gh.inProgress()&&null!=t&&t instanceof Ip&&t.isDeletable()&&t.isMovable()&&!t.workspace.isFlyout},callback(e){const t=m();return!(!t||!Ns(t))&&(Xp=t.toCopyData(),Yp=e,t.checkAndDelete(),!0)},keyCodes:[e,t,n]})},Fs=function(){const e=jp.registry.createSerializedKey(Vh.V,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.V,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.V,[Vh.META]);jp.registry.register({name:Cp.PASTE,preconditionFn:e=>!e.options.readOnly&&!gh.inProgress(),callback:()=>!(!Xp||!Yp)&&!!On(Xp,Yp),keyCodes:[e,t,n]})},Us=function(){const e=jp.registry.createSerializedKey(Vh.Z,[Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.Z,[Vh.ALT]),n=jp.registry.createSerializedKey(Vh.Z,[Vh.META]);jp.registry.register({name:Cp.UNDO,preconditionFn:e=>!e.options.readOnly&&!gh.inProgress(),callback:e=>(e.hideChaff(),e.undo(!1),!0),keyCodes:[e,t,n]})},zs=function(){const e=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.CTRL]),t=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.ALT]),n=jp.registry.createSerializedKey(Vh.Z,[Vh.SHIFT,Vh.META]),i=jp.registry.createSerializedKey(Vh.Y,[Vh.CTRL]);jp.registry.register({name:Cp.REDO,preconditionFn:e=>!gh.inProgress()&&!e.options.readOnly,callback:e=>(e.hideChaff(),e.undo(!0),!0),keyCodes:[e,t,n,i]})},Hs=function(){Ds(),Ps(),$s(),Bs(),Fs(),Us(),zs()},Gs=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length?(t.parameters=e.getParameters().map((e=>Vs(e))),t):t},Vs=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length?(t.types=e.getTypes(),t):t},Ws=function(e,t,n,i){if(e=new e(i,n.name,n.id).setReturnTypes(n.returnTypes),!n.parameters)return e;for(const[r,s]of n.parameters.entries())e.insertParameter(js(t,s,i),r);return e},js=function(e,t,n){return e=new e(n,t.name,t.id),t.types&&e.setTypes(t.types),e},Xs=function(e){const t=Object.create(null),n=l(Bo.SERIALIZER,!0);for(const i in n){let r;const s=null==(r=n[i])?void 0:r.save(e);s&&(t[i]=s)}return t},Ys=function(e,t){let{recordUndo:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i=l(Bo.SERIALIZER,!0);if(i){i=Object.entries(i).sort(((e,t)=>t[1].priority-e[1].priority));var r=C();I(n),(n=Oo.getGroup$$module$build$src$core$events$utils())||Oo.setGroup$$module$build$src$core$events$utils(!0),de(),t instanceof fp&&t.setResizesEnabled(!1);for(const[,e]of i.reverse()){let n;null==(n=e)||n.clear(t)}for(let[n,r]of i.reverse())if(e[n]){let i;null==(i=r)||i.load(e[n],t)}t instanceof fp&&t.setResizesEnabled(!0),pe(),k(new(B(ga))(t)),Oo.setGroup$$module$build$src$core$events$utils(n),I(r)}},Ks=function(e,t,n){const i=n.getBoundingRectangle(),r=i.right-i.left,s=di(t.top,i.top,t.top+t.height-(i.bottom-i.top))-i.top;let o=t.left;return t=t.left+t.width-r,e.RTL?o=Math.min(t,o):t=Math.max(o,t),!(!(e=di(o,i.left,t)-i.left)&&!s)&&(n.moveBy(e,s,["inbounds"]),!0)},qs=function(e){return t=>{var n,i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging())if(-1!==ma.indexOf(null!=(n=t.type)?n:"")){n=i.getScrollMetrics(!0);const r=Js(e,t);r&&(i=Oo.getGroup$$module$build$src$core$events$utils()||!1,Oo.setGroup$$module$build$src$core$events$utils(t.group),Ks(e,n,r)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),Oo.setGroup$$module$build$src$core$events$utils(i))}else t.type===ua&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Zs(e)}},Js=function(e,t){let n=null;switch(t.type){case Oo.CREATE$$module$build$src$core$events$utils:case Oo.MOVE$$module$build$src$core$events$utils:(n=e.getBlockById(t.blockId))&&(n=n.getRootBlock());break;case ha:case fa:n=e.getCommentById(t.commentId)}return n},Zs=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var n=e.getTopBoundedElements();for(let i,r=0;i=n[r];r++)Ks(e,t,i)}},Qs=function(e,t){const n=[];for(const i of e.getIcons())mr(i)&&!i.bubbleIsVisible()||(n.push({location:t,icon:i}),i.onLocationChange(t));for(const i of e.getChildren(!1))n.push(...Qs(i,cl.sum(t,i.relativeCoords)));return n},eo=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>0<e.workspace.getUndoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:mu.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},to=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>0<e.workspace.getRedoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:mu.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},no=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:mu.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},io=function(e,t){function n(t){r--,t.setCollapsed(e),0===r&&Oo.setGroup$$module$build$src$core$events$utils(!1)}let i=0,r=0;Oo.setGroup$$module$build$src$core$events$utils(!0);for(let s=0;s<t.length;s++){let e=t[s];for(;e;)r++,setTimeout(n.bind(null,e),i),e=e.getNextBlock(),i+=10}},ro=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){io(!0,e.workspace.getTopBlocks(!0))},scopeType:mu.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},so=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){io(!1,e.workspace.getTopBlocks(!0))},scopeType:mu.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},oo=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let n=0;n<e.length;n++)oo(e[n],t)}},ao=function(e){const t=[];e=e.getTopBlocks(!0);for(let n=0;n<e.length;n++)oo(e[n],t);return t},lo=function(e,t){t?Oo.setGroup$$module$build$src$core$events$utils(t):(Oo.setGroup$$module$build$src$core$events$utils(!0),t=Oo.getGroup$$module$build$src$core$events$utils());const n=e.shift();n&&(n.isDeadOrDying()?lo(e,t):(n.dispose(!1,!0),setTimeout(lo,10,e,t))),Oo.setGroup$$module$build$src$core$events$utils(!1)},co=function(){mu.registry.register({displayText:e=>e.workspace?1===(e=ao(e.workspace).length)?Oo.Msg$$module$build$src$core$msg.DELETE_BLOCK:Oo.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1","".concat(e)):"",preconditionFn:e=>e.workspace&&0<ao(e.workspace).length?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=ao(e.workspace);2>t.length?lo(t):Je(Oo.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),(function(e){e&&lo(t)}))}},scopeType:mu.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},uo=function(){eo(),to(),no(),ro(),so(),co()},ho=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&On(t,e.block.workspace)}},scopeType:mu.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},po=function(){mu.registry.register({displayText:e=>e.block.hasIcon(ed.TYPE)?Oo.Msg$$module$build$src$core$msg.REMOVE_COMMENT:Oo.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(ed.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:mu.ScopeType.BLOCK,id:"blockComment",weight:2})},fo=function(){mu.registry.register({displayText:e=>e.block.getInputsInline()?Oo.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Oo.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof Cf||e.inputList[t]instanceof Cf))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:mu.ScopeType.BLOCK,id:"blockInline",weight:3})},go=function(){mu.registry.register({displayText:e=>e.block.isCollapsed()?Oo.Msg$$module$build$src$core$msg.EXPAND_BLOCK:Oo.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:mu.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},mo=function(){mu.registry.register({displayText:e=>e.block.isEnabled()?Oo.Msg$$module$build$src$core$msg.DISABLE_BLOCK:Oo.Msg$$module$build$src$core$msg.ENABLE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden",callback(e){e=e.block;const t=Oo.getGroup$$module$build$src$core$events$utils();t||Oo.setGroup$$module$build$src$core$events$utils(!0),e.setEnabled(!e.isEnabled()),Oo.setGroup$$module$build$src$core$events$utils(t)},scopeType:mu.ScopeType.BLOCK,id:"blockDisable",weight:5})},vo=function(){mu.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?Oo.Msg$$module$build$src$core$msg.DELETE_BLOCK:Oo.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1","".concat(e))},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:mu.ScopeType.BLOCK,id:"blockDelete",weight:6})},_o=function(){mu.registry.register({displayText:()=>Oo.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"===typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:mu.ScopeType.BLOCK,id:"blockHelp",weight:7})},bo=function(){ho(),po(),fo(),go(),mo(),vo(),_o()},yo=function(){uo(),bo()},To=function(e,t){var n=null;let i;if(n="string"===typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(n)&&document!==(null==(i=n)?void 0:i.ownerDocument))throw Error("Error: container is not in current document");e=new Th(t||{}),(t=document.createElement("div")).className="injectionDiv",t.tabIndex=0,Bn(t,Qc.LABEL,Oo.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),n.appendChild(t),n=Eo(t,e);const r=So(t,n,e);return wo(r),g(r),y(r),t.addEventListener("focusin",(function(){g(r)})),r},Eo=function(e,t){e.setAttribute("dir","LTR"),te(t.hasCss,t.pathToMedia),e=ie(bl.SVG,{xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const n=ie(bl.DEFS,{},e),i=String(Math.random()).substring(2);return t.gridPattern=mh.createDom(i,t.gridOptions,n),e},So=function(e,t,n){n.parentWorkspace=null;const i=(n=new fp(n)).options;n.scale=i.zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground",e));var r=n.getRenderer().getClassName();return r&&re(e,r),(r=n.getTheme().getClassName())&&re(e,r),!i.hasCategories&&i.languageTree&&(e=n.addFlyout(bl.SVG),ce(e,t)),i.hasTrashcan&&n.addTrashcan(),i.zoomOptions&&i.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(qs(n)),y(n),zn(),pi(),tr(),n},wo=function(e){const t=e.options;var n=e.getParentSvg();if(j(n.parentNode,"contextmenu",null,(function(e){K(e)||e.preventDefault()})),n=j(window,"resize",null,(function(){lr(),e.hideComponents(!0),Ni(),Jn(),y(e),Zs(e)})),e.setResizeHandlerWrapper(n),Mo(),t.languageTree){n=e.getToolbox();const i=e.getFlyout(!0);n?n.init():i&&(i.init(e),i.show(t.languageTree),"function"===typeof i.scrollToStart&&i.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new nf(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&Io(t.pathToMedia,e)},xo=function(e){const t=f();t&&!(K(e)||t.rendered&&!t.isVisible())&&jp.registry.onKeyDown(t,e)},Mo=function(){Zf||(j(document,"scroll",null,(function(){const e=h();for(let t,n=0;t=e[n];n++)t instanceof fp&&t.updateInverseScreenCTM()})),j(document,"keydown",null,xo),X(document,"touchend",null,z),X(document,"touchcancel",null,z),Ka&&j(window,"orientationchange",document,(function(){y(f())}))),Zf=!0},Io=function(e,t){function n(){for(;r.length;){const e=r.pop();e&&Y(e)}i.preload()}const i=t.getAudioManager();i.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),i.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),i.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const r=[];r.push(j(document,"pointermove",null,n,!0)),r.push(j(document,"touchstart",null,n,!0))},Co=function(e){return void 0!==e.getType&&void 0!==e.initView&&void 0!==e.dispose&&void 0!==e.getWeight&&void 0!==e.getSize&&void 0!==e.applyColour&&void 0!==e.hideForInsertionMarker&&void 0!==e.updateEditable&&void 0!==e.updateCollapsed&&void 0!==e.isShownWhenCollapsed&&void 0!==e.setOffsetInBlock&&void 0!==e.onLocationChange&&void 0!==e.onClick},ko=function(e){return void 0!==e.paste},Ro=function(e){return e.isSelectable()},Ao=function(e){f().hideChaff(e)},(Lo=Lo||{}).scope={},Lo.ASSUME_ES5=!1,Lo.ASSUME_NO_NATIVE_MAP=!1,Lo.ASSUME_NO_NATIVE_SET=!1,Lo.SIMPLE_FROUND_POLYFILL=!1,Lo.ISOLATE_POLYFILLS=!1,Lo.FORCE_POLYFILL_PROMISE=!1,Lo.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Lo.defineProperty=Lo.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},Lo.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},Lo.global=Lo.getGlobal(this),Lo.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x"),Lo.TRUST_ES6_POLYFILLS=!Lo.ISOLATE_POLYFILLS||Lo.IS_SYMBOL_NATIVE,Lo.polyfills={},Lo.propertyToPolyfillSymbol={},Lo.POLYFILL_PREFIX="$jscp$",Lo.polyfill=function(e,t,n,i){t&&(Lo.ISOLATE_POLYFILLS?Lo.polyfillIsolated(e,t,n,i):Lo.polyfillUnisolated(e,t,n,i))},Lo.polyfillUnisolated=function(e,t,n,i){for(n=Lo.global,e=e.split("."),i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))return;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&Lo.defineProperty(n,e,{configurable:!0,writable:!0,value:t})},Lo.polyfillIsolated=function(e,t,n,i){var r=e.split(".");e=1===r.length,i=r[0],i=!e&&i in Lo.polyfills?Lo.polyfills:Lo.global;for(var s=0;s<r.length-1;s++){var o=r[s];if(!(o in i))return;i=i[o]}r=r[r.length-1],null!=(t=t(n=Lo.IS_SYMBOL_NATIVE&&"es6"===n?i[r]:null))&&(e?Lo.defineProperty(Lo.polyfills,r,{configurable:!0,writable:!0,value:t}):t!==n&&(void 0===Lo.propertyToPolyfillSymbol[r]&&(n=1e9*Math.random()>>>0,Lo.propertyToPolyfillSymbol[r]=Lo.IS_SYMBOL_NATIVE?Lo.global.Symbol(r):Lo.POLYFILL_PREFIX+n+"$"+r),Lo.defineProperty(i,Lo.propertyToPolyfillSymbol[r],{configurable:!0,writable:!0,value:t})))},Lo.polyfill("globalThis",(function(e){return e||Lo.global}),"es_2020","es3"),Lo.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},Lo.arrayIterator=function(e){return{next:Lo.arrayIteratorImpl(e)}},Lo.initSymbol=function(){},Lo.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},Lo.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r},Lo.polyfill("Array.prototype.values",(function(e){return e||function(){return Lo.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),Lo.polyfill("Array.prototype.flat",(function(e){return e||function(e){e=void 0===e?1:e;var t=[];return Array.prototype.forEach.call(this,(function(n){Array.isArray(n)&&0<e?(n=Array.prototype.flat.call(n,e-1),t.push.apply(t,n)):t.push(n)})),t}}),"es9","es5"),Lo.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Lo.polyfill("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)Lo.owns(e,t)&&n.push([t,e[t]]);return n}}),"es8","es3"),Lo.polyfill("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)Lo.owns(e,t)&&n.push(e[t]);return n}}),"es8","es3");var No=Object.create(null),Do={typeMap:No},Po=Object.create(null),$o="default",Bo=class{constructor(e){this.name=e}toString(){return this.name}};Bo.CONNECTION_CHECKER=new Bo("connectionChecker"),Bo.CURSOR=new Bo("cursor"),Bo.EVENT=new Bo("event"),Bo.FIELD=new Bo("field"),Bo.INPUT=new Bo("input"),Bo.RENDERER=new Bo("renderer"),Bo.TOOLBOX=new Bo("toolbox"),Bo.THEME=new Bo("theme"),Bo.TOOLBOX_ITEM=new Bo("toolboxItem"),Bo.FLYOUTS_VERTICAL_TOOLBOX=new Bo("flyoutsVerticalToolbox"),Bo.FLYOUTS_HORIZONTAL_TOOLBOX=new Bo("flyoutsHorizontalToolbox"),Bo.METRICS_MANAGER=new Bo("metricsManager"),Bo.BLOCK_DRAGGER=new Bo("blockDragger"),Bo.SERIALIZER=new Bo("serializer"),Bo.ICON=new Bo("icon"),Bo.PASTER=new Bo("paster");var Fo={DEFAULT:$o,TEST_ONLY:Do};Fo.Type=Bo,Fo.getAllItems=l,Fo.getClass=o,Fo.getClassFromOptions=c,Fo.getObject=a,Fo.hasItem=s,Fo.register=e,Fo.unregister=i;var Uo,zo,Ho=Object.create(null),Go=Object.create(null),Vo=null,Wo=[],jo={defineBlocksWithJsonArrayInternal:w},Xo={TEST_ONLY:jo};Xo.createBlockDefinitionsFromJsonArray=Oo.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Xo.defineBlocks=Oo.defineBlocks$$module$build$src$core$common,Xo.defineBlocksWithJsonArray=S,Xo.draggingConnections=Wo,Xo.getAllWorkspaces=h,Xo.getBlockTypeCounts=T,Xo.getMainWorkspace=f,Xo.getParentContainer=_,Xo.getSelected=m,Xo.getWorkspaceById=u,Xo.registerWorkspace=d,Xo.setMainWorkspace=g,Xo.setParentContainer=b,Xo.setSelected=v,Xo.svgResize=y,Xo.unregisterWorkpace=p;var Yo,Ko,qo,Jo,Zo,Qo,ea,ta,na,ia,ra,sa,oa,aa,la,ca,ua,ha,da,pa,fa,ga,ma,va,_a,ba,ya="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Ta={genUid:()=>{const e=ya.length,t=[];for(let n=0;20>n;n++)t[n]=ya.charAt(Math.random()*e);return t.join("")}},Ea=0,Sa={TEST_ONLY:Ta};Sa.genUid=M,Sa.getNextUniqueId=x,Yo="",Ko=!0,qo=0,Oo.CREATE$$module$build$src$core$events$utils="create",Oo.CREATE$$module$build$src$core$events$utils,Oo.DELETE$$module$build$src$core$events$utils="delete",Oo.DELETE$$module$build$src$core$events$utils,Oo.CHANGE$$module$build$src$core$events$utils="change",Oo.CHANGE$$module$build$src$core$events$utils,Jo="block_field_intermediate_change",Oo.MOVE$$module$build$src$core$events$utils="move",Oo.MOVE$$module$build$src$core$events$utils,Zo="var_create",Qo="var_delete",ea="var_rename",ta="ui",na="drag",ia="selected",ra="click",sa="marker_move",oa="bubble_open",aa="trashcan_open",la="toolbox_item_select",ca="theme_change",ua="viewport_change",ha="comment_create",da="comment_delete",pa="comment_change",fa="comment_move",ga="finished_loading",ma=[Oo.CREATE$$module$build$src$core$events$utils,Oo.MOVE$$module$build$src$core$events$utils,ha,fa],_a={FIRE_QUEUE:va=[],fireNow:A,fireInternal:R,setGroupInternal:D},(ba={BLOCK_CHANGE:Oo.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:Oo.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:Oo.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:na,BLOCK_FIELD_INTERMEDIATE_CHANGE:Jo,BLOCK_MOVE:Oo.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:oa,BUMP_EVENTS:ma,CHANGE:Oo.CHANGE$$module$build$src$core$events$utils,CLICK:ra,COMMENT_CHANGE:pa,COMMENT_CREATE:ha,COMMENT_DELETE:da,COMMENT_MOVE:fa,CREATE:Oo.CREATE$$module$build$src$core$events$utils,DELETE:Oo.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:ga,MARKER_MOVE:sa,MOVE:Oo.MOVE$$module$build$src$core$events$utils,SELECTED:ia,TEST_ONLY:_a,THEME_CHANGE:ca,TOOLBOX_ITEM_SELECT:la,TRASHCAN_OPEN:aa,UI:ta,VAR_CREATE:Zo,VAR_DELETE:Qo,VAR_RENAME:ea,VIEWPORT_CHANGE:ua}).clearPendingUndo=O,ba.disable=Oo.disable$$module$build$src$core$events$utils,ba.disableOrphans=F,ba.enable=Oo.enable$$module$build$src$core$events$utils,ba.filter=L,ba.fire=k,ba.fromJson=$,ba.get=B,ba.getDescendantIds=P,ba.getGroup=Oo.getGroup$$module$build$src$core$events$utils,ba.getRecordUndo=C,ba.isEnabled=N,ba.setGroup=Oo.setGroup$$module$build$src$core$events$utils,ba.setRecordUndo=I;var wa,xa,Ma=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Oo.getGroup$$module$build$src$core$events$utils(),this.recordUndo=C()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,n){return n.isBlank=!1,n.group=e.group||"",n.workspaceId=t.id,n}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=u(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Ia=class extends Ma{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank="undefined"===typeof e,this.workspaceId=e||""}},Ca=class extends Ia{constructor(e,t,n){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=ra,this.blockId=e?e.id:void 0,this.targetType=n}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ca)).targetType=e.targetType,t.blockId=e.blockId,t}};(xa=wa||(wa={})).BLOCK="block",xa.WORKSPACE="workspace",xa.ZOOM_CONTROLS="zoom_controls",e(Bo.EVENT,ra,Ca);var ka={};ka.Click=Ca,ka.ClickTarget=wa;var Ra,Aa,La,Oa,Na,Da,Pa,$a,Ba,Fa,Ua=750,za="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Ha=null,Ga={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Va=0,Wa={TOUCH_ENABLED:za,TOUCH_MAP:Ga};Wa.checkTouchIdentifier=W,Wa.clearTouchIdentifier=H,Wa.getTouchIdentifierFromEvent=V,Wa.longStart=U,Wa.longStop=z,Wa.shouldHandleEvent=G,function(e){function t(e){return-1!==n.indexOf(e.toUpperCase())}const n=(Ra=e).toUpperCase();Aa=t("JavaFX"),La=t("WebKit"),Oa=t("Gecko")&&!La,Na=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Da=t("iPad")||t("Macintosh")&&0<e,Pa=t("iPhone")&&!Da,$a=t("Macintosh"),Ba=Da||Na&&!t("Mobile")||t("Silk"),Fa=!Ba&&(Pa||Na)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var ja=Aa,Xa=Oa,Ya=Na,Ka=Da,qa=Pa,Ja=$a,Za=Fa,Qa={ANDROID:Ya,GECKO:Xa,IPAD:Ka,IPHONE:qa,JavaFx:ja,MAC:Ja,MOBILE:Za,raw:Ra},el=40,tl=125,nl={};nl.bind=X,nl.conditionalBind=j,nl.getScrollDeltaPixels=Z,nl.isRightButton=q,nl.isTargetInput=K,nl.mouseToSvg=J,nl.unbind=Y;var il={};il.removeElem=Q;var rl=class{constructor(e){this.name_=e}toString(){return this.name_}};rl.POSITIONABLE=new rl("positionable"),rl.DRAG_TARGET=new rl("drag_target"),rl.DELETE_AREA=new rl("delete_area"),rl.AUTOHIDEABLE=new rl("autohideable");var sl=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const n=e.component.id;var i;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(i=this.componentData.get(n))?void 0:i.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],i=0;i<e.capabilities.length;i++){const r=String(e.capabilities[i]).toLowerCase();if(t.push(r),this.capabilityToComponentIds.has(r)){let e;null==(e=this.capabilityToComponentIds.get(r))||e.push(n)}else this.capabilityToComponentIds.set(r,[n])}this.componentData.get(n).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let n=0;n<t.capabilities.length;n++){const i=String(t.capabilities[n]).toLowerCase();Q(this.capabilityToComponentIds.get(i),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var n,i;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t="".concat(t).toLowerCase(),null==(n=this.componentData.get(e))||n.capabilities.push(t),null==(i=this.capabilityToComponentIds.get(t))||i.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t="".concat(t).toLowerCase(),Q(this.componentData.get(e).capabilities,t),Q(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t="".concat(t).toLowerCase(),this.componentData.has(e)&&-1!==this.componentData.get(e).capabilities.indexOf(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e="".concat(e).toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const n=[];if(t){const t=[];e.forEach((e=>{t.push(this.componentData.get(e))})),t.sort((function(e,t){return e.weight-t.weight})),t.forEach((function(e){n.push(e.component)}))}else e.forEach((e=>{n.push(this.componentData.get(e).component)}));return n}};sl.Capability=rl;var ol=!1,al='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n',ll={};ll.inject=te,ll.register=ee;var cl=class{constructor(e,t){this.x=e,this.y=t}clone(){return new cl(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const n=e.x-t.x;return e=e.y-t.y,Math.sqrt(n*n+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new cl(e.x-t.x,e.y-t.y)}static sum(e,t){return new cl(e.x+t.x,e.y+t.y)}},ul={};ul.warn=ne;var hl,dl="http://www.w3.org/2000/svg",pl="http://www.w3.org/1999/xhtml",fl="http://www.w3.org/1999/xlink";!function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"}(hl||(hl={}));var gl=null,ml=0,vl=null,_l={HTML_NS:pl};_l.NodeType=hl,_l.SVG_NS=dl,_l.XLINK_NS=fl,_l.addClass=re,_l.containsNode=ue,_l.createSvgElement=ie,_l.getFastTextWidth=ge,_l.getFastTextWidthWithSizeString=me,_l.getTextWidth=fe,_l.hasClass=ae,_l.insertAfter=ce,_l.measureFontMetrics=ve,_l.removeClass=oe,_l.removeClasses=se,_l.removeNode=le,_l.setCssTransform=he,_l.startTextWidthCache=de,_l.stopTextWidthCache=pe;var bl=class{constructor(e){this.tagName=e}toString(){return this.tagName}};bl.ANIMATE=new bl("animate"),bl.CIRCLE=new bl("circle"),bl.CLIPPATH=new bl("clipPath"),bl.DEFS=new bl("defs"),bl.FECOMPOSITE=new bl("feComposite"),bl.FECOMPONENTTRANSFER=new bl("feComponentTransfer"),bl.FEFLOOD=new bl("feFlood"),bl.FEFUNCA=new bl("feFuncA"),bl.FEGAUSSIANBLUR=new bl("feGaussianBlur"),bl.FEPOINTLIGHT=new bl("fePointLight"),bl.FESPECULARLIGHTING=new bl("feSpecularLighting"),bl.FILTER=new bl("filter"),bl.FOREIGNOBJECT=new bl("foreignObject"),bl.G=new bl("g"),bl.IMAGE=new bl("image"),bl.LINE=new bl("line"),bl.PATH=new bl("path"),bl.PATTERN=new bl("pattern"),bl.POLYGON=new bl("polygon"),bl.RECT=new bl("rect"),bl.SVG=new bl("svg"),bl.TEXT=new bl("text"),bl.TSPAN=new bl("tspan");var yl=class{constructor(e,t,n,i){this.top=e,this.bottom=t,this.left=n,this.right=i}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},Tl=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}},El={getSizeInternal:be},Sl={TEST_ONLY:El};Sl.getBorderBox=we,Sl.getComputedStyle=Te,Sl.getContainerOffsetToScrollInto=Me,Sl.getPageOffset=Ee,Sl.getSize=_e,Sl.getViewportPageOffset=Se,Sl.scrollIntoContainerView=xe;var wl=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,xl=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Ml={TEST_ONLY:{XY_REGEX:wl,XY_STYLE_REGEX:xl}};Ml.getDocumentScroll=Re,Ml.getInjectionDivXY=Ce,Ml.getRelativeXY=Ie,Ml.getViewportBBox=ke,Ml.screenToWsCoordinates=Ae,Ml.wsToScreenCoordinates=Le;var Il=class{constructor(e,t,n,i,r){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new cl(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new cl(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=n||!1,this.margin=void 0!==r?r:Il.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),i&&(e+=" "+i),this.outerSvg=ie(bl.SVG,{class:e}),i=ie(bl.G,{},this.outerSvg),this.svgBackground=ie(bl.RECT,{class:"blocklyScrollbarBackground"},i),e=Math.floor((Il.scrollbarThickness-5)/2),this.svgHandle=ie(bl.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},i),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),ce(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=j(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=j(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Il.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),Y(this.onMouseDownBarWrapper_),Y(this.onMouseDownHandleWrapper_),le(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,he(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){(e||(e=this.workspace.getMetrics()))&&(this.oldHostMetrics&&Il.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics()))}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Il.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Il.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Il.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var n=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Il.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Il.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var n=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),H(),this.cleanUp(),q(e))e.stopPropagation();else{var t=J(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var n=Ce(this.svgHandle);n=this.horizontal?n.x:n.y;var i=this.handlePosition,r=.95*this.handleLength;t<=n?i-=r:t>=n+this.handleLength&&(i+=r),this.setHandlePosition(this.constrainHandlePosition(i)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),q(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=j(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=j(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){H(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(Y(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(Y(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new cl(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Il.scrollbarThickness=za?25:15,Il.DEFAULT_SCROLLBAR_MARGIN=.5;var Cl={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},kl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Rl,DOMParser:Al,XMLSerializer:Ll}=globalThis;Al&&(Cl=new Al),Ll&&(kl=new Ll);var Ol="https://developers.google.com/blockly/xml",Nl=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Dl={NAME_SPACE:Ol};Dl.createElement=Oo.createElement$$module$build$src$core$utils$xml,Dl.createTextNode=Oo.createTextNode$$module$build$src$core$utils$xml,Dl.domToText=Ne,Dl.injectDependencies=Oe,Dl.textToDom=Oo.textToDom$$module$build$src$core$utils$xml;var Pl,$l="categoryToolbox",Bl="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Pl||(Pl={}));var Fl,Ul,zl,Hl={hasCategoriesInternal:Ue},Gl={};Gl.Position=Pl,Gl.TEST_ONLY=Hl,Gl.convertFlyoutDefToJsonArray=Be,Gl.convertToolboxDefToJson=Pe,Gl.hasCategories=Fe,Gl.isCategoryCollapsible=ze,Gl.parseToolboxTree=We,function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(Fl||(Fl={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(Ul||(Ul={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(zl||(zl={}));var Vl={};Vl.bumpDirection=zl,Vl.bumpPositionRect=Ye,Vl.getCornerOppositeToolbox=Xe,Vl.getStartPositionRect=je,Vl.horizontalPosition=Ul,Vl.verticalPosition=Fl;var Wl={width:96,height:124,url:"sprites.png"},jl=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=ie(bl.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[sl.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&le(this.svgGroup);for(const e of this.boundEvents)Y(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new yl(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var n,i=Xe(this.workspace,e),r=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(r+=this.LARGE_SPACING+this.HEIGHT),e=je(i,new Tl(this.WIDTH,r),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),i=i.vertical,t=Ye(e,this.MARGIN_VERTICAL,i===Fl.TOP?zl.DOWN:zl.UP,t),i===Fl.TOP){var s,o=this.SMALL_SPACING+this.HEIGHT;null==(s=this.zoomInGroup)||s.setAttribute("transform","translate(0, "+o+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING+this.HEIGHT)+")")}else{let e;s=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(e=this.zoomInGroup)||e.setAttribute("transform","translate(0, "+s+")"),s=s+this.SMALL_SPACING+this.HEIGHT,null==(o=this.zoomOutGroup)||o.setAttribute("transform","translate(0, "+s+")")}this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=ie(bl.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=ie(bl.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);ie(bl.RECT,{width:32,height:32},t),ie(bl.IMAGE,{width:Wl.width,height:Wl.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=ie(bl.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=ie(bl.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);ie(bl.RECT,{width:32,height:32},t),ie(bl.IMAGE,{width:Wl.width,height:Wl.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),H(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=ie(bl.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=ie(bl.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);ie(bl.RECT,{width:32,height:32},t),ie(bl.IMAGE,{width:Wl.width,height:Wl.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),this.boundEvents.push(j(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),H(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(B(ra))(null,this.workspace.id,"zoom_controls");k(e)}};ee("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var Xl=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Xl.MUTATOR=new Xl("mutator"),Xl.WARNING=new Xl("warning"),Xl.COMMENT=new Xl("comment"),function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(Oo.inputTypes$$module$build$src$core$inputs$input_types||(Oo.inputTypes$$module$build$src$core$inputs$input_types={})),Oo.inputTypes$$module$build$src$core$inputs$input_types;var Yl,Kl,ql=function(e,t){window.alert(e),t&&t()},Jl=function(e,t){t(window.confirm(e))},Zl=function(e,t,n){n(window.prompt(e,t))},Ql={confirmInternal:Ze},ec={TEST_ONLY:Ql};ec.alert=Ke,ec.confirm=Je,ec.prompt=et,ec.setAlert=qe,ec.setConfirm=Qe,ec.setPrompt=tt,Oo.Msg$$module$build$src$core$msg=Object.create(null),Yl=function(e){Object.keys(e).forEach((function(t){Oo.Msg$$module$build$src$core$msg[t]=e[t]}))},Kl={Msg:Oo.Msg$$module$build$src$core$msg,setLocale:Yl};var tc={};tc.isLegacyProcedureCallBlock=rt,tc.isLegacyProcedureDefBlock=it;var nc=class extends Ma{constructor(e){super(),this.isBlank="undefined"===typeof e,e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new nc)).varId=e.varId,t}},ic=class extends nc{constructor(e){super(e),this.type=Zo,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ic)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};e(Bo.EVENT,Zo,ic);var rc=class{constructor(e,t,n,i){this.workspace=e,this.name=t,this.type=n||"",this.id_=i||M()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},sc="VARIABLE",oc="ijkmnopqrstuvwxyzabcdefgh",ac={generateUniqueNameInternal:lt},lc={CATEGORY_NAME:sc,TEST_ONLY:ac,VAR_LETTER_OPTIONS:oc};lc.allDeveloperVariables=Oo.allDeveloperVariables$$module$build$src$core$variables,lc.allUsedVarModels=Oo.allUsedVarModels$$module$build$src$core$variables,lc.createVariableButtonHandler=ut,lc.flyoutCategory=st,lc.flyoutCategoryBlocks=ot,lc.generateUniqueName=at,lc.generateUniqueNameFromOptions=ct,lc.generateVariableFieldDom=vt,lc.getAddedVariables=bt,lc.getOrCreateVariablePackage=Oo.getOrCreateVariablePackage$$module$build$src$core$variables,lc.getVariable=Oo.getVariable$$module$build$src$core$variables,lc.nameUsedWithAnyType=pt,lc.nameUsedWithConflictingParam=ft,lc.promptName=ht,lc.renameVariable=Oo.renameVariable$$module$build$src$core$variables;var cc=class{constructor(e,t,n,i,r){this.workspace=e,this.editable=this.movable=this.deletable=!0,this.disposed_=!1,this.isComment=!0,this.id=r&&!e.getCommentById(r)?r:M(),e.addTopComment(this),this.xy_=new cl(0,0),this.height_=n,this.width_=i,this.RTL=e.RTL,this.content_=t,cc.fireCreateEvent(this)}dispose(){this.disposed_||(N()&&k(new(B(da))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getRelativeToSurfaceXY(){return new cl(this.xy_.x,this.xy_.y)}moveBy(e,t){const n=new(B(fa))(this);this.xy_.translate(e,t),n.recordNew(),k(n)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable=e}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(k(new(B(pa))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return(e=this.toXml(e)).setAttribute("x",String(Math.round(this.xy_.x))),e.setAttribute("y",String(Math.round(this.xy_.y))),e.setAttribute("h",String(this.height_)),e.setAttribute("w",String(this.width_)),e}toXml(e){const t=Oo.createElement$$module$build$src$core$utils$xml("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(N()){const t=Oo.getGroup$$module$build$src$core$events$utils();t||Oo.setGroup$$module$build$src$core$events$utils(!0);try{k(new(B(ha))(e))}finally{Oo.setGroup$$module$build$src$core$events$utils(t)}}}static fromXml(e,t){var n=cc.parseAttributes(e);return t=new cc(t,n.content,n.h,n.w,n.id),n=e.getAttribute("x"),e=e.getAttribute("y"),n=n?parseInt(n,10):NaN,e=e?parseInt(e,10):NaN,isNaN(n)||isNaN(e)||t.moveBy(n,e),cc.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),n=e.getAttribute("w"),i=e.getAttribute("x"),r=e.getAttribute("y"),s=e.getAttribute("id");if(!s)throw Error("No ID present in XML comment definition.");let o;return{id:s,h:t?parseInt(t):100,w:n?parseInt(n):100,x:i?parseInt(i):NaN,y:r?parseInt(r):NaN,content:null!=(o=e.textContent)?o:""}}},uc=class extends Ia{constructor(e,t,n){super(n),this.type=ia,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new uc)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};e(Bo.EVENT,ia,uc);var hc={};hc.register=yt,hc.unregister=Tt;var dc=class{paste(e,t,n){const i=e.commentState;if(n)i.setAttribute("x","".concat(n.x)),i.setAttribute("y","".concat(n.y));else{var r;let e;n=parseInt(null!=(r=i.getAttribute("x"))?r:"0")+50,r=parseInt(null!=(e=i.getAttribute("y"))?e:"0")+50,i.setAttribute("x","".concat(n)),i.setAttribute("y","".concat(r))}return mc.fromXmlRendered(e.commentState,t)}};dc.TYPE="workspace-comment",yt(dc.TYPE,new dc);var pc=8,fc=3,gc=2,mc=class extends cc{constructor(e,t,n,i,r){super(e,t,n,i,r),this.onMouseMoveWrapper=this.onMouseUpWrapper=null,this.eventsInit=!1,this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=this.svgHandleTarget=this.svgRectTarget=this.textarea=null,this.rendered=this.autoLayout=this.focused=!1,this.svgGroup=ie(bl.G,{class:"blocklyComment"}),this.workspace=e,this.svgRect_=ie(bl.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:fc,ry:fc}),this.svgGroup.appendChild(this.svgRect_),this.render()}dispose(){this.disposed_||(m()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),N()&&k(new(B(da))(this)),le(this.svgGroup),Oo.disable$$module$build$src$core$events$utils(),super.dispose(),Oo.enable$$module$build$src$core$events$utils())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit||(j(this.svgRectTarget,"pointerdown",this,this.pathMouseDown),j(this.svgHandleTarget,"pointerdown",this,this.pathMouseDown)),this.eventsInit=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea&&this.textarea.select()}pathMouseDown(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(m()!==this){var e=null;if(m()){e=m().id,Oo.disable$$module$build$src$core$events$utils();try{m().unselect()}finally{Oo.enable$$module$build$src$core$events$utils()}}e=new(B(ia))(e,this.id,this.workspace.id),k(e),v(this),this.addSelect()}}unselect(){if(m()===this){var e=new(B(ia))(this.id,null,this.workspace.id);k(e),v(null),this.removeSelect(),this.blurFocus()}}addSelect(){re(this.svgGroup,"blocklySelected"),this.setFocus()}removeSelect(){re(this.svgGroup,"blocklySelected"),this.blurFocus()}addFocus(){re(this.svgGroup,"blocklyFocused")}removeFocus(){oe(this.svgGroup,"blocklyFocused")}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,i=this.getSvgRoot();if(i)do{const e=Ie(i);t+=e.x,n+=e.y,i=i.parentNode}while(i&&!e.hasLayer(i)&&null!==i);return this.xy_=new cl(t,n)}moveBy(e,t){const n=new(B(fa))(this),i=this.getRelativeToSurfaceXY();this.translate(i.x+e,i.y+t),this.xy_=new cl(i.x+e,i.y+t),n.recordNew(),k(n),this.workspace.resizeContents()}translate(e,t){this.xy_=new cl(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveDuringDrag(e){e="translate(".concat(e.x,", ").concat(e.y,")"),this.getSvgRoot().setAttribute("transform",e)}moveTo(e,t){this.translate(e,t)}clearTransformAttributes(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),n=e.y,i=e.y+t.height;let r;return this.RTL?(r=e.x-t.width,e=e.x):(r=e.x,e=e.x+t.width),new yl(n,i,r,e)}updateMovable(){this.isMovable()?re(this.svgGroup,"blocklyDraggable"):oe(this.svgGroup,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea&&(this.textarea.readOnly=!e)}setDragging(e){e?re(this.getSvgRoot(),"blocklyDragging"):oe(this.getSvgRoot(),"blocklyDragging")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(e){super.setContent(e),this.textarea&&(this.textarea.value=e)}setDeleteStyle(e){e?re(this.svgGroup,"blocklyDraggingDelete"):oe(this.svgGroup,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const n=this.getRelativeToSurfaceXY();return e.setAttribute("x",String(Math.round(this.workspace.RTL?t-n.x:n.x))),e.setAttribute("y",String(Math.round(n.y))),e.setAttribute("h",String(this.getHeight())),e.setAttribute("w",String(this.getWidth())),e}toCopyData(){return{paster:dc.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered){var e=this.getHeightWidth(),t=this.createEditor();this.svgGroup.appendChild(t),this.svgHandleTarget=ie(bl.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup.appendChild(this.svgHandleTarget),this.svgRectTarget=ie(bl.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:fc,ry:fc}),this.svgGroup.appendChild(this.svgRectTarget),this.addResizeDom(),this.isDeletable()&&this.addDeleteDom(),this.setSize(e.width,e.height),this.textarea.value=this.content_,this.rendered=!0,this.resizeGroup&&j(this.resizeGroup,"pointerdown",this,this.resizeMouseDown),this.isDeletable()&&(j(this.deleteGroup,"pointerdown",this,this.deleteMouseDown),j(this.deleteGroup,"pointerout",this,this.deleteMouseOut),j(this.deleteGroup,"pointerup",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=ie(bl.FOREIGNOBJECT,{x:0,y:mc.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(pl,"body");e.setAttribute("xmlns",pl),e.className="blocklyMinimalBody";const t=document.createElementNS(pl,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea=t,this.foreignObject.appendChild(e),j(t,"wheel",this,(function(e){e.stopPropagation()})),j(t,"change",this,(function(e){this.setContent(t.value)})),this.foreignObject}addResizeDom(){this.resizeGroup=ie(bl.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup),ie(bl.POLYGON,{points:"0,".concat(pc," ").concat(pc,",").concat(pc," ").concat(pc,",0")},this.resizeGroup),ie(bl.LINE,{class:"blocklyResizeLine",x1:pc/3,y1:pc-1,x2:pc-1,y2:pc/3},this.resizeGroup),ie(bl.LINE,{class:"blocklyResizeLine",x1:2*pc/3,y1:pc-1,x2:pc-1,y2:2*pc/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=ie(bl.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup),this.deleteIconBorder=ie(bl.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup),ie(bl.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup),ie(bl.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup)}resizeMouseDown(e){this.unbindDragEvents(),q(e)||(this.workspace.startDrag(e,new cl(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=j(document,"pointerup",this,this.resizeMouseUp),this.onMouseMoveWrapper=j(document,"pointermove",this,this.resizeMouseMove),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown(e){this.deleteIconBorder&&re(this.deleteIconBorder,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut(e){this.deleteIconBorder&&oe(this.deleteIconBorder,"blocklyDeleteIconHighlighted")}deleteMouseUp(e){this.dispose(),e.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(Y(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onMouseMoveWrapper&&(Y(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)}resizeMouseUp(e){H(),this.unbindDragEvents()}resizeMouseMove(e){this.autoLayout=!1,e=this.workspace.moveDrag(e),this.setSize(this.RTL?-e.x:e.x,e.y)}resizeComment(){const e=this.getHeightWidth(),t=mc.TOP_OFFSET,n=2*gc;let i,r;if(null==(i=this.foreignObject)||i.setAttribute("width",String(e.width)),null==(r=this.foreignObject)||r.setAttribute("height",String(e.height-t)),this.RTL){let t;null==(t=this.foreignObject)||t.setAttribute("x",String(-e.width))}this.textarea&&(this.textarea.style.width=e.width-n+"px",this.textarea.style.height=e.height-n-t+"px")}setSize(e,t){let n,i,r,s;if(e=Math.max(e,45),t=Math.max(t,20+mc.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width","".concat(e)),this.svgRect_.setAttribute("height","".concat(t)),null==(n=this.svgRectTarget)||n.setAttribute("width","".concat(e)),null==(i=this.svgRectTarget)||i.setAttribute("height","".concat(t)),null==(r=this.svgHandleTarget)||r.setAttribute("width","".concat(e)),null==(s=this.svgHandleTarget)||s.setAttribute("height",String(mc.TOP_OFFSET)),this.RTL){let e;this.svgRect_.setAttribute("transform","scale(-1 1)"),null==(e=this.svgRectTarget)||e.setAttribute("transform","scale(-1 1)")}if(this.resizeGroup)if(this.RTL){let n;this.resizeGroup.setAttribute("transform","translate("+(-e+pc)+","+(t-pc)+") scale(-1 1)"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(-e+pc)+","+-pc+") scale(-1 1)")}else{let n;this.resizeGroup.setAttribute("transform","translate("+(e-pc)+","+(t-pc)+")"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(e-pc)+","+-pc+")")}this.resizeComment()}setFocus(){this.focused=!0,setTimeout((()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&re(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&re(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}blurFocus(){this.focused=!1,setTimeout((()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&oe(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&oe(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}static fromXmlRendered(e,t,n){let i;Oo.disable$$module$build$src$core$events$utils();try{const r=cc.parseAttributes(e);if(i=new mc(t,r.content,r.h,r.w,r.id),t.rendered&&(i.initSvg(!0),i.render()),!isNaN(r.x)&&!isNaN(r.y))if(t.RTL){const e=n||t.getWidth();i.moveBy(e-r.x,r.y)}else i.moveBy(r.x,r.y)}finally{Oo.enable$$module$build$src$core$events$utils()}return cc.fireCreateEvent(i),i}};mc.DEFAULT_SIZE=100,mc.TOP_OFFSET=10,ee("\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n");var vc=new Set,_c=new WeakSet,bc=null,yc=null,Tc=0,Ec={};Ec.finishQueuedRenders=St,Ec.queueRender=Et,Ec.triggerQueuedRenders=wt;var Sc={};Sc.appendDomToWorkspace=zt,Sc.blockToDom=Pt,Sc.blockToDomWithXY=Ot,Sc.clearWorkspaceAndLoadFromXml=Ut,Sc.deleteNext=en,Sc.domToBlock=Oo.domToBlock$$module$build$src$core$xml,Sc.domToBlockInternal=Ht,Sc.domToPrettyText=Ft,Sc.domToText=Bt,Sc.domToVariables=Gt,Sc.domToWorkspace=Oo.domToWorkspace$$module$build$src$core$xml,Sc.variablesToDom=Lt,Sc.workspaceToDom=At;var wc=class extends Error{},xc=class extends wc{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Mc=class extends wc{constructor(e,t,n){super("The block ".concat(t.toDevString()," is missing a(n) ").concat(e,"\nconnection")),this.block=t,this.state=n}},Ic=class extends wc{constructor(e,t,n,i){super("The block ".concat(n.toDevString()," could not connect its\n").concat(t," to its parent, because: ").concat(e)),this.childBlock=n,this.childState=i}},Cc=class extends wc{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},kc=class extends wc{constructor(e,t,n){super("Cannot add an icon of type '".concat(e,"' to the block ")+"".concat(t.toDevString(),", because there is no icon registered with ")+"type '".concat(e,"'. Make sure that all of your icons have been ")+"registered."),this.block=t,this.state=n}},Rc={};Rc.BadConnectionCheck=Ic,Rc.DeserializationError=wc,Rc.MissingBlockType=xc,Rc.MissingConnection=Mc,Rc.RealChildOfShadow=Cc,Rc.UnregisteredIcon=kc;var Ac=100,Lc=75,Oc=50,Nc={BLOCKS:Oc,PROCEDURES:Lc,VARIABLES:Ac},Dc={};Dc.register=rn,Dc.unregister=sn;var Pc=class{constructor(){this.priority=Oc}save(e){const t=[];for(const n of e.getTopBlocks(!1))(e=on(n,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const n of e)gn(n,t,{recordUndo:C()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};rn("blocks",new Pc);var $c={};$c.BlockSerializer=Pc,$c.append=gn,$c.appendInternal=mn,$c.save=on;var Bc=class extends Ma{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Bc)).blockId=e.blockId,t}},Fc=class extends Bc{constructor(e){super(e),this.type=Oo.CREATE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Ot(e),this.ids=P(e),this.json=on(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bt(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Fc)).xml=Oo.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!Uc(t,this.ids))if(e)gn(this.json,t);else for(e=0;e<this.ids.length;e++){const n=this.ids[e],i=t.getBlockById(n);i?i.dispose(!1):n===this.blockId&&console.warn("Can't uncreate non-existent block: "+n)}}},Uc=function(e,t){return t.map((t=>e.getBlockById(t))).filter((e=>e&&e.isShadow())).length===t.length};e(Bo.EVENT,Oo.CREATE$$module$build$src$core$events$utils,Fc);var zc=class extends Ia{constructor(e,t){super(t),this.type=ca,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new zc)).themeName=e.themeName,t}};e(Bo.EVENT,ca,zc);var Hc,Gc,Vc=class extends Ia{constructor(e,t,n,i,r){super(i),this.type=ua,this.viewTop=e,this.viewLeft=t,this.scale=n,this.oldScale=r}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Vc)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};e(Bo.EVENT,ua,Vc),Hc=28,Oo.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Hc,connectingSnapRadius:Hc,currentConnectionPreference:8,bumpDelay:250},Oo.config$$module$build$src$core$config,function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"}(Gc||(Gc={}));var Wc=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const n=this.calculateIndexForYPos(t);if(n>=this.connections.length)return-1;t=e.y;let i=n;for(;0<=i&&this.connections[i].y===t;){if(this.connections[i]===e)return i;i--}for(i=n;i<this.connections.length&&this.connections[i].y===t;){if(this.connections[i]===e)return i;i++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,n=this.connections.length;for(;t<n;){const i=Math.floor((t+n)/2);if(this.connections[i].y<e)t=i+1;else{if(!(this.connections[i].y>e)){t=i;break}n=i}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function n(e){const n=r-i[e].x,o=s-i[e].y;return Math.sqrt(n*n+o*o)<=t&&l.push(i[e]),o<t}const i=this.connections,r=e.x,s=e.y;e=0;let o=i.length-2,a=o;for(;e<a;)i[a].y<s?e=a:o=a,a=Math.floor((e+o)/2);const l=[];if(o=e=a,i.length){for(;0<=e&&n(e);)e--;do{o++}while(o<i.length&&n(o))}return l}isInYRange(e,t,n){return Math.abs(this.connections[e].y-t)<=n}searchForClosest(e,t,n){if(!this.connections.length)return{connection:null,radius:t};const i=e.y,r=e.x;e.x=r+n.x,e.y=i+n.y;var s=this.calculateIndexForYPos(e.y);n=null;let o,a=t,l=s-1;for(;0<=l&&this.isInYRange(l,e.y,t);)o=this.connections[l],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),l--;for(;s<this.connections.length&&this.isInYRange(s,e.y,t);)o=this.connections[s],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),s++;return e.x=r,e.y=i,{connection:n,radius:a}}static init(e){const t=[];return t[Gc.INPUT_VALUE]=new Wc(e),t[Gc.OUTPUT_VALUE]=new Wc(e),t[Gc.NEXT_STATEMENT]=new Wc(e),t[Gc.PREVIOUS_STATEMENT]=new Wc(e),t}},jc=class{paste(e,t,n){if(!t.isCapacityAvailable(e.typeCounts))return null;let i;n&&(e.blockState.x=n.x,e.blockState.y=n.y),Oo.disable$$module$build$src$core$events$utils();try{i=gn(e.blockState,t),Cn(i)}finally{Oo.enable$$module$build$src$core$events$utils()}return i?(N()&&!i.isShadow()&&k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(i)),i.select(),i):i}};jc.TYPE="block",yt(jc.TYPE,new jc);var Xc={};Xc.BlockPaster=jc,Xc.moveBlockToNotConflict=Cn;var Yc=null,Kc=null,qc={duplicateInternal:Pn,copyInternal:Ln},Jc={};Jc.BlockPaster=jc,Jc.TEST_ONLY=qc,Jc.copy=An,Jc.duplicate=Dn,Jc.paste=On,Jc.registry=hc;var Zc,Qc,eu="aria-",tu="role";(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(Zc||(Zc={})),function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"}(Qc||(Qc={}));var nu={};nu.Role=Zc,nu.State=Qc,nu.setRole=$n,nu.setState=Bn;var iu,ru=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&$n(t,this.roleName),this.element=t;for(let n,i=0;n=this.menuItems[i];i++)t.appendChild(n.createDom());return this.mouseOverHandler=j(t,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=j(t,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=j(t,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=j(t,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=j(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:!0}),re(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),oe(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(Y(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(Y(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(Y(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(Y(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(Y(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e,t=0;e=this.menuItems[t];t++)e.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem"))for(let t,n=0;t=this.menuItems[n];n++)if(t.getElement()===e)return t;e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement(),xe(e.getElement(),t),Bn(t,Qc.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let n;for(e+=t;n=this.menuItems[e];){if(n.isEnabled()){this.setHighlighted(n);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&"number"===typeof e.clientX){const n=new cl(e.clientX,e.clientY);if(1>cl.distance(t,n))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=_e(e);return t.height=e.scrollHeight,t}},su=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=x(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var n=document.createElement("div");n.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(n)}return n=this.content,"string"===typeof this.content&&(n=document.createTextNode(this.content)),t.appendChild(n),e.appendChild(t),this.roleName&&$n(e,this.roleName),Bn(e,Qc.SELECTED,this.checkable&&this.checked||!1),Bn(e,Qc.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(re(t,"blocklyMenuItemHighlight"),re(t,"goog-menuitem-highlight")):(oe(t,"blocklyMenuItemHighlight"),oe(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},ou=null,au=null,lu="blocklyWidgetDiv",cu="",uu="",hu={};hu.createDom=zn,hu.getDiv=Fn,hu.hide=Gn,hu.hideIfOwner=Wn,hu.isVisible=Vn,hu.positionWithAnchor=Xn,hu.repositionForWindowResize=Jn,hu.show=Hn,hu.testOnly_setDiv=Un;var du=null,pu={},fu=null,gu={};gu.callbackFactory=Oo.callbackFactory$$module$build$src$core$contextmenu,gu.commentDeleteOption=ai,gu.commentDuplicateOption=li,gu.dispose=oi,gu.getCurrentBlock=Zn,gu.hide=si,gu.setCurrentBlock=Qn,gu.show=ei,gu.workspaceCommentOption=ci;var mu=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return null!=(t=this.registry_.get(e))?t:null}getContextMenuOptions(e,t){const n=[];for(const r of this.registry_.values())if(e===r.scopeType){var i=r.preconditionFn(t);"hidden"!==i&&(i={text:"function"===typeof r.displayText?r.displayText(t):r.displayText,enabled:"enabled"===i,callback:r.callback,scope:t,weight:r.weight},n.push(i))}return n.sort((function(e,t){return e.weight-t.weight})),n}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e}(mu||(mu={}));var vu=mu.ScopeType,_u={};_u.ContextMenuRegistry=mu,_u.ScopeType=vu;var bu={};bu.clamp=di,bu.toDegrees=hi,bu.toRadians=ui;var yu,Tu,Eu,Su=16,wu=1,xu=12,Mu=16,Iu=.25,Cu=null,ku=null,Ru="",Au="",Lu=null,Ou=null,Nu=null,Du={getBoundsInfo:function(){const e=Ee(Lu),t=_e(Lu);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,n,i){const r=Du.getBoundsInfo(),s=_e(yu);return t+s.height<r.bottom?xi(e,t,r,s):i-s.height>r.top?Mi(n,i,r,s):t+s.height<document.documentElement.clientHeight?xi(e,t,r,s):i-s.height>document.documentElement.clientTop?Mi(n,i,r,s):Ii(e,r,s)}},Pu={ANIMATION_TIME:Iu,ARROW_HORIZONTAL_PADDING:xu,ARROW_SIZE:Su,BORDER_SIZE:wu,PADDING_Y:Mu,TEST_ONLY:Du};Pu.clearContent=vi,Pu.createDom=pi,Pu.getContentDiv=mi,Pu.getOwner=gi,Pu.getPositionX=Ci,Pu.hide=Ai,Pu.hideIfOwner=Ri,Pu.hideWithoutAnimation=Li,Pu.isVisible=ki,Pu.repositionForWindowResize=Ni,Pu.setBoundsElement=fi,Pu.setColour=_i,Pu.show=wi,Pu.showPositionedByBlock=bi,Pu.showPositionedByField=yi;var $u=null,Bu=null,Fu={};Fu.connectionUiEffect=$i,Fu.disconnectUiEffect=Bi,Fu.disconnectUiStop=Ui,Fu.disposeUiEffect=Di;var Uu=50,zu=100,Hu=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){let e;Oo.getGroup$$module$build$src$core$events$utils()||Oo.setGroup$$module$build$src$core$events$utils(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=cl.sum(this.startXY_,t),this.bubble.moveDuringDrag(t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return!(!e||!this.workspace.getComponentManager().hasCapability(e.id,sl.Capability.DELETE_AREA))&&e.wouldDelete(this.bubble,!1)}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){if(this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=cl.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_)this.fireMoveEvent_(),this.bubble.dispose();else{if(this.bubble.setDragging){let e;this.bubble.setDragging(!1),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,zu)}this.fireMoveEvent_()}this.workspace.setResizesEnabled(!0),Oo.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof mc){const e=new(B(fa))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),k(e)}}pixelsToWorkspaceUnits_(e){return e=new cl(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},Gu=30,Vu=!0,Wu=[];Wu[Gc.INPUT_VALUE]=Gc.OUTPUT_VALUE,Wu[Gc.OUTPUT_VALUE]=Gc.INPUT_VALUE,Wu[Gc.NEXT_STATEMENT]=Gc.PREVIOUS_STATEMENT,Wu[Gc.PREVIOUS_STATEMENT]=Gc.NEXT_STATEMENT;var ju="RENAME_VARIABLE_ID",Xu="DELETE_VARIABLE_ID",Yu={};Yu.commonWordPrefix=Gi,Yu.commonWordSuffix=Vi,Yu.isNumber=Oo.isNumber$$module$build$src$core$utils$string,Yu.shortestStringLength=Hi,Yu.startsWith=zi,Yu.wrap=Oo.wrap$$module$build$src$core$utils$string;var Ku=void 0,qu=!1,Ju=!1,Zu=50,Qu=0,eh=0,th=0,nh=0,ih=null,rh=null,sh=0,oh=10,ah=10,lh=750,ch=5,uh=null,hh={HOVER_MS:lh,LIMIT:Zu,MARGINS:ch,OFFSET_X:sh,OFFSET_Y:oh,RADIUS_OK:ah};hh.bindMouseEvents=nr,hh.block=cr,hh.createDom=tr,hh.dispose=ar,hh.getCustomTooltip=qi,hh.getDiv=Zi,hh.getTooltipOfObject=Qi,hh.hide=lr,hh.isVisible=Ji,hh.setCustomTooltip=Ki,hh.unbindMouseEvents=ir,hh.unblock=ur;var dh=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new cl(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){m()&&m().unselect()}endDrag(e){this.drag(e)}drag(e){if(e=cl.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},ph=5,fh=6,gh=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new cl(0,0),this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new cl(0,0),this.healStack=!Vu}dispose(){H(),ur(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.blockDragger&&this.blockDragger.dispose(),this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new cl(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(),z()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=cl.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=cl.magnitude(this.currentDragDeltaXY)>(this.flyout?Oo.config$$module$build$src$core$config.flyoutDragRadius:Oo.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY))&&(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Oo.getGroup$$module$build$src$core$events$utils()||Oo.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),!0)}updateIsDraggingBubble(){return!!this.startBubble&&(this.startDraggingBubble(),!0)}updateIsDraggingBlock(){if(!this.targetBlock)return!1;if(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger=new dh(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new(c(Bo.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_),this.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack),this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger=new Hu(this.startBubble,this.startWorkspace_),this.bubbleDragger.startBubbleDrag(),this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,K(e)?this.cancel():(this.gestureHasStarted=!0,Ui(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=gi(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,cr(),this.targetBlock&&this.targetBlock.select(),q(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&U(e,this),this.mouseDownXY=new cl(e.clientX,e.clientY),this.healStack=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(j(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(j(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(j(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&z())}handleMove(e){this.isDragging()&&G(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),z())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!G(e))return;if(this.updateFromEvent(e),z(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.bubbleDragger?this.bubbleDragger.endBubbleDrag(e,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(e,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=V(e);this.cachedPoints.set(t,this.getTouchPoint(e));var n=Array.from(this.cachedPoints.keys());2===n.length&&(t=this.cachedPoints.get(n[0]),n=this.cachedPoints.get(n[1]),this.startDistance=cl.distance(t,n),this.isMultiTouch_=!0,e.preventDefault())}handleTouchMove(e){const t=V(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):this.handleMove(e)}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),n=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),n=cl.distance(n,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=0<(t=n-this.previousScale)?t*ph:t*fh,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const i=this.startWorkspace_,r=J(e,i.getParentSvg(),i.getInverseScreenCTM());i.zoom(r.x,r.y,t)}this.previousScale=n,e.preventDefault()}handleTouchEnd(e){e=V(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new cl(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(z(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.doStart(e)}fireWorkspaceClick(e){k(new(B(ra))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}doBubbleClick(){this.startBubble instanceof mc&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock.isEnabled()&&(Oo.getGroup$$module$build$src$core$events$utils()||Oo.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new(B(ra))(this.startBlock,this.startWorkspace_.id,"block");k(e)}this.bringBlockToFront(),Oo.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){e=this.creatorWorkspace,m()&&m().unselect(),this.fireWorkspaceClick(this.startWorkspace_||e)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):this.targetBlock=e}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.blockDragger)?e:this.workspaceDragger)?t:this.bubbleDragger}static inProgress(){const e=h();for(let t,n=0;t=e[n];n++)if(t.currentGesture_)return!0;return!1}},mh=class{constructor(e,t){let n,i,r;this.pattern=e,this.spacing=null!=(n=t.spacing)?n:0,this.length=null!=(i=t.length)?i:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(r=t.snap)&&r}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){var t=this.spacing*e;this.pattern.setAttribute("width","".concat(t)),this.pattern.setAttribute("height","".concat(t));let n=(t=Math.floor(this.spacing/2)+.5)-this.length/2,i=t+this.length/2;t*=e,n*=e,i*=e,this.setLineAttributes(this.line1,e,n,i,t,t),this.setLineAttributes(this.line2,e,t,t,n,i)}setLineAttributes(e,t,n,i,r,s){e&&(e.setAttribute("stroke-width","".concat(t)),e.setAttribute("x1","".concat(n)),e.setAttribute("y1","".concat(r)),e.setAttribute("x2","".concat(i)),e.setAttribute("y2","".concat(s)))}moveTo(e,t){this.pattern.setAttribute("x","".concat(e)),this.pattern.setAttribute("y","".concat(t))}static createDom(e,t,n){let i,r;if(e=ie(bl.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},n),0<(null!=(i=t.length)?i:1)&&0<(null!=(r=t.spacing)?r:0)){let n;ie(bl.LINE,{stroke:t.colour},e),null!=(n=t.length)&&n&&ie(bl.LINE,{stroke:t.colour},e)}else ie(bl.LINE,{},e);return e}},vh=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t,n=0;t=e[n];n++)this.unregisterMarker(t);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};vh.LOCAL_MARKER="local_marker_1";var _h={};_h.deepMerge=gr;var bh=class{constructor(t,n,i,r){this.name=t,this.startHats=!1,this.blockStyles=n||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=r||Object.create(null),this.fontStyle=Object.create(null),e(Bo.THEME,t,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"===typeof e){const t=this.getComponentStyle(e);if(t)return t}return"".concat(e)}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const n=new bh(e);let i=t.base;if(i){if("string"===typeof i){let e;i=null!=(e=a(Bo.THEME,i))?e:void 0}i instanceof bh&&(gr(n,i),n.name=e)}return gr(n.blockStyles,t.blockStyles),gr(n.categoryStyles,t.categoryStyles),gr(n.componentStyles,t.componentStyles),gr(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}},yh=new bh("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Th=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,n=!1;var i=!1,r=!1,s=!1,o=!1,a=!1;const l=!!e.readOnly;var c;l||(t=Pe(null!=(c=e.toolbox)?c:null),n=Fe(t),i=void 0===(i=e.trashcan)?n:i,r=void 0===(r=e.collapse)?n:r,s=void 0===(s=e.comments)?n:s,o=void 0===(o=e.disable)?n:o,a=void 0===(a=e.sounds)||a),c=e.maxTrashcanContents,i?void 0===c&&(c=32):c=0;const u=!!e.rtl;let h=e.horizontalLayout;void 0===h&&(h=!1);var d="end"!==e.toolboxPosition;d=h?d?Pl.TOP:Pl.BOTTOM:d===u?Pl.RIGHT:Pl.LEFT;let p=e.css;void 0===p&&(p=!0);let f="https://blockly-demo.appspot.com/static/media/";e.media?f=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(ne("path","Nov 2014","Jul 2023","media"),f=e.path+"media/");const g=e.oneBasedIndex,m=e.renderer||"geras",v=e.plugins||{};let _,b,y,T=e.modalInputs;void 0===T&&(T=!0),this.RTL=u,this.oneBasedIndex=void 0===g||g,this.collapse=r,this.comments=s,this.disable=o,this.readOnly=l,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(_=e.maxInstances)?_:null,this.modalInputs=T,this.pathToMedia=f,this.hasCategories=n,this.moveOptions=Th.parseMoveOptions_(e,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=i,this.maxTrashcanContents=c,this.hasSounds=a,this.hasCss=p,this.horizontalLayout=h,this.languageTree=t,this.gridOptions=Th.parseGridOptions_(e),this.zoomOptions=Th.parseZoomOptions_(e),this.toolboxPosition=d,this.theme=Th.parseThemeOptions_(e),this.renderer=m,this.rendererOverrides=null!=(b=e.rendererOverrides)?b:null,this.parentWorkspace=null!=(y=e.parentWorkspace)?y:null,this.plugins=v}static parseMoveOptions_(e,t){const n=e.move||{},i={};return void 0===n.scrollbars&&void 0===e.scrollbars?i.scrollbars=t:"object"===typeof n.scrollbars?(i.scrollbars={horizontal:!!n.scrollbars.horizontal,vertical:!!n.scrollbars.vertical},i.scrollbars.horizontal&&i.scrollbars.vertical?i.scrollbars=!0:i.scrollbars.horizontal||i.scrollbars.vertical||(i.scrollbars=!1)):i.scrollbars=!!n.scrollbars||!!e.scrollbars,i.wheel=i.scrollbars&&void 0!==n.wheel?!!n.wheel:"object"===typeof i.scrollbars,i.drag=!!i.scrollbars&&(void 0===n.drag||!!n.drag),i}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return"string"===typeof(e=e.theme||yh)?a(Bo.THEME,e):e instanceof bh?e:bh.defineTheme(e.name||"builtin"+x(),e)}},Eh=class extends Bc{constructor(e,t,n,i,r){super(e),this.type=Oo.CHANGE$$module$build$src$core$events$utils,e&&(this.element=t,this.name=n||void 0,this.oldValue=i,this.newValue=r)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Eh)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getIcon(Xl.MUTATOR);switch(n&&mr(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":n=Eh.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(Oo.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),k(new Eh(t,"mutation",null,n,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Bt(e):""}};e(Bo.EVENT,Oo.CHANGE$$module$build$src$core$events$utils,Eh);var Sh=.45,wh=.65,xh={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Mh={};Mh.blend=xr,Mh.getHsvSaturation=vr,Mh.getHsvValue=br,Mh.hexToRgb=Sr,Mh.hsvToHex=wr,Mh.hueToHex=Mr,Mh.names=xh,Mh.parse=Tr,Mh.rgbToHex=Er,Mh.setHsvSaturation=_r,Mh.setHsvValue=yr;var Ih={};Ih.checkMessageReferences=Rr,Ih.parseBlockColour=Ar,Ih.replaceMessageReferences=kr,Ih.tokenizeInterpolation=Cr;var Ch=class{constructor(e,t,n){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Tl(0,0),e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(kr(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=ie(bl.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=ie(bl.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=ie(bl.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");nr(e),this.mouseDownWrapper_=j(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(Ch))?e:this.getValue()}loadState(e){this.loadLegacyState(Ch,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=Oo.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Ne(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(Oo.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;Ri(this),Wn(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||le(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(re(e,"blocklyEditableText"),oe(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(re(e,"blocklyNonEditableText"),oe(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Ch.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error("The border rectangle is ".concat(this.borderRect_,"."));return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error("The text element is ".concat(this.textElement_,"."));return this.textElement_}getTextContent(){if(!this.textContent_)throw Error("The text content is ".concat(this.textContent_,"."));return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let n=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),i=t.FIELD_TEXT_HEIGHT,r=0;this.textElement_&&(r=ge(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),n+=r),this.isFullBlockField()||(i=Math.max(i,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=i,this.size_.width=n,this.positionTextElement_(e,r),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,i=this.getConstants(),r=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?r:r-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Tl(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new kh;if(this.isFullBlockField()){var n=this.sourceBlock_.getHeightWidth();const i=t.workspace.scale;e=this.getAbsoluteXY_(),t=(n.width+1)*i,n=(n.height+1)*i,Xa?(e.x+=1.5*i,e.y+=1.5*i):(e.x-=.5*i,e.y-=.5*i)}else n=this.borderRect_.getBoundingClientRect(),e=Ee(this.borderRect_),t=n.width,n=n.height;return new yl(e.y,e.y+n,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,Ch.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e):Ch.NBSP}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),this.sourceBlock_.bumpNeighbours())}setValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==e){var n,i=this.doClassValidation_(e);(e=this.processValidation_(e,i))instanceof Error||(i=null==(n=this.getValidator())?void 0:n.call(this,e),(n=this.processValidation_(e,i))instanceof Error||(e=this.sourceBlock_)&&e.disposed||((i=this.getValue())===n?this.doValueUpdate_(n):(this.doValueUpdate_(n),t&&e&&N()&&k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(e,"field",this.name||null,i,n)),this.isDirty_&&this.forceRerender())))}}processValidation_(e,t){return null===t?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null===e||void 0===e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return Qi(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Ee(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new kh;const n=t.inputList;for(let i=0;i<t.inputList.length;i++){const t=n[i],r=t.fieldRow;for(let n=0;n<r.length;n++)if(r[n]===this){e=t;break}}return e}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(e){return!1}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new kh;(e=e.workspace).keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(vh.LOCAL_MARKER).draw()}};Ch.NBSP="\xa0",Ch.SKIP_SETUP=Symbol("SKIP_SETUP");var kh=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Rh={};Rh.Field=Ch,Rh.UnattachedFieldError=kh,Oo.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=Oo.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),Oo.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let n=e;t===Oo.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(n=e),e=n.toLowerCase();const i=t===Oo.NameType$$module$build$src$core$names.VARIABLE||t===Oo.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const r=this.db.get(t);return r.has(e)?i+r.get(e):(t=this.getDistinctName(n,t),r.set(e,t.substr(i.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let n,i,r,s=null;for(;this.dbReverse.has(e+(null!=(n=s)?n:""))||this.reservedWords.has(e+(null!=(i=s)?i:""));)s=s?s+1:2;return e+=null!=(r=s)?r:"",this.dbReverse.add(e),(t===Oo.NameType$$module$build$src$core$names.VARIABLE||t===Oo.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!=="0123456789".indexOf(e[0])&&(e="my_"+e)):e=Oo.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(Oo.Names$$module$build$src$core$names||(Oo.Names$$module$build$src$core$names={})),Oo.NameType$$module$build$src$core$names=Oo.Names$$module$build$src$core$names.NameType,Oo.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=Oo.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:Oo.NameType$$module$build$src$core$names}.Names=Oo.Names$$module$build$src$core$names;var Ah=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),Or(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))?(Or(t)&&t.stopPublishing(),e):e}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Lh=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new cl(0,0),this.workspaceLocation=new cl(0,0),this.svgRoot=null,this.tooltip=e}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=ie(bl.G,{class:"blocklyIconGroup"}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),j(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,nr(this.svgRoot)}}dispose(){ir(this.svgRoot),le(this.svgRoot)}getWeight(){return-1}getSize(){return new Tl(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",mr(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform","translate(".concat(this.offsetInBlock.x,", ").concat(this.offsetInBlock.y,")"))}onLocationChange(e){this.workspaceLocation=cl.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}setVisible(e){ne("setVisible","v10","v11","setBubbleVisible"),mr(this)&&this.setBubbleVisible(e)}},Oh={fromJsonInternal:Pr},Nh={TEST_ONLY:Oh};Nh.fromJson=Oo.fromJson$$module$build$src$core$field_registry,Nh.register=Nr,Nh.unregister=Dr;var Dh=class extends Ch{constructor(e,t,n){super(Ch.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==Ch.SKIP_SETUP&&(Array.isArray(e)?(Fr(e),e=$r(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],n&&this.configure_(n),this.setValue(this.selectedOption[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Dh,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=ie(bl.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&re(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=ie(bl.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?Dh.ARROW_CHAR+" ":" "+Dh.ARROW_CHAR)),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=ie(bl.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(fl,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new kh;this.dropdownCreate(),this.menu_.openingCoords=e&&"number"===typeof e.clientX?new cl(e.clientX,e.clientY):null,vi(),e=this.menu_.render(mi()),re(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),_i(t,this.sourceBlock_.style.colourTertiary)),yi(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),xe(this.selectedMenuItem.getElement(),mi(),!0)),this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new kh;const t=new ru;t.setRole(Zc.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let r=0;r<n.length;r++){const[s,o]=n[r];if("object"===typeof s){var i=new Image(s.width,s.height);i.src=s.src,i.alt=s.alt||""}else i=s;(i=new su(i,o)).setRole(Zc.OPTION),i.setRightToLeft(e.RTL),i.setCheckable(!0),t.addChild(i),i.setChecked(o===this.value_),o===this.value_&&(this.selectedMenuItem=i),i.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Ri(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"===typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),Fr(this.generatedOptions)),this.generatedOptions)}doClassValidation_(e){return this.getOptions(!0).some((t=>t[1]===e))?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t,n=0;t=e[n];n++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=e.colourSecondary:this.arrow.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];e&&"object"===typeof e?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new kh;this.imageElement.style.display="",this.imageElement.setAttributeNS(fl,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const n=Number(e.height);e=Number(e.width);var i=!!this.borderRect_;const r=Math.max(i?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+Ph);let s;i=i?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.svgArrow?this.positionSVGArrow(e+i,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):ge(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+s+2*i,this.size_.height=r;let o=0;t.RTL?this.imageElement.setAttribute("x","".concat(i+s)):(o=e+s,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x","".concat(i))),this.imageElement.setAttribute("y",String(r/2-n/2)),this.positionTextElement_(o+i,e+s)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();re(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const n=ge(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let i=0;this.svgArrow&&(i=this.positionSVGArrow(n+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=n+i+2*t,this.size_.height=e,this.positionTextElement_(t,n)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new kh;const i=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(n.RTL?i:e+r)+","+t+")"),s+r}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];return"object"===typeof e?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};Dh.CHECKMARK_OVERHANG=25,Dh.MAX_MENU_HEIGHT_VH=.45,Dh.ARROW_CHAR="\u25be";var Ph=10;Nr("field_dropdown",Dh);var $h,Bh=class{constructor(e,t,n){this.workspace=e,this.anchor=t,this.ownerRect=n,this.size=new Tl(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.svgRoot=ie(bl.G,{},e.getBubbleCanvas()),e=ie(bl.G,{filter:"url(#".concat(this.workspace.getRenderer().getConstants().embossFilterId,")")},this.svgRoot),this.tail=ie(bl.PATH,{},e),this.background=ie(bl.RECT,{class:"blocklyDraggable",x:0,y:0,rx:$h.BORDER_WIDTH,ry:$h.BORDER_WIDTH},e),this.contentContainer=ie(bl.G,{},this.svgRoot),j(this.background,"pointerdown",this,this.onMouseDown)}dispose(){le(this.svgRoot),this.disposed=!0}setAnchorLocation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.width=Math.max(e.width,$h.MIN_SIZE),e.height=Math.max(e.height,$h.MIN_SIZE),this.size=e,this.background.setAttribute("width","".concat(e.width)),this.background.setAttribute("height","".concat(e.height)),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform","translate(".concat(e,", ").concat(t,")"))}positionByRect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yl(0,0,0,0);var t=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(t),i=this.getOptimalRelativeTop(t);const r={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:i};i={x:e.getWidth(),y:i};var o={x:n,y:e.getHeight()};n=e.getWidth()<e.getHeight()?i:o,e=e.getWidth()<e.getHeight()?o:i,i=this.getOverlap(r,t),o=this.getOverlap(s,t);const a=this.getOverlap(n,t);t=this.getOverlap(e,t),i===(t=Math.max(i,o,a,t))?(this.relativeLeft=r.x,this.relativeTop=r.y):o===t?(this.relativeLeft=s.x,this.relativeTop=s.y):a===t?(this.relativeLeft=n.x,this.relativeTop=n.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var n=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(n+this.size.width,t.left+t.width)-Math.max(n,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var n=this.anchor.x-t;n-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):n>e.right&&(t=-(e.right-this.anchor.x))}else{const i=(n=t+this.anchor.x)+this.size.width;n<e.left?t=e.left-this.anchor.x:i>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const n=this.anchor.y+t,i=n+this.size.height;return n<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:i>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let n=e.top+e.height,i=e.left;return e=e.left+e.width,n-=this.getScrollbarThickness(),this.workspace.RTL?i-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new yl(t,n,i,e)}getScrollbarThickness(){return Il.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,n=this.size.height/2,i=-this.relativeLeft,r=-this.relativeTop;if(t===i&&n===r)e.push("M "+t+","+n);else{r-=n,i-=t,this.workspace.RTL&&(i*=-1);var s=Math.sqrt(r*r+i*i),o=Math.acos(i/s);0>r&&(o=2*Math.PI-o);var a=o+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a);const c=Math.cos(a);let u=(this.size.width+this.size.height)/$h.TAIL_THICKNESS;u=Math.min(u,this.size.width,this.size.height)/4,i=t+(a=1-$h.ANCHOR_RADIUS/s)*i,r=n+a*r,a=t+u*c;const h=n+u*l;t-=u*c,n-=u*l,(l=o+(l=ui(this.workspace.RTL?-$h.TAIL_ANGLE:$h.TAIL_ANGLE)))>2*Math.PI&&(l-=2*Math.PI),o=Math.sin(l)*s/$h.TAIL_BEND,s=Math.cos(l)*s/$h.TAIL_BEND,e.push("M"+a+","+h),e.push("C"+(a+s)+","+(h+o)+" "+i+","+r+" "+i+","+r),e.push("C"+i+","+r+" "+(t+s)+","+(n+o)+" "+t+","+n)}let c;e.push("z"),null==(c=this.tail)||c.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==t?void 0:t.lastChild)===this.svgRoot)&&(null==t||t.appendChild(this.svgRoot),!0)}getRelativeToSurfaceXY(){return new cl(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}};$h=Bh,Bh.BORDER_WIDTH=6,Bh.DOUBLE_BORDER=2*$h.BORDER_WIDTH,Bh.MIN_SIZE=$h.DOUBLE_BORDER,Bh.TAIL_THICKNESS=1,Bh.TAIL_ANGLE=20,Bh.TAIL_BEND=4,Bh.ANCHOR_RADIUS=8;var Fh,Uh,zh=class extends Bh{constructor(e,t,n,i){let r,s;super(t,n,i),this.workspace=t,this.anchor=n,this.ownerRect=i,this.autoLayout=!0,t=new Th(e),this.validateWorkspaceOptions(t),this.svgDialog=ie(bl.SVG,{x:Bh.BORDER_WIDTH,y:Bh.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Th(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(bl.G),this.miniWorkspace.getCanvas()),null==(e=this.miniWorkspace.getFlyout())||e.init(this.miniWorkspace),null==e||e.show(t.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(r=this.miniWorkspace.getFlyout())||null==(s=r.getWorkspace())||s.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let n=-20;const i=this.miniWorkspace.getFlyout();i&&(n-=i.getWidth()),t.x>n&&e.moveBy(n-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<zh.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<zh.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width","".concat(t.width,"px")),this.svgDialog.setAttribute("height","".concat(t.height,"px")),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform","translate(".concat(t.width,", 0)")),this.setSize(new Tl(t.width+Bh.DOUBLE_BORDER,t.height+Bh.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+zh.MARGIN;e=e.height+zh.MARGIN;const n=this.miniWorkspace.getFlyout();if(n){const i=n.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,i.height+20),t+=n.getWidth()}return new Tl(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const n of e.getAllBlocks(!1))n.setStyle(n.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};zh.MINIMUM_VIEW_CHANGE=10,zh.MARGIN=3*Bh.DOUBLE_BORDER,Fh=17,Uh=16,Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Lh{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(bl.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),ie(bl.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),ie(bl.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),re(this.svgRoot,"blockly-icon-mutator"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Tl(Fh,Fh)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.style.colourPrimary),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e){let e;this.miniWorkspaceBubble=new zh(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour(),this.createRootBlock(),this.addSaveConnectionsListener(),null==(e=this.miniWorkspaceBubble)||e.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let e;null==(e=this.miniWorkspaceBubble)||e.dispose(),this.miniWorkspaceBubble=null,this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener),this.saveConnectionsListener=null}k(new(B(oa))(this.sourceBlock,e,"mutator"))}}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map((e=>({kind:"block",type:e})))}),t}getAnchorLocation(){const e=Fh/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,n,i,r;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(r=null==(t=this.miniWorkspaceBubble)||null==(n=t.getWorkspace())||null==(i=n.getFlyout())?void 0:i.getWidth())?r:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+Uh):Uh,Uh)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout((()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()}),0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||e.type===Oo.CREATE$$module$build$src$core$events$utils||e.type===Oo.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=Oo.getGroup$$module$build$src$core$events$utils();e||Oo.setGroup$$module$build$src$core$events$utils(!0);var t=Eh.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var n=Eh.getExtraBlockState_(this.sourceBlock);t!==n&&k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,t,n)),Oo.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}static reconnect(e,t,n){return ne("MutatorIcon.reconnect","v10","v11","connection.reconnect"),!!e&&e.reconnect(t,n)}static findParentWs(e){return ne("MutatorIcon.findParentWs","v10","v11","workspace.getRootWorkspace"),e.getRootWorkspace()}},Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Xl.MUTATOR,Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Hh=Object.create(null),Gh={allExtensions:Hh};Oo.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Qr);var Vh,Wh={TEST_ONLY:Gh};Wh.apply=Hr,Wh.buildTooltipForDropdown=Oo.buildTooltipForDropdown$$module$build$src$core$extensions,Wh.buildTooltipWithFieldText=Oo.buildTooltipWithFieldText$$module$build$src$core$extensions,Wh.isRegistered=zr,Wh.register=Oo.register$$module$build$src$core$extensions,Wh.registerMixin=Oo.registerMixin$$module$build$src$core$extensions,Wh.registerMutator=Oo.registerMutator$$module$build$src$core$extensions,Wh.runAfterPageLoad=Jr,Wh.unregister=Ur,function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"}(Vh||(Vh={}));var jh={};jh.arc=as,jh.curve=ts,jh.line=ss,jh.lineOnAxis=os,jh.lineTo=rs,jh.moveBy=is,jh.moveTo=ns,jh.point=es;var Xh={};Xh.Coordinate=cl,Xh.KeyCodes=Vh,Xh.Rect=yl,Xh.Size=Tl,Xh.Svg=bl,Xh.aria=nu,Xh.array=il,Xh.browserEvents=nl,Xh.colour=Mh,Xh.deprecation=ul,Xh.dom=_l,Xh.extensions=Wh,Xh.idGenerator=Sa,Xh.math=bu,Xh.object=_h,Xh.parsing=Ih,Xh.string=Yu,Xh.style=Sl,Xh.svgMath=Ml,Xh.svgPaths=jh,Xh.toolbox=Gl,Xh.userAgent=Qa,Xh.xml=Dl;var Yh={};Yh.register=ls,Yh.unregister=cs;var Kh=class extends Bh{constructor(e,t,n,i){super(t,n,i),this.text=e,this.workspace=t,this.anchor=n,this.ownerRect=i,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(e){this.text=e,le(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createSpans(t,e),this.workspace.RTL&&this.rightAlignSpans(t.getBBox().width,e),t}createParagraph(e){return ie(bl.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Bh.BORDER_WIDTH},e)}createSpans(e,t){return t.split("\n").map((t=>{const n=ie(bl.TSPAN,{dy:"1em",x:Bh.BORDER_WIDTH},e);return t=document.createTextNode(t),n.appendChild(t),n}))}rightAlignSpans(e,t){for(const n of t)n.setAttribute("text-anchor","end"),n.setAttribute("x","".concat(e+Bh.BORDER_WIDTH))}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Tl(e.width+2*Bh.BORDER_WIDTH,e.height+2*Bh.BORDER_WIDTH),!0)}},qh=class extends Bh{constructor(e,t,n){super(e,t,n),this.workspace=e,this.anchor=t,this.ownerRect=n,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Tl(160+Bh.DOUBLE_BORDER,80+Bh.DOUBLE_BORDER),this.MIN_SIZE=new Tl(45+Bh.DOUBLE_BORDER,20+Bh.DOUBLE_BORDER),({inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer)),this.resizeGroup=this.createResizeHandle(this.svgRoot),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}createEditor(e){e=ie(bl.FOREIGNOBJECT,{x:Bh.BORDER_WIDTH,y:Bh.BORDER_WIDTH},e);const t=document.createElementNS(pl,"body");t.setAttribute("xmlns",pl),t.className="blocklyMinimalBody";const n=document.createElementNS(pl,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),t.appendChild(n),e.appendChild(t),this.bindTextAreaEvents(n),setTimeout((()=>{n.focus()}),0),{inputRoot:e,textArea:n}}bindTextAreaEvents(e){j(e,"wheel",this,(e=>{e.stopPropagation()})),j(e,"focus",this,this.onStartEdit,!0),j(e,"change",this,this.onTextChange)}createResizeHandle(e){e=ie(bl.G,{class:this.workspace.RTL?"blocklyResizeSW":"blocklyResizeSE"},e);const t=2*Bh.BORDER_WIDTH;return ie(bl.POLYGON,{points:"0,".concat(t," ").concat(t,",").concat(t," ").concat(t,",0")},e),ie(bl.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},e),ie(bl.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},e),j(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const n=e.width-Bh.DOUBLE_BORDER,i=e.height-Bh.DOUBLE_BORDER;this.inputRoot.setAttribute("width","".concat(n)),this.inputRoot.setAttribute("height","".concat(i)),this.textArea.style.width="".concat(n-4,"px"),this.textArea.style.height="".concat(i-4,"px"),this.workspace.RTL?this.resizeGroup.setAttribute("transform","translate(".concat(Bh.DOUBLE_BORDER,", ").concat(i,") scale(-1 1)")):this.resizeGroup.setAttribute("transform","translate(".concat(n,", ").concat(i,")")),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(e){this.bringToFront(),q(e)||(this.workspace.startDrag(e,new cl(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=j(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=j(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){H(),this.resizePointerUpListener&&(Y(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Y(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=this.workspace.moveDrag(e),this.setSize(new Tl(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}};ee("\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n");var Jh=17,Zh=160,Qh=80,ed=class extends Lh{constructor(e){super(e),this.sourceBlock=e,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Tl(Zh,Qh),this.bubbleVisiblity=!1}getType(){return ed.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(bl.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),ie(bl.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),ie(bl.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),re(this.svgRoot,"blockly-icon-comment"))}dispose(){let e,t;super.dispose(),null==(e=this.textInputBubble)||e.dispose(),null==(t=this.textBubble)||t.dispose()}getWeight(){return ed.WEIGHT}getSize(){return new Tl(Jh,Jh)}applyColour(){super.applyColour();const e=this.sourceBlock.style.colourPrimary;let t,n;null==(t=this.textInputBubble)||t.setColour(e),null==(n=this.textBubble)||n.setColour(e)}updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(e){let t,n;super.onLocationChange(e),e=this.getAnchorLocation(),null==(t=this.textInputBubble)||t.setAnchorLocation(e),null==(n=this.textBubble)||n.setAnchorLocation(e)}setText(e){const t=this.text;let n,i;k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(n=this.textInputBubble)||n.setText(this.text),null==(i=this.textBubble)||i.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){let t,n,i,r;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new Tl(null!=(n=e.width)?n:Zh,null!=(i=e.height)?i:Qh),this.bubbleVisiblity=null!=(r=e.pinned)&&r,setTimeout((()=>this.setBubbleVisible(this.bubbleVisiblity)),1)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){e&&(this.textBubble||this.textInputBubble)||(e||this.textBubble||this.textInputBubble)&&(this.bubbleVisiblity=e,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),k(new(B(oa))(this.sourceBlock,e,"comment"))))}showEditableBubble(){this.textInputBubble=new qh(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener((()=>this.onTextChange())),this.textInputBubble.addSizeChangeListener((()=>this.onSizeChange()))}showNonEditableBubble(){this.textBubble=new Kh(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let e,t;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null,null==(t=this.textBubble)||t.dispose(),this.textBubble=null}getAnchorLocation(){const e=Jh/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}};ed.TYPE=Xl.COMMENT,ed.WEIGHT=3,ls(ed.TYPE,ed);var td=17,nd=class extends Lh{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return nd.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(bl.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),ie(bl.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),ie(bl.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),re(this.svgRoot,"blockly-icon-warning"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return nd.WEIGHT}getSize(){return new Tl(td,td)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let n;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(n=this.textBubble)||n.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e)this.textBubble=new Kh(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let e;null==(e=this.textBubble)||e.dispose(),this.textBubble=null}k(new(B(oa))(this.sourceBlock,e,"warning"))}}getAnchorLocation(){const e=td/2;return cl.sum(this.workspaceLocation,new cl(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new yl(e.y,e.y+e.height,e.x,e.x+e.width)}};nd.TYPE=Xl.WARNING,nd.WEIGHT=2;var id=class extends Error{constructor(e){super("Tried to append an icon of type ".concat(e.getType()," when an icon of ")+"that type already exists on the block. Use getIcon to access the existing icon."),this.icon=e}},rd={};rd.DuplicateIconType=id;var sd,od,ad={};ad.CommentIcon=ed,ad.Icon=Lh,ad.IconType=Xl,ad.MutatorIcon=Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon,ad.WarningIcon=nd,ad.exceptions=rd,ad.registry=Yh,sd="PROCEDURE",Oo.DEFAULT_ARG$$module$build$src$core$procedures="x",(od={CATEGORY_NAME:sd,DEFAULT_ARG:Oo.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Ah,od.allProcedures=us,od.findLegalName=Oo.findLegalName$$module$build$src$core$procedures,od.flyoutCategory=fs,od.getCallers=_s,od.getDefinition=Oo.getDefinition$$module$build$src$core$procedures,od.isNameUsed=ps,od.isProcedureBlock=Lr,od.mutateCallers=Oo.mutateCallers$$module$build$src$core$procedures,od.mutatorOpenListener=ms,od.rename=Oo.rename$$module$build$src$core$procedures;var ld=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},cd=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=ld.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},ud=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=ld.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(ld.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(ld.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(ld.isSpacer(t))return t}return null}},hd=class extends ud{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=ld.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];t+=r.width,ld.isSpacer(r)||(ld.isNextConnection(r)?n=Math.max(n,r.height):e=Math.max(e,r.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},dd=class extends cd{constructor(e,t){super(e),this.connectionModel=t,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=ld.CONNECTION}},pd=class extends dd{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=ld.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},fd=class extends pd{constructor(e,t){super(e,t),this.height=0,this.type|=ld.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},gd=class extends cd{constructor(e,t,n){super(e),this.field=t,this.parentInput=n,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=ld.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},md=class extends cd{constructor(e){super(e),this.type|=ld.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},vd=class extends cd{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.isVisible=mr(t)&&t.bubbleIsVisible(),this.type|=ld.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},_d=class extends cd{constructor(e,t){super(e),this.type=this.type|ld.SPACER|ld.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},bd=class extends pd{constructor(e,t){super(e,t),this.type|=ld.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},yd=class extends pd{constructor(e,t){super(e,t),this.type|=ld.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Td=class extends ud{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=ld.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const n=this.elements[t];this.width+=n.width,ld.isInput(n)&&n instanceof pd&&(ld.isStatementInput(n)&&n instanceof yd?e+=n.connectedBlockWidth:ld.isExternalInput(n)&&n instanceof fd&&0!==n.connectedBlockWidth&&(e+=n.connectedBlockWidth-n.connectionWidth)),ld.isSpacer(n)||(this.height=Math.max(this.height,n.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Ed=class extends cd{constructor(e){super(e),this.type|=ld.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Sd=class extends dd{constructor(e,t){super(e,t),this.type|=ld.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},wd=class extends dd{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=ld.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},xd=class extends dd{constructor(e,t){super(e,t),this.type|=ld.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Md=class extends cd{constructor(e,t){super(e),this.type=(t&&"left"!==t?ld.RIGHT_ROUND_CORNER:ld.LEFT_ROUND_CORNER)|ld.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Id=class extends ud{constructor(e,t,n){super(e),this.height=t,this.width=n,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|ld.SPACER|ld.BETWEEN_ROW_SPACER,this.elements=[new _d(this.constants_,n)]}measure(){}},Cd=class extends cd{constructor(e,t){super(e),this.type=(t&&"left"!==t?ld.RIGHT_SQUARE_CORNER:ld.LEFT_SQUARE_CORNER)|ld.CORNER,this.width=this.height=this.constants_.NO_PADDING}},kd=class extends ud{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=ld.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,n=e.getPreviousBlock();return!!e.outputConnection||t||!!n&&n.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];t+=r.width,ld.isSpacer(r)||(ld.isHat(r)&&r instanceof md?n=Math.max(n,r.ascenderHeight):e=Math.max(e,r.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Rd=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=is(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const n in t)this.blockStyles[n]=this.validatedBlockStyle_(t[n]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=ve("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&0===e.indexOf("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=Ar(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?Ar(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?Ar(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return xr("#fff",e,.6)||e}generateTertiaryColour_(e){return xr("#fff",e,.3)||e}dispose(){this.embossFilter&&le(this.embossFilter),this.disabledPattern&&le(this.disabledPattern),this.debugFilter&&le(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:ss([es(t,e/4),es(2*-t,e/2),es(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:ts("c",[es(30,-e),es(70,-e),es(t,0)])}}makePuzzleTab(){function e(e){const i=-(e=e?-1:1);var r=n/2;const s=r+2.5,o=r+.5,a=es(-t,e*r);return r=es(t,e*r),ts("c",[es(0,e*s),es(-t,i*o),a])+ts("s",[es(t,2.5*i),r])}const t=this.TAB_WIDTH,n=this.TAB_HEIGHT,i=e(!0),r=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:n,pathDown:r,pathUp:i}}makeNotch(){function e(e){return ss([es(e*i,n),es(3*e,0),es(e*i,-n)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,i=(t-3)/2,r=e(1),s=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:r,pathRight:s}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:as("a","0 0,0",e,es(-e,e)),pathBottom:as("a","0 0,0",e,es(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=is(0,e)+as("a","0 0,1",e,es(e,-e)),n=as("a","0 0,1",e,es(e,e)),i=as("a","0 0,1",e,es(-e,-e));return{topLeft:t,topRight:n,bottomRight:as("a","0 0,1",e,es(-e,e)),bottomLeft:i,rightHeight:e}}shapeFor(e){switch(e.type){case Gc.INPUT_VALUE:case Gc.OUTPUT_VALUE:return this.PUZZLE_TAB;case Gc.PREVIOUS_STATEMENT:case Gc.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,n){this.injectCSS_(t,n),this.defs=ie(bl.DEFS,{},e),e=ie(bl.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),ie(bl.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=ie(bl.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),ie(bl.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),ie(bl.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),ie(bl.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=ie(bl.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),ie(bl.RECT,{width:10,height:10,fill:"#aaa"},e),ie(bl.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const e=ie(bl.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=ie(bl.FECOMPONENTTRANSFER,{result:"outBlur"},e);ie(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ie(bl.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),ie(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const n=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=n:((t=document.createElement("style")).id=e,e=document.createTextNode(n),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return["".concat(e," .blocklyText, "),"".concat(e," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ")+"".concat(this.FIELD_TEXT_FONTSIZE,"pt ").concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e," .blocklyText {"),"fill: #fff;","}","".concat(e," .blocklyNonEditableText>rect,"),"".concat(e," .blocklyEditableText>rect {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"fill-opacity: .6;","stroke: none;","}","".concat(e," .blocklyNonEditableText>text,"),"".concat(e," .blocklyEditableText>text {"),"fill: #000;","}","".concat(e," .blocklyFlyoutLabelText {"),"fill: #000;","}","".concat(e," .blocklyText.blocklyBubbleText {"),"fill: #000;","}","".concat(e," .blocklyEditableText:not(.editing):hover>rect {"),"stroke: #fff;","stroke-width: 2;","}","".concat(e," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"}","".concat(e," .blocklySelected>.blocklyPath {"),"stroke: #fc3;","stroke-width: 3px;","}","".concat(e," .blocklyHighlightedConnectionPath {"),"stroke: #fc3;","}","".concat(e," .blocklyReplaceable .blocklyPath {"),"fill-opacity: .5;","}","".concat(e," .blocklyReplaceable .blocklyPathLight,"),"".concat(e," .blocklyReplaceable .blocklyPathDark {"),"display: none;","}","".concat(e," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"]}},Ad={};Ad.ConstantProvider=Rd,Ad.isDynamicShape=ys;var Ld=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}hideHiddenIcons_(){ne("hideHiddenIcons_","v10","v11")}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=is(e.xPos,this.info_.startY);for(let n,i=0;n=t[i];i++)ld.isLeftRoundedCorner(n)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:ld.isRightRoundedCorner(n)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:ld.isPreviousConnection(n)&&n instanceof dd?this.outlinePath_+=n.shape.pathLeft:ld.isHat(n)?this.outlinePath_+=this.constants_.START_HAT.path:ld.isSpacer(n)&&(this.outlinePath_+=os("h",n.width));this.outlinePath_+=os("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+os("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const n=ys(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=os("H",t.xPos+t.width)+n+os("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var n=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+os("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var i=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=os("H",n)+t+os("v",i)+this.constants_.INSIDE_CORNERS.pathBottom+os("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=os("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let n=0,i="";for(let r,s=t.length-1;r=t[s];s--)ld.isNextConnection(r)&&r instanceof dd?i+=r.shape.pathRight:ld.isLeftSquareCorner(r)?i+=os("H",e.xPos):ld.isLeftRoundedCorner(r)?i+=this.constants_.OUTSIDE_CORNERS.bottomLeft:ld.isRightRoundedCorner(r)?(i+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):ld.isSpacer(r)&&(i+=os("h",-1*r.width));this.outlinePath_+=os("V",e.baseline-n),this.outlinePath_+=i}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=ys(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=os("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e,t=0;e=this.info_.rows[t];t++)for(let n,i=0;n=e.elements[i];i++)ld.isInlineInput(n)?this.drawInlineInput_(n):(ld.isIcon(n)||ld.isField(n))&&this.layoutField_(n)}layoutField_(e){const t=e.centerline-e.height/2;let n=e.xPos;var i="";this.info_.RTL&&(n=-(n+e.width),e.flipRtl&&(n+=e.width,i="scale(-1 1)")),ld.isIcon(e)?((i=e.icon).setOffsetInBlock(new cl(n,t)),this.info_.isInsertionMarker&&i.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+n+","+t+")"+i),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,n=e.height,i=e.connectionOffsetY,r=e.connectionHeight+i;this.inlinePath_+=ns(e.xPos+e.connectionWidth,e.centerline-n/2)+os("v",i)+e.shape.pathDown+os("v",n-r)+os("h",t-e.connectionWidth)+os("v",-n)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}};(function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Oo.Align$$module$build$src$core$inputs$align||(Oo.Align$$module$build$src$core$inputs$align={})),Oo.Align$$module$build$src$core$inputs$align;var Od=class extends Ch{constructor(e,t,n){super(Ch.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==Ch.SKIP_SETUP&&(n?this.configure_(n):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&re(this.getTextElement(),this.class)}doClassValidation_(e){return null===e||void 0===e?null:"".concat(e)}setClass(e){this.textElement_&&(this.class&&oe(this.textElement_,this.class),e&&re(this.textElement_,e)),this.class=e}static fromJson(e){return new this(kr(e.text),void 0,e)}};Nr("field_label",Od),Od.prototype.DEFAULT_VALUE="";var Nd=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=Oo.Align$$module$build$src$core$inputs$input.LEFT,this.visible=!0,this.type=Oo.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,n){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return t||""===t&&n?("string"===typeof t&&(t=Oo.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=n,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),e):e}removeField(e,t){for(let n,i=0;n=this.fieldRow[i];i++)if(n.name===e)return n.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let i,r=0;i=this.fieldRow[r];r++)i.setVisible(e);if(this.connection){var n=this.connection;e?t=n.startTrackingAll():n.stopTrackingAll(),(n=n.targetBlock())&&(n.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e,t=0;e=this.fieldRow[t];t++)e.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e,t=0;e=this.fieldRow[t];t++)e.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}};(function(e){(e=e.Align||(e.Align={}))[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Nd||(Nd={})),Oo.Align$$module$build$src$core$inputs$input=Nd.Align,{Align:Oo.Align$$module$build$src$core$inputs$input}.Input=Nd;var Dd=class extends Nd{constructor(e,t){super(e,t),this.name=e,this.type=Oo.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Pd=class extends Nd{constructor(e,t){super(e,t),this.name=e,this.type=Oo.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},$d=class extends Nd{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=Oo.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Gc.NEXT_STATEMENT)}};Oo.ValueInput$$module$build$src$core$inputs$value_input=class extends Nd{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=Oo.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Gc.INPUT_VALUE)}},Oo.ValueInput$$module$build$src$core$inputs$value_input;var Bd=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new wd(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new kd(this.constants_),this.bottomRow=new hd(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new Td(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let n,i=0;n=t[i];i++){const t=new vd(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}t=void 0;for(let n,i=0;n=this.block_.inputList[i];i++)if(n.isVisible()){this.shouldStartNewRow_(n,t)&&(this.rows.push(e),e=new Td(this.constants_),this.inputRows.push(e));for(let t,i=0;t=n.fieldRow[i];i++)e.elements.push(new gd(this.constants_,t,n));this.addInput_(n,e),t=n}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Ed(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let n=this.topRow.hasLeftSquareCorner(this.block_)?Cd:Md;this.topRow.elements.push(new n(this.constants_)),t?(e=new md(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new xd(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof $d&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,n=this.topRow.hasRightSquareCorner(this.block_)?Cd:Md,this.topRow.elements.push(new n(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof $d?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Cd(this.constants_)):this.bottomRow.elements.push(new Md(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Sd(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Cd(this.constants_,"right")):this.bottomRow.elements.push(new Md(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new bd(this.constants_,e)),t.hasInlineInput=!0):e instanceof $d?(t.elements.push(new yd(this.constants_,e)),t.hasStatement=!0):e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new fd(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Dd||e instanceof Pd)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof Pd||e instanceof $d||t instanceof $d||(e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Dd||t instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e,t=0;e=this.rows[t];t++){const t=e.elements;if(e.elements=[],e.startsWithElemSpacer()&&e.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){e.elements.push(t[n]);const i=this.getInRowSpacing_(t[n],t[n+1]);e.elements.push(new _d(this.constants_,i))}e.elements.push(t[t.length-1]),e.endsWithElemSpacer()&&e.elements.push(new _d(this.constants_,this.getInRowSpacing_(t[t.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&ld.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}return e&&ld.isLeftSquareCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset:e&&ld.isLeftRoundedCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,n=0;for(let r,s=0;r=this.rows[s];s++){if(r.measure(),t=Math.max(t,r.width),r.hasStatement){var i=r.getLastInput();let t,n;i=r.width-(null!=(n=null==(t=i)?void 0:t.width)?n:0),e=Math.max(e,i)}n=Math.max(n,r.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let r,s=0;r=this.rows[s];s++)r.hasStatement&&(r.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t,n=0;t=this.rows[n];n++)if(t.hasStatement)this.alignStatementRow_(t);else{var e=t.width;0<(e=this.getDesiredRowWidth_(t)-e)&&this.addAlignmentPadding_(t,e),ld.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const n=e.getFirstSpacer(),i=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===Oo.Align$$module$build$src$core$inputs$align.LEFT&&i)i.width+=t;else if(e.align===Oo.Align$$module$build$src$core$inputs$align.CENTRE&&n&&i)n.width+=t/2,i.width+=t/2;else if(e.align===Oo.Align$$module$build$src$core$inputs$align.RIGHT&&n)n.width+=t;else{if(!i)return;i.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var n=e.width-t.width,i=this.statementEdge;0<(n=i-n)&&this.addAlignmentPadding_(e,n),n=e.width,i=this.getDesiredRowWidth_(e),t.width+=i-n,t.height=Math.max(t.height,e.height),e.width+=i-n,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var n=this.getSpacerRowHeight_(e,t);const i=this.getSpacerRowWidth_(e,t);return n=new Id(this.constants_,n,i),e.hasStatement&&(n.followsStatement=!0),t.hasStatement&&(n.precedesStatement=!0),n}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return ld.isSpacer(t)?e.yPos+t.height/2:ld.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2):ld.isTopRow(e)?ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let n,i=0;n=e.elements[i];i++)ld.isSpacer(n)&&(n.height=e.height),n.xPos=t,n.centerline=this.getElemCenterline_(e,n),t+=n.width}finalize_(){let e=0,t=0;for(let n,i=0;n=this.rows[i];i++)n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),this.recordElemPositions_(n);if(this.outputConnection&&this.block_.nextConnection){const t=this.block_.nextConnection.targetBlock();t&&(e=Math.max(e,t.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}},Fd=class{constructor(e,t,n){if(this.wsCoordinate=null,!t)throw Error("Cannot create a node without a location.");this.type=e,this.isConnectionLocation=Fd.isConnectionType(e),this.location=t,this.processParams(n||null)}processParams(e){e&&e.wsCoordinate&&(this.wsCoordinate=e.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var e=this.location.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const n=t.inputList[e],i=n.fieldRow;for(let e=0;e<i.length;e++){const t=i[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}if(n.connection)return Fd.createInputNode(n)}return null}findNextForField(){var e=this.location,t=e.getParentInput();const n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var i=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;i<n.inputList.length;i++){const r=(t=n.inputList[i]).fieldRow;for(;e<r.length;){if(r[e].isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(r[e]);e++}if(e=0,t.connection)return Fd.createInputNode(t)}return null}findPrevForInput(){const e=this.location.getParentInput(),t=e.getSourceBlock();for(var n=t.inputList.indexOf(e);0<=n;n--){var i=t.inputList[n];if(i.connection&&i!==e)return Fd.createInputNode(i);for(let e=(i=i.fieldRow).length-1;0<=e;e--){const t=i[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}}return null}findPrevForField(){var e=this.location;const t=e.getParentInput(),n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var i=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=i;i--){var r=n.inputList[i];if(r.connection&&r!==t)return Fd.createInputNode(r);for(r=r.fieldRow;-1<e;){if(r[e].isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(r[e]);e--}0<=i-1&&(e=n.inputList[i-1].fieldRow.length-1)}return null}navigateBetweenStacks(e){var t=this.getLocation();if(t.getSourceBlock){var n=t.getSourceBlock();n&&(t=n)}if(!t||t.isDeadOrDying())return null;n=t.getRootBlock(),t=n.workspace.getTopBlocks(!0);for(let i=0;i<t.length;i++)if(n.id===t[i].id)return-1===(e=i+(e?1:-1))||e===t.length?null:Fd.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock(e){const t=Ts(e);return t?Fd.createConnectionNode(t):Fd.createBlockNode(e)}getOutAstNodeForBlock(e){if(!e)return null;e=e.getTopStackBlock();const t=Ts(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?Fd.createInputNode(t.targetConnection.getParentInput()):Fd.createStackNode(e)}findFirstFieldOrInput(e){e=e.inputList;for(let t=0;t<e.length;t++){const n=e[t],i=n.fieldRow;for(let e=0;e<i.length;e++){const t=i[e];if(t.isClickable()||Fd.NAVIGATE_ALL_FIELDS)return Fd.createFieldNode(t)}if(n.connection)return Fd.createInputNode(n)}return null}getSourceBlock(){return this.getType()===Fd.types.BLOCK||this.getType()===Fd.types.STACK?this.getLocation():this.getType()===Fd.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Fd.types.STACK:return this.navigateBetweenStacks(!0);case Fd.types.OUTPUT:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.FIELD:return this.findNextForField();case Fd.types.INPUT:return this.findNextForInput();case Fd.types.BLOCK:const e=this.location.nextConnection;if(!e)break;return Fd.createConnectionNode(e);case Fd.types.PREVIOUS:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.NEXT:return Fd.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case Fd.types.WORKSPACE:const e=this.location.getTopBlocks(!0);if(0<e.length)return Fd.createStackNode(e[0]);break;case Fd.types.STACK:return this.findTopASTNodeForBlock(this.location);case Fd.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Fd.types.INPUT:return Fd.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Fd.types.STACK:return this.navigateBetweenStacks(!1);case Fd.types.FIELD:return this.findPrevForField();case Fd.types.INPUT:return this.findPrevForInput();case Fd.types.BLOCK:var e=Ts(this.location);if(!e)break;return Fd.createConnectionNode(e);case Fd.types.PREVIOUS:if((e=this.location.targetConnection)&&!e.getParentInput())return Fd.createConnectionNode(e);break;case Fd.types.NEXT:return Fd.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case Fd.types.STACK:var e=this.location,t=e.getRelativeToSurfaceXY();return t=new cl(t.x,t.y+Fd.DEFAULT_OFFSET_Y),Fd.createWorkspaceNode(e.workspace,t);case Fd.types.OUTPUT:return(t=(e=this.location).targetConnection)?Fd.createConnectionNode(t):Fd.createStackNode(e.getSourceBlock());case Fd.types.FIELD:if(!(e=this.location.getSourceBlock()))throw Error("The current AST location is not associated with a block");return Fd.createBlockNode(e);case Fd.types.INPUT:return Fd.createBlockNode(this.location.getSourceBlock());case Fd.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Fd.types.PREVIOUS:case Fd.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(e){switch(e){case Fd.types.PREVIOUS:case Fd.types.NEXT:case Fd.types.INPUT:case Fd.types.OUTPUT:return!0}return!1}static createFieldNode(e){return e?new Fd(Fd.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Gc.INPUT_VALUE||t===Gc.NEXT_STATEMENT&&e.getParentInput()?Fd.createInputNode(e.getParentInput()):t===Gc.NEXT_STATEMENT?new Fd(Fd.types.NEXT,e):t===Gc.OUTPUT_VALUE?new Fd(Fd.types.OUTPUT,e):t===Gc.PREVIOUS_STATEMENT?new Fd(Fd.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new Fd(Fd.types.INPUT,e.connection):null}static createBlockNode(e){return e?new Fd(Fd.types.BLOCK,e):null}static createStackNode(e){return e?new Fd(Fd.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new Fd(Fd.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Ts(e);return t?Fd.createConnectionNode(t):Fd.createBlockNode(e)}};Fd.NAVIGATE_ALL_FIELDS=!1,Fd.DEFAULT_OFFSET_Y=-20,function(e){(e=e.types||(e.types={})).FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(Fd||(Fd={}));var Ud=class extends Ia{constructor(e,t,n,i){let r=e?e.workspace.id:void 0;i&&i.getType()===Fd.types.WORKSPACE&&(r=i.getLocation().id),super(r),this.type=sa,this.blockId=null==e?void 0:e.id,this.oldNode=n||void 0,this.newNode=i,this.isCursor=t}toJson(){const e=super.toJson();if(void 0===this.isCursor)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ud)).isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};e(Bo.EVENT,sa,Ud);var zd="blocklyCursor",Hd="blocklyMarker",Gd=.75,Vd=class{constructor(e,t,n){this.workspace=e,this.marker=n,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=n.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return"cursor"===this.marker.type}createDom(){const e=this.isCursor()?zd:Hd;return this.svgGroup_=ie(bl.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var n=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||n,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent(e,t),void 0!==(e=this.currentMarkerSvg.childNodes[0])&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===Fd.types.BLOCK?this.showWithBlock_(e):e.getType()===Fd.types.OUTPUT?this.showWithOutput_(e):t===Gc.INPUT_VALUE?this.showWithInput_(e):t===Gc.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===Fd.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===Fd.types.FIELD?this.showWithField_(e):e.getType()===Fd.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===Fd.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput(e){const t=(e=e.getSourceBlock()).width;var n=e.height,i=n*Gd;const r=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(n=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,r,i,n)):e.outputConnection?(i=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,n,i)):this.positionBlock_(t,r,i),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput(e)}showWithPrevious_(e){this.showWithBlockPrevOutput(e)}showWithOutput_(e){this.showWithBlockPrevOutput(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){const t=(e=e.getLocation()).getSize().width,n=e.getSize().height;this.positionRect_(0,0,t,n),this.setParent_(e),this.showCurrent_()}showWithInput_(e){const t=(e=e.getLocation()).getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let n=0;t=t.getOffsetInBlock().y;const i=e.getHeightWidth().width;this.workspace.RTL&&(n=-i),this.positionLine_(n,t,i),this.setParent_(e),this.showCurrent_()}showWithStack_(e){var t=(e=e.getLocation()).getHeightWidth();const n=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const i=-this.constants_.CURSOR_STACK_PADDING/2,r=-this.constants_.CURSOR_STACK_PADDING/2;let s=i;this.workspace.RTL&&(s=-(n+i)),this.positionRect_(s,r,n,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,n){if(e=is(-t,n)+os("V",-t)+os("H",e+2*t)+os("V",n),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,n=e.getOffsetInBlock().y;e=ns(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+n+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,n){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x","".concat(e)),this.markerSvgLine_.setAttribute("y","".concat(t)),this.markerSvgLine_.setAttribute("width","".concat(n)),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,n){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=is(e,0)+os("h",-(e-n.width))+os("v",this.constants_.TAB_OFFSET_FROM_TOP)+n.pathDown+os("V",t)+os("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,n,i){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=is(-t,n)+os("V",-t)+os("H",this.constants_.NOTCH_OFFSET_LEFT)+i.pathLeft+os("H",e+2*t)+os("V",n),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,n,i){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x","".concat(e)),this.markerSvgRect_.setAttribute("y","".concat(t)),this.markerSvgRect_.setAttribute("width","".concat(n)),this.markerSvgRect_.setAttribute("height","".concat(i)),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(e,t){const n=t.getSourceBlock();e=new(B(sa))(n,this.isCursor(),e,t),k(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=ie(bl.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=ie(bl.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=ie(bl.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=ie(bl.PATH,{transform:""},this.markerSvg_),this.markerBlock_=ie(bl.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();ie(bl.ANIMATE,e,this.markerSvgLine_),ie(bl.ANIMATE,e,this.markerInput_),ie(bl.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&le(this.svgGroup_)}},Wd=class{constructor(e,t,n){this.markerSvg=this.cursorSvg=null,this.constants=n,this.style=t,this.svgRoot=e,this.svgPath=ie(bl.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?re(this.svgRoot,e):oe(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}},jd=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e}connect_(e){const t=Gc.INPUT_VALUE,n=this.getSourceBlock();var i=e.getSourceBlock();let r,s;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const e=this.stashShadowState(),t=this.targetBlock();t.isShadow()?t.dispose(!1):(this.disconnectInternal(),r=t),this.applyShadowState(e)}N()&&(s=new(B(Oo.MOVE$$module$build$src$core$events$utils))(i),s.setReason(["connect"])),Es(this,e),i.setParent(n),s&&(s.recordNew(),k(s)),r&&(e=this.type===t?r.outputConnection:r.previousConnection)&&((i=jd.getConnectionForOrphanedConnection(i,e))?e.connect(i):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Gc.INPUT_VALUE||this.type===Gc.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=Oo.getGroup$$module$build$src$core$events$utils();t||Oo.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),Oo.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(!t||!n)throw Error("Source connection not connected.");const i=Oo.getGroup$$module$build$src$core$events$utils();let r;i||Oo.setGroup$$module$build$src$core$events$utils(!0),N()&&(r=new(B(Oo.MOVE$$module$build$src$core$events$utils))(n.getSourceBlock()),r.setReason(["disconnect"]));const s=this.targetConnection;s&&(s.targetConnection=null),this.targetConnection=null,e&&n.getSourceBlock().setParent(null),r&&(r.recordNew(),k(r)),n.getSourceBlock().isShadow()||t.respawnShadow_(),Oo.setGroup$$module$build$src$core$events$utils(i)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!this.getSourceBlock().isDeadOrDying()&&(t=null==(n=e.getInput(t))?void 0:n.connection,!((n=this.targetBlock())&&n!==e||!t||t.targetConnection===this)&&(t.isConnected()&&t.disconnect(),t.connect(this),!0));var n}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Pt(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?on(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let n=0;n<t.length;n++)if(t[n].connection===this){e=t[n];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let n,i=0;n=e.inputList[i];i++)if(n.connection===this){t=n;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState(e){let{shadowDom:t,shadowState:n}=e;this.shadowDom=t,this.shadowState=n}setShadowStateInternal(){let{shadowDom:e=null,shadowState:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.shadowDom=e,this.shadowState=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(e){var t=this.getSourceBlock();const n=this.getShadowState(),i=this.getShadowDom();if(t.isDeadOrDying()||!n&&!i)return null;if(n)return mn(n,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(i){if(t=Ht(i,t.workspace),e)if(this.type===Gc.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==Gc.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=Pt(e),this.shadowState=on(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Gc.OUTPUT_VALUE)return ws(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const n=t.getConnectionChecker();return e&&n.canConnect(t,e,!1)?e:null}};jd.CAN_CONNECT=0,jd.REASON_SELF_CONNECTION=1,jd.REASON_WRONG_TYPE=2,jd.REASON_TARGET_NULL=3,jd.REASON_CHECKS_FAILED=4,jd.REASON_DIFFERENT_WORKSPACES=5,jd.REASON_SHADOW_PARENT=6,jd.REASON_DRAG_CHECKS_FAILED=7,jd.REASON_PREVIOUS_AND_OUTPUT=8;var Xd="_TEMP_COLLAPSED_INPUT",Yd="_TEMP_COLLAPSED_FIELD",Kd={COLLAPSED_FIELD_NAME:Yd,COLLAPSED_INPUT_NAME:Xd},qd="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Jd=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,v(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Oo.disable$$module$build$src$core$events$utils(),this.hidePreview(),Oo.enable$$module$build$src$core$events$utils();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const n=e.isSuperior()?t:e,i=this.topBlock.getRootBlock();St().then((()=>{$i(n.getSourceBlock()),setTimeout((()=>{i.bringToFront()}),0)}))}}}update(e,t){const n=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!n,t))||this.shouldUpdatePreviews(n,e))&&(Oo.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(n),this.maybeShowPreview(n),Oo.enable$$module$build$src$core$events$utils())}createMarkerBlock(e){var t=e.type;let n;Oo.disable$$module$build$src$core$events$utils();try{if(n=this.workspace.newBlock(t),n.setInsertionMarker(!0),e.saveExtraState){var i=e.saveExtraState(!0);i&&n.loadExtraState&&n.loadExtraState(i)}else if(e.mutationToDom){const t=e.mutationToDom();t&&n.domToMutation&&n.domToMutation(t)}for(t=0;t<e.inputList.length;t++){const r=e.inputList[t];if(r.name===Xd)continue;const s=n.inputList[t];if(!s)throw Error(qd.replace("%1","an input"));for(i=0;i<r.fieldRow.length;i++){const e=r.fieldRow[i],t=s.fieldRow[i];if(!t)throw Error(qd.replace("%1","a field"));t.setValue(e.getValue())}}for(const e of n.getDescendants(!1))e.setInsertionMarker(!0);n.setCollapsed(e.isCollapsed()),n.setInputsInline(e.getInputsInline()),n.initSvg(),n.getSvgRoot().setAttribute("visibility","hidden")}finally{Oo.enable$$module$build$src$core$events$utils()}return n}initAvailableConnections(){const e=this.topBlock.getConnections_(!1),t=this.topBlock.lastConnectionInStack(!0);return t&&t!==this.topBlock.nextConnection&&(e.push(t),this.lastOnStack=t),e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:n,closest:i}=this.activeCandidate;if(i===e.closest&&n===e.local)return!1;const r=n.x+t.x-i.x;return t=n.y+t.y-i.y,e.radius<Math.sqrt(r*r+t*t)-Oo.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),n=null;for(let i=0;i<this.availableConnections.length;i++){const r=this.availableConnections[i],s=r.closest(t,e);s.connection&&(n={closest:s.connection,local:r,radius:s.radius},t=s.radius)}return n}getStartRadius(){return this.activeCandidate?Oo.config$$module$build$src$core$config.connectingSnapRadius:Oo.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return!(!t||!this.workspace.getComponentManager().hasCapability(t.id,sl.Capability.DELETE_AREA))&&t.wouldDelete(this.topBlock,e)}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t,n=e.closest;n===(null==(t=this.activeCandidate)?void 0:t.closest)||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Jd.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Jd.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Jd.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(e){if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}}else this.hidePreview();this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=null==(e=this.activeCandidate)?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:n}=e;let i,r=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!r)throw Error("Cannot show the insertion marker because there is no insertion marker block");try{i=r.getMatchingConnection(t.getSourceBlock(),t)}catch(l){if(e&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),r=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),r=this.firstMarker=this.createMarkerBlock(this.topBlock)),!r)throw Error("Cannot show the insertion marker because there is no insertion marker block");i=r.getMatchingConnection(t.getSourceBlock(),t)}if(!i)throw Error("Cannot show the insertion marker because there is no associated connection");if(i===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");r.queueRender(),wt(),i.connect(n);const s={x:n.x-i.x,y:n.y-i.y},o=i.getOffsetInBlock().clone(),a=i;St().then((()=>{let e,t;null==(e=r)||e.positionNearConnection(a,s,o),null==(t=r)||t.getSvgRoot().setAttribute("visibility","visible")})),this.markerConnection=i}hideInsertionMarker(){if(this.markerConnection){var e,t=this.markerConnection,n=t.getSourceBlock(),i=n.outputConnection;if(null!=(e=n.previousConnection)&&e.targetConnection||null!=i&&i.targetConnection)n.unplug(!0);else{let e;null==(e=t.targetBlock())||e.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}disposeInsertionMarker(e){if(e){Oo.disable$$module$build$src$core$events$utils();try{e.dispose()}finally{Oo.enable$$module$build$src$core$events$utils()}}}};!function(e){(e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}))[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"}(Jd||(Jd={}));var Zd=Jd.PREVIEW_TYPE,Qd={};Qd.InsertionMarkerManager=Jd,Qd.PreviewType=Zd;var ep=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Rd}makeRenderInfo_(e){return new Bd(this,e)}makeDrawer_(e,t){return new Ld(e,t)}makeMarkerDrawer(e,t){return new Vd(e,this.getConstants(),t)}makePathObject(e,t){return new Wd(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,n){return!!jd.getConnectionForOrphanedConnection(e,n===Gc.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,n){return t.type===Gc.OUTPUT_VALUE||t.type===Gc.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(n,e.targetBlock(),t.type)?Jd.PREVIEW_TYPE.INSERTION_MARKER:Jd.PREVIEW_TYPE.REPLACEMENT_FADE:Jd.PREVIEW_TYPE.INSERTION_MARKER}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},tp={};tp.BottomRow=hd,tp.Connection=dd,tp.ConstantProvider=Rd,tp.Drawer=Ld,tp.ExternalValueInput=fd,tp.Field=gd,tp.Hat=md,tp.Icon=vd,tp.InRowSpacer=_d,tp.InlineInput=bd,tp.InputConnection=pd,tp.InputRow=Td,tp.JaggedEdge=Ed,tp.MarkerSvg=Vd,tp.Measurable=cd,tp.NextConnection=Sd,tp.OutputConnection=wd,tp.PathObject=Wd,tp.PreviousConnection=xd,tp.RenderInfo=Bd,tp.Renderer=ep,tp.RoundCorner=Md,tp.Row=ud,tp.SpacerRow=Id,tp.SquareCorner=Cd,tp.StatementInput=yd,tp.TopRow=kd,tp.Types=ld,tp.init=Is,tp.register=xs,tp.unregister=Ms;var np=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&oe(e,t),(t=this.theme.getClassName())&&re(e,t));for(let n,i=0;n=this.subscribedWorkspaces_[i];i++)n.refreshTheme();for(const[n,i]of this.componentDB)for(const r of i){e=r.element,t=r.propertyName;const i=this.theme&&this.theme.getComponentStyle(n);e.style.setProperty(t,i||"")}for(const n of this.subscribedWorkspaces_)n.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!Q(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,n){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:n}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(n,t||"")}unsubscribe(e){if(e)for(const[t,n]of this.componentDB){for(let t=n.length-1;0<=t;t--)n[t].element===e&&n.splice(t,1);n.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},ip="VARIABLE_DYNAMIC",rp={CATEGORY_NAME:ip};rp.flyoutCategory=As,rp.flyoutCategoryBlocks=Ls,rp.onCreateVariableButtonClick_Colour=Rs,rp.onCreateVariableButtonClick_Number=ks,rp.onCreateVariableButtonClick_String=Cs;var sp=class{canConnect(e,t,n,i){return this.canConnectWithReason(e,t,n,i)===jd.CAN_CONNECT}canConnectWithReason(e,t,n,i){const r=this.doSafetyChecks(e,t);return r!==jd.CAN_CONNECT?r:this.doTypeChecks(e,t)?n&&!this.doDragChecks(e,t,i||0)?jd.REASON_DRAG_CHECKS_FAILED:jd.CAN_CONNECT:jd.REASON_CHECKS_FAILED}getErrorMessage(e,t,n){switch(e){case jd.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case jd.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case jd.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case jd.REASON_TARGET_NULL:return"Target connection is null.";case jd.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+n.getCheck();case jd.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case jd.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case jd.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return jd.REASON_TARGET_NULL;let n,i,r;return e.isSuperior()?(n=e.getSourceBlock(),i=t.getSourceBlock(),r=t):(i=e.getSourceBlock(),n=t.getSourceBlock(),r=e,e=t),n===i?jd.REASON_SELF_CONNECTION:r.type!==Wu[e.type]?jd.REASON_WRONG_TYPE:n.workspace!==i.workspace?jd.REASON_DIFFERENT_WORKSPACES:n.isShadow()&&!i.isShadow()?jd.REASON_SHADOW_PARENT:r.type===Gc.OUTPUT_VALUE&&i.previousConnection&&i.previousConnection.isConnected()||r.type===Gc.PREVIOUS_STATEMENT&&i.outputConnection&&i.outputConnection.isConnected()?jd.REASON_PREVIOUS_AND_OUTPUT:jd.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let n=0;n<e.length;n++)if(-1!==t.indexOf(e[n]))return!0;return!1}doDragChecks(e,t,n){if(e.distanceFrom(t)>n||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case Gc.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Gc.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case Gc.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Gc.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return-1===Wo.indexOf(t)}canConnectToPrevious_(e,t){return!e.targetConnection&&-1===Wo.indexOf(t)&&(!t.targetConnection||!!(e=t.targetBlock()).isInsertionMarker()&&!e.getPreviousBlock())}};e(Bo.CONNECTION_CHECKER,$o,sp);var op=class extends nc{constructor(e){super(e),this.type=Qo,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new op)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};e(Bo.EVENT,Qo,op);var ap=class extends nc{constructor(e,t){super(e),this.type=ea,e&&(this.oldName=e.name,this.newName="undefined"===typeof t?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ap)).oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};e(Bo.EVENT,ea,ap);var lp=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(;0<e.length;)this.deleteVariable(e[0]);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.name!==t){var n=this.getVariable(t,e.type),i=this.workspace.getAllBlocks(!1),r=Oo.getGroup$$module$build$src$core$events$utils();r||Oo.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,n,i):this.renameVariableAndUses_(e,t,i)}finally{Oo.setGroup$$module$build$src$core$events$utils(r)}}}renameVariableById(e,t){const n=this.getVariableById(e);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(n,t)}renameVariableAndUses_(e,t,n){for(k(new(B(ea))(e,t)),e.name=t,t=0;t<n.length;t++)n[t].updateVarName(e)}renameVariableWithConflict_(e,t,n,i){const r=e.type;for(t!==n.name&&this.renameVariableAndUses_(n,t,i),t=0;t<i.length;t++)i[t].renameVarById(e.getId(),n.getId());k(new(B(Qo))(e)),Q(this.variableMap.get(r),e)}createVariable(e,t,n){var i=this.getVariable(e,t);if(i){if(n&&i.getId()!==n)throw Error('Variable "'+e+'" is already in use and its id is "'+i.getId()+'" which conflicts with the passed in id, "'+n+'".');return i}if(n&&this.getVariableById(n))throw Error('Variable id, "'+n+'", is already in use.');return i=n||M(),t=t||"",i=new rc(this.workspace,e,t,i),(e=this.variableMap.get(t)||[]).push(i),this.variableMap.delete(t),this.variableMap.set(t,e),k(new(B(Zo))(i)),i}deleteVariable(e){const t=e.getId(),n=this.variableMap.get(e.type);if(n)for(let i=0;i<n.length;i++)if(n[i].getId()===t){n.splice(i,1),k(new(B(Qo))(e)),0===n.length&&this.variableMap.delete(e.type);break}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var n=t.name;const i=this.getVariableUsesById(e);for(let t,r=0;t=i[r];r++)if("procedures_defnoreturn"===t.type||"procedures_defreturn"===t.type)return e=String(t.getFieldValue("NAME")),n=Oo.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",n).replace("%2",e),void Ke(n);1<i.length?(n=Oo.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(i.length)).replace("%2",n),Je(n,(e=>{e&&t&&this.deleteVariableInternal(t,i)}))):this.deleteVariableInternal(t,i)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const n=Oo.getGroup$$module$build$src$core$events$utils();n||Oo.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);this.deleteVariable(e)}finally{Oo.setGroup$$module$build$src$core$events$utils(n)}}getVariable(e,t){if(t=this.variableMap.get(t||""))for(let n,i=0;n=t[i];i++)if(Oo.Names$$module$build$src$core$names.equals(n.name,e))return n;return null}getVariableById(e){for(const t of this.variableMap.values())for(const n of t)if(n.getId()===e)return n;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const n of e.getPotentialVariableMap().variableMap.keys())t.add(n);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map((e=>e.name))}getVariableUsesById(e){const t=[],n=this.workspace.getAllBlocks(!1);for(let i=0;i<n.length;i++){const r=n[i].getVarModels();if(r)for(let s=0;s<r.length;s++)r[s].getId()===e&&t.push(n[i])}return t}},cp=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Ah,this.potentialVariableMap=null,this.id=M(),d(this),this.options=e||new Th({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(c(Bo.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new lp(this)}dispose(){this.listeners.length=0,this.clear(),p(this)}sortObjects_(e,t){const n=Math.sin(ui(cp.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+n*e.x-(t.y+n*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!Q(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){Q(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects_.bind(this)),e.filter((function(e){return!e.isInsertionMarker()}))):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!Q(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}getAllBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.getTopBlocks(!0);e=[];for(let n=0;n<t.length;n++)e.push(...t[n].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter((function(e){return!e.isInsertionMarker()}))}clear(){this.isClearing=!0;try{const e=Oo.getGroup$$module$build$src$core$events$utils();for(e||Oo.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();Oo.setGroup$$module$build$src$core$events$utils(e),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,n){return this.variableMap.createVariable(e,t,n)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const n in e){if(e[n]>this.remainingCapacityOfType(n))return!1;t+=e[n]}return!(t>this.remainingCapacity())}hasBlockLimits(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,n=e?this.undoStack_:this.redoStack_;const i=t.pop();if(i){for(var r=[i];t.length&&i.group&&i.group===t[t.length-1].group;){const e=t.pop();e&&r.push(e)}for(t=0;t<r.length;t++)n.push(r[t]);r=L(r,e),I(!1);try{for(n=0;n<r.length;n++)r[n].run(e)}finally{I(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,O()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){Q(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let n=0;n<t.length;n++)if(!t[n].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new lp(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return u(e)}static getAll(){return h()}};cp.SCAN_ANGLE=3;var up=100,hp=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var n=new globalThis.Audio}catch(r){return}for(let t=0;t<e.length;t++){const r=e[t],s=r.match(/\.(\w+)$/);if(s&&n.canPlayType("audio/"+s[1])){var i=new globalThis.Audio(r);break}}i&&this.sounds.set(t,i)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch((function(){})):e.pause(),Ka||qa)break}}play(e,t){var n=this.sounds.get(e);n?(e=new Date,null!==this.lastSound_&&e.getTime()-this.lastSound_.getTime()<up||(this.lastSound_=e,(n=Ka||Ya?n:n.cloneNode()).volume=void 0===t?1:t,n.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}},dp=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e)),e=this.createLayer(Uu),re(e,"blocklyBlockCanvas"),e=this.createLayer(zu),re(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=ie(bl.SVG,{class:"blocklyBlockDragSurface",xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1"});return e.append(t),ie(bl.G,{},t)}translateLayers(e,t){let n;e="translate(".concat(e.x,", ").concat(e.y,") scale(").concat(t,")"),null==(n=this.dragLayer)||n.setAttribute("transform",e);for(const[,i]of this.layers)i.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot())}moveOffDragLayer(e,t){this.append(e,t)}append(e,t){let n;this.layers.has(t)||this.createLayer(t),null==(n=this.layers.get(t))||n.appendChild(e.getSvgRoot())}createLayer(e){const t=this.workspace.getSvgGroup(),n=ie(bl.G,{});let i=!1;const r=[...this.layers].sort(((e,t)=>e[0]-t[0]));for(const[s,o]of r)if(e<s){t.insertBefore(n,o),i=!0;break}return i||t.appendChild(n),this.layers.set(e,n),n}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(Uu)}getBubbleLayer(){return this.layers.get(zu)}},pp=20,fp=class extends cp{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(c(Bo.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||fp.setTopLevelWorkspaceMetrics_,this.componentManager=new sl,this.connectionDBList=Wc.init(this.connectionChecker),this.audioManager=new hp(e.parentWorkspace),this.grid=this.options.gridPattern?new mh(this.options.gridPattern,e.gridOptions):null,this.markerManager=new vh(this),lc&&st&&this.registerToolboxCategoryCallback(sc,st),rp&&As&&this.registerToolboxCategoryCallback(ip,As),od&&fs&&(this.registerToolboxCategoryCallback(sd,fs),this.addChangeListener(ms)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new np(this,this.options.theme||yh),this.themeManager_.subscribeWorkspace(this),this.renderer=Is(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new Tl(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=yh),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(e){return!!e.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const e=new(B(ca))(this.getTheme().name,this.id);k(e)}updateBlockStyles_(e){for(let t,n=0;t=e[n];n++){const e=t.getStyleName();e&&t.setStyle(e)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,n=0,i=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(i=this.scale);do{const r=Ie(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(i=1),t+=r.x*i,n+=r.y*i,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new cl(t,n)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Tl(e.width,e.height)}getOriginOffsetInPixels(){return Ce(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if(-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=ie(bl.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=ie(bl.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new dp(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(j(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),j(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(c(Bo.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=c(Bo.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&le(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&le(e.parentNode)}this.resizeHandlerWrapper&&(Y(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=fp.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new jl(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new Th({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(c(Bo.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(c(Bo.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(sl.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),n=[];for(let i,r=0;i=e[r];r++){i.position(t,n);const e=i.getBoundingRectangle();e&&n.push(e)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Re();cl.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const n=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,n.setAttribute("data-cached-width","".concat(e))),null!=t&&(this.cachedParentSvgSize.height=t,n.setAttribute("data-cached-height","".concat(t)))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(N()){var e=this.scale,t=-this.scrollY,n=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(n-this.oldLeft))){var i=new(B(ua))(t,n,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=n,k(i)}}}translate(e,t){let n,i;null==(n=this.layerManager)||n.translateLayers(new cl(e,t),this.scale),null==(i=this.grid)||i.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.isVisible_=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e||this.hideChaff(!0))}render(){for(var e=this.getAllBlocks(!1),t=e.length-1;0<=t;t--)e[t].queueRender();if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].queueRender();St().then((()=>{this.markerManager.updateMarkers()}))}highlightBlock(e,t){if(void 0===t){for(let e,t=0;e=this.highlightedBlocks[t];t++)e.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?-1===this.highlightedBlocks.indexOf(e)&&this.highlightedBlocks.push(e):Q(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(ne("Blockly.WorkspaceSvg.prototype.paste","v10","v11","Blockly.clipboard.paste"),!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Oo.getGroup$$module$build$src$core$events$utils();let n;t||Oo.setGroup$$module$build$src$core$events$utils(!0);try{n=e.type?this.pasteBlock_(null,e):"comment"===e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null)}finally{Oo.setGroup$$module$build$src$core$events$utils(t)}return n}pasteBlock_(e,t){let n;Oo.disable$$module$build$src$core$events$utils();try{let i=0,r=0;if(e){let t,s;n=Ht(e,this),i=parseInt(null!=(t=e.getAttribute("x"))?t:"0"),this.RTL&&(i=-i),r=parseInt(null!=(s=e.getAttribute("y"))?s:"0")}else t&&(n=gn(t,this),i=t.x||10,this.RTL&&(i=this.getWidth()-i),r=t.y||10);if(!isNaN(i)&&!isNaN(r)){let e;do{e=!1;const t=this.getAllBlocks(!1);for(let n,s=0;n=t[s];s++){const t=n.getRelativeToSurfaceXY();if(1>=Math.abs(i-t.x)&&1>=Math.abs(r-t.y)){e=!0;break}}if(!e){const t=n.getConnections_(!1);for(let n,s=0;n=t[s];s++)if(n.closest(Oo.config$$module$build$src$core$config.snapRadius,new cl(i,r)).connection){e=!0;break}}e&&(i=this.RTL?i-Oo.config$$module$build$src$core$config.snapRadius:i+Oo.config$$module$build$src$core$config.snapRadius,r+=2*Oo.config$$module$build$src$core$config.snapRadius)}while(e);n.moveTo(new cl(i,r))}}finally{Oo.enable$$module$build$src$core$events$utils()}return N()&&!n.isShadow()&&k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}pasteWorkspaceComment_(e){let t;Oo.disable$$module$build$src$core$events$utils();try{t=mc.fromXmlRendered(e,this);let n,i,r=parseInt(null!=(n=e.getAttribute("x"))?n:"0"),s=parseInt(null!=(i=e.getAttribute("y"))?i:"0");isNaN(r)||isNaN(s)||(this.RTL&&(r=-r),t.moveBy(r+50,s+50))}finally{Oo.enable$$module$build$src$core$events$utils()}return N()&&cc.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,n){return e=super.createVariable(e,t,n),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(sl.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t,n=0;t=e[n];n++){const e=t.getClientRect();e&&this.dragTargetAreas.push({component:t,clientRect:e})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t,n=0;t=this.dragTargetAreas[n];n++)if(t.clientRect.contains(e.clientX,e.clientY))return t.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){(e=J(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,this.dragDeltaXY=cl.difference(t,e)}moveDrag(e){return(e=J(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,cl.sum(this.dragDeltaXY,e)}isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(gh.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,n=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||n){var i=Z(e);if(Ja)var r=e.metaKey;t&&(e.ctrlKey||r||!n)?(i=-i.y/50,t=J(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,i)):(t=this.scrollX-i.x,n=this.scrollY-i.y,e.shiftKey&&!i.x&&(t=this.scrollX-i.y,n=this.scrollY),this.scroll(t,n)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new yl(0,0,0,0);const t=e[0].getBoundingRectangle();for(let i=1;i<e.length;i++){var n=e[i];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<t.top&&(t.top=n.top),n.bottom>t.bottom&&(t.bottom=n.bottom),n.left<t.left&&(t.left=n.left),n.right>t.right&&(t.right=n.right))}return t}cleanUp(){this.setResizesEnabled(!1),Oo.setGroup$$module$build$src$core$events$utils(!0);const e=this.getTopBlocks(!0);let t=0;for(let n,i=0;n=e[i];i++){if(!n.isMovable())continue;const e=n.getRelativeToSurfaceXY();n.moveBy(-e.x,t-e.y,["cleanup"]),n.snapToGrid(),t=n.getRelativeToSurfaceXY().y+n.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}Oo.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=mu.registry.getContextMenuOptions(mu.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),ei(e,t,this.RTL)}}updateToolbox(e){if(e=Pe(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Fe(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(g(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);const i=this.scale*n;if(this.scale!==i){i>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:i<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var r=this.getCanvas().getCTM(),s=this.getParentSvg().createSVGPoint();s.x=e,s.y=t,e=(s=s.matrixTransform(r.inverse())).x,t=s.y,r=r.translate(e*(1-n),t*(1-n)).scale(n),this.scrollX=r.e,this.scrollY=r.f,this.setScale(i)}}zoomCenter(e){var t=this.getMetrics();let n;this.flyout?(n=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(n=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(n,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var n=this.getBlocksBoundingBox(),i=2*pp,r=n.right-n.left+i;if(n=n.bottom-n.top+i,r){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),r+=this.flyout.getWidth()/this.scale)),t/=r,e/=n,Oo.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{Oo.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){re(this.getCanvas(),"blocklyCanvasTransitioning"),re(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){oe(this.getCanvas(),"blocklyCanvasTransitioning"),oe(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,n=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,n=-n-e.scrollTop,this.scroll(t,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var n=e?this.getBlockById(e):null;if(n){e=n.getRelativeToSurfaceXY(),n=t?{height:n.height,width:n.width}:n.getHeightWidth();var i=this.scale;t=(e.x+(this.RTL?-1:1)*n.width/2)*i,e=(e.y+n.height/2)*i,n=this.getMetrics(),this.scroll(-(t-n.viewWidth/2),-(e-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(!0);const n=this.getMetrics();e=Math.min(e,-n.scrollLeft),t=Math.min(t,-n.scrollTop);const i=n.scrollTop+Math.max(0,n.scrollHeight-n.viewHeight);e=Math.max(e,-(n.scrollLeft+Math.max(0,n.scrollWidth-n.viewWidth))),t=Math.max(t,-i),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+n.scrollLeft),-(t+n.scrollTop),!1),e+=n.absoluteLeft,t+=n.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return super.getAllBlocks(e)}getTopBlocks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){Q(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!==typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!==typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t="pointerdown"===e.type,n=this.currentGesture_;return n?t&&n.hasStarted()?(console.warn("Tried to start the same gesture twice."),n.cancel(),null):n:t?this.currentGesture_=new gh(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];lr(),Gn(),Li(),this.hideComponents(e)}hideComponents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getComponentManager().getComponents(sl.Capability.AUTOHIDEABLE,!0).forEach((t=>t.autoHide(e)))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();"number"===typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"===typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},gp={};gp.WorkspaceSvg=fp,gp.resizeSvgContents=Os;var mp=class extends Ia{constructor(e,t){super(t),this.type=aa,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new mp)).isOpen=e.isOpen,t}};e(Bo.EVENT,aa,mp);var vp=class extends Bc{constructor(e){if(super(e),this.type=Oo.DELETE$$module$build$src$core$events$utils,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Ot(e),this.ids=P(e),this.wasShadow=e.isShadow(),this.oldJson=on(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=Bt(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new vp)).oldXml=Oo.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const n=this.ids[e],i=t.getBlockById(n);i?i.dispose(!1):n===this.blockId&&console.warn("Can't delete non-existent block: "+n)}else gn(this.oldJson,t)}};e(Bo.EVENT,Oo.DELETE$$module$build$src$core$events$utils,vp);var _p=class{constructor(e,t,n){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.isInsertionMarker_=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=n&&!e.getBlockById(n)?n:M(),e.setBlockById(this.id,this),this.xy_=new cl(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(n=Ho[t])||"object"!==typeof n)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,n)}e.addTopBlock(this),e.addTypedBlock(this),new.target===_p&&this.doInit_()}doInit_(){const e=Oo.getGroup$$module$build$src$core$events$utils();e||Oo.setGroup$$module$build$src$core$events$utils(!0);const t=C();try{"function"===typeof this.init&&(I(!1),this.init(),I(t)),N()&&k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(this))}finally{Oo.setGroup$$module$build$src$core$events$utils(e),I(t)}this.inputsInlineDefault=this.inputsInline,"function"===typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),N()&&k(new(B(Oo.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,"function"===typeof this.destroy&&this.destroy(),this.childBlocks_.forEach((e=>e.disposeInternal())),this.inputList.forEach((e=>e.dispose())),this.inputList.length=0,this.getConnections_(!0).forEach((e=>e.dispose())),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const e of this.inputList)for(const t of e.fieldRow)t.initModel&&t.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t,n=null;null!=(t=this.outputConnection)&&t.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null==(e=e.targetConnection)||e.disconnect(),this.workspace.connectionChecker.canConnect(e,n,!1)?n.connect(e):null==e||e.onFailedConnect(n))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const n=this.inputList[t].connection;if(n&&n.type===Gc.INPUT_VALUE&&n.targetConnection){if(e)return null;e=n}}return e}unplugFromStack_(e){let t=null;var n;if(null!=(n=this.previousConnection)&&n.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),n=this.getNextBlock(),e&&n&&!n.isShadow()){let n,i;null==(e=null!=(i=null==(n=this.nextConnection)?void 0:n.targetConnection)?i:null)||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t,n=0;t=this.inputList[n];n++)t.connection&&e.push(t.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const n=t.targetBlock();if(!n||e&&n.isShadow())return t;t=n.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t,n=0;t=this.inputList[n];n++)if(t.connection&&t.connection.targetBlock()===e)return t;return null}getSurroundParent(){let e,t=this;do{if(e=t,t=t.getParent(),!t)return null}while(t.getNextBlock()===e);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{e=t,t=e.parentBlock_}while(t);return e}getTopStackBlock(){let e,t=this;do{e=t.getPreviousBlock()}while(e&&e.getNextBlock()===t&&(t=e));return t}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let n,i=0;n=this.inputList[i];i++)if(n.connection){var t=n.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),n=!!t;if(n&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!n&&e)throw Error("Block not connected to new parent.");if(n&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Q(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],n=this.getChildren(e);for(let i,r=0;i=n[r];r++)t.push(...i.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(e){this.movable_=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(T(this,!0))}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(e){this.editable_=e;for(let t,n=0;t=this.inputList[n];n++)for(let e,i=0;e=t.fieldRow[i];i++)e.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){const n=this.getConnections_(!0);if(e=e.getConnections_(!0),n.length!==e.length)throw Error("Connection lists did not match in length.");for(let i=0;i<e.length;i++)if(e[i]===t)return n[i];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Qi(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=Ar(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!==typeof e)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if("string"!==typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(let t,n=0;t=this.inputList[n];n++)for(let i,r=0;i=t.fieldRow[r];r++)if(i.name===e)return i;return null}getVars(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let i,r=0;i=t.fieldRow[r];r++)i.referencesVariables()&&e.push(i.getValue());return e}getVarModels(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let i,r=0;i=t.fieldRow[r];r++)if(i.referencesVariables()){const t=this.workspace.getVariableById(i.getValue());t&&e.push(t)}return e}updateVarName(e){for(let t,n=0;t=this.inputList[n];n++)for(let i,r=0;i=t.fieldRow[r];r++)i.referencesVariables()&&e.getId()===i.getValue()&&i.refreshVariableName()}renameVarById(e,t){for(let n,i=0;n=this.inputList[i];i++)for(let r,s=0;r=n.fieldRow[s];s++)r.referencesVariables()&&e===r.getValue()&&r.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const n=this.getField(t);if(!n)throw Error('Field "'+t+'" not found.');n.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Gc.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Gc.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Gc.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Dd&&this.inputList[e]instanceof Dd)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Dd)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof Pd)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let i=2;i<t.length;i++)"("===t[i-2]&&")"===t[i]&&(t[i-2]=t[i-1],t.splice(i-1,2));let n="";return t=(t=t.reduce(((e,t)=>(e=e+("("===n||")"===t?"":" ")+t,n=t[t.length-1],e)),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"?";const t=[];for(const i of this.inputList)if(i.name!=Xd){for(const e of i.fieldRow)t.push(e.getText());if(i.connection){const r=i.connection.targetBlock();if(r){var n=i.connection;let s=n.getCheck();!s&&n.targetConnection&&(s=n.targetConnection.getCheck()),(n=!!s&&(-1!==s.indexOf("Boolean")||-1!==s.indexOf("Number")))&&t.push("("),t.push(...r.toTokens(e)),n&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new Oo.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new $d(e,this))}appendDummyInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.appendInput(new Dd(e,this))}appendEndRowInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.appendInput(new Pd(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=o(Bo.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var n=0;e["args"+n];){if(void 0===e["message"+n])throw Error(t+"args".concat(n," must have a corresponding message (message").concat(n,")."));n++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t),n=0;void 0!==e["message"+n];)this.interpolate_(e["message"+n],e["args"+n]||[],e["implicitAlign"+n]||e["lastDummyAlign"+n],t),n++;if(void 0!==e.inputsInline&&(Oo.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),Oo.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(n=kr(e.tooltip),this.setTooltip(n)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(n=kr(e.helpUrl),this.setHelpUrl(n)),"string"===typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Hr(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Hr(e[t],this,!1)}jsonInitColour_(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(n){console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch(n){console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!==typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const n in e)void 0!==this[n]&&t.push(n);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,n,i){e=Cr(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,n),n=[];for(let r,s=0;r=t[s];s++)if(this.isInputKeyword_(r.type)){if(e=this.inputFromJson_(r,i)){for(let t,i=0;t=n[i];i++)e.appendField(t[0],t[1]);n.length=0}}else(e=this.fieldFromJson_(r))&&n.push([e,r.name])}validateTokens_(e,t){const n=[];let i=0;for(let r=0;r<e.length;r++){const s=e[r];if("number"===typeof s){if(1>s||s>t)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(n[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");n[s]=!0,i++}}if(i!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,n){const i=[];for(let s=0;s<e.length;s++){var r=e[s];if("number"===typeof r&&(r=t[r-1]),"string"===typeof r)if("\n"===r)r={type:"input_end_row"},n&&(r.align=n);else if(!(r=this.stringToFieldJson_(r)))continue;i.push(r)}return(e=i.length)&&!this.isInputKeyword_(i[e-1].type)&&(e={type:"input_dummy"},n&&(e.align=n),i.push(e)),i}fieldFromJson_(e){const t=Oo.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"===typeof e.alt?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var n={LEFT:Oo.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:Oo.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:Oo.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:Oo.Align$$module$build$src$core$inputs$align.CENTRE};let i;switch(e.type){case"input_value":i=this.appendValueInput(e.name);break;case"input_statement":i=this.appendStatementInput(e.name);break;case"input_dummy":i=this.appendDummyInput(e.name);break;case"input_end_row":i=this.appendEndRowInput(e.name);break;default:i=this.appendInputFromRegistry(e.type,e.name)}return i?(e.check&&i.setCheck(e.check),e.align&&(void 0===(n=n[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):i.setAlign(n)),i):null}isInputKeyword_(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||s(Bo.INPUT,e)}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var n=-1,i=t?-1:this.inputList.length;for(let r,s=0;r=this.inputList[s];s++)if(r.name===e){if(n=s,-1!==i)break}else if(t&&r.name===t&&(i=s,-1!==n))break;if(-1===n)throw Error('Named input "'+e+'" not found.');if(-1===i)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(n,i)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const n=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,n)}removeInput(e,t){for(let n,i=0;n=this.inputList[i];i++)if(n.name===e)return n instanceof $d&&this.statementInputCount--,n.dispose(),this.inputList.splice(i,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(ed.TYPE))?void 0:e.getText())?t:null}setCommentText(e){var t;let n;const i=null!=(n=null==(t=this.getIcon(ed.TYPE))?void 0:t.getText())?n:null;i!==e&&(null!==e?((t=this.getIcon(ed.TYPE))||(t=this.addIcon(new ed(this))),Oo.disable$$module$build$src$core$events$utils(),t.setText(e),Oo.enable$$module$build$src$core$events$utils()):this.removeIcon(ed.TYPE),k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,i,e)))}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new id(e);return this.icons.push(e),this.icons.sort(((e,t)=>e.getWeight()-t.getWeight())),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter((t=>!t.getType().equals(e))),!0}hasIcon(e){return this.icons.some((t=>t.getType().equals(e)))}getIcon(e){return e instanceof Xl?this.icons.find((t=>t.getType().equals(e))):this.icons.find((t=>t.getType().toString()===e))}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const i=new(B(Oo.MOVE$$module$build$src$core$events$utils))(this);n&&i.setReason(n),this.xy_.translate(e,t),i.recordNew(),k(i)}makeConnection_(e){return new jd(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let n,i=0;n=this.inputList[i];i++)if(n.connection){var t=n.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};_p.COLLAPSED_INPUT_NAME=Xd,_p.COLLAPSED_FIELD_NAME=Yd;var bp=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(e){this.drawer=e}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(e){const t=this.curNode;this.curNode=e,this.drawer&&this.drawer.draw(t,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},yp=class extends bp{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===Fd.types.NEXT||e.getType()===Fd.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;let t,n;return e.getType()!==Fd.types.PREVIOUS&&e.getType()!==Fd.types.OUTPUT||(e=e.next()),(e=null!=(n=null==(t=e)?void 0:t.in())?n:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===Fd.types.NEXT||e.getType()===Fd.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===Fd.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};e(Bo.CURSOR,$o,yp);var Tp=class extends yp{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const n=e.in()||e.next();return t(n)?n:n?this.getNextNode_(n,t):t(e=this.findSiblingOrParent(e.out()))?e:e?this.getNextNode_(e,t):null}getPreviousNode_(e,t){if(!e)return null;let n=e.prev();return n=n?this.getRightMostChild(n):e.out(),t(n)?n:n?this.getPreviousNode_(n,t):null}validNode_(e){let t=!1;return(e=e&&e.getType())!==Fd.types.OUTPUT&&e!==Fd.types.INPUT&&e!==Fd.types.FIELD&&e!==Fd.types.NEXT&&e!==Fd.types.PREVIOUS&&e!==Fd.types.WORKSPACE||(t=!0),t}findSiblingOrParent(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent(e.out())}getRightMostChild(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild(e)}};Tp.registrationName="basicCursor",e(Bo.CURSOR,Tp.registrationName,Tp);var Ep=class extends Tp{validNode_(e){let t=!1;const n=e&&e.getType();return e&&(e=e.getLocation(),n===Fd.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=!0)),t}},Sp=10,wp=class extends jd{constructor(e,t){super(e,t),this.targetConnection=this.highlightPath=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Wu[t]],this.offsetInBlock=new cl(0,0),this.trackedState=wp.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===wp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.highlightPath&&(le(this.highlightPath),this.highlightPath=null)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var n=!1;if(!t.isMovable()){if(!(t=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,n=!0}var i=m()==t;i||t.addSelect();var r=e.x+Oo.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Sp)-this.x,s=e.y+Oo.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Sp)-this.y;n&&(s=-s),t.RTL&&(r=e.x-Oo.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*Sp)-this.x),t.moveBy(r,s,["bump"]),i||t.removeSelect()}}}moveTo(e,t){let n=!1;return this.trackedState===wp.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=wp.TrackedState.TRACKED,n=!0):this.trackedState===wp.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),n=!0),this.x=e,this.y=t,n}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=cl.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){if(!this.highlightPath){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),t=e.shapeFor(this);this.type===Gc.INPUT_VALUE||this.type===Gc.OUTPUT_VALUE?(e=e.TAB_OFFSET_FROM_TOP,t=is(0,-e)+os("v",e)+t.pathDown+os("v",e)):(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS,t=is(-e,0)+os("h",e)+t.pathLeft+os("h",e)),e=this.offsetInBlock,this.highlightPath=ie(bl.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate(".concat(e.x,", ").concat(e.y,")")+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(le(this.highlightPath),this.highlightPath=null)}setTracking(e){e&&this.trackedState===wp.TrackedState.TRACKED||!e&&this.trackedState===wp.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=wp.TrackedState.TRACKED):(this.trackedState===wp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=wp.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const n=e[t],i=n.getConnections_(!0);for(let e=0;e<i.length;e++)i[e].setTracking(!1);for(const e of n.getIcons())mr(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==Gc.INPUT_VALUE&&this.type!==Gc.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let n;t.isCollapsed()?(n=[],t.outputConnection&&n.push(t.outputConnection),t.nextConnection&&n.push(t.nextConnection),t.previousConnection&&n.push(t.previousConnection)):n=t.getConnections_(!0);for(let t=0;t<n.length;t++)e.push(...n[t].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(C()){const n=Oo.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(Oo.setGroup$$module$build$src$core$events$utils(n),this.bumpAwayFrom(e),Oo.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),Oo.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(t&&n){var i=t.getSourceBlock(),r=n.getSourceBlock();super.disconnectInternal(e),i.rendered&&i.queueRender(),r.rendered&&(r.updateDisabled(),r.queueRender(),r.getSvgRoot().style.display="block")}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const n=t.rendered,i=e.rendered;n&&t.updateDisabled(),i&&e.updateDisabled(),n&&i&&(this.type===Gc.NEXT_STATEMENT||this.type===Gc.PREVIOUS_STATEMENT?e.queueRender():t.queueRender()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(e){return super.setCheck(e),this.sourceBlock_.rendered&&this.sourceBlock_.queueRender(),this}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(wp||(wp={}));var xp=wp.TrackedState,Mp={};Mp.RenderedConnection=wp,Mp.TrackedState=xp;var Ip=class extends _p{constructor(e,t,n){super(e,t,n),this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1,this.translation="",this.bumpNeighboursPid=0,this.dragging=!1,this.relativeCoords=new cl(0,0),this.workspace=e,this.svgGroup_=ie(bl.G,{}),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),(e=this.pathObject.svgPath).tooltip=this,nr(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let t,n=0;t=this.inputList[n];n++)t.init();for(var e of this.getIcons())e.initView(this.createIconPointerDownListener(e)),e.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||j(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(m()!==this){var e=null;if(m()){e=m().id,Oo.disable$$module$build$src$core$events$utils();try{m().unselect()}finally{Oo.enable$$module$build$src$core$events$utils()}}e=new(B(ia))(e,this.id,this.workspace.id),k(e),v(this),this.addSelect()}}unselect(){if(m()===this){var e=new(B(ia))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,k(e),v(null),this.removeSelect()}}setParent(e){const t=this.parentBlock_;if(e!==t){de(),super.setParent(e),pe();var n=this.getSvgRoot();if(!this.workspace.isClearing&&n){var i=this.getRelativeToSurfaceXY();e?e.getSvgRoot().appendChild(n):t&&((e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(n,e):this.workspace.getCanvas().appendChild(n),this.translate(i.x,i.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,i=this.getSvgRoot();if(i)do{const e=Ie(i);t+=e.x,n+=e.y,i=i.parentNode}while(i&&!e.hasLayer(i));return new cl(t,n)}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const i=N();let r=null;i&&(r=new(B(Oo.MOVE$$module$build$src$core$events$utils))(this),n&&r.setReason(n)),e=new cl(e,t),t=this.getRelativeToSurfaceXY(),e=cl.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),i&&r&&(r.recordNew(),k(r)),this.workspace.resizeContents()}translate(e,t){this.translation="translate(".concat(e,", ").concat(t,")"),this.relativeCoords=new cl(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const n=this.getRelativeToSurfaceXY();this.moveBy(e.x-n.x,e.y-n.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),n=t/2,i=this.getRelativeToSurfaceXY();e=Math.round(Math.round((i.x-n)/t)*t+n-i.x),t=Math.round(Math.round((i.y-n)/t)*t+n-i.y),(e||t)&&this.moveBy(e,t,["snap"])}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let n,i;return this.RTL?(n=e.x-t.width,i=e.x):(n=e.x,i=e.x+t.width),new yl(e.y,e.y+t.height,n,i)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e,t=0;e=this.inputList[t];t++)e.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t=Xd,n=Yd;for(let r,s=0;r=this.inputList[s];s++)r.name!==t&&r.setVisible(!e);for(var i of this.getIcons())i.updateCollapsed();e?(e=this.toString(Gu),(i=this.getField(n))?i.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Od(e),n)):(this.updateDisabled(),this.removeInput(t))}tab(e,t){const n=new Ep;n.setCurNode(Fd.createFieldNode(e)),e=n.getCurNode(),t?n.next():n.prev(),(t=n.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e="function"===typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=mu.registry.getContextMenuOptions(mu.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(ei(e,t,this.RTL),Qn(this))}updateComponentLocations(e){if(this.rendered){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(cl.sum(e,t.relativeCoords))}}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const n of t.fieldRow)n.onLocationChange(e)}setDragging(e){(this.dragging=e)?(this.translation="",Wo.push(...this.getConnections_(!0)),re(this.svgGroup_,"blocklyDragging")):(Wo.length=0,oe(this.svgGroup_,"blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(e,t){this.isDeadOrDying()||(ar(),si(),t&&this.rendered&&(this.unplug(e),Di(this)),super.dispose(!!e),le(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,m()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach((e=>clearTimeout(e))),this.warningTextDb.clear(),this.getIcons().forEach((e=>e.dispose())))}checkAndDelete(){this.workspace.isFlyout||(Oo.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),Oo.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:jc.TYPE,blockState:on(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:T(this,!0)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t,n=0;t=this.inputList[n];n++)for(let e,i=0;e=t.fieldRow[i];i++)e.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let e;null==(e=this.getNextBlock())||e.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const e of this.getChildren(!1))e.updateDisabled()}}getCommentIcon(){let e;return ne("getCommentIcon","v10","v11","getIcon"),null!=(e=this.getIcon(ed.TYPE))?e:null}setWarningText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var n of this.warningTextDb.values())clearTimeout(n);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout((()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))}),100));else if(this.isInFlyout&&(e=null),n=this.getIcon(nd.TYPE),e){let i=this.getSurroundParent(),r=null;for(;i;)i.isCollapsed()&&(r=i),i=i.getSurroundParent();r&&r.setWarningText(Oo.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Ip.COLLAPSED_WARNING_ID),n?n.addMessage(e,t):this.addIcon(new nd(this).addMessage(e,t))}else n&&(t?(n.addMessage("",t),n.getText()||this.removeIcon(nd.TYPE)):this.removeIcon(nd.TYPE))}setMutator(e){this.removeIcon(Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof nd&&(this.warning=e),e instanceof Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),this.rendered&&(e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),wt(),this.bumpNeighbours()),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(nd.TYPE)&&(this.warning=null),e.equals(Oo.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.rendered&&(this.queueRender(),wt(),this.bumpNeighbours()),t}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,!t)throw Error("Invalid style name: "+e);this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour()}bringToFront(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(!t.isDeadOrDying())do{const n=t.getSvgRoot(),i=n.parentNode,r=i.childNodes;if(r[r.length-1]!==n&&i.appendChild(n),e)break;t=t.getParent()}while(t)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(e){return super.appendInput(e),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var n=this.inputList[t].connection;n&&(n.setTracking(e),(n=n.targetBlock())&&n.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let n,i=0;n=this.inputList[i];i++)n.connection&&t.push(n.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new wp(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var e=Oo.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout((()=>{const t=Oo.getGroup$$module$build$src$core$events$utils();Oo.setGroup$$module$build$src$core$events$utils(e),this.getRootBlock().bumpNeighboursInternal(),Oo.setGroup$$module$build$src$core$events$utils(t),this.bumpNeighboursPid=0}),Oo.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let e;null==(e=t.targetBlock())||e.bumpNeighboursInternal()}for(const n of t.neighbours(Oo.config$$module$build$src$core$config.snapRadius))n.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&n.isConnected()||(t.isSuperior()?n.bumpAwayFrom(t):t.bumpAwayFrom(n)))}}scheduleSnapAndBump(){const e=Oo.getGroup$$module$build$src$core$events$utils();setTimeout((()=>{Oo.setGroup$$module$build$src$core$events$utils(e),this.snapToGrid(),Oo.setGroup$$module$build$src$core$events$utils(!1)}),Oo.config$$module$build$src$core$config.bumpDelay/2),this.bumpNeighbours()}positionNearConnection(e,t,n){if(e.type===Gc.NEXT_STATEMENT||e.type===Gc.INPUT_VALUE){let i=t.x;t=t.y,i+=n.x-e.getOffsetInBlock().x,t+=n.y-e.getOffsetInBlock().y,this.moveBy(i,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Et(this)}render(){this.queueRender(),wt()}renderEfficiently(){this.rendered=!0,de(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),pe(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(vh.LOCAL_MARKER).draw();for(const e of this.inputList)for(const t of e.fieldRow)t.updateMarkers_()}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var n=this.getNextBlock();if(n){n=n.getHeightWidth();const i=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=n.height-i,t=Math.max(t,n.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Ip.INLINE=-1,Ip.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Cp,kp=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Rp=class extends kp{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e,t){return e instanceof Ip?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Ap=class extends Rp{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=new Th({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Pl.TOP?Pl.BOTTOM:Pl.TOP,this.flyout=new(c(Bo.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Pl.RIGHT?Pl.LEFT:Pl.RIGHT,this.flyout=new(c(Bo.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=ie(bl.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=ie(bl.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),ie(bl.RECT,{width:Lp,height:Op,y:Np},e);const n=ie(bl.IMAGE,{width:Wl.width,x:-Bp,height:Wl.height,y:-Fp,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return n.setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),e=ie(bl.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),ie(bl.RECT,{width:Lp,height:Np},e),this.svgLid=ie(bl.IMAGE,{width:Wl.width,x:-Bp,height:Wl.height,y:-Fp,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(fl,"xlink:href",this.workspace.options.pathToMedia+Wl.url),X(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),X(this.svgGroup,"pointerup",this,this.click),X(n,"pointerover",this,this.mouseOver),X(n,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(ce(this.flyout.createDom(bl.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[sl.Capability.AUTOHIDEABLE,sl.Capability.DELETE_AREA,sl.Capability.DRAG_TARGET,sl.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&le(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map((function(e){return JSON.parse(e)})),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout((()=>{let n,i;null==(n=this.flyout)||n.show(e),t.cursor="",null==(i=this.workspace.scrollbar)||i.setVisible(!1)}),10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var n,i=Xe(this.workspace,e);e=je(i,new Tl(Lp,Op+Np),Pp,Dp,e,this.workspace),t=Ye(e,Dp,i.vertical===Fl.TOP?zl.DOWN:zl.UP,t),this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new yl(this.top,this.top+Op+Np,this.left,this.left+Lp)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Fp-$p;return e=e.left+Bp-$p,new yl(t,t+Np+Op+2*$p,e,e+Lp+2*$p)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=Hp;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Wp),t=Gp+this.lidOpen*(Vp-Gp),this.svgGroup&&(this.svgGroup.style.opacity="".concat(t)),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),zp/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Pl.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let n;null==(n=this.svgLid)||n.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Lp-4)+","+(Np-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Wp)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(B(aa))(e,this.workspace.id),k(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==Oo.DELETE$$module$build$src$core$events$utils||e.type!==Oo.DELETE$$module$build$src$core$events$utils||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),-1===this.contents.indexOf(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Up)}}}cleanBlockJson(e){function t(e){if(e){if(delete e.id,delete e.x,delete e.y,delete e.enabled,e.icons&&e.icons.comment){var n=e.icons.comment;delete n.height,delete n.width,delete n.pinned}for(var i in n=e.inputs){var r=n[i];const e=r.block;r=r.shadow,e&&t(e),r&&t(r)}e.next&&(e=(i=e.next).block,i=i.shadow,e&&t(e),i&&t(i))}}return t(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},Lp=47,Op=44,Np=16,Dp=20,Pp=20,$p=10,Bp=0,Fp=32,Up=.1,zp=80,Hp=4,Gp=.4,Vp=.8,Wp=45,jp=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error('Shortcut named "'.concat(e.name,'" already exists.'));if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let n=0;n<t.length;n++)this.addKeyMapping(t[n],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn('Keyboard shortcut named "'.concat(e,'" not found.')),!1)}addKeyMapping(e,t,n){e="".concat(e);const i=this.keyMap.get(e);if(i&&!n)throw Error('Shortcut named "'.concat(t,'" collides with shortcuts "').concat(i,'"'));i&&n?i.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,n){const i=this.keyMap.get(e);if(!i)return n||console.warn('No keyboard shortcut named "'.concat(t,'" registered with key code "').concat(e,'"')),!1;const r=i.indexOf(t);return-1<r?(i.splice(r,1),0===i.length&&this.keyMap.delete(e),!0):(n||console.warn('No keyboard shortcut named "'.concat(t,'" registered with key code "').concat(e,'"')),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,n]of this.keyMap)e[t]=n;return e}getRegistry(){const e=Object.create(null);for(const[t,n]of this.shortcuts)e[t]=n;return gr(Object.create(null),e)}onKeyDown(e,t){var n=this.serializeKeyEvent_(t);if(!(n=this.getShortcutNamesByKeyCode(n)))return!1;for(let i,r=0;i=n[r];r++){const n=this.shortcuts.get(i);let r,s;if(null==(r=n)||!r.preconditionFn||null!=(s=n)&&s.preconditionFn(e)){let i,r;if(null!=(i=n)&&i.callback&&null!=(r=n)&&r.callback(e,t,n))return!0}}return!1}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[n,i]of this.keyMap)-1<i.indexOf(e)&&t.push(n);return t}serializeKeyEvent_(e){let t="";for(const n in jp.modifierKeys)e.getModifierState(n)&&(""!==t&&(t+="+"),t+=n);return""!==t&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers_(e){for(let t,n=0;t=e[n];n++)if(!(t in jp.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let n="";if(t){this.checkModifiers_(t);for(const e in jp.modifierKeys)-1<t.indexOf(jp.modifierKeys[e])&&(""!==n&&(n+="+"),n+=e)}return""!==n&&e?n=n+"+"+e:e&&(n="".concat(e)),n}};jp.registry=new jp,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(jp||(jp={})),function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"}(Cp||(Cp={}));var Xp=null,Yp=null;Hs();var Kp={};Kp.names=Cp,Kp.registerCopy=$s,Kp.registerCut=Bs,Kp.registerDefaultShortcuts=Hs,Kp.registerDelete=Ps,Kp.registerEscape=Ds,Kp.registerPaste=Fs,Kp.registerRedo=zs,Kp.registerUndo=Us;var qp=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Lc}save(e){return(e=e.getProcedureMap().getProcedures().map((e=>Gs(e)))).length?e:null}load(e,t){const n=t.getProcedureMap();for(const i of e)n.add(Ws(this.procedureModelClass,this.parameterModelClass,i,t))}clear(e){e.getProcedureMap().clear()}},Jp={};Jp.ProcedureSerializer=qp,Jp.loadParameter=js,Jp.loadProcedure=Ws,Jp.saveParameter=Vs,Jp.saveProcedure=Gs;var Zp=class{constructor(){this.priority=Ac}save(e){const t=[];for(const n of e.getAllVariables())e={name:n.name,id:n.getId()},n.type&&(e.type=n.type),t.push(e);return t.length?t:null}load(e,t){for(const n of e)t.createVariable(n.name,n.type,n.id)}clear(e){e.getVariableMap().clear()}};rn("variables",new Zp);var Qp={};Qp.VariableSerializer=Zp;var ef={};ef.load=Ys,ef.save=Xs;var tf={blocks:$c,exceptions:Rc,priorities:Nc,procedures:Jp,registry:Dc,variables:Qp,workspaces:ef},nf=class{constructor(e,t,n,i,r){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,n=void 0===n||n;const s=(t=void 0===t||t)&&n;t&&(this.hScroll=new Il(e,!0,s,i,r)),n&&(this.vScroll=new Il(e,!1,s,i,r)),s&&(this.corner_=ie(bl.RECT,{height:Il.scrollbarThickness,width:Il.scrollbarThickness,class:"blocklyScrollbarBackground"}),ce(this.corner_,e.getBubbleCanvas()))}dispose(){le(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,n=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(n=!0)):n=t=!0,t||n){try{Oo.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&n&&this.vScroll.resize(e)}finally{Oo.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let e;null==(e=this.corner_)||e.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let e;null==(e=this.corner_)||e.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,n){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(n||void 0===n)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},rf=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,n=0;return e&&(t=e.getWidth(),n=e.getHeight()),new Tl(t,n)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const n=this.getToolboxMetrics(),i=this.getFlyoutMetrics(),r=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=r?n.position:i.position)===Pl.TOP;return s===Pl.LEFT&&(r&&(e+=n.width),o&&(e+=i.width)),a&&(r&&(t+=n.height),o&&(t+=i.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),n=this.getToolboxMetrics(),i=this.getFlyoutMetrics(),r=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=r?n.position:i.position)===Pl.LEFT||s===Pl.RIGHT;return s!==Pl.TOP&&s!==Pl.BOTTOM||(r&&(t.height-=n.height),o&&(t.height-=i.height)),a&&(r&&(t.width-=n.width),o&&(t.width-=i.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),n=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const i={};return n||(i.top=e.top,i.bottom=e.top+e.height),t||(i.left=e.left,i.right=e.left+e.width),i}getPaddedContent_(e,t){const n=t.top+t.height,i=t.left+t.width,r=e.width,s=r/2,o=(e=e.height)/2;return{top:Math.min(t.top-o,n-e),bottom:Math.max(n+o,t.top+e),left:Math.min(t.left-s,i-r),right:Math.max(i+s,t.left+r)}}getScrollMetrics(e,t,n){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var i=n||this.getContentMetrics();n=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,i),i=void 0!==n.top?n.top:t.top;const r=void 0!==n.left?n.left:t.left;return{top:i/e,left:r/e,width:((void 0!==n.right?n.right:t.right)-r)/e,height:((void 0!==n.bottom?n.bottom:t.bottom)-i)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),n=this.getSvgMetrics(),i=this.getAbsoluteMetrics(),r=this.getViewMetrics(),s=this.getContentMetrics(),o=this.getScrollMetrics(!1,r,s);return{contentHeight:s.height,contentWidth:s.width,contentTop:s.top,contentLeft:s.left,scrollHeight:o.height,scrollWidth:o.width,scrollTop:o.top,scrollLeft:o.left,viewHeight:r.height,viewWidth:r.width,viewTop:r.top,viewLeft:r.left,absoluteTop:i.top,absoluteLeft:i.left,svgHeight:n.height,svgWidth:n.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};e(Bo.METRICS_MANAGER,$o,rf);var sf=class extends Ma{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=ga,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};e(Bo.EVENT,ga,sf);var of=class extends Ia{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=na,e&&(this.blockId=e.id,this.isStart=t,this.blocks=n)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new of)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};e(Bo.EVENT,na,of);var af={};af.bumpIntoBounds=Ks,af.bumpIntoBoundsHandler=qs,af.bumpTopObjectsIntoBounds=Zs;var lf=class{constructor(e,t){this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.dragIconData_=[],this.draggingBlock_=e,this.draggedConnectionManager_=new Jd(this.draggingBlock_),this.workspace_=t,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=Qs(e,this.startXY_)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(e,t){let n;Oo.getGroup$$module$build$src$core$events$utils()||Oo.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent_(),this.draggingBlock_.bringToFront(!0),de(),this.workspace_.setResizesEnabled(!1),Ui(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(!0),null==(n=this.workspace_.getLayerManager())||n.moveToDragLayer(this.draggingBlock_)}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=cl.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),Bi(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const e=new(B(na))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));k(e)}drag(e,t){t=this.pixelsToWorkspaceUnits_(t);var n=cl.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(n),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(t,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,e!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(e,t){if(this.drag(e,t),this.fireDragEndEvent_(),pe(),Ui(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(e=this.getNewLocationAfterDrag_(t).delta),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),!this.maybeDeleteBlock_()){let t;null==(t=this.workspace_.getLayerManager())||t.moveOffDragLayer(this.draggingBlock_,Uu),this.draggingBlock_.setDragging(!1),e?this.updateBlockAfterMove_():Ks(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)}this.workspace_.setResizesEnabled(!0),Oo.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(e){return{delta:e=this.pixelsToWorkspaceUnits_(e),newLocation:cl.sum(this.startXY_,e)}}maybeDeleteBlock_(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),Wo.length=0,!0)}updateBlockAfterMove_(){this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.queueRender(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const e=new(B(na))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));k(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const n=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&"function"===typeof t.removeStyle?t.removeStyle(n):e||"function"!==typeof t.addStyle||t.addStyle(n)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var e=new(B(Oo.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);e.setReason(["drag"]),e.oldCoordinate=this.startXY_,e.recordNew(),k(e)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new cl(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(){ne("Blockly.BlockDragger.prototype.dragIcons_","v10","v11")}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};e(Bo.BLOCK_DRAGGER,$o,lf);var cf={};cf.Bubble=Bh,cf.MiniWorkspaceBubble=zh,cf.TextBubble=Kh,cf.TextInputBubble=qh;var uf=class extends Bc{constructor(e,t,n,i){super(e),this.type=Jo,this.recordUndo=!1,e&&(this.name=t,this.oldValue=n,this.newValue=i)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new uf)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};e(Bo.EVENT,Jo,uf);var hf=class extends Bc{constructor(e){super(e),this.type=Oo.MOVE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate="".concat(Math.round(this.oldCoordinate.x),", ")+"".concat(Math.round(this.oldCoordinate.y))),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate="".concat(Math.round(this.newCoordinate.x),", ")+"".concat(Math.round(this.newCoordinate.y))),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new hf)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(n=e.oldCoordinate.split(","),t.oldCoordinate=new cl(Number(n[0]),Number(n[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(n=e.newCoordinate.split(","),t.newCoordinate=new cl(Number(n[0]),Number(n[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const n=t.getParent();return n?(e.parentId=n.id,(t=n.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&cl.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getBlockById(this.blockId);if(n){var i=e?this.newParentId:this.oldParentId,r=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,i){var s=t.getBlockById(i);if(!s)return void console.warn("Can't connect to non-existent block: "+i)}if(n.getParent()&&n.unplug(),e)r=n.getRelativeToSurfaceXY(),n.moveBy(e.x-r.x,e.y-r.y,this.reason);else{let e,i;(!(t=n.outputConnection)||n.previousConnection&&n.previousConnection.isConnected())&&(t=n.previousConnection),n=null==(i=t)?void 0:i.type,r?(n=s.getInput(r))&&(e=n.connection):n===Gc.PREVIOUS_STATEMENT&&(e=s.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+r)}}else console.warn("Can't move non-existent block: "+this.blockId)}};e(Bo.EVENT,Oo.MOVE$$module$build$src$core$events$utils,hf);var df,pf=class extends Ia{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=oa,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=n)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new pf)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(df||(df={})),e(Bo.EVENT,oa,pf);var ff={};ff.BubbleOpen=pf,ff.BubbleType=df;var gf=class extends Ma{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Oo.getGroup$$module$build$src$core$events$utils(),this.recordUndo=C())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new gf)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var n=e.getEventWorkspace_();if(t){if(t=Oo.createElement$$module$build$src$core$utils$xml("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Oo.domToWorkspace$$module$build$src$core$xml(t,n)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(n=n.getCommentById(e.commentId))?n.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},mf=class extends gf{constructor(e,t,n){super(e),this.type=pa,e&&(this.oldContents_="undefined"===typeof t?"":t,this.newContents_="undefined"===typeof n?"":n)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new mf)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var n=e?this.newContents_:this.oldContents_;if(!n){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setContent(n)}else console.warn("Can't change non-existent comment: "+this.commentId)}};e(Bo.EVENT,pa,mf);var vf=class extends gf{constructor(e){super(e),this.type=ha,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bt(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new vf)).xml=Oo.textToDom$$module$build$src$core$utils$xml(e.xml),t}run(e){gf.CommentCreateDeleteHelper(this,e)}};e(Bo.EVENT,ha,vf);var _f=class extends gf{constructor(e){super(e),this.type=da,e&&(this.xml=e.toXmlWithXY())}run(e){gf.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bt(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new _f)).xml=Oo.textToDom$$module$build$src$core$utils$xml(e.xml),t}};e(Bo.EVENT,da,_f);var bf=class extends gf{constructor(e){super(e),this.type=fa,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate="".concat(Math.round(this.oldCoordinate_.x),", ")+"".concat(Math.round(this.oldCoordinate_.y)),e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,n){return t=super.fromJson(e,t,null!=n?n:new bf),n=e.oldCoordinate.split(","),t.oldCoordinate_=new cl(Number(n[0]),Number(n[1])),n=e.newCoordinate.split(","),t.newCoordinate_=new cl(Number(n[0]),Number(n[1])),t}isNull(){return cl.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var n=t.getRelativeToSurfaceXY();t.moveBy(e.x-n.x,e.y-n.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};e(Bo.EVENT,fa,bf);var yf=class extends Ia{constructor(e,t,n){super(n),this.type=la,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new yf)).oldItem=e.oldItem,t.newItem=e.newItem,t}};e(Bo.EVENT,la,yf),Oo.CHANGE$$module$build$src$core$events$utils,Oo.CREATE$$module$build$src$core$events$utils,Oo.DELETE$$module$build$src$core$events$utils,Oo.MOVE$$module$build$src$core$events$utils,Oo.CHANGE$$module$build$src$core$events$utils,Oo.CREATE$$module$build$src$core$events$utils,Oo.DELETE$$module$build$src$core$events$utils,Oo.MOVE$$module$build$src$core$events$utils,Oo.disable$$module$build$src$core$events$utils,Oo.enable$$module$build$src$core$events$utils,Oo.getGroup$$module$build$src$core$events$utils,Oo.setGroup$$module$build$src$core$events$utils;var Tf={};Tf.Abstract=Ma,Tf.BLOCK_CHANGE=Oo.CHANGE$$module$build$src$core$events$utils,Tf.BLOCK_CREATE=Oo.CREATE$$module$build$src$core$events$utils,Tf.BLOCK_DELETE=Oo.DELETE$$module$build$src$core$events$utils,Tf.BLOCK_DRAG=na,Tf.BLOCK_FIELD_INTERMEDIATE_CHANGE=Jo,Tf.BLOCK_MOVE=Oo.MOVE$$module$build$src$core$events$utils,Tf.BUBBLE_OPEN=oa,Tf.BUMP_EVENTS=ma,Tf.BlockBase=Bc,Tf.BlockChange=Eh,Tf.BlockCreate=Fc,Tf.BlockDelete=vp,Tf.BlockDrag=of,Tf.BlockFieldIntermediateChange=uf,Tf.BlockMove=hf,Tf.BubbleOpen=pf,Tf.BubbleType=df,Tf.CHANGE=Oo.CHANGE$$module$build$src$core$events$utils,Tf.CLICK=ra,Tf.COMMENT_CHANGE=pa,Tf.COMMENT_CREATE=ha,Tf.COMMENT_DELETE=da,Tf.COMMENT_MOVE=fa,Tf.CREATE=Oo.CREATE$$module$build$src$core$events$utils,Tf.Click=Ca,Tf.ClickTarget=wa,Tf.CommentBase=gf,Tf.CommentChange=mf,Tf.CommentCreate=vf,Tf.CommentDelete=_f,Tf.CommentMove=bf,Tf.DELETE=Oo.DELETE$$module$build$src$core$events$utils,Tf.FINISHED_LOADING=ga,Tf.FinishedLoading=sf,Tf.MARKER_MOVE=sa,Tf.MOVE=Oo.MOVE$$module$build$src$core$events$utils,Tf.MarkerMove=Ud,Tf.SELECTED=ia,Tf.Selected=uc,Tf.THEME_CHANGE=ca,Tf.TOOLBOX_ITEM_SELECT=la,Tf.TRASHCAN_OPEN=aa,Tf.ThemeChange=zc,Tf.ToolboxItemSelect=yf,Tf.TrashcanOpen=mp,Tf.UI=ta,Tf.UiBase=Ia,Tf.VAR_CREATE=Zo,Tf.VAR_DELETE=Qo,Tf.VAR_RENAME=ea,Tf.VIEWPORT_CHANGE=ua,Tf.VarBase=nc,Tf.VarCreate=ic,Tf.VarDelete=op,Tf.VarRename=ap,Tf.ViewportChange=Vc,Tf.clearPendingUndo=O,Tf.disable=Oo.disable$$module$build$src$core$events$utils,Tf.disableOrphans=F,Tf.enable=Oo.enable$$module$build$src$core$events$utils,Tf.filter=L,Tf.fire=k,Tf.fromJson=$,Tf.get=B,Tf.getDescendantIds=P,Tf.getGroup=Oo.getGroup$$module$build$src$core$events$utils,Tf.getRecordUndo=C,Tf.isEnabled=N,Tf.setGroup=Oo.setGroup$$module$build$src$core$events$utils,Tf.setRecordUndo=I;var Ef=class extends Rd{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&le(this.selectedGlowFilter),this.replacementGlowFilter&&le(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:ts("c",[es(25,-e),es(71,-e),es(t,0)])}}makeHexagonal(){function e(e,n,i){var r=e/2;return rs(-(i=i?-1:1)*(r=r>t?t:r),e=(n?-1:1)*e/2)+rs(i*r,e)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeRounded(){function e(e,t,i){const r=e>n?e-n:0;return as("a","0 0,1",e=(e>n?n:e)/2,es((t?-1:1)*e,(t?-1:1)*e))+os("v",(i?1:-1)*r)+as("a","0 0,1",e,es((t?1:-1)*e,(t?-1:1)*e))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeSquared(){function e(e,n,i){return e-=2*t,as("a","0 0,1",t,es((n?-1:1)*t,(n?-1:1)*t))+os("v",(i?1:-1)*e)+as("a","0 0,1",t,es((n?1:-1)*t,(n?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:e=>t,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Gc.INPUT_VALUE:case Gc.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&-1!==t.indexOf("Boolean")?this.HEXAGONAL:(t&&-1!==t.indexOf("Number")||t&&t.indexOf("String"),this.ROUNDED);case Gc.PREVIOUS_STATEMENT:case Gc.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return ts("c",[es(e*r/2,0),es(e*r*3/4,o/2),es(e*r,o)])+ss([es(e*r,s)])+ts("c",[es(e*r/4,o/2),es(e*r/2,o),es(e*r,o)])+os("h",e*i)+ts("c",[es(e*r/2,0),es(e*r*3/4,-o/2),es(e*r,-o)])+ss([es(e*r,-s)])+ts("c",[es(e*r/4,-o/2),es(e*r/2,-o),es(e*r,-o)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,i=t/3,r=i/3,s=n/2,o=s/2,a=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:a,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=as("a","0 0,0",e,es(-e,e)),n=as("a","0 0,1",e,es(-e,e));return{width:e,height:e,pathTop:t,pathBottom:as("a","0 0,0",e,es(e,e)),rightWidth:e,rightHeight:e,pathTopRight:n,pathBottomRight:as("a","0 0,1",e,es(e,e))}}generateSecondaryColour_(e){return xr("#000",e,.15)||e}generateTertiaryColour_(e){return xr("#000",e,.25)||e}createDom(e,t,n){super.createDom(e,t,n),e=ie(bl.DEFS,{},e),t=ie(bl.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ie(bl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),n=ie(bl.FECOMPONENTTRANSFER,{result:"outBlur"},t),ie(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),ie(bl.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),ie(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=ie(bl.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ie(bl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=ie(bl.FECOMPONENTTRANSFER,{result:"outBlur"},e),ie(bl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ie(bl.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),ie(bl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),ie(bl.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e}getCSS_(e){return["".concat(e," .blocklyText,"),"".concat(e," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ").concat(this.FIELD_TEXT_FONTSIZE)+"pt ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e," .blocklyText {"),"fill: #fff;","}","".concat(e," .blocklyNonEditableText>rect:not(.blocklyDropdownRect),"),"".concat(e," .blocklyEditableText>rect:not(.blocklyDropdownRect) {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"}","".concat(e," .blocklyNonEditableText>text,"),"".concat(e," .blocklyEditableText>text,"),"".concat(e," .blocklyNonEditableText>g>text,"),"".concat(e," .blocklyEditableText>g>text {"),"fill: #575E75;","}","".concat(e," .blocklyFlyoutLabelText {"),"fill: #575E75;","}","".concat(e," .blocklyText.blocklyBubbleText {"),"fill: #575E75;","}","".concat(e," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>rect,","".concat(e," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}","".concat(e," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"color: #575E75;","}","".concat(e," .blocklyDropdownText {"),"fill: #fff !important;","}","".concat(e,".blocklyWidgetDiv .goog-menuitem,"),"".concat(e,".blocklyDropDownDiv .goog-menuitem {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(e,".blocklyDropDownDiv .goog-menuitem-content {"),"color: #fff;","}","".concat(e," .blocklyHighlightedConnectionPath {"),"stroke: ".concat(this.SELECTED_GLOW_COLOUR,";"),"}","".concat(e," .blocklyDisabled > .blocklyOutlinePath {"),"fill: url(#blocklyDisabledPattern".concat(this.randomIdentifier,")"),"}","".concat(e," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"]}},Sf=class extends Ld{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(ld.isSpacer(e)){const i=e.precedesStatement;var t=e.followsStatement;if(i||t){const r=this.constants_.INSIDE_CORNERS;var n=r.rightHeight;return n=e.height-(i?n:0),t=t?r.pathBottomRight:"",e=0<n?os("V",e.yPos+n):"",void(this.outlinePath_+=t+e+(i?r.pathTopRight:""))}}this.outlinePath_+=os("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=is(e.xPos,this.info_.startY),this.outlinePath_+=os("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=os("V",e.baseline),this.outlinePath_+=os("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var n=e.width-2*e.connectionWidth;e=ns(e.xPos+e.connectionWidth,e.centerline-e.height/2)+os("h",n)+e.shape.pathRightDown(e.height)+os("h",-n)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(t,e)}}drawStatementInput_(e){var t=e.getLastInput();const n=t.xPos+t.notchOffset+t.shape.width,i=this.constants_.INSIDE_CORNERS,r=t.shape.pathRight+os("h",-(t.notchOffset-i.width))+i.pathTop,s=e.height-2*i.height;t=i.pathBottom+os("h",t.notchOffset-i.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=os("H",n)+r+os("v",s)+t+os("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}},wf=class extends Ch{constructor(e,t,n,i,r,s,o){if(super(Ch.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",n=Number(kr(n)),t=Number(kr(t)),isNaN(n)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=n||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Tl(t,n+wf.Y_PADDING),this.imageHeight=n,"function"===typeof r&&(this.clickHandler=r),e!==Ch.SKIP_SETUP&&(o?this.configure_(o):(this.flipRtl=!!s,this.altText=kr(i)||""),this.setValue(kr(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=kr(e.alt))}initView(){this.imageElement=ie(bl.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(fl,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!==typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(fl,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};wf.Y_PADDING=1,Nr("field_image",wf),wf.prototype.DEFAULT_VALUE="";var xf=class extends Ch{constructor(e,t,n){super(Ch.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new kh;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new kh;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&N()&&k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new kh;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.style.colourTertiary)):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(oe(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!1)):(re(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new kh;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(Za||Ya||Ka)?this.showPromptEditor_():this.showInlineEditor_(t)}showPromptEditor_(){et(Oo.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),(e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)}))}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new kh;Hn(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new kh;Oo.setGroup$$module$build$src$core$events$utils(!0);const t=Fn();var n=this.getClickTarget_();if(!n)throw Error("A click target has not been set.");re(n,"editing"),(n=document.createElement("input")).className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);const i=this.workspace_.getScale();var r=this.getConstants().FIELD_TEXT_FONTSIZE*i+"pt";return t.style.fontSize=r,n.style.fontSize=r,r=xf.BORDERRADIUS*i+"px",this.isFullBlockField()&&(r=((r=this.getScaledBBox()).bottom-r.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,n.style.border=1*i+"px solid "+e,t.style.borderRadius=r,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*i+"px")),n.style.borderRadius=r,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(n),n}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&N()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(k(new(B(Oo.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),Oo.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=Fn().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");oe(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=j(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=j(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(Y(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(Y(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){"Enter"===e.key?(Gn(),Li()):"Escape"===e.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),Gn(),Li()):"Tab"===e.key&&(Gn(),Li(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&N()&&this.value_!==e&&k(new(B(Jo))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new kh;const t=Fn(),n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",e=new cl(e.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}repositionForWindowResize(){const e=this.getSourceBlock();return e instanceof Ip&&(Ks(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),e)||this.resizeEditor_(),!0)}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return"".concat(e)}getValueFromEditorText_(e){return e}};xf.BORDERRADIUS=4;var Mf=class extends xf{constructor(e,t,n){super(e,t,n)}doClassValidation_(e){return void 0===e?null:"".concat(e)}static fromJson(e){return new this(kr(e.text),void 0,e)}};Nr("field_input",Mf),Mf.prototype.DEFAULT_VALUE="";var If=class extends hd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Cf=class extends yd{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},kf=class extends cd{constructor(e){super(e),this.width=this.height=0,this.type|=ld.getType("RIGHT_CONNECTION")}},Rf=class extends kd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Af=class extends Bd{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new Rf(this.constants_),this.bottomRow=new If(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new kf(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof Pd||e instanceof $d||t instanceof $d||(e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Dd||e instanceof Pd)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&ld.isLeftRoundedCorner(e)&&t&&(ld.isPreviousConnection(t)||ld.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&ld.isLeftSquareCorner(e)&&t&&ld.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(ld.isTopRow(e)&&ld.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const n=ld.isInputRow(e)&&e.hasStatement,i=ld.isInputRow(t)&&t.hasStatement;return i||n?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),i&&n?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):ld.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):ld.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const n=this.width-this.startX;return ld.isInputRow(e)&&e.hasStatement||ld.isInputRow(t)&&t.hasStatement?Math.max(n,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):n}getElemCenterline_(e,t){if(e.hasStatement&&!ld.isSpacer(t)&&!ld.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(ld.isInlineInput(t)&&t instanceof pd){const n=t.connectedBlock;if(n&&n.outputConnection&&n.nextConnection)return e.yPos+n.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Dd||e instanceof Pd)&&t.hasDummyInput&&t.align===Oo.Align$$module$build$src$core$inputs$align.LEFT&&e.align===Oo.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof $d)return t.elements.push(new Cf(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let n;for(let t=0;t<e.elements.length;t++){const i=e.elements[t];if(ld.isSpacer(i)&&(n=i),ld.isField(i)&&i instanceof gd&&i.parentInput===this.rightAlignedDummyInputs.get(e))break}if(n)return n.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let r=2;r<this.rows.length-1;r+=2){var n=this.rows[r-1];const s=this.rows[r];var i=this.rows[r+1];if(n=2===r?!!this.topRow.hasPreviousConnection:!!n.followsStatement,i=r+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!i.precedesStatement,ld.isInputRow(s)&&s.hasStatement){let n,i;s.measure(),t=s.width-(null!=(i=null==(n=s.getLastInput())?void 0:n.width)?i:0)+e}else if(n&&(2===r||i)&&ld.isInputRow(s)&&!s.hasStatement){i=s.xPos,n=null;for(let e=0;e<s.elements.length;e++){const r=s.elements[e];ld.isSpacer(r)&&(n=r),n&&(ld.isField(r)||ld.isInput(r))&&i<t&&!(ld.isField(r)&&r instanceof gd&&(r.field instanceof Od||r.field instanceof wf))&&(n.width+=t-i),i+=r.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,n=0;n<this.rows.length;n++){const e=this.rows[n];e.yPos=t,t+=e.height}this.height=t,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(n),n=e.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(n),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=n,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=n,this.width+=n+e,this.widthWithChildren+=n+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var n=this.rows[t];if(!ld.isInputRow(n))continue;e=n.elements[n.elements.length-2];let i=this.getNegativeSpacing_(n.elements[1]),r=this.getNegativeSpacing_(e);e=i+r;const s=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<s&&(i=(e=this.width-s)/2,r=e/2),n.elements.unshift(new _d(this.constants_,-i)),n.elements.push(new _d(this.constants_,-r))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)n=this.rows[t],ld.isTopOrBottomRow(n)&&(n.elements[1].width-=e),n.width-=e,n.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var n=this.outputConnection.shape.type;const i=this.constants_;if(1<this.inputRows.length)return n===i.SHAPES.ROUND?(n=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(n=this.height/2>n?n:this.height/2)*(1-Math.sin(Math.acos((n-this.constants_.SMALL_PADDING)/n)))):0;if(ld.isInlineInput(e)&&e instanceof pd){const r=e.connectedBlock;return null==(e=r?r.pathObject.outputShapeType:e.shape.type)||r&&r.outputConnection&&(r.statementInputCount||r.nextConnection)||n===i.SHAPES.HEXAGONAL&&n!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][e]}return ld.isField(e)&&e instanceof gd?n===i.SHAPES.ROUND&&e.field instanceof Mf?t-2.75*i.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][0]:ld.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let i=2;i<this.rows.length-1;i+=2){const r=this.rows[i-1],s=this.rows[i],o=this.rows[i+1];var e=2===i,t=i+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!o.precedesStatement;if(e?this.topRow.hasPreviousConnection:r.followsStatement){var n=s.elements[1];if(n=3===s.elements.length&&n instanceof gd&&(n.field instanceof Od||n.field instanceof wf),!e&&n)r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<s.elements.length;t++)if((n=s.elements[t])instanceof pd&&ld.isInlineInput(n)&&n.connectedBlock&&!n.connectedBlock.isShadow()&&40<=n.connectedBlock.getHeightWidth().height){e=!0;break}e&&(r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING)}}else r.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Lf=class extends Vd{constructor(e,t,n){super(e,t,n),this.markerCircle=null}showWithInputOutput(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput(e)}showWithInput_(e){this.showWithInputOutput(e)}showWithBlock_(e){const t=(e=e.getLocation()).getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle(e,t){let n,i;null==(n=this.markerCircle)||n.setAttribute("cx","".concat(e)),null==(i=this.markerCircle)||i.setAttribute("cy","".concat(t)),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=ie(bl.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();ie(bl.ANIMATE,e,this.markerCircle)}return this.markerSvg_}applyColour_(e){let t,n;if(super.applyColour_(e),null==(t=this.markerCircle)||t.setAttribute("fill",this.colour_),null==(n=this.markerCircle)||n.setAttribute("stroke",this.colour_),this.isCursor()){let t;e=this.colour_+";transparent;transparent;",null==(t=this.markerCircle)||t.firstElementChild.setAttribute("values",e)}}},Of=class extends Wd{constructor(e,t,n){super(e,t,n),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=n}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const n of this.outlines.values())n.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,ie(bl.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,n;null==(t=this.outlines.get(e))||null==(n=t.parentNode)||n.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Nf=class extends ep{constructor(e){super(e)}makeConstants_(){return new Ef}makeRenderInfo_(e){return new Af(this,e)}makeDrawer_(e,t){return new Sf(e,t)}makeMarkerDrawer(e,t){return new Lf(e,this.getConstants(),t)}makePathObject(e,t){return new Of(e,t,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(e){return e.type!==Gc.INPUT_VALUE&&e.type!==Gc.OUTPUT_VALUE}getConnectionPreviewMethod(e,t,n){return t.type===Gc.OUTPUT_VALUE?e.isConnected()?Jd.PREVIEW_TYPE.REPLACEMENT_FADE:Jd.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,n)}};xs("zelos",Nf);var Df={};Df.BottomRow=If,Df.ConstantProvider=Ef,Df.Drawer=Sf,Df.MarkerSvg=Lf,Df.PathObject=Of,Df.RenderInfo=Af,Df.Renderer=Nf,Df.RightConnectionShape=kf,Df.StatementInput=Cf,Df.TopRow=Rf,yo();var Pf={};Pf.registerCleanup=no,Pf.registerCollapse=ro,Pf.registerCollapseExpandBlock=go,Pf.registerComment=po,Pf.registerDefaultOptions=yo,Pf.registerDelete=vo,Pf.registerDeleteAll=co,Pf.registerDisable=mo,Pf.registerDuplicate=ho,Pf.registerExpand=so,Pf.registerHelp=_o,Pf.registerInline=fo,Pf.registerRedo=to,Pf.registerUndo=eo;var $f,Bf=class extends xf{constructor(e,t,n){super(Ch.SKIP_SETUP),this.clockwise=Bf.CLOCKWISE,this.offset=Bf.OFFSET,this.wrap=Bf.WRAP,this.round=Bf.ROUND,this.boundEvents=[],this.symbol_=this.gauge=this.line=null,e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case $f.COMPASS:this.clockwise=!0,this.offset=90;break;case $f.PROTRACTOR:this.clockwise=!1,this.offset=0}e.clockwise&&(this.clockwise=e.clockwise),e.offset&&(this.offset=e.offset),e.wrap&&(this.wrap=e.wrap),e.round&&(this.round=e.round)}initView(){super.initView(),this.symbol_=ie(bl.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("\xb0")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph()}showEditor_(e){super.showEditor_(e,Za||Ya||Ka),e=this.dropdownCreate(),mi().appendChild(e),this.sourceBlock_ instanceof Ip&&_i(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),yi(this,this.dropdownDispose.bind(this)),this.updateGraph()}dropdownCreate(){const e=ie(bl.SVG,{xmlns:dl,"xmlns:html":pl,"xmlns:xlink":fl,version:"1.1",height:2*Bf.HALF+"px",width:2*Bf.HALF+"px"});e.style.touchAction="none";const t=ie(bl.CIRCLE,{cx:Bf.HALF,cy:Bf.HALF,r:Bf.RADIUS,class:"blocklyAngleCircle"},e);this.gauge=ie(bl.PATH,{class:"blocklyAngleGauge"},e),this.line=ie(bl.LINE,{x1:Bf.HALF,y1:Bf.HALF,class:"blocklyAngleLine"},e);for(let n=0;360>n;n+=15)ie(bl.LINE,{x1:Bf.HALF+Bf.RADIUS,y1:Bf.HALF,x2:Bf.HALF+Bf.RADIUS-(0===n%45?10:5),y2:Bf.HALF,class:"blocklyAngleMarks",transform:"rotate("+n+","+Bf.HALF+","+Bf.HALF+")"},e);return this.boundEvents.push(j(e,"click",this,this.hide)),this.boundEvents.push(j(t,"pointerdown",this,this.onMouseMove_,!0)),this.boundEvents.push(j(t,"pointermove",this,this.onMouseMove_,!0)),e}dropdownDispose(){for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.line=this.gauge=null}hide(){Ri(this),Gn()}onMouseMove_(e){var t=this.gauge.ownerSVGElement.getBoundingClientRect();const n=e.clientX-t.left-Bf.HALF;e=e.clientY-t.top-Bf.HALF,t=Math.atan(-e/n),isNaN(t)||(t=hi(t),0>n?t+=180:0<e&&(t+=360),t=this.clockwise?this.offset+360-t:360-(this.offset-t),this.displayMouseOrKeyboardValue(t))}displayMouseOrKeyboardValue(e){if(this.round&&(e=Math.round(e/this.round)*this.round),(e=this.wrapValue(e))!==this.value_){const t=this.value_;this.setEditorValue_(e,!1),this.sourceBlock_&&N()&&this.value_!==t&&k(new(B(Jo))(this.sourceBlock_,this.name||null,t,this.value_))}}updateGraph(){if(this.gauge&&this.line){var e=Number(this.getText())+this.offset,t=ui(e%360);e=["M ",Bf.HALF,",",Bf.HALF];var n=Bf.HALF,i=Bf.HALF;if(!isNaN(t)){const r=Number(this.clockwise),s=ui(this.offset),o=Math.cos(s)*Bf.RADIUS,a=Math.sin(s)*-Bf.RADIUS;r&&(t=2*s-t),n+=Math.cos(t)*Bf.RADIUS,i-=Math.sin(t)*Bf.RADIUS,t=Math.abs(Math.floor((t-s)/Math.PI)%2),r&&(t=1-t),e.push(" l ",o,",",a," A ",Bf.RADIUS,",",Bf.RADIUS," 0 ",t," ",r," ",n,",",i," z")}this.gauge.setAttribute("d",e.join("")),this.line.setAttribute("x2","".concat(n)),this.line.setAttribute("y2","".concat(i))}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new kh;let n=0;switch(e.key){case"ArrowLeft":n=t.RTL?1:-1;break;case"ArrowRight":n=t.RTL?-1:1;break;case"ArrowDown":n=-1;break;case"ArrowUp":n=1}n&&(t=this.getValue(),this.displayMouseOrKeyboardValue(t+n*this.round),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue(e)}wrapValue(e){return 0>(e%=360)&&(e+=360),e>this.wrap&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};Bf.HALF=50,Bf.RADIUS=Bf.HALF-1,Bf.CLOCKWISE=!1,Bf.OFFSET=0,Bf.WRAP=360,Bf.ROUND=15,Nr("field_angle",Bf),Bf.prototype.DEFAULT_VALUE=0,ee("\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: 0.8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: 0.8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n"),function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"}($f||($f={}));var Ff={};Ff.FieldAngle=Bf,Ff.Mode=$f;var Uf=class extends Ch{constructor(e,t,n){super(Ch.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=Uf.CHECK_CHAR,e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Uf);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();re(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Uf.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return"string"===typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Uf.CHECK_CHAR="\u2713",Nr("field_checkbox",Uf),Uf.prototype.DEFAULT_VALUE=!1;var zf=class extends Ch{constructor(e,t,n){super(Ch.SKIP_SETUP),this.highlightedIndex=this.picker=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles=this.colours=null,this.columns=0,e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours=e.colourOptions),e.colourTitles&&(this.titles=e.colourTitles),e.columns&&(this.columns=e.columns)}initView(){this.size_=new Tl(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new kh;const t=this.getConstants();return e.isSimpleReporter()&&!(null==t||!t.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const e=this.getSourceBlock();if(!e)throw new kh;if(this.fieldGroup_){var t=this.borderRect_;if(!t)throw Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getValue())}}getSize(){let e;return null!=(e=this.getConstants())&&e.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const e=this.getSourceBlock();if(!e)throw new kh;e.applyColour()}updateSize_(e){var t=this.getConstants();this.isFullBlockField()?(e=2*(null!=e?e:0),t=t.FIELD_TEXT_HEIGHT):(e=t.FIELD_COLOUR_DEFAULT_WIDTH,t=t.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=t,this.size_.width=e,this.positionBorderRect_()}doClassValidation_(e){return"string"!==typeof e?null:Tr(e)}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours=e,t&&(this.titles=t),this}setColumns(e){return this.columns=e,this}showEditor_(){this.dropdownCreate(),mi().appendChild(this.picker),yi(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(e){null!==(e=(e=e.target)&&e.getAttribute("data-colour"))&&(this.setValue(e),Ri(this))}onKeyDown(e){let t=!0;var n;switch(e.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":(n=this.getHighlighted())&&null!==(n=n.getAttribute("data-colour"))&&this.setValue(n),Li();break;default:t=!1}t&&e.stopPropagation()}moveHighlightBy(e,t){if(this.highlightedIndex){var n=this.colours||zf.COLOURS,i=this.columns||zf.COLUMNS,r=this.highlightedIndex%i,s=Math.floor(this.highlightedIndex/i);r+=e,s+=t,0>e?0>r&&0<s?(r=i-1,s--):0>r&&(r=0):0<e?r>i-1&&s<Math.floor(n.length/i)-1?(r=0,s++):r>i-1&&r--:0>t?0>s&&(s=0):0<t&&s>Math.floor(n.length/i)-1&&(s=Math.floor(n.length/i)-1),this.setHighlightedCell(this.picker.childNodes[s].childNodes[r],s*i+r)}}onMouseMove(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));null!==t&&t!==this.highlightedIndex&&this.setHighlightedCell(e,t)}onMouseEnter(){let e;null==(e=this.picker)||e.focus({preventScroll:!0})}onMouseLeave(){var e;null==(e=this.picker)||e.blur(),(e=this.getHighlighted())&&oe(e,"blocklyColourHighlighted")}getHighlighted(){if(!this.highlightedIndex)return null;const e=this.columns||zf.COLUMNS,t=this.picker.childNodes[Math.floor(this.highlightedIndex/e)];return t?t.childNodes[this.highlightedIndex%e]:null}setHighlightedCell(e,t){const n=this.getHighlighted();n&&oe(n,"blocklyColourHighlighted"),re(e,"blocklyColourHighlighted"),this.highlightedIndex=t,(e=e.getAttribute("id"))&&this.picker&&Bn(this.picker,Qc.ACTIVEDESCENDANT,e)}dropdownCreate(){const e=this.columns||zf.COLUMNS,t=this.colours||zf.COLOURS,n=this.titles||zf.TITLES,i=this.getValue(),r=document.createElement("table");let s;r.className="blocklyColourTable",r.tabIndex=0,r.dir="ltr",$n(r,Zc.GRID),Bn(r,Qc.EXPANDED,!0),Bn(r,Qc.ROWCOUNT,Math.floor(t.length/e)),Bn(r,Qc.COLCOUNT,e);for(let o=0;o<t.length;o++){0===o%e&&(s=document.createElement("tr"),$n(s,Zc.ROW),r.appendChild(s));const a=document.createElement("td");s.appendChild(a),a.setAttribute("data-colour",t[o]),a.title=n[o]||t[o],a.id=x(),a.setAttribute("data-index","".concat(o)),$n(a,Zc.GRIDCELL),Bn(a,Qc.LABEL,t[o]),Bn(a,Qc.SELECTED,t[o]===i),a.style.backgroundColor=t[o],t[o]===i&&(a.className="blocklyColourSelected",this.highlightedIndex=o)}this.boundEvents.push(j(r,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(j(r,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(j(r,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(j(r,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(j(r,"keydown",this,this.onKeyDown,!1)),this.picker=r}dropdownDispose(){for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.highlightedIndex=this.picker=null}static fromJson(e){return new this(e.colour,void 0,e)}};zf.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),zf.TITLES=[],zf.COLUMNS=7,zf.prototype.DEFAULT_VALUE=zf.COLOURS[0],Nr("field_colour",zf),ee("\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n");var Hf=class extends Od{constructor(e,t,n){super(String(null!=e?e:""),t,n),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(kr(e.text),void 0,e)}};Nr("field_label_serializable",Hf);var Gf=class extends Mf{constructor(e,t,n){super(Ch.SKIP_SETUP),this.textGroup=null,this.maxLines_=1/0,this.isOverflowedY_=!1,e!==Ch.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,"\n"))}saveState(){const e=this.saveLegacyState(Gf);return null!==e?e:this.getValue()}loadState(e){this.loadLegacyState(Ch,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup=ie(bl.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new kh;let t=this.getText();if(!t)return Ch.NBSP;const n=t.split("\n");t="";const i=this.isOverflowedY_?this.maxLines_:n.length;for(let r=0;r<i;r++){let e=n[r];e.length>this.maxDisplayLength?e=e.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&r===i-1&&(e=e.substring(0,e.length-3)+"..."),e=e.replace(/\s/g,Ch.NBSP),t+=e,r!==i-1&&(t+="\n")}return e.RTL&&(t+="\u200f"),t}doValueUpdate_(e){super.doValueUpdate_(e),null!==this.value_&&(this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_)}render_(){var e=this.getSourceBlock();if(!e)throw new kh;for(var t,n=this.textGroup;t=n.firstChild;)n.removeChild(t);t=this.getDisplayText_().split("\n");let i=0;for(let r=0;r<t.length;r++){const e=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;ie(bl.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:i+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},n).appendChild(document.createTextNode(t[r])),i+=e}this.isBeingEdited_&&(n=this.htmlInput_,this.isOverflowedY_?re(n,"blocklyHtmlTextAreaInputOverflowedY"):oe(n,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(oe(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!1)):(re(e,"blocklyInvalidInput"),Bn(e,Qc.INVALID,!0)))}updateSize_(){var e=this.textGroup.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,n=this.getConstants().FIELD_TEXT_FONTWEIGHT,i=this.getConstants().FIELD_TEXT_FONTFAMILY;let r=0,s=0;for(var o=0;o<e.length;o++){var a=ge(e[o],t,n,i);a>r&&(r=a),s+=this.getConstants().FIELD_TEXT_HEIGHT+(0<o?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=String(this.value_).split("\n"),o=ie(bl.TEXT,{class:"blocklyText blocklyMultilineText"}),a=0;a<e.length;a++){e[a].length>this.maxDisplayLength&&(e[a]=e[a].substring(0,this.maxDisplayLength)),o.textContent=e[a];const s=ge(o,t,n,i);s>r&&(r=s)}r+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(s+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width","".concat(r)),this.borderRect_.setAttribute("height","".concat(s))),this.size_.width=r,this.size_.height=s,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=Fn(),t=this.workspace_.getScale(),n=document.createElement("textarea");n.className="blocklyHtmlInput blocklyHtmlTextAreaInput",n.setAttribute("spellcheck",String(this.spellcheck_));var i=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=i,n.style.fontSize=i,n.style.borderRadius=Mf.BORDERRADIUS*t+"px",i=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const r=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return n.style.padding=r+"px "+i+"px "+r+"px "+i+"px",i=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n.style.lineHeight=i*t+"px",e.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),n.setAttribute("data-old-value",""),Xa?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(n),n}setMaxLines(e){"number"===typeof e&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){"Enter"!==e.key&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(kr(e.text),void 0,e)}};Nr("field_multilinetext",Gf),ee("\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n");var Vf=class extends xf{constructor(e,t,n,i,r,s){super(Ch.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==Ch.SKIP_SETUP&&(s?this.configure_(s):this.setConstraints(t,n,i),this.setValue(e),r&&this.setValidator(r))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);-1!==t.indexOf("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e?null:(e=(e=(e="".concat(e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e)?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e))}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&(e.min="".concat(this.min_),Bn(e,Qc.VALUEMIN,this.min_)),1/0>this.max_&&(e.max="".concat(this.max_),Bn(e,Qc.VALUEMAX,this.max_)),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Nr("field_number",Vf),Vf.prototype.DEFAULT_VALUE=0;var Wf=class extends Dh{constructor(e,t,n,i,r){super(Ch.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=Wf.dropdownCreate,this.defaultVariableName="string"===typeof e?e:"",this.size_=new Tl(0,0),e!==Ch.SKIP_SETUP&&(r?this.configure_(r):this.setTypes(n,i),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new kh;this.variable||(e=Oo.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new kh;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new kh;const n=e.getAttribute("id"),i=e.textContent,r=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Oo.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,n,i,r),null!==r&&r!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+Bt(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.name,this.variable.type&&e.setAttribute("variabletype",this.variable.type),e}saveState(e){var t=this.saveLegacyState(Wf);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.name,t.type=this.variable.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new kh;this.loadLegacyState(Wf,e)||(e=Oo.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new kh;return(t=Oo.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.type,this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new kh;this.variable=Oo.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let n=0;n<t.length;n++)if(e===t[n])return!0;return!1}getVariableTypes(){var e=this.variableTypes;if(null===e&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(0===(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(Array.isArray(e)){let n=!1;for(let i=0;i<e.length;i++)e[i]===t&&(n=!0);if(!n)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===ju)return void Oo.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===Xu)return void this.sourceBlock_.workspace.deleteVariableById(this.variable.getId())}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(kr(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var n=this.getVariableTypes(),i=0;i<n.length;i++){const e=this.sourceBlock_.workspace.getVariablesOfType(n[i]);t=t.concat(e)}for(t.sort(rc.compareByName),n=[],i=0;i<t.length;i++)n[i]=[t[i].name,t[i].getId()];return n.push([Oo.Msg$$module$build$src$core$msg.RENAME_VARIABLE,ju]),Oo.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&n.push([Oo.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Xu]),n}};Nr("field_variable",Wf);var jf=class{constructor(e,t,n,i){this.workspace=e,this.targetWorkspace=t,this.isLabel_=i,this.onMouseUpWrapper=null,this.height=this.width=0,this.svgText=this.svgGroup=null,this.text=n.text,this.position=new cl(0,0),this.callbackKey=n.callbackKey||n.callbackkey,this.cssClass=n["web-class"]||null,this.info=n}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";let t;this.cssClass&&(e+=" "+this.cssClass),this.svgGroup=ie(bl.G,{class:e},this.workspace.getCanvas()),this.isLabel_||(t=ie(bl.RECT,{class:"blocklyFlyoutButtonShadow",rx:jf.BORDER_RADIUS,ry:jf.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=ie(bl.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:jf.BORDER_RADIUS,ry:jf.BORDER_RADIUS},this.svgGroup);const n=ie(bl.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var i=kr(this.text);this.workspace.RTL&&(i+="\u200f"),n.textContent=i,this.isLabel_&&(this.svgText=n,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const r=Te(n,"fontSize"),s=Te(n,"fontWeight"),o=Te(n,"fontFamily");if(this.width=me(n,r,s,o),i=ve(i,r,s,o),this.height=i.height,!this.isLabel_){let e,n;this.width+=2*jf.TEXT_MARGIN_X,this.height+=2*jf.TEXT_MARGIN_Y,null==(e=t)||e.setAttribute("width",String(this.width)),null==(n=t)||n.setAttribute("height",String(this.height))}return e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),n.setAttribute("x",String(this.width/2)),n.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseUpWrapper=j(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&Y(this.onMouseUpWrapper),this.svgGroup&&le(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};jf.TEXT_MARGIN_X=5,jf.TEXT_MARGIN_Y=2,jf.BORDER_RADIUS=4,ee("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Xf,Yf=class extends rf{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,n){return t=n||this.getContentMetrics(),n=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*n)/e,width:(t.width+t.left+n)/e,top:0,left:0}}};!function(e){e.BLOCK="block",e.BUTTON="button"}(Xf||(Xf={}));var Kf=class extends Rp{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new fp(e),this.workspace_.setMetricsManager(new Yf(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=M(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=ie(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=ie(bl.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new nf(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(j(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(j(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[sl.Capability.AUTOHIDEABLE,sl.Capability.DELETE_AREA,sl.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)Y(e);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&le(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,n,i){let r,s;null==(r=this.svgGroup_)||r.setAttribute("width","".concat(e)),null==(s=this.svgGroup_)||s.setAttribute("height","".concat(t)),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&he(this.svgGroup_,"translate("+n+"px,"+i+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(n,i),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const e of this.listeners)Y(e);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"===typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=Be(e),e=this.createFlyoutInfo(e),wt(this.workspace_),this.layout_(e.contents,e.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(e){const t=[],n=[];this.permanentlyDisabled.length=0;const i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const r of e){if("custom"in r){e=this.getDynamicCategoryContents(r.custom),e=Be(e);const{contents:i,gaps:s}=this.createFlyoutInfo(e);t.push(...i),n.push(...s)}switch(r.kind.toUpperCase()){case"BLOCK":e=r;const s=this.createFlyoutBlock(e);t.push({type:Xf.BLOCK,block:s}),this.addBlockGap(e,n,i);break;case"SEP":this.addSeparatorGap(r,n,i);break;case"LABEL":e=this.createButton(r,!0),t.push({type:Xf.BUTTON,button:e}),n.push(i);break;case"BUTTON":e=this.createButton(r,!1),t.push({type:Xf.BUTTON,button:e}),n.push(i)}}return{contents:t,gaps:n}}getDynamicCategoryContents(e){if("function"!==typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton(e,t){return new jf(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock(e){let t;return e.blockxml?(e="string"===typeof e.blockxml?Oo.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,(t=this.getRecycledBlock(e.getAttribute("type")))||(t=Ht(e,this.workspace_))):(t=this.getRecycledBlock(e.type),t||(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),t=mn(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled.push(t),t}getRecycledBlock(e){let t=-1;for(let n=0;n<this.recycledBlocks.length;n++)if(this.recycledBlocks[n].type===e){t=n;break}return-1===t?void 0:this.recycledBlocks.splice(t,1)[0]}addBlockGap(e,t,n){let i;e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e="string"===typeof e.blockxml?Oo.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),t.push(!i||isNaN(i)?n:i)}addSeparatorGap(e,t,n){e=parseInt(String(e.gap)),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(n)}clearOldBlocks(){var e=this.workspace_.getTopBlocks(!1);for(let n,i=0;n=e[i];i++)this.blockIsRecyclable_(n)?this.recycleBlock(n):n.dispose(!1,!1);for(e=0;e<this.mats.length;e++){const t=this.mats[e];t&&(ir(t),le(t))}this.mats.length=0;for(let n,i=0;n=this.buttons_[i];i++)n.dispose();let t;this.buttons_.length=0,null==(t=this.workspace_.getPotentialVariableMap())||t.clear()}emptyRecycledBlocks(){for(let e=0;e<this.recycledBlocks.length;e++)this.recycledBlocks[e].dispose();this.recycledBlocks=[]}blockIsRecyclable_(e){return!1}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks.push(e)}addBlockListeners_(e,t,n){this.listeners.push(j(e,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(j(n,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(X(e,"pointerenter",t,t.addSelect)),this.listeners.push(X(e,"pointerleave",t,t.removeSelect)),this.listeners.push(X(n,"pointerenter",t,t.addSelect)),this.listeners.push(X(n,"pointerleave",t,t.removeSelect))}blockMouseDown(e){return t=>{const n=this.targetWorkspace.getGesture(t);n&&(n.setStartBlock(e),n.handleFlyoutStart(t,this))}}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Oo.disable$$module$build$src$core$events$utils();var n=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{Oo.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=bt(this.targetWorkspace,n),N()){for(Oo.setGroup$$module$build$src$core$events$utils(!0),n=0;n<e.length;n++){const t=e[n];k(new(B(Zo))(t))}k(new(B(Oo.CREATE$$module$build$src$core$events$utils))(t))}return this.autoClose?this.hide():this.filterForCapacity(),t}initFlyoutButton_(e,t,n){const i=e.createDom();e.moveTo(t,n),e.show(),this.listeners.push(j(i,"pointerdown",this,this.onMouseDown)),this.buttons_.push(e)}createRect_(e,t,n,i,r){return(t=ie(bl.RECT,{"fill-opacity":0,x:t,y:n,height:i.height,width:i.width})).tooltip=e,nr(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats[r]=t}moveRectToBlock_(e,t){const n=t.getHeightWidth();e.setAttribute("width",String(n.width)),e.setAttribute("height",String(n.height)),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",String(t.y)),e.setAttribute("x",String(this.RTL?t.x-n.width:t.x))}filterForCapacity(){const e=this.workspace_.getTopBlocks(!1);for(let t,n=0;t=e[n];n++)if(-1===this.permanentlyDisabled.indexOf(t)){const e=this.targetWorkspace.isCapacityAvailable(T(t));for(;t;)t.setEnabled(e),t=t.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const n=on(e);return t.setResizesEnabled(!1),t=gn(n,t),this.positionNewBlock(e,t),t}positionNewBlock(e,t){const n=this.targetWorkspace;var i=n.getOriginOffsetInPixels(),r=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),r=cl.sum(r,e),(i=cl.difference(r,i)).scale(1/n.scale),t.moveTo(new cl(i.x,i.y))}};Kf.FlyoutItemType=Xf;var qf=class extends Kf{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),i=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"===typeof e.x&&(this.workspace_.scrollX=-(n.left+(n.width-i.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();e=e.getToolboxMetrics();const i=this.toolboxPosition_===Pl.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?i?e.height:n.height-this.height_:i?0:n.height:i?0:n.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Pl.TOP,i=["M 0,"+(n?0:this.CORNER_RADIUS)];n?(i.push("h",e+2*this.CORNER_RADIUS),i.push("v",t),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",-e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),i.push("h",e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",t),i.push("h",-e-2*this.CORNER_RADIUS)),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=Z(e);if(t=t.x||t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let i;t=e.getViewMetrics().left-n.left+t,null==(i=this.workspace_.scrollbar)||i.setX(t),Gn(),Li()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const n=this.MARGIN;let i=n+this.tabWidth_;this.RTL&&(e=e.reverse());for(let a,l=0;a=e[l];l++)if("block"===a.type){var r=a.block,s=r.getDescendants(!1);for(let t,n=0;t=s[n];n++)t.isInFlyout=!0;s=r.getSvgRoot();const e=r.getHeightWidth();var o=r.outputConnection?this.tabWidth_:0;o=this.RTL?i+e.width:i-o,r.moveBy(o,n),o=this.createRect_(r,o,n,e,l),i+=e.width+t[l],this.addBlockListeners_(s,r,o)}else"button"===a.type&&(r=a.button,this.initFlyoutButton_(r,i,n),i+=r.width+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Pl.TOP?new yl(-1e9,t+e.height,-1e9,1e9):new yl(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(!1);for(let i,r=0;i=t[r];r++)e=Math.max(e,i.getHeightWidth().height);const n=this.buttons_;for(let i,r=0;i=n[r];r++)e=Math.max(e,i.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Il.scrollbarThickness,this.height_!==e){for(let e,n=0;e=t[n];n++)this.rectMap_.has(e)&&this.moveRectToBlock_(this.rectMap_.get(e),e);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Pl.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};e(Bo.FLYOUTS_HORIZONTAL_TOOLBOX,$o,qf);var Jf=class extends Kf{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),i=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"===typeof e.y&&(this.workspace_.scrollY=-(n.top+(n.height-i.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Pl.LEFT?e.width:n.width-this.width_:this.toolboxPosition_===Pl.LEFT?0:n.width:this.toolboxPosition_===Pl.LEFT?0:n.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Pl.RIGHT;var i=e+this.CORNER_RADIUS;(i=["M "+(n?i:0)+",0"]).push("h",n?-e:e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",Math.max(0,t)),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",n?e:-e),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=Z(e);if(t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let i;t=e.getViewMetrics().top-n.top+t.y,null==(i=this.workspace_.scrollbar)||i.setY(t),Gn(),Li()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var n=this.MARGIN;const i=this.RTL?n:n+this.tabWidth_;for(let a,l=0;a=e[l];l++)if("block"===a.type){var r=a.block,s=r.getDescendants(!1);for(let t,n=0;t=s[n];n++)t.isInFlyout=!0;s=r.getSvgRoot();const e=r.getHeightWidth();var o=r.outputConnection?i-this.tabWidth_:i;r.moveBy(o,n),o=this.createRect_(r,this.RTL?o-e.width:o,n,e,l),this.addBlockListeners_(s,r,o),n+=e.height+t[l]}else"button"===a.type&&(r=a.button,this.initFlyoutButton_(r,i,n),n+=r.height+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Pl.LEFT?new yl(-1e9,1e9,-1e9,t+e.width):new yl(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(!1);for(let i,r=0;i=t[r];r++){var n=i.getHeightWidth().width;i.outputConnection&&(n-=this.tabWidth_),e=Math.max(e,n)}for(let i,r=0;i=this.buttons_[r];r++)e=Math.max(e,i.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Il.scrollbarThickness,this.width_!==e){for(let i,r=0;i=t[r];r++){if(this.RTL){n=i.getRelativeToSurfaceXY().x;let t=e/this.workspace_.scale-this.MARGIN;i.outputConnection||(t-=this.tabWidth_),i.moveBy(t-n,0)}this.rectMap_.has(i)&&this.moveRectToBlock_(this.rectMap_.get(i),i)}if(this.RTL)for(let n,i=0;n=this.buttons_[i];i++)t=n.getPosition().y,n.moveTo(e/this.workspace_.scale-n.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Pl.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Jf.registryName="verticalFlyout",e(Bo.FLYOUTS_VERTICAL_TOOLBOX,$o,Jf),Oo.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=f());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let n,i=0;n=e[i];i++){let e=this.blockToCode(n);Array.isArray(e)&&(e=e[0]),e&&(n.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,n)+e),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,n))),t.push(e))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let n=0;n<e.length;n++){const i=e[n].getCommentText();i&&t.push(i)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var n=this.forBlock[e.type];if(!n&&this[e.type]&&(ne("block generator functions on CodeGenerator objects","10.0","11.0","the .forBlock[blockType] dictionary"),n=this[e.type]),"function"!==typeof n)throw Error("".concat(this.name_," generator does not know how to generate code ")+'for block type "'.concat(e.type,'".'));if(n=n.call(e,e,this),Array.isArray(n)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,n[0],t),n[1]]}if("string"===typeof n)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,e)+n),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,n,t);if(null===n)return"";throw SyntaxError("Invalid code generated: "+n)}valueToCode(e,t,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+e.type);var i=e.getInputTargetBlock(t);if(!i)return"";if(""===(t=this.blockToCode(i)))return"";if(!Array.isArray(t))throw TypeError("Expecting tuple from value block: ".concat(i.type," See ")+"developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information");if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+i.type);if(!e)return"";i=!1;var r=Math.floor(n);const s=Math.floor(t);if(r<=s&&(r!==s||0!==r&&99!==r))for(i=!0,r=0;r<this.ORDER_OVERRIDES.length;r++)if(this.ORDER_OVERRIDES[r][0]===n&&this.ORDER_OVERRIDES[r][1]===t){i=!1;break}return i&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),"string"!==typeof(t=this.blockToCode(e)))throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const n=this.nameDB_.getDistinctName(e,Oo.NameType$$module$build$src$core$names.PROCEDURE);let i;for(this.functionNames_[e]=n,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);i!==t;)i=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,Oo.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,Oo.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,n){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Oo.CodeGenerator$$module$build$src$core$generator;var Zf=!1,Qf={};Qf.Align=Oo.Align$$module$build$src$core$inputs$align,Qf.DummyInput=Dd,Qf.EndRowInput=Pd,Qf.Input=Nd,Qf.StatementInput=$d,Qf.ValueInput=Oo.ValueInput$$module$build$src$core$inputs$value_input,Qf.inputTypes=Oo.inputTypes$$module$build$src$core$inputs$input_types;var eg=class extends Rd{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat(["".concat(e," .blocklyInsertionMarker>.blocklyPathLight,"),"".concat(e," .blocklyInsertionMarker>.blocklyPathDark {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"])}},tg=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=is(e.xPos,this.info_.startY);for(let t,n=0;t=e.elements[n];n++)ld.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:ld.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):ld.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:ld.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):ld.isSpacer(t)&&0!==t.width&&(this.steps_+=os("H",t.xPos+t.width-this.highlightOffset));this.steps_+=os("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+os("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const n=e.height-t.connectionHeight;this.steps_+=ns(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+os("v",n)}else this.steps_+=ns(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const n=e.height-2*this.insideCornerPaths_.height;this.steps_+=ns(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+os("v",n)+this.insideCornerPaths_.pathBottom(this.RTL_)+rs(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=ns(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+rs(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof Id&&e.followsStatement&&(this.steps_+=os("H",t)),this.RTL_&&(this.steps_+=os("H",t),e.height>this.highlightOffset&&(this.steps_+=os("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=os("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];ld.isLeftSquareCorner(t)?this.steps_+=ns(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):ld.isLeftRoundedCorner(t)&&(this.steps_+=ns(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=ns(this.info_.startX,e):(this.steps_+=ns(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=os("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,ld.isLeftRoundedCorner(e.elements[0])?this.steps_+=os("V",this.outsideCornerPaths_.height):this.steps_+=os("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,n=e.xPos+e.connectionWidth;var i=e.centerline-e.height/2;const r=e.width-e.connectionWidth,s=i+t;this.RTL_?(i=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=ns(n-t,s)+os("v",i)+this.puzzleTabPaths_.pathDown(this.RTL_)+os("v",e)+os("h",r)):this.inlineSteps_+=ns(e.xPos+e.width+t,s)+os("v",e.height)+os("h",-r)+ns(n,i+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},ng=class extends Ld{constructor(e,t){super(e,t),this.highlighter_=new tg(t)}draw(){this.drawOutline_(),this.drawInternals_();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=os("H",e.xPos+e.width)+os("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(n,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},ig=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=is(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e+t)-t,i=is(n,n)+as("a","0 0,0",e,es(-n-t,e-n)),r=as("a","0 0,0",e+t,es(e+t,e+t)),s=is(n,-n)+as("a","0 0,0",e+t,es(e-n,n+t));return{width:e+t,height:e,pathTop:e=>e?i:"",pathBottom:e=>e?r:s}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e-t)+t,i=is(n,n)+as("a","0 0,1",e-t,es(e-n,-n+t)),r=is(t,e)+as("a","0 0,1",e-t,es(e,-e+t)),s=-n,o=is(n,s)+as("a","0 0,1",e-t,es(-n+t,-s-e));return{height:e,topLeft:e=>e?i:r,bottomLeft:()=>o}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,n=is(-2,3.4-t)+rs(-.45*e,-2.1),i=os("v",2.5)+is(.97*-e,2.5)+ts("q",[es(.05*-e,10),es(.3*e,9.5)])+is(.67*e,-1.9)+os("v",2.5),r=os("v",-1.5)+is(-.92*e,-.5)+ts("q",[es(-.19*e,-5.5),es(0,-11)])+is(.92*e,1),s=is(-5,t-.7)+rs(.46*e,-2.1);return{width:e,height:t,pathUp:e=>e?n:r,pathDown:e=>e?i:s}}makeNotch(){return{pathLeft:os("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:rs(5.1,2.6)+is(-10.2,6.8)+rs(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=is(25,-8.7)+ts("c",[es(29.7,-6.2),es(57.2,-.5),es(75,8.7)]),n=ts("c",[es(17.8,-9.2),es(45.3,-14.9),es(75,-8.7)])+ns(100.5,e+.5);return{path:e=>e?t:n}}},rg=class extends bd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},sg=class extends yd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},og=class extends Bd{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof $d||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new rg(this.constants_,e)),t.hasInlineInput=!0):e instanceof $d?(t.elements.push(new sg(this.constants_,e)),t.hasStatement=!0):e instanceof Oo.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new fd(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Dd||e instanceof Pd)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let n,i=0;n=this.rows[i];i++)n.hasExternalInput&&(e=!0);for(let n,i=0;n=this.rows[i];i++){var t=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let e=0;e<t.length-1;e++){n.elements.push(t[e]);const i=this.getInRowSpacing_(t[e],t[e+1]);n.elements.push(new _d(this.constants_,i))}n.elements.push(t[t.length-1]),n.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&n.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),n.elements.push(new _d(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&ld.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ld.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ld.isInput(e)&&(!t||ld.isStatementInput(t)))return ld.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:ld.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ld.isHat(e)?this.constants_.NO_PADDING:ld.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ld.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ld.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}if(!ld.isInput(e)&&t&&ld.isInput(t)){if(ld.isField(e)&&e.isEditable){if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ld.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ld.isIcon(e)&&t&&!ld.isInput(t))return this.constants_.LARGE_PADDING;if(ld.isInlineInput(e)&&t&&ld.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ld.isLeftSquareCorner(e)&&t){if(ld.isHat(t))return this.constants_.NO_PADDING;if(ld.isPreviousConnection(t))return t.notchOffset;if(ld.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(ld.isLeftRoundedCorner(e)&&t){if(ld.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(ld.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return ld.isField(e)&&t&&ld.isField(t)&&e.isEditable===t.isEditable||t&&ld.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ld.isTopRow(e)&&ld.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ld.isTopRow(e)||ld.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ld.isSpacer(t))return e.yPos+t.height/2;if(ld.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ld.isTopRow(e))return ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ld.isField(t)||ld.isIcon(t)?(n+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(n+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):n=ld.isInlineInput(t)?n+t.height/2:n+e.height/2,n}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,n=null;for(let i,r=this.rows.length-1;i=this.rows[r];r--)t.set(i,e),ld.isInputRow(i)&&(i.hasStatement&&this.alignStatementRow_(i),n&&n.hasStatement&&i.width<n.width?t.set(i,n.width):e=i.hasStatement?i.width:Math.max(e,i.width),n=i);e=0;for(let i,r=0;i=this.rows[r];r++)i.hasStatement?e=this.getDesiredRowWidth_(i):ld.isSpacer(i)?i.width=Math.max(e,t.get(i)):(n=i.width,0<(e=Math.max(e,t.get(i))-n)&&this.addAlignmentPadding_(i,e),e=i.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let i,r=0;i=this.rows[r];r++){i.yPos=t,i.xPos=this.startX,t+=i.height,e=Math.max(e,i.widthWithConnectedBlocks);var n=t-this.topRow.ascenderHeight;i===this.bottomRow&&n<this.constants_.MIN_BLOCK_HEIGHT&&(n=this.constants_.MIN_BLOCK_HEIGHT-n,this.bottomRow.height+=n,t+=n),this.recordElemPositions_(i)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},ag=class extends Wd{constructor(e,t,n){super(e,t,n),this.constants=n,this.colourDark="#000000",this.svgPathDark=ie(bl.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=ie(bl.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=xr("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},lg=class extends ep{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new eg}makeRenderInfo_(e){return new og(this,e)}makeDrawer_(e,t){return new ng(e,t)}makePathObject(e,t){return new ag(e,t,this.getConstants())}makeHighlightConstants_(){return new ig(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};xs("geras",lg);var cg={};cg.ConstantProvider=eg,cg.Drawer=ng,cg.HighlightConstantProvider=ig,cg.Highlighter=tg,cg.InlineInput=rg,cg.PathObject=ag,cg.RenderInfo=og,cg.Renderer=lg,cg.StatementInput=sg;var ug=class extends Rd{constructor(){super(),ne("Blockly.minimalist.ConstantProvider","v10","v11","Blockly.blockRendering.ConstantProvider")}},hg=class extends Ld{constructor(e,t){super(e,t),ne("Blockly.minimalist.Drawer","v10","v11","Blockly.blockRendering.Drawer")}},dg=class extends Bd{constructor(e,t){super(e,t),ne("Blockly.minimalist.RenderInfo","v10","v11","Blockly.blockRendering.RenderInfo")}getRenderer(){return this.renderer_}},pg=class extends ep{constructor(e){super(e),ne("Blockly.minimalist.Renderer","v10","v11","Blockly.blockRendering.Renderer")}makeConstants_(){return new ug}makeRenderInfo_(e){return new dg(this,e)}makeDrawer_(e,t){return new hg(e,t)}};xs("minimalist",pg);var fg={};fg.ConstantProvider=ug,fg.Drawer=hg,fg.RenderInfo=dg,fg.Renderer=pg;var gg=class extends Bd{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const i=this.rows[t];var n=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new _d(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){i.elements.push(n[e]);const t=this.getInRowSpacing_(n[e],n[e+1]);i.elements.push(new _d(this.constants_,t))}i.elements.push(n[n.length-1]),i.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&i.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),i.elements.push(new _d(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&ld.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ld.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ld.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ld.isInput(e)&&!t)return ld.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:ld.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ld.isHat(e)?this.constants_.NO_PADDING:ld.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ld.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ld.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ld.isInput(e)&&!t){if(ld.isExternalInput(e))return this.constants_.NO_PADDING;if(ld.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ld.isStatementInput(e))return this.constants_.NO_PADDING}if(!ld.isInput(e)&&t&&ld.isInput(t)){if(ld.isField(e)&&e.isEditable){if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ld.isInlineInput(t)||ld.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ld.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ld.isIcon(e)&&t&&!ld.isInput(t))return this.constants_.LARGE_PADDING;if(ld.isInlineInput(e)&&t&&ld.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ld.isLeftSquareCorner(e)&&t){if(ld.isHat(t))return this.constants_.NO_PADDING;if(ld.isPreviousConnection(t)||ld.isNextConnection(t))return t.notchOffset}return ld.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:ld.isField(e)&&t&&ld.isField(t)&&e.isEditable===t.isEditable||t&&ld.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ld.isTopRow(e)&&ld.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ld.isTopRow(e)||ld.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ld.isSpacer(t))return e.yPos+t.height/2;if(ld.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ld.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ld.isTopRow(e))return ld.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ld.isField(t)&&e.hasStatement?n+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):n+e.height/2}finalize_(){let e=0,t=0;for(var n=0;n<this.rows.length;n++){const r=this.rows[n];r.yPos=t,r.xPos=this.startX,t+=r.height,e=Math.max(e,r.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;r===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,t+=i),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},mg=class extends ep{constructor(e){super(e)}makeRenderInfo_(e){return new gg(this,e)}};xs("thrasos",mg);var vg={};vg.RenderInfo=gg,vg.Renderer=mg;var _g=new bh("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),bg={Classic:yh,Zelos:_g},yg=class{constructor(e,t,n){this.id_=e.toolboxitemid||x(),this.level_=(this.parent_=n||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}},Tg=class extends yg{constructor(e,t,n){super(e,t,n),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(n)}}parseCategoryDef_(e){this.name_="name"in e?kr(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),$n(this.htmlDiv_,Zc.TREEITEM),Bn(this.htmlDiv_,Qc.SELECTED,!1),Bn(this.htmlDiv_,Qc.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),$n(this.iconDom_,Zc.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Bn(this.htmlDiv_,Qc.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&re(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&re(e,t),t="".concat(Tg.nestedPadding*this.getLevel(),"px"),this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&re(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&re(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&re(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Tg.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(null==(e=kr(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=Tr(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Mr(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&se(e,t),(t=this.cssConfig_.openicon)&&re(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&se(e,t),(t=this.cssConfig_.closedicon)&&re(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const e=this.parseColour_(Tg.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,t&&re(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&oe(this.rowDiv_,t);Bn(this.htmlDiv_,Qc.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled","".concat(e)),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"===typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Be(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){le(this.htmlDiv_)}};Tg.registrationName="category",Tg.nestedPadding=19,Tg.borderWidth=8,Tg.defaultBackgroundColour="#57e",ee('\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n'),e(Bo.TOOLBOX_ITEM,Tg.registrationName,Tg);var Eg=class extends yg{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&re(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){le(this.htmlDiv_)}};Eg.registrationName="sep",ee('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),e(Bo.TOOLBOX_ITEM,Eg.registrationName,Eg);var Sg=class extends Tg{constructor(e,t,n){super(e,t,n),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let n=0;n<t.length;n++){const i=t[n];!s(Bo.TOOLBOX_ITEM,i.kind)||i.kind.toLowerCase()===Eg.registrationName&&e?(this.flyoutItems_.push(i),e=!0):(this.createToolboxItem_(i),e=!1)}}}}createToolboxItem_(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&ze(e)&&(t=Sg.registrationName),e=new(o(Bo.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),$n(this.subcategoriesDiv_,Zc.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Bn(this.htmlDiv_,Qc.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&re(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var n=this.cssConfig_.contents;for(n&&re(t,n),n=0;n<e.length;n++){const i=e[n];i.init();const r=i.getDiv();if(t.appendChild(r),i.getClickTarget){let e;null==(e=i.getClickTarget())||e.setAttribute("id",i.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let e;null==(e=this.parentToolbox_.getFlyout())||e.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Bn(this.htmlDiv_,Qc.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let n=0;n<t.length;n++)t[n].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Sg.registrationName="collapsibleCategory",e(Bo.TOOLBOX_ITEM,Sg.registrationName,Sg);var wg=class extends Rp{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),ce(this.flyout_.createDom("svg"),t),this.setVisible(!0),this.flyout_.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[sl.Capability.AUTOHIDEABLE,sl.Capability.DELETE_AREA,sl.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,$n(this.contentsDiv_,Zc.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),re(e,"blocklyToolboxDiv"),re(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return re(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=j(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=j(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(q(e)||e.target===this.HtmlDiv)f().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),f().hideChaff(!0)}H()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext_();break;case"ArrowUp":t=this.selectPrevious_();break;case"ArrowLeft":t=this.selectParent_();break;case"ArrowRight":t=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new Th({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?c(Bo.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):c(Bo.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const e=this.contents_[t];e&&e.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let n=0;n<e.length;n++)this.createToolboxItem_(e[n],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var n=e.kind;"CATEGORY"===n.toUpperCase()&&ze(e)&&(n=Sg.registrationName),(n=o(Bo.TOOLBOX_ITEM,n.toLowerCase()))&&((e=new n(e,this)).init(),this.addToolboxItem_(e),(n=e.getDiv())&&t.appendChild(n),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&re(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&oe(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,n=t+e.height,i=e.left;return e=i+e.width,this.toolboxPosition===Pl.TOP?new yl(-1e7,n,-1e7,1e7):this.toolboxPosition===Pl.BOTTOM?new yl(t,1e7,-1e7,1e7):this.toolboxPosition===Pl.LEFT?new yl(-1e7,1e7,-1e7,e):new yl(-1e7,1e7,i,1e7)}wouldDelete(e,t){return e instanceof Ip?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Pl.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Pl.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===Pl.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===Pl.TOP?e.scrollY+t.height:e.scrollY),y(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Ro(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),Bn(this.contentsDiv_,Qc.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Bn(this.contentsDiv_,Qc.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e]).isSelectable()&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const n=e&&e.getName();let i=t&&t.getName();e===t&&(i=null),e=new(B(la))(n,i,this.workspace_.id),k(e)}selectParent_(){return!!this.selectedItem_&&(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):!(!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable())&&(this.setSelectedItem(this.selectedItem_.getParent()),!0))}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)Y(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),le(this.HtmlDiv))}};ee('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n'),e(Bo.TOOLBOX,$o,wg);var xg="10.3.1",Mg=Oo.Align$$module$build$src$core$inputs$align.LEFT,Ig=Oo.Align$$module$build$src$core$inputs$align.CENTRE,Cg=Oo.Align$$module$build$src$core$inputs$align.RIGHT,kg=Gc.INPUT_VALUE,Rg=Gc.OUTPUT_VALUE,Ag=Gc.NEXT_STATEMENT,Lg=Gc.PREVIOUS_STATEMENT,Og=Oo.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,Ng=Pl.TOP,Dg=Pl.BOTTOM,Pg=Pl.LEFT,$g=Pl.RIGHT;cp.prototype.newBlock=function(e,t){return new _p(this,e,t)},fp.prototype.newBlock=function(e,t){return new Ip(this,e,t)},fp.newTrashcan=function(e){return new Ap(e)},mc.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(li(this)),t.push(ai(this))),ei(e,t,this.RTL)}},zh.prototype.newWorkspaceSvg=function(e){return new fp(e)},Oo.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=us(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Oo.Names$$module$build$src$core$names.NameType.PROCEDURE)};var Bg=Gc,Fg={ALIGN_CENTRE:Ig,ALIGN_LEFT:Mg,ALIGN_RIGHT:Cg};return Fg.ASTNode=Fd,Fg.BasicCursor=Tp,Fg.Block=_p,Fg.BlockDragger=lf,Fg.BlockSvg=Ip,Fg.Blocks=Ho,Fg.Bubble=Bh,Fg.BubbleDragger=Hu,Fg.COLLAPSED_FIELD_NAME=Yd,Fg.COLLAPSED_INPUT_NAME=Xd,Fg.COLLAPSE_CHARS=Gu,Fg.CodeGenerator=Oo.CodeGenerator$$module$build$src$core$generator,Fg.CollapsibleToolboxCategory=Sg,Fg.ComponentManager=sl,Fg.Connection=jd,Fg.ConnectionChecker=sp,Fg.ConnectionDB=Wc,Fg.ConnectionType=Gc,Fg.ContextMenu=gu,Fg.ContextMenuItems=Pf,Fg.ContextMenuRegistry=mu,Fg.Css=ll,Fg.Cursor=yp,Fg.DELETE_VARIABLE_ID=Xu,Fg.DRAG_STACK=Vu,Fg.DUMMY_INPUT=Og,Fg.DeleteArea=Rp,Fg.DragTarget=kp,Fg.DropDownDiv=Pu,Fg.Events=Tf,Fg.Extensions=Wh,Fg.Field=Ch,Fg.FieldAngle=Bf,Fg.FieldCheckbox=Uf,Fg.FieldColour=zf,Fg.FieldDropdown=Dh,Fg.FieldImage=wf,Fg.FieldLabel=Od,Fg.FieldLabelSerializable=Hf,Fg.FieldMultilineInput=Gf,Fg.FieldNumber=Vf,Fg.FieldTextInput=Mf,Fg.FieldVariable=Wf,Fg.Flyout=Kf,Fg.FlyoutButton=jf,Fg.FlyoutMetricsManager=Yf,Fg.Generator=Oo.CodeGenerator$$module$build$src$core$generator,Fg.Gesture=gh,Fg.Grid=mh,Fg.HorizontalFlyout=qf,Fg.INPUT_VALUE=kg,Fg.Input=Nd,Fg.InsertionMarkerManager=Jd,Fg.Marker=bp,Fg.MarkerManager=vh,Fg.Menu=ru,Fg.MenuItem=su,Fg.MetricsManager=rf,Fg.Msg=Oo.Msg$$module$build$src$core$msg,Fg.NEXT_STATEMENT=Ag,Fg.Names=Oo.Names$$module$build$src$core$names,Fg.OPPOSITE_TYPE=Wu,Fg.OUTPUT_VALUE=Rg,Fg.Options=Th,Fg.PREVIOUS_STATEMENT=Lg,Fg.PROCEDURE_CATEGORY_NAME=sd,Fg.Procedures=od,Fg.RENAME_VARIABLE_ID=ju,Fg.RenderedConnection=wp,Fg.Scrollbar=Il,Fg.ScrollbarPair=nf,Fg.ShortcutItems=Kp,Fg.ShortcutRegistry=jp,Fg.TOOLBOX_AT_BOTTOM=Dg,Fg.TOOLBOX_AT_LEFT=Pg,Fg.TOOLBOX_AT_RIGHT=$g,Fg.TOOLBOX_AT_TOP=Ng,Fg.TabNavigateCursor=Ep,Fg.Theme=bh,Fg.ThemeManager=np,Fg.Themes=bg,Fg.Toolbox=wg,Fg.ToolboxCategory=Tg,Fg.ToolboxItem=yg,Fg.ToolboxSeparator=Eg,Fg.Tooltip=hh,Fg.Touch=Wa,Fg.Trashcan=Ap,Fg.UnattachedFieldError=kh,Fg.VARIABLE_CATEGORY_NAME=sc,Fg.VARIABLE_DYNAMIC_CATEGORY_NAME=ip,Fg.VERSION=xg,Fg.VariableMap=lp,Fg.VariableModel=rc,Fg.Variables=lc,Fg.VariablesDynamic=rp,Fg.VerticalFlyout=Jf,Fg.WidgetDiv=hu,Fg.Workspace=cp,Fg.WorkspaceAudio=hp,Fg.WorkspaceComment=cc,Fg.WorkspaceCommentSvg=mc,Fg.WorkspaceDragger=dh,Fg.WorkspaceSvg=fp,Fg.Xml=Sc,Fg.ZoomControls=jl,Fg.blockAnimations=Fu,Fg.blockRendering=tp,Fg.browserEvents=nl,Fg.bubbles=cf,Fg.bumpObjects=af,Fg.clipboard=Jc,Fg.common=Xo,Fg.config=Oo.config$$module$build$src$core$config,Fg.connectionTypes=Bg,Fg.constants=Kd,Fg.defineBlocksWithJsonArray=S,Fg.dialog=ec,Fg.fieldRegistry=Nh,Fg.geras=cg,Fg.getMainWorkspace=f,Fg.getSelected=m,Fg.hasBubble=mr,Fg.hideChaff=Ao,Fg.icons=ad,Fg.inject=To,Fg.inputTypes=Oo.inputTypes$$module$build$src$core$inputs$input_types,Fg.inputs=Qf,Fg.isCopyable=Ns,Fg.isIcon=Co,Fg.isObservable=Or,Fg.isPaster=ko,Fg.isSerializable=nn,Fg.isVariableBackedParameterModel=nt,Fg.minimalist=fg,Fg.procedures=od,Fg.registry=Fo,Fg.renderManagement=Ec,Fg.serialization=tf,Fg.setLocale=Yl,Fg.setParentContainer=b,Fg.svgResize=y,Fg.thrasos=vg,Fg.uiPosition=Vl,Fg.utils=Xh,Fg.zelos=Df,Object.defineProperties(Fg,{HSV_SATURATION:{get:function(){return ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.getHsvSaturation()"),vr()},set:function(e){ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.setHsvSaturation()"),_r(e)}},HSV_VALUE:{get:function(){return ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.getHsvValue()"),br()},set:function(e){ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.setHsvValue()"),yr(e)}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:Kl}),Fg.__namespace__=Oo,Fg},void 0===(s="function"===typeof i?i.apply(t,r):i)||(e.exports=s)},720:function(e,t,n){var i,r,s;r=[n(657)],void 0===(s="function"===typeof(i=function(e){return e})?i.apply(t,r):i)||(e.exports=s)},657:function(e,t,n){var i,r,s;r=[n(363)],void 0===(s="function"===typeof(i=function(e){var t=e.__namespace__,n=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),i={customContextMenu:function(e){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(i={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:r(this)},o=this.getField("VAR").getText(),o={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",o),enabled:!0,callback:s(this)},e.unshift(i),e.unshift(o));else{if("variables_get_dynamic"===this.type)var n="variables_set_dynamic",i=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get_dynamic",i=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var o=this.getField("VAR");n={type:n,fields:{VAR:o.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:i.replace("%1",o.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}},onchange:function(e){e=this.getFieldValue("VAR"),e=t.getVariable$$module$build$src$core$variables(this.workspace,e),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(e.type):this.getInput("VALUE").connection.setCheck(e.type)}},r=function(e){return function(){const n=e.workspace,i=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,i)}},s=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",i),t.defineBlocks$$module$build$src$core$common(n);var o={blocks:n},a=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),l={customContextMenu:function(e){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(i={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:c(this)},r=this.getField("VAR").getText(),r={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:u(this)},e.unshift(i),e.unshift(r));else{if("variables_get"===this.type)var n="variables_set",i=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get",i=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var r=this.getField("VAR");n={type:n,fields:{VAR:r.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:i.replace("%1",r.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}},c=function(e){return function(){const n=e.workspace,i=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,i)}},u=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",l),t.defineBlocks$$module$build$src$core$common(a);var h={blocks:a},d=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),p={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1","".concat(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2","".concat(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const i=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});i.setValidator((function(t){const i="FROM_START"===t||"FROM_END"===t;if(i!==n){const n=this.getSourceBlock();return n.updateAt_(e,i),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(i,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};d.text_getSubstring=p,d.text_changeCase={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},d.text_trim={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},d.text_print={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var f={updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}};d.text_prompt_ext=Object.assign({},f,{init:function(){var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});var g=Object.assign({},f,{init:function(){this.mixin(m);var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});d.text_prompt=g,d.text_count={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},d.text_replace={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},d.text_reverse={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var m={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(let t,n=0;t=this.inputList[n];n++)for(let i,r=0;i=t.fieldRow[r];r++)if(e===i.name)return t.insertFieldAt(r,this.newQuote_(!0)),void t.insertFieldAt(r+2,this.newQuote_(!1));console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,t.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"\u201c":"\u201d"})}},v=function(){this.mixin(m),this.quoteField_("TEXT")},_={itemCount_:0,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items","".concat(this.itemCount_)),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("text_create_join_container");t.initSvg();let n=t.getInput("STACK").connection;for(let i=0;i<this.itemCount_;i++){const t=e.newBlock("text_create_join_item");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);e.valueConnection_=n&&n.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}},b=function(){this.mixin(m),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};t.register$$module$build$src$core$extensions("text_append_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var y=function(){this.setTooltip((()=>t.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))},T={isAt_:!1,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at","".concat(this.isAt_)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}},E=function(){this.getField("WHERE").setValidator((function(e){e="FROM_START"===e||"FROM_END"===e;const t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)})),this.updateAt_(!0),this.setTooltip((()=>{var e=this.getFieldValue("WHERE");let n=t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===e||"FROM_END"===e)&&(e="FROM_START"===e?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(n+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),n}))};t.register$$module$build$src$core$extensions("text_indexOf_tooltip",y),t.register$$module$build$src$core$extensions("text_quotes",v),t.registerMixin$$module$build$src$core$extensions("quote_image_mixin",m),t.registerMutator$$module$build$src$core$extensions("text_join_mutator",_,b),t.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",T,E),t.defineBlocks$$module$build$src$core$common(d);var S={blocks:d},w={},x={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=t.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{t.enable$$module$build$src$core$events$utils()}},mutationToDom:function(e){const n=t.createElement$$module$build$src$core$utils$xml("mutation");e&&n.setAttribute("name",this.getFieldValue("NAME"));for(let i=0;i<this.argumentVarModels_.length;i++){const r=t.createElement$$module$build$src$core$utils$xml("arg"),s=this.argumentVarModels_[i];r.setAttribute("name",s.name),r.setAttribute("varid",s.getId()),e&&this.paramIds_&&r.setAttribute("paramId",this.paramIds_[i]),n.appendChild(r)}return this.hasStatements_||n.setAttribute("statements","false"),n},domToMutation:function(e){this.arguments_=[],this.argumentVarModels_=[];for(let i,r=0;i=e.childNodes[r];r++)if("arg"===i.nodeName.toLowerCase()){var n=i;const e=n.getAttribute("name");n=n.getAttribute("varid")||n.getAttribute("varId"),this.arguments_.push(e),null!==(n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n,e,""))?this.argumentVarModels_.push(n):console.log('Failed to create a variable named "'.concat(e,'", ignoring.'))}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==e.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const e=Object.create(null);if(this.argumentVarModels_.length){e.params=[];for(let t=0;t<this.argumentVarModels_.length;t++)e.params.push({name:this.argumentVarModels_[t].name,id:this.argumentVarModels_[t].getId()})}return this.hasStatements_||(e.hasStatements=!1),e},loadExtraState:function(e){if(this.arguments_=[],this.argumentVarModels_=[],e.params)for(let i=0;i<e.params.length;i++){var n=e.params[i];n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n.id,n.name,""),this.arguments_.push(n.name),this.argumentVarModels_.push(n)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==e.hasStatements)},decompose:function(e){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorcontainer");var i=t.createElement$$module$build$src$core$utils$xml("statement");i.setAttribute("name","STACK"),n.appendChild(i);for(let s=0;s<this.arguments_.length;s++){const e=t.createElement$$module$build$src$core$utils$xml("block");e.setAttribute("type","procedures_mutatorarg");var r=t.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME");const n=t.createTextNode$$module$build$src$core$utils$xml(this.arguments_[s]);r.appendChild(n),e.appendChild(r),r=t.createElement$$module$build$src$core$utils$xml("next"),e.appendChild(r),i.appendChild(e),i=r}return e=t.domToBlock$$module$build$src$core$xml(n,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),t.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let n=e.getInputTargetBlock("STACK");for(;n&&!n.isInsertionMarker();){var i=n.getFieldValue("NAME");this.arguments_.push(i),i=this.workspace.getVariable(i,""),this.argumentVarModels_.push(i),this.paramIds_.push(n.id),n=n.nextConnection&&n.nextConnection.targetBlock()}if(this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&(e="TRUE"===e,this.hasStatements_!==e))if(e){var r;this.setStatements_(!0),null==(r=this.statementConnection_)||r.reconnect(this,"STACK"),this.statementConnection_=null}else r=this.getInput("STACK").connection,(this.statementConnection_=r.targetConnection)&&((r=r.targetBlock()).unplug(),r.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,n){var i=this.workspace.getVariableById(e);if(""===i.type){i=i.name,n=this.workspace.getVariableById(n);var r=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e&&(this.arguments_[t]=n.name,this.argumentVarModels_[t]=n,r=!0);r&&(this.displayRenamedVar_(i,n.name),t.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(e){const n=e.name;let i,r=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e.getId()&&(i=this.arguments_[t],this.arguments_[t]=n,r=!0);r&&(this.displayRenamedVar_(i,n),t.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(e,n){this.updateParams_();var i=this.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(i&&i.bubbleIsVisible()){i=i.getWorkspace().getAllBlocks(!1);for(let r,s=0;r=i[s];s++)"procedures_mutatorarg"===r.type&&t.Names$$module$build$src$core$names.equals(e,r.getFieldValue("NAME"))&&r.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var n=this.getFieldValue("NAME"),i={type:this.callType_,extraState:{name:n,params:this.arguments_}};if(e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",n),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,i)}),!this.isCollapsed())for(n=0;n<this.argumentVarModels_.length;n++){const r={type:"variables_get",fields:{VAR:{name:(i=this.argumentVarModels_[n]).name,id:i.getId(),type:i.type}}};e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i.name),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,r)})}}}};w.procedures_defnoreturn=Object.assign({},x,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),w.procedures_defreturn=Object.assign({},x,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var M={init:function(){this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};w.procedures_mutatorcontainer=M;var I={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:t.DEFAULT_ARG$$module$build$src$core$procedures});e.setValidator(this.validator_),e.oldShowEditorFn_=e.showEditor_,e.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,e.onFinishEditing_=this.deleteIntermediateVars_,e.createdVariables_=[],e.onFinishEditing_("x")},validator_:function(e){var t=this.getSourceBlock();const n=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const i=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),r=e.toLowerCase();for(let s=0;s<i.length;s++){if(i[s].id===this.getSourceBlock().id)continue;const e=i[s].getFieldValue("NAME");if(e&&e.toLowerCase()===r)return null}return t.isInFlyout||((t=n.getVariable(e,""))&&t.name!==e&&n.renameVariableById(t.getId(),e),t||(t=n.createVariable(e,""))&&this.createdVariables_&&this.createdVariables_.push(t)),e},deleteIntermediateVars_:function(e){const t=this.getSourceBlock().workspace.getRootWorkspace();if(t)for(let n=0;n<this.createdVariables_.length;n++){const i=this.createdVariables_[n];i.name!==e&&t.deleteVariableById(i.getId())}}};w.procedures_mutatorarg=I;var C={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,n){t.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(n,"NAME"),this.setTooltip((this.outputConnection?t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",n)))},setProcedureParameters_:function(e,n){var i=t.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((i=(i=i&&i.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&i.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=n;else{if(n.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var r=this.getInput("ARG"+e);r&&(r=r.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=r,i&&r&&-1===n.indexOf(this.quarkIds_[e])&&(r.disconnect(),r.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)i=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(i);if(this.updateShape_(),this.quarkIds_=n)for(n=0;n<this.arguments_.length;n++)if((e=this.quarkIds_[n])in this.quarkConnections_){let t;null!=(t=this.quarkConnections_[e])&&t.reconnect(this,"ARG"+n)||delete this.quarkConnections_[e]}}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var n=this.getField("ARGNAME"+e);if(n){t.disable$$module$build$src$core$events$utils();try{n.setValue(this.arguments_[e])}finally{t.enable$$module$build$src$core$events$utils()}}else n=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(n,"ARGNAME"+e).init()}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(e.appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),e.init()):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("name",this.getProcedureCall());for(let n=0;n<this.arguments_.length;n++){const i=t.createElement$$module$build$src$core$utils$xml("arg");i.setAttribute("name",this.arguments_[n]),e.appendChild(i)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];const n=[];for(let i,r=0;i=e.childNodes[r];r++)"arg"===i.nodeName.toLowerCase()&&(t.push(i.getAttribute("name")),n.push(i.getAttribute("paramId")));this.setProcedureParameters_(t,n)},saveExtraState:function(){const e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){if(this.renameProcedure(this.getProcedureCall(),e.name),e=e.params){const t=[];t.length=e.length,t.fill(null),this.setProcedureParameters_(e,t)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===t.CREATE$$module$build$src$core$events$utils&&-1!==e.ids.indexOf(this.id)){var n=this.getProcedureCall();if(!(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))||n.type===this.defType_&&JSON.stringify(n.getVars())===JSON.stringify(this.arguments_)||(n=null),!n){t.setGroup$$module$build$src$core$events$utils(e.group),e=t.createElement$$module$build$src$core$utils$xml("xml"),(n=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var i=this.getRelativeToSurfaceXY(),r=i.y+2*t.config$$module$build$src$core$config.snapRadius;n.setAttribute("x","".concat(i.x+t.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1))),n.setAttribute("y","".concat(r)),i=this.mutationToDom(),n.appendChild(i),(i=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),r=this.getProcedureCall();const s=t.findLegalName$$module$build$src$core$procedures(r,this);r!==s&&this.renameProcedure(r,s),i.appendChild(t.createTextNode$$module$build$src$core$utils$xml(r)),n.appendChild(i),e.appendChild(n),t.domToWorkspace$$module$build$src$core$xml(e,this.workspace),t.setGroup$$module$build$src$core$events$utils(!1)}}else e.type===t.DELETE$$module$build$src$core$events$utils?(n=this.getProcedureCall(),t.getDefinition$$module$build$src$core$procedures(n,this.workspace)||(t.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),t.setGroup$$module$build$src$core$events$utils(!1))):e.type===t.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element&&(n=this.getProcedureCall(),(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))&&n.id===e.blockId&&((n=t.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),t.setGroup$$module$build$src$core$events$utils(e.group),e.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.setGroup$$module$build$src$core$events$utils(n)))},customContextMenu:function(e){if(this.workspace.isMovable()){var n=this.getProcedureCall(),i=this.workspace;e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const e=t.getDefinition$$module$build$src$core$procedures(n,i);e&&(i.centerOnBlock(e.id),e.select())}})}}};w.procedures_callnoreturn=Object.assign({},C,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),w.procedures_callreturn=Object.assign({},C,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"});var k={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==t.MOVE$$module$build$src$core$events$utils)){var n=!1,i=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(i.type)){n=!0;break}i=i.getSurroundParent()}while(i);n?("procedures_defnoreturn"===i.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==i.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(i=t.getGroup$$module$build$src$core$events$utils(),t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(i))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};w.procedures_ifreturn=k,t.defineBlocks$$module$build$src$core$common(w);var R={blocks:w},A=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),L={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};t.register$$module$build$src$core$extensions("math_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",L));var O={mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(n)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){const t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}},N=function(){this.getField("PROPERTY").setValidator((function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)}))};t.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",O,N),t.register$$module$build$src$core$extensions("math_change_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var D={updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}},P=function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))};t.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",D,P),t.defineBlocks$$module$build$src$core$common(A);var $={blocks:A},B=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),F={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};t.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",F));var U={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};t.register$$module$build$src$core$extensions("controls_flow_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",U));var z={customContextMenu:function(e){if(!this.isInFlyout){var n=this.getField("VAR"),i=n.getVariable().name;this.isCollapsed()||null===i||(n={type:"variables_get",fields:{VAR:n.saveState(!0)}},e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}};t.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",z),t.register$$module$build$src$core$extensions("controls_for_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("controls_forEach_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var H=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),G={getSurroundLoop:function(){let e=this;do{if(H.has(e.type))return e;e=e.getSurroundParent()}while(e);return null},onchange:function(e){var n=this.workspace;if(n.isDragging&&!n.isDragging()&&e.type===t.MOVE$$module$build$src$core$events$utils&&(n=!!this.getSurroundLoop(),this.setWarningText(n?null:t.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const i=t.getGroup$$module$build$src$core$events$utils();t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(i)}}};t.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",G),t.defineBlocks$$module$build$src$core$common(B);var V={blocks:B,loopTypes:H},W=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),j={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};t.register$$module$build$src$core$extensions("logic_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",j));var X={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=t.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=Object.create(null);return this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(e){const t=e.newBlock("controls_if_if");t.initSvg();let n=t.nextConnection;for(let i=1;i<=this.elseifCount_;i++){const t=e.newBlock("controls_if_elseif");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),n.connect(e.previousConnection)),t},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const t=[null],n=[null];let i=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),n.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,i=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,n,i)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var n=this.getInput("IF"+t);const i=this.getInput("DO"+t);e.valueConnection_=n&&n.connection.targetConnection,e.statementConnection_=i&&i.connection.targetConnection,t++;break;case"controls_if_else":n=this.getInput("ELSE"),e.statementConnection_=n&&n.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);for(let i=1;this.getInput("IF"+i);i++){const n=this.getInput("IF"+i),r=this.getInput("DO"+i);e.push(n.connection.targetConnection),t.push(r.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(e,t,n){for(let i=1;i<=this.elseifCount_;i++){let n,r;null==(n=e[i])||n.reconnect(this,"IF"+i),null==(r=t[i])||r.reconnect(this,"DO"+i)}null==n||n.reconnect(this,"ELSE")}};t.registerMutator$$module$build$src$core$extensions("controls_if_mutator",X,null,["controls_if_elseif","controls_if_else"]);var Y=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))};t.register$$module$build$src$core$extensions("controls_if_tooltip",Y);var K={onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var n=this.getInputTargetBlock("A");const i=this.getInputTargetBlock("B");n&&i&&!this.workspace.connectionChecker.doTypeChecks(n.outputConnection,i.outputConnection)&&(t.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==n&&(n.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(n=this.prevBlocks_[1])!==i&&(i.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("B").connection.connect(n.outputConnection)),this.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},q=function(){this.mixin(K)};t.register$$module$build$src$core$extensions("logic_compare",q);var J={prevParentConnection_:null,onchange:function(e){const n=this.getInputTargetBlock("THEN"),i=this.getInputTargetBlock("ELSE"),r=this.outputConnection.targetConnection;if((n||i)&&r)for(let s=0;2>s;s++){const o=1===s?n:i;o&&!o.workspace.connectionChecker.doTypeChecks(o.outputConnection,r)&&(t.setGroup$$module$build$src$core$events$utils(e.group),r===this.prevParentConnection_?(this.unplug(),r.getSourceBlock().bumpNeighbours()):(o.unplug(),o.bumpNeighbours()),t.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=r}};t.registerMixin$$module$build$src$core$extensions("logic_ternary",J),t.defineBlocks$$module$build$src$core$common(W);var Z=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),Q={init:function(){this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("lists_create_with_container");t.initSvg();let n=t.getInput("STACK").connection;for(let i=0;i<this.itemCount_;i++){const t=e.newBlock("lists_create_with_item");if(t.initSvg(),!t.previousConnection)throw Error("itemBlock has no previousConnection");n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);let i;e.valueConnection_=null==(i=n)?void 0:i.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};Z.lists_create_with=Q;var ee={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};Z.lists_create_with_container=ee;var te={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};Z.lists_create_with_item=te;var ne={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip((()=>t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))}};Z.lists_indexOf=ne;var ie={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)})),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let i="";switch(e+" "+n){case"GET FROM_START":case"GET FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(i+="  "+("FROM_START"===n?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("statement",String(!this.outputConnection));const n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"===typeof e&&this.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.getInput("AT").appendField(n,"WHERE"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};Z.lists_getIndex=ie;var re={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let i="";switch(e+" "+n){case"SET FROM_START":case"SET FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(i+="  "+t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(n,"WHERE")}};Z.lists_setIndex=re;var se={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e);const i=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});i.setValidator((function(t){const i="FROM_START"===t||"FROM_END"===t;if(i!==n){const n=this.getSourceBlock();return n.updateAt_(e,i),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(i,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};Z.lists_getSublist=se,Z.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},Z.lists_split={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator((e=>{this.updateType_(e)})),this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((()=>{const e=this.getFieldValue("MODE");if("SPLIT"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)}))},updateType_:function(e){if(this.getFieldValue("MODE")!==e){const e=this.getInput("INPUT").connection;e.setShadowDom(null);const t=e.targetBlock();t&&(e.disconnect(),t.isShadow()?t.dispose(!1):this.bumpNeighbours())}"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},t.defineBlocks$$module$build$src$core$common(Z);var oe={blocks:Z},ae=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]);t.defineBlocks$$module$build$src$core$common(ae);var le={blocks:ae},ce={blocks:Object.assign({},ae,Z,W,B,A,w,a,n),colour:le,lists:oe,loops:V,math:$,procedures:R,texts:S,variables:h,variablesDynamic:o};return ce.__namespace__=t,ce})?i.apply(t,r):i)||(e.exports=s)},285:function(e,t,n){var i,r,s;r=[n(30),n(130),n(720),n(505)],void 0===(s="function"===typeof(i=function(e,t,n,i){"use strict";return e.setLocale(t),e})?i.apply(t,r):i)||(e.exports=s)},30:function(e,t,n){var i,r,s;r=[n(478)],void 0===(s="function"===typeof(i=function(e){"use strict";return e})?i.apply(t,r):i)||(e.exports=s)},271:function(e,t,n){var i,r,s;r=[n(285)],void 0===(s="function"===typeof(i=function(e){return e})?i.apply(t,r):i)||(e.exports=s)},505:function(e,t,n){var i,r,s;r=[n(30),n(952)],void 0===(s="function"===typeof(i=function(e,t){return t})?i.apply(t,r):i)||(e.exports=s)},952:function(e,t,n){var i,r,s;r=[n(363)],i=function(e){var t,n,i=e.__namespace__,r=function(e,n){return[n.quote_(e.getFieldValue("COLOUR")),t.ATOMIC]},s=function(e,n){return[n.provideFunction_("colourRandom","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"() {\n  var num = Math.floor(Math.random() * Math.pow(2, 24));\n  return '#' + ('00000' + num.toString(16)).substr(-6);\n}\n"))+"()",t.FUNCTION_CALL]},o=function(e,n){const i=n.valueToCode(e,"RED",t.NONE)||0,r=n.valueToCode(e,"GREEN",t.NONE)||0;return e=n.valueToCode(e,"BLUE",t.NONE)||0,[n.provideFunction_("colourRgb","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(r, g, b) {\n  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;\n  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;\n  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;\n  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);\n  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);\n  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n"))+"("+i+", "+r+", "+e+")",t.FUNCTION_CALL]},a=function(e,n){const i=n.valueToCode(e,"COLOUR1",t.NONE)||"'#000000'",r=n.valueToCode(e,"COLOUR2",t.NONE)||"'#000000'";return e=n.valueToCode(e,"RATIO",t.NONE)||.5,[n.provideFunction_("colourBlend","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(c1, c2, ratio) {\n  ratio = Math.max(Math.min(Number(ratio), 1), 0);\n  var r1 = parseInt(c1.substring(1, 3), 16);\n  var g1 = parseInt(c1.substring(3, 5), 16);\n  var b1 = parseInt(c1.substring(5, 7), 16);\n  var r2 = parseInt(c2.substring(1, 3), 16);\n  var g2 = parseInt(c2.substring(3, 5), 16);\n  var b2 = parseInt(c2.substring(5, 7), 16);\n  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);\n  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);\n  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);\n  r = ('0' + (r || 0).toString(16)).slice(-2);\n  g = ('0' + (g || 0).toString(16)).slice(-2);\n  b = ('0' + (b || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n"))+"("+i+", "+r+", "+e+")",t.FUNCTION_CALL]},l=function(e,n){return["[]",t.ATOMIC]},c=function(e,n){const i=Array(e.itemCount_);for(let r=0;r<e.itemCount_;r++)i[r]=n.valueToCode(e,"ADD"+r,t.NONE)||"null";return["["+i.join(", ")+"]",t.ATOMIC]},u=function(e,n){return[n.provideFunction_("listsRepeat","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n}\n"))+"("+(n.valueToCode(e,"ITEM",t.NONE)||"null")+", "+(e=n.valueToCode(e,"NUM",t.NONE)||"0")+")",t.FUNCTION_CALL]},h=function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.MEMBER]},d=function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.LOGICAL_NOT]},p=function(e,n){const i="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",r=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+"."+i+"("+r+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},f=function(e,n){const i=e.getFieldValue("MODE")||"GET",r=e.getFieldValue("WHERE")||"FROM_START";var s=n.valueToCode(e,"VALUE","RANDOM"===r?t.NONE:t.MEMBER)||"[]";switch(r){case"FIRST":if("GET"===i)return[s+"[0]",t.MEMBER];if("GET_REMOVE"===i)return[s+".shift()",t.MEMBER];if("REMOVE"===i)return s+".shift();\n";break;case"LAST":if("GET"===i)return[s+".slice(-1)[0]",t.MEMBER];if("GET_REMOVE"===i)return[s+".pop()",t.MEMBER];if("REMOVE"===i)return s+".pop();\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"GET"===i)return[s+"["+e+"]",t.MEMBER];if("GET_REMOVE"===i)return[s+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===i)return s+".splice("+e+", 1);\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!0),"GET"===i)return[s+".slice("+e+")[0]",t.FUNCTION_CALL];if("GET_REMOVE"===i)return[s+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===i)return s+".splice("+e+", 1);";break;case"RANDOM":if(s=n.provideFunction_("listsGetRandomItem","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(list, remove) {\n  var x = Math.floor(Math.random() * list.length);\n  if (remove) {\n    return list.splice(x, 1)[0];\n  } else {\n    return list[x];\n  }\n}\n"))+"("+s+", "+("GET"!==i)+")","GET"===i||"GET_REMOVE"===i)return[s,t.FUNCTION_CALL];if("REMOVE"===i)return s+";\n"}throw Error("Unhandled combination (lists_getIndex).")},g=function(e,n){function r(){if(s.match(/^\w+$/))return"";const e=n.nameDB_.getDistinctName("tmpList",i.NameType$$module$build$src$core$names.VARIABLE),t="var "+e+" = "+s+";\n";return s=e,t}let s=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const o=e.getFieldValue("MODE")||"GET";var a=e.getFieldValue("WHERE")||"FROM_START";const l=n.valueToCode(e,"TO",t.ASSIGNMENT)||"null";switch(a){case"FIRST":if("SET"===o)return s+"[0] = "+l+";\n";if("INSERT"===o)return s+".unshift("+l+");\n";break;case"LAST":if("SET"===o)return r()+(s+"[")+s+".length - 1] = "+l+";\n";if("INSERT"===o)return s+".push("+l+");\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"SET"===o)return s+"["+e+"] = "+l+";\n";if("INSERT"===o)return s+".splice("+e+", 0, "+l+");\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!1,t.SUBTRACTION),a=r(),"SET"===o)return a+(s+"[")+s+".length - "+e+"] = "+l+";\n";if("INSERT"===o)return a+(s+".splice(")+s+".length - "+e+", 0, "+l+");\n";break;case"RANDOM":if(e=r(),e+="var "+(a=n.nameDB_.getDistinctName("tmpX",i.NameType$$module$build$src$core$names.VARIABLE))+" = Math.floor(Math.random() * "+s+".length);\n","SET"===o)return e+(s+"[")+a+"] = "+l+";\n";if("INSERT"===o)return e+(s+".splice(")+a+", 0, "+l+");\n"}throw Error("Unhandled combination (lists_setIndex).")},m=function(e,n){var i={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},r=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const s=e.getFieldValue("WHERE1"),o=e.getFieldValue("WHERE2");if("FIRST"===s&&"LAST"===o)r+=".slice(0)";else if(r.match(/^\w+$/)||"FROM_END"!==s&&"FROM_START"===o){switch(s){case"FROM_START":i=n.getAdjusted(e,"AT1");break;case"FROM_END":i=r+".length - "+(i=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=r+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=r+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}r=r+".slice("+i+", "+n+")"}else{const t=n.getAdjusted(e,"AT1");e=n.getAdjusted(e,"AT2"),r=n.provideFunction_("subsequence"+i[s]+i[o],"\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(sequence").concat("FROM_END"===s||"FROM_START"===s?", at1":"").concat("FROM_END"===o||"FROM_START"===o?", at2":"",") {\n  var start = ").concat(ge("sequence",s,"at1"),";\n  var end = ").concat(ge("sequence",o,"at2")," + 1;\n  return sequence.slice(start, end);\n}\n"))+"("+r+("FROM_END"===s||"FROM_START"===s?", "+t:"")+("FROM_END"===o||"FROM_START"===o?", "+e:"")+")"}return[r,t.FUNCTION_CALL]},v=function(e,n){const i=n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]",r="1"===e.getFieldValue("DIRECTION")?1:-1;return e=e.getFieldValue("TYPE"),[i+".slice().sort("+(n=n.provideFunction_("listsGetSortCompare","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(type, direction) {\n  var compareFuncs = {\n    'NUMERIC': function(a, b) {\n        return Number(a) - Number(b); },\n    'TEXT': function(a, b) {\n        return String(a) > String(b) ? 1 : -1; },\n    'IGNORE_CASE': function(a, b) {\n        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },\n  };\n  var compare = compareFuncs[type];\n  return function(a, b) { return compare(a, b) * direction; };\n}\n      ")))+'("'+e+'", '+r+"))",t.FUNCTION_CALL]},_=function(e,n){let i=n.valueToCode(e,"INPUT",t.MEMBER);if(n=n.valueToCode(e,"DELIM",t.NONE)||"''","SPLIT"===(e=e.getFieldValue("MODE")))i||(i="''"),e="split";else{if("JOIN"!==e)throw Error("Unknown mode: "+e);i||(i="[]"),e="join"}return[i+"."+e+"("+n+")",t.FUNCTION_CALL]},b=function(e,n){return[(n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]")+".slice().reverse()",t.FUNCTION_CALL]},y=function(e,n){var i=0;let r="";n.STATEMENT_PREFIX&&(r+=n.injectId(n.STATEMENT_PREFIX,e));do{const s=n.valueToCode(e,"IF"+i,t.NONE)||"false";let o=n.statementToCode(e,"DO"+i);n.STATEMENT_SUFFIX&&(o=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+o),r+=(0<i?" else ":"")+"if ("+s+") {\n"+o+"}",i++}while(e.getInput("IF"+i));return(e.getInput("ELSE")||n.STATEMENT_SUFFIX)&&(i=n.statementToCode(e,"ELSE"),n.STATEMENT_SUFFIX&&(i=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+i),r+=" else {\n"+i+"}"),r+"\n"},T=function(e,n){const i={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],r="=="===i||"!="===i?t.EQUALITY:t.RELATIONAL;return[(n.valueToCode(e,"A",r)||"0")+" "+i+" "+(e=n.valueToCode(e,"B",r)||"0"),r]},E=function(e,n){const i="AND"===e.getFieldValue("OP")?"&&":"||",r="&&"===i?t.LOGICAL_AND:t.LOGICAL_OR;let s=n.valueToCode(e,"A",r);return e=n.valueToCode(e,"B",r),s||e?(n="&&"===i?"true":"false",s||(s=n),e||(e=n)):e=s="false",[s+" "+i+" "+e,r]},S=function(e,n){const i=t.LOGICAL_NOT;return["!"+(n.valueToCode(e,"BOOL",i)||"true"),i]},w=function(e,n){return["TRUE"===e.getFieldValue("BOOL")?"true":"false",t.ATOMIC]},x=function(e,n){return["null",t.ATOMIC]},M=function(e,n){return[(n.valueToCode(e,"IF",t.CONDITIONAL)||"false")+" ? "+(n.valueToCode(e,"THEN",t.CONDITIONAL)||"null")+" : "+(e=n.valueToCode(e,"ELSE",t.CONDITIONAL)||"null"),t.CONDITIONAL]},I=function(e,n){let r;r=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):n.valueToCode(e,"TIMES",t.ASSIGNMENT)||"0";let s=n.statementToCode(e,"DO");s=n.addLoopTrap(s,e),e="";const o=n.nameDB_.getDistinctName("count",i.NameType$$module$build$src$core$names.VARIABLE);let a=r;return r.match(/^\w+$/)||i.isNumber$$module$build$src$core$utils$string(r)||(a=n.nameDB_.getDistinctName("repeat_end",i.NameType$$module$build$src$core$names.VARIABLE),e+="var "+a+" = "+r+";\n"),e+"for (var "+o+" = 0; "+o+" < "+a+"; "+o+"++) {\n"+s+"}\n"},C=function(e,n){const i="UNTIL"===e.getFieldValue("MODE");let r=n.valueToCode(e,"BOOL",i?t.LOGICAL_NOT:t.NONE)||"false",s=n.statementToCode(e,"DO");return s=n.addLoopTrap(s,e),i&&(r="!"+r),"while ("+r+") {\n"+s+"}\n"},k=function(e,n){var r=n.getVariableName(e.getFieldValue("VAR")),s=n.valueToCode(e,"FROM",t.ASSIGNMENT)||"0",o=n.valueToCode(e,"TO",t.ASSIGNMENT)||"0";const a=n.valueToCode(e,"BY",t.ASSIGNMENT)||"1";let l=n.statementToCode(e,"DO");if(l=n.addLoopTrap(l,e),i.isNumber$$module$build$src$core$utils$string(s)&&i.isNumber$$module$build$src$core$utils$string(o)&&i.isNumber$$module$build$src$core$utils$string(a))e="for ("+r+" = "+s+"; "+r+((n=Number(s)<=Number(o))?" <= ":" >= ")+o+"; "+r,e=1===(r=Math.abs(Number(a)))?e+(n?"++":"--"):e+(n?" += ":" -= ")+r,e+=") {\n"+l+"}\n";else{e="";let t=s;s.match(/^\w+$/)||i.isNumber$$module$build$src$core$utils$string(s)||(t=n.nameDB_.getDistinctName(r+"_start",i.NameType$$module$build$src$core$names.VARIABLE),e+="var "+t+" = "+s+";\n"),s=o,o.match(/^\w+$/)||i.isNumber$$module$build$src$core$utils$string(o)||(e+="var "+(s=n.nameDB_.getDistinctName(r+"_end",i.NameType$$module$build$src$core$names.VARIABLE))+" = "+o+";\n"),e+="var "+(o=n.nameDB_.getDistinctName(r+"_inc",i.NameType$$module$build$src$core$names.VARIABLE))+" = ",e=i.isNumber$$module$build$src$core$utils$string(a)?e+(Math.abs(Number(a))+";\n"):e+"Math.abs("+a+");\n",e+="if ("+t+" > "+s+") {\n",e=(e+=n.INDENT+o+" = -"+o+";\n")+"}\nfor ("+r+" = "+t+"; "+o+" >= 0 ? "+r+" <= "+s+" : "+r+" >= "+s+"; "+r+" += "+o+") {\n"+l+"}\n"}return e},R=function(e,n){const r=n.getVariableName(e.getFieldValue("VAR"));var s=n.valueToCode(e,"LIST",t.ASSIGNMENT)||"[]";let o=n.statementToCode(e,"DO");o=n.addLoopTrap(o,e),e="";let a=s;return s.match(/^\w+$/)||(a=n.nameDB_.getDistinctName(r+"_list",i.NameType$$module$build$src$core$names.VARIABLE),e+="var "+a+" = "+s+";\n"),s=n.nameDB_.getDistinctName(r+"_index",i.NameType$$module$build$src$core$names.VARIABLE),o=n.INDENT+r+" = "+a+"["+s+"];\n"+o,e+"for (var "+s+" in "+a+") {\n"+o+"}\n"},A=function(e,t){let n="";if(t.STATEMENT_PREFIX&&(n+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(n+=t.injectId(t.STATEMENT_SUFFIX,e)),t.STATEMENT_PREFIX){const i=e.getSurroundLoop();i&&!i.suppressPrefixSuffix&&(n+=t.injectId(t.STATEMENT_PREFIX,i))}switch(e.getFieldValue("FLOW")){case"BREAK":return n+"break;\n";case"CONTINUE":return n+"continue;\n"}throw Error("Unknown flow statement.")},L=function(e,n){return e=Number(e.getFieldValue("NUM")),[String(e),0<=e?t.ATOMIC:t.UNARY_NEGATION]},O=function(e,n){var i={ADD:[" + ",t.ADDITION],MINUS:[" - ",t.SUBTRACTION],MULTIPLY:[" * ",t.MULTIPLICATION],DIVIDE:[" / ",t.DIVISION],POWER:[null,t.NONE]}[e.getFieldValue("OP")];const r=i[0];i=i[1];const s=n.valueToCode(e,"A",i)||"0";return e=n.valueToCode(e,"B",i)||"0",r?[s+r+e,i]:["Math.pow("+s+", "+e+")",t.FUNCTION_CALL]},N=function(e,n){const i=e.getFieldValue("OP");let r;if("NEG"===i)return"-"===(e=n.valueToCode(e,"NUM",t.UNARY_NEGATION)||"0")[0]&&(e=" "+e),["-"+e,t.UNARY_NEGATION];switch(e="SIN"===i||"COS"===i||"TAN"===i?n.valueToCode(e,"NUM",t.DIVISION)||"0":n.valueToCode(e,"NUM",t.NONE)||"0",i){case"ABS":r="Math.abs("+e+")";break;case"ROOT":r="Math.sqrt("+e+")";break;case"LN":r="Math.log("+e+")";break;case"EXP":r="Math.exp("+e+")";break;case"POW10":r="Math.pow(10,"+e+")";break;case"ROUND":r="Math.round("+e+")";break;case"ROUNDUP":r="Math.ceil("+e+")";break;case"ROUNDDOWN":r="Math.floor("+e+")";break;case"SIN":r="Math.sin("+e+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+e+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+e+" / 180 * Math.PI)"}if(r)return[r,t.FUNCTION_CALL];switch(i){case"LOG10":r="Math.log("+e+") / Math.log(10)";break;case"ASIN":r="Math.asin("+e+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+e+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+e+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+i)}return[r,t.DIVISION]},D=function(e,n){return{PI:["Math.PI",t.MEMBER],E:["Math.E",t.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.DIVISION],SQRT2:["Math.SQRT2",t.MEMBER],SQRT1_2:["Math.SQRT1_2",t.MEMBER],INFINITY:["Infinity",t.ATOMIC]}[e.getFieldValue("CONSTANT")]},P=function(e,n){var i={EVEN:[" % 2 === 0",t.MODULUS,t.EQUALITY],ODD:[" % 2 === 1",t.MODULUS,t.EQUALITY],WHOLE:[" % 1 === 0",t.MODULUS,t.EQUALITY],POSITIVE:[" > 0",t.RELATIONAL,t.RELATIONAL],NEGATIVE:[" < 0",t.RELATIONAL,t.RELATIONAL],DIVISIBLE_BY:[null,t.MODULUS,t.EQUALITY],PRIME:[null,t.NONE,t.FUNCTION_CALL]};const r=e.getFieldValue("PROPERTY"),[s,o,a]=i[r];return i=n.valueToCode(e,"NUMBER_TO_CHECK",o)||"0",[e="PRIME"===r?n.provideFunction_("mathIsPrime","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(n) {\n  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n  if (n == 2 || n == 3) {\n    return true;\n  }\n  // False if n is NaN, negative, is 1, or not whole.\n  // And false if n is divisible by 2 or 3.\n  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {\n    return false;\n  }\n  // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {\n    if (n % (x - 1) === 0 || n % (x + 1) === 0) {\n      return false;\n    }\n  }\n  return true;\n}\n"))+"("+i+")":"DIVISIBLE_BY"===r?i+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0")+" === 0":i+s,a]},$=function(e,n){const i=n.valueToCode(e,"DELTA",t.ADDITION)||"0";return(e=n.getVariableName(e.getFieldValue("VAR")))+" = (typeof "+e+" === 'number' ? "+e+" : 0) + "+i+";\n"},B=function(e,n){var i=e.getFieldValue("OP");switch(i){case"SUM":e=n.valueToCode(e,"LIST",t.MEMBER)||"[]",e+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":e="Math.min.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MAX":e="Math.max.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"AVERAGE":e=(i=n.provideFunction_("mathMean","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MEDIAN":e=(i=n.provideFunction_("mathMedian","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n  var localList = myList.filter(function (x) {return typeof x === 'number';});\n  if (!localList.length) return null;\n  localList.sort(function(a, b) {return b - a;});\n  if (localList.length % 2 === 0) {\n    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n  } else {\n    return localList[(localList.length - 1) / 2];\n  }\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MODE":e=(i=n.provideFunction_("mathModes","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(values) {\n  var modes = [];\n  var counts = [];\n  var maxCount = 0;\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i];\n    var found = false;\n    var thisCount;\n    for (var j = 0; j < counts.length; j++) {\n      if (counts[j][0] === value) {\n        thisCount = ++counts[j][1];\n        found = true;\n        break;\n      }\n    }\n    if (!found) {\n      counts.push([value, 1]);\n      thisCount = 1;\n    }\n    maxCount = Math.max(thisCount, maxCount);\n  }\n  for (var j = 0; j < counts.length; j++) {\n    if (counts[j][1] === maxCount) {\n        modes.push(counts[j][0]);\n    }\n  }\n  return modes;\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"STD_DEV":e=(i=n.provideFunction_("mathStandardDeviation","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(numbers) {\n  var n = numbers.length;\n  if (!n) return null;\n  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;\n  var variance = 0;\n  for (var j = 0; j < n; j++) {\n    variance += Math.pow(numbers[j] - mean, 2);\n  }\n  variance = variance / n;\n  return Math.sqrt(variance);\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"RANDOM":e=(i=n.provideFunction_("mathRandomList","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(list) {\n  var x = Math.floor(Math.random() * list.length);\n  return list[x];\n}\n")))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+i)}return[e,t.FUNCTION_CALL]},F=function(e,n){return[(n.valueToCode(e,"DIVIDEND",t.MODULUS)||"0")+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0"),t.MODULUS]},U=function(e,n){return["Math.min(Math.max("+(n.valueToCode(e,"VALUE",t.NONE)||"0")+", "+(n.valueToCode(e,"LOW",t.NONE)||"0")+"), "+(e=n.valueToCode(e,"HIGH",t.NONE)||"Infinity")+")",t.FUNCTION_CALL]},z=function(e,n){const i=n.valueToCode(e,"FROM",t.NONE)||"0";return e=n.valueToCode(e,"TO",t.NONE)||"0",[n.provideFunction_("mathRandomInt","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return Math.floor(Math.random() * (b - a + 1) + a);\n}\n"))+"("+i+", "+e+")",t.FUNCTION_CALL]},H=function(e,n){return["Math.random()",t.FUNCTION_CALL]},G=function(e,n){const i=n.valueToCode(e,"X",t.NONE)||"0";return["Math.atan2("+(n.valueToCode(e,"Y",t.NONE)||"0")+", "+i+") / Math.PI * 180",t.DIVISION]},V=function(e,n){const i=n.getProcedureName(e.getFieldValue("NAME"));var r="";n.STATEMENT_PREFIX&&(r+=n.injectId(n.STATEMENT_PREFIX,e)),n.STATEMENT_SUFFIX&&(r+=n.injectId(n.STATEMENT_SUFFIX,e)),r&&(r=n.prefixLines(r,n.INDENT));let s="";n.INFINITE_LOOP_TRAP&&(s=n.prefixLines(n.injectId(n.INFINITE_LOOP_TRAP,e),n.INDENT));const o=n.statementToCode(e,"STACK");let a=n.valueToCode(e,"RETURN",t.NONE)||"",l="";o&&a&&(l=r),a&&(a=n.INDENT+"return "+a+";\n");const c=[],u=e.getVars();for(let t=0;t<u.length;t++)c[t]=n.getVariableName(u[t]);return r="function "+i+"("+c.join(", ")+") {\n"+r+s+o+l+a+"}",r=n.scrub_(e,r),n.definitions_["%"+i]=r,null},W=function(e,n){const i=n.getProcedureName(e.getFieldValue("NAME")),r=[],s=e.getVars();for(let o=0;o<s.length;o++)r[o]=n.valueToCode(e,"ARG"+o,t.NONE)||"null";return[i+"("+r.join(", ")+")",t.FUNCTION_CALL]},j=function(e,t){return t.forBlock.procedures_callreturn(e,t)[0]+";\n"},X=function(e,n){let i="if ("+(n.valueToCode(e,"CONDITION",t.NONE)||"false")+") {\n";return n.STATEMENT_SUFFIX&&(i+=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)),e.hasReturnValue_?(e=n.valueToCode(e,"VALUE",t.NONE)||"null",i+=n.INDENT+"return "+e+";\n"):i+=n.INDENT+"return;\n",i+"}\n"},Y=function(e,n){return[n.quote_(e.getFieldValue("TEXT")),t.ATOMIC]},K=function(e,n){return e=n.multiline_quote_(e.getFieldValue("TEXT")),n=-1!==e.indexOf("+")?t.ADDITION:t.ATOMIC,[e,n]},q=function(e,n){switch(e.itemCount_){case 0:return["''",t.ATOMIC];case 1:return e=n.valueToCode(e,"ADD0",t.NONE)||"''",Ee(e);case 2:var i=n.valueToCode(e,"ADD0",t.NONE)||"''";return e=n.valueToCode(e,"ADD1",t.NONE)||"''",[Ee(i)[0]+" + "+Ee(e)[0],t.ADDITION];default:i=Array(e.itemCount_);for(let r=0;r<e.itemCount_;r++)i[r]=n.valueToCode(e,"ADD"+r,t.NONE)||"''";return["["+i.join(",")+"].join('')",t.FUNCTION_CALL]}},J=function(e,n){const i=n.getVariableName(e.getFieldValue("VAR"));return e=n.valueToCode(e,"TEXT",t.NONE)||"''",i+" += "+Ee(e)[0]+";\n"},Z=function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.MEMBER]},Q=function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.LOGICAL_NOT]},ee=function(e,n){const i="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",r=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+"."+i+"("+r+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},te=function(e,n){const i=e.getFieldValue("WHERE")||"FROM_START",r=n.valueToCode(e,"VALUE","RANDOM"===i?t.NONE:t.MEMBER)||"''";switch(i){case"FIRST":return[r+".charAt(0)",t.FUNCTION_CALL];case"LAST":return[r+".slice(-1)",t.FUNCTION_CALL];case"FROM_START":return[r+".charAt("+(e=n.getAdjusted(e,"AT"))+")",t.FUNCTION_CALL];case"FROM_END":return[r+".slice("+(e=n.getAdjusted(e,"AT",1,!0))+").charAt(0)",t.FUNCTION_CALL];case"RANDOM":return[n.provideFunction_("textRandomLetter","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(text) {\n  var x = Math.floor(Math.random() * text.length);\n  return text[x];\n}\n"))+"("+r+")",t.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},ne=function(e,n){var i={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const r=e.getFieldValue("WHERE1"),s=e.getFieldValue("WHERE2");var o="FROM_END"!==r&&"LAST"!==r&&"FROM_END"!==s&&"LAST"!==s,a=n.valueToCode(e,"STRING",o?t.MEMBER:t.NONE)||"''";if("FIRST"===r&&"LAST"===s)return[a,t.NONE];if(a.match(/^'?\w+'?$/)||o){switch(r){case"FROM_START":i=n.getAdjusted(e,"AT1");break;case"FROM_END":i=a+".length - "+(i=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(s){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=a+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=a+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}a=a+".slice("+i+", "+n+")"}else o=n.getAdjusted(e,"AT1"),e=n.getAdjusted(e,"AT2"),a=n.provideFunction_("subsequence"+i[r]+i[s],"\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(sequence").concat("FROM_END"===r||"FROM_START"===r?", at1":"").concat("FROM_END"===s||"FROM_START"===s?", at2":"",") {\n  var start = ").concat(Se("sequence",r,"at1"),";\n  var end = ").concat(Se("sequence",s,"at2")," + 1;\n  return sequence.slice(start, end);\n}\n"))+"("+a+("FROM_END"===r||"FROM_START"===r?", "+o:"")+("FROM_END"===s||"FROM_START"===s?", "+e:"")+")";return[a,t.FUNCTION_CALL]},ie=function(e,n){const i={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")];return e=n.valueToCode(e,"TEXT",i?t.MEMBER:t.NONE)||"''",[i?e+i:n.provideFunction_("textToTitleCase","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(str) {\n  return str.replace(/\\S+/g,\n      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});\n}\n"))+"("+e+")",t.FUNCTION_CALL]},re=function(e,n){const i={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")];return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+i,t.FUNCTION_CALL]},se=function(e,n){return"window.alert("+(n.valueToCode(e,"TEXT",t.NONE)||"''")+");\n"},oe=function(e,n){return n="window.prompt("+(e.getField("TEXT")?n.quote_(e.getFieldValue("TEXT")):n.valueToCode(e,"TEXT",t.NONE)||"''")+")","NUMBER"===e.getFieldValue("TYPE")&&(n="Number("+n+")"),[n,t.FUNCTION_CALL]},ae=function(e,n){const i=n.valueToCode(e,"TEXT",t.NONE)||"''";return e=n.valueToCode(e,"SUB",t.NONE)||"''",[n.provideFunction_("textCount","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(haystack, needle) {\n  if (needle.length === 0) {\n    return haystack.length + 1;\n  } else {\n    return haystack.split(needle).length - 1;\n  }\n}\n"))+"("+i+", "+e+")",t.FUNCTION_CALL]},le=function(e,n){const i=n.valueToCode(e,"TEXT",t.NONE)||"''",r=n.valueToCode(e,"FROM",t.NONE)||"''";return e=n.valueToCode(e,"TO",t.NONE)||"''",[n.provideFunction_("textReplace","\nfunction ".concat(n.FUNCTION_NAME_PLACEHOLDER_,"(haystack, needle, replacement) {\n  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')\n                 .replace(/\\x08/g, '\\\\x08');\n  return haystack.replace(new RegExp(needle, 'g'), replacement);\n}\n"))+"("+i+", "+r+", "+e+")",t.FUNCTION_CALL]},ce=function(e,n){return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+".split('').reverse().join('')",t.FUNCTION_CALL]},ue=function(e,n){return[n.getVariableName(e.getFieldValue("VAR")),t.ATOMIC]},he=function(e,n){const i=n.valueToCode(e,"VALUE",t.ASSIGNMENT)||"0";return n.getVariableName(e.getFieldValue("VAR"))+" = "+i+";\n"};(n=t||(t={}))[n.ATOMIC=0]="ATOMIC",n[n.NEW=1.1]="NEW",n[n.MEMBER=1.2]="MEMBER",n[n.FUNCTION_CALL=2]="FUNCTION_CALL",n[n.INCREMENT=3]="INCREMENT",n[n.DECREMENT=3]="DECREMENT",n[n.BITWISE_NOT=4.1]="BITWISE_NOT",n[n.UNARY_PLUS=4.2]="UNARY_PLUS",n[n.UNARY_NEGATION=4.3]="UNARY_NEGATION",n[n.LOGICAL_NOT=4.4]="LOGICAL_NOT",n[n.TYPEOF=4.5]="TYPEOF",n[n.VOID=4.6]="VOID",n[n.DELETE=4.7]="DELETE",n[n.AWAIT=4.8]="AWAIT",n[n.EXPONENTIATION=5]="EXPONENTIATION",n[n.MULTIPLICATION=5.1]="MULTIPLICATION",n[n.DIVISION=5.2]="DIVISION",n[n.MODULUS=5.3]="MODULUS",n[n.SUBTRACTION=6.1]="SUBTRACTION",n[n.ADDITION=6.2]="ADDITION",n[n.BITWISE_SHIFT=7]="BITWISE_SHIFT",n[n.RELATIONAL=8]="RELATIONAL",n[n.IN=8]="IN",n[n.INSTANCEOF=8]="INSTANCEOF",n[n.EQUALITY=9]="EQUALITY",n[n.BITWISE_AND=10]="BITWISE_AND",n[n.BITWISE_XOR=11]="BITWISE_XOR",n[n.BITWISE_OR=12]="BITWISE_OR",n[n.LOGICAL_AND=13]="LOGICAL_AND",n[n.LOGICAL_OR=14]="LOGICAL_OR",n[n.CONDITIONAL=15]="CONDITIONAL",n[n.ASSIGNMENT=16]="ASSIGNMENT",n[n.YIELD=17]="YIELD",n[n.COMMA=18]="COMMA",n[n.NONE=99]="NONE";var de=class extends i.CodeGenerator$$module$build$src$core$generator{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"JavaScript";super(e),this.ORDER_OVERRIDES=[[t.FUNCTION_CALL,t.MEMBER],[t.FUNCTION_CALL,t.FUNCTION_CALL],[t.MEMBER,t.MEMBER],[t.MEMBER,t.FUNCTION_CALL],[t.LOGICAL_NOT,t.LOGICAL_NOT],[t.MULTIPLICATION,t.MULTIPLICATION],[t.ADDITION,t.ADDITION],[t.LOGICAL_AND,t.LOGICAL_AND],[t.LOGICAL_OR,t.LOGICAL_OR]],this.isInitialized=!1;for(const n in t)e=t[n],"string"!==typeof e&&(this["ORDER_"+n]=e);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(e){super.init(e),this.nameDB_?this.nameDB_.reset():this.nameDB_=new i.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e);const t=[];var n=i.allDeveloperVariables$$module$build$src$core$variables(e);for(let r=0;r<n.length;r++)t.push(this.nameDB_.getName(n[r],i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(e=i.allUsedVarModels$$module$build$src$core$variables(e),n=0;n<e.length;n++)t.push(this.nameDB_.getName(e[n].getId(),i.NameType$$module$build$src$core$names.VARIABLE));t.length&&(this.definitions_.variables="var "+t.join(", ")+";"),this.isInitialized=!0}finish(e){const t=Object.values(this.definitions_);return super.finish(e),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+e}scrubNakedValue(e){return e+";\n"}quote_(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"}multiline_quote_(e){return e.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")}scrub_(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";if(!e.outputConnection||!e.outputConnection.targetConnection){var s=e.getCommentText();s&&(s=i.wrap$$module$build$src$core$utils$string(s,this.COMMENT_WRAP-3),r+=this.prefixLines(s+"\n","// "));for(let t=0;t<e.inputList.length;t++)e.inputList[t].type===i.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(s=e.inputList[t].connection.targetBlock())&&(s=this.allNestedComments(s))&&(r+=this.prefixLines(s,"// "))}return e=e.nextConnection&&e.nextConnection.targetBlock(),n=n?"":this.blockToCode(e),r+t+n}getAdjusted(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.NONE;e.workspace.options.oneBasedIndex&&r--;const a=e.workspace.options.oneBasedIndex?"1":"0";let l=o;return 0<r?l=t.ADDITION:0>r?l=t.SUBTRACTION:s&&(l=t.UNARY_NEGATION),e=this.valueToCode(e,n,l)||a,0!==r||s?i.isNumber$$module$build$src$core$utils$string(e)?(e=String(Number(e)+r),s&&(e=String(-Number(e))),e):(0<r?e="".concat(e," + ").concat(r):0>r&&(e="".concat(e," - ").concat(-r)),s&&(e=r?"-(".concat(e,")"):"-".concat(e)),Math.floor(o)>=Math.floor(l)&&(e="(".concat(e,")")),e):e}},pe={};pe.JavascriptGenerator=de,pe.Order=t;var fe={};fe.colour_blend=a,fe.colour_picker=r,fe.colour_random=s,fe.colour_rgb=o;var ge=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},me={};me.lists_create_empty=l,me.lists_create_with=c,me.lists_getIndex=f,me.lists_getSublist=m,me.lists_indexOf=p,me.lists_isEmpty=d,me.lists_length=h,me.lists_repeat=u,me.lists_reverse=b,me.lists_setIndex=g,me.lists_sort=v,me.lists_split=_;var ve={};ve.controls_if=y,ve.controls_ifelse=y,ve.logic_boolean=w,ve.logic_compare=T,ve.logic_negate=S,ve.logic_null=x,ve.logic_operation=E,ve.logic_ternary=M;var _e={};_e.controls_flow_statements=A,_e.controls_for=k,_e.controls_forEach=R,_e.controls_repeat=I,_e.controls_repeat_ext=I,_e.controls_whileUntil=C;var be={};be.math_arithmetic=O,be.math_atan2=G,be.math_change=$,be.math_constant=D,be.math_constrain=U,be.math_modulo=F,be.math_number=L,be.math_number_property=P,be.math_on_list=B,be.math_random_float=H,be.math_random_int=z,be.math_round=N,be.math_single=N,be.math_trig=N;var ye={};ye.procedures_callnoreturn=j,ye.procedures_callreturn=W,ye.procedures_defnoreturn=V,ye.procedures_defreturn=V,ye.procedures_ifreturn=X;var Te=/^\s*'([^']|\\')*'\s*$/,Ee=function(e){return Te.test(e)?[e,t.ATOMIC]:["String("+e+")",t.FUNCTION_CALL]},Se=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},we={};we.text=Y,we.text_append=J,we.text_changeCase=ie,we.text_charAt=te,we.text_count=ae,we.text_getSubstring=ne,we.text_indexOf=ee,we.text_isEmpty=Q,we.text_join=q,we.text_length=Z,we.text_multiline=K,we.text_print=se,we.text_prompt=oe,we.text_prompt_ext=oe,we.text_replace=le,we.text_reverse=ce,we.text_trim=re;var xe={};xe.variables_get=ue,xe.variables_set=he;var Me={};Me.variables_get_dynamic=ue,Me.variables_set_dynamic=he;var Ie=new de,Ce=Object.assign({},fe,me,ve,_e,be,ye,we,xe,Me);for(const Re in Ce)Ie.forBlock[Re]=Ce[Re];var ke={};return ke.JavascriptGenerator=de,ke.Order=t,ke.javascriptGenerator=Ie,ke.__namespace__=i,ke},void 0===(s="function"===typeof i?i.apply(t,r):i)||(e.exports=s)},130:function(e,t){var n,i,r;i=[],void 0===(r="function"===typeof(n=function(){"use strict";var e=e||{Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="\xf7",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg})?n.apply(t,i):n)||(e.exports=r)},888:(e,t,n)=>{"use strict";var i=n(47);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,o){if(o!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},7:(e,t,n)=>{e.exports=n(888)()},47:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:(e,t,n)=>{"use strict";var i=n(791),r=n(296);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,_);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,_);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,_);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),I=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var P,$=Object.assign;function B(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function z(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case E:return"Portal";case x:return"Profiler";case w:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function j(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return $({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function q(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){J(e,t);var n=V(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return $({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function se(e,t){var n=V(t.value),i=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=ge(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=$({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function Te(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Se=null,we=null;function xe(e){if(e=br(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=Tr(t),Ee(e.stateNode,e.type,t))}}function Me(e){Se?we?we.push(e):we=[e]:Se=e}function Ie(){if(Se){var e=Se,t=we;if(we=Se=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Ce(e,t){return e(t)}function ke(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ce(e,t,n)}finally{Re=!1,(null!==Se||null!==we)&&(ke(),Ie())}}function Le(e,t){var n=e.stateNode;if(null===n)return null;var i=Tr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Oe=!1}function De(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Pe=!1,$e=null,Be=!1,Fe=null,Ue={onError:function(e){Pe=!0,$e=e}};function ze(e,t,n,i,r,s,o,a,l){Pe=!1,$e=null,De.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(He(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Ve(r),e;if(o===i)return Ve(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?je(e):null}function je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=je(e);if(null!==t)return t;e=e.sibling}return null}var Xe=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,qe=r.unstable_requestPaint,Je=r.unstable_now,Ze=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ht(a):0!==(s&=o)&&(i=ht(s))}else 0!==(o=n&~r)?i=ht(o):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Tt,Et,St,wt,xt,Mt=!1,It=[],Ct=null,kt=null,Rt=null,At=new Map,Lt=new Map,Ot=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Pt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&Et(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function $t(e){var t=_r(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void xt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&Et(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ye=i,n.target.dispatchEvent(i),ye=null,t.shift()}return!0}function Ft(e,t,n){Bt(e)&&n.delete(t)}function Ut(){Mt=!1,null!==Ct&&Bt(Ct)&&(Ct=null),null!==kt&&Bt(kt)&&(kt=null),null!==Rt&&Bt(Rt)&&(Rt=null),At.forEach(Ft),Lt.forEach(Ft)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Mt||(Mt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return zt(t,e)}if(0<It.length){zt(It[0],e);for(var n=1;n<It.length;n++){var i=It[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Ct&&zt(Ct,e),null!==kt&&zt(kt,e),null!==Rt&&zt(Rt,e),At.forEach(t),Lt.forEach(t),n=0;n<Ot.length;n++)(i=Ot[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)$t(n),null===n.blockedOn&&Ot.shift()}var Gt=y.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,n,i){var r=bt,s=Gt.transition;Gt.transition=null;try{bt=1,Xt(e,t,n,i)}finally{bt=r,Gt.transition=s}}function jt(e,t,n,i){var r=bt,s=Gt.transition;Gt.transition=null;try{bt=4,Xt(e,t,n,i)}finally{bt=r,Gt.transition=s}}function Xt(e,t,n,i){if(Vt){var r=Kt(e,t,n,i);if(null===r)Vi(e,t,i,Yt,n),Dt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Ct=Pt(Ct,e,t,n,i,r),!0;case"dragenter":return kt=Pt(kt,e,t,n,i,r),!0;case"mouseover":return Rt=Pt(Rt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return At.set(s,Pt(At.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Lt.set(s,Pt(Lt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Nt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&Tt(s),null===(s=Kt(e,t,n,i))&&Vi(e,t,i,Yt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Vi(e,t,i,null,n)}}var Yt=null;function Kt(e,t,n,i){if(Yt=null,null!==(e=_r(e=Te(i))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Zt,i=n.length,r="value"in Jt?Jt.value:Jt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return $(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=$({},cn,{view:0,detail:0}),dn=sn(hn),pn=$({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=sn(pn),gn=sn($({},pn,{dataTransfer:0})),mn=sn($({},hn,{relatedTarget:0})),vn=sn($({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=$({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(_n),yn=sn($({},cn,{data:0})),Tn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function xn(){return wn}var Mn=$({},hn,{key:function(e){if(e.key){var t=Tn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(Mn),Cn=sn($({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=sn($({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Rn=sn($({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=$({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=sn(An),On=[9,13,27,32],Nn=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Pn=u&&"TextEvent"in window&&!Dn,$n=u&&(!Nn||Dn&&8<Dn&&11>=Dn),Bn=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Wn(e,t,n,i){Me(i),0<(t=ji(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var jn=null,Xn=null;function Yn(e){Bi(e,0)}function Kn(e){if(X(yr(e)))return e}function qn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Zn;if(u){var Qn="oninput"in document;if(!Qn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Qn="function"===typeof ei.oninput}Zn=Qn}else Zn=!1;Jn=Zn&&(!document.documentMode||9<document.documentMode)}function ti(){jn&&(jn.detachEvent("onpropertychange",ni),Xn=jn=null)}function ni(e){if("value"===e.propertyName&&Kn(Xn)){var t=[];Wn(t,Xn,e,Te(e)),Ae(Yn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Xn=n,(jn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Xn)}function si(e,t){if("click"===e)return Kn(t)}function oi(e,t){if("input"===e||"change"===e)return Kn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,_i=null,bi=!1;function yi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==mi||mi!==Y(i)||("selectionStart"in(i=mi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},_i&&li(_i,i)||(_i=i,0<(i=ji(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=mi)))}function Ti(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ei={animationend:Ti("Animation","AnimationEnd"),animationiteration:Ti("Animation","AnimationIteration"),animationstart:Ti("Animation","AnimationStart"),transitionend:Ti("Transition","TransitionEnd")},Si={},wi={};function xi(e){if(Si[e])return Si[e];if(!Ei[e])return e;var t,n=Ei[e];for(t in n)if(n.hasOwnProperty(t)&&t in wi)return Si[e]=n[t];return e}u&&(wi=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);var Mi=xi("animationend"),Ii=xi("animationiteration"),Ci=xi("animationstart"),ki=xi("transitionend"),Ri=new Map,Ai="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(e,t){Ri.set(e,t),l(t,[e])}for(var Oi=0;Oi<Ai.length;Oi++){var Ni=Ai[Oi];Li(Ni.toLowerCase(),"on"+(Ni[0].toUpperCase()+Ni.slice(1)))}Li(Mi,"onAnimationEnd"),Li(Ii,"onAnimationIteration"),Li(Ci,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(ki,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function $i(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(ze.apply(this,arguments),Pe){if(!Pe)throw Error(s(198));var u=$e;Pe=!1,$e=null,Be||(Be=!0,Fe=u)}}(i,t,void 0,e),e.currentTarget=null}function Bi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;$i(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;$i(r,a,c),s=l}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Fi(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var i=e+"__bubble";n.has(i)||(Gi(t,e,2,!1),n.add(i))}function Ui(e,t,n){var i=0;t&&(i|=4),Gi(n,e,i,t)}var zi="_reactListening"+Math.random().toString(36).slice(2);function Hi(e){if(!e[zi]){e[zi]=!0,o.forEach((function(t){"selectionchange"!==t&&(Pi.has(t)||Ui(t,!1,e),Ui(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zi]||(t[zi]=!0,Ui("selectionchange",!1,t))}}function Gi(e,t,n,i){switch(qt(t)){case 1:var r=Wt;break;case 4:r=jt;break;default:r=Xt}n=r.bind(null,t,n,e),r=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=_r(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Ae((function(){var i=s,r=Te(n),o=[];e:{var a=Ri.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Mi:case Ii:case Ci:l=vn;break;case ki:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==d&&(null!=(g=Le(f,d))&&u.push(Wi(f,g,p)))),h)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!_r(c)&&!c[fr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?_r(c):null)&&(c!==(h=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,g="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,g="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:yr(l),p=null==c?a:yr(c),(a=new u(g,f+"leave",l,n,r)).target=h,a.relatedTarget=p,g=null,_r(r)===i&&((u=new u(d,f+"enter",c,n,r)).target=p,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Xi(p))f++;for(p=0,g=d;g;g=Xi(g))p++;for(;0<f-p;)u=Xi(u),f--;for(;0<p-f;)d=Xi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xi(u),d=Xi(d)}u=null}else u=null;null!==l&&Yi(o,a,l,u,!1),null!==c&&null!==h&&Yi(o,h,c,u,!0)}if("select"===(l=(a=i?yr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=qn;else if(Vn(a))if(Jn)m=oi;else{m=ri;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=si);switch(m&&(m=m(e,i))?Wn(o,m,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?yr(i):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,_i=null);break;case"focusout":_i=vi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,yi(o,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":yi(o,n,r)}var _;if(Nn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&($n&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(_=en()):(Zt="value"in(Jt=r)?Jt.value:Jt.textContent,Hn=!0)),0<(v=ji(i,b)).length&&(b=new yn(b,e,null,n,r),o.push({event:b,listeners:v}),_?b.data=_:null!==(_=zn(n))&&(b.data=_))),(_=Pn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Nn&&Un(e,t)?(e=en(),Qt=Zt=Jt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=ji(i,"onBeforeInput")).length&&(r=new yn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=_))}Bi(o,t)}))}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ji(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Le(e,n))&&i.unshift(Wi(e,s,r)),null!=(s=Le(e,t))&&i.push(Wi(e,s,r))),e=e.return}return i}function Xi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yi(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Le(n,s))&&o.unshift(Wi(n,l,a)):r||null!=(l=Le(n,s))&&o.push(Wi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Ki=/\r\n?/g,qi=/\u0000|\uFFFD/g;function Ji(e){return("string"===typeof e?e:""+e).replace(Ki,"\n").replace(qi,"")}function Zi(e,t,n){if(t=Ji(t),Ji(e)!==t&&n)throw Error(s(425))}function Qi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Ht(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ht(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,gr="__reactEvents$"+hr,mr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function _r(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[dr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Tr(e){return e[pr]||null}var Er=[],Sr=-1;function wr(e){return{current:e}}function xr(e){0>Sr||(e.current=Er[Sr],Er[Sr]=null,Sr--)}function Mr(e,t){Sr++,Er[Sr]=e.current,e.current=t}var Ir={},Cr=wr(Ir),kr=wr(!1),Rr=Ir;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Ir;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Lr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Or(){xr(kr),xr(Cr)}function Nr(e,t,n){if(Cr.current!==Ir)throw Error(s(168));Mr(Cr,t),Mr(kr,n)}function Dr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,G(e)||"Unknown",r));return $({},n,i)}function Pr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ir,Rr=Cr.current,Mr(Cr,e),Mr(kr,kr.current),!0}function $r(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Dr(e,t,Rr),i.__reactInternalMemoizedMergedChildContext=e,xr(kr),xr(Cr),Mr(Cr,e)):xr(kr),Mr(kr,n)}var Br=null,Fr=!1,Ur=!1;function zr(e){null===Br?Br=[e]:Br.push(e)}function Hr(){if(!Ur&&null!==Br){Ur=!0;var e=0,t=bt;try{var n=Br;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Br=null,Fr=!1}catch(r){throw null!==Br&&(Br=Br.slice(e+1)),Xe(Qe,Hr),r}finally{bt=t,Ur=!1}}return null}var Gr=[],Vr=0,Wr=null,jr=0,Xr=[],Yr=0,Kr=null,qr=1,Jr="";function Zr(e,t){Gr[Vr++]=jr,Gr[Vr++]=Wr,Wr=e,jr=t}function Qr(e,t,n){Xr[Yr++]=qr,Xr[Yr++]=Jr,Xr[Yr++]=Kr,Kr=e;var i=qr;e=Jr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,qr=1<<32-ot(t)+r|n<<r|i,Jr=s+e}else qr=1<<s|n<<r|i,Jr=e}function es(e){null!==e.return&&(Zr(e,1),Qr(e,1,0))}function ts(e){for(;e===Wr;)Wr=Gr[--Vr],Gr[Vr]=null,jr=Gr[--Vr],Gr[Vr]=null;for(;e===Kr;)Kr=Xr[--Yr],Xr[Yr]=null,Jr=Xr[--Yr],Xr[Yr]=null,qr=Xr[--Yr],Xr[Yr]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Kr?{id:qr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Lc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=cr(e.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var gs=y.ReactCurrentBatchConfig;function ms(e,t){if(e&&e.defaultProps){for(var n in t=$({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=wr(null),_s=null,bs=null,ys=null;function Ts(){ys=bs=_s=null}function Es(e){var t=vs.current;xr(vs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function ws(e,t){_s=e,ys=bs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function xs(e){var t=e._currentValue;if(ys!==e)if(e={context:e,memoizedValue:t,next:null},null===bs){if(null===_s)throw Error(s(308));bs=e,_s.dependencies={lanes:0,firstContext:e}}else bs=bs.next=e;return t}var Ms=null;function Is(e){null===Ms?Ms=[e]:Ms.push(e)}function Cs(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Is(t)):(n.next=r.next,r.next=n),t.interleaved=n,ks(e,i)}function ks(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function As(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&kl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,ks(e,n)}return null===(r=i.interleaved)?(t.next=t,Is(i)):(t.next=r.next,r.next=t),i.interleaved=t,ks(e,n)}function Ds(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_t(e,n)}}function Ps(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $s(e,t,n,i){var r=e.updateQueue;Rs=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(d=t,p=n,g.tag){case 1:if("function"===typeof(f=g.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=g.payload)?f.call(p,h,d):f)||void 0===d)break e;h=$({},h,d);break e;case 2:Rs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);$l|=o,e.lanes=o,e.memoizedState=h}}function Bs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Fs=(new i.Component).refs;function Us(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:$({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var zs={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Os(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(ic(t,e,r,i),Ds(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Os(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(ic(t,e,r,i),Ds(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),r=Os(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ns(e,r,i))&&(ic(t,e,i,n),Ds(t,e,i))}};function Hs(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function Gs(e,t,n){var i=!1,r=Ir,s=t.contextType;return"object"===typeof s&&null!==s?s=xs(s):(r=Lr(t)?Rr:Cr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Ar(e,r):Ir),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Vs(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&zs.enqueueReplaceState(t,t.state,null)}function Ws(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Fs,As(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=xs(s):(s=Lr(t)?Rr:Cr.current,r.context=Ar(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Us(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&zs.enqueueReplaceState(r,r.state,null),$s(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function js(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===Fs&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ys(e){return(0,e._init)(e._payload)}function Ks(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Nc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Bc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===S?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===L&&Ys(s)===t.type)?((i=r(t,n.props)).ref=js(e,t,n),i.return=e,i):((i=Dc(n.type,n.key,n.props,null,e.mode,i)).ref=js(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Pc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case T:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=js(e,null,t),n.return=e,n;case E:return(t=Fc(t,e.mode,n)).return=e,t;case L:return d(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Pc(t,e.mode,n,null)).return=e,t;Xs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case T:return n.key===r?c(e,t,n,i):null;case E:return n.key===r?u(e,t,n,i):null;case L:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||D(n))return null!==r?null:h(e,t,n,i,null);Xs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case T:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case E:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case L:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||D(i))return h(t,e=e.get(n)||null,i,r,null);Xs(t,i)}return null}function g(r,s,a,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=p(r,h,a[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(r,h),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(r,h),rs&&Zr(r,g),c;if(null===h){for(;g<a.length;g++)null!==(h=d(r,a[g],l))&&(s=o(h,s,g),null===u?c=h:u.sibling=h,u=h);return rs&&Zr(r,g),c}for(h=i(r,h);g<a.length;g++)null!==(m=f(h,r,g,a[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(r,e)})),rs&&Zr(r,g),c}function m(r,a,l,c){var u=D(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=a,m=a=0,v=null,_=l.next();null!==g&&!_.done;m++,_=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=p(r,g,_.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(r,g),a=o(b,a,m),null===h?u=b:h.sibling=b,h=b,g=v}if(_.done)return n(r,g),rs&&Zr(r,m),u;if(null===g){for(;!_.done;m++,_=l.next())null!==(_=d(r,_.value,c))&&(a=o(_,a,m),null===h?u=_:h.sibling=_,h=_);return rs&&Zr(r,m),u}for(g=i(r,g);!_.done;m++,_=l.next())null!==(_=f(g,r,m,_.value,c))&&(e&&null!==_.alternate&&g.delete(null===_.key?m:_.key),a=o(_,a,m),null===h?u=_:h.sibling=_,h=_);return e&&g.forEach((function(e){return t(r,e)})),rs&&Zr(r,m),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case T:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===L&&Ys(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=js(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===S?((s=Pc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Dc(o.type,o.key,o.props,null,i.mode,l)).ref=js(i,s,o),l.return=i,i=l)}return a(i);case E:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Fc(o,i.mode,l)).return=i,i=s}return a(i);case L:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return g(i,s,o,l);if(D(o))return m(i,s,o,l);Xs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Bc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var qs=Ks(!0),Js=Ks(!1),Zs={},Qs=wr(Zs),eo=wr(Zs),to=wr(Zs);function no(e){if(e===Zs)throw Error(s(174));return e}function io(e,t){switch(Mr(to,t),Mr(eo,e),Mr(Qs,Zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xr(Qs),Mr(Qs,t)}function ro(){xr(Qs),xr(eo),xr(to)}function so(e){no(to.current);var t=no(Qs.current),n=le(t,e.type);t!==n&&(Mr(eo,e),Mr(Qs,n))}function oo(e){eo.current===e&&(xr(Qs),xr(eo))}var ao=wr(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=y.ReactCurrentDispatcher,po=y.ReactCurrentBatchConfig,fo=0,go=null,mo=null,vo=null,_o=!1,bo=!1,yo=0,To=0;function Eo(){throw Error(s(321))}function So(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function wo(e,t,n,i,r,o){if(fo=o,go=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?aa:la,e=n(i,r),bo){o=0;do{if(bo=!1,yo=0,25<=o)throw Error(s(301));o+=1,vo=mo=null,t.updateQueue=null,ho.current=ca,e=n(i,r)}while(bo)}if(ho.current=oa,t=null!==mo&&null!==mo.next,fo=0,vo=mo=go=null,_o=!1,t)throw Error(s(300));return e}function xo(){var e=0!==yo;return yo=0,e}function Mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?go.memoizedState=vo=e:vo=vo.next=e,vo}function Io(){if(null===mo){var e=go.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===vo?go.memoizedState:vo.next;if(null!==t)vo=t,mo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===vo?go.memoizedState=vo=e:vo=vo.next=e}return vo}function Co(e,t){return"function"===typeof t?t(e):t}function ko(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=mo,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((fo&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,go.lanes|=h,$l|=h}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(ya=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,go.lanes|=o,$l|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Ao(){}function Lo(e,t){var n=go,i=Io(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ya=!0),i=i.queue,Vo(Do.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==vo&&1&vo.memoizedState.tag){if(n.flags|=2048,Fo(9,No.bind(null,n,i,r,t),void 0,null),null===Rl)throw Error(s(349));0!==(30&fo)||Oo(n,t,r)}return r}function Oo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function No(e,t,n,i){t.value=n,t.getSnapshot=i,Po(t)&&$o(e)}function Do(e,t,n){return n((function(){Po(t)&&$o(e)}))}function Po(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function $o(e){var t=ks(e,1);null!==t&&ic(t,e,1,-1)}function Bo(e){var t=Mo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,go,e),[t.memoizedState,e]}function Fo(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Uo(){return Io().memoizedState}function zo(e,t,n,i){var r=Mo();go.flags|=e,r.memoizedState=Fo(1|t,n,void 0,void 0===i?null:i)}function Ho(e,t,n,i){var r=Io();i=void 0===i?null:i;var s=void 0;if(null!==mo){var o=mo.memoizedState;if(s=o.destroy,null!==i&&So(i,o.deps))return void(r.memoizedState=Fo(t,n,s,i))}go.flags|=e,r.memoizedState=Fo(1|t,n,s,i)}function Go(e,t){return zo(8390656,8,e,t)}function Vo(e,t){return Ho(2048,8,e,t)}function Wo(e,t){return Ho(4,2,e,t)}function jo(e,t){return Ho(4,4,e,t)}function Xo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Yo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ho(4,4,Xo.bind(null,t,e),n)}function Ko(){}function qo(e,t){var n=Io();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&So(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Jo(e,t){var n=Io();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&So(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Zo(e,t,n){return 0===(21&fo)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(ai(n,t)||(n=gt(),go.lanes|=n,$l|=n,e.baseState=!0),t)}function Qo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=po.transition;po.transition={};try{e(!1),t()}finally{bt=n,po.transition=i}}function ea(){return Io().memoizedState}function ta(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ia(e))ra(t,n);else if(null!==(n=Cs(e,t,n,i))){ic(n,e,i,tc()),sa(n,t,i)}}function na(e,t,n){var i=nc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(e))ra(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Is(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Cs(e,t,r,i))&&(ic(n,e,i,r=tc()),sa(n,t,i))}}function ia(e){var t=e.alternate;return e===go||null!==t&&t===go}function ra(e,t){bo=_o=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_t(e,n)}}var oa={readContext:xs,useCallback:Eo,useContext:Eo,useEffect:Eo,useImperativeHandle:Eo,useInsertionEffect:Eo,useLayoutEffect:Eo,useMemo:Eo,useReducer:Eo,useRef:Eo,useState:Eo,useDebugValue:Eo,useDeferredValue:Eo,useTransition:Eo,useMutableSource:Eo,useSyncExternalStore:Eo,useId:Eo,unstable_isNewReconciler:!1},aa={readContext:xs,useCallback:function(e,t){return Mo().memoizedState=[e,void 0===t?null:t],e},useContext:xs,useEffect:Go,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4194308,4,Xo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zo(4194308,4,e,t)},useInsertionEffect:function(e,t){return zo(4,2,e,t)},useMemo:function(e,t){var n=Mo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Mo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ta.bind(null,go,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Mo().memoizedState=e},useState:Bo,useDebugValue:Ko,useDeferredValue:function(e){return Mo().memoizedState=e},useTransition:function(){var e=Bo(!1),t=e[0];return e=Qo.bind(null,e[1]),Mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=go,r=Mo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));0!==(30&fo)||Oo(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Go(Do.bind(null,i,o,e),[e]),i.flags|=2048,Fo(9,No.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=Mo(),t=Rl.identifierPrefix;if(rs){var n=Jr;t=":"+t+"R"+(n=(qr&~(1<<32-ot(qr)-1)).toString(32)+n),0<(n=yo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=To++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:xs,useCallback:qo,useContext:xs,useEffect:Vo,useImperativeHandle:Yo,useInsertionEffect:Wo,useLayoutEffect:jo,useMemo:Jo,useReducer:ko,useRef:Uo,useState:function(){return ko(Co)},useDebugValue:Ko,useDeferredValue:function(e){return Zo(Io(),mo.memoizedState,e)},useTransition:function(){return[ko(Co)[0],Io().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Lo,useId:ea,unstable_isNewReconciler:!1},ca={readContext:xs,useCallback:qo,useContext:xs,useEffect:Vo,useImperativeHandle:Yo,useInsertionEffect:Wo,useLayoutEffect:jo,useMemo:Jo,useReducer:Ro,useRef:Uo,useState:function(){return Ro(Co)},useDebugValue:Ko,useDeferredValue:function(e){var t=Io();return null===mo?t.memoizedState=e:Zo(t,mo.memoizedState,e)},useTransition:function(){return[Ro(Co)[0],Io().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Lo,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",i=t;do{n+=z(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ha(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Os(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Wl||(Wl=!0,jl=i),da(0,t)},n}function ga(e,t,n){(n=Os(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof i&&(null===Xl?Xl=new Set([this]):Xl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new pa;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Mc.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _a(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Os(-1,1)).tag=2,Ns(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ba=y.ReactCurrentOwner,ya=!1;function Ta(e,t,n,i){t.child=null===e?Js(t,null,n,i):qs(t,e.child,n,i)}function Ea(e,t,n,i,r){n=n.render;var s=t.ref;return ws(t,r),i=wo(e,t,n,i,s,r),n=xo(),null===e||ya?(rs&&n&&es(t),t.flags|=1,Ta(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function Sa(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Oc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,wa(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Wa(e,t,r)}return t.flags|=1,(e=Nc(s,i)).ref=t.ref,e.return=t,t.child=e}function wa(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(ya=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Wa(e,t,r);0!==(131072&e.flags)&&(ya=!0)}}return Ia(e,t,n,i,r)}function xa(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Nl,Ol),Ol|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mr(Nl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Mr(Nl,Ol),Ol|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Mr(Nl,Ol),Ol|=i;return Ta(e,t,r,n),t.child}function Ma(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ia(e,t,n,i,r){var s=Lr(n)?Rr:Cr.current;return s=Ar(t,s),ws(t,r),n=wo(e,t,n,i,s,r),i=xo(),null===e||ya?(rs&&i&&es(t),t.flags|=1,Ta(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function Ca(e,t,n,i,r){if(Lr(n)){var s=!0;Pr(t)}else s=!1;if(ws(t,r),null===t.stateNode)Va(e,t),Gs(t,n,i),Ws(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=xs(c):c=Ar(t,c=Lr(n)?Rr:Cr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&Vs(t,o,i,c),Rs=!1;var d=t.memoizedState;o.state=d,$s(t,i,o,r),l=t.memoizedState,a!==i||d!==l||kr.current||Rs?("function"===typeof u&&(Us(t,n,u,i),l=t.memoizedState),(a=Rs||Hs(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ms(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=xs(l):l=Ar(t,l=Lr(n)?Rr:Cr.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Vs(t,o,i,l),Rs=!1,d=t.memoizedState,o.state=d,$s(t,i,o,r);var f=t.memoizedState;a!==h||d!==f||kr.current||Rs?("function"===typeof p&&(Us(t,n,p,i),f=t.memoizedState),(c=Rs||Hs(t,n,c,i,d,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return ka(e,t,n,i,s,r)}function ka(e,t,n,i,r,s){Ma(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&$r(t,n,!1),Wa(e,t,s);i=t.stateNode,ba.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=qs(t,e.child,null,s),t.child=qs(t,null,a,s)):Ta(e,t,a,s),t.memoizedState=i.state,r&&$r(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Nr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Nr(0,t.context,!1),io(e,t.containerInfo)}function Aa(e,t,n,i,r){return ps(),fs(r),t.flags|=256,Ta(e,t,n,i),t.child}var La,Oa,Na,Da,Pa={dehydrated:null,treeContext:null,retryLane:0};function $a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,n){var i,r=t.pendingProps,o=ao.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Mr(ao,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=$c(l,r,0,null),e=Pc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$a(n),t.memoizedState=Pa,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,i=ha(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=$c({mode:"visible",children:i.children},r,0,null),(o=Pc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&qs(t,e.child,null,a),t.child.memoizedState=$a(a),t.memoizedState=Pa,o);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ua(e,t,a,i=ha(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(i=Rl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,ks(e,r),ic(i,e,r,-1))}return mc(),Ua(e,t,a,i=ha(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Xr[Yr++]=qr,Xr[Yr++]=Jr,Xr[Yr++]=Kr,qr=e.id,Jr=e.overflow,Kr=t),t=Fa(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Nc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Nc(i,a):(a=Pc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?$a(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Pa,r}return e=(a=e.child).sibling,r=Nc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fa(e,t){return(t=$c({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,i){return null!==i&&fs(i),qs(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function za(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ss(e.return,t,n)}function Ha(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Ga(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Ta(e,t,i.children,n),0!==(2&(i=ao.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&za(e,n,t);else if(19===e.tag)za(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Mr(ao,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ha(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===lo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ha(t,!0,n,null,s);break;case"together":Ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),$l|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Nc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Nc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ja(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ya(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(t),null;case 1:case 17:return Lr(t.type)&&Or(),Xa(t),null;case 3:return i=t.stateNode,ro(),xr(kr),xr(Cr),uo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Oa(e,t),Xa(t),null;case 5:oo(t);var r=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Na(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Xa(t),null}if(e=no(Qs.current),hs(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[dr]=t,i[pr]=o,e=0!==(1&t.mode),n){case"dialog":Fi("cancel",i),Fi("close",i);break;case"iframe":case"object":case"embed":Fi("load",i);break;case"video":case"audio":for(r=0;r<Di.length;r++)Fi(Di[r],i);break;case"source":Fi("error",i);break;case"img":case"image":case"link":Fi("error",i),Fi("load",i);break;case"details":Fi("toggle",i);break;case"input":q(i,o),Fi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Fi("invalid",i);break;case"textarea":re(i,o),Fi("invalid",i)}for(var l in _e(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fi("scroll",i)}switch(n){case"input":j(i),Q(i,o,!0);break;case"textarea":j(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Qi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[pr]=i,La(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Fi("cancel",e),Fi("close",e),r=i;break;case"iframe":case"object":case"embed":Fi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Di.length;r++)Fi(Di[r],e);r=i;break;case"source":Fi("error",e),r=i;break;case"img":case"image":case"link":Fi("error",e),Fi("load",e),r=i;break;case"details":Fi("toggle",e),r=i;break;case"input":q(e,i),r=K(e,i),Fi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=$({},i,{value:void 0}),Fi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Fi("invalid",e)}for(o in _e(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Fi("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":j(e),Q(e,i,!1);break;case"textarea":j(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+V(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xa(t),null;case 6:if(e&&null!=t.stateNode)Da(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=no(to.current),no(Qs.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Zi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return Xa(t),null;case 13:if(xr(ao),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,o=!1;else if(o=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xa(t),o=!1}else null!==ss&&(ac(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ao.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Xa(t),null);case 4:return ro(),Oa(e,t),null===e&&Hi(t.stateNode.containerInfo),Xa(t),null;case 10:return Es(t.type._context),Xa(t),null;case 19:if(xr(ao),null===(o=t.memoizedState))return Xa(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)ja(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,ja(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mr(ao,1&ao.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Gl&&(t.flags|=128,i=!0,ja(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=lo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ja(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Xa(t),null}else 2*Je()-o.renderingStartTime>Gl&&1073741824!==n&&(t.flags|=128,i=!0,ja(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=ao.current,Mr(ao,i?1&n|2:1&n),t):(Xa(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ol)&&(Xa(t),6&t.subtreeFlags&&(t.flags|=8192)):Xa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ka(e,t){switch(ts(t),t.tag){case 1:return Lr(t.type)&&Or(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ro(),xr(kr),xr(Cr),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(xr(ao),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xr(ao),null;case 4:return ro(),null;case 10:return Es(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}La=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oa=function(){},Na=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,no(Qs.current);var s,o=null;switch(n){case"input":r=K(e,r),i=K(e,i),o=[];break;case"select":r=$({},r,{value:void 0}),i=$({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Qi)}for(u in _e(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fi("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Da=function(e,t,n,i){n!==i&&(t.flags|=4)};var qa=!1,Ja=!1,Za="function"===typeof WeakSet?WeakSet:Set,Qa=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){xc(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){xc(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&tl(t,n,s)}r=r.next}while(r!==i)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[gr],delete t[mr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qi));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ja||el(n,t);case 6:var i=hl,r=dl;hl=null,pl(e,t,n),dl=r,null!==(hl=i)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Ht(e)):lr(hl,n.stateNode));break;case 4:i=hl,r=dl,hl=n.stateNode.containerInfo,dl=!0,pl(e,t,n),hl=i,dl=r;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&tl(n,t,o),r=r.next}while(r!==i)}pl(e,t,n);break;case 1:if(!Ja&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){xc(n,t,a)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Ja=(i=Ja)||null!==n.memoizedState,pl(e,t,n),Ja=i):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach((function(t){var i=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));fl(o,a,r),hl=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){xc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),_l(e),4&i){try{il(3,e,e.return),rl(3,e)}catch(m){xc(e,e.return,m)}try{il(5,e,e.return)}catch(m){xc(e,e.return,m)}}break;case 1:ml(t,e),_l(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),_l(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(m){xc(e,e.return,m)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(r,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?me(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):b(r,h,d,u)}switch(l){case"input":Z(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(r,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(m){xc(e,e.return,m)}}break;case 6:if(ml(t,e),_l(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(m){xc(e,e.return,m)}}break;case 3:if(ml(t,e),_l(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(m){xc(e,e.return,m)}break;case 4:default:ml(t,e),_l(e);break;case 13:ml(t,e),_l(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Hl=Je())),4&i&&gl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||h,ml(t,e),Ja=u):ml(t,e),_l(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qa=e,h=e.child;null!==h;){for(d=Qa=h;null!==Qa;){switch(f=(p=Qa).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:el(p,p.return);var g=p.stateNode;if("function"===typeof g.componentWillUnmount){i=p,n=p.return;try{t=i,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){xc(i,n,m)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){El(d);continue}}null!==f?(f.return=p,Qa=f):El(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(m){xc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){xc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),_l(e),4&i&&gl(e);case 21:}}function _l(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),ul(e,ll(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(s(161))}}catch(a){xc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Qa=e,yl(e,t,n)}function yl(e,t,n){for(var i=0!==(1&e.mode);null!==Qa;){var r=Qa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||qa;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=qa;var c=Ja;if(qa=o,(Ja=l)&&!c)for(Qa=r;null!==Qa;)l=(o=Qa).child,22===o.tag&&null!==o.memoizedState?Sl(r):null!==l?(l.return=o,Qa=l):Sl(r);for(;null!==s;)Qa=s,yl(s,t,n),s=s.sibling;Qa=r,qa=a,Ja=c}Tl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Qa=s):Tl(e)}}function Tl(e){for(;null!==Qa;){var t=Qa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||rl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ja)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ms(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ht(d)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&sl(t)}catch(p){xc(t,t.return,p)}}if(t===e){Qa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qa=n;break}Qa=t.return}}function El(e){for(;null!==Qa;){var t=Qa;if(t===e){Qa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qa=n;break}Qa=t.return}}function Sl(e){for(;null!==Qa;){var t=Qa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){xc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){xc(t,r,l)}}var s=t.return;try{sl(t)}catch(l){xc(t,s,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){xc(t,o,l)}}}catch(l){xc(t,t.return,l)}if(t===e){Qa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Qa=a;break}Qa=t.return}}var wl,xl=Math.ceil,Ml=y.ReactCurrentDispatcher,Il=y.ReactCurrentOwner,Cl=y.ReactCurrentBatchConfig,kl=0,Rl=null,Al=null,Ll=0,Ol=0,Nl=wr(0),Dl=0,Pl=null,$l=0,Bl=0,Fl=0,Ul=null,zl=null,Hl=0,Gl=1/0,Vl=null,Wl=!1,jl=null,Xl=null,Yl=!1,Kl=null,ql=0,Jl=0,Zl=null,Ql=-1,ec=0;function tc(){return 0!==(6&kl)?Je():-1!==Ql?Ql:Ql=Je()}function nc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Ll?Ll&-Ll:null!==gs.transition?(0===ec&&(ec=gt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:qt(e.type)}function ic(e,t,n,i){if(50<Jl)throw Jl=0,Zl=null,Error(s(185));vt(e,n,i),0!==(2&kl)&&e===Rl||(e===Rl&&(0===(2&kl)&&(Bl|=n),4===Dl&&lc(e,Ll)),rc(e,i),1===n&&0===kl&&0===(1&t.mode)&&(Gl=Je()+500,Fr&&Hr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=dt(e,e===Rl?Ll:0);if(0===i)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Fr=!0,zr(e)}(cc.bind(null,e)):zr(cc.bind(null,e)),or((function(){0===(6&kl)&&Hr()})),n=null;else{switch(yt(i)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Rc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Ql=-1,ec=0,0!==(6&kl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var i=dt(e,e===Rl?Ll:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=vc(e,i);else{t=i;var r=kl;kl|=2;var o=gc();for(Rl===e&&Ll===t||(Vl=null,Gl=Je()+500,pc(e,t));;)try{bc();break}catch(l){fc(e,l)}Ts(),Ml.current=o,kl=r,null!==Al?t=0:(Rl=null,Ll=0,t=Dl)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=oc(e,r))),1===t)throw n=Pl,pc(e,0),lc(e,i),rc(e,Je()),n;if(6===t)lc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=vc(e,i))&&(0!==(o=ft(e))&&(i=o,t=oc(e,o))),1===t))throw n=Pl,pc(e,0),lc(e,i),rc(e,Je()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:Ec(e,zl,Vl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=Hl+500-Je())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(Ec.bind(null,e,zl,Vl),t);break}Ec(e,zl,Vl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Je()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*xl(i/1960))-i)){e.timeoutHandle=ir(Ec.bind(null,e,zl,Vl),i);break}Ec(e,zl,Vl);break;default:throw Error(s(329))}}}return rc(e,Je()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~Fl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&kl))throw Error(s(327));Sc();var t=dt(e,0);if(0===(1&t))return rc(e,Je()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=oc(e,i))}if(1===n)throw n=Pl,pc(e,0),lc(e,t),rc(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,zl,Vl),rc(e,Je()),null}function uc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Gl=Je()+500,Fr&&Hr())}}function hc(e){null!==Kl&&0===Kl.tag&&0===(6&kl)&&Sc();var t=kl;kl|=1;var n=Cl.transition,i=bt;try{if(Cl.transition=null,bt=1,e)return e()}finally{bt=i,Cl.transition=n,0===(6&(kl=t))&&Hr()}}function dc(){Ol=Nl.current,xr(Nl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Al)for(n=Al.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Or();break;case 3:ro(),xr(kr),xr(Cr),uo();break;case 5:oo(i);break;case 4:ro();break;case 13:case 19:xr(ao);break;case 10:Es(i.type._context);break;case 22:case 23:dc()}n=n.return}if(Rl=e,Al=e=Nc(e.current,null),Ll=Ol=t,Dl=0,Pl=null,Fl=Bl=$l=0,zl=Ul=null,null!==Ms){for(t=0;t<Ms.length;t++)if(null!==(i=(n=Ms[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Ms=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Ts(),ho.current=oa,_o){for(var i=go.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}_o=!1}if(fo=0,vo=mo=go=null,bo=!1,yo=0,Il.current=null,null===n||null===n.return){Dl=1,Pl=t,Al=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Ll,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,_a(f,a,l,0,t),1&f.mode&&ma(o,u,t),c=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),_a(v,a,l,0,t),fs(ua(c,l));break e}}o=c=ua(c,l),4!==Dl&&(Dl=2),null===Ul?Ul=[o]:Ul.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ps(o,fa(0,c,t));break e;case 1:l=c;var _=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof _.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xl||!Xl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Ps(o,ga(o,l,t));break e}}o=o.return}while(null!==o)}Tc(n)}catch(y){t=y,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function gc(){var e=Ml.current;return Ml.current=oa,null===e?oa:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Rl||0===(268435455&$l)&&0===(268435455&Bl)||lc(Rl,Ll)}function vc(e,t){var n=kl;kl|=2;var i=gc();for(Rl===e&&Ll===t||(Vl=null,pc(e,t));;)try{_c();break}catch(r){fc(e,r)}if(Ts(),kl=n,Ml.current=i,null!==Al)throw Error(s(261));return Rl=null,Ll=0,Dl}function _c(){for(;null!==Al;)yc(Al)}function bc(){for(;null!==Al&&!Ke();)yc(Al)}function yc(e){var t=wl(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?Tc(e):Al=t,Il.current=null}function Tc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ya(n,t,Ol)))return void(Al=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Dl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Dl&&(Dl=5)}function Ec(e,t,n){var i=bt,r=Cl.transition;try{Cl.transition=null,bt=1,function(e,t,n,i){do{Sc()}while(null!==Kl);if(0!==(6&kl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Rl&&(Al=Rl=null,Ll=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Rc(tt,(function(){return Sc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var a=bt;bt=1;var l=kl;kl|=4,Il.current=null,function(e,t){if(er=Vt,pi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(T){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=a),p===o&&++h===i&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Vt=!1,Qa=t;null!==Qa;)if(e=(t=Qa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qa=e;else for(;null!==Qa;){t=Qa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?m:ms(t.type,m),v);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(s(163))}}catch(T){xc(t,t.return,T)}if(null!==(e=t.sibling)){e.return=t.return,Qa=e;break}Qa=t.return}g=nl,nl=!1}(e,n),vl(n,e),fi(tr),Vt=!!er,tr=er=null,e.current=n,bl(n,e,r),qe(),kl=l,bt=a,Cl.transition=o}else e.current=n;if(Yl&&(Yl=!1,Kl=e,ql=r),o=e.pendingLanes,0===o&&(Xl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=jl,jl=null,e;0!==(1&ql)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===Zl?Jl++:(Jl=0,Zl=e):Jl=0,Hr()}(e,t,n,i)}finally{Cl.transition=r,bt=i}return null}function Sc(){if(null!==Kl){var e=yt(ql),t=Cl.transition,n=bt;try{if(Cl.transition=null,bt=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,ql=0,0!==(6&kl))throw Error(s(331));var r=kl;for(kl|=4,Qa=e.current;null!==Qa;){var o=Qa,a=o.child;if(0!==(16&Qa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qa=u;null!==Qa;){var h=Qa;switch(h.tag){case 0:case 11:case 15:il(8,h,o)}var d=h.child;if(null!==d)d.return=h,Qa=d;else for(;null!==Qa;){var p=(h=Qa).sibling,f=h.return;if(ol(h),h===u){Qa=null;break}if(null!==p){p.return=f,Qa=p;break}Qa=f}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Qa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Qa=a;else e:for(;null!==Qa;){if(0!==(2048&(o=Qa).flags))switch(o.tag){case 0:case 11:case 15:il(9,o,o.return)}var _=o.sibling;if(null!==_){_.return=o.return,Qa=_;break e}Qa=o.return}}var b=e.current;for(Qa=b;null!==Qa;){var y=(a=Qa).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,Qa=y;else e:for(a=b;null!==Qa;){if(0!==(2048&(l=Qa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(E){xc(l,l.return,E)}if(l===a){Qa=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,Qa=T;break e}Qa=l.return}}if(kl=r,Hr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(E){}i=!0}return i}finally{bt=n,Cl.transition=t}}return!1}function wc(e,t,n){e=Ns(e,t=fa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),rc(e,t))}function xc(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Xl||!Xl.has(i))){t=Ns(t,e=ga(t,e=ua(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Mc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Ll&n)===n&&(4===Dl||3===Dl&&(130023424&Ll)===Ll&&500>Je()-Hl?pc(e,0):Fl|=n),rc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=ks(e,t))&&(vt(e,t,n),rc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Ic(e,n)}function Rc(e,t){return Xe(e,t)}function Ac(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(e,t,n,i){return new Ac(e,t,n,i)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nc(e,t){var n=e.alternate;return null===n?((n=Lc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Oc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Pc(n.children,r,o,t);case w:a=8,r|=8;break;case x:return(e=Lc(12,n,t,2|r)).elementType=x,e.lanes=o,e;case k:return(e=Lc(13,n,t,r)).elementType=k,e.lanes=o,e;case R:return(e=Lc(19,n,t,r)).elementType=R,e.lanes=o,e;case O:return $c(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case M:a=10;break e;case I:a=9;break e;case C:a=11;break e;case A:a=14;break e;case L:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Lc(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Pc(e,t,n,i){return(e=Lc(7,e,i,t)).lanes=n,e}function $c(e,t,n,i){return(e=Lc(22,e,i,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Lc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Lc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,i,r,s,o,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Lc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},As(s),e}function Hc(e){if(!e)return Ir;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Lr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Lr(n))return Dr(e,n,t)}return t}function Gc(e,t,n,i,r,s,o,a,l){return(e=zc(n,i,!0,e,0,s,0,a,l)).context=Hc(null),n=e.current,(s=Os(i=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,Ns(n,s,r),e.current.lanes=r,vt(e,r,i),rc(e,i),e}function Vc(e,t,n,i){var r=t.current,s=tc(),o=nc(r);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Os(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ns(r,t,o))&&(ic(e,r,o,s),Ds(e,r,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xc(e,t){jc(e,t),(e=e.alternate)&&jc(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||kr.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),ps();break;case 5:so(t);break;case 1:Lr(t.type)&&Pr(t);break;case 4:io(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Mr(vs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Mr(ao,1&ao.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ba(e,t,n):(Mr(ao,1&ao.current),null!==(e=Wa(e,t,n))?e.sibling:null);Mr(ao,1&ao.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Ga(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mr(ao,ao.current),i)break;return null;case 22:case 23:return t.lanes=0,xa(e,t,n)}return Wa(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,rs&&0!==(1048576&t.flags)&&Qr(t,jr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Va(e,t),e=t.pendingProps;var r=Ar(t,Cr.current);ws(t,n),r=wo(null,t,i,e,r,n);var o=xo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Lr(i)?(o=!0,Pr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,As(t),r.updater=zs,t.stateNode=r,r._reactInternals=t,Ws(t,i,e,n),t=ka(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),Ta(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(i),e=ms(i,e),r){case 0:t=Ia(null,t,i,e,n);break e;case 1:t=Ca(null,t,i,e,n);break e;case 11:t=Ea(null,t,i,e,n);break e;case 14:t=Sa(null,t,i,ms(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ia(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ca(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 3:e:{if(Ra(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ls(e,t),$s(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Aa(e,t,i,n,r=ua(Error(s(423)),t));break e}if(i!==r){t=Aa(e,t,i,n,r=ua(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=Js(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=Wa(e,t,n);break e}Ta(e,t,i,n)}t=t.child}return t;case 5:return so(t),null===e&&cs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),Ma(e,t),Ta(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ba(e,t,n);case 4:return io(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=qs(t,null,i,n):Ta(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Ea(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 7:return Ta(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ta(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Mr(vs,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!kr.current){t=Wa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Os(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ss(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ss(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Ta(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,ws(t,n),i=i(r=xs(r)),t.flags|=1,Ta(e,t,i,n),t.child;case 14:return r=ms(i=t.type,t.pendingProps),Sa(e,t,i,r=ms(i.type,r),n);case 15:return wa(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ms(i,r),Va(e,t),t.tag=1,Lr(i)?(e=!0,Pr(t)):e=!1,ws(t,n),Gs(t,i,r),Ws(t,i,r,n),ka(null,t,i,!0,e,n);case 19:return Ga(e,t,n);case 22:return xa(e,t,n)}throw Error(s(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function eu(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Wc(o);a.call(e)}}Vc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Wc(o);s.call(e)}}var o=Gc(t,i,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[fr]=o.current,Hi(8===e.nodeType?e.parentNode:e),hc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Wc(l);a.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fr]=l.current,Hi(8===e.nodeType?e.parentNode:e),hc((function(){Vc(t,l,n,i)})),l}(n,t,e,r,i);return Wc(o)}qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vc(e,t,null,null)},qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Vc(null,e,null,null)})),t[fr]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&$t(e)}},Tt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(_t(t,1|n),rc(t,Je()),0===(6&kl)&&(Gl=Je()+500,Hr()))}break;case 13:hc((function(){var t=ks(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),Xc(e,1)}},Et=function(e){if(13===e.tag){var t=ks(e,134217728);if(null!==t)ic(t,e,134217728,tc());Xc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=ks(e,t);if(null!==n)ic(n,e,t,tc());Xc(e,t)}},wt=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Tr(i);if(!r)throw Error(s(90));X(i),Z(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=uc,ke=hc;var tu={usingClientEntryPoint:!1,Events:[br,yr,Tr,Me,Ie,uc]},nu={findFiberByHostInstance:_r,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(iu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,i="",r=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,Hi(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Gc(t,null,e,1,null!=n?n:null,r,0,o,a),e[fr]=t.current,Hi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new qc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(s(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Zc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,i)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var i=n(164);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{"use strict";var i=n(791),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function _(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=v.prototype;var y=b.prototype=new _;y.constructor=b,g(y,v.prototype),y.isPureReactComponent=!0;var T=Array.isArray,E=Object.prototype.hasOwnProperty,S={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,r)&&!w.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:S.current}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,T(o)?(r="",null!=e&&(r=e.replace(I,"$&/")+"/"),k(o,t,r,"",(function(e){return e}))):null!=o&&(M(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",T(e))for(var c=0;c<e.length;c++){var u=s+C(a=e[c],c);l+=k(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=k(a=a.value,t,r,u=s+C(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var i=[],r=0;return k(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},O={transition:null},N={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!w.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,n){return L.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,n){return L.current.useReducer(e,t,n)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return L.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return L.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function T(e){if(m=!1,y(e),!g)if(null!==i(c))g=!0,O(E);else{var t=i(u);null!==t&&N(T,t.startTime-e)}}function E(e,n){g=!1,m&&(m=!1,_(M),M=-1),f=!0;var s=p;try{for(y(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!k());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),y(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&N(T,h.startTime-n),l=!1}return l}finally{d=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,w=!1,x=null,M=-1,I=5,C=-1;function k(){return!(t.unstable_now()-C<I)}function R(){if(null!==x){var e=t.unstable_now();C=e;var n=!0;try{n=x(!0,e)}finally{n?S():(w=!1,x=null)}}else w=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,L=A.port2;A.port1.onmessage=R,S=function(){L.postMessage(null)}}else S=function(){v(R,0)};function O(e){x=e,w||(w=!0,S())}function N(e,n){M=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,O(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(_(M),M=-1):m=!0,N(T,s-o))):(e.sortIndex=a,n(c,e),g||f||(g=!0,O(E))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},561:(e,t,n)=>{"use strict";var i=n(791);var r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=i.useState,o=i.useEffect,a=i.useLayoutEffect,l=i.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(i){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=s({inst:{value:n,getSnapshot:t}}),r=i[0].inst,u=i[1];return a((function(){r.value=n,r.getSnapshot=t,c(r)&&u({inst:r})}),[e,n,t]),o((function(){return c(r)&&u({inst:r}),e((function(){c(r)&&u({inst:r})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:u},595:(e,t,n)=>{"use strict";var i=n(791),r=n(248);var s="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useSyncExternalStore,a=i.useRef,l=i.useEffect,c=i.useMemo,u=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,i,r){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=c((function(){function e(e){if(!l){if(l=!0,o=e,e=i(e),void 0!==r&&d.hasValue){var t=d.value;if(r(t,e))return a=t}return a=e}if(t=a,s(o,e))return t;var n=i(e);return void 0!==r&&r(t,n)?t:(o=e,a=n)}var o,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,i,r]);var p=o(e,h[0],h[1]);return l((function(){d.hasValue=!0,d.value=p}),[p]),u(p),p}},248:(e,t,n)=>{"use strict";e.exports=n(561)},327:(e,t,n)=>{"use strict";e.exports=n(595)},391:e=>{"use strict";var t=function(){};e.exports=t},174:()=>{},418:(e,t)=>{var n;!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,s(n)))}return e}function s(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)i.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var r=Object.create(null);__webpack_require__.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,__webpack_require__.d(r,s),r}})(),__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>"static/js/"+e+".578359c5.chunk.js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="my-blockly-app:";__webpack_require__.l=(n,i,r,s)=>{if(e[n])e[n].push(i);else{var o,a;if(void 0!==r)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){o=u;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",t+r),o.src=n),e[n]=[i];var h=(t,i)=>{o.onerror=o.onload=null,clearTimeout(d);var r=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(i))),t)return t(i)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),a&&document.head.appendChild(o)}}})(),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/gpu-programming/",(()=>{var e={179:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var s=__webpack_require__.p+__webpack_require__.u(t),o=new Error;__webpack_require__.l(s,(n=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",o.name="ChunkLoadError",o.type=r,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,r,s=n[0],o=n[1],a=n[2],l=0;if(s.some((t=>0!==e[t]))){for(i in o)__webpack_require__.o(o,i)&&(__webpack_require__.m[i]=o[i]);if(a)a(__webpack_require__)}for(t&&t(n);l<s.length;l++)r=s[l],__webpack_require__.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkmy_blockly_app=self.webpackChunkmy_blockly_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(791),t=__webpack_require__.t(e,2),n=__webpack_require__(250),i=(__webpack_require__(174),__webpack_require__(271));const r="143",s={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a=0,l=1,c=2,u=1,h=2,d=3,p=0,f=1,g=2,m=0,v=1,_=2,b=3,y=4,T=5,E=100,S=101,w=102,x=103,M=104,I=200,C=201,k=202,R=203,A=204,L=205,O=206,N=207,D=208,P=209,$=210,B=0,F=1,U=2,z=3,H=4,G=5,V=6,W=7,j=0,X=1,Y=2,K=0,q=1,J=2,Z=3,Q=4,ee=5,te=300,ne=301,ie=302,re=303,se=304,oe=306,ae=1e3,le=1001,ce=1002,ue=1003,he=1004,de=1005,pe=1006,fe=1007,ge=1008,me=1009,ve=1010,_e=1011,be=1012,ye=1013,Te=1014,Ee=1015,Se=1016,we=1017,xe=1018,Me=1020,Ie=1021,Ce=1022,ke=1023,Re=1024,Ae=1025,Le=1026,Oe=1027,Ne=1028,De=1029,Pe=1030,$e=1031,Be=1033,Fe=33776,Ue=33777,ze=33778,He=33779,Ge=35840,Ve=35841,We=35842,je=35843,Xe=36196,Ye=37492,Ke=37496,qe=37808,Je=37809,Ze=37810,Qe=37811,et=37812,tt=37813,nt=37814,it=37815,rt=37816,st=37817,ot=37818,at=37819,lt=37820,ct=37821,ut=36492,ht=2300,dt=2301,pt=2302,ft=2400,gt=2401,mt=2402,vt=2500,_t=2501,bt=3e3,yt=3001,Tt=3200,Et=3201,St=0,wt=1,xt="srgb",Mt="srgb-linear",It=7680,Ct=35044,kt=35048,Rt="300 es",At=1035;class Lt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const Ot=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Nt=1234567;const Dt=Math.PI/180,Pt=180/Math.PI;function $t(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Ot[255&e]+Ot[e>>8&255]+Ot[e>>16&255]+Ot[e>>24&255]+"-"+Ot[255&t]+Ot[t>>8&255]+"-"+Ot[t>>16&15|64]+Ot[t>>24&255]+"-"+Ot[63&n|128]+Ot[n>>8&255]+"-"+Ot[n>>16&255]+Ot[n>>24&255]+Ot[255&i]+Ot[i>>8&255]+Ot[i>>16&255]+Ot[i>>24&255]).toLowerCase()}function Bt(e,t,n){return Math.max(t,Math.min(n,e))}function Ft(e,t){return(e%t+t)%t}function Ut(e,t,n){return(1-n)*e+n*t}function zt(e){return 0===(e&e-1)&&0!==e}function Ht(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Gt(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var Vt=Object.freeze({__proto__:null,DEG2RAD:Dt,RAD2DEG:Pt,generateUUID:$t,clamp:Bt,euclideanModulo:Ft,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Ut,damp:function(e,t,n,i){return Ut(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Ft(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Nt=e);let t=Nt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Dt},radToDeg:function(e){return e*Pt},isPowerOfTwo:zt,ceilPowerOfTwo:Ht,floorPowerOfTwo:Gt,setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((t+i)/2),u=o((t+i)/2),h=s((t-i)/2),d=o((t-i)/2),p=s((i-t)/2),f=o((i-t)/2);switch(r){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*f,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*f,a*c);break;case"ZYZ":e.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}},denormalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}});class Wt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Wt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class jt{constructor(){jt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,r,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],g=i[3],m=i[6],v=i[1],_=i[4],b=i[7],y=i[2],T=i[5],E=i[8];return r[0]=s*f+o*v+a*y,r[3]=s*g+o*_+a*T,r[6]=s*m+o*b+a*E,r[1]=l*f+c*v+u*y,r[4]=l*g+c*_+u*T,r[7]=l*m+c*b+u*E,r[2]=h*f+d*v+p*y,r[5]=h*g+d*_+p*T,r[8]=h*m+d*b+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(i*l-c*n)*f,e[2]=(o*n-i*s)*f,e[3]=h*f,e[4]=(c*t-i*a)*f,e[5]=(i*r-o*t)*f,e[6]=d*f,e[7]=(n*a-l*t)*f,e[8]=(s*t-n*r)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],s=i[3],o=i[6],a=i[1],l=i[4],c=i[7];return i[0]=t*r+n*a,i[3]=t*s+n*l,i[6]=t*o+n*c,i[1]=-n*r+t*a,i[4]=-n*s+t*l,i[7]=-n*o+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Xt(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}const Yt={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Kt(e,t){return new Yt[e](t)}function qt(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Jt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Zt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const Qt={[xt]:{[Mt]:Jt},[Mt]:{[xt]:Zt}},en={legacyMode:!0,get workingColorSpace(){return Mt},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(Qt[t]&&void 0!==Qt[t][n]){const i=Qt[t][n];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},tn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nn={r:0,g:0,b:0},rn={h:0,s:0,l:0},sn={h:0,s:0,l:0};function on(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function an(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}class ln{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,en.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mt;return this.r=e,this.g=t,this.b=n,en.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mt;if(e=Ft(e,1),t=Bt(t,0,1),n=Bt(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=on(r,i,e+1/3),this.g=on(r,i,e),this.b=on(r,i,e-1/3)}return en.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const r=t[1],s=t[2];switch(r){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,en.toWorkingColorSpace(this,n),i(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,en.toWorkingColorSpace(this,n),i(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const t=parseFloat(e[1])/360,r=parseInt(e[2],10)/100,s=parseInt(e[3],10)/100;return i(e[4]),this.setHSL(t,r,s,n)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=t[1],i=e.length;if(3===i)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,en.toWorkingColorSpace(this,n),this;if(6===i)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,en.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;const n=tn[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Jt(e.r),this.g=Jt(e.g),this.b=Jt(e.b),this}copyLinearToSRGB(e){return this.r=Zt(e.r),this.g=Zt(e.g),this.b=Zt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return en.fromWorkingColorSpace(an(this,nn),e),Bt(255*nn.r,0,255)<<16^Bt(255*nn.g,0,255)<<8^Bt(255*nn.b,0,255)<<0}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt;en.fromWorkingColorSpace(an(this,nn),t);const n=nn.r,i=nn.g,r=nn.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case n:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-n)/e+2;break;case r:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt;return en.fromWorkingColorSpace(an(this,nn),t),e.r=nn.r,e.g=nn.g,e.b=nn.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt;return en.fromWorkingColorSpace(an(this,nn),e),e!==xt?"color(".concat(e," ").concat(nn.r," ").concat(nn.g," ").concat(nn.b,")"):"rgb(".concat(255*nn.r|0,",").concat(255*nn.g|0,",").concat(255*nn.b|0,")")}offsetHSL(e,t,n){return this.getHSL(rn),rn.h+=e,rn.s+=t,rn.l+=n,this.setHSL(rn.h,rn.s,rn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(rn),e.getHSL(sn);const n=Ut(rn.h,sn.h,t),i=Ut(rn.s,sn.s,t),r=Ut(rn.l,sn.l,t);return this.setHSL(n,i,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let cn;ln.NAMES=tn;class un{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===cn&&(cn=qt("canvas")),cn.width=e.width,cn.height=e.height;const n=cn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=cn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=qt("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*Jt(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*Jt(t[e]/255)):t[e]=Jt(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class hn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=$t(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(dn(i[t].image)):e.push(dn(i[t]))}else e=dn(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function dn(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?un.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let pn=0;class fn extends Lt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fn.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fn.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:le,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pe,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ge,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ke,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:me,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:bt;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:pn++}),this.uuid=$t(),this.name="",this.source=new hn(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Wt(0,0),this.repeat=new Wt(1,1),this.center=new Wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==te)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ae:e.x=e.x-Math.floor(e.x);break;case le:e.x=e.x<0?0:1;break;case ce:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ae:e.y=e.y-Math.floor(e.y);break;case le:e.y=e.y<0?0:1;break;case ce:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}fn.DEFAULT_IMAGE=null,fn.DEFAULT_MAPPING=te;class gn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;gn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(o+1)/2,s=(u+1)/2,g=(f+1)/2,m=(a+c)/4,v=(l+d)/4,_=(h+p)/4;return e>s&&e>g?e<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=m/n,r=v/n):s>g?s<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=m/i,r=_/i):g<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=v/r,i=_/r),this.set(n,i,r,t),this}let g=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(g)<.001&&(g=1),this.x=(p-h)/g,this.y=(l-d)/g,this.z=(c-a)/g,this.w=Math.acos((o+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class mn extends Lt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gn(0,0,e,t),this.scissorTest=!1,this.viewport=new gn(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new fn(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:pe,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new hn(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vn extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ue,this.minFilter=ue,this.wrapR=le,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _n extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ue,this.minFilter=ue,this.wrapR=le,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*f,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+f*r,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(r),n*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class yn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;yn.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(En.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(En.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*i-o*n,c=a*n+o*t-r*i,u=a*i+r*n-s*t,h=-r*t-s*n-o*i;return this.x=l*a+h*-r+c*-o-u*-s,this.y=c*a+h*-s+u*-r-l*-o,this.z=u*a+h*-o+l*-s-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Tn.copy(this).projectOnVector(e),this.sub(Tn)}reflect(e){return this.sub(Tn.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Bt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Tn=new yn,En=new bn;class Sn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,n,i),this.max.set(r,s,o),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,n,i),this.max.set(r,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=xn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,i=t.count;n<i;n++)xn.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(xn)}else null===n.boundingBox&&n.computeBoundingBox(),Mn.copy(n.boundingBox),Mn.applyMatrix4(e.matrixWorld),this.union(Mn);const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,xn),xn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(On),Nn.subVectors(this.max,On),In.subVectors(e.a,On),Cn.subVectors(e.b,On),kn.subVectors(e.c,On),Rn.subVectors(Cn,In),An.subVectors(kn,Cn),Ln.subVectors(In,kn);let t=[0,-Rn.z,Rn.y,0,-An.z,An.y,0,-Ln.z,Ln.y,Rn.z,0,-Rn.x,An.z,0,-An.x,Ln.z,0,-Ln.x,-Rn.y,Rn.x,0,-An.y,An.x,0,-Ln.y,Ln.x,0];return!(!$n(t,In,Cn,kn,Nn)||(t=[1,0,0,0,1,0,0,0,1],!$n(t,In,Cn,kn,Nn)))&&(Dn.crossVectors(Rn,An),t=[Dn.x,Dn.y,Dn.z],$n(t,In,Cn,kn,Nn))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return xn.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(xn).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(wn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wn)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wn=[new yn,new yn,new yn,new yn,new yn,new yn,new yn,new yn],xn=new yn,Mn=new Sn,In=new yn,Cn=new yn,kn=new yn,Rn=new yn,An=new yn,Ln=new yn,On=new yn,Nn=new yn,Dn=new yn,Pn=new yn;function $n(e,t,n,i,r){for(let s=0,o=e.length-3;s<=o;s+=3){Pn.fromArray(e,s);const o=r.x*Math.abs(Pn.x)+r.y*Math.abs(Pn.y)+r.z*Math.abs(Pn.z),a=t.dot(Pn),l=n.dot(Pn),c=i.dot(Pn);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Bn=new Sn,Fn=new yn,Un=new yn,zn=new yn;class Hn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Bn.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){zn.subVectors(e,this.center);const t=zn.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add(zn.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return!0===this.center.equals(e.center)?Un.set(0,0,1).multiplyScalar(e.radius):Un.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Fn.copy(e.center).add(Un)),this.expandByPoint(Fn.copy(e.center).sub(Un)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Gn=new yn,Vn=new yn,Wn=new yn,jn=new yn,Xn=new yn,Yn=new yn,Kn=new yn;class qn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Gn)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Gn.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Gn.copy(this.direction).multiplyScalar(t).add(this.origin),Gn.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Vn.copy(e).add(t).multiplyScalar(.5),Wn.copy(t).sub(e).normalize(),jn.copy(this.origin).sub(Vn);const r=.5*e.distanceTo(t),s=-this.direction.dot(Wn),o=jn.dot(this.direction),a=-jn.dot(Wn),l=jn.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Wn).multiplyScalar(h).add(Vn),d}intersectSphere(e,t){Gn.subVectors(e.center,this.origin);const n=Gn.dot(this.direction),i=Gn.dot(Gn)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return o<0&&a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),n>s||r>i||((r>n||n!==n)&&(n=r),(s<i||i!==i)&&(i=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||o>i)||((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return null!==this.intersectBox(e,Gn)}intersectTriangle(e,t,n,i,r){Xn.subVectors(t,e),Yn.subVectors(n,e),Kn.crossVectors(Xn,Yn);let s,o=this.direction.dot(Kn);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}jn.subVectors(this.origin,e);const a=s*this.direction.dot(Yn.crossVectors(jn,Yn));if(a<0)return null;const l=s*this.direction.dot(Xn.cross(jn));if(l<0||a+l>o)return null;const c=-s*jn.dot(Kn);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Jn{constructor(){Jn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,f,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=i,m[1]=r,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=d,m[7]=p,m[11]=f,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Jn).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Zn.setFromMatrixColumn(e,0).length(),r=1/Zn.setFromMatrixColumn(e,1).length(),s=1/Zn.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*a,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e+r*o,t[4]=i*o-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e-r*o,t[4]=-s*u,t[8]=i+n*o,t[1]=n+i*o,t[5]=s*c,t[9]=r-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=a*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=o*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ei,e,ti)}lookAt(e,t,n){const i=this.elements;return ri.subVectors(e,t),0===ri.lengthSq()&&(ri.z=1),ri.normalize(),ni.crossVectors(n,ri),0===ni.lengthSq()&&(1===Math.abs(n.z)?ri.x+=1e-4:ri.z+=1e-4,ri.normalize(),ni.crossVectors(n,ri)),ni.normalize(),ii.crossVectors(ri,ni),i[0]=ni.x,i[4]=ii.x,i[8]=ri.x,i[1]=ni.y,i[5]=ii.y,i[9]=ri.y,i[2]=ni.z,i[6]=ii.z,i[10]=ri.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],g=n[10],m=n[14],v=n[3],_=n[7],b=n[11],y=n[15],T=i[0],E=i[4],S=i[8],w=i[12],x=i[1],M=i[5],I=i[9],C=i[13],k=i[2],R=i[6],A=i[10],L=i[14],O=i[3],N=i[7],D=i[11],P=i[15];return r[0]=s*T+o*x+a*k+l*O,r[4]=s*E+o*M+a*R+l*N,r[8]=s*S+o*I+a*A+l*D,r[12]=s*w+o*C+a*L+l*P,r[1]=c*T+u*x+h*k+d*O,r[5]=c*E+u*M+h*R+d*N,r[9]=c*S+u*I+h*A+d*D,r[13]=c*w+u*C+h*L+d*P,r[2]=p*T+f*x+g*k+m*O,r[6]=p*E+f*M+g*R+m*N,r[10]=p*S+f*I+g*A+m*D,r[14]=p*w+f*C+g*L+m*P,r[3]=v*T+_*x+b*k+y*O,r[7]=v*E+_*M+b*R+y*N,r[11]=v*S+_*I+b*A+y*D,r[15]=v*w+_*C+b*L+y*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+e[7]*(+t*a*d-t*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+e[11]*(+t*l*u-t*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+e[15]*(-i*o*c-t*a*u+t*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],g=e[14],m=e[15],v=u*g*l-f*h*l+f*a*d-o*g*d-u*a*m+o*h*m,_=p*h*l-c*g*l-p*a*d+s*g*d+c*a*m-s*h*m,b=c*f*l-p*u*l+p*o*d-s*f*d-c*o*m+s*u*m,y=p*u*a-c*f*a-p*o*h+s*f*h+c*o*g-s*u*g,T=t*v+n*_+i*b+r*y;if(0===T)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/T;return e[0]=v*E,e[1]=(f*h*r-u*g*r-f*i*d+n*g*d+u*i*m-n*h*m)*E,e[2]=(o*g*r-f*a*r+f*i*l-n*g*l-o*i*m+n*a*m)*E,e[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*E,e[4]=_*E,e[5]=(c*g*r-p*h*r+p*i*d-t*g*d-c*i*m+t*h*m)*E,e[6]=(p*a*r-s*g*r-p*i*l+t*g*l+s*i*m-t*a*m)*E,e[7]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*d+t*a*d)*E,e[8]=b*E,e[9]=(p*u*r-c*f*r-p*n*d+t*f*d+c*n*m-t*u*m)*E,e[10]=(s*f*r-p*o*r+p*n*l-t*f*l-s*n*m+t*o*m)*E,e[11]=(c*o*r-s*u*r-c*n*l+t*u*l+s*n*d-t*o*d)*E,e[12]=y*E,e[13]=(c*f*i-p*u*i+p*n*h-t*f*h-c*n*g+t*u*g)*E,e[14]=(p*o*i-s*f*i-p*n*a+t*f*a+s*n*g-t*o*g)*E,e[15]=(s*u*i-c*o*i+c*n*a-t*u*a-s*n*h+t*o*h)*E,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,f=s*c,g=s*u,m=o*u,v=a*l,_=a*c,b=a*u,y=n.x,T=n.y,E=n.z;return i[0]=(1-(f+m))*y,i[1]=(d+b)*y,i[2]=(p-_)*y,i[3]=0,i[4]=(d-b)*T,i[5]=(1-(h+m))*T,i[6]=(g+v)*T,i[7]=0,i[8]=(p+_)*E,i[9]=(g-v)*E,i[10]=(1-(h+f))*E,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=Zn.set(i[0],i[1],i[2]).length();const s=Zn.set(i[4],i[5],i[6]).length(),o=Zn.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Qn.copy(this);const a=1/r,l=1/s,c=1/o;return Qn.elements[0]*=a,Qn.elements[1]*=a,Qn.elements[2]*=a,Qn.elements[4]*=l,Qn.elements[5]*=l,Qn.elements[6]*=l,Qn.elements[8]*=c,Qn.elements[9]*=c,Qn.elements[10]*=c,t.setFromRotationMatrix(Qn),n.x=r,n.y=s,n.z=o,this}makePerspective(e,t,n,i,r,s){const o=this.elements,a=2*r/(t-e),l=2*r/(n-i),c=(t+e)/(t-e),u=(n+i)/(n-i),h=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,i,r,s){const o=this.elements,a=1/(t-e),l=1/(n-i),c=1/(s-r),u=(t+e)*a,h=(n+i)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Zn=new yn,Qn=new Jn,ei=new yn(0,0,0),ti=new yn(1,1,1),ni=new yn,ii=new yn,ri=new yn,si=new Jn,oi=new bn;class ai{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ai.DefaultOrder;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Bt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Bt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Bt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Bt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Bt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Bt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return si.makeRotationFromQuaternion(e),this.setFromRotationMatrix(si,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return oi.setFromEuler(this),this.setFromQuaternion(oi,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}ai.DefaultOrder="XYZ",ai.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class li{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&(1<<e|0))}}let ci=0;const ui=new yn,hi=new bn,di=new Jn,pi=new yn,fi=new yn,gi=new yn,mi=new bn,vi=new yn(1,0,0),_i=new yn(0,1,0),bi=new yn(0,0,1),yi={type:"added"},Ti={type:"removed"};class Ei extends Lt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ci++}),this.uuid=$t(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ei.DefaultUp.clone();const e=new yn,t=new ai,n=new bn,i=new yn(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Jn},normalMatrix:{value:new jt}}),this.matrix=new Jn,this.matrixWorld=new Jn,this.matrixAutoUpdate=Ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new li,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hi.setFromAxisAngle(e,t),this.quaternion.multiply(hi),this}rotateOnWorldAxis(e,t){return hi.setFromAxisAngle(e,t),this.quaternion.premultiply(hi),this}rotateX(e){return this.rotateOnAxis(vi,e)}rotateY(e){return this.rotateOnAxis(_i,e)}rotateZ(e){return this.rotateOnAxis(bi,e)}translateOnAxis(e,t){return ui.copy(e).applyQuaternion(this.quaternion),this.position.add(ui.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(vi,e)}translateY(e){return this.translateOnAxis(_i,e)}translateZ(e){return this.translateOnAxis(bi,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(di.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?pi.copy(e):pi.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),fi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?di.lookAt(fi,pi,this.up):di.lookAt(pi,fi,this.up),this.quaternion.setFromRotationMatrix(di),i&&(di.extractRotation(i.matrixWorld),hi.setFromRotationMatrix(di),this.quaternion.premultiply(hi.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(yi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ti)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ti)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),di.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),di.multiply(e.parent.matrixWorld)),e.applyMatrix4(di),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fi,e,gi),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fi,mi,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Ei.DefaultUp=new yn(0,1,0),Ei.DefaultMatrixAutoUpdate=!0;const Si=new yn,wi=new yn,xi=new yn,Mi=new yn,Ii=new yn,Ci=new yn,ki=new yn,Ri=new yn,Ai=new yn,Li=new yn;class Oi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Si.subVectors(e,t),i.cross(Si);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Si.subVectors(i,t),wi.subVectors(n,t),xi.subVectors(e,t);const s=Si.dot(Si),o=Si.dot(wi),a=Si.dot(xi),l=wi.dot(wi),c=wi.dot(xi),u=s*l-o*o;if(0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Mi),Mi.x>=0&&Mi.y>=0&&Mi.x+Mi.y<=1}static getUV(e,t,n,i,r,s,o,a){return this.getBarycoord(e,t,n,i,Mi),a.set(0,0),a.addScaledVector(r,Mi.x),a.addScaledVector(s,Mi.y),a.addScaledVector(o,Mi.z),a}static isFrontFacing(e,t,n,i){return Si.subVectors(n,t),wi.subVectors(e,t),Si.cross(wi).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Si.subVectors(this.c,this.b),wi.subVectors(this.a,this.b),.5*Si.cross(wi).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Oi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Oi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return Oi.getUV(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Oi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Oi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,o;Ii.subVectors(i,n),Ci.subVectors(r,n),Ri.subVectors(e,n);const a=Ii.dot(Ri),l=Ci.dot(Ri);if(a<=0&&l<=0)return t.copy(n);Ai.subVectors(e,i);const c=Ii.dot(Ai),u=Ci.dot(Ai);if(c>=0&&u<=c)return t.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(n).addScaledVector(Ii,s);Li.subVectors(e,r);const d=Ii.dot(Li),p=Ci.dot(Li);if(p>=0&&d<=p)return t.copy(r);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(Ci,o);const g=c*p-d*u;if(g<=0&&u-c>=0&&d-p>=0)return ki.subVectors(r,i),o=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(ki,o);const m=1/(g+f+h);return s=f*m,o=h*m,t.copy(n).addScaledVector(Ii,s).addScaledVector(Ci,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Ni=0;class Di extends Lt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ni++}),this.uuid=$t(),this.name="",this.type="Material",this.blending=v,this.side=p,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=A,this.blendDst=L,this.blendEquation=E,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=It,this.stencilZFail=It,this.stencilZPass=It,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==v&&(n.blending=this.blending),this.side!==p&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Pi extends Di{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ln(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $i=new yn,Bi=new Wt;class Fi{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Ct,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new ln),t[n++]=r.r,t[n++]=r.g,t[n++]=r.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new Wt),t[n++]=r.x,t[n++]=r.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new yn),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new gn),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n++]=r.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix3(e),this.setXY(t,Bi.x,Bi.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix3(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ct&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Ui extends Fi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class zi extends Fi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Hi extends Fi{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Gi=0;const Vi=new Jn,Wi=new Ei,ji=new yn,Xi=new Sn,Yi=new Sn,Ki=new yn;class qi extends Lt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Gi++}),this.uuid=$t(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Xt(e)?zi:Ui)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new jt).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vi.makeRotationFromQuaternion(e),this.applyMatrix4(Vi),this}rotateX(e){return Vi.makeRotationX(e),this.applyMatrix4(Vi),this}rotateY(e){return Vi.makeRotationY(e),this.applyMatrix4(Vi),this}rotateZ(e){return Vi.makeRotationZ(e),this.applyMatrix4(Vi),this}translate(e,t,n){return Vi.makeTranslation(e,t,n),this.applyMatrix4(Vi),this}scale(e,t,n){return Vi.makeScale(e,t,n),this.applyMatrix4(Vi),this}lookAt(e){return Wi.lookAt(e),Wi.updateMatrix(),this.applyMatrix4(Wi.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ji).negate(),this.translate(ji.x,ji.y,ji.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Hi(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Sn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new yn(-1/0,-1/0,-1/0),new yn(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];Xi.setFromBufferAttribute(e),this.morphTargetsRelative?(Ki.addVectors(this.boundingBox.min,Xi.min),this.boundingBox.expandByPoint(Ki),Ki.addVectors(this.boundingBox.max,Xi.max),this.boundingBox.expandByPoint(Ki)):(this.boundingBox.expandByPoint(Xi.min),this.boundingBox.expandByPoint(Xi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Hn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new yn,1/0);if(e){const n=this.boundingSphere.center;if(Xi.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];Yi.setFromBufferAttribute(n),this.morphTargetsRelative?(Ki.addVectors(Xi.min,Yi.min),Xi.expandByPoint(Ki),Ki.addVectors(Xi.max,Yi.max),Xi.expandByPoint(Ki)):(Xi.expandByPoint(Yi.min),Xi.expandByPoint(Yi.max))}Xi.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)Ki.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(Ki));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],o=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)Ki.fromBufferAttribute(s,t),o&&(ji.fromBufferAttribute(e,t),Ki.add(ji)),i=Math.max(i,n.distanceToSquared(Ki))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,r=t.normal.array,s=t.uv.array,o=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Fi(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let x=0;x<o;x++)l[x]=new yn,c[x]=new yn;const u=new yn,h=new yn,d=new yn,p=new Wt,f=new Wt,g=new Wt,m=new yn,v=new yn;function _(e,t,n){u.fromArray(i,3*e),h.fromArray(i,3*t),d.fromArray(i,3*n),p.fromArray(s,2*e),f.fromArray(s,2*t),g.fromArray(s,2*n),h.sub(u),d.sub(u),f.sub(p),g.sub(p);const r=1/(f.x*g.y-g.x*f.y);!isFinite(r)||(m.copy(h).multiplyScalar(g.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-g.x).multiplyScalar(r),l[e].add(m),l[t].add(m),l[n].add(m),c[e].add(v),c[t].add(v),c[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let x=0,M=b.length;x<M;++x){const e=b[x],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)_(n[i+0],n[i+1],n[i+2])}const y=new yn,T=new yn,E=new yn,S=new yn;function w(e){E.fromArray(r,3*e),S.copy(E);const t=l[e];y.copy(t),y.sub(E.multiplyScalar(E.dot(t))).normalize(),T.crossVectors(S,t);const n=T.dot(c[e])<0?-1:1;a[4*e]=y.x,a[4*e+1]=y.y,a[4*e+2]=y.z,a[4*e+3]=n}for(let x=0,M=b.length;x<M;++x){const e=b[x],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)w(n[i+0]),w(n[i+1]),w(n[i+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Fi(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new yn,r=new yn,s=new yn,o=new yn,a=new yn,l=new yn,c=new yn,u=new yn;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===e.attributes[i])continue;const r=n[i].array,s=e.attributes[i],o=s.array,a=s.itemSize*t,l=Math.min(o.length,r.length-a);for(let e=0,t=a;e<l;e++,t++)r[t]=o[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ki.fromBufferAttribute(e,t),Ki.normalize(),e.setXYZ(t,Ki.x,Ki.y,Ki.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let o=0,a=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[a++]=n[o++]}return new Fi(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qi,n=this.index.array,i=this.attributes;for(const o in i){const r=e(i[o],n);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[o]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const e=s[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const i={};let r=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[a]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ji=new Jn,Zi=new qn,Qi=new Hn,er=new yn,tr=new yn,nr=new yn,ir=new yn,rr=new yn,sr=new yn,or=new yn,ar=new yn,lr=new yn,cr=new Wt,ur=new Wt,hr=new Wt,dr=new yn,pr=new yn;class fr extends Ei{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pi;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i||(null===n.boundingSphere&&n.computeBoundingSphere(),Qi.copy(n.boundingSphere),Qi.applyMatrix4(r),!1===e.ray.intersectsSphere(Qi))||(Ji.copy(r).invert(),Zi.copy(e.ray).applyMatrix4(Ji),null!==n.boundingBox&&!1===Zi.intersectsBox(n.boundingBox)))return;let s;const o=n.index,a=n.attributes.position,l=n.morphAttributes.position,c=n.morphTargetsRelative,u=n.attributes.uv,h=n.attributes.uv2,d=n.groups,p=n.drawRange;if(null!==o)if(Array.isArray(i))for(let f=0,g=d.length;f<g;f++){const n=d[f],r=i[n.materialIndex];for(let i=Math.max(n.start,p.start),d=Math.min(o.count,Math.min(n.start+n.count,p.start+p.count));i<d;i+=3){const d=o.getX(i),p=o.getX(i+1),f=o.getX(i+2);s=gr(this,r,e,Zi,a,l,c,u,h,d,p,f),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,p.start),r=Math.min(o.count,p.start+p.count);n<r;n+=3){const r=o.getX(n),d=o.getX(n+1),p=o.getX(n+2);s=gr(this,i,e,Zi,a,l,c,u,h,r,d,p),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}else if(void 0!==a)if(Array.isArray(i))for(let f=0,g=d.length;f<g;f++){const n=d[f],r=i[n.materialIndex];for(let i=Math.max(n.start,p.start),o=Math.min(a.count,Math.min(n.start+n.count,p.start+p.count));i<o;i+=3){s=gr(this,r,e,Zi,a,l,c,u,h,i,i+1,i+2),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,p.start),r=Math.min(a.count,p.start+p.count);n<r;n+=3){s=gr(this,i,e,Zi,a,l,c,u,h,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}}}function gr(e,t,n,i,r,s,o,a,l,c,u,h){er.fromBufferAttribute(r,c),tr.fromBufferAttribute(r,u),nr.fromBufferAttribute(r,h);const d=e.morphTargetInfluences;if(s&&d){or.set(0,0,0),ar.set(0,0,0),lr.set(0,0,0);for(let e=0,t=s.length;e<t;e++){const t=d[e],n=s[e];0!==t&&(ir.fromBufferAttribute(n,c),rr.fromBufferAttribute(n,u),sr.fromBufferAttribute(n,h),o?(or.addScaledVector(ir,t),ar.addScaledVector(rr,t),lr.addScaledVector(sr,t)):(or.addScaledVector(ir.sub(er),t),ar.addScaledVector(rr.sub(tr),t),lr.addScaledVector(sr.sub(nr),t)))}er.add(or),tr.add(ar),nr.add(lr)}e.isSkinnedMesh&&(e.boneTransform(c,er),e.boneTransform(u,tr),e.boneTransform(h,nr));const p=function(e,t,n,i,r,s,o,a){let l;if(l=t.side===f?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,t.side!==g,a),null===l)return null;pr.copy(a),pr.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(pr);return c<n.near||c>n.far?null:{distance:c,point:pr.clone(),object:e}}(e,t,n,i,er,tr,nr,dr);if(p){a&&(cr.fromBufferAttribute(a,c),ur.fromBufferAttribute(a,u),hr.fromBufferAttribute(a,h),p.uv=Oi.getUV(dr,er,tr,nr,cr,ur,hr,new Wt)),l&&(cr.fromBufferAttribute(l,c),ur.fromBufferAttribute(l,u),hr.fromBufferAttribute(l,h),p.uv2=Oi.getUV(dr,er,tr,nr,cr,ur,hr,new Wt));const e={a:c,b:u,c:h,normal:new yn,materialIndex:0};Oi.getNormal(er,tr,nr,e.normal),p.face=e}return p}class mr extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,i,r,s,p,f,g,m,v){const _=s/g,b=p/m,y=s/2,T=p/2,E=f/2,S=g+1,w=m+1;let x=0,M=0;const I=new yn;for(let o=0;o<w;o++){const s=o*b-T;for(let a=0;a<S;a++){const h=a*_-y;I[e]=h*i,I[t]=s*r,I[n]=E,l.push(I.x,I.y,I.z),I[e]=0,I[t]=0,I[n]=f>0?1:-1,c.push(I.x,I.y,I.z),u.push(a/g),u.push(1-o/m),x+=1}}for(let o=0;o<m;o++)for(let e=0;e<g;e++){const t=h+e+S*o,n=h+e+S*(o+1),i=h+(e+1)+S*(o+1),r=h+(e+1)+S*o;a.push(t,n,r),a.push(n,i,r),M+=6}o.addGroup(d,M,v),d+=M,h+=x}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new Hi(l,3)),this.setAttribute("normal",new Hi(c,3)),this.setAttribute("uv",new Hi(u,2))}static fromJSON(e){return new mr(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vr(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function _r(e){const t={};for(let n=0;n<e.length;n++){const i=vr(e[n]);for(const e in i)t[e]=i[e]}return t}const br={clone:vr,merge:_r};class yr extends Di{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vr(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Tr extends Ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jn,this.projectionMatrix=new Jn,this.projectionMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Er extends Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Pt*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Dt*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Pt*Math.atan(Math.tan(.5*Dt*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Dt*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/o,i*=s.width/e,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Sr=90;class wr extends Ei{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new Er(Sr,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new yn(1,0,0)),this.add(i);const r=new Er(Sr,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new yn(-1,0,0)),this.add(r);const s=new Er(Sr,1,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new yn(0,1,0)),this.add(s);const o=new Er(Sr,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new yn(0,-1,0)),this.add(o);const a=new Er(Sr,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new yn(0,0,1)),this.add(a);const l=new Er(Sr,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new yn(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,s,o,a,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=K,e.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,a),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class xr extends fn{constructor(e,t,n,i,r,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ne,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Mr extends mn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new xr(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:pe}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new mr(5,5,5),o=new yr({name:"CubemapFromEquirect",uniforms:vr(n),vertexShader:i,fragmentShader:r,side:f,blending:m});o.uniforms.tEquirect.value=t;const a=new fr(s,o),l=t.minFilter;return t.minFilter===ge&&(t.minFilter=pe),new wr(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}const Ir=new yn,Cr=new yn,kr=new jt;class Rr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Ir.subVectors(n,t).cross(Cr.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Ir),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(n).multiplyScalar(r).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||kr.getNormalMatrix(e),i=this.coplanarPoint(Ir).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ar=new Hn,Lr=new yn;class Or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Rr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Rr,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Rr,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Rr,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Rr;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],g=n[12],m=n[13],v=n[14],_=n[15];return t[0].setComponents(o-i,u-a,f-h,_-g).normalize(),t[1].setComponents(o+i,u+a,f+h,_+g).normalize(),t[2].setComponents(o+r,u+l,f+d,_+m).normalize(),t[3].setComponents(o-r,u-l,f-d,_-m).normalize(),t[4].setComponents(o-s,u-c,f-p,_-v).normalize(),t[5].setComponents(o+s,u+c,f+p,_+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ar.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ar)}intersectsSprite(e){return Ar.center.set(0,0,0),Ar.radius=.7071067811865476,Ar.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ar)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Lr.x=i.normal.x>0?e.max.x:e.min.x,Lr.y=i.normal.y>0?e.max.y:e.min.y,Lr.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Lr)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Nr(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Dr(e,t){const n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=i.get(t);void 0===s?i.set(t,function(t,i){const r=t.array,s=t.usage,o=e.createBuffer();let a;if(e.bindBuffer(i,o),e.bufferData(i,r,s),t.onUploadCallback(),r instanceof Float32Array)a=5126;else if(r instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(r instanceof Int16Array)a=5122;else if(r instanceof Uint32Array)a=5125;else if(r instanceof Int32Array)a=5124;else if(r instanceof Int8Array)a=5120;else if(r instanceof Uint8Array)a=5121;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);a=5121}return{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,r)):s.version<t.version&&(function(t,i,r){const s=i.array,o=i.updateRange;e.bindBuffer(r,t),-1===o.count?e.bufferSubData(r,0,s):(n?e.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):e.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,t,r),s.version=t.version)}}}class Pr extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,u=e/o,h=t/a,d=[],p=[],f=[],g=[];for(let m=0;m<c;m++){const e=m*h-s;for(let t=0;t<l;t++){const n=t*u-r;p.push(n,-e,0),f.push(0,0,1),g.push(t/o),g.push(1-m/a)}}for(let m=0;m<a;m++)for(let e=0;e<o;e++){const t=e+l*m,n=e+l*(m+1),i=e+1+l*(m+1),r=e+1+l*m;d.push(t,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new Hi(p,3)),this.setAttribute("normal",new Hi(f,3)),this.setAttribute("uv",new Hi(g,2))}static fromJSON(e){return new Pr(e.width,e.height,e.widthSegments,e.heightSegments)}}const $r={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Br={common:{diffuse:{value:new ln(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new jt},uv2Transform:{value:new jt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ln(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ln(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jt}},sprite:{diffuse:{value:new ln(16777215)},opacity:{value:1},center:{value:new Wt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jt}}},Fr={basic:{uniforms:_r([Br.common,Br.specularmap,Br.envmap,Br.aomap,Br.lightmap,Br.fog]),vertexShader:$r.meshbasic_vert,fragmentShader:$r.meshbasic_frag},lambert:{uniforms:_r([Br.common,Br.specularmap,Br.envmap,Br.aomap,Br.lightmap,Br.emissivemap,Br.fog,Br.lights,{emissive:{value:new ln(0)}}]),vertexShader:$r.meshlambert_vert,fragmentShader:$r.meshlambert_frag},phong:{uniforms:_r([Br.common,Br.specularmap,Br.envmap,Br.aomap,Br.lightmap,Br.emissivemap,Br.bumpmap,Br.normalmap,Br.displacementmap,Br.fog,Br.lights,{emissive:{value:new ln(0)},specular:{value:new ln(1118481)},shininess:{value:30}}]),vertexShader:$r.meshphong_vert,fragmentShader:$r.meshphong_frag},standard:{uniforms:_r([Br.common,Br.envmap,Br.aomap,Br.lightmap,Br.emissivemap,Br.bumpmap,Br.normalmap,Br.displacementmap,Br.roughnessmap,Br.metalnessmap,Br.fog,Br.lights,{emissive:{value:new ln(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$r.meshphysical_vert,fragmentShader:$r.meshphysical_frag},toon:{uniforms:_r([Br.common,Br.aomap,Br.lightmap,Br.emissivemap,Br.bumpmap,Br.normalmap,Br.displacementmap,Br.gradientmap,Br.fog,Br.lights,{emissive:{value:new ln(0)}}]),vertexShader:$r.meshtoon_vert,fragmentShader:$r.meshtoon_frag},matcap:{uniforms:_r([Br.common,Br.bumpmap,Br.normalmap,Br.displacementmap,Br.fog,{matcap:{value:null}}]),vertexShader:$r.meshmatcap_vert,fragmentShader:$r.meshmatcap_frag},points:{uniforms:_r([Br.points,Br.fog]),vertexShader:$r.points_vert,fragmentShader:$r.points_frag},dashed:{uniforms:_r([Br.common,Br.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$r.linedashed_vert,fragmentShader:$r.linedashed_frag},depth:{uniforms:_r([Br.common,Br.displacementmap]),vertexShader:$r.depth_vert,fragmentShader:$r.depth_frag},normal:{uniforms:_r([Br.common,Br.bumpmap,Br.normalmap,Br.displacementmap,{opacity:{value:1}}]),vertexShader:$r.meshnormal_vert,fragmentShader:$r.meshnormal_frag},sprite:{uniforms:_r([Br.sprite,Br.fog]),vertexShader:$r.sprite_vert,fragmentShader:$r.sprite_frag},background:{uniforms:{uvTransform:{value:new jt},t2D:{value:null}},vertexShader:$r.background_vert,fragmentShader:$r.background_frag},cube:{uniforms:_r([Br.envmap,{opacity:{value:1}}]),vertexShader:$r.cube_vert,fragmentShader:$r.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$r.equirect_vert,fragmentShader:$r.equirect_frag},distanceRGBA:{uniforms:_r([Br.common,Br.displacementmap,{referencePosition:{value:new yn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$r.distanceRGBA_vert,fragmentShader:$r.distanceRGBA_frag},shadow:{uniforms:_r([Br.lights,Br.fog,{color:{value:new ln(0)},opacity:{value:1}}]),vertexShader:$r.shadow_vert,fragmentShader:$r.shadow_frag}};function Ur(e,t,n,i,r,s){const o=new ln(0);let a,l,c=!0===r?0:1,u=null,h=0,d=null;function g(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,s)}return{getClearColor:function(){return o},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(e),c=t,g(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,g(o,c)},render:function(n,r){let s=!1,m=!0===r.isScene?r.background:null;m&&m.isTexture&&(m=t.get(m));const v=e.xr,_=v.getSession&&v.getSession();_&&"additive"===_.environmentBlendMode&&(m=null),null===m?g(o,c):m&&m.isColor&&(g(m,1),s=!0),(e.autoClear||s)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===oe)?(void 0===l&&(l=new fr(new mr(1,1,1),new yr({name:"BackgroundCubeMaterial",uniforms:vr(Fr.cube.uniforms),vertexShader:Fr.cube.vertexShader,fragmentShader:Fr.cube.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,(u!==m||h!==m.version||d!==e.toneMapping)&&(l.material.needsUpdate=!0,u=m,h=m.version,d=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===a&&(a=new fr(new Pr(2,2),new yr({name:"BackgroundMaterial",uniforms:vr(Fr.background.uniforms),vertexShader:Fr.background.vertexShader,fragmentShader:Fr.background.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),a.material.uniforms.uvTransform.value.copy(m.matrix),(u!==m||h!==m.version||d!==e.toneMapping)&&(a.material.needsUpdate=!0,u=m,h=m.version,d=e.toneMapping),a.layers.enableAll(),n.unshift(a,a.geometry,a.material,0,0,null))}}}function zr(e,t,n,i){const r=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=p(null);let c=l,u=!1;function h(t){return i.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return i.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){const t=[],n=[],i=[];for(let s=0;s<r;s++)t[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function g(e){m(e,0)}function m(n,r){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;s[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),a[n]!==r&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),a[n]=r)}function v(){const t=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function _(t,n,r,s,o,a){!0!==i.isWebGL2||5124!==r&&5125!==r?e.vertexAttribPointer(t,n,r,s,o,a):e.vertexAttribIPointer(t,n,r,o,a)}function b(){y(),u=!0,c!==l&&(c=l,h(c.object))}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,b,y){let T=!1;if(o){const t=function(t,n,r){const o=!0===r.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[o];return void 0===u&&(u=p(i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[o]=u),u}(b,d,l);c!==t&&(c=t,h(c.object)),T=function(e,t,n,i){const r=c.attributes,s=t.attributes;let o=0;const a=n.getAttributes();for(const l in a)if(a[l].location>=0){const t=r[l];let n=s[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t||t.attribute!==n||n&&t.data!==n.data)return!0;o++}return c.attributesNum!==o||c.index!==i}(r,b,d,y),T&&function(e,t,n,i){const r={},s=t.attributes;let o=0;const a=n.getAttributes();for(const l in a)if(a[l].location>=0){let t=s[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[l]=n,o++}c.attributes=r,c.attributesNum=o,c.index=i}(r,b,d,y)}else{const e=!0===l.wireframe;(c.geometry!==b.id||c.program!==d.id||c.wireframe!==e)&&(c.geometry=b.id,c.program=d.id,c.wireframe=e,T=!0)}null!==y&&n.update(y,34963),(T||u)&&(u=!1,function(r,s,o,a){if(!1===i.isWebGL2&&(r.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const t in c){const i=c[t];if(i.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&r.instanceMatrix&&(s=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(s=r.instanceColor)),void 0!==s){const t=s.normalized,o=s.itemSize,l=n.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const n=s.data,l=n.stride,d=s.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)m(i.location+e,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<i.locationSize;e++)g(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)_(i.location+e,o/i.locationSize,u,t,l*h,(d+o/i.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)m(i.location+e,s.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)g(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)_(i.location+e,o/i.locationSize,u,t,o*h,o/i.locationSize*e*h)}}else if(void 0!==u){const n=u[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i.location,n);break;case 3:e.vertexAttrib3fv(i.location,n);break;case 4:e.vertexAttrib4fv(i.location,n);break;default:e.vertexAttrib1fv(i.location,n)}}}}v()}(r,l,d,b),null!==y&&e.bindBuffer(34963,n.get(y).buffer))},reset:b,resetDefaultState:y,dispose:function(){b();for(const e in a){const t=a[e];for(const e in t){const n=t[e];for(const e in n)d(n[e].object),delete n[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const n in t){const e=t[n];for(const t in e)d(e[t].object),delete e[t];delete t[n]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const n=a[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)d(i[e].object),delete i[e];delete n[e.id]}},initAttributes:f,enableAttribute:g,disableUnusedAttributes:v}}function Hr(e,t,n,i){const r=i.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,i){e.drawArrays(s,t,i),n.update(i,s,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(r)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,i,o,a),n.update(o,s,a)}}function Gr(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=s||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),g=e.getParameter(36347),m=e.getParameter(36348),v=e.getParameter(36349),_=h>0,b=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:_&&b,maxSamples:s?e.getParameter(36183):0}}function Vr(e){const t=this;let n=null,i=0,r=!1,s=!1;const o=new Rr,a=new jt,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)o.copy(e[n]).applyMatrix4(r,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,s){const o=0!==e.length||t||0!==i||r;return r=t,n=u(e,s,0),i=e.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(t,o,a){const h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(!r||null===h||0===h.length||s&&!p)s?u(null):c();else{const e=s?0:i,t=4*e;let r=f.clippingState||null;l.value=r,r=u(h,o,t,a);for(let i=0;i!==t;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function Wr(e){let t=new WeakMap;function n(e,t){return t===re?e.mapping=ne:t===se&&(e.mapping=ie),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const s=r.mapping;if(s===re||s===se){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new Mr(s.height/2);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}Fr.physical={uniforms:_r([Fr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Wt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ln(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Wt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ln(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ln(1,1,1)},specularColorMap:{value:null}}]),vertexShader:$r.meshphysical_vert,fragmentShader:$r.meshphysical_frag};class jr extends Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Xr=[.125,.215,.35,.446,.526,.582],Yr=20,Kr=new jr,qr=new ln;let Jr=null;const Zr=(1+Math.sqrt(5))/2,Qr=1/Zr,es=[new yn(1,1,1),new yn(-1,1,1),new yn(1,1,-1),new yn(-1,1,-1),new yn(0,Zr,Qr),new yn(0,Zr,-Qr),new yn(Qr,0,Zr),new yn(-Qr,0,Zr),new yn(Zr,Qr,0),new yn(-Zr,Qr,0)];class ts{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Jr=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ss(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=rs(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Jr),e.scissorTest=!1,is(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ne||e.mapping===ie?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Jr=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:pe,minFilter:pe,generateMipmaps:!1,type:Se,format:ke,encoding:bt,depthBuffer:!1},i=ns(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ns(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+Xr.length;for(let o=0;o<s;o++){const s=Math.pow(2,r);n.push(s);let a=1/s;o>e-4?a=Xr[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,g=2,m=1,v=new Float32Array(f*p*d),_=new Float32Array(g*p*d),b=new Float32Array(m*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,f*p*e),_.set(h,g*p*e);const r=[e,e,e,e,e,e];b.set(r,m*p*e)}const y=new qi;y.setAttribute("position",new Fi(v,f)),y.setAttribute("uv",new Fi(_,g)),y.setAttribute("faceIndex",new Fi(b,m)),t.push(y),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(Yr),r=new yn(0,1,0);return new yr({name:"SphericalGaussianBlur",defines:{n:Yr,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}(i,e,t)}return i}_compileMaterial(e){const t=new fr(this._lodPlanes[0],e);this._renderer.compile(t,Kr)}_sceneToCubeUV(e,t,n,i){const r=new Er(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(qr),a.toneMapping=K,a.autoClear=!1;const u=new Pi({name:"PMREM.Background",side:f,depthWrite:!1,depthTest:!1}),h=new fr(new mr,u);let d=!1;const p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(qr),d=!0);for(let f=0;f<6;f++){const t=f%3;0===t?(r.up.set(0,s[f],0),r.lookAt(o[f],0,0)):1===t?(r.up.set(0,0,s[f]),r.lookAt(0,o[f],0)):(r.up.set(0,s[f],0),r.lookAt(0,0,o[f]));const n=this._cubeSize;is(i,t*n,f>2?n:0,n,n),a.setRenderTarget(i),d&&a.render(h,r),a.render(e,r)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===ne||e.mapping===ie;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=ss()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=rs());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new fr(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const o=this._cubeSize;is(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(s,Kr)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=es[(i-1)%es.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new fr(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):Yr;f>Yr&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(Yr));const g=[];let m=0;for(let b=0;b<Yr;++b){const e=b/p,t=Math.exp(-e*e/2);g.push(t),0===b?m+=t:b<f&&(m+=2*t)}for(let b=0;b<g.length;b++)g[b]=g[b]/m;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=g,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const _=this._sizeLods[i];is(t,3*_*(i>v-4?i-v+4:0),4*(this._cubeSize-_),3*_,2*_),a.setRenderTarget(t),a.render(c,Kr)}}function ns(e,t,n){const i=new mn(e,t,n);return i.texture.mapping=oe,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function is(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function rs(){return new yr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function ss(){return new yr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function os(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,o=s===re||s===se,a=s===ne||s===ie;if(o||a){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=t.get(r);return null===n&&(n=new ts(e)),i=o?n.fromEquirectangular(r,i):n.fromCubemap(r,i),t.set(r,i),i.texture}if(t.has(r))return t.get(r).texture;{const s=r.image;if(o&&s&&s.height>0||a&&s&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(s)){null===n&&(n=new ts(e));const s=o?n.fromEquirectangular(r):n.fromCubemap(r);return t.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function as(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ls(e,t,n,i){const r={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const n in a.attributes)t.remove(a.attributes[n]);a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],i=e.index,r=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{const e=r.array;o=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}const a=new(Xt(n)?zi:Ui)(n,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,n.memory.geometries++),t},update:function(e){const n=e.attributes;for(const r in n)t.update(n[r],34962);const i=e.morphAttributes;for(const r in i){const e=i[r];for(let n=0,i=e.length;n<i;n++)t.update(e[n],34962)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return s.get(e)}}}function cs(e,t,n,i){const r=i.isWebGL2;let s,o,a;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(s,i,o,t*a),n.update(i,s,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(r)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](s,l,o,i*a,c),n.update(l,s,c)}}function us(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function hs(e,t){return e[0]-t[0]}function ds(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ps(e,t){let n=1;const i=t.isInterleavedBufferAttribute?t.data.array:t.array;i instanceof Int8Array?n=127:i instanceof Uint8Array?n=255:i instanceof Uint16Array?n=65535:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),e.divideScalar(n)}function fs(e,t,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new gn,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const i=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,r=void 0!==i?i.length:0;let a=s.get(c);if(void 0===a||a.count!==r){let e=function(){v.dispose(),s.delete(c),c.removeEventListener("dispose",e)};void 0!==a&&a.texture.dispose();const n=void 0!==c.morphAttributes.position,i=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,u=c.morphAttributes.position||[],h=c.morphAttributes.normal||[],d=c.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===i&&(p=2),!0===l&&(p=3);let f=c.attributes.position.count*p,g=1;f>t.maxTextureSize&&(g=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const m=new Float32Array(f*g*4*r),v=new vn(m,f,g,r);v.type=Ee,v.needsUpdate=!0;const _=4*p;for(let t=0;t<r;t++){const e=u[t],r=h[t],s=d[t],a=f*g*4*t;for(let t=0;t<e.count;t++){const c=t*_;!0===n&&(o.fromBufferAttribute(e,t),!0===e.normalized&&ps(o,e),m[a+c+0]=o.x,m[a+c+1]=o.y,m[a+c+2]=o.z,m[a+c+3]=0),!0===i&&(o.fromBufferAttribute(r,t),!0===r.normalized&&ps(o,r),m[a+c+4]=o.x,m[a+c+5]=o.y,m[a+c+6]=o.z,m[a+c+7]=0),!0===l&&(o.fromBufferAttribute(s,t),!0===s.normalized&&ps(o,s),m[a+c+8]=o.x,m[a+c+9]=o.y,m[a+c+10]=o.z,m[a+c+11]=4===s.itemSize?o.w:1)}}a={count:r,texture:v,size:new Wt(f,g)},s.set(c,a),c.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",a.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",a.size)}else{const t=void 0===d?0:d.length;let n=i[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];i[c.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=d[e]}n.sort(ds);for(let e=0;e<8;e++)e<t&&n[e][1]?(a[e][0]=n[e][0],a[e][1]=n[e][1]):(a[e][0]=Number.MAX_SAFE_INTEGER,a[e][1]=0);a.sort(hs);const s=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=a[e],n=t[0],i=t[1];n!==Number.MAX_SAFE_INTEGER&&i?(s&&c.getAttribute("morphTarget"+e)!==s[n]&&c.setAttribute("morphTarget"+e,s[n]),o&&c.getAttribute("morphNormal"+e)!==o[n]&&c.setAttribute("morphNormal"+e,o[n]),r[e]=i,l+=i):(s&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),o&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),r[e]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function gs(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){const o=i.render.frame,a=e.geometry,l=t.get(e,a);return r.get(l)!==o&&(t.update(l),r.set(l,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}const ms=new fn,vs=new vn,_s=new _n,bs=new xr,ys=[],Ts=[],Es=new Float32Array(16),Ss=new Float32Array(9),ws=new Float32Array(4);function xs(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=ys[r];if(void 0===s&&(s=new Float32Array(r),ys[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function Ms(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Is(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function Cs(e,t){let n=Ts[t];void 0===n&&(n=new Int32Array(t),Ts[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function ks(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Rs(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ms(n,t))return;e.uniform2fv(this.addr,t),Is(n,t)}}function As(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ms(n,t))return;e.uniform3fv(this.addr,t),Is(n,t)}}function Ls(e,t){const n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ms(n,t))return;e.uniform4fv(this.addr,t),Is(n,t)}}function Os(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Ms(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Is(n,t)}else{if(Ms(n,i))return;ws.set(i),e.uniformMatrix2fv(this.addr,!1,ws),Is(n,i)}}function Ns(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Ms(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Is(n,t)}else{if(Ms(n,i))return;Ss.set(i),e.uniformMatrix3fv(this.addr,!1,Ss),Is(n,i)}}function Ds(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Ms(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Is(n,t)}else{if(Ms(n,i))return;Es.set(i),e.uniformMatrix4fv(this.addr,!1,Es),Is(n,i)}}function Ps(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function $s(e,t){const n=this.cache;Ms(n,t)||(e.uniform2iv(this.addr,t),Is(n,t))}function Bs(e,t){const n=this.cache;Ms(n,t)||(e.uniform3iv(this.addr,t),Is(n,t))}function Fs(e,t){const n=this.cache;Ms(n,t)||(e.uniform4iv(this.addr,t),Is(n,t))}function Us(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function zs(e,t){const n=this.cache;Ms(n,t)||(e.uniform2uiv(this.addr,t),Is(n,t))}function Hs(e,t){const n=this.cache;Ms(n,t)||(e.uniform3uiv(this.addr,t),Is(n,t))}function Gs(e,t){const n=this.cache;Ms(n,t)||(e.uniform4uiv(this.addr,t),Is(n,t))}function Vs(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(t||ms,r)}function Ws(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||_s,r)}function js(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||bs,r)}function Xs(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||vs,r)}function Ys(e,t){e.uniform1fv(this.addr,t)}function Ks(e,t){const n=xs(t,this.size,2);e.uniform2fv(this.addr,n)}function qs(e,t){const n=xs(t,this.size,3);e.uniform3fv(this.addr,n)}function Js(e,t){const n=xs(t,this.size,4);e.uniform4fv(this.addr,n)}function Zs(e,t){const n=xs(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Qs(e,t){const n=xs(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function eo(e,t){const n=xs(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function to(e,t){e.uniform1iv(this.addr,t)}function no(e,t){e.uniform2iv(this.addr,t)}function io(e,t){e.uniform3iv(this.addr,t)}function ro(e,t){e.uniform4iv(this.addr,t)}function so(e,t){e.uniform1uiv(this.addr,t)}function oo(e,t){e.uniform2uiv(this.addr,t)}function ao(e,t){e.uniform3uiv(this.addr,t)}function lo(e,t){e.uniform4uiv(this.addr,t)}function co(e,t,n){const i=t.length,r=Cs(n,i);e.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2D(t[s]||ms,r[s])}function uo(e,t,n){const i=t.length,r=Cs(n,i);e.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture3D(t[s]||_s,r[s])}function ho(e,t,n){const i=t.length,r=Cs(n,i);e.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTextureCube(t[s]||bs,r[s])}function po(e,t,n){const i=t.length,r=Cs(n,i);e.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2DArray(t[s]||vs,r[s])}class fo{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ks;case 35664:return Rs;case 35665:return As;case 35666:return Ls;case 35674:return Os;case 35675:return Ns;case 35676:return Ds;case 5124:case 35670:return Ps;case 35667:case 35671:return $s;case 35668:case 35672:return Bs;case 35669:case 35673:return Fs;case 5125:return Us;case 36294:return zs;case 36295:return Hs;case 36296:return Gs;case 35678:case 36198:case 36298:case 36306:case 35682:return Vs;case 35679:case 36299:case 36307:return Ws;case 35680:case 36300:case 36308:case 36293:return js;case 36289:case 36303:case 36311:case 36292:return Xs}}(t.type)}}class go{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ys;case 35664:return Ks;case 35665:return qs;case 35666:return Js;case 35674:return Zs;case 35675:return Qs;case 35676:return eo;case 5124:case 35670:return to;case 35667:case 35671:return no;case 35668:case 35672:return io;case 35669:case 35673:return ro;case 5125:return so;case 36294:return oo;case 36295:return ao;case 36296:return lo;case 35678:case 36198:case 36298:case 36306:case 35682:return co;case 35679:case 36299:case 36307:return uo;case 35680:case 36300:case 36308:case 36293:return ho;case 36289:case 36303:case 36311:case 36292:return po}}(t.type)}}class mo{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const vo=/(\w+)(\])?(\[|\.)?/g;function _o(e,t){e.seq.push(t),e.map[t.id]=t}function bo(e,t,n){const i=e.name,r=i.length;for(vo.lastIndex=0;;){const s=vo.exec(i),o=vo.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===r){_o(n,void 0===c?new fo(a,e,t):new go(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new mo(a),_o(n,e)),n=e}}}class yo{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);bo(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function To(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}let Eo=0;function So(e,t,n){const i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let o=r;o<s;o++){const e=o+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[o]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function wo(e,t){const n=function(e){switch(e){case bt:return["Linear","( value )"];case yt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function xo(e,t){let n;switch(t){case q:n="Linear";break;case J:n="Reinhard";break;case Z:n="OptimizedCineon";break;case Q:n="ACESFilmic";break;case ee:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Mo(e){return""!==e}function Io(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Co(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ko=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ro(e){return e.replace(ko,Ao)}function Ao(e,t){const n=$r[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ro(n)}const Lo=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Oo=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function No(e){return e.replace(Oo,Po).replace(Lo,Do)}function Do(e,t,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Po(e,t,n,i)}function Po(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function $o(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Bo(e,t,n,i){const r=e.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===u?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===h?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===d&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ne:case ie:t="ENVMAP_TYPE_CUBE";break;case oe:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),p=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===ie&&(t="ENVMAP_MODE_REFRACTION");return t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case j:t="ENVMAP_BLENDING_MULTIPLY";break;case X:t="ENVMAP_BLENDING_MIX";break;case Y:t="ENVMAP_BLENDING_ADD"}return t}(n),g=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),m=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Mo).join("\n")}(n),v=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),_=r.createProgram();let b,y,T=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(b=[v].filter(Mo).join("\n"),b.length>0&&(b+="\n"),y=[m,v].filter(Mo).join("\n"),y.length>0&&(y+="\n")):(b=[$o(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Mo).join("\n"),y=[m,$o(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+p:"",n.envMap?"#define "+f:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==K?"#define TONE_MAPPING":"",n.toneMapping!==K?$r.tonemapping_pars_fragment:"",n.toneMapping!==K?xo("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",$r.encodings_pars_fragment,wo("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Mo).join("\n")),o=Ro(o),o=Io(o,n),o=Co(o,n),a=Ro(a),a=Io(a,n),a=Co(a,n),o=No(o),a=No(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(T="#version 300 es\n",b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,y=["#define varying in",n.glslVersion===Rt?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Rt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const E=T+y+a,S=To(r,35633,T+b+o),w=To(r,35632,E);if(r.attachShader(_,S),r.attachShader(_,w),void 0!==n.index0AttributeName?r.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),e.debug.checkShaderErrors){const e=r.getProgramInfoLog(_).trim(),t=r.getShaderInfoLog(S).trim(),n=r.getShaderInfoLog(w).trim();let i=!0,s=!0;if(!1===r.getProgramParameter(_,35714)){i=!1;const t=So(r,S,"vertex"),n=So(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===n)&&(s=!1);s&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:b},fragmentShader:{log:n,prefix:y}})}let x,M;return r.deleteShader(S),r.deleteShader(w),this.getUniforms=function(){return void 0===x&&(x=new yo(r,_)),x},this.getAttributes=function(){return void 0===M&&(M=function(e,t){const n={},i=e.getProgramParameter(t,35721);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let o=1;35674===i.type&&(o=2),35675===i.type&&(o=3),35676===i.type&&(o=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return n}(r,_)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=Eo++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=w,this}let Fo=0;class Uo{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new zo(e);t.set(e,n)}return t.get(e)}}class zo{constructor(e){this.id=Fo++,this.code=e,this.usedTimes=0}}function Ho(e,t,n,i,r,s,o){const a=new li,l=new Uo,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,a,c,_,b){const y=_.fog,T=b.geometry,E=s.isMeshStandardMaterial?_.environment:null,S=(s.isMeshStandardMaterial?n:t).get(s.envMap||E),w=S&&S.mapping===oe?S.image.height:null,x=m[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));const M=T.morphAttributes.position||T.morphAttributes.normal||T.morphAttributes.color,I=void 0!==M?M.length:0;let C,k,R,A,L=0;if(void 0!==T.morphAttributes.position&&(L=1),void 0!==T.morphAttributes.normal&&(L=2),void 0!==T.morphAttributes.color&&(L=3),x){const e=Fr[x];C=e.vertexShader,k=e.fragmentShader}else C=s.vertexShader,k=s.fragmentShader,l.update(s),R=l.getVertexShaderID(s),A=l.getFragmentShaderID(s);const O=e.getRenderTarget(),N=s.alphaTest>0,D=s.clearcoat>0,P=s.iridescence>0;return{isWebGL2:u,shaderID:x,shaderName:s.type,vertexShader:C,fragmentShader:k,defines:s.defines,customVertexShaderID:R,customFragmentShaderID:A,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,instancing:!0===b.isInstancedMesh,instancingColor:!0===b.isInstancedMesh&&null!==b.instanceColor,supportsVertexTextures:d,outputEncoding:null===O?e.outputEncoding:!0===O.isXRRenderTarget?O.texture.encoding:bt,map:!!s.map,matcap:!!s.matcap,envMap:!!S,envMapMode:S&&S.mapping,envMapCubeUVHeight:w,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:s.normalMapType===wt,tangentSpaceNormalMap:s.normalMapType===St,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===yt,clearcoat:D,clearcoatMap:D&&!!s.clearcoatMap,clearcoatRoughnessMap:D&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:D&&!!s.clearcoatNormalMap,iridescence:P,iridescenceMap:P&&!!s.iridescenceMap,iridescenceThicknessMap:P&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&s.blending===v,alphaMap:!!s.alphaMap,alphaTest:N,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!T.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!T.attributes.color&&4===T.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!y,useFog:!0===s.fog,fogExp2:y&&y.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===b.isSkinnedMesh,morphTargets:void 0!==T.morphAttributes.position,morphNormals:void 0!==T.morphAttributes.normal,morphColors:void 0!==T.morphAttributes.color,morphTargetsCount:I,morphTextureStride:L,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:K,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===g,flipSided:s.side===f,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0),t.supportsVertexTextures&&a.enable(1),t.instancing&&a.enable(2),t.instancingColor&&a.enable(3),t.map&&a.enable(4),t.matcap&&a.enable(5),t.envMap&&a.enable(6),t.lightMap&&a.enable(7),t.aoMap&&a.enable(8),t.emissiveMap&&a.enable(9),t.bumpMap&&a.enable(10),t.normalMap&&a.enable(11),t.objectSpaceNormalMap&&a.enable(12),t.tangentSpaceNormalMap&&a.enable(13),t.clearcoat&&a.enable(14),t.clearcoatMap&&a.enable(15),t.clearcoatRoughnessMap&&a.enable(16),t.clearcoatNormalMap&&a.enable(17),t.iridescence&&a.enable(18),t.iridescenceMap&&a.enable(19),t.iridescenceThicknessMap&&a.enable(20),t.displacementMap&&a.enable(21),t.specularMap&&a.enable(22),t.roughnessMap&&a.enable(23),t.metalnessMap&&a.enable(24),t.gradientMap&&a.enable(25),t.alphaMap&&a.enable(26),t.alphaTest&&a.enable(27),t.vertexColors&&a.enable(28),t.vertexAlphas&&a.enable(29),t.vertexUvs&&a.enable(30),t.vertexTangents&&a.enable(31),t.uvsVertexOnly&&a.enable(32),t.fog&&a.enable(33),e.push(a.mask),a.disableAll(),t.useFog&&a.enable(0),t.flatShading&&a.enable(1),t.logarithmicDepthBuffer&&a.enable(2),t.skinning&&a.enable(3),t.morphTargets&&a.enable(4),t.morphNormals&&a.enable(5),t.morphColors&&a.enable(6),t.premultipliedAlpha&&a.enable(7),t.shadowMapEnabled&&a.enable(8),t.physicallyCorrectLights&&a.enable(9),t.doubleSided&&a.enable(10),t.flipSided&&a.enable(11),t.useDepthPacking&&a.enable(12),t.dithering&&a.enable(13),t.specularIntensityMap&&a.enable(14),t.specularColorMap&&a.enable(15),t.transmission&&a.enable(16),t.transmissionMap&&a.enable(17),t.thicknessMap&&a.enable(18),t.sheen&&a.enable(19),t.sheenColorMap&&a.enable(20),t.sheenRoughnessMap&&a.enable(21),t.decodeVideoTexture&&a.enable(22),t.opaque&&a.enable(23),e.push(a.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=m[e.type];let n;if(t){const e=Fr[t];n=br.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=c.length;e<r;e++){const t=c[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new Bo(e,n,t,s),c.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Go(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function Vo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Wo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function jo(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,o,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.push(u):!0===o.transparent?r.push(u):n.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Vo),i.length>1&&i.sort(t||Wo),r.length>1&&r.sort(t||Wo)}}}function Xo(){let e=new WeakMap;return{get:function(t,n){let i;return!1===e.has(t)?(i=new jo,e.set(t,[i])):n>=e.get(t).length?(i=new jo,e.get(t).push(i)):i=e.get(t)[n],i},dispose:function(){e=new WeakMap}}}function Yo(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new yn,color:new ln};break;case"SpotLight":n={position:new yn,direction:new yn,color:new ln,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new yn,color:new ln,distance:0,decay:0};break;case"HemisphereLight":n={direction:new yn,skyColor:new ln,groundColor:new ln};break;case"RectAreaLight":n={color:new ln,position:new yn,halfWidth:new yn,halfHeight:new yn}}return e[t.id]=n,n}}}let Ko=0;function qo(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Jo(e,t){const n=new Yo,i=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new yn);const s=new yn,o=new Jn,a=new Jn;return{setup:function(s,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,g=0,m=0,v=0;s.sort(qo);const _=!0!==o?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],o=t.color,b=t.intensity,y=t.distance,T=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*b*_,l+=o.g*b*_,c+=o.b*b*_;else if(t.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[u]=n,r.directionalShadowMap[u]=T,r.directionalShadowMatrix[u]=t.shadow.matrix,g++}r.directional[u]=e,u++}else if(t.isSpotLight){const e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(b*_),e.distance=y,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.spotShadow[d]=n,r.spotShadowMap[d]=T,r.spotShadowMatrix[d]=t.shadow.matrix,v++}r.spot[d]=e,d++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(o).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[p]=e,p++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=T,r.pointShadowMatrix[h]=t.shadow.matrix,m++}r.point[h]=e,h++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(b*_),e.groundColor.copy(t.groundColor).multiplyScalar(b*_),r.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Br.LTC_FLOAT_1,r.rectAreaLTC2=Br.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Br.LTC_HALF_1,r.rectAreaLTC2=Br.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=a,r.ambient[1]=l,r.ambient[2]=c;const b=r.hash;(b.directionalLength!==u||b.pointLength!==h||b.spotLength!==d||b.rectAreaLength!==p||b.hemiLength!==f||b.numDirectionalShadows!==g||b.numPointShadows!==m||b.numSpotShadows!==v)&&(r.directional.length=u,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=f,r.directionalShadow.length=g,r.directionalShadowMap.length=g,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=g,r.pointShadowMatrix.length=m,r.spotShadowMatrix.length=v,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=p,b.hemiLength=f,b.numDirectionalShadows=g,b.numPointShadows=m,b.numSpotShadows=v,r.version=Ko++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){const t=e[d];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),a.identity(),o.copy(t.matrixWorld),o.premultiply(h),a.extractRotation(o),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=r.point[i];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),i++}else if(t.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:r}}function Zo(e,t){const n=new Jo(e,t),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(e){n.setup(i,e)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){r.push(e)}}}function Qo(e,t){let n=new WeakMap;return{get:function(i){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(i)?(r=new Zo(e,t),n.set(i,[r])):s>=n.get(i).length?(r=new Zo(e,t),n.get(i).push(r)):r=n.get(i)[s],r},dispose:function(){n=new WeakMap}}}class ea extends Di{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Tt,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ta extends Di{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new yn,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const na="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",ia="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function ra(e,t,n){let i=new Or;const r=new Wt,s=new Wt,o=new gn,a=new ea({depthPacking:Et}),l=new ta,c={},h=n.maxTextureSize,v={0:f,1:p,2:g},_=new yr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Wt},radius:{value:4}},vertexShader:na,fragmentShader:ia}),b=_.clone();b.defines.HORIZONTAL_PASS=1;const y=new qi;y.setAttribute("position",new Fi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new fr(y,_),E=this;function S(n,i){const s=t.update(T);_.defines.VSM_SAMPLES!==n.blurSamples&&(_.defines.VSM_SAMPLES=n.blurSamples,b.defines.VSM_SAMPLES=n.blurSamples,_.needsUpdate=!0,b.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new mn(r.x,r.y)),_.uniforms.shadow_pass.value=n.map.texture,_.uniforms.resolution.value=n.mapSize,_.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,_,T,null),b.uniforms.shadow_pass.value=n.mapPass.texture,b.uniforms.resolution.value=n.mapSize,b.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,b,T,null)}function w(t,n,i,r,s,o){let u=null;const h=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(u=void 0!==h?h:!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const e=u.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=u.clone(),i[t]=r),u=r}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=o===d?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:v[n.side],u.alphaMap=n.alphaMap,u.alphaTest=n.alphaTest,u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.displacementMap=n.displacementMap,u.displacementScale=n.displacementScale,u.displacementBias=n.displacementBias,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=r,u.farDistance=s),u}function x(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===d)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),r=n.material;if(Array.isArray(r)){const t=i.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=r[c.materialIndex];if(u&&u.visible){const t=w(n,u,o,s.near,s.far,a);e.renderBufferDirect(s,null,i,t,n,c)}}}else if(r.visible){const t=w(n,r,o,s.near,s.far,a);e.renderBufferDirect(s,null,i,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)x(l[e],r,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=u,this.render=function(t,n,a){if(!1===E.enabled||!1===E.autoUpdate&&!1===E.needsUpdate||0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),p=e.state;p.setBlending(m),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(let f=0,g=t.length;f<g;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const u=c.getFrameExtents();if(r.multiply(u),s.copy(c.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/u.x),r.x=s.x*u.x,c.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/u.y),r.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map){const e=this.type!==d?{minFilter:ue,magFilter:ue}:{};c.map=new mn(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const g=c.getViewportCount();for(let e=0;e<g;e++){const t=c.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),p.viewport(o),c.updateMatrices(l,e),i=c.getFrustum(),x(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===d&&S(c,a),c.needsUpdate=!1}E.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function sa(e,t,n){const i=n.isWebGL2;const r=new function(){let t=!1;const n=new gn;let i=null;const r=new gn(0,0,0,0);return{setMask:function(n){i!==n&&!t&&(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,o,a){!0===a&&(t*=o,i*=o,s*=o),n.set(t,i,s,o),!1===r.equals(n)&&(e.clearColor(t,i,s,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(e){e?Te(2929):Ee(2929)},setMask:function(i){n!==i&&!t&&(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case B:e.depthFunc(512);break;case F:e.depthFunc(519);break;case U:e.depthFunc(513);break;case z:e.depthFunc(515);break;case H:e.depthFunc(514);break;case G:e.depthFunc(518);break;case V:e.depthFunc(516);break;case W:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},o=new function(){let t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?Te(2960):Ee(2960))},setMask:function(i){n!==i&&!t&&(e.stencilMask(i),n=i)},setFunc:function(t,n,o){(i!==t||r!==n||s!==o)&&(e.stencilFunc(t,n,o),i=t,r=n,s=o)},setOp:function(t,n,i){(o!==t||a!==n||l!==i)&&(e.stencilOp(t,n,i),o=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}},u=new WeakMap,h=new WeakMap;let d={},p={},j=new WeakMap,X=[],Y=null,K=!1,q=null,J=null,Z=null,Q=null,ee=null,te=null,ne=null,ie=!1,re=null,se=null,oe=null,ae=null,le=null;const ce=e.getParameter(35661);let ue=!1,he=0;const de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(he=parseFloat(/^WebGL (\d)/.exec(de)[1]),ue=he>=1):-1!==de.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),ue=he>=2);let pe=null,fe={};const ge=e.getParameter(3088),me=e.getParameter(2978),ve=(new gn).fromArray(ge),_e=(new gn).fromArray(me);function be(t,n,i){const r=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let o=0;o<i;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,r);return s}const ye={};function Te(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function Ee(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}ye[3553]=be(3553,3553,1),ye[34067]=be(34067,34069,6),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),Te(2929),s.setFunc(z),Me(!1),Ie(l),Te(2884),xe(m);const Se={[E]:32774,[S]:32778,[w]:32779};if(i)Se[x]=32775,Se[M]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(Se[x]=e.MIN_EXT,Se[M]=e.MAX_EXT)}const we={[I]:0,[C]:1,[k]:768,[A]:770,[$]:776,[D]:774,[O]:772,[R]:769,[L]:771,[P]:775,[N]:773};function xe(t,n,i,r,s,o,a,l){if(t!==m){if(!1===K&&(Te(3042),K=!0),t===T)s=s||n,o=o||i,a=a||r,(n!==J||s!==ee)&&(e.blendEquationSeparate(Se[n],Se[s]),J=n,ee=s),(i!==Z||r!==Q||o!==te||a!==ne)&&(e.blendFuncSeparate(we[i],we[r],we[o],we[a]),Z=i,Q=r,te=o,ne=a),q=t,ie=null;else if(t!==q||l!==ie){if((J!==E||ee!==E)&&(e.blendEquation(32774),J=E,ee=E),l)switch(t){case v:e.blendFuncSeparate(1,771,1,771);break;case _:e.blendFunc(1,1);break;case b:e.blendFuncSeparate(0,769,0,1);break;case y:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case v:e.blendFuncSeparate(770,771,1,771);break;case _:e.blendFunc(770,1);break;case b:e.blendFuncSeparate(0,769,0,1);break;case y:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}Z=null,Q=null,te=null,ne=null,q=t,ie=l}}else!0===K&&(Ee(3042),K=!1)}function Me(t){re!==t&&(t?e.frontFace(2304):e.frontFace(2305),re=t)}function Ie(t){t!==a?(Te(2884),t!==se&&(t===l?e.cullFace(1029):t===c?e.cullFace(1028):e.cullFace(1032))):Ee(2884),se=t}function Ce(t,n,i){t?(Te(32823),(ae!==n||le!==i)&&(e.polygonOffset(n,i),ae=n,le=i)):Ee(32823)}function ke(t){void 0===t&&(t=33984+ce-1),pe!==t&&(e.activeTexture(t),pe=t)}return{buffers:{color:r,depth:s,stencil:o},enable:Te,disable:Ee,bindFramebuffer:function(t,n){return p[t]!==n&&(e.bindFramebuffer(t,n),p[t]=n,i&&(36009===t&&(p[36160]=n),36160===t&&(p[36009]=n)),!0)},drawBuffers:function(i,r){let s=X,o=!1;if(i)if(s=j.get(r),void 0===s&&(s=[],j.set(r,s)),i.isWebGLMultipleRenderTargets){const e=i.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,n=e.length;t<n;t++)s[t]=36064+t;s.length=e.length,o=!0}}else 36064!==s[0]&&(s[0]=36064,o=!0);else 1029!==s[0]&&(s[0]=1029,o=!0);o&&(n.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return Y!==t&&(e.useProgram(t),Y=t,!0)},setBlending:xe,setMaterial:function(e,t){e.side===g?Ee(2884):Te(2884);let n=e.side===f;t&&(n=!n),Me(n),e.blending===v&&!1===e.transparent?xe(m):xe(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),r.setMask(e.colorWrite);const i=e.stencilWrite;o.setTest(i),i&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ce(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?Te(32926):Ee(32926)},setFlipSided:Me,setCullFace:Ie,setLineWidth:function(t){t!==oe&&(ue&&e.lineWidth(t),oe=t)},setPolygonOffset:Ce,setScissorTest:function(e){e?Te(3089):Ee(3089)},activeTexture:ke,bindTexture:function(t,n){null===pe&&ke();let i=fe[pe];void 0===i&&(i={type:void 0,texture:void 0},fe[pe]=i),(i.type!==t||i.texture!==n)&&(e.bindTexture(t,n||ye[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=fe[pe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let i=h.get(n);void 0===i&&(i=new WeakMap,h.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=h.get(n).get(t);u.get(t)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),u.set(t,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===ve.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ve.copy(t))},viewport:function(t){!1===_e.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),_e.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},pe=null,fe={},p={},j=new WeakMap,X=[],Y=null,K=!1,q=null,J=null,Z=null,Q=null,ee=null,te=null,ne=null,ie=!1,re=null,se=null,oe=null,ae=null,le=null,ve.set(0,0,e.canvas.width,e.canvas.height),_e.set(0,0,e.canvas.width,e.canvas.height),r.reset(),s.reset(),o.reset()}}}function oa(e,t,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let g;const m=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(e,t){return v?new OffscreenCanvas(e,t):qt("canvas")}function b(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=t?Gt:Math.floor,s=i(r*e.width),o=i(r*e.height);void 0===g&&(g=_(s,o));const a=n?_(s,o):g;return a.width=s,a.height=o,a.getContext("2d").drawImage(e,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+o+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function y(e){return zt(e.width)&&zt(e.height)}function T(e,t){return e.generateMipmaps&&t&&e.minFilter!==ue&&e.minFilter!==pe}function E(t){e.generateMipmap(t)}function S(n,i,r,s){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===a)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=i;return 6403===i&&(5126===r&&(l=33326),5131===r&&(l=33325),5121===r&&(l=33321)),33319===i&&(5126===r&&(l=33328),5131===r&&(l=33327),5121===r&&(l=33323)),6408===i&&(5126===r&&(l=34836),5131===r&&(l=34842),5121===r&&(l=s===yt&&!1===o?35907:32856),32819===r&&(l=32854),32820===r&&(l=32855)),(33325===l||33326===l||33327===l||33328===l||34842===l||34836===l)&&t.get("EXT_color_buffer_float"),l}function w(e,t,n){return!0===T(e,n)||e.isFramebufferTexture&&e.minFilter!==ue&&e.minFilter!==pe?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function x(e){return e===ue||e===he||e===de?9728:9729}function M(e){const t=e.target;t.removeEventListener("dispose",M),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=m.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&C(e),0===Object.keys(r).length&&m.delete(n)}i.remove(e)}(t),t.isVideoTexture&&f.delete(t)}function I(t){const n=t.target;n.removeEventListener("dispose",I),function(t){const n=t.texture,r=i.get(t),s=i.get(n);if(void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++)e.deleteFramebuffer(r.__webglFramebuffer[i]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[i]);else{if(e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let a=0,l=n.length;a<l;a++){const t=i.get(n[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),i.remove(n[a])}i.remove(n),i.remove(t)}(n)}function C(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete m.get(r)[n.__cacheKey],o.memory.textures--}let k=0;function R(e,t){const r=i.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&r.__version!==e.version){const n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void D(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,r.__webglTexture)}const A={[ae]:10497,[le]:33071,[ce]:33648},L={[ue]:9728,[he]:9984,[de]:9986,[pe]:9729,[fe]:9985,[ge]:9987};function O(n,s,o){if(o?(e.texParameteri(n,10242,A[s.wrapS]),e.texParameteri(n,10243,A[s.wrapT]),(32879===n||35866===n)&&e.texParameteri(n,32882,A[s.wrapR]),e.texParameteri(n,10240,L[s.magFilter]),e.texParameteri(n,10241,L[s.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),(32879===n||35866===n)&&e.texParameteri(n,32882,33071),(s.wrapS!==le||s.wrapT!==le)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,x(s.magFilter)),e.texParameteri(n,10241,x(s.minFilter)),s.minFilter!==ue&&s.minFilter!==pe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(s.type===Ee&&!1===t.has("OES_texture_float_linear")||!1===a&&s.type===Se&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function N(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",M));const r=n.source;let s=m.get(r);void 0===s&&(s={},m.set(r,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),s[a].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&C(n)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return i}function D(t,i,r){let o=3553;i.isDataArrayTexture&&(o=35866),i.isData3DTexture&&(o=32879);const l=N(t,i),c=i.source;if(n.activeTexture(33984+r),n.bindTexture(o,t.__webglTexture),c.version!==c.__currentVersion||!0===l){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const t=function(e){return!a&&(e.wrapS!==le||e.wrapT!==le||e.minFilter!==ue&&e.minFilter!==pe)}(i)&&!1===y(i.image);let r=b(i.image,t,!1,u);r=z(i,r);const h=y(r)||a,d=s.convert(i.format,i.encoding);let p,f=s.convert(i.type),g=S(i.internalFormat,d,f,i.encoding,i.isVideoTexture);O(o,i,h);const m=i.mipmaps,v=a&&!0!==i.isVideoTexture,_=void 0===c.__currentVersion||!0===l,x=w(i,r,h);if(i.isDepthTexture)g=6402,a?g=i.type===Ee?36012:i.type===Te?33190:i.type===Me?35056:33189:i.type===Ee&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Le&&6402===g&&i.type!==be&&i.type!==Te&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Te,f=s.convert(i.type)),i.format===Oe&&6402===g&&(g=34041,i.type!==Me&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Me,f=s.convert(i.type))),_&&(v?n.texStorage2D(3553,1,g,r.width,r.height):n.texImage2D(3553,0,g,r.width,r.height,0,d,f,null));else if(i.isDataTexture)if(m.length>0&&h){v&&_&&n.texStorage2D(3553,x,g,m[0].width,m[0].height);for(let e=0,t=m.length;e<t;e++)p=m[e],v?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,g,p.width,p.height,0,d,f,p.data);i.generateMipmaps=!1}else v?(_&&n.texStorage2D(3553,x,g,r.width,r.height),n.texSubImage2D(3553,0,0,0,r.width,r.height,d,f,r.data)):n.texImage2D(3553,0,g,r.width,r.height,0,d,f,r.data);else if(i.isCompressedTexture){v&&_&&n.texStorage2D(3553,x,g,m[0].width,m[0].height);for(let e=0,t=m.length;e<t;e++)p=m[e],i.format!==ke?null!==d?v?n.compressedTexSubImage2D(3553,e,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,e,g,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,e,g,p.width,p.height,0,d,f,p.data)}else if(i.isDataArrayTexture)v?(_&&n.texStorage3D(35866,x,g,r.width,r.height,r.depth),n.texSubImage3D(35866,0,0,0,0,r.width,r.height,r.depth,d,f,r.data)):n.texImage3D(35866,0,g,r.width,r.height,r.depth,0,d,f,r.data);else if(i.isData3DTexture)v?(_&&n.texStorage3D(32879,x,g,r.width,r.height,r.depth),n.texSubImage3D(32879,0,0,0,0,r.width,r.height,r.depth,d,f,r.data)):n.texImage3D(32879,0,g,r.width,r.height,r.depth,0,d,f,r.data);else if(i.isFramebufferTexture){if(_)if(v)n.texStorage2D(3553,x,g,r.width,r.height);else{let e=r.width,t=r.height;for(let i=0;i<x;i++)n.texImage2D(3553,i,g,e,t,0,d,f,null),e>>=1,t>>=1}}else if(m.length>0&&h){v&&_&&n.texStorage2D(3553,x,g,m[0].width,m[0].height);for(let e=0,t=m.length;e<t;e++)p=m[e],v?n.texSubImage2D(3553,e,0,0,d,f,p):n.texImage2D(3553,e,g,d,f,p);i.generateMipmaps=!1}else v?(_&&n.texStorage2D(3553,x,g,r.width,r.height),n.texSubImage2D(3553,0,0,0,d,f,r)):n.texImage2D(3553,0,g,d,f,r);T(i,h)&&E(o),c.__currentVersion=c.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function P(t,r,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),h=S(o.internalFormat,c,u,o.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,h,r.width,r.height,0,c,u,null)),n.bindFramebuffer(36160,t),U(r)?d.framebufferTexture2DMultisampleEXT(36160,a,l,i.get(o).__webglTexture,0,F(r)):e.framebufferTexture2D(36160,a,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function $(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||U(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===Ee?r=36012:t.type===Te&&(r=33190));const i=F(n);U(n)?d.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):e.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else e.renderbufferStorage(36161,r,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){const r=F(n);i&&!1===U(n)?e.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):U(n)?d.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<t.length;r++){const o=t[r],a=s.convert(o.format,o.encoding),l=s.convert(o.type),c=S(o.internalFormat,a,l,o.encoding),u=F(n);i&&!1===U(n)?e.renderbufferStorageMultisample(36161,u,c,n.width,n.height):U(n)?d.renderbufferStorageMultisampleEXT(36161,u,c,n.width,n.height):e.renderbufferStorage(36161,c,n.width,n.height)}}e.bindRenderbuffer(36161,null)}function B(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(r.depthTexture).__webglTexture||r.depthTexture.image.width!==r.width||r.depthTexture.image.height!==r.height)&&(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),R(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture,o=F(r);if(r.depthTexture.format===Le)U(r)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,o):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(r.depthTexture.format!==Oe)throw new Error("Unknown depthTexture format");U(r)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,o):e.framebufferTexture2D(36160,33306,3553,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=e.createRenderbuffer(),$(r.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),$(r.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function F(e){return Math.min(h,e.samples)}function U(e){const n=i.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function z(e,n){const i=e.encoding,r=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===At||i!==bt&&(i===yt?!1===a?!0===t.has("EXT_sRGB")&&r===ke?(e.format=At,e.minFilter=pe,e.generateMipmaps=!1):n=un.sRGBToLinear(n):(r!==ke||s!==me)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}this.allocateTextureUnit=function(){const e=k;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),k+=1,e},this.resetTextureUnits=function(){k=0},this.setTexture2D=R,this.setTexture2DArray=function(e,t){const r=i.get(e);e.version>0&&r.__version!==e.version?D(r,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(e,t){const r=i.get(e);e.version>0&&r.__version!==e.version?D(r,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=function(t,r){const o=i.get(t);t.version>0&&o.__version!==t.version?function(t,i,r){if(6!==i.image.length)return;const o=N(t,i),l=i.source;if(n.activeTexture(33984+r),n.bindTexture(34067,t.__webglTexture),l.version!==l.__currentVersion||!0===o){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const t=i.isCompressedTexture||i.image[0].isCompressedTexture,r=i.image[0]&&i.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=t||r?r?i.image[e].image:i.image[e]:b(i.image[e],!1,!0,c),u[e]=z(i,u[e]);const h=u[0],d=y(h)||a,p=s.convert(i.format,i.encoding),f=s.convert(i.type),g=S(i.internalFormat,p,f,i.encoding),m=a&&!0!==i.isVideoTexture,v=void 0===l.__currentVersion||!0===o;let _,x=w(i,h,d);if(O(34067,i,d),t){m&&v&&n.texStorage2D(34067,x,g,h.width,h.height);for(let e=0;e<6;e++){_=u[e].mipmaps;for(let t=0;t<_.length;t++){const r=_[t];i.format!==ke?null!==p?m?n.compressedTexSubImage2D(34069+e,t,0,0,r.width,r.height,p,r.data):n.compressedTexImage2D(34069+e,t,g,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m?n.texSubImage2D(34069+e,t,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+e,t,g,r.width,r.height,0,p,f,r.data)}}}else{_=i.mipmaps,m&&v&&(_.length>0&&x++,n.texStorage2D(34067,x,g,u[0].width,u[0].height));for(let e=0;e<6;e++)if(r){m?n.texSubImage2D(34069+e,0,0,0,u[e].width,u[e].height,p,f,u[e].data):n.texImage2D(34069+e,0,g,u[e].width,u[e].height,0,p,f,u[e].data);for(let t=0;t<_.length;t++){const i=_[t].image[e].image;m?n.texSubImage2D(34069+e,t+1,0,0,i.width,i.height,p,f,i.data):n.texImage2D(34069+e,t+1,g,i.width,i.height,0,p,f,i.data)}}else{m?n.texSubImage2D(34069+e,0,0,0,p,f,u[e]):n.texImage2D(34069+e,0,g,p,f,u[e]);for(let t=0;t<_.length;t++){const i=_[t];m?n.texSubImage2D(34069+e,t+1,0,0,p,f,i.image[e]):n.texImage2D(34069+e,t+1,g,p,f,i.image[e])}}}T(i,d)&&E(34067),l.__currentVersion=l.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,r):(n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture))},this.rebindTextures=function(e,t,n){const r=i.get(e);void 0!==t&&P(r.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&B(e)},this.setupRenderTarget=function(t){const l=t.texture,c=i.get(t),u=i.get(l);t.addEventListener("dispose",I),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=y(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d)if(r.drawBuffers){const n=t.texture;for(let t=0,r=n.length;t<r;t++){const r=i.get(n[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&t.samples>0&&!1===U(t)){const i=d?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){const r=i[n];c.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[n]);const o=s.convert(r.format,r.encoding),a=s.convert(r.type),l=S(r.internalFormat,o,a,r.encoding),u=F(t);e.renderbufferStorageMultisample(36161,u,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+n,36161,c.__webglColorRenderbuffer[n])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),$(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}}if(h){n.bindTexture(34067,u.__webglTexture),O(34067,l,p);for(let e=0;e<6;e++)P(c.__webglFramebuffer[e],t,l,36064,34069+e);T(l,p)&&E(34067),n.unbindTexture()}else if(d){const e=t.texture;for(let r=0,s=e.length;r<s;r++){const s=e[r],o=i.get(s);n.bindTexture(3553,o.__webglTexture),O(3553,s,p),P(c.__webglFramebuffer,t,s,36064+r,3553),T(s,p)&&E(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,u.__webglTexture),O(e,l,p),P(c.__webglFramebuffer,t,l,36064,e),T(l,p)&&E(e),n.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(e){const t=y(e)||a,r=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,o=r.length;s<o;s++){const o=r[s];if(T(o,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,r=i.get(o).__webglTexture;n.bindTexture(t,r),E(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===U(t)){const r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,o=t.height;let a=16384;const l=[],c=t.stencilBuffer?33306:36096,u=i.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<r.length;t++)n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);n.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,u.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(36064+n),t.depthBuffer&&l.push(c);const d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),h){const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,9728),p&&e.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let t=0;t<r.length;t++){n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,s,0)}n.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=P,this.useMultisampledRTT=U}function aa(e,t,n){const i=n.isWebGL2;return{convert:function(n){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n===me)return 5121;if(n===we)return 32819;if(n===xe)return 32820;if(n===ve)return 5120;if(n===_e)return 5122;if(n===be)return 5123;if(n===ye)return 5124;if(n===Te)return 5125;if(n===Ee)return 5126;if(n===Se)return i?5131:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(n===Ie)return 6406;if(n===ke)return 6408;if(n===Re)return 6409;if(n===Ae)return 6410;if(n===Le)return 6402;if(n===Oe)return 34041;if(n===Ne)return 6403;if(n===Ce)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===At)return r=t.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(n===De)return 36244;if(n===Pe)return 33319;if(n===$e)return 33320;if(n===Be)return 36249;if(n===Fe||n===Ue||n===ze||n===He)if(s===yt){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===Fe)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ue)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ze)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===He)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===Fe)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ue)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ze)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===He)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Ge||n===Ve||n===We||n===je){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===Ge)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Ve)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===We)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===je)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Xe)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===Ye||n===Ke){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===Ye)return s===yt?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===Ke)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===qe||n===Je||n===Ze||n===Qe||n===et||n===tt||n===nt||n===it||n===rt||n===st||n===ot||n===at||n===lt||n===ct){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===qe)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Je)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ze)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Qe)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===et)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===tt)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===nt)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===it)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===rt)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===st)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ot)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===at)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===lt)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ct)return s===yt?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===ut){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===ut)return s===yt?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===Me?i?34042:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}class la extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}}class ca extends Ei{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ua={type:"move"};class ha{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ca,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ca,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new yn,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new yn),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ca,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new yn,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new yn),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n);if(void 0===l.joints[s.jointName]){const e=new ca;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[s.jointName]=e,l.add(e)}const i=l.joints[s.jointName];null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(ua)))}return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}}class da extends fn{constructor(e,t,n,i,r,s,o,a,l,c){if((c=void 0!==c?c:Le)!==Le&&c!==Oe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Le&&(n=Te),void 0===n&&c===Oe&&(n=Me),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:ue,this.minFilter=void 0!==a?a:ue,this.flipY=!1,this.generateMipmaps=!1}}class pa extends Lt{constructor(e,t){super();const n=this;let i=null,r=1,s=null,o="local-floor",a=null,l=null,c=null,u=null,h=null,d=null;const p=t.getContextAttributes();let f=null,g=null;const m=[],v=[],_=new Er;_.layers.enable(1),_.viewport=new gn;const b=new Er;b.layers.enable(2),b.viewport=new gn;const y=[_,b],T=new la;T.layers.enable(1),T.layers.enable(2);let E=null,S=null;function w(e){const t=v.indexOf(e.inputSource);if(-1===t)return;const n=m[t];void 0!==n&&n.dispatchEvent({type:e.type,data:e.inputSource})}function x(){i.removeEventListener("select",w),i.removeEventListener("selectstart",w),i.removeEventListener("selectend",w),i.removeEventListener("squeeze",w),i.removeEventListener("squeezestart",w),i.removeEventListener("squeezeend",w),i.removeEventListener("end",x),i.removeEventListener("inputsourceschange",M);for(let e=0;e<m.length;e++){const t=v[e];null!==t&&(v[e]=null,m[e].disconnect(t))}E=null,S=null,e.setRenderTarget(f),h=null,u=null,c=null,i=null,g=null,A.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function M(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=v.indexOf(n);i>=0&&(v[i]=null,m[i].dispatchEvent({type:"disconnected",data:n}))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=v.indexOf(n);if(-1===i){for(let e=0;e<m.length;e++){if(e>=v.length){v.push(n),i=e;break}if(null===v[e]){v[e]=n,i=e;break}}if(-1===i)break}const r=m[i];r&&r.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=m[e];return void 0===t&&(t=new ha,m[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=m[e];return void 0===t&&(t=new ha,m[e]=t),t.getGripSpace()},this.getHand=function(e){let t=m[e];return void 0===t&&(t=new ha,m[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a||s},this.setReferenceSpace=function(e){a=e},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return i},this.setSession=async function(l){if(i=l,null!==i){if(f=e.getRenderTarget(),i.addEventListener("select",w),i.addEventListener("selectstart",w),i.addEventListener("selectend",w),i.addEventListener("squeeze",w),i.addEventListener("squeezestart",w),i.addEventListener("squeezeend",w),i.addEventListener("end",x),i.addEventListener("inputsourceschange",M),!0!==p.xrCompatible&&await t.makeXRCompatible(),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==i.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:h}),g=new mn(h.framebufferWidth,h.framebufferHeight,{format:ke,type:me,encoding:e.outputEncoding})}else{let n=null,s=null,o=null;p.depth&&(o=p.stencil?35056:33190,n=p.stencil?Oe:Le,s=p.stencil?Me:Te);const a={colorFormat:32856,depthFormat:o,scaleFactor:r};c=new XRWebGLBinding(i,t),u=c.createProjectionLayer(a),i.updateRenderState({layers:[u]}),g=new mn(u.textureWidth,u.textureHeight,{format:ke,type:me,depthTexture:new da(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});e.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),a=null,s=await i.requestReferenceSpace(o),A.setContext(i),A.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const I=new yn,C=new yn;function k(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;T.near=b.near=_.near=e.near,T.far=b.far=_.far=e.far,(E!==T.near||S!==T.far)&&(i.updateRenderState({depthNear:T.near,depthFar:T.far}),E=T.near,S=T.far);const t=e.parent,n=T.cameras;k(T,t);for(let i=0;i<n.length;i++)k(n[i],t);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),e.position.copy(T.position),e.quaternion.copy(T.quaternion),e.scale.copy(T.scale),e.matrix.copy(T.matrix),e.matrixWorld.copy(T.matrixWorld);const r=e.children;for(let i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(!0);2===n.length?function(e,t,n){I.setFromMatrixPosition(t.matrixWorld),C.setFromMatrixPosition(n.matrixWorld);const i=I.distanceTo(C),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,f=i/(-u+h),g=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(g),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const m=o+f,v=a+f,_=d-g,b=p+(i-g),y=l*a/v*m,T=c*a/v*m;e.projectionMatrix.makePerspective(_,b,y,T,m,v)}(T,_,b):T.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(e){null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let R=null;const A=new Nr;A.setAnimationLoop((function(t,n){if(l=n.getViewerPose(a||s),d=n,null!==l){const t=l.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const r=t[i];let s=null;if(null!==h)s=h.getViewport(r);else{const t=c.getViewSubImage(u,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(g,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let o=y[i];void 0===o&&(o=new Er,o.layers.enable(i),o.viewport=new gn,y[i]=o),o.matrix.fromArray(r.transform.matrix),o.projectionMatrix.fromArray(r.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&T.matrix.copy(o.matrix),!0===n&&T.cameras.push(o)}}for(let e=0;e<m.length;e++){const t=v[e],i=m[e];null!==t&&void 0!==i&&i.update(t,n,a||s)}R&&R(t,n),d=null})),this.setAnimationLoop=function(e){R=e},this.dispose=function(){}}}function fa(e,t){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===f&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===f&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const r=t.get(i).envMap;if(r&&(n.envMap.value=r,n.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*t}let s,o;i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?s=i.map:i.specularMap?s=i.specularMap:i.displacementMap?s=i.displacementMap:i.normalMap?s=i.normalMap:i.bumpMap?s=i.bumpMap:i.roughnessMap?s=i.roughnessMap:i.metalnessMap?s=i.metalnessMap:i.alphaMap?s=i.alphaMap:i.emissiveMap?s=i.emissiveMap:i.clearcoatMap?s=i.clearcoatMap:i.clearcoatNormalMap?s=i.clearcoatNormalMap:i.clearcoatRoughnessMap?s=i.clearcoatRoughnessMap:i.iridescenceMap?s=i.iridescenceMap:i.iridescenceThicknessMap?s=i.iridescenceThicknessMap:i.specularIntensityMap?s=i.specularIntensityMap:i.specularColorMap?s=i.specularColorMap:i.transmissionMap?s=i.transmissionMap:i.thicknessMap?s=i.thicknessMap:i.sheenColorMap?s=i.sheenColorMap:i.sheenRoughnessMap&&(s=i.sheenRoughnessMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),i.aoMap?o=i.aoMap:i.lightMap&&(o=i.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uv2Transform.value.copy(o.matrix))}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,i,r,s,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(e,i):i.isMeshToonMaterial?(n(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(n(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(n(e,i),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===f&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,i,o)):i.isMeshMatcapMaterial?(n(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?n(e,i):i.isMeshDistanceMaterial?(n(e,i),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?n(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i,r,s):i.isSpriteMaterial?function(e,t){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function ga(e,t,n,i){let r={},s={},o=[];const a=n.isWebGL2?e.getParameter(35375):0;function l(e,t,n){const i=e.value;if(void 0===n[t])return n[t]="number"==typeof i?i:i.clone(),!0;if("number"==typeof i){if(n[t]!==i)return n[t]=i,!0}else{const e=n[t];if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t=e.value,n={boundary:0,storage:0};return"number"==typeof t?(n.boundary=4,n.storage=4):t.isVector2?(n.boundary=8,n.storage=8):t.isVector3||t.isColor?(n.boundary=16,n.storage=12):t.isVector4?(n.boundary=16,n.storage=16):t.isMatrix3?(n.boundary=48,n.storage=48):t.isMatrix4?(n.boundary=64,n.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),n}function u(t){const n=t.target;n.removeEventListener("dispose",u);const i=o.indexOf(n.__bindingPointIndex);o.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,h){let d=r[n.id];void 0===d&&(function(e){const t=e.uniforms;let n=0;const i=16;let r=0;for(let s=0,o=t.length;s<o;s++){const e=t[s],o=c(e);if(e.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,s>0){r=n%i;0!==r&&i-r-o.boundary<0&&(n+=i-r,e.__offset=n)}n+=o.storage}r=n%i,r>0&&(n+=i-r),e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(35345,i),e.bufferData(35345,r,s),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",u));const p=h.program;i.updateUBOMapping(n,p);const f=t.render.frame;s[n.id]!==f&&(function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(35345,n);for(let r=0,o=i.length;r<o;r++){const t=i[r];if(!0===l(t,r,s)){const n=t.value,i=t.__offset;"number"==typeof n?(t.__data[0]=n,e.bufferSubData(35345,i,t.__data)):(t.value.isMatrix3?(t.__data[0]=t.value.elements[0],t.__data[1]=t.value.elements[1],t.__data[2]=t.value.elements[2],t.__data[3]=t.value.elements[0],t.__data[4]=t.value.elements[3],t.__data[5]=t.value.elements[4],t.__data[6]=t.value.elements[5],t.__data[7]=t.value.elements[0],t.__data[8]=t.value.elements[6],t.__data[9]=t.value.elements[7],t.__data[10]=t.value.elements[8],t.__data[11]=t.value.elements[0]):n.toArray(t.__data),e.bufferSubData(35345,i,t.__data))}}e.bindBuffer(35345,null)}(n),s[n.id]=f)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);o=[],r={},s={}}}}function ma(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;const t=void 0!==e.canvas?e.canvas:function(){const e=qt("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,i=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h;h=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let d=null,m=null;const v=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=bt,this.physicallyCorrectLights=!1,this.toneMapping=K,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const b=this;let y=!1,T=0,E=0,S=null,w=-1,x=null;const M=new gn,I=new gn;let C=null,k=t.width,R=t.height,A=1,L=null,O=null;const N=new gn(0,0,k,R),D=new gn(0,0,k,R);let P=!1;const $=new Or;let B=!1,F=!1,U=null;const z=new Jn,H=new Wt,G=new yn,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===S?A:1}let j,X,Y,q,J,Z,Q,ee,te,ne,ie,re,se,oe,ae,le,ce,ue,he,de,pe,fe,ve,_e,be=n;function ye(e,n){for(let i=0;i<e.length;i++){const r=e[i],s=t.getContext(r,n);if(null!==s)return s}return null}try{const e={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(r)),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",Me,!1),t.addEventListener("webglcontextcreationerror",Ie,!1),null===be){const t=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&t.shift(),be=ye(t,e),null===be)throw ye(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===be.getShaderPrecisionFormat&&(be.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ue){throw console.error("THREE.WebGLRenderer: "+Ue.message),Ue}function Te(){j=new as(be),X=new Gr(be,j,e),j.init(X),fe=new aa(be,j,X),Y=new sa(be,j,X),q=new us,J=new Go,Z=new oa(be,j,Y,J,X,fe,q),Q=new Wr(b),ee=new os(b),te=new Dr(be,X),ve=new zr(be,j,te,X),ne=new ls(be,te,q,ve),ie=new gs(be,ne,te,q),he=new fs(be,X,Z),le=new Vr(J),re=new Ho(b,Q,ee,j,X,ve,le),se=new fa(b,J),oe=new Xo,ae=new Qo(j,X),ue=new Ur(b,Q,Y,ie,h,a),ce=new ra(b,ie,X),_e=new ga(be,q,X,Y),de=new Hr(be,j,q,X),pe=new cs(be,j,q,X),q.programs=re.programs,b.capabilities=X,b.extensions=j,b.properties=J,b.renderLists=oe,b.shadowMap=ce,b.state=Y,b.info=q}Te();const we=new pa(b,be);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Me(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=q.autoReset,t=ce.enabled,n=ce.autoUpdate,i=ce.needsUpdate,r=ce.type;Te(),q.autoReset=e,ce.enabled=t,ce.autoUpdate=n,ce.needsUpdate=i,ce.type=r}function Ie(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ce(e){const t=e.target;t.removeEventListener("dispose",Ce),function(e){(function(e){const t=J.get(e).programs;void 0!==t&&(t.forEach((function(e){re.releaseProgram(e)})),e.isShaderMaterial&&re.releaseShaderCache(e))})(e),J.remove(e)}(t)}this.xr=we,this.getContext=function(){return be},this.getContextAttributes=function(){return be.getContextAttributes()},this.forceContextLoss=function(){const e=j.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=j.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(e){void 0!==e&&(A=e,this.setSize(k,R,!1))},this.getSize=function(e){return e.set(k,R)},this.setSize=function(e,n,i){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=e,R=n,t.width=Math.floor(e*A),t.height=Math.floor(n*A),!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(k*A,R*A).floor()},this.setDrawingBufferSize=function(e,n,i){k=e,R=n,A=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(M)},this.getViewport=function(e){return e.copy(N)},this.setViewport=function(e,t,n,i){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,i),Y.viewport(M.copy(N).multiplyScalar(A).floor())},this.getScissor=function(e){return e.copy(D)},this.setScissor=function(e,t,n,i){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,n,i),Y.scissor(I.copy(D).multiplyScalar(A).floor())},this.getScissorTest=function(){return P},this.setScissorTest=function(e){Y.setScissorTest(P=e)},this.setOpaqueSort=function(e){L=e},this.setTransparentSort=function(e){O=e},this.getClearColor=function(e){return e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),be.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",Me,!1),t.removeEventListener("webglcontextcreationerror",Ie,!1),oe.dispose(),ae.dispose(),J.dispose(),Q.dispose(),ee.dispose(),ie.dispose(),ve.dispose(),_e.dispose(),re.dispose(),we.dispose(),we.removeEventListener("sessionstart",Ae),we.removeEventListener("sessionend",Le),U&&(U.dispose(),U=null),Oe.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=V);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=function(e,t,n,i,r){!0!==t.isScene&&(t=V),Z.resetTextureUnits();const s=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===S?b.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:bt,l=(i.isMeshStandardMaterial?ee:Q).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,f=i.toneMapped?b.toneMapping:K,g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,_=J.get(i),y=m.state.lights;if(!0===B&&(!0===F||e!==x)){const t=e===x&&i.id===w;le.setState(i,e,t)}let T=!1;i.version===_.__version?(_.needsLights&&_.lightsStateVersion!==y.state.version||_.outputEncoding!==a||r.isInstancedMesh&&!1===_.instancing||!r.isInstancedMesh&&!0===_.instancing||r.isSkinnedMesh&&!1===_.skinning||!r.isSkinnedMesh&&!0===_.skinning||_.envMap!==l||!0===i.fog&&_.fog!==s||void 0!==_.numClippingPlanes&&(_.numClippingPlanes!==le.numPlanes||_.numIntersection!==le.numIntersection)||_.vertexAlphas!==c||_.vertexTangents!==u||_.morphTargets!==h||_.morphNormals!==d||_.morphColors!==p||_.toneMapping!==f||!0===X.isWebGL2&&_.morphTargetsCount!==v)&&(T=!0):(T=!0,_.__version=i.version);let E=_.currentProgram;!0===T&&(E=Be(i,t,r));let M=!1,I=!1,C=!1;const k=E.getUniforms(),L=_.uniforms;if(Y.useProgram(E.program)&&(M=!0,I=!0,C=!0),i.id!==w&&(w=i.id,I=!0),M||x!==e){if(k.setValue(be,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&k.setValue(be,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,I=!0,C=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const t=k.map.cameraPosition;void 0!==t&&t.setValue(be,G.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&k.setValue(be,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&k.setValue(be,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){k.setOptional(be,r,"bindMatrix"),k.setOptional(be,r,"bindMatrixInverse");const e=r.skeleton;e&&(X.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),k.setValue(be,"boneTexture",e.boneTexture,Z),k.setValue(be,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const O=n.morphAttributes;if((void 0!==O.position||void 0!==O.normal||void 0!==O.color&&!0===X.isWebGL2)&&he.update(r,n,i,E),(I||_.receiveShadow!==r.receiveShadow)&&(_.receiveShadow=r.receiveShadow,k.setValue(be,"receiveShadow",r.receiveShadow)),I&&(k.setValue(be,"toneMappingExposure",b.toneMappingExposure),_.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(L,C),s&&!0===i.fog&&se.refreshFogUniforms(L,s),se.refreshMaterialUniforms(L,i,A,R,U),yo.upload(be,_.uniformsList,L,Z)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(yo.upload(be,_.uniformsList,L,Z),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&k.setValue(be,"center",r.center),k.setValue(be,"modelViewMatrix",r.modelViewMatrix),k.setValue(be,"normalMatrix",r.normalMatrix),k.setValue(be,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(X.isWebGL2){const n=e[t];_e.update(n,E),_e.bind(n,E)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return E}(e,t,n,i,r);Y.setMaterial(i,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u=1;!0===i.wireframe&&(l=ne.getWireframeAttribute(n),u=2),ve.setup(r,i,a,n,l);let h,d=de;null!==l&&(h=te.get(l),d=pe,d.setIndex(h));const p=null!==l?l.count:c.count,f=n.drawRange.start*u,g=n.drawRange.count*u,v=null!==s?s.start*u:0,_=null!==s?s.count*u:1/0,y=Math.max(f,v),T=Math.min(p,f+g,v+_)-1,E=Math.max(0,T-y+1);if(0!==E){if(r.isMesh)!0===i.wireframe?(Y.setLineWidth(i.wireframeLinewidth*W()),d.setMode(1)):d.setMode(4);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),Y.setLineWidth(e*W()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(y,E,r.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,E,e)}else d.render(y,E)}},this.compile=function(e,t){m=ae.get(e),m.init(),_.push(m),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),m.setupLights(b.physicallyCorrectLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){Be(n[i],e,t)}else Be(n,e,t)})),_.pop(),m=null};let Re=null;function Ae(){Oe.stop()}function Le(){Oe.start()}const Oe=new Nr;function Ne(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)m.pushLight(e),e.castShadow&&m.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||$.intersectsSprite(e)){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=ie.update(e),r=e.material;r.visible&&d.push(e,t,r,n,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==q.render.frame&&(e.skeleton.update(),e.skeleton.frame=q.render.frame),!e.frustumCulled||$.intersectsObject(e))){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);const t=ie.update(e),r=e.material;if(Array.isArray(r)){const i=t.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&d.push(e,t,a,n,G.z,o)}}else r.visible&&d.push(e,t,r,n,G.z,null)}const r=e.children;for(let s=0,o=r.length;s<o;s++)Ne(r[s],t,n,i)}function De(e,t,n,i){const r=e.opaque,s=e.transmissive,a=e.transparent;m.setupLightsView(n),s.length>0&&function(e,t,n){const i=X.isWebGL2;null===U&&(U=new mn(1,1,{generateMipmaps:!0,type:j.has("EXT_color_buffer_half_float")?Se:me,minFilter:ge,samples:i&&!0===o?4:0})),b.getDrawingBufferSize(H),i?U.setSize(H.x,H.y):U.setSize(Gt(H.x),Gt(H.y));const r=b.getRenderTarget();b.setRenderTarget(U),b.clear();const s=b.toneMapping;b.toneMapping=K,Pe(e,t,n),b.toneMapping=s,Z.updateMultisampleRenderTarget(U),Z.updateRenderTargetMipmap(U),b.setRenderTarget(r)}(r,t,n),i&&Y.viewport(M.copy(i)),r.length>0&&Pe(r,t,n),s.length>0&&Pe(s,t,n),a.length>0&&Pe(a,t,n),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1)}function Pe(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;o.layers.test(n.layers)&&$e(o,t,n,a,l,c)}}function $e(e,t,n,i,r,s){e.onBeforeRender(b,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(b,t,n,i,e,s),!0===r.transparent&&r.side===g?(r.side=f,r.needsUpdate=!0,b.renderBufferDirect(n,t,i,r,e,s),r.side=p,r.needsUpdate=!0,b.renderBufferDirect(n,t,i,r,e,s),r.side=g):b.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(b,t,n,i,r,s)}function Be(e,t,n){!0!==t.isScene&&(t=V);const i=J.get(e),r=m.state.lights,s=m.state.shadowsArray,o=r.state.version,a=re.getParameters(e,r.state,s,t,n),l=re.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ee:Q).get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",Ce),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return Fe(e,a),u}else a.uniforms=re.getUniforms(e),e.onBuild(n,a,b),e.onBeforeCompile(a,b),u=re.acquireProgram(a,l),c.set(l,u),i.uniforms=a.uniforms;const h=i.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(h.clippingPlanes=le.uniform),Fe(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotShadowMatrix.value=r.state.spotShadowMatrix,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);const d=u.getUniforms(),p=yo.seqWithValue(d.seq,h);return i.currentProgram=u,i.uniformsList=p,u}function Fe(e,t){const n=J.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Oe.setAnimationLoop((function(e){Re&&Re(e)})),typeof self<"u"&&Oe.setContext(self),this.setAnimationLoop=function(e){Re=e,we.setAnimationLoop(e),null===e?Oe.stop():Oe.start()},we.addEventListener("sessionstart",Ae),we.addEventListener("sessionend",Le),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(!0===we.cameraAutoUpdate&&we.updateCamera(t),t=we.getCamera()),!0===e.isScene&&e.onBeforeRender(b,e,t,S),m=ae.get(e,_.length),m.init(),_.push(m),z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromProjectionMatrix(z),F=this.localClippingEnabled,B=le.init(this.clippingPlanes,F,t),d=oe.get(e,v.length),d.init(),v.push(d),Ne(e,t,0,b.sortObjects),d.finish(),!0===b.sortObjects&&d.sort(L,O),!0===B&&le.beginShadows();const n=m.state.shadowsArray;if(ce.render(n,e,t),!0===B&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),ue.render(d,e),m.setupLights(b.physicallyCorrectLights),t.isArrayCamera){const n=t.cameras;for(let t=0,i=n.length;t<i;t++){const i=n[t];De(d,e,i,i.viewport)}}else De(d,e,t);null!==S&&(Z.updateMultisampleRenderTarget(S),Z.updateRenderTargetMipmap(S)),!0===e.isScene&&e.onAfterRender(b,e,t),ve.resetDefaultState(),w=-1,x=null,_.pop(),m=_.length>0?_[_.length-1]:null,v.pop(),d=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(e,t,n){J.get(e.texture).__webglTexture=t,J.get(e.depthTexture).__webglTexture=n;const i=J.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===j.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=J.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;S=e,T=t,E=n;let i=!0;if(e){const t=J.get(e);void 0!==t.__useDefaultFramebuffer?(Y.bindFramebuffer(36160,null),i=!1):void 0===t.__webglFramebuffer?Z.setupRenderTarget(e):t.__hasExternalTextures&&Z.rebindTextures(e,J.get(e.texture).__webglTexture,J.get(e.depthTexture).__webglTexture)}let r=null,s=!1,o=!1;if(e){const n=e.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(o=!0);const i=J.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=i[t],s=!0):r=X.isWebGL2&&e.samples>0&&!1===Z.useMultisampledRTT(e)?J.get(e).__webglMultisampledFramebuffer:i,M.copy(e.viewport),I.copy(e.scissor),C=e.scissorTest}else M.copy(N).multiplyScalar(A).floor(),I.copy(D).multiplyScalar(A).floor(),C=P;if(Y.bindFramebuffer(36160,r)&&X.drawBuffers&&i&&Y.drawBuffers(e,r),Y.viewport(M),Y.scissor(I),Y.setScissorTest(C),s){const i=J.get(e.texture);be.framebufferTexture2D(36160,36064,34069+t,i.__webglTexture,n)}else if(o){const i=J.get(e.texture),r=t||0;be.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}w=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=J.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){Y.bindFramebuffer(36160,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==ke&&fe.convert(a)!==be.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Se&&(j.has("EXT_color_buffer_half_float")||X.isWebGL2&&j.has("EXT_color_buffer_float"));if(l!==me&&fe.convert(l)!==be.getParameter(35738)&&(l!==Ee||!(X.isWebGL2||j.has("OES_texture_float")||j.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&be.readPixels(t,n,i,r,fe.convert(a),fe.convert(l),s)}finally{const e=null!==S?J.get(S).__webglFramebuffer:null;Y.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i);Z.setTexture2D(t,0),be.copyTexSubImage2D(3553,n,0,0,e.x,e.y,r,s),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=t.image.width,s=t.image.height,o=fe.convert(n.format),a=fe.convert(n.type);Z.setTexture2D(n,0),be.pixelStorei(37440,n.flipY),be.pixelStorei(37441,n.premultiplyAlpha),be.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?be.texSubImage2D(3553,i,e.x,e.y,r,s,o,a,t.image.data):t.isCompressedTexture?be.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):be.texSubImage2D(3553,i,e.x,e.y,o,a,t.image),0===i&&n.generateMipmaps&&be.generateMipmap(3553),Y.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=fe.convert(i.format),c=fe.convert(i.type);let u;if(i.isData3DTexture)Z.setTexture3D(i,0),u=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(i,0),u=35866}be.pixelStorei(37440,i.flipY),be.pixelStorei(37441,i.premultiplyAlpha),be.pixelStorei(3317,i.unpackAlignment);const h=be.getParameter(3314),d=be.getParameter(32878),p=be.getParameter(3316),f=be.getParameter(3315),g=be.getParameter(32877),m=n.isCompressedTexture?n.mipmaps[0]:n.image;be.pixelStorei(3314,m.width),be.pixelStorei(32878,m.height),be.pixelStorei(3316,e.min.x),be.pixelStorei(3315,e.min.y),be.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?be.texSubImage3D(u,r,t.x,t.y,t.z,s,o,a,l,c,m.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),be.compressedTexSubImage3D(u,r,t.x,t.y,t.z,s,o,a,l,m.data)):be.texSubImage3D(u,r,t.x,t.y,t.z,s,o,a,l,c,m),be.pixelStorei(3314,h),be.pixelStorei(32878,d),be.pixelStorei(3316,p),be.pixelStorei(3315,f),be.pixelStorei(32877,g),0===r&&i.generateMipmaps&&be.generateMipmap(u),Y.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?Z.setTextureCube(e,0):e.isData3DTexture?Z.setTexture3D(e,0):e.isDataArrayTexture?Z.setTexture2DArray(e,0):Z.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){T=0,E=0,S=null,Y.reset(),ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class va extends ma{}va.prototype.isWebGL1Renderer=!0;class _a{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new ln(e),this.density=t}clone(){return new _a(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ba{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new ln(e),this.near=t,this.far=n}clone(){return new ba(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ya extends Ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class Ta{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ct,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=$t()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ea=new yn;class Sa{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyMatrix4(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyNormalMatrix(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.transformDirection(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Fi(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Sa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class wa extends Di{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ln(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let xa;const Ma=new yn,Ia=new yn,Ca=new yn,ka=new Wt,Ra=new Wt,Aa=new Jn,La=new yn,Oa=new yn,Na=new yn,Da=new Wt,Pa=new Wt,$a=new Wt;class Ba extends Ei{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===xa){xa=new qi;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Ta(e,5);xa.setIndex([0,1,2,0,2,3]),xa.setAttribute("position",new Sa(t,3,0,!1)),xa.setAttribute("uv",new Sa(t,2,3,!1))}this.geometry=xa,this.material=void 0!==e?e:new wa,this.center=new Wt(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ia.setFromMatrixScale(this.matrixWorld),Aa.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ca.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ia.multiplyScalar(-Ca.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;Fa(La.set(-.5,-.5,0),Ca,s,Ia,i,r),Fa(Oa.set(.5,-.5,0),Ca,s,Ia,i,r),Fa(Na.set(.5,.5,0),Ca,s,Ia,i,r),Da.set(0,0),Pa.set(1,0),$a.set(1,1);let o=e.ray.intersectTriangle(La,Oa,Na,!1,Ma);if(null===o&&(Fa(Oa.set(-.5,.5,0),Ca,s,Ia,i,r),Pa.set(0,1),o=e.ray.intersectTriangle(La,Na,Oa,!1,Ma),null===o))return;const a=e.ray.origin.distanceTo(Ma);a<e.near||a>e.far||t.push({distance:a,point:Ma.clone(),uv:Oi.getUV(Ma,La,Oa,Na,Da,Pa,$a,new Wt),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Fa(e,t,n,i,r,s){ka.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(Ra.x=s*ka.x-r*ka.y,Ra.y=r*ka.x+s*ka.y):Ra.copy(ka),e.copy(t),e.x+=Ra.x,e.y+=Ra.y,e.applyMatrix4(Aa)}const Ua=new yn,za=new yn;class Ha extends Ei{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Ua.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Ua);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Ua.setFromMatrixPosition(e.matrixWorld),za.setFromMatrixPosition(this.matrixWorld);const n=Ua.distanceTo(za)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const e=n[i];t.object.levels.push({object:e.object.uuid,distance:e.distance})}return t}}const Ga=new yn,Va=new gn,Wa=new gn,ja=new yn,Xa=new Jn;class Ya extends fr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Jn,this.bindMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;Va.fromBufferAttribute(i.attributes.skinIndex,e),Wa.fromBufferAttribute(i.attributes.skinWeight,e),Ga.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const e=Wa.getComponent(r);if(0!==e){const i=Va.getComponent(r);Xa.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(ja.copy(Ga).applyMatrix4(Xa),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ka extends Ei{constructor(){super(),this.isBone=!0,this.type="Bone"}}class qa extends fn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:ue,arguments.length>9&&void 0!==arguments[9]?arguments[9]:ue,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Ja=new Jn,Za=new Jn;class Qa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=$t(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Jn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Jn;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const i=e[r]?e[r].matrixWorld:Za;Ja.multiplyMatrices(i,t[r]),Ja.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new Qa(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Ht(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new qa(t,e,e,ke,Ee);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new Ka),this.bones.push(r),this.boneInverses.push((new Jn).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const r=t[i];e.bones.push(r.uuid);const s=n[i];e.boneInverses.push(s.toArray())}return e}}class el extends Fi{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const tl=new Jn,nl=new Jn,il=[],rl=new fr;class sl extends fr{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new el(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(rl.geometry=this.geometry,rl.material=this.material,void 0!==rl.material)for(let r=0;r<i;r++){this.getMatrixAt(r,tl),nl.multiplyMatrices(n,tl),rl.matrixWorld=nl,rl.raycast(e,il);for(let e=0,n=il.length;e<n;e++){const n=il[e];n.instanceId=r,n.object=this,t.push(n)}il.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new el(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ol extends Di{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ln(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const al=new yn,ll=new yn,cl=new Jn,ul=new qn,hl=new Hn;class dl extends Ei{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ol;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)al.fromBufferAttribute(t,e-1),ll.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=al.distanceTo(ll);e.setAttribute("lineDistance",new Hi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),hl.copy(n.boundingSphere),hl.applyMatrix4(i),hl.radius+=r,!1===e.ray.intersectsSphere(hl))return;cl.copy(i).invert(),ul.copy(e.ray).applyMatrix4(cl);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new yn,c=new yn,u=new yn,h=new yn,d=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p){for(let n=Math.max(0,s.start),i=Math.min(p.count,s.start+s.count)-1;n<i;n+=d){const i=p.getX(n),r=p.getX(n+1);if(l.fromBufferAttribute(f,i),c.fromBufferAttribute(f,r),ul.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const s=e.ray.origin.distanceTo(h);s<e.near||s>e.far||t.push({distance:s,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,s.start),i=Math.min(f.count,s.start+s.count)-1;n<i;n+=d){if(l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,n+1),ul.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(h);i<e.near||i>e.far||t.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const pl=new yn,fl=new yn;class gl extends dl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)pl.fromBufferAttribute(t,e),fl.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+pl.distanceTo(fl);e.setAttribute("lineDistance",new Hi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ml extends dl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class vl extends Di{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ln(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const _l=new Jn,bl=new qn,yl=new Hn,Tl=new yn;class El extends Ei{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new vl;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),yl.copy(n.boundingSphere),yl.applyMatrix4(i),yl.radius+=r,!1===e.ray.intersectsSphere(yl))return;_l.copy(i).invert(),bl.copy(e.ray).applyMatrix4(_l);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);Tl.fromBufferAttribute(c,r),Sl(Tl,r,a,i,e,t,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)Tl.fromBufferAttribute(c,n),Sl(Tl,n,a,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Sl(e,t,n,i,r,s,o){const a=bl.distanceSqToPoint(e);if(a<n){const n=new yn;bl.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:o})}}class wl extends fn{constructor(e,t,n,i,r,s,o,a,l,c,u,h){super(null,s,o,a,l,c,i,r,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class xl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);const r=this.getPoint(n),s=this.getPoint(i),o=t||(r.isVector2?new Wt:new yn);return o.copy(s).sub(r).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new yn,i=[],r=[],s=[],o=new yn,a=new Jn;for(let d=0;d<=e;d++){const t=d/e;i[d]=this.getTangentAt(t,new yn)}r[0]=new yn,s[0]=new yn;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Bt(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,e))}s[d].crossVectors(i[d],r[d])}if(!0===t){let t=Math.acos(Bt(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ml extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const n=t||new Wt,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0===this.aClockwise&&!s&&(r===i?r=-i:r-=i);const o=this.aStartAngle+e*r;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Il extends Ml{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Cl(){let e=0,t=0,n=0,i=0;function r(r,s,o,a){e=r,t=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,o,a){let l=(t-e)/s-(n-e)/(s+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l*=o,c*=o,r(t,n,l,c)},calc:function(r){const s=r*r;return e+t*r+n*s+i*(s*r)}}}const kl=new yn,Rl=new Cl,Al=new Cl,Ll=new Cl;class Ol extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.points,i=n.length,r=(i-(this.closed?0:1))*e;let s,o,a=Math.floor(r),l=r-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:0===l&&a===i-1&&(a=i-2,l=1),this.closed||a>0?s=n[(a-1)%i]:(kl.subVectors(n[0],n[1]).add(n[0]),s=kl);const c=n[a%i],u=n[(a+1)%i];if(this.closed||a+2<i?o=n[(a+2)%i]:(kl.subVectors(n[i-1],n[i-2]).add(n[i-1]),o=kl),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),Rl.initNonuniformCatmullRom(s.x,c.x,u.x,o.x,t,n,i),Al.initNonuniformCatmullRom(s.y,c.y,u.y,o.y,t,n,i),Ll.initNonuniformCatmullRom(s.z,c.z,u.z,o.z,t,n,i)}else"catmullrom"===this.curveType&&(Rl.initCatmullRom(s.x,c.x,u.x,o.x,this.tension),Al.initCatmullRom(s.y,c.y,u.y,o.y,this.tension),Ll.initCatmullRom(s.z,c.z,u.z,o.z,this.tension));return t.set(Rl.calc(l),Al.calc(l),Ll.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new yn).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Nl(e,t,n,i,r){const s=.5*(i-t),o=.5*(r-n),a=e*e;return(2*n-2*i+s+o)*(e*a)+(-3*n+3*i-2*s-o)*a+s*e+n}function Dl(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function Pl(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}class $l extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Wt;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Pl(e,n.x,i.x,r.x,s.x),Pl(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Bl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new yn;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Pl(e,n.x,i.x,r.x,s.x),Pl(e,n.y,i.y,r.y,s.y),Pl(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Fl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Wt;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ul extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wt;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.v0,i=this.v1,r=this.v2;return t.set(Dl(e,n.x,i.x,r.x),Dl(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yn;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,n=this.v0,i=this.v1,r=this.v2;return t.set(Dl(e,n.x,i.x,r.x),Dl(e,n.y,i.y,r.y),Dl(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gl extends xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,o=n[0===r?r:r-1],a=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set(Nl(s,o.x,a.x,l.x,c.x),Nl(s,o.y,a.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Wt).fromArray(n))}return this}}var Vl=Object.freeze({__proto__:null,ArcCurve:Il,CatmullRomCurve3:Ol,CubicBezierCurve:$l,CubicBezierCurve3:Bl,EllipseCurve:Ml,LineCurve:Fl,LineCurve3:Ul,QuadraticBezierCurve:zl,QuadraticBezierCurve3:Hl,SplineCurve:Gl});class Wl extends xl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Fl(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const e=i[r]-n,s=this.curves[r],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new Vl[n.type]).fromJSON(n))}return this}}class jl extends Wl{constructor(e){super(),this.type="Path",this.currentPoint=new Wt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Fl(this.currentPoint.clone(),new Wt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new zl(this.currentPoint.clone(),new Wt(e,t),new Wt(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const o=new $l(this.currentPoint.clone(),new Wt(e,t),new Wt(n,i),new Wt(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Gl(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,o,a),this}absellipse(e,t,n,i,r,s,o,a){const l=new Ml(e,t,n,i,r,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Xl extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new Wt(0,-.5),new Wt(.5,0),new Wt(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Bt(i,0,2*Math.PI);const r=[],s=[],o=[],a=[],l=[],c=1/t,u=new yn,h=new Wt,d=new yn,p=new yn,f=new yn;let g=0,m=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=1*m,d.y=-g,d.z=0*m,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(f.x,f.y,f.z);break;default:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=1*m,d.y=-g,d.z=0*m,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){const r=n+v*c*i,d=Math.sin(r),p=Math.cos(r);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*p,s.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),o.push(h.x,h.y);const i=a[3*n+0]*d,r=a[3*n+1],c=a[3*n+0]*p;l.push(i,r,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,i=n,s=n+e.length,o=n+e.length+1,a=n+1;r.push(i,s,a),r.push(o,a,s)}this.setIndex(r),this.setAttribute("position",new Hi(s,3)),this.setAttribute("uv",new Hi(o,2)),this.setAttribute("normal",new Hi(l,3))}static fromJSON(e){return new Xl(e.points,e.segments,e.phiStart,e.phiLength)}}class Yl extends Xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;const r=new jl;r.absarc(0,-t/2,e,1.5*Math.PI,0),r.absarc(0,t/2,e,0,.5*Math.PI),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new Yl(e.radius,e.length,e.capSegments,e.radialSegments)}}class Kl extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],o=[],a=[],l=new yn,c=new Wt;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const r=n+u/t*i;l.x=e*Math.cos(r),l.y=e*Math.sin(r),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[h]/e+1)/2,c.y=(s[h+1]/e+1)/2,a.push(c.x,c.y)}for(let u=1;u<=t;u++)r.push(u,u+1,0);this.setIndex(r),this.setAttribute("position",new Hi(s,3)),this.setAttribute("normal",new Hi(o,3)),this.setAttribute("uv",new Hi(a,2))}static fromJSON(e){return new Kl(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ql extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],u=[],h=[],d=[];let p=0;const f=[],g=n/2;let m=0;function v(n){const r=p,s=new Wt,f=new yn;let v=0;const _=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=i;e++)u.push(0,g*b,0),h.push(0,b,0),d.push(.5,.5),p++;const y=p;for(let e=0;e<=i;e++){const t=e/i*a+o,n=Math.cos(t),r=Math.sin(t);f.x=_*r,f.y=g*b,f.z=_*n,u.push(f.x,f.y,f.z),h.push(0,b,0),s.x=.5*n+.5,s.y=.5*r*b+.5,d.push(s.x,s.y),p++}for(let e=0;e<i;e++){const t=r+e,i=y+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(m,v,!0===n?1:2),m+=v}(function(){const s=new yn,v=new yn;let _=0;const b=(t-e)/n;for(let l=0;l<=r;l++){const c=[],m=l/r,_=m*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*a+o,l=Math.sin(r),f=Math.cos(r);v.x=_*l,v.y=-m*n+g,v.z=_*f,u.push(v.x,v.y,v.z),s.set(l,b,f).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-m),c.push(p++)}f.push(c)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=f[t][e],i=f[t+1][e],r=f[t+1][e+1],s=f[t][e+1];c.push(n,i,s),c.push(i,r,s),_+=6}l.addGroup(m,_,0),m+=_})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Hi(u,3)),this.setAttribute("normal",new Hi(h,3)),this.setAttribute("uv",new Hi(d,2))}static fromJSON(e){return new ql(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Jl extends ql{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(e){return new Jl(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zl extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],s=[];function o(e,t,n,i){const r=i+1,s=[];for(let o=0;o<=r;o++){s[o]=[];const i=e.clone().lerp(n,o/r),a=t.clone().lerp(n,o/r),l=r-o;for(let e=0;e<=l;e++)s[o][e]=0===e&&o===r?i:i.clone().lerp(a,e/l)}for(let o=0;o<r;o++)for(let e=0;e<2*(r-o)-1;e++){const t=Math.floor(e/2);e%2===0?(a(s[o][t+1]),a(s[o+1][t]),a(s[o][t])):(a(s[o][t+1]),a(s[o+1][t+1]),a(s[o+1][t]))}}function a(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){const n=new yn,i=new yn,r=new yn;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),o(n,i,r,e)})(i),function(e){const t=new yn;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new yn;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];const n=u(e)/2/Math.PI+.5,i=h(e)/Math.PI+.5;s.push(n,1-i)}(function(){const e=new yn,t=new yn,n=new yn,i=new yn,o=new Wt,a=new Wt,l=new Wt;for(let h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(e).add(t).add(n).divideScalar(3);const p=u(i);c(o,d+0,e,p),c(a,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);r>.9&&o<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new Hi(r,3)),this.setAttribute("normal",new Hi(r.slice(),3)),this.setAttribute("uv",new Hi(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Zl(e.vertices,e.indices,e.radius,e.details)}}class Ql extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ql(e.radius,e.detail)}}const ec=new yn,tc=new yn,nc=new yn,ic=new Oi;class rc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=Math.pow(10,4),i=Math.cos(Dt*t),r=e.getIndex(),s=e.getAttribute("position"),o=r?r.count:s.count,a=[0,0,0],l=["a","b","c"],c=new Array(3),u={},h=[];for(let e=0;e<o;e+=3){r?(a[0]=r.getX(e),a[1]=r.getX(e+1),a[2]=r.getX(e+2)):(a[0]=e,a[1]=e+1,a[2]=e+2);const{a:t,b:o,c:d}=ic;if(t.fromBufferAttribute(s,a[0]),o.fromBufferAttribute(s,a[1]),d.fromBufferAttribute(s,a[2]),ic.getNormal(nc),c[0]="".concat(Math.round(t.x*n),",").concat(Math.round(t.y*n),",").concat(Math.round(t.z*n)),c[1]="".concat(Math.round(o.x*n),",").concat(Math.round(o.y*n),",").concat(Math.round(o.z*n)),c[2]="".concat(Math.round(d.x*n),",").concat(Math.round(d.y*n),",").concat(Math.round(d.z*n)),c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=c[e],r=c[t],s=ic[l[e]],o=ic[l[t]],d="".concat(n,"_").concat(r),p="".concat(r,"_").concat(n);p in u&&u[p]?(nc.dot(u[p].normal)<=i&&(h.push(s.x,s.y,s.z),h.push(o.x,o.y,o.z)),u[p]=null):d in u||(u[d]={index0:a[e],index1:a[t],normal:nc.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];ec.fromBufferAttribute(s,t),tc.fromBufferAttribute(s,n),h.push(ec.x,ec.y,ec.z),h.push(tc.x,tc.y,tc.z)}this.setAttribute("position",new Hi(h,3))}}}class sc extends jl{constructor(e){super(e),this.uuid=$t(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new jl).fromJSON(n))}return this}}const oc=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=ac(e,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(i&&(s=function(e,t,n,i){const r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*i,l=s<o-1?t[s+1]*i:e.length,c=ac(e,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(_c(c));for(r.sort(fc),s=0;s<r.length;s++)gc(r[s],n),n=lc(n,n.next);return n}(e,t,s,n)),e.length>80*n){a=c=e[0],l=u=e[1];for(let t=n;t<r;t+=n)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return cc(s,o,n,a,l,p),o};function ac(e,t,n,i,r){let s,o;if(r===function(e,t,n,i){let r=0;for(let s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}(e,t,n,i)>0)for(s=t;s<n;s+=i)o=Cc(s,e[s],e[s+1],o);else for(s=n-i;s>=t;s-=i)o=Cc(s,e[s],e[s+1],o);return o&&Ec(o,o.next)&&(kc(o),o=o.next),o}function lc(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Ec(i,i.next)&&0!==Tc(i.prev,i,i.next))i=i.next;else{if(kc(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function cc(e,t,n,i,r,s,o){if(!e)return;!o&&s&&function(e,t,n,i){let r=e;do{null===r.z&&(r.z=vc(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,s,o,a,l,c=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ,i);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(e,i,r,s);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,s?hc(e,i,r,s):uc(e))t.push(a.i/n),t.push(e.i/n),t.push(l.i/n),kc(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?cc(e=dc(lc(e),t,n),t,n,i,r,s,2):2===o&&pc(e,t,n,i,r,s):cc(lc(e),t,n,i,r,s,1);break}}function uc(e){const t=e.prev,n=e,i=e.next;if(Tc(t,n,i)>=0)return!1;let r=e.next.next;for(;r!==e.prev;){if(bc(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Tc(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function hc(e,t,n,i){const r=e.prev,s=e,o=e.next;if(Tc(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=vc(a,l,t,n,i),d=vc(c,u,t,n,i);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&bc(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Tc(p.prev,p,p.next)>=0||(p=p.prevZ,f!==e.prev&&f!==e.next&&bc(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Tc(f.prev,f,f.next)>=0))return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&bc(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Tc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&bc(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Tc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function dc(e,t,n){let i=e;do{const r=i.prev,s=i.next.next;!Ec(r,s)&&Sc(r,i,i.next,s)&&Mc(r,s)&&Mc(s,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(s.i/n),kc(i),kc(i.next),i=e=s),i=i.next}while(i!==e);return lc(i)}function pc(e,t,n,i,r,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&yc(o,e)){let a=Ic(o,e);return o=lc(o,o.next),a=lc(a,a.next),cc(o,t,n,i,r,s),void cc(a,t,n,i,r,s)}e=e.next}o=o.next}while(o!==e)}function fc(e,t){return e.x-t.x}function gc(e,t){if(t=function(e,t){let n=t;const i=e.x,r=e.y;let s,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const e=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>o){if(o=e,e===i){if(r===n.y)return n;if(r===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(i===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;n=s;do{i>=n.x&&n.x>=l&&i!==n.x&&bc(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),Mc(n,e)&&(u<h||u===h&&(n.x>s.x||n.x===s.x&&mc(s,n)))&&(s=n,h=u)),n=n.next}while(n!==a);return s}(e,t),t){const n=Ic(t,e);lc(t,t.next),lc(n,n.next)}}function mc(e,t){return Tc(e.prev,e,t.prev)<0&&Tc(t.next,e,e.next)<0}function vc(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _c(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function bc(e,t,n,i,r,s,o,a){return(r-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(i-a)-(n-o)*(t-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function yc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Sc(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Mc(e,t)&&Mc(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Tc(e.prev,e,t.prev)||Tc(e,t.prev,t))||Ec(e,t)&&Tc(e.prev,e,e.next)>0&&Tc(t.prev,t,t.next)>0)}function Tc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Ec(e,t){return e.x===t.x&&e.y===t.y}function Sc(e,t,n,i){const r=xc(Tc(e,t,n)),s=xc(Tc(e,t,i)),o=xc(Tc(n,i,e)),a=xc(Tc(n,i,t));return!!(r!==s&&o!==a||0===r&&wc(e,n,t)||0===s&&wc(e,i,t)||0===o&&wc(n,e,i)||0===a&&wc(n,t,i))}function wc(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function xc(e){return e>0?1:e<0?-1:0}function Mc(e,t){return Tc(e.prev,e,e.next)<0?Tc(e,t,e.next)>=0&&Tc(e,e.prev,t)>=0:Tc(e,t,e.prev)<0||Tc(e,e.next,t)<0}function Ic(e,t){const n=new Rc(e.i,e.x,e.y),i=new Rc(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Cc(e,t,n,i){const r=new Rc(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function kc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Rc(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ac{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return Ac.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];Lc(e),Oc(n,e);let s=e.length;t.forEach(Lc);for(let a=0;a<t.length;a++)i.push(s),s+=t[a].length,Oc(n,t[a]);const o=oc(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function Lc(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Oc(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class Nc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sc([new Wt(.5,.5),new Wt(-.5,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let o=0,a=e.length;o<a;o++){s(e[o])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,g=void 0!==t.UVGenerator?t.UVGenerator:Dc;let m,v,_,b,y,T=!1;f&&(m=f.getSpacedPoints(a),T=!0,c=!1,v=f.computeFrenetFrames(a,!1),_=new yn,b=new yn,y=new yn),c||(p=0,u=0,h=0,d=0);const E=e.extractPoints(o);let S=E.shape;const w=E.holes;if(!Ac.isClockWise(S)){S=S.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];Ac.isClockWise(t)&&(w[e]=t.reverse())}}const x=Ac.triangulateShape(S,w),M=S;for(let t=0,n=w.length;t<n;t++){const e=w[t];S=S.concat(e)}function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const C=S.length,k=x.length;function R(e,t,n){let i,r,s;const o=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,f=t.y+o/h,g=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(o*c-a*l);i=p+o*g-e.x,r=f+a*g-e.y;const m=i*i+r*r;if(m<=2)return new Wt(i,r);s=Math.sqrt(m/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,r=o,s=Math.sqrt(u)):(i=o,r=a,s=Math.sqrt(u/2))}return new Wt(i/s,r/s)}const A=[];for(let t=0,n=M.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),A[t]=R(M[t],M[i],M[r]);const L=[];let O,N=A.concat();for(let t=0,n=w.length;t<n;t++){const e=w[t];O=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),O[t]=R(e[t],e[i],e[r]);L.push(O),N=N.concat(O)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,r=M.length;t<r;t++){const e=I(M[t],A[t],i);$(e.x,e.y,-n)}for(let t=0,r=w.length;t<r;t++){const e=w[t];O=L[t];for(let t=0,r=e.length;t<r;t++){const r=I(e[t],O[t],i);$(r.x,r.y,-n)}}}const D=h+d;for(let t=0;t<C;t++){const e=c?I(S[t],N[t],D):S[t];T?(b.copy(v.normals[0]).multiplyScalar(e.x),_.copy(v.binormals[0]).multiplyScalar(e.y),y.copy(m[0]).add(b).add(_),$(y.x,y.y,y.z)):$(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<C;e++){const n=c?I(S[e],N[e],D):S[e];T?(b.copy(v.normals[t]).multiplyScalar(n.x),_.copy(v.binormals[t]).multiplyScalar(n.y),y.copy(m[t]).add(b).add(_),$(y.x,y.y,y.z)):$(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,r=M.length;t<r;t++){const e=I(M[t],A[t],i);$(e.x,e.y,l+n)}for(let t=0,r=w.length;t<r;t++){const e=w[t];O=L[t];for(let t=0,r=e.length;t<r;t++){const r=I(e[t],O[t],i);T?$(r.x,r.y+m[a-1].y,m[a-1].x+n):$(r.x,r.y,l+n)}}}function P(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=C*e,s=C*(e+1);F(t+i+n,t+r+n,t+r+s,t+i+s)}}}function $(e,t,n){s.push(e),s.push(t),s.push(n)}function B(e,t,r){U(e),U(t),U(r);const s=i.length/3,o=g.generateTopUV(n,i,s-3,s-2,s-1);z(o[0]),z(o[1]),z(o[2])}function F(e,t,r,s){U(e),U(t),U(s),U(t),U(r),U(s);const o=i.length/3,a=g.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);z(a[0]),z(a[1]),z(a[3]),z(a[1]),z(a[2]),z(a[3])}function U(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function z(e){r.push(e.x),r.push(e.y)}(function(){const e=i.length/3;if(c){let e=0,t=C*e;for(let n=0;n<k;n++){const e=x[n];B(e[2]+t,e[1]+t,e[0]+t)}e=a+2*p,t=C*e;for(let n=0;n<k;n++){const e=x[n];B(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<k;e++){const t=x[e];B(t[2],t[1],t[0])}for(let e=0;e<k;e++){const t=x[e];B(t[0]+C*a,t[1]+C*a,t[2]+C*a)}}n.addGroup(e,i.length/3-e,0)})(),function(){const e=i.length/3;let t=0;P(M,t),t+=M.length;for(let n=0,i=w.length;n<i;n++){const e=w[n];P(e,t),t+=e.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new Hi(i,3)),this.setAttribute("uv",new Hi(r,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){const t=e[i];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);return n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const i=t[e.shapes[r]];n.push(i)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new Vl[i.type]).fromJSON(i)),new Nc(n,e.options)}}const Dc={generateTopUV:function(e,t,n,i,r){const s=t[3*n],o=t[3*n+1],a=t[3*i],l=t[3*i+1],c=t[3*r],u=t[3*r+1];return[new Wt(s,o),new Wt(a,l),new Wt(c,u)]},generateSideWallUV:function(e,t,n,i,r,s){const o=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],g=t[3*s],m=t[3*s+1],v=t[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Wt(o,1-l),new Wt(c,1-h),new Wt(d,1-f),new Wt(g,1-v)]:[new Wt(a,1-l),new Wt(u,1-h),new Wt(p,1-f),new Wt(m,1-v)]}};class Pc extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Pc(e.radius,e.detail)}}class $c extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $c(e.radius,e.detail)}}class Bc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n),i=Math.max(1,i);const o=[],a=[],l=[],c=[];let u=e;const h=(t-e)/i,d=new yn,p=new Wt;for(let f=0;f<=i;f++){for(let e=0;e<=n;e++){const i=r+e/n*s;d.x=u*Math.cos(i),d.y=u*Math.sin(i),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let f=0;f<i;f++){const e=f*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,s=i+n+1,a=i+n+2,l=i+1;o.push(r,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new Hi(a,3)),this.setAttribute("normal",new Hi(l,3)),this.setAttribute("uv",new Hi(c,2))}static fromJSON(e){return new Bc(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Fc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sc([new Wt(0,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(o,a,c),o+=a,a=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===Ac.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===Ac.isClockWise(e)&&(u[t]=e.reverse())}const h=Ac.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,i=h.length;t<i;t++){const e=h[t],i=e[0]+o,r=e[1]+o,s=e[2]+o;n.push(i,r,s),a+=3}}this.setIndex(n),this.setAttribute("position",new Hi(i,3)),this.setAttribute("normal",new Hi(r,3)),this.setAttribute("uv",new Hi(s,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const r=t[e.shapes[i]];n.push(r)}return new Fc(n,e.curveSegments)}}class Uc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new yn,h=new yn,d=[],p=[],f=[],g=[];for(let m=0;m<=n;m++){const d=[],v=m/n;let _=0;0==m&&0==s?_=.5/t:m==n&&a==Math.PI&&(_=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(i+a*r)*Math.sin(s+v*o),u.y=e*Math.cos(s+v*o),u.z=e*Math.sin(i+a*r)*Math.sin(s+v*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),g.push(a+_,1-v),d.push(l++)}c.push(d)}for(let m=0;m<n;m++)for(let e=0;e<t;e++){const t=c[m][e+1],i=c[m][e],r=c[m+1][e],o=c[m+1][e+1];(0!==m||s>0)&&d.push(t,i,o),(m!==n-1||a<Math.PI)&&d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new Hi(p,3)),this.setAttribute("normal",new Hi(f,3)),this.setAttribute("uv",new Hi(g,2))}static fromJSON(e){return new Uc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zc extends Zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zc(e.radius,e.detail)}}class Hc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],o=[],a=[],l=[],c=new yn,u=new yn,h=new yn;for(let d=0;d<=n;d++)for(let s=0;s<=i;s++){const p=s/i*r,f=d/n*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(s/i),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=i;e++){const t=(i+1)*d+e-1,n=(i+1)*(d-1)+e-1,r=(i+1)*(d-1)+e,o=(i+1)*d+e;s.push(t,n,o),s.push(n,r,o)}this.setIndex(s),this.setAttribute("position",new Hi(o,3)),this.setAttribute("normal",new Hi(a,3)),this.setAttribute("uv",new Hi(l,2))}static fromJSON(e){return new Hc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Gc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new yn,h=new yn,d=new yn,p=new yn,f=new yn,g=new yn,m=new yn;for(let _=0;_<=n;++_){const o=_/n*r*Math.PI*2;v(o,r,s,e,d),v(o+.01,r,s,e,p),g.subVectors(p,d),m.addVectors(p,d),f.crossVectors(g,m),m.crossVectors(f,g),f.normalize(),m.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,s=-t*Math.cos(r),o=t*Math.sin(r);u.x=d.x+(s*m.x+o*f.x),u.y=d.y+(s*m.y+o*f.y),u.z=d.z+(s*m.z+o*f.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(_/n),c.push(e/i)}}for(let _=1;_<=n;_++)for(let e=1;e<=i;e++){const t=(i+1)*(_-1)+(e-1),n=(i+1)*_+(e-1),r=(i+1)*_+e,s=(i+1)*(_-1)+e;o.push(t,n,s),o.push(n,r,s)}function v(e,t,n,i,r){const s=Math.cos(e),o=Math.sin(e),a=n/t*e,l=Math.cos(a);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new Hi(a,3)),this.setAttribute("normal",new Hi(l,3)),this.setAttribute("uv",new Hi(c,2))}static fromJSON(e){return new Gc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Vc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hl(new yn(-1,-1,0),new yn(-1,1,0),new yn(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new yn,a=new yn,l=new Wt;let c=new yn;const u=[],h=[],d=[],p=[];function f(r){c=e.getPointAt(r/t,c);const l=s.normals[r],d=s.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+r*d.x,a.y=s*l.y+r*d.y,a.z=s*l.z+r*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,u.push(o.x,o.y,o.z)}}(function(){for(let e=0;e<t;e++)f(e);f(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;p.push(n,r,o),p.push(r,s,o)}}()})(),this.setIndex(p),this.setAttribute("position",new Hi(u,3)),this.setAttribute("normal",new Hi(h,3)),this.setAttribute("uv",new Hi(d,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Vc((new Vl[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Wc extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new yn,r=new yn;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let l=0;l<3;l++){const a=o.getX(e+l),c=o.getX(e+(l+1)%3);i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,c),!0===jc(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let a=0;a<3;a++){const o=3*e+a,l=3*e+(a+1)%3;i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,l),!0===jc(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Hi(t,3))}}}function jc(e,t,n){const i="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),r="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}var Xc=Object.freeze({__proto__:null,BoxGeometry:mr,BoxBufferGeometry:mr,CapsuleGeometry:Yl,CapsuleBufferGeometry:Yl,CircleGeometry:Kl,CircleBufferGeometry:Kl,ConeGeometry:Jl,ConeBufferGeometry:Jl,CylinderGeometry:ql,CylinderBufferGeometry:ql,DodecahedronGeometry:Ql,DodecahedronBufferGeometry:Ql,EdgesGeometry:rc,ExtrudeGeometry:Nc,ExtrudeBufferGeometry:Nc,IcosahedronGeometry:Pc,IcosahedronBufferGeometry:Pc,LatheGeometry:Xl,LatheBufferGeometry:Xl,OctahedronGeometry:$c,OctahedronBufferGeometry:$c,PlaneGeometry:Pr,PlaneBufferGeometry:Pr,PolyhedronGeometry:Zl,PolyhedronBufferGeometry:Zl,RingGeometry:Bc,RingBufferGeometry:Bc,ShapeGeometry:Fc,ShapeBufferGeometry:Fc,SphereGeometry:Uc,SphereBufferGeometry:Uc,TetrahedronGeometry:zc,TetrahedronBufferGeometry:zc,TorusGeometry:Hc,TorusBufferGeometry:Hc,TorusKnotGeometry:Gc,TorusKnotBufferGeometry:Gc,TubeGeometry:Vc,TubeBufferGeometry:Vc,WireframeGeometry:Wc});class Yc extends Di{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ln(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Kc extends yr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qc extends Di{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ln(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jc extends qc{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Wt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Bt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ln(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new ln(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ln(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Zc extends Di{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ln(16777215),this.specular=new ln(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Qc extends Di{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ln(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class eu extends Di{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class tu extends Di{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ln(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ln(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class nu extends Di{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ln(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iu extends ol{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function ru(e,t,n){return ou(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function su(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function ou(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function au(e){const t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n}function lu(e,t,n){const i=e.length,r=new e.constructor(i);for(let s=0,o=0;o!==i;++s){const i=n[s]*t;for(let n=0;n!==t;++n)r[o++]=e[i+n]}return r}function cu(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(t.push(s.time),n.push.apply(n,o)),s=e[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(t.push(s.time),o.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(t.push(s.time),n.push(o)),s=e[r++]}while(void 0!==s)}var uu=Object.freeze({__proto__:null,arraySlice:ru,convertArray:su,isTypedArray:ou,getKeyframeOrder:au,sortedArray:lu,flattenJSON:cu,subclip:function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const s=e.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const e=s.tracks[l],t=e.getValueSize(),a=[],c=[];for(let s=0;s<e.times.length;++s){const o=e.times[s]*r;if(!(o<n||o>=i)){a.push(e.times[s]);for(let n=0;n<t;++n)c.push(e.values[s*t+n])}}0!==a.length&&(e.times=su(a,e.times.constructor),e.values=su(c,e.values.constructor),o.push(e))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;i<=0&&(i=30);const r=n.tracks.length,s=t/i;for(let o=0;o<r;++o){const t=n.tracks[o],i=t.ValueTypeName;if("bool"===i||"string"===i)continue;const r=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===i}));if(void 0===r)continue;let a=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(s<=t.times[0]){const e=a,n=l-a;d=ru(t.values,e,n)}else if(s>=t.times[h]){const e=h*l+a,n=e+l-a;d=ru(t.values,e,n)}else{const e=t.createInterpolant(),n=a,i=l-a;e.evaluate(s),d=ru(e.resultBuffer,n,i)}"quaternion"===i&&(new bn).fromArray(d).normalize().conjugate().toArray(d);const p=r.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===i)bn.multiplyQuaternionsFlat(r.values,t,d,0,r.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)r.values[t+n]-=d[n]}}}return e.blendMode=_t,e}});class hu{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class du extends hu{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ft,endingEnd:ft}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case gt:r=e,o=2*t-n;break;case mt:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case gt:s=e,a=2*n-t;break;case mt:s=1,a=n+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,g=f*p,m=-h*g+2*h*f-h*p,v=(1+h)*g+(-1.5-2*h)*f+(-.5+h)*p+1,_=(-1-d)*g+(1.5+d)*f+.5*p,b=d*g-d*f;for(let y=0;y!==o;++y)r[y]=m*s[c+y]+v*s[l+y]+_*s[a+y]+b*s[u+y];return r}}class pu extends hu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),u=1-c;for(let h=0;h!==o;++h)r[h]=s[l+h]*u+s[a+h]*c;return r}}class fu extends hu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class gu{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=su(t,this.TimeBufferType),this.values=su(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:su(e.times,Array),values:su(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new fu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new du(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ht:t=this.InterpolantFactoryMethodDiscrete;break;case dt:t=this.InterpolantFactoryMethodLinear;break;case pt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ht;case this.InterpolantFactoryMethodLinear:return dt;case this.InterpolantFactoryMethodSmooth:return pt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=ru(n,r,s),this.values=ru(this.values,r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const t=n[o];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,s),e=!1;break}s=t}if(void 0!==i&&ou(i))for(let o=0,a=i.length;o!==a;++o){const t=i[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=ru(this.times),t=ru(this.values),n=this.getValueSize(),i=this.getInterpolation()===pt,r=e.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)r=!0;else{const e=o*n,i=e-n,s=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[s+o]){r=!0;break}}}if(r){if(o!==s){e[s]=e[o];const i=o*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,o=0;o!==n;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=ru(e,0,s),this.values=ru(t,0,s*n)):(this.times=e,this.values=t),this}clone(){const e=ru(this.times,0),t=ru(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}gu.prototype.TimeBufferType=Float32Array,gu.prototype.ValueBufferType=Float32Array,gu.prototype.DefaultInterpolation=dt;class mu extends gu{}mu.prototype.ValueTypeName="bool",mu.prototype.ValueBufferType=Array,mu.prototype.DefaultInterpolation=ht,mu.prototype.InterpolantFactoryMethodLinear=void 0,mu.prototype.InterpolantFactoryMethodSmooth=void 0;class vu extends gu{}vu.prototype.ValueTypeName="color";class _u extends gu{}_u.prototype.ValueTypeName="number";class bu extends hu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let c=l+o;l!==c;l+=4)bn.slerpFlat(r,0,s,l-o,s,l,a);return r}}class yu extends gu{InterpolantFactoryMethodLinear(e){return new bu(this.times,this.values,this.getValueSize(),e)}}yu.prototype.ValueTypeName="quaternion",yu.prototype.DefaultInterpolation=dt,yu.prototype.InterpolantFactoryMethodSmooth=void 0;class Tu extends gu{}Tu.prototype.ValueTypeName="string",Tu.prototype.ValueBufferType=Array,Tu.prototype.DefaultInterpolation=ht,Tu.prototype.InterpolantFactoryMethodLinear=void 0,Tu.prototype.InterpolantFactoryMethodSmooth=void 0;class Eu extends gu{}Eu.prototype.ValueTypeName="vector";class Su{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vt;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=$t(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,o=n.length;s!==o;++s)t.push(wu(n[s]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(gu.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,s=[];for(let o=0;o<r;o++){let e=[],a=[];e.push((o+r-1)%r,o,(o+1)%r),a.push(0,1,0);const l=au(e);e=lu(e,1,l),a=lu(a,1,l),!i&&0===e[0]&&(e.push(r),a.push(a[0])),s.push(new _u(".morphTargetInfluences["+t[o].name+"]",e,a).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=e.length;o<a;o++){const t=e[o],n=t.name.match(r);if(n&&n.length>1){const e=n[1];let r=i[e];r||(i[e]=r=[]),r.push(t)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const s=[],o=[];cu(n,s,o,i),0!==s.length&&r.push(new e(t,s,o))}},i=[],r=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let i=0;i<e[n].morphTargets.length;i++)t[e[n].morphTargets[i]]=-1;for(const r in t){const t=[],s=[];for(let i=0;i!==e[n].morphTargets.length;++i){const i=e[n];t.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new _u(".morphTargetInfluence["+r+"]",t,s))}a=t.length*s}else{const r=".bones["+t[c].name+"]";n(Eu,r+".position",e,"pos",i),n(yu,r+".quaternion",e,"rot",i),n(Eu,r+".scale",e,"scl",i)}}return 0===i.length?null:new this(r,a,i,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function wu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _u;case"vector":case"vector2":case"vector3":case"vector4":return Eu;case"color":return vu;case"quaternion":return yu;case"bool":case"boolean":return mu;case"string":return Tu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];cu(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const xu={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Mu{constructor(e,t,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const Iu=new Mu;class Cu{constructor(e){this.manager=void 0!==e?e:Iu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const ku={};class Ru extends Error{constructor(e,t){super(e),this.response=t}}class Au extends Cu{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=xu.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==ku[e])return void ku[e].push({onLoad:t,onProgress:n,onError:i});ku[e]=[],ku[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;const n=ku[e],i=t.body.getReader(),r=t.headers.get("Content-Length"),s=r?parseInt(r):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{a+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new Ru('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{xu.add(e,t);const n=ku[e];delete ku[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=ku[e];if(void 0===n)throw this.manager.itemError(e),t;delete ku[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Lu extends Cu{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=xu.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;const o=qt("img");function a(){c(),xu.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class Ou extends Ei{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new ln(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Nu extends Ou{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.groundColor=new ln(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Du=new Jn,Pu=new yn,$u=new yn;class Bu{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Wt(512,512),this.map=null,this.mapPass=null,this.matrix=new Jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Or,this._frameExtents=new Wt(1,1),this._viewportCount=1,this._viewports=[new gn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Pu.setFromMatrixPosition(e.matrixWorld),t.position.copy(Pu),$u.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($u),t.updateMatrixWorld(),Du.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Du),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fu extends Bu{constructor(){super(new Er(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Pt*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Uu extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.target=new Ei,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.shadow=new Fu}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const zu=new Jn,Hu=new yn,Gu=new yn;class Vu extends Bu{constructor(){super(new Er(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Wt(4,2),this._viewportCount=6,this._viewports=[new gn(2,1,1,1),new gn(0,1,1,1),new gn(3,1,1,1),new gn(1,1,1,1),new gn(3,0,1,1),new gn(1,0,1,1)],this._cubeDirections=[new yn(1,0,0),new yn(-1,0,0),new yn(0,0,1),new yn(0,0,-1),new yn(0,1,0),new yn(0,-1,0)],this._cubeUps=[new yn(0,1,0),new yn(0,1,0),new yn(0,1,0),new yn(0,1,0),new yn(0,0,1),new yn(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Hu.setFromMatrixPosition(e.matrixWorld),n.position.copy(Hu),Gu.copy(n.position),Gu.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Gu),n.updateMatrixWorld(),i.makeTranslation(-Hu.x,-Hu.y,-Hu.z),zu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zu)}}class Wu extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Vu}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ju extends Bu{constructor(){super(new jr(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Xu extends Ou{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ei.DefaultUp),this.updateMatrix(),this.target=new Ei,this.shadow=new ju}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Yu extends Ou{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ku extends Ou{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class qu{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new yn)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class Ju extends Ou{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qu;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Zu extends Cu{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new Au(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=Zu.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new ln).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new ln).setHex(t.value);break;case"v2":i.uniforms[r].value=(new Wt).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new yn).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new gn).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new jt).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new Jn).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new Wt).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Wt).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:Yc,SpriteMaterial:wa,RawShaderMaterial:Kc,ShaderMaterial:yr,PointsMaterial:vl,MeshPhysicalMaterial:Jc,MeshStandardMaterial:qc,MeshPhongMaterial:Zc,MeshToonMaterial:Qc,MeshNormalMaterial:eu,MeshLambertMaterial:tu,MeshDepthMaterial:ea,MeshDistanceMaterial:ta,MeshBasicMaterial:Pi,MeshMatcapMaterial:nu,LineDashedMaterial:iu,LineBasicMaterial:ol,Material:Di}[e]}}class Qu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class eh extends qi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class th extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Au(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers[t],r=new Uint32Array(i).buffer;return n[t]=r,r}(e,r.buffer),o=Kt(r.type,s),a=new Ta(o,r.stride);return a.uuid=r.uuid,t[i]=a,a}const r=e.isInstancedBufferGeometry?new eh:new qi,s=e.data.index;if(void 0!==s){const e=Kt(s.type,s.array);r.setIndex(new Fi(e,1))}const o=e.data.attributes;for(const u in o){const t=o[u];let n;if(t.isInterleavedBufferAttribute){const r=i(e.data,t.data);n=new Sa(r,t.itemSize,t.offset,t.normalized)}else{const e=Kt(t.type,t.array);n=new(t.isInstancedBufferAttribute?el:Fi)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),void 0!==t.updateRange&&(n.updateRange.offset=t.updateRange.offset,n.updateRange.count=t.updateRange.count),r.setAttribute(u,n)}const a=e.data.morphAttributes;if(a)for(const u in a){const t=a[u],n=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];let o;if(s.isInterleavedBufferAttribute){const t=i(e.data,s.data);o=new Sa(t,s.itemSize,s.offset,s.normalized)}else{const e=Kt(s.type,s.array);o=new Fi(e,s.itemSize,s.normalized)}void 0!==s.name&&(o.name=s.name),n.push(o)}r.morphAttributes[u]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];r.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new yn;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new Hn(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}const nh={UVMapping:te,CubeReflectionMapping:ne,CubeRefractionMapping:ie,EquirectangularReflectionMapping:re,EquirectangularRefractionMapping:se,CubeUVReflectionMapping:oe},ih={RepeatWrapping:ae,ClampToEdgeWrapping:le,MirroredRepeatWrapping:ce},rh={NearestFilter:ue,NearestMipmapNearestFilter:he,NearestMipmapLinearFilter:de,LinearFilter:pe,LinearMipmapNearestFilter:fe,LinearMipmapLinearFilter:ge};let sh;const oh={getContext:function(){return void 0===sh&&(sh=new(window.AudioContext||window.webkitAudioContext)),sh},setContext:function(e){sh=e}};const ah=new Jn,lh=new Jn,ch=new Jn;class uh{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=hh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=hh();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function hh(){return(typeof performance>"u"?Date:performance).now()}const dh=new yn,ph=new bn,fh=new yn,gh=new yn;class mh extends Ei{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const vh=new yn,_h=new bn,bh=new yn,yh=new yn;class Th{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let a=t,l=t+t;a!==l;++a)if(n[a]!==n[a+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){bn.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const s=this._workIndex*r;bn.multiplyQuaternionsFlat(e,s,e,t,e,n),bn.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const r=t+o;e[r]=e[r]*s+e[n+o]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){const r=t+s;e[r]=e[r]+e[n+s]*i}}}const Eh="\\[\\]\\.:\\/",Sh=new RegExp("["+Eh+"]","g"),wh="[^"+Eh+"]",xh="[^"+Eh.replace("\\.","")+"]",Mh=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wh)+/(WCOD+)?/.source.replace("WCOD",xh)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wh)+"$"),Ih=["material","materials","bones"];class Ch{constructor(e,t,n){this.path=t,this.parsedPath=n||Ch.parseTrackName(t),this.node=Ch.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ch.Composite(e,t,n):new Ch(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Sh,"")}static parseTrackName(e){const t=Mh.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==Ih.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=Ch.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ch.Composite=class{constructor(e,t,n){const i=n||Ch.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Ch.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ch.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ch.prototype.GetterByBindingType=[Ch.prototype._getValue_direct,Ch.prototype._getValue_array,Ch.prototype._getValue_arrayElement,Ch.prototype._getValue_toArray],Ch.prototype.SetterByBindingTypeAndVersioning=[[Ch.prototype._setValue_direct,Ch.prototype._setValue_direct_setNeedsUpdate,Ch.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ch.prototype._setValue_array,Ch.prototype._setValue_array_setNeedsUpdate,Ch.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ch.prototype._setValue_arrayElement,Ch.prototype._setValue_arrayElement_setNeedsUpdate,Ch.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ch.prototype._setValue_fromArray,Ch.prototype._setValue_fromArray_setNeedsUpdate,Ch.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class kh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,s=r.length,o=new Array(s),a={endingStart:ft,endingEnd:ft};for(let l=0;l!==s;++l){const e=r[l].createInterpolant(null);o[l]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===_t)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(o);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const s=2202===n;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=gt,i.endingEnd=gt):(i.endingStart=e?this.zeroSlopeAtStart?gt:ft:mt,i.endingEnd=t?this.zeroSlopeAtEnd?gt:ft:mt)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=t,o[1]=r+e,a[1]=n,this}}const Rh=new Float32Array(1);class Ah{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Ah(void 0===this.value.clone?this.value:this.value.clone())}}let Lh=0;class Oh extends Ta{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new qn(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new li,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Ph(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(Dh),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)Ph(e[i],this,n,t);return n.sort(Dh),n}}function Dh(e,t){return e.distance-t.distance}function Ph(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)Ph(i[e],t,n,!0)}}class $h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Bt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Bh=new Wt;const Fh=new yn,Uh=new yn;class zh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Fh.subVectors(e,this.start),Uh.subVectors(this.end,this.start);const n=Uh.dot(Uh);let i=Uh.dot(Fh)/n;return t&&(i=Bt(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Hh=new yn;const Gh=new yn,Vh=new Jn,Wh=new Jn;function jh(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,jh(e.children[n]));return t}const Xh=new yn,Yh=new ln,Kh=new ln;const qh=new yn,Jh=new yn,Zh=new yn;const Qh=new yn,ed=new Tr;function td(e,t,n,i,r,s,o){Qh.set(r,s,o).unproject(i);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],Qh.x,Qh.y,Qh.z)}}const nd=new Sn;const id=new yn;let rd,sd;const od=ad();function ad(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var ld=Object.freeze({__proto__:null,toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Bt(e,-65504,65504),od.floatView[0]=e;const t=od.uint32View[0],n=t>>23&511;return od.baseTable[n]+((8388607&t)>>od.shiftTable[n])},fromHalfFloat:function(e){const t=e>>10;return od.uint32View[0]=od.mantissaTable[od.offsetTable[t]+(1023&e)]+od.exponentTable[t],od.floatView[0]}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r);const cd=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Q,AddEquation:E,AddOperation:Y,AdditiveAnimationBlendMode:_t,AdditiveBlending:_,AlphaFormat:Ie,AlwaysDepth:F,AlwaysStencilFunc:519,AmbientLight:Yu,AmbientLightProbe:class extends Ju{constructor(e){super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isAmbientLightProbe=!0;const t=(new ln).set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}},AnimationClip:Su,AnimationLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Au(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Su.parse(e[n]);t.push(i)}return t}},AnimationMixer:class extends Lt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,o=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==r;++u){const e=i[u],r=e.name;let l=c[r];if(void 0!==l)++l.referenceCount,s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,r));continue}const i=t&&t._propertyBindings[u].binding.parsedPath;l=new Th(Ch.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,r),s[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[r],0===Object.keys(o).length&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new pu(new Float32Array(2),new Float32Array(2),1,Rh),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let s="string"==typeof e?Su.findByName(i,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:vt),void 0!==a){const e=a.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new kh(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(e,t){const n=t||this._root,i=n.uuid,r="string"==typeof e?Su.findByName(n,e):e,s=r?r.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(i,e,r,s);const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const r in n){const e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const r in i){const e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},AnimationObjectGroup:class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=$t(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=s;e!==t;++e)r[e].push(new Ch(u,n[e],i[e]))}else if(d<l){o=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=s;e!==t;++e){const t=r[e],s=t[a];let o=t[d];t[d]=s,void 0===o&&(o=new Ch(u,n[e],i[e])),t[a]=o}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=t[a];if(void 0!==l&&l>=r){const s=r++,c=e[s];t[c.uuid]=l,e[l]=c,t[a]=s,e[s]=o;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[s],r=t[l];t[l]=i,t[s]=r}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<r){const o=--r,a=e[o],c=--s,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],r=t[c];t[l]=i,t[o]=r,t.pop()}}else{const r=--s,o=e[r];r>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[e]=i,s.push(e),o.push(t),r.push(u);for(let h=c,d=a.length;h!==d;++h){const n=a[h];u[h]=new Ch(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];t[e[o]]=n,s[n]=a,s.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}},AnimationUtils:uu,ArcCurve:Il,ArrayCamera:la,ArrowHelper:class extends Ei{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yn(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*r;super(),this.type="ArrowHelper",void 0===rd&&(rd=new qi,rd.setAttribute("position",new Hi([0,0,0,0,1,0],3)),sd=new ql(0,.5,1,5,1),sd.translate(0,-.5,0)),this.position.copy(t),this.line=new dl(rd,new ol({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fr(sd,new Pi({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{id.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(id,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}},Audio:mh,AudioAnalyser:class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},AudioContext:oh,AudioListener:class extends Ei{constructor(){super(),this.type="AudioListener",this.context=oh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uh}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dh,ph,fh),gh.set(0,0,-1).applyQuaternion(ph),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(dh.x,e),t.positionY.linearRampToValueAtTime(dh.y,e),t.positionZ.linearRampToValueAtTime(dh.z,e),t.forwardX.linearRampToValueAtTime(gh.x,e),t.forwardY.linearRampToValueAtTime(gh.y,e),t.forwardZ.linearRampToValueAtTime(gh.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(dh.x,dh.y,dh.z),t.setOrientation(gh.x,gh.y,gh.z,n.x,n.y,n.z)}},AudioLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Au(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{const e=n.slice(0);oh.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}},AxesHelper:class extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new qi;n.setAttribute("position",new Hi(t,3)),n.setAttribute("color",new Hi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new ol({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new ln,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BackSide:f,BasicDepthPacking:Tt,BasicShadowMap:0,Bone:Ka,BooleanKeyframeTrack:mu,Box2:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Bh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Bh.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Box3:Sn,Box3Helper:class extends gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new qi;i.setIndex(new Fi(n,1)),i.setAttribute("position",new Hi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new ol({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}},BoxBufferGeometry:mr,BoxGeometry:mr,BoxHelper:class extends gl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new qi;r.setIndex(new Fi(n,1)),r.setAttribute("position",new Fi(i,3)),super(r,new ol({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&nd.setFromObject(this.object),nd.isEmpty())return;const t=nd.min,n=nd.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}},BufferAttribute:Fi,BufferGeometry:qi,BufferGeometryLoader:th,ByteType:ve,Cache:xu,Camera:Tr,CameraHelper:class extends gl{constructor(e){const t=new qi,n=new ol({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function o(e,t){a(e),a(t)}function a(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new Hi(i,3)),t.setAttribute("color",new Hi(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new ln(16755200),c=new ln(16711680),u=new ln(43775),h=new ln(16777215),d=new ln(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,i,r){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;ed.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),td("c",t,e,ed,0,0,-1),td("t",t,e,ed,0,0,1),td("n1",t,e,ed,-1,-1,-1),td("n2",t,e,ed,1,-1,-1),td("n3",t,e,ed,-1,1,-1),td("n4",t,e,ed,1,1,-1),td("f1",t,e,ed,-1,-1,1),td("f2",t,e,ed,1,-1,1),td("f3",t,e,ed,-1,1,1),td("f4",t,e,ed,1,1,1),td("u1",t,e,ed,.7,1.1,-1),td("u2",t,e,ed,-.7,1.1,-1),td("u3",t,e,ed,0,2,-1),td("cf1",t,e,ed,-1,0,1),td("cf2",t,e,ed,1,0,1),td("cf3",t,e,ed,0,-1,1),td("cf4",t,e,ed,0,1,1),td("cn1",t,e,ed,-1,0,-1),td("cn2",t,e,ed,1,0,-1),td("cn3",t,e,ed,0,-1,-1),td("cn4",t,e,ed,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},CanvasTexture:class extends fn{constructor(e,t,n,i,r,s,o,a,l){super(e,t,n,i,r,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},CapsuleBufferGeometry:Yl,CapsuleGeometry:Yl,CatmullRomCurve3:Ol,CineonToneMapping:Z,CircleBufferGeometry:Kl,CircleGeometry:Kl,ClampToEdgeWrapping:le,Clock:uh,Color:ln,ColorKeyframeTrack:vu,ColorManagement:en,CompressedTexture:wl,CompressedTextureLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=[],o=new wl,a=new Au(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=r.parse(e,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=pe),o.image=s,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else a.load(e,(function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)s[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),s[t].format=n.format,s[t].width=n.width,s[t].height=n.height}o.image=s}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=pe),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}},ConeBufferGeometry:Jl,ConeGeometry:Jl,CubeCamera:wr,CubeReflectionMapping:ne,CubeRefractionMapping:ie,CubeTexture:xr,CubeTextureLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=new xr,s=new Lu(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(e[n],(function(e){r.images[n]=e,o++,6===o&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(let l=0;l<e.length;++l)a(l);return r}},CubeUVReflectionMapping:oe,CubicBezierCurve:$l,CubicBezierCurve3:Bl,CubicInterpolant:du,CullFaceBack:l,CullFaceFront:c,CullFaceFrontBack:3,CullFaceNone:a,Curve:xl,CurvePath:Wl,CustomBlending:T,CustomToneMapping:ee,CylinderBufferGeometry:ql,CylinderGeometry:ql,Cylindrical:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}},Data3DTexture:_n,DataArrayTexture:vn,DataTexture:qa,DataTexture2DArray:class extends vn{constructor(e,t,n,i){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,i)}},DataTexture3D:class extends _n{constructor(e,t,n,i){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,i)}},DataTextureLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new qa,o=new Au(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(e,(function(e){const n=r.parse(e);!n||(void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:le,s.wrapT=void 0!==n.wrapT?n.wrapT:le,s.magFilter=void 0!==n.magFilter?n.magFilter:pe,s.minFilter=void 0!==n.minFilter?n.minFilter:pe,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(s.encoding=n.encoding),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=ge),1===n.mipmapCount&&(s.minFilter=pe),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,t&&t(s,n))}),n,i),s}},DataUtils:ld,DecrementStencilOp:7683,DecrementWrapStencilOp:34056,DefaultLoadingManager:Iu,DepthFormat:Le,DepthStencilFormat:Oe,DepthTexture:da,DirectionalLight:Xu,DirectionalLightHelper:class extends Ei{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let i=new qi;i.setAttribute("position",new Hi([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new ol({fog:!1,toneMapped:!1});this.lightPlane=new dl(i,r),this.add(this.lightPlane),i=new qi,i.setAttribute("position",new Hi([0,0,0,0,0,1],3)),this.targetLine=new dl(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){qh.setFromMatrixPosition(this.light.matrixWorld),Jh.setFromMatrixPosition(this.light.target.matrixWorld),Zh.subVectors(Jh,qh),this.lightPlane.lookAt(Jh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Jh),this.targetLine.scale.z=Zh.length()}},DiscreteInterpolant:fu,DodecahedronBufferGeometry:Ql,DodecahedronGeometry:Ql,DoubleSide:g,DstAlphaFactor:O,DstColorFactor:D,DynamicCopyUsage:35050,DynamicDrawUsage:kt,DynamicReadUsage:35049,EdgesGeometry:rc,EllipseCurve:Ml,EqualDepth:H,EqualStencilFunc:514,EquirectangularReflectionMapping:re,EquirectangularRefractionMapping:se,Euler:ai,EventDispatcher:Lt,ExtrudeBufferGeometry:Nc,ExtrudeGeometry:Nc,FileLoader:Au,FlatShading:1,Float16BufferAttribute:class extends Fi{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}},Float32BufferAttribute:Hi,Float64BufferAttribute:class extends Fi{constructor(e,t,n){super(new Float64Array(e),t,n)}},FloatType:Ee,Fog:ba,FogExp2:_a,Font:function(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")},FontLoader:function(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")},FramebufferTexture:class extends fn{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=ue,this.minFilter=ue,this.generateMipmaps=!1,this.needsUpdate=!0}},FrontSide:p,Frustum:Or,GLBufferAttribute:class{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},GLSL1:"100",GLSL3:Rt,GreaterDepth:V,GreaterEqualDepth:G,GreaterEqualStencilFunc:518,GreaterStencilFunc:516,GridHelper:class extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new ln(n),i=new ln(i);const r=t/2,s=e/t,o=e/2,a=[],l=[];for(let u=0,h=0,d=-o;u<=t;u++,d+=s){a.push(-o,0,d,o,0,d),a.push(d,0,-o,d,0,o);const e=u===r?n:i;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new qi;c.setAttribute("position",new Hi(a,3)),c.setAttribute("color",new Hi(l,3));super(c,new ol({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}},Group:ca,HalfFloatType:Se,HemisphereLight:Nu,HemisphereLightHelper:class extends Ei{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new $c(t);i.rotateY(.5*Math.PI),this.material=new Pi({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new Fi(s,3)),this.add(new fr(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Yh.copy(this.light.color),Kh.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?Yh:Kh;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Xh.setFromMatrixPosition(this.light.matrixWorld).negate())}},HemisphereLightProbe:class extends Ju{constructor(e,t){super(void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),this.isHemisphereLightProbe=!0;const n=(new ln).set(e),i=(new ln).set(t),r=new yn(n.r,n.g,n.b),s=new yn(i.r,i.g,i.b),o=Math.sqrt(Math.PI),a=o*Math.sqrt(.75);this.sh.coefficients[0].copy(r).add(s).multiplyScalar(o),this.sh.coefficients[1].copy(r).sub(s).multiplyScalar(a)}},IcosahedronBufferGeometry:Pc,IcosahedronGeometry:Pc,ImageBitmapLoader:class extends Cu{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=xu.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){xu.add(e,n),t&&t(n),r.manager.itemEnd(e)})).catch((function(t){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}},ImageLoader:Lu,ImageUtils:un,ImmediateRenderObject:function(){console.error("THREE.ImmediateRenderObject has been removed.")},IncrementStencilOp:7682,IncrementWrapStencilOp:34055,InstancedBufferAttribute:el,InstancedBufferGeometry:eh,InstancedInterleavedBuffer:Oh,InstancedMesh:sl,Int16BufferAttribute:class extends Fi{constructor(e,t,n){super(new Int16Array(e),t,n)}},Int32BufferAttribute:class extends Fi{constructor(e,t,n){super(new Int32Array(e),t,n)}},Int8BufferAttribute:class extends Fi{constructor(e,t,n){super(new Int8Array(e),t,n)}},IntType:ye,InterleavedBuffer:Ta,InterleavedBufferAttribute:Sa,Interpolant:hu,InterpolateDiscrete:ht,InterpolateLinear:dt,InterpolateSmooth:pt,InvertStencilOp:5386,KeepStencilOp:It,KeyframeTrack:gu,LOD:Ha,LatheBufferGeometry:Xl,LatheGeometry:Xl,Layers:li,LessDepth:U,LessEqualDepth:z,LessEqualStencilFunc:515,LessStencilFunc:513,Light:Ou,LightProbe:Ju,Line:dl,Line3:zh,LineBasicMaterial:ol,LineCurve:Fl,LineCurve3:Ul,LineDashedMaterial:iu,LineLoop:ml,LineSegments:gl,LinearEncoding:bt,LinearFilter:pe,LinearInterpolant:pu,LinearMipMapLinearFilter:1008,LinearMipMapNearestFilter:1007,LinearMipmapLinearFilter:ge,LinearMipmapNearestFilter:fe,LinearSRGBColorSpace:Mt,LinearToneMapping:q,Loader:Cu,LoaderUtils:Qu,LoadingManager:Mu,LoopOnce:2200,LoopPingPong:2202,LoopRepeat:2201,LuminanceAlphaFormat:Ae,LuminanceFormat:Re,MOUSE:s,Material:Di,MaterialLoader:Zu,MathUtils:Vt,Matrix3:jt,Matrix4:Jn,MaxEquation:M,Mesh:fr,MeshBasicMaterial:Pi,MeshDepthMaterial:ea,MeshDistanceMaterial:ta,MeshLambertMaterial:tu,MeshMatcapMaterial:nu,MeshNormalMaterial:eu,MeshPhongMaterial:Zc,MeshPhysicalMaterial:Jc,MeshStandardMaterial:qc,MeshToonMaterial:Qc,MinEquation:x,MirroredRepeatWrapping:ce,MixOperation:X,MultiplyBlending:y,MultiplyOperation:j,NearestFilter:ue,NearestMipMapLinearFilter:1005,NearestMipMapNearestFilter:1004,NearestMipmapLinearFilter:de,NearestMipmapNearestFilter:he,NeverDepth:B,NeverStencilFunc:512,NoBlending:m,NoColorSpace:"",NoToneMapping:K,NormalAnimationBlendMode:vt,NormalBlending:v,NotEqualDepth:W,NotEqualStencilFunc:517,NumberKeyframeTrack:_u,Object3D:Ei,ObjectLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=this,s=""===this.path?Qu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new Au(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){let s=null;try{s=JSON.parse(n)}catch(a){return void 0!==i&&i(a),void console.error("THREE:ObjectLoader: Can't parse "+e+".",a.message)}const o=s.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(s,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,i)}async loadAsync(e,t){const n=""===this.path?Qu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new Au(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(e,t),s=JSON.parse(r),o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,i,o,s,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new sc).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let r=0,s=e.length;r<s;r++){const t=(new Qa).fromJSON(e[r],i);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const i=new th;for(let r=0,s=e.length;r<s;r++){let s;const o=e[r];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(o);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:o.type in Xc?s=Xc[o.type].fromJSON(o,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(o.type,'"'))}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),n[o.uuid]=s}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const r=new Zu;r.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];if("MultiMaterial"===s.type){const e=[];for(let t=0;t<s.materials.length;t++){const i=s.materials[t];void 0===n[i.uuid]&&(n[i.uuid]=r.parse(i)),e.push(n[i.uuid])}i[s.uuid]=e}else void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],r=Su.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function s(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),r.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:Kt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Mu(t);r=new Lu(n),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const n=e[t],r=n.url;if(Array.isArray(r)){const e=[];for(let t=0,n=r.length;t<n;t++){const n=s(r[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new qa(n.data,n.width,n.height)))}i[n.uuid]=new hn(e)}else{const e=s(n.url);i[n.uuid]=new hn(e)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(e){if("string"==typeof e){const n=e,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await i.loadAsync(r)}return e.data?{data:Kt(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new Lu(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t],i=await r(n);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new qa(i.data,i.width,i.height)))}n[i.uuid]=new hn(e)}else{const e=await r(i.url);n[i.uuid]=new hn(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,s=e.length;r<s;r++){const s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const o=t[s.image],a=o.data;let l;Array.isArray(a)?(l=new xr,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new qa:new fn,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,nh)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],ih),l.wrapT=n(s.wrap[1],ih)),void 0!==s.format&&(l.format=s.format),void 0!==s.type&&(l.type=s.type),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,rh)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,rh)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(e,t,n,i,r){let s,o,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":s=new ya,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new ln(e.background):s.background=u(e.background)),void 0!==e.environment&&(s.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new ba(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new _a(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new Er(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new jr(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new Yu(e.color,e.intensity);break;case"DirectionalLight":s=new Xu(e.color,e.intensity);break;case"PointLight":s=new Wu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Ku(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Uu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Nu(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new Ju).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),s=new Ya(o,a),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),s=new fr(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;s=new sl(o,a,t),s.instanceMatrix=new el(new Float32Array(n.array),16),void 0!==i&&(s.instanceColor=new el(new Float32Array(i.array),i.itemSize));break;case"LOD":s=new Ha;break;case"Line":s=new dl(l(e.geometry),c(e.material));break;case"LineLoop":s=new ml(l(e.geometry),c(e.material));break;case"LineSegments":s=new gl(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new El(l(e.geometry),c(e.material));break;case"Sprite":s=new Ba(c(e.material));break;case"Group":s=new ca;break;case"Bone":s=new Ka;break;default:s=new Ei}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)s.add(this.parseObject(o[e],t,n,i,r))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];s.animations.push(r[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=s.getObjectByProperty("uuid",n.object);void 0!==i&&s.addLevel(i,n.distance)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},ObjectSpaceNormalMap:wt,OctahedronBufferGeometry:$c,OctahedronGeometry:$c,OneFactor:C,OneMinusDstAlphaFactor:N,OneMinusDstColorFactor:P,OneMinusSrcAlphaFactor:L,OneMinusSrcColorFactor:R,OrthographicCamera:jr,PCFShadowMap:u,PCFSoftShadowMap:h,PMREMGenerator:ts,ParametricGeometry:class extends qi{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}},Path:jl,PerspectiveCamera:Er,Plane:Rr,PlaneBufferGeometry:Pr,PlaneGeometry:Pr,PlaneHelper:class extends dl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,i=new qi;i.setAttribute("position",new Hi([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new ol({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const r=new qi;r.setAttribute("position",new Hi([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new fr(r,new Pi({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}},PointLight:Wu,PointLightHelper:class extends fr{constructor(e,t,n){super(new Uc(t,4,2),new Pi({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Points:El,PointsMaterial:vl,PolarGridHelper:class extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;r=new ln(r),s=new ln(s);const o=[],a=[];for(let c=0;c<=t;c++){const n=c/t*(2*Math.PI),i=Math.sin(n)*e,l=Math.cos(n)*e;o.push(0,0,0),o.push(i,0,l);const u=1&c?r:s;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let c=0;c<=n;c++){const t=1&c?r:s,l=e-e/n*c;for(let e=0;e<i;e++){let n=e/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l;o.push(r,0,s),a.push(t.r,t.g,t.b),n=(e+1)/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l,o.push(r,0,s),a.push(t.r,t.g,t.b)}}const l=new qi;l.setAttribute("position",new Hi(o,3)),l.setAttribute("color",new Hi(a,3));super(l,new ol({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}},PolyhedronBufferGeometry:Zl,PolyhedronGeometry:Zl,PositionalAudio:class extends mh{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(vh,_h,bh),yh.set(0,0,1).applyQuaternion(_h);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(vh.x,e),t.positionY.linearRampToValueAtTime(vh.y,e),t.positionZ.linearRampToValueAtTime(vh.z,e),t.orientationX.linearRampToValueAtTime(yh.x,e),t.orientationY.linearRampToValueAtTime(yh.y,e),t.orientationZ.linearRampToValueAtTime(yh.z,e)}else t.setPosition(vh.x,vh.y,vh.z),t.setOrientation(yh.x,yh.y,yh.z)}},PropertyBinding:Ch,PropertyMixer:Th,QuadraticBezierCurve:zl,QuadraticBezierCurve3:Hl,Quaternion:bn,QuaternionKeyframeTrack:yu,QuaternionLinearInterpolant:bu,REVISION:r,RGBADepthPacking:Et,RGBAFormat:ke,RGBAIntegerFormat:Be,RGBA_ASTC_10x10_Format:at,RGBA_ASTC_10x5_Format:rt,RGBA_ASTC_10x6_Format:st,RGBA_ASTC_10x8_Format:ot,RGBA_ASTC_12x10_Format:lt,RGBA_ASTC_12x12_Format:ct,RGBA_ASTC_4x4_Format:qe,RGBA_ASTC_5x4_Format:Je,RGBA_ASTC_5x5_Format:Ze,RGBA_ASTC_6x5_Format:Qe,RGBA_ASTC_6x6_Format:et,RGBA_ASTC_8x5_Format:tt,RGBA_ASTC_8x6_Format:nt,RGBA_ASTC_8x8_Format:it,RGBA_BPTC_Format:ut,RGBA_ETC2_EAC_Format:Ke,RGBA_PVRTC_2BPPV1_Format:je,RGBA_PVRTC_4BPPV1_Format:We,RGBA_S3TC_DXT1_Format:Ue,RGBA_S3TC_DXT3_Format:ze,RGBA_S3TC_DXT5_Format:He,RGBFormat:Ce,RGB_ETC1_Format:Xe,RGB_ETC2_Format:Ye,RGB_PVRTC_2BPPV1_Format:Ve,RGB_PVRTC_4BPPV1_Format:Ge,RGB_S3TC_DXT1_Format:Fe,RGFormat:Pe,RGIntegerFormat:$e,RawShaderMaterial:Kc,Ray:qn,Raycaster:Nh,RectAreaLight:Ku,RedFormat:Ne,RedIntegerFormat:De,ReinhardToneMapping:J,RepeatWrapping:ae,ReplaceStencilOp:7681,ReverseSubtractEquation:w,RingBufferGeometry:Bc,RingGeometry:Bc,SRGBColorSpace:xt,Scene:ya,ShaderChunk:$r,ShaderLib:Fr,ShaderMaterial:yr,ShadowMaterial:Yc,Shape:sc,ShapeBufferGeometry:Fc,ShapeGeometry:Fc,ShapePath:class{constructor(){this.type="ShapePath",this.color=new ln,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new jl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new sc;r.curves=i.curves,t.push(r)}return t}function i(e,t){const n=t.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=t[r],o=t[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],a=-a,o=t[r],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const r=Ac.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===t)return n(s);let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new sc,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],d=[];let p,f,g=[],m=0;d[m]=void 0,g[m]=[];for(let v=0,_=s.length;v<_;v++)a=s[v],p=a.getPoints(),o=r(p),o=e?!o:o,o?(!u&&d[m]&&m++,d[m]={s:new sc,p:p},d[m].s.curves=a.curves,u&&m++,g[m]=[]):g[m].push({h:a,p:p[0]});if(!d[0])return n(s);if(d.length>1){let e=!1,t=0;for(let n=0,i=d.length;n<i;n++)h[n]=[];for(let n=0,r=d.length;n<r;n++){const r=g[n];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<d.length;r++)i(o.p,d[r].p)&&(n!==r&&t++,a?(a=!1,h[r].push(o)):e=!0);a&&h[n].push(o)}}t>0&&!1===e&&(g=h)}for(let v=0,_=d.length;v<_;v++){l=d[v].s,c.push(l),f=g[v];for(let e=0,t=f.length;e<t;e++)l.holes.push(f[e].h)}return c}},ShapeUtils:Ac,ShortType:_e,Skeleton:Qa,SkeletonHelper:class extends gl{constructor(e){const t=jh(e),n=new qi,i=[],r=[],s=new ln(0,0,1),o=new ln(0,1,0);for(let a=0;a<t.length;a++){const e=t[a];e.parent&&e.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Hi(i,3)),n.setAttribute("color",new Hi(r,3));super(n,new ol({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Wh.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const e=t[r];e.parent&&e.parent.isBone&&(Vh.multiplyMatrices(Wh,e.matrixWorld),Gh.setFromMatrixPosition(Vh),i.setXYZ(s,Gh.x,Gh.y,Gh.z),Vh.multiplyMatrices(Wh,e.parent.matrixWorld),Gh.setFromMatrixPosition(Vh),i.setXYZ(s+1,Gh.x,Gh.y,Gh.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}},SkinnedMesh:Ya,SmoothShading:2,Source:hn,Sphere:Hn,SphereBufferGeometry:Uc,SphereGeometry:Uc,Spherical:$h,SphericalHarmonics3:qu,SplineCurve:Gl,SpotLight:Uu,SpotLightHelper:class extends Ei{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new qi,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){const e=s/a*Math.PI*2,t=o/a*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new Hi(i,3));const r=new ol({fog:!1,toneMapped:!1});this.cone=new gl(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Hh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Sprite:Ba,SpriteMaterial:wa,SrcAlphaFactor:A,SrcAlphaSaturateFactor:$,SrcColorFactor:k,StaticCopyUsage:35046,StaticDrawUsage:Ct,StaticReadUsage:35045,StereoCamera:class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Er,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Er,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,ch.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(Dt*t.fov*.5)/t.zoom;let s,o;lh.elements[12]=-n,ah.elements[12]=n,s=-r*t.aspect+i,o=r*t.aspect+i,ch.elements[0]=2*t.near/(o-s),ch.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(ch),s=-r*t.aspect-i,o=r*t.aspect-i,ch.elements[0]=2*t.near/(o-s),ch.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(ch)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ah)}},StreamCopyUsage:35042,StreamDrawUsage:35040,StreamReadUsage:35041,StringKeyframeTrack:Tu,SubtractEquation:S,SubtractiveBlending:b,TOUCH:o,TangentSpaceNormalMap:St,TetrahedronBufferGeometry:zc,TetrahedronGeometry:zc,TextGeometry:class extends qi{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}},Texture:fn,TextureLoader:class extends Cu{constructor(e){super(e)}load(e,t,n,i){const r=new fn,s=new Lu(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}},TorusBufferGeometry:Hc,TorusGeometry:Hc,TorusKnotBufferGeometry:Gc,TorusKnotGeometry:Gc,Triangle:Oi,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:0,TubeBufferGeometry:Vc,TubeGeometry:Vc,UVMapping:te,Uint16BufferAttribute:Ui,Uint32BufferAttribute:zi,Uint8BufferAttribute:class extends Fi{constructor(e,t,n){super(new Uint8Array(e),t,n)}},Uint8ClampedBufferAttribute:class extends Fi{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},Uniform:Ah,UniformsGroup:class extends Lt{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Lh++}),this.name="",this.usage=Ct,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++)this.uniforms.push(t[n].clone());return this}clone(){return(new this.constructor).copy(this)}},UniformsLib:Br,UniformsUtils:br,UnsignedByteType:me,UnsignedInt248Type:Me,UnsignedIntType:Te,UnsignedShort4444Type:we,UnsignedShort5551Type:xe,UnsignedShortType:be,VSMShadowMap:d,Vector2:Wt,Vector3:yn,Vector4:gn,VectorKeyframeTrack:Eu,VideoTexture:class extends fn{constructor(e,t,n,i,r,s,o,a,l){super(e,t,n,i,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:pe,this.magFilter=void 0!==r?r:pe,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},WebGL1Renderer:va,WebGL3DRenderTarget:class extends mn{constructor(e,t,n){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new _n(null,e,t,n),this.texture.isRenderTargetTexture=!0}},WebGLArrayRenderTarget:class extends mn{constructor(e,t,n){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new vn(null,e,t,n),this.texture.isRenderTargetTexture=!0}},WebGLCubeRenderTarget:Mr,WebGLMultipleRenderTargets:class extends mn{constructor(e,t,n){super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;const i=this.texture;this.texture=[];for(let r=0;r<n;r++)this.texture[r]=i.clone(),this.texture[r].isRenderTargetTexture=!0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},WebGLMultisampleRenderTarget:class extends mn{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}},WebGLRenderTarget:mn,WebGLRenderer:ma,WebGLUtils:aa,WireframeGeometry:Wc,WrapAroundEnding:mt,ZeroCurvatureEnding:ft,ZeroFactor:I,ZeroSlopeEnding:gt,ZeroStencilOp:0,_SRGBAFormat:At,sRGBEncoding:yt},Symbol.toStringTag,{value:"Module"}));var ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof __webpack_require__.g<"u"?__webpack_require__.g:typeof self<"u"?self:{};function hd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dd,pd={exports:{}},fd={};function gd(e){let t;const n=new Set,i=(e,i)=>{const r="function"==typeof e?e(t):e;if(r!==t){const e=t;t=i?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,subscribe:(e,i,s)=>i||s?function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=i(t);function a(){const n=i(t);if(!s(o,n)){const t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)}(e,i,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,s),s}pd.exports=(dd||(dd=1,fd.ConcurrentRoot=1,fd.ContinuousEventPriority=4,fd.DefaultEventPriority=16,fd.DiscreteEventPriority=1,fd.IdleEventPriority=536870912,fd.LegacyRoot=0),fd);const md=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?e.useEffect:e.useLayoutEffect;var vd,_d={exports:{}},bd={exports:{}},yd={};var Td,Ed;function Sd(){return Ed||(Ed=1,Td=function(t){var n={},i=e,r=bd.exports,s=Object.assign;function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),T=Symbol.iterator;function E(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=T&&e[T]||e["@@iterator"])?e:null}function S(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case h:return"StrictMode";case m:return"Suspense";case v:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case f:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case g:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:S(e.type)||"Memo";case b:t=e._payload,e=e._init;try{return S(e(t))}catch{}}return null}function w(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S(t);case 8:return t===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function x(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function M(e){if(x(e)!==e)throw Error(o(188))}function I(e){var t=e.alternate;if(!t){if(null===(t=x(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return M(r),e;if(s===i)return M(r),t;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}function C(e){return null!==(e=I(e))?k(e):null}function k(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=k(e);if(null!==t)return t;e=e.sibling}return null}function R(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=R(e);if(null!==t)return t}e=e.sibling}return null}var A,L=Array.isArray,O=t.getPublicInstance,N=t.getRootHostContext,D=t.getChildHostContext,P=t.prepareForCommit,$=t.resetAfterCommit,B=t.createInstance,F=t.appendInitialChild,U=t.finalizeInitialChildren,z=t.prepareUpdate,H=t.shouldSetTextContent,G=t.createTextInstance,V=t.scheduleTimeout,W=t.cancelTimeout,j=t.noTimeout,X=t.isPrimaryRenderer,Y=t.supportsMutation,K=t.supportsPersistence,q=t.supportsHydration,J=t.getInstanceFromNode,Z=t.preparePortalMount,Q=t.getCurrentEventPriority,ee=t.detachDeletedInstance,te=t.supportsMicrotasks,ne=t.scheduleMicrotask,ie=t.supportsTestSelectors,re=t.findFiberRoot,se=t.getBoundingRect,oe=t.getTextContent,ae=t.isHiddenSubtree,le=t.matchAccessibilityRole,ce=t.setFocusIfFocusable,ue=t.setupIntersectionObserver,he=t.appendChild,de=t.appendChildToContainer,pe=t.commitTextUpdate,fe=t.commitMount,ge=t.commitUpdate,me=t.insertBefore,ve=t.insertInContainerBefore,_e=t.removeChild,be=t.removeChildFromContainer,ye=t.resetTextContent,Te=t.hideInstance,Ee=t.hideTextInstance,Se=t.unhideInstance,we=t.unhideTextInstance,xe=t.clearContainer,Me=t.cloneInstance,Ie=t.createContainerChildSet,Ce=t.appendChildToContainerChildSet,ke=t.finalizeContainerChildren,Re=t.replaceContainerChildren,Ae=t.cloneHiddenInstance,Le=t.cloneHiddenTextInstance,Oe=t.canHydrateInstance,Ne=t.canHydrateTextInstance,De=t.canHydrateSuspenseInstance,Pe=t.isSuspenseInstancePending,$e=t.isSuspenseInstanceFallback,Be=t.registerSuspenseInstanceRetry,Fe=t.getNextHydratableSibling,Ue=t.getFirstHydratableChild,ze=t.getFirstHydratableChildWithinContainer,He=t.getFirstHydratableChildWithinSuspenseInstance,Ge=t.hydrateInstance,Ve=t.hydrateTextInstance,We=t.hydrateSuspenseInstance,je=t.getNextHydratableInstanceAfterSuspenseInstance,Xe=t.commitHydratedContainer,Ye=t.commitHydratedSuspenseInstance,Ke=t.clearSuspenseBoundary,qe=t.clearSuspenseBoundaryFromContainer,Je=t.shouldDeleteUnhydratedTailInstances,Ze=t.didNotMatchHydratedContainerTextInstance,Qe=t.didNotMatchHydratedTextInstance;function et(e){if(void 0===A)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return"\n"+A+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"==typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var it=Object.prototype.hasOwnProperty,rt=[],st=-1;function ot(e){return{current:e}}function at(e){0>st||(e.current=rt[st],rt[st]=null,st--)}function lt(e,t){st++,rt[st]=e.current,e.current=t}var ct={},ut=ot(ct),ht=ot(!1),dt=ct;function pt(e,t){var n=e.type.contextTypes;if(!n)return ct;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ft(e){return null!=(e=e.childContextTypes)}function gt(){at(ht),at(ut)}function mt(e,t,n){if(ut.current!==ct)throw Error(o(168));lt(ut,t),lt(ht,n)}function vt(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(o(108,w(e)||"Unknown",r));return s({},n,i)}function _t(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,dt=ut.current,lt(ut,e),lt(ht,ht.current),!0}function bt(e,t,n){var i=e.stateNode;if(!i)throw Error(o(169));n?(e=vt(e,t,dt),i.__reactInternalMemoizedMergedChildContext=e,at(ht),at(ut),lt(ut,e)):at(ht),lt(ht,n)}var yt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Tt(e)/Et|0)|0},Tt=Math.log,Et=Math.LN2;var St=64,wt=4194304;function xt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=xt(a):0!==(s&=o)&&(i=xt(s))}else 0!==(o=n&~r)?i=xt(o):0!==s&&(i=xt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-yt(t)),i|=e[n],t&=~r;return i}function It(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ct(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function kt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-yt(t)]=n}function At(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-yt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Lt=0;function Ot(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Nt=r.unstable_scheduleCallback,Dt=r.unstable_cancelCallback,Pt=r.unstable_shouldYield,$t=r.unstable_requestPaint,Bt=r.unstable_now,Ft=r.unstable_ImmediatePriority,Ut=r.unstable_UserBlockingPriority,zt=r.unstable_NormalPriority,Ht=r.unstable_IdlePriority,Gt=null,Vt=null;var Wt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},jt=null,Xt=!1,Yt=!1;function Kt(e){null===jt?jt=[e]:jt.push(e)}function qt(){if(!Yt&&null!==jt){Yt=!0;var e=0,t=Lt;try{var n=jt;for(Lt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}jt=null,Xt=!1}catch(r){throw null!==jt&&(jt=jt.slice(e+1)),Nt(Ft,qt),r}finally{Lt=t,Yt=!1}}return null}var Jt=a.ReactCurrentBatchConfig;function Zt(e,t){if(Wt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!it.call(t,r)||!Wt(e[r],t[r]))return!1}return!0}function Qt(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=s({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=ot(null),nn=null,rn=null,sn=null;function on(){sn=rn=nn=null}function an(e,t,n){X?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;at(tn),X?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function un(e,t){nn=e,sn=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Pr=!0),e.firstContext=null)}function hn(e){var t=X?e._currentValue:e._currentValue2;if(sn!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(o(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var dn=null,pn=!1;function fn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Ys&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=n.interleaved)?(t.next=t,null===dn?dn=[n]:dn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function _n(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,At(e,n)}}function bn(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yn(e,t,n,i){var r=e.updateQueue;pn=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var c=l,u=c.next;c.next=null,null===a?o=u:a.next=u,a=c;var h=e.alternate;null!==h&&((l=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===l?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(null!==o){var d=r.baseState;for(a=0,h=u=c=null,l=o;;){var p=l.lane,f=l.eventTime;if((i&p)===p){null!==h&&(h=h.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,m=l;switch(p=t,f=n,m.tag){case 1:if("function"==typeof(g=m.payload)){d=g.call(f,d,p);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(p="function"==typeof(g=m.payload)?g.call(f,d,p):g))break e;d=s({},d,p);break e;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===h?(u=h=f,c=d):h=h.next=f,a|=p;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(p=l).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===h&&(c=d),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=h,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);to|=a,e.lanes=a,e.memoizedState=d}}function Tn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(o(191,r));r.call(i)}}}var En=(new i.Component).refs;function Sn(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:s({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&x(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=To(),r=Eo(e),s=mn(i,r);s.payload=t,null!=n&&(s.callback=n),vn(e,s),null!==(t=So(e,r,i))&&_n(t,e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=To(),r=Eo(e),s=mn(i,r);s.tag=1,s.payload=t,null!=n&&(s.callback=n),vn(e,s),null!==(t=So(e,r,i))&&_n(t,e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=To(),i=Eo(e),r=mn(n,i);r.tag=2,null!=t&&(r.callback=t),vn(e,r),null!==(t=So(e,i,n))&&_n(t,e,i)}};function xn(e,t,n,i,r,s,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Zt(n,i)||!Zt(r,s))}function Mn(e,t,n){var i=!1,r=ct,s=t.contextType;return"object"==typeof s&&null!==s?s=hn(s):(r=ft(t)?dt:ut.current,s=(i=null!=(i=t.contextTypes))?pt(e,r):ct),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function In(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function Cn(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=En,fn(e);var s=t.contextType;"object"==typeof s&&null!==s?r.context=hn(s):(s=ft(t)?dt:ut.current,r.context=pt(e,s)),r.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(Sn(e,t,s,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&wn.enqueueReplaceState(r,r.state,null),yn(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}var kn=[],Rn=0,An=null,Ln=0,On=[],Nn=0,Dn=null,Pn=1,$n="";function Bn(e,t){kn[Rn++]=Ln,kn[Rn++]=An,An=e,Ln=t}function Fn(e,t,n){On[Nn++]=Pn,On[Nn++]=$n,On[Nn++]=Dn,Dn=e;var i=Pn;e=$n;var r=32-yt(i)-1;i&=~(1<<r),n+=1;var s=32-yt(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Pn=1<<32-yt(t)+r|n<<r|i,$n=s+e}else Pn=1<<s|n<<r|i,$n=e}function Un(e){null!==e.return&&(Bn(e,1),Fn(e,1,0))}function zn(e){for(;e===An;)An=kn[--Rn],kn[Rn]=null,Ln=kn[--Rn],kn[Rn]=null;for(;e===Dn;)Dn=On[--Nn],On[Nn]=null,$n=On[--Nn],On[Nn]=null,Pn=On[--Nn],On[Nn]=null}var Hn=null,Gn=null,Vn=!1,Wn=!1,jn=null;function Xn(e,t){var n=Zo(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Yn(e,t){switch(e.tag){case 5:return null!==(t=Oe(t,e.type,e.pendingProps))&&(e.stateNode=t,Hn=e,Gn=Ue(t),!0);case 6:return null!==(t=Ne(t,e.pendingProps))&&(e.stateNode=t,Hn=e,Gn=null,!0);case 13:if(null!==(t=De(t))){var n=null!==Dn?{id:Pn,overflow:$n}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Zo(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Hn=e,Gn=null,!0}return!1;default:return!1}}function Kn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function qn(e){if(Vn){var t=Gn;if(t){var n=t;if(!Yn(e,t)){if(Kn(e))throw Error(o(418));t=Fe(n);var i=Hn;t&&Yn(e,t)?Xn(i,n):(e.flags=-4097&e.flags|2,Vn=!1,Hn=e)}}else{if(Kn(e))throw Error(o(418));e.flags=-4097&e.flags|2,Vn=!1,Hn=e}}}function Jn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Hn=e}function Zn(e){if(!q||e!==Hn)return!1;if(!Vn)return Jn(e),Vn=!0,!1;if(3!==e.tag&&(5!==e.tag||Je(e.type)&&!H(e.type,e.memoizedProps))){var t=Gn;if(t){if(Kn(e)){for(e=Gn;e;)e=Fe(e);throw Error(o(418))}for(;t;)Xn(e,t),t=Fe(t)}}if(Jn(e),13===e.tag){if(!q)throw Error(o(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));Gn=je(e)}else Gn=Hn?Fe(e.stateNode):null;return!0}function Qn(){q&&(Gn=Hn=null,Wn=Vn=!1)}function ei(e){null===jn?jn=[e]:jn.push(e)}function ti(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=r.refs;t===En&&(t=r.refs={}),null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function ni(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ii(e){return(0,e._init)(e._payload)}function ri(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=ea(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function h(e,t,n,i){return null===t||6!==t.tag?((t=ra(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n,i){var s=n.type;return s===u?f(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===b&&ii(s)===t.type)?((i=r(t,n.props)).ref=ti(e,t,n),i.return=e,i):((i=ta(n.type,n.key,n.props,null,e.mode,i)).ref=ti(e,t,n),i.return=e,i)}function p(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=sa(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function f(e,t,n,i,s){return null===t||7!==t.tag?((t=na(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function g(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ra(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case l:return(n=ta(t.type,t.key,t.props,null,e.mode,n)).ref=ti(e,null,t),n.return=e,n;case c:return(t=sa(t,e.mode,n)).return=e,t;case b:return g(e,(0,t._init)(t._payload),n)}if(L(t)||E(t))return(t=na(t,e.mode,n,null)).return=e,t;ni(e,t)}return null}function m(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:h(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===r?d(e,t,n,i):null;case c:return n.key===r?p(e,t,n,i):null;case b:return m(e,t,(r=n._init)(n._payload),i)}if(L(n)||E(n))return null!==r?null:f(e,t,n,i,null);ni(e,n)}return null}function v(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return h(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case l:return d(t,e=e.get(null===i.key?n:i.key)||null,i,r);case c:return p(t,e=e.get(null===i.key?n:i.key)||null,i,r);case b:return v(e,t,n,(0,i._init)(i._payload),r)}if(L(i)||E(i))return f(t,e=e.get(n)||null,i,r,null);ni(t,i)}return null}return function h(d,p,f,_){if("object"==typeof f&&null!==f&&f.type===u&&null===f.key&&(f=f.props.children),"object"==typeof f&&null!==f){switch(f.$$typeof){case l:e:{for(var y=f.key,T=p;null!==T;){if(T.key===y){if((y=f.type)===u){if(7===T.tag){n(d,T.sibling),(p=r(T,f.props.children)).return=d,d=p;break e}}else if(T.elementType===y||"object"==typeof y&&null!==y&&y.$$typeof===b&&ii(y)===T.type){n(d,T.sibling),(p=r(T,f.props)).ref=ti(d,T,f),p.return=d,d=p;break e}n(d,T);break}t(d,T),T=T.sibling}f.type===u?((p=na(f.props.children,d.mode,_,f.key)).return=d,d=p):((_=ta(f.type,f.key,f.props,null,d.mode,_)).ref=ti(d,p,f),_.return=d,d=_)}return a(d);case c:e:{for(T=f.key;null!==p;){if(p.key===T){if(4===p.tag&&p.stateNode.containerInfo===f.containerInfo&&p.stateNode.implementation===f.implementation){n(d,p.sibling),(p=r(p,f.children||[])).return=d,d=p;break e}n(d,p);break}t(d,p),p=p.sibling}(p=sa(f,d.mode,_)).return=d,d=p}return a(d);case b:return h(d,p,(T=f._init)(f._payload),_)}if(L(f))return function(r,o,a,l){for(var c=null,u=null,h=o,d=o=0,p=null;null!==h&&d<a.length;d++){h.index>d?(p=h,h=null):p=h.sibling;var f=m(r,h,a[d],l);if(null===f){null===h&&(h=p);break}e&&h&&null===f.alternate&&t(r,h),o=s(f,o,d),null===u?c=f:u.sibling=f,u=f,h=p}if(d===a.length)return n(r,h),Vn&&Bn(r,d),c;if(null===h){for(;d<a.length;d++)null!==(h=g(r,a[d],l))&&(o=s(h,o,d),null===u?c=h:u.sibling=h,u=h);return Vn&&Bn(r,d),c}for(h=i(r,h);d<a.length;d++)null!==(p=v(h,r,d,a[d],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?d:p.key),o=s(p,o,d),null===u?c=p:u.sibling=p,u=p);return e&&h.forEach((function(e){return t(r,e)})),Vn&&Bn(r,d),c}(d,p,f,_);if(E(f))return function(r,a,l,c){var u=E(l);if("function"!=typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,d=a,p=a=0,f=null,_=l.next();null!==d&&!_.done;p++,_=l.next()){d.index>p?(f=d,d=null):f=d.sibling;var b=m(r,d,_.value,c);if(null===b){null===d&&(d=f);break}e&&d&&null===b.alternate&&t(r,d),a=s(b,a,p),null===h?u=b:h.sibling=b,h=b,d=f}if(_.done)return n(r,d),Vn&&Bn(r,p),u;if(null===d){for(;!_.done;p++,_=l.next())null!==(_=g(r,_.value,c))&&(a=s(_,a,p),null===h?u=_:h.sibling=_,h=_);return Vn&&Bn(r,p),u}for(d=i(r,d);!_.done;p++,_=l.next())null!==(_=v(d,r,p,_.value,c))&&(e&&null!==_.alternate&&d.delete(null===_.key?p:_.key),a=s(_,a,p),null===h?u=_:h.sibling=_,h=_);return e&&d.forEach((function(e){return t(r,e)})),Vn&&Bn(r,p),u}(d,p,f,_);ni(d,f)}return"string"==typeof f&&""!==f||"number"==typeof f?(f=""+f,null!==p&&6===p.tag?(n(d,p.sibling),(p=r(p,f)).return=d,d=p):(n(d,p),(p=ra(f,d.mode,_)).return=d,d=p),a(d)):n(d,p)}}var si=ri(!0),oi=ri(!1),ai={},li=ot(ai),ci=ot(ai),ui=ot(ai);function hi(e){if(e===ai)throw Error(o(174));return e}function di(e,t){lt(ui,t),lt(ci,e),lt(li,ai),e=N(t),at(li),lt(li,e)}function pi(){at(li),at(ci),at(ui)}function fi(e){var t=hi(ui.current),n=hi(li.current);n!==(t=D(n,e.type,t))&&(lt(ci,e),lt(li,t))}function gi(e){ci.current===e&&(at(li),at(ci))}var mi=ot(0);function vi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Pe(n)||$e(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _i=[];function bi(){for(var e=0;e<_i.length;e++){var t=_i[e];X?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}_i.length=0}var yi=a.ReactCurrentDispatcher,Ti=a.ReactCurrentBatchConfig,Ei=0,Si=null,wi=null,xi=null,Mi=!1,Ii=!1,Ci=0,ki=0;function Ri(){throw Error(o(321))}function Ai(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wt(e[n],t[n]))return!1;return!0}function Li(e,t,n,i,r,s){if(Ei=s,Si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yi.current=null===e||null===e.memoizedState?fr:gr,e=n(i,r),Ii){s=0;do{if(Ii=!1,Ci=0,25<=s)throw Error(o(301));s+=1,xi=wi=null,t.updateQueue=null,yi.current=mr,e=n(i,r)}while(Ii)}if(yi.current=pr,t=null!==wi&&null!==wi.next,Ei=0,xi=wi=Si=null,Mi=!1,t)throw Error(o(300));return e}function Oi(){var e=0!==Ci;return Ci=0,e}function Ni(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xi?Si.memoizedState=xi=e:xi=xi.next=e,xi}function Di(){if(null===wi){var e=Si.alternate;e=null!==e?e.memoizedState:null}else e=wi.next;var t=null===xi?Si.memoizedState:xi.next;if(null!==t)xi=t,wi=e;else{if(null===e)throw Error(o(310));e={memoizedState:(wi=e).memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},null===xi?Si.memoizedState=xi=e:xi=xi.next=e}return xi}function Pi(e,t){return"function"==typeof t?t(e):t}function $i(e){var t=Di(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=wi,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((Ei&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,Si.lanes|=h,to|=h}u=u.next}while(null!==u&&u!==s);null===c?a=i:c.next=l,Wt(i,t.memoizedState)||(Pr=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,Si.lanes|=s,to|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Bi(e){var t=Di(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);Wt(s,t.memoizedState)||(Pr=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Fi(){}function Ui(e,t){var n=Si,i=Di(),r=t(),s=!Wt(i.memoizedState,r);if(s&&(i.memoizedState=r,Pr=!0),i=i.queue,Ji(Gi.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==xi&&1&xi.memoizedState.tag){if(n.flags|=2048,ji(9,Hi.bind(null,n,i,r,t),void 0,null),null===Ys)throw Error(o(349));0!==(30&Ei)||zi(n,t,r)}return r}function zi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Si.updateQueue)?(t={lastEffect:null,stores:null},Si.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Hi(e,t,n,i){t.value=n,t.getSnapshot=i,Vi(t)&&So(e,1,-1)}function Gi(e,t,n){return n((function(){Vi(t)&&So(e,1,-1)}))}function Vi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wt(e,n)}catch{return!0}}function Wi(e){var t=Ni();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:e},t.queue=e,e=e.dispatch=lr.bind(null,Si,e),[t.memoizedState,e]}function ji(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=Si.updateQueue)?(t={lastEffect:null,stores:null},Si.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Xi(){return Di().memoizedState}function Yi(e,t,n,i){var r=Ni();Si.flags|=e,r.memoizedState=ji(1|t,n,void 0,void 0===i?null:i)}function Ki(e,t,n,i){var r=Di();i=void 0===i?null:i;var s=void 0;if(null!==wi){var o=wi.memoizedState;if(s=o.destroy,null!==i&&Ai(i,o.deps))return void(r.memoizedState=ji(t,n,s,i))}Si.flags|=e,r.memoizedState=ji(1|t,n,s,i)}function qi(e,t){return Yi(8390656,8,e,t)}function Ji(e,t){return Ki(2048,8,e,t)}function Zi(e,t){return Ki(4,2,e,t)}function Qi(e,t){return Ki(4,4,e,t)}function er(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tr(e,t,n){return n=null!=n?n.concat([e]):null,Ki(4,4,er.bind(null,t,e),n)}function nr(){}function ir(e,t){var n=Di();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ai(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function rr(e,t){var n=Di();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ai(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function sr(e,t){var n=Lt;Lt=0!==n&&4>n?n:4,e(!0);var i=Ti.transition;Ti.transition={};try{e(!1),t()}finally{Lt=n,Ti.transition=i}}function or(){return Di().memoizedState}function ar(e,t,n){var i=Eo(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},cr(e)?ur(t,n):(hr(e,t,n),null!==(e=So(e,i,n=To()))&&dr(e,t,i))}function lr(e,t,n){var i=Eo(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(cr(e))ur(t,r);else{hr(e,t,r);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Wt(a,o))return}catch{}null!==(e=So(e,i,n=To()))&&dr(e,t,i)}}function cr(e){var t=e.alternate;return e===Si||null!==t&&t===Si}function ur(e,t){Ii=Mi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hr(e,t,n){null!==Ys&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=t.interleaved)?(n.next=n,null===dn?dn=[t]:dn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function dr(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,At(e,n)}}var pr={readContext:hn,useCallback:Ri,useContext:Ri,useEffect:Ri,useImperativeHandle:Ri,useInsertionEffect:Ri,useLayoutEffect:Ri,useMemo:Ri,useReducer:Ri,useRef:Ri,useState:Ri,useDebugValue:Ri,useDeferredValue:Ri,useTransition:Ri,useMutableSource:Ri,useSyncExternalStore:Ri,useId:Ri,unstable_isNewReconciler:!1},fr={readContext:hn,useCallback:function(e,t){return Ni().memoizedState=[e,void 0===t?null:t],e},useContext:hn,useEffect:qi,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Yi(4194308,4,er.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Yi(4,2,e,t)},useMemo:function(e,t){var n=Ni();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ni();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ar.bind(null,Si,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ni().memoizedState=e},useState:Wi,useDebugValue:nr,useDeferredValue:function(e){var t=Wi(e),n=t[0],i=t[1];return qi((function(){var t=Ti.transition;Ti.transition={};try{i(e)}finally{Ti.transition=t}}),[e]),n},useTransition:function(){var e=Wi(!1),t=e[0];return e=sr.bind(null,e[1]),Ni().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Si,r=Ni();if(Vn){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Ys)throw Error(o(349));0!==(30&Ei)||zi(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,qi(Gi.bind(null,i,s,e),[e]),i.flags|=2048,ji(9,Hi.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Ni(),t=Ys.identifierPrefix;if(Vn){var n=$n;t=":"+t+"R"+(n=(Pn&~(1<<32-yt(Pn)-1)).toString(32)+n),0<(n=Ci++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ki++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},gr={readContext:hn,useCallback:ir,useContext:hn,useEffect:Ji,useImperativeHandle:tr,useInsertionEffect:Zi,useLayoutEffect:Qi,useMemo:rr,useReducer:$i,useRef:Xi,useState:function(){return $i(Pi)},useDebugValue:nr,useDeferredValue:function(e){var t=$i(Pi),n=t[0],i=t[1];return Ji((function(){var t=Ti.transition;Ti.transition={};try{i(e)}finally{Ti.transition=t}}),[e]),n},useTransition:function(){return[$i(Pi)[0],Di().memoizedState]},useMutableSource:Fi,useSyncExternalStore:Ui,useId:or,unstable_isNewReconciler:!1},mr={readContext:hn,useCallback:ir,useContext:hn,useEffect:Ji,useImperativeHandle:tr,useInsertionEffect:Zi,useLayoutEffect:Qi,useMemo:rr,useReducer:Bi,useRef:Xi,useState:function(){return Bi(Pi)},useDebugValue:nr,useDeferredValue:function(e){var t=Bi(Pi),n=t[0],i=t[1];return Ji((function(){var t=Ti.transition;Ti.transition={};try{i(e)}finally{Ti.transition=t}}),[e]),n},useTransition:function(){return[Bi(Pi)[0],Di().memoizedState]},useMutableSource:Fi,useSyncExternalStore:Ui,useId:or,unstable_isNewReconciler:!1};function vr(e,t){try{var n="",i=t;do{n+=Qt(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r}}function _r(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var br,yr,Tr,Er,Sr="function"==typeof WeakMap?WeakMap:Map;function wr(e,t,n){(n=mn(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){uo||(uo=!0,ho=i),_r(0,t)},n}function xr(e,t,n){(n=mn(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){_r(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(n.callback=function(){_r(0,t),"function"!=typeof i&&(null===po?po=new Set([this]):po.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Mr(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new Sr;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=jo.bind(null,e,t,n),t.then(e,e))}function Ir(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Cr(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=mn(-1,1)).tag=2,vn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}function kr(e){e.flags|=4}function Rr(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(Y)br=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)F(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},yr=function(){},Tr=function(e,t,n,i,r){if((e=e.memoizedProps)!==i){var s=t.stateNode,o=hi(li.current);n=z(s,n,e,i,r,o),(t.updateQueue=n)&&kr(t)}},Er=function(e,t,n,i){n!==i&&kr(t)};else if(K){br=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Ae(s,r.type,r.memoizedProps,r)),F(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Le(s,r.memoizedProps,r)),F(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),br(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var Ar=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Ae(s,r.type,r.memoizedProps,r)),Ce(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Le(s,r.memoizedProps,r)),Ce(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),Ar(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yr=function(e,t){var n=t.stateNode;if(!Rr(e,t)){e=n.containerInfo;var i=Ie(e);Ar(i,t,!1,!1),n.pendingChildren=i,kr(t),ke(e,i)}},Tr=function(e,t,n,i,r){var s=e.stateNode,o=e.memoizedProps;if((e=Rr(e,t))&&o===i)t.stateNode=s;else{var a=t.stateNode,l=hi(li.current),c=null;o!==i&&(c=z(a,n,o,i,r,l)),e&&null===c?t.stateNode=s:(s=Me(s,c,n,o,i,t,e,a),U(s,n,i,r,l)&&kr(t),t.stateNode=s,e?kr(t):br(s,t,!1,!1))}},Er=function(e,t,n,i){n!==i?(e=hi(ui.current),n=hi(li.current),t.stateNode=G(i,e,n,t),kr(t)):t.stateNode=e.stateNode}}else yr=function(){},Tr=function(){},Er=function(){};function Lr(e,t){if(!Vn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Or(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Nr(e,t,n){var i=t.pendingProps;switch(zn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(t),null;case 1:case 17:return ft(t.type)&&gt(),Or(t),null;case 3:return i=t.stateNode,pi(),at(ht),at(ut),bi(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(null===e||null===e.child)&&(Zn(t)?kr(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==jn&&(Co(jn),jn=null))),yr(e,t),Or(t),null;case 5:gi(t),n=hi(ui.current);var r=t.type;if(null!==e&&null!=t.stateNode)Tr(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(o(166));return Or(t),null}if(e=hi(li.current),Zn(t)){if(!q)throw Error(o(175));e=Ge(t.stateNode,t.type,t.memoizedProps,n,e,t,!Wn),t.updateQueue=e,null!==e&&kr(t)}else{var s=B(r,i,n,e,t);br(s,t,!1,!1),t.stateNode=s,U(s,r,i,n,e)&&kr(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Or(t),null;case 6:if(e&&null!=t.stateNode)Er(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(o(166));if(e=hi(ui.current),n=hi(li.current),Zn(t)){if(!q)throw Error(o(176));if(e=t.stateNode,i=t.memoizedProps,(n=Ve(e,i,t,!Wn))&&null!==(r=Hn))switch(s=0!==(1&r.mode),r.tag){case 3:Ze(r.stateNode.containerInfo,e,i,s);break;case 5:Qe(r.type,r.memoizedProps,r.stateNode,e,i,s)}n&&kr(t)}else t.stateNode=G(i,e,n,t)}return Or(t),null;case 13:if(at(mi),i=t.memoizedState,Vn&&null!==Gn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Gn;e;)e=Fe(e);return Qn(),t.flags|=98560,t}if(null!==i&&null!==i.dehydrated){if(i=Zn(t),null===e){if(!i)throw Error(o(318));if(!q)throw Error(o(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(317));We(e,t)}else Qn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Or(t),null}return null!==jn&&(Co(jn),jn=null),0!==(128&t.flags)?(t.lanes=n,t):(i=null!==i,n=!1,null===e?Zn(t):n=null!==e.memoizedState,i&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&mi.current)?0===Qs&&(Qs=3):Po())),null!==t.updateQueue&&(t.flags|=4),Or(t),null);case 4:return pi(),yr(e,t),null===e&&Z(t.stateNode.containerInfo),Or(t),null;case 10:return ln(t.type._context),Or(t),null;case 19:if(at(mi),null===(r=t.memoizedState))return Or(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)Lr(r,!1);else{if(0!==Qs||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=vi(e))){for(t.flags|=128,Lr(r,!1),null!==(e=s.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,i=t.child;null!==i;)r=e,(n=i).flags&=14680066,null===(s=n.alternate)?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,r=s.dependencies,n.dependencies=null===r?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return lt(mi,1&mi.current|2),t.child}e=e.sibling}null!==r.tail&&Bt()>ao&&(t.flags|=128,i=!0,Lr(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=vi(s))){if(t.flags|=128,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Lr(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!Vn)return Or(t),null}else 2*Bt()-r.renderingStartTime>ao&&1073741824!==n&&(t.flags|=128,i=!0,Lr(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Bt(),t.sibling=null,e=mi.current,lt(mi,i?1&e|2:1&e),t):(Or(t),null);case 22:case 23:return Lo(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Js)&&(Or(t),Y&&6&t.subtreeFlags&&(t.flags|=8192)):Or(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}var Dr=a.ReactCurrentOwner,Pr=!1;function $r(e,t,n,i){t.child=null===e?oi(t,null,n,i):si(t,e.child,n,i)}function Br(e,t,n,i,r){n=n.render;var s=t.ref;return un(t,r),i=Li(e,t,n,i,s,r),n=Oi(),null===e||Pr?(Vn&&n&&Un(t),t.flags|=1,$r(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Fr(e,t,n,i,r){if(null===e){var s=n.type;return"function"!=typeof s||Qo(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ta(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ur(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Zt)(o,i)&&e.ref===t.ref)return rs(e,t,r)}return t.flags|=1,(e=ea(s,i)).ref=t.ref,e.return=t,t.child=e}function Ur(e,t,n,i,r){if(null!==e&&Zt(e.memoizedProps,i)&&e.ref===t.ref){if(Pr=!1,0===(e.lanes&r))return t.lanes=e.lanes,rs(e,t,r);0!==(131072&e.flags)&&(Pr=!0)}return Gr(e,t,n,i,r)}function zr(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(Zs,Js),Js|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(Zs,Js),Js|=e,null;t.memoizedState={baseLanes:0,cachePool:null},i=null!==s?s.baseLanes:n,lt(Zs,Js),Js|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,lt(Zs,Js),Js|=i;return $r(e,t,r,n),t.child}function Hr(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Gr(e,t,n,i,r){var s=ft(n)?dt:ut.current;return s=pt(t,s),un(t,r),n=Li(e,t,n,i,s,r),i=Oi(),null===e||Pr?(Vn&&i&&Un(t),t.flags|=1,$r(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Vr(e,t,n,i,r){if(ft(n)){var s=!0;_t(t)}else s=!1;if(un(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Mn(t,n,i),Cn(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"==typeof c&&null!==c?c=hn(c):c=pt(t,c=ft(n)?dt:ut.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==i||l!==c)&&In(t,o,i,c),pn=!1;var d=t.memoizedState;o.state=d,yn(t,i,o,r),l=t.memoizedState,a!==i||d!==l||ht.current||pn?("function"==typeof u&&(Sn(t,n,u,i),l=t.memoizedState),(a=pn||xn(t,n,a,i,d,l,c))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,gn(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:en(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"==typeof(l=n.contextType)&&null!==l?l=hn(l):l=pt(t,l=ft(n)?dt:ut.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==h||d!==l)&&In(t,o,i,l),pn=!1,d=t.memoizedState,o.state=d,yn(t,i,o,r);var f=t.memoizedState;a!==h||d!==f||ht.current||pn?("function"==typeof p&&(Sn(t,n,p,i),f=t.memoizedState),(c=pn||xn(t,n,c,i,d,f,l)||!1)?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Wr(e,t,n,i,s,r)}function Wr(e,t,n,i,r,s){Hr(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&bt(t,n,!1),rs(e,t,s);i=t.stateNode,Dr.current=t;var a=o&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=si(t,e.child,null,s),t.child=si(t,null,a,s)):$r(e,t,a,s),t.memoizedState=i.state,r&&bt(t,n,!0),t.child}function jr(e){var t=e.stateNode;t.pendingContext?mt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&mt(0,t.context,!1),di(e,t.containerInfo)}function Xr(e,t,n,i,r){return Qn(),ei(r),t.flags|=256,$r(e,t,n,i),t.child}var Yr={dehydrated:null,treeContext:null,retryLane:0};function Kr(e){return{baseLanes:e,cachePool:null}}function qr(e,t,n){var i,r=t.pendingProps,s=mi.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(a=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(s|=1),lt(mi,1&s),null===e)return qn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:$e(e)?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,a?(r=t.mode,a=t.child,s={mode:"hidden",children:s},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=s):a=ia(s,r,0,null),e=na(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Kr(n),t.memoizedState=Yr,e):Jr(t,s));if(null!==(s=e.memoizedState)){if(null!==(i=s.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,es(e,t,n,Error(o(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=ia({mode:"visible",children:r.children},s,0,null),(a=na(a,s,n,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&si(t,e.child,null,n),t.child.memoizedState=Kr(n),t.memoizedState=Yr,a);if(0===(1&t.mode))t=es(e,t,n,null);else if($e(i))t=es(e,t,n,Error(o(419)));else if(r=0!==(n&e.childLanes),Pr||r){if(null!==(r=Ys)){switch(n&-n){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(r=0!==(a&(r.suspendedLanes|n))?0:a)&&r!==s.retryLane&&(s.retryLane=r,So(e,r,-1))}Po(),t=es(e,t,n,Error(o(421)))}else Pe(i)?(t.flags|=128,t.child=e.child,t=Yo.bind(null,e),Be(i,t),t=null):(n=s.treeContext,q&&(Gn=He(i),Hn=t,Vn=!0,jn=null,Wn=!1,null!==n&&(On[Nn++]=Pn,On[Nn++]=$n,On[Nn++]=Dn,Pn=n.id,$n=n.overflow,Dn=t)),(t=Jr(t,t.pendingProps.children)).flags|=4096);return t}return a?(r=Qr(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?Kr(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Yr,r):(n=Zr(e,t,r.children,n),t.memoizedState=null,n)}return a?(r=Qr(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?Kr(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Yr,r):(n=Zr(e,t,r.children,n),t.memoizedState=null,n)}function Jr(e,t){return(t=ia({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Zr(e,t,n,i){var r=e.child;return e=r.sibling,n=ea(r,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n}function Qr(e,t,n,i,r){var s=t.mode,o=(e=e.child).sibling,a={mode:"hidden",children:n};return 0===(1&s)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=a,t.deletions=null):(n=ea(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==o?i=ea(o,i):(i=na(i,s,r,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}function es(e,t,n,i){return null!==i&&ei(i),si(t,e.child,null,n),(e=Jr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ts(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),cn(e.return,t,n)}function ns(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function is(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if($r(e,t,i.children,n),0!==(2&(i=mi.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ts(e,n,t);else if(19===e.tag)ts(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(lt(mi,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===vi(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ns(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===vi(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ns(t,!0,n,null,s);break;case"together":ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),to|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=ea(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ea(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ss(e,t){switch(zn(t),t.tag){case 1:return ft(t.type)&&gt(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return pi(),at(ht),at(ut),bi(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return gi(t),null;case 13:if(at(mi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));Qn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return at(mi),null;case 4:return pi(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Lo(),null;default:return null}}var os=!1,as=!1,ls="function"==typeof WeakSet?WeakSet:Set,cs=null;function us(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(i){Wo(e,t,i)}else n.current=null}function hs(e,t,n){try{n()}catch(i){Wo(e,t,i)}}var ds=!1;function ps(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&hs(t,n,s)}r=r.next}while(r!==i)}}function fs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function gs(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=O(n);else e=n;"function"==typeof t?t(e):t.current=e}}function ms(e,t,n){if(Vt&&"function"==typeof Vt.onCommitFiberUnmount)try{Vt.onCommitFiberUnmount(Gt,t)}catch{}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var r=i,s=r.destroy;r=r.tag,void 0!==s&&(0!==(2&r)||0!==(4&r))&&hs(t,n,s),i=i.next}while(i!==e)}break;case 1:if(us(t,n),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){Wo(t,n,o)}break;case 5:us(t,n);break;case 4:Y?ws(e,t,n):K&&K&&(t=t.stateNode.containerInfo,n=Ie(t),Re(t,n))}}function vs(e,t,n){for(var i=t;;)if(ms(e,i,n),null===i.child||Y&&4===i.tag){if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else i.child.return=i,i=i.child}function _s(e){var t=e.alternate;null!==t&&(e.alternate=null,_s(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bs(e){return 5===e.tag||3===e.tag||4===e.tag}function ys(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||bs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ts(e){if(Y){e:{for(var t=e.return;null!==t;){if(bs(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(ye(t),n.flags&=-33),Ss(e,n=ys(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Es(e,n=ys(e),t);break;default:throw Error(o(161))}}}function Es(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?ve(n,e,t):de(n,e);else if(4!==i&&null!==(e=e.child))for(Es(e,t,n),e=e.sibling;null!==e;)Es(e,t,n),e=e.sibling}function Ss(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?me(n,e,t):he(n,e);else if(4!==i&&null!==(e=e.child))for(Ss(e,t,n),e=e.sibling;null!==e;)Ss(e,t,n),e=e.sibling}function ws(e,t,n){for(var i,r,s=t,a=!1;;){if(!a){a=s.return;e:for(;;){if(null===a)throw Error(o(160));switch(i=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:i=i.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===s.tag||6===s.tag)vs(e,s,n),r?be(i,s.stateNode):_e(i,s.stateNode);else if(18===s.tag)r?qe(i,s.stateNode):Ke(i,s.stateNode);else if(4===s.tag){if(null!==s.child){i=s.stateNode.containerInfo,r=!0,s.child.return=s,s=s.child;continue}}else if(ms(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(a=!1)}s.sibling.return=s.return,s=s.sibling}}function xs(e,t){if(Y){switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),fs(3,t),void ps(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var r=t.type,s=t.updateQueue;t.updateQueue=null,null!==s&&ge(n,s,r,e,i,t)}return;case 6:if(null===t.stateNode)throw Error(o(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(q&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo));case 13:case 19:return void Ms(t)}throw Error(o(163))}switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),fs(3,t),void ps(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Ms(t);case 3:q&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo)}e:if(K){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Re(t.containerInfo,t.pendingChildren);break e}throw Error(o(163))}}function Ms(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ls),t.forEach((function(t){var i=Ko.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function Is(e,t,n){cs=e,Cs(e)}function Cs(e,t,n){for(var i=0!==(1&e.mode);null!==cs;){var r=cs,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||os;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||as;a=os;var c=as;if(os=o,(as=l)&&!c)for(cs=r;null!==cs;)l=(o=cs).child,22===o.tag&&null!==o.memoizedState?As(r):null!==l?(l.return=o,cs=l):As(r);for(;null!==s;)cs=s,Cs(s),s=s.sibling;cs=r,os=a,as=c}ks(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,cs=s):ks(e)}}function ks(e){for(;null!==cs;){var t=cs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:as||fs(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!as)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Tn(t,s,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=O(t.child.stateNode);break;case 1:n=t.child.stateNode}Tn(t,a,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&fe(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(q&&null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ye(h)}}}break;default:throw Error(o(163))}as||512&t.flags&&gs(t)}catch(d){Wo(t,t.return,d)}}if(t===e){cs=null;break}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}function Rs(e){for(;null!==cs;){var t=cs;if(t===e){cs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,cs=n;break}cs=t.return}}function As(e){for(;null!==cs;){var t=cs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{fs(4,t)}catch(l){Wo(t,n,l)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Wo(t,r,l)}}var s=t.return;try{gs(t)}catch(l){Wo(t,s,l)}break;case 5:var o=t.return;try{gs(t)}catch(l){Wo(t,o,l)}}}catch(l){Wo(t,t.return,l)}if(t===e){cs=null;break}var a=t.sibling;if(null!==a){a.return=t.return,cs=a;break}cs=t.return}}var Ls=0,Os=1,Ns=2,Ds=3,Ps=4;if("function"==typeof Symbol&&Symbol.for){var $s=Symbol.for;Ls=$s("selector.component"),Os=$s("selector.has_pseudo_class"),Ns=$s("selector.role"),Ds=$s("selector.test_id"),Ps=$s("selector.text")}function Bs(e){var t=J(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(o(364));return t}if(null===(e=re(e)))throw Error(o(362));return e.stateNode.current}function Fs(e,t){switch(t.$$typeof){case Ls:if(e.type===t.value)return!0;break;case Os:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var i=e[n++],r=e[n++],s=t[r];if(5!==i.tag||!ae(i)){for(;null!=s&&Fs(i,s);)s=t[++r];if(r===t.length){t=!0;break e}for(i=i.child;null!==i;)e.push(i,r),i=i.sibling}}t=!1}return t;case Ns:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Ps:if((5===e.tag||6===e.tag)&&(null!==(e=oe(e))&&0<=e.indexOf(t.value)))return!0;break;case Ds:if(5===e.tag&&("string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Us(e){switch(e.$$typeof){case Ls:return"<"+(S(e.value)||"Unknown")+">";case Os:return":has("+(Us(e)||"")+")";case Ns:return'[role="'+e.value+'"]';case Ps:return'"'+e.value+'"';case Ds:return'[data-testname="'+e.value+'"]';default:throw Error(o(365))}}function zs(e,t){var n=[];e=[e,0];for(var i=0;i<e.length;){var r=e[i++],s=e[i++],o=t[s];if(5!==r.tag||!ae(r)){for(;null!=o&&Fs(r,o);)o=t[++s];if(s===t.length)n.push(r);else for(r=r.child;null!==r;)e.push(r,s),r=r.sibling}}return n}function Hs(e,t){if(!ie)throw Error(o(363));e=zs(e=Bs(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var i=e[n++];if(5===i.tag)ae(i)||t.push(i.stateNode);else for(i=i.child;null!==i;)e.push(i),i=i.sibling}return t}var Gs=Math.ceil,Vs=a.ReactCurrentDispatcher,Ws=a.ReactCurrentOwner,js=a.ReactCurrentBatchConfig,Xs=0,Ys=null,Ks=null,qs=0,Js=0,Zs=ot(0),Qs=0,eo=null,to=0,no=0,io=0,ro=null,so=null,oo=0,ao=1/0;function lo(){ao=Bt()+500}var co,uo=!1,ho=null,po=null,fo=!1,go=null,mo=0,vo=0,_o=null,bo=-1,yo=0;function To(){return 0!==(6&Xs)?Bt():-1!==bo?bo:bo=Bt()}function Eo(e){return 0===(1&e.mode)?1:0!==(2&Xs)&&0!==qs?qs&-qs:null!==Jt.transition?(0===yo&&(e=St,0===(4194240&(St<<=1))&&(St=64),yo=e),yo):0!==(e=Lt)?e:Q()}function So(e,t,n){if(50<vo)throw vo=0,_o=null,Error(o(185));var i=wo(e,t);return null===i?null:(Rt(i,t,n),(0===(2&Xs)||i!==Ys)&&(i===Ys&&(0===(2&Xs)&&(no|=t),4===Qs&&ko(i,qs)),xo(i,n),1===t&&0===Xs&&0===(1&e.mode)&&(lo(),Xt&&qt())),i)}function wo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function xo(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-yt(s),a=1<<o,l=r[o];-1===l?(0===(a&n)||0!==(a&i))&&(r[o]=It(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=Mt(e,e===Ys?qs:0);if(0===i)null!==n&&Dt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Dt(n),1===t)0===e.tag?function(e){Xt=!0,Kt(e)}(Ro.bind(null,e)):Kt(Ro.bind(null,e)),te?ne((function(){0===Xs&&qt()})):Nt(Ft,qt),n=null;else{switch(Ot(i)){case 1:n=Ft;break;case 4:n=Ut;break;case 16:default:n=zt;break;case 536870912:n=Ht}n=qo(n,Mo.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Mo(e,t){if(bo=-1,yo=0,0!==(6&Xs))throw Error(o(327));var n=e.callbackNode;if(Go()&&e.callbackNode!==n)return null;var i=Mt(e,e===Ys?qs:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=$o(e,i);else{t=i;var r=Xs;Xs|=2;var s=Do();for((Ys!==e||qs!==t)&&(lo(),Oo(e,t));;)try{Fo();break}catch(l){No(e,l)}on(),Vs.current=s,Xs=r,null!==Ks?t=0:(Ys=null,qs=0,t=Qs)}if(0!==t){if(2===t&&(0!==(r=Ct(e))&&(i=r,t=Io(e,r))),1===t)throw n=eo,Oo(e,0),ko(e,i),xo(e,Bt()),n;if(6===t)ko(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Wt(s(),r))return!1}catch{return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=$o(e,i))&&(0!==(s=Ct(e))&&(i=s,t=Io(e,s))),1===t))throw n=eo,Oo(e,0),ko(e,i),xo(e,Bt()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(o(345));case 2:case 5:Ho(e,so);break;case 3:if(ko(e,i),(130023424&i)===i&&10<(t=oo+500-Bt())){if(0!==Mt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){To(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=V(Ho.bind(null,e,so),t);break}Ho(e,so);break;case 4:if(ko(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-yt(i);s=1<<a,(a=t[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Bt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Gs(i/1960))-i)){e.timeoutHandle=V(Ho.bind(null,e,so),i);break}Ho(e,so);break;default:throw Error(o(329))}}}return xo(e,Bt()),e.callbackNode===n?Mo.bind(null,e):null}function Io(e,t){var n=ro;return e.current.memoizedState.isDehydrated&&(Oo(e,t).flags|=256),2!==(e=$o(e,t))&&(t=so,so=n,null!==t&&Co(t)),e}function Co(e){null===so?so=e:so.push.apply(so,e)}function ko(e,t){for(t&=~io,t&=~no,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yt(t),i=1<<n;e[n]=-1,t&=~i}}function Ro(e){if(0!==(6&Xs))throw Error(o(327));Go();var t=Mt(e,0);if(0===(1&t))return xo(e,Bt()),null;var n=$o(e,t);if(0!==e.tag&&2===n){var i=Ct(e);0!==i&&(t=i,n=Io(e,i))}if(1===n)throw n=eo,Oo(e,0),ko(e,t),xo(e,Bt()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ho(e,so),xo(e,Bt()),null}function Ao(e){null!==go&&0===go.tag&&0===(6&Xs)&&Go();var t=Xs;Xs|=1;var n=js.transition,i=Lt;try{if(js.transition=null,Lt=1,e)return e()}finally{Lt=i,js.transition=n,0===(6&(Xs=t))&&qt()}}function Lo(){Js=Zs.current,at(Zs)}function Oo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==j&&(e.timeoutHandle=j,W(n)),null!==Ks)for(n=Ks.return;null!==n;){var i=n;switch(zn(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&gt();break;case 3:pi(),at(ht),at(ut),bi();break;case 5:gi(i);break;case 4:pi();break;case 13:case 19:at(mi);break;case 10:ln(i.type._context);break;case 22:case 23:Lo()}n=n.return}if(Ys=e,Ks=e=ea(e.current,null),qs=Js=t,Qs=0,eo=null,io=no=to=0,so=ro=null,null!==dn){for(t=0;t<dn.length;t++)if(null!==(i=(n=dn[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}dn=null}return e}function No(e,t){for(;;){var n=Ks;try{if(on(),yi.current=pr,Mi){for(var i=Si.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}Mi=!1}if(Ei=0,xi=wi=Si=null,Ii=!1,Ci=0,Ws.current=null,null===n||null===n.return){Qs=1,eo=t,Ks=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=qs,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=Ir(a);if(null!==f){f.flags&=-257,Cr(f,a,l,0,t),1&f.mode&&Mr(s,u,t),c=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){Mr(s,u,t),Po();break e}c=Error(o(426))}else if(Vn&&1&l.mode){var v=Ir(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Cr(v,a,l,0,t),ei(c);break e}}s=c,4!==Qs&&(Qs=2),null===ro?ro=[s]:ro.push(s),c=vr(c,l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,bn(l,wr(0,c,t));break e;case 1:s=c;var _=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"==typeof _.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===po||!po.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,bn(l,xr(l,s,t));break e}}l=l.return}while(null!==l)}zo(n)}catch(y){t=y,Ks===n&&null!==n&&(Ks=n=n.return);continue}break}}function Do(){var e=Vs.current;return Vs.current=pr,null===e?pr:e}function Po(){(0===Qs||3===Qs||2===Qs)&&(Qs=4),null===Ys||0===(268435455&to)&&0===(268435455&no)||ko(Ys,qs)}function $o(e,t){var n=Xs;Xs|=2;var i=Do();for(Ys===e&&qs===t||Oo(e,t);;)try{Bo();break}catch(r){No(e,r)}if(on(),Xs=n,Vs.current=i,null!==Ks)throw Error(o(261));return Ys=null,qs=0,Qs}function Bo(){for(;null!==Ks;)Uo(Ks)}function Fo(){for(;null!==Ks&&!Pt();)Uo(Ks)}function Uo(e){var t=co(e.alternate,e,Js);e.memoizedProps=e.pendingProps,null===t?zo(e):Ks=t,Ws.current=null}function zo(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Nr(n,t,Js)))return void(Ks=n)}else{if(null!==(n=ss(n,t)))return n.flags&=32767,void(Ks=n);if(null===e)return Qs=6,void(Ks=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ks=t);Ks=t=e}while(null!==t);0===Qs&&(Qs=5)}function Ho(e,t){var n=Lt,i=js.transition;try{js.transition=null,Lt=1,function(e,t,n){do{Go()}while(null!==go);if(0!==(6&Xs))throw Error(o(327));var i=e.finishedWork,r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-yt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,s),e===Ys&&(Ks=Ys=null,qs=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||fo||(fo=!0,qo(zt,(function(){return Go(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=js.transition,js.transition=null;var a=Lt;Lt=1;var l=Xs;Xs|=4,Ws.current=null,function(e,t){for(P(e.containerInfo),cs=t;null!==cs;)if(t=(e=cs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,cs=t;else for(;null!==cs;){e=cs;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var i=n.memoizedProps,r=n.memoizedState,s=e.stateNode,a=s.getSnapshotBeforeUpdate(e.elementType===e.type?i:en(e.type,i),r);s.__reactInternalSnapshotBeforeUpdate=a}break;case 3:Y&&xe(e.stateNode.containerInfo);break;default:throw Error(o(163))}}catch(l){Wo(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,cs=t;break}cs=e.return}n=ds,ds=!1}(e,i),function(e,t){for(cs=t;null!==cs;){var n=(t=cs).deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e;Y?ws(s,r,t):vs(s,r,t);var o=r.alternate;null!==o&&(o.return=null),r.return=null}catch(T){Wo(r,t,T)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,cs=n;else for(;null!==cs;){t=cs;try{var a=t.flags;if(32&a&&Y&&ye(t.stateNode),512&a){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"==typeof c?c(null):c.current=null)}}if(8192&a)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;(null===u||null===u.memoizedState)&&(oo=Bt())}break;case 22:var h=null!==t.memoizedState,d=t.alternate,p=null!==d&&null!==d.memoizedState;if(n=t,Y)e:if(i=n,r=h,s=null,Y)for(var f=i;;){if(5===f.tag){if(null===s){s=f;var g=f.stateNode;r?Te(g):Se(f.stateNode,f.memoizedProps)}}else if(6===f.tag){if(null===s){var m=f.stateNode;r?Ee(m):we(m,f.memoizedProps)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===i)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===i)break;for(;null===f.sibling;){if(null===f.return||f.return===i)break e;s===f&&(s=null),f=f.return}s===f&&(s=null),f.sibling.return=f.return,f=f.sibling}if(h&&!p&&0!==(1&n.mode)){cs=n;for(var v=n.child;null!==v;){for(n=cs=v;null!==cs;){var _=(i=cs).child;switch(i.tag){case 0:case 11:case 14:case 15:ps(4,i,i.return);break;case 1:us(i,i.return);var b=i.stateNode;if("function"==typeof b.componentWillUnmount){var y=i.return;try{b.props=i.memoizedProps,b.state=i.memoizedState,b.componentWillUnmount()}catch(T){Wo(i,y,T)}}break;case 5:us(i,i.return);break;case 22:if(null!==i.memoizedState){Rs(n);continue}}null!==_?(_.return=i,cs=_):Rs(n)}v=v.sibling}}}switch(4102&a){case 2:Ts(t),t.flags&=-3;break;case 6:Ts(t),t.flags&=-3,xs(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,xs(t.alternate,t);break;case 4:xs(t.alternate,t)}}catch(T){Wo(t,t.return,T)}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}}(e,i),$(e.containerInfo),e.current=i,Is(i),$t(),Xs=l,Lt=a,js.transition=s}else e.current=i;if(fo&&(fo=!1,go=e,mo=r),s=e.pendingLanes,0===s&&(po=null),function(e){if(Vt&&"function"==typeof Vt.onCommitFiberRoot)try{Vt.onCommitFiberRoot(Gt,e,void 0,128===(128&e.current.flags))}catch{}}(i.stateNode),xo(e,Bt()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n(t[i]);if(uo)throw uo=!1,e=ho,ho=null,e;0!==(1&mo)&&0!==e.tag&&Go(),s=e.pendingLanes,0!==(1&s)?e===_o?vo++:(vo=0,_o=e):vo=0,qt()}(e,t,n)}finally{js.transition=i,Lt=n}return null}function Go(){if(null!==go){var e=Ot(mo),t=js.transition,n=Lt;try{if(js.transition=null,Lt=16>e?16:e,null===go)var i=!1;else{if(e=go,go=null,mo=0,0!==(6&Xs))throw Error(o(331));var r=Xs;for(Xs|=4,cs=e.current;null!==cs;){var s=cs,a=s.child;if(0!==(16&cs.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(cs=u;null!==cs;){var h=cs;switch(h.tag){case 0:case 11:case 15:ps(8,h,s)}var d=h.child;if(null!==d)d.return=h,cs=d;else for(;null!==cs;){var p=(h=cs).sibling,f=h.return;if(_s(h),h===u){cs=null;break}if(null!==p){p.return=f,cs=p;break}cs=f}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}cs=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,cs=a;else e:for(;null!==cs;){if(0!==(2048&(s=cs).flags))switch(s.tag){case 0:case 11:case 15:ps(9,s,s.return)}var _=s.sibling;if(null!==_){_.return=s.return,cs=_;break e}cs=s.return}}var b=e.current;for(cs=b;null!==cs;){var y=(a=cs).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,cs=y;else e:for(a=b;null!==cs;){if(0!==(2048&(l=cs).flags))try{switch(l.tag){case 0:case 11:case 15:fs(9,l)}}catch(E){Wo(l,l.return,E)}if(l===a){cs=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,cs=T;break e}cs=l.return}}if(Xs=r,qt(),Vt&&"function"==typeof Vt.onPostCommitFiberRoot)try{Vt.onPostCommitFiberRoot(Gt,e)}catch{}i=!0}return i}finally{Lt=n,js.transition=t}}return!1}function Vo(e,t,n){vn(e,t=wr(0,t=vr(n,t),1)),t=To(),null!==(e=wo(e,1))&&(Rt(e,1,t),xo(e,t))}function Wo(e,t,n){if(3===e.tag)Vo(e,e,n);else for(;null!==t;){if(3===t.tag){Vo(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===po||!po.has(i))){vn(t,e=xr(t,e=vr(n,e),1)),e=To(),null!==(t=wo(t,1))&&(Rt(t,1,e),xo(t,e));break}}t=t.return}}function jo(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=To(),e.pingedLanes|=e.suspendedLanes&n,Ys===e&&(qs&n)===n&&(4===Qs||3===Qs&&(130023424&qs)===qs&&500>Bt()-oo?Oo(e,0):io|=n),xo(e,t)}function Xo(e,t){0===t&&(0===(1&e.mode)?t=1:(t=wt,0===(130023424&(wt<<=1))&&(wt=4194304)));var n=To();null!==(e=wo(e,t))&&(Rt(e,t,n),xo(e,n))}function Yo(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Xo(e,n)}function Ko(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(t),Xo(e,n)}function qo(e,t){return Nt(e,t)}function Jo(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zo(e,t,n,i){return new Jo(e,t,n,i)}function Qo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ea(e,t){var n=e.alternate;return null===n?((n=Zo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ta(e,t,n,i,r,s){var a=2;if(i=e,"function"==typeof e)Qo(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case u:return na(n.children,r,s,t);case h:a=8,r|=8;break;case d:return(e=Zo(12,n,t,2|r)).elementType=d,e.lanes=s,e;case m:return(e=Zo(13,n,t,r)).elementType=m,e.lanes=s,e;case v:return(e=Zo(19,n,t,r)).elementType=v,e.lanes=s,e;case y:return ia(n,r,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case p:a=10;break e;case f:a=9;break e;case g:a=11;break e;case _:a=14;break e;case b:a=16,i=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Zo(a,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function na(e,t,n,i){return(e=Zo(7,e,i,t)).lanes=n,e}function ia(e,t,n,i){return(e=Zo(22,e,i,t)).elementType=y,e.lanes=n,e.stateNode={},e}function ra(e,t,n){return(e=Zo(6,e,null,t)).lanes=n,e}function sa(e,t,n){return(t=Zo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oa(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=j,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kt(0),this.expirationTimes=kt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kt(0),this.identifierPrefix=i,this.onRecoverableError=r,q&&(this.mutableSourceEagerHydrationData=null)}function aa(e,t,n,i,r,s,o,a,l){return e=new oa(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Zo(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null},fn(s),e}function la(e){if(!e)return ct;e:{if(x(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ft(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(ft(n))return vt(e,n,t)}return t}function ca(e){var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return null===(e=C(t))?null:e.stateNode}function ua(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ha(e,t){ua(e,t),(e=e.alternate)&&ua(e,t)}function da(e){return null===(e=C(e))?null:e.stateNode}function pa(){return null}return co=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ht.current)Pr=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Pr=!1,function(e,t,n){switch(t.tag){case 3:jr(t),Qn();break;case 5:fi(t);break;case 1:ft(t.type)&&_t(t);break;case 4:di(t,t.stateNode.containerInfo);break;case 10:an(0,t.type._context,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(lt(mi,1&mi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?qr(e,t,n):(lt(mi,1&mi.current),null!==(e=rs(e,t,n))?e.sibling:null);lt(mi,1&mi.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return is(e,t,n);t.flags|=128}var r=t.memoizedState;if(null!==r&&(r.rendering=null,r.tail=null,r.lastEffect=null),lt(mi,mi.current),i)break;return null;case 22:case 23:return t.lanes=0,zr(e,t,n)}return rs(e,t,n)}(e,t,n);Pr=0!==(131072&e.flags)}else Pr=!1,Vn&&0!==(1048576&t.flags)&&Fn(t,Ln,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var r=pt(t,ut.current);un(t,n),r=Li(null,t,i,e,r,n);var s=Oi();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ft(i)?(s=!0,_t(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,fn(t),r.updater=wn,t.stateNode=r,r._reactInternals=t,Cn(t,i,e,n),t=Wr(null,t,i,!0,s,n)):(t.tag=0,Vn&&s&&Un(t),$r(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"==typeof e)return Qo(e)?1:0;if(null!=e){if((e=e.$$typeof)===g)return 11;if(e===_)return 14}return 2}(i),e=en(i,e),r){case 0:t=Gr(null,t,i,e,n);break e;case 1:t=Vr(null,t,i,e,n);break e;case 11:t=Br(null,t,i,e,n);break e;case 14:t=Fr(null,t,i,en(i.type,e),n);break e}throw Error(o(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Gr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 1:return i=t.type,r=t.pendingProps,Vr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 3:e:{if(jr(t),null===e)throw Error(o(387));i=t.pendingProps,r=(s=t.memoizedState).element,gn(e,t),yn(t,i,null,n);var a=t.memoizedState;if(i=a.element,q&&s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Xr(e,t,i,n,r=Error(o(423)));break e}if(i!==r){t=Xr(e,t,i,n,r=Error(o(424)));break e}for(q&&(Gn=ze(t.stateNode.containerInfo),Hn=t,Vn=!0,jn=null,Wn=!1),n=oi(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Qn(),i===r){t=rs(e,t,n);break e}$r(e,t,i,n)}t=t.child}return t;case 5:return fi(t),null===e&&qn(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,H(i,r)?a=null:null!==s&&H(i,s)&&(t.flags|=32),Hr(e,t),$r(e,t,a,n),t.child;case 6:return null===e&&qn(t),null;case 13:return qr(e,t,n);case 4:return di(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=si(t,null,i,n):$r(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Br(e,t,i,r=t.elementType===i?r:en(i,r),n);case 7:return $r(e,t,t.pendingProps,n),t.child;case 8:case 12:return $r(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,an(0,i,a=r.value),null!==s)if(Wt(s.value,a)){if(s.children===r.children&&!ht.current){t=rs(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=mn(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),cn(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),cn(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}$r(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,un(t,n),i=i(r=hn(r)),t.flags|=1,$r(e,t,i,n),t.child;case 14:return r=en(i=t.type,t.pendingProps),Fr(e,t,i,r=en(i.type,r),n);case 15:return Ur(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:en(i,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ft(i)?(e=!0,_t(t)):e=!1,un(t,n),Mn(t,i,r),Cn(t,i,r,n),Wr(null,t,i,!0,e,n);case 19:return is(e,t,n);case 22:return zr(e,t,n)}throw Error(o(156,t.tag))},n.attemptContinuousHydration=function(e){13===e.tag&&(So(e,134217728,To()),ha(e,134217728))},n.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=To(),n=Eo(e);So(e,n,t),ha(e,n)}},n.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=xt(t.pendingLanes);0!==n&&(At(t,1|n),xo(t,Bt()),0===(6&Xs)&&(lo(),qt()))}break;case 13:var i=To();Ao((function(){return So(e,1,i)})),ha(e,1)}},n.batchedUpdates=function(e,t){var n=Xs;Xs|=1;try{return e(t)}finally{0===(Xs=n)&&(lo(),Xt&&qt())}},n.createComponentSelector=function(e){return{$$typeof:Ls,value:e}},n.createContainer=function(e,t,n,i,r,s,o){return aa(e,t,!1,null,0,i,0,s,o)},n.createHasPseudoClassSelector=function(e){return{$$typeof:Os,value:e}},n.createHydrationContainer=function(e,t,n,i,r,s,o,a,l){return(e=aa(n,i,!0,e,0,s,0,a,l)).context=la(null),n=e.current,(s=mn(i=To(),r=Eo(n))).callback=null!=t?t:null,vn(n,s),e.current.lanes=r,Rt(e,r,i),xo(e,i),e},n.createPortal=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},n.createRoleSelector=function(e){return{$$typeof:Ns,value:e}},n.createTestNameSelector=function(e){return{$$typeof:Ds,value:e}},n.createTextSelector=function(e){return{$$typeof:Ps,value:e}},n.deferredUpdates=function(e){var t=Lt,n=js.transition;try{return js.transition=null,Lt=16,e()}finally{Lt=t,js.transition=n}},n.discreteUpdates=function(e,t,n,i,r){var s=Lt,o=js.transition;try{return js.transition=null,Lt=1,e(t,n,i,r)}finally{Lt=s,js.transition=o,0===Xs&&lo()}},n.findAllNodes=Hs,n.findBoundingRects=function(e,t){if(!ie)throw Error(o(363));t=Hs(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var i=(n=e[t]).x,r=i+n.width,s=n.y,a=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,h=u+c.width,d=c.y,p=d+c.height;if(i>=u&&s>=d&&r<=h&&a<=p){e.splice(t,1);break}if(!(i!==u||n.width!==c.width||p<s||d>a)){d>s&&(c.height+=d-s,c.y=s),p<a&&(c.height=a-d),e.splice(t,1);break}if(!(s!==d||n.height!==c.height||h<i||u>r)){u>i&&(c.width+=u-i,c.x=i),h<r&&(c.width=r-u),e.splice(t,1);break}}return e},n.findHostInstance=ca,n.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=I(e))?R(e):null)?null:e.stateNode},n.findHostInstanceWithWarning=function(e){return ca(e)},n.flushControlled=function(e){var t=Xs;Xs|=1;var n=js.transition,i=Lt;try{js.transition=null,Lt=1,e()}finally{Lt=i,js.transition=n,0===(Xs=t)&&(lo(),qt())}},n.flushPassiveEffects=Go,n.flushSync=Ao,n.focusWithin=function(e,t){if(!ie)throw Error(o(363));for(t=zs(e=Bs(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ae(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Lt},n.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(o(363));var n=0,i=[];e=[Bs(e),0];for(var r=0;r<e.length;){var s=e[r++],a=e[r++],l=t[a];if((5!==s.tag||!ae(s))&&(Fs(s,l)&&(i.push(Us(l)),++a>n&&(n=a)),a<t.length))for(s=s.child;null!==s;)e.push(s,a),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Us(t[n]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},n.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?O(e.child.stateNode):e.child.stateNode:null},n.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:da,findFiberByHostInstance:e.findFiberByHostInstance||pa,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Gt=t.inject(e),Vt=t}catch{}e=!!t.checkDCE}}return e},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(e,t,n,i){if(!ie)throw Error(o(363));e=Hs(e,t);var r=ue(e,n,i).disconnect;return{disconnect:function(){r()}}},n.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},n.runWithPriority=function(e,t){var n=Lt;try{return Lt=e,t()}finally{Lt=n}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(e,t,n,i){var r=t.current,s=To(),o=Eo(r);return n=la(n),null===t.context?t.context=n:t.pendingContext=n,(t=mn(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),vn(r,t),null!==(e=So(r,o,s))&&_n(e,r,o),o},n}),Td}!function(e){e.exports=(vd||(vd=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,s=e[i];if(!(0<r(s,t)))break e;e[i]=t,e[n]=s,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,s=e.length,o=s>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<s&&0>r(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<s&&0>r(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,g=!1,m="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var r=n(c);null!==r;){if(null===r.callback)i(c);else{if(!(r.startTime<=e))break;i(c),r.sortIndex=r.expirationTime,t(l,r)}r=n(c)}}function y(e){if(g=!1,b(e),!f)if(null!==n(l))f=!0,L(T);else{var t=n(c);null!==t&&O(y,t.startTime-e)}}function T(t,r){f=!1,g&&(g=!1,v(x),x=-1),p=!0;var s=d;try{for(b(r),h=n(l);null!==h&&(!(h.expirationTime>r)||t&&!C());){var o=h.callback;if("function"==typeof o){h.callback=null,d=h.priorityLevel;var a=o(h.expirationTime<=r);r=e.unstable_now(),"function"==typeof a?h.callback=a:h===n(l)&&i(l),b(r)}else i(l);h=n(l)}if(null!==h)var u=!0;else{var m=n(c);null!==m&&O(y,m.startTime-r),u=!1}return u}finally{h=null,d=s,p=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,w=null,x=-1,M=5,I=-1;function C(){return!(e.unstable_now()-I<M)}function k(){if(null!==w){var t=e.unstable_now();I=t;var n=!0;try{n=w(!0,t)}finally{n?E():(S=!1,w=null)}}else S=!1}if("function"==typeof _)E=function(){_(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,A=R.port2;R.port1.onmessage=k,E=function(){A.postMessage(null)}}else E=function(){m(k,0)};function L(e){w=e,S||(S=!0,E())}function O(t,n){x=m((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,L(T))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_scheduleCallback=function(i,r,s){var o=e.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?o+s:o,i){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return i={id:u++,callback:r,priorityLevel:i,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(i.sortIndex=s,t(c,i),null===n(l)&&i===n(c)&&(g?(v(x),x=-1):g=!0,O(y,s-o))):(i.sortIndex=a,t(l,i),f||p||(f=!0,L(T))),i},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}}(yd)),yd)}(bd);!function(e){e.exports=Sd()}(_d);const wd=hd(_d.exports);function xd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}const Md=[];const Id=(e,t,n)=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(const s of Md)if(xd(t,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return s.response;if(!n)throw s.promise}const r={keys:t,equal:i.equal,promise:e(...t).then((e=>r.response=e)).then((()=>{i.lifespan&&i.lifespan>0&&setTimeout((()=>{const e=Md.indexOf(r);-1!==e&&Md.splice(e,1)}),i.lifespan)})).catch((e=>r.error=e))};if(Md.push(r),!n)throw r.promise}(e,t,!1,n);var Cd,kd={exports:{}},Rd={};!function(t){t.exports=function(){if(Cd)return Rd;Cd=1;var t=e,n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(e,t,i){var a,l={},c=null,u=null;for(a in void 0!==i&&(c=""+i),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)r.call(t,a)&&!o.hasOwnProperty(a)&&(l[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===l[a]&&(l[a]=t[a]);return{$$typeof:n,type:e,key:c,ref:u,props:l,_owner:s.current}}return Rd.Fragment=i,Rd.jsx=a,Rd.jsxs=a,Rd}()}(kd);const Ad=kd.exports.Fragment,Ld=kd.exports.jsx,Od=kd.exports.jsxs,Nd={};var Dd,Pd;const $d=()=>{var e;return null!=(e=Nd.ColorManagement)?e:null},Bd=e=>e&&e.isOrthographicCamera,Fd=typeof window<"u"&&(null!=(Dd=window.document)&&Dd.createElement||"ReactNative"===(null==(Pd=window.navigator)?void 0:Pd.product))?e.useLayoutEffect:e.useEffect;function Ud(t){const n=e.useRef(t);return Fd((()=>{n.current=t}),[t]),n}function zd(e){let{set:t}=e;return Fd((()=>(t(new Promise((()=>null))),()=>t(!1))),[t]),null}class Hd extends e.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Hd.getDerivedStateFromError=()=>({error:!0});const Gd="__default",Vd=new Map,Wd=e=>e&&!!e.memoized&&!!e.changes;function jd(e){const t=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(e)?Math.min(Math.max(e[0],t),e[1]):e}const Xd=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},Yd={obj:e=>e===Object(e)&&!Yd.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:i="reference",strict:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(Yd.str(e)||Yd.num(e))return e===t;const s=Yd.obj(e);if(s&&"reference"===i)return e===t;const o=Yd.arr(e);if(o&&"reference"===n)return e===t;if((o||s)&&e===t)return!0;let a;for(a in e)if(!(a in t))return!1;if(s&&"shallow"===n&&"shallow"===i){for(a in r?t:e)if(!Yd.equ(e[a],t[a],{strict:r,objects:"reference"}))return!1}else for(a in r?t:e)if(e[a]!==t[a])return!1;if(Yd.und(a)){if(o&&0===e.length&&0===t.length||s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function Kd(e,t){const n=e;return(null!=t&&t.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function qd(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),r=i.pop();return n=i.reduce(((e,t)=>e[t]),e),{target:n,key:r}}return{target:n,key:t}}const Jd=/-\d+$/;function Zd(e,t,n){if(Yd.str(n)){if(Jd.test(n)){const t=n.replace(Jd,""),{target:i,key:r}=qd(e,t);Array.isArray(i[r])||(i[r]=[])}const{target:i,key:r}=qd(e,n);t.__r3f.previousAttach=i[r],i[r]=t}else t.__r3f.previousAttach=n(e,t)}function Qd(e,t,n){var i,r;if(Yd.str(n)){const{target:i,key:r}=qd(e,n),s=t.__r3f.previousAttach;void 0===s?delete i[r]:i[r]=s}else null==(i=t.__r3f)||null==i.previousAttach||i.previousAttach(e,t);null==(r=t.__r3f)||delete r.previousAttach}function ep(e,t){let{children:n,key:i,ref:r,...s}=t,{children:o,key:a,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var h;const d=null!=(h=null==e?void 0:e.__r3f)?h:{},p=Object.entries(s),f=[];if(u){const e=Object.keys(c);for(let t=0;t<e.length;t++)s.hasOwnProperty(e[t])||p.unshift([e[t],Gd+"remove"])}p.forEach((t=>{let[n,i]=t;var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===n||Yd.equ(i,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return f.push([n,i,!0,[]]);let o=[];n.includes("-")&&(o=n.split("-")),f.push([n,i,!1,o]);for(const e in s){const t=s[e];e.startsWith("".concat(n,"-"))&&f.push([e,t,!1,e.split("-")])}}));const g={...s};return d.memoizedProps&&d.memoizedProps.args&&(g.args=d.memoizedProps.args),d.memoizedProps&&d.memoizedProps.attach&&(g.attach=d.memoizedProps.attach),{memoized:g,changes:f}}function tp(e,t){var n,i,r;const s=null!=(n=e.__r3f)?n:{},o=s.root,a=null!=(i=null==o||null==o.getState?void 0:o.getState())?i:{},{memoized:l,changes:c}=Wd(t)?t:ep(e,t),u=s.eventCount;e.__r3f&&(e.__r3f.memoizedProps=l);for(let h=0;h<c.length;h++){let[t,n,i,r]=c[h],o=e,l=o[t];if(r.length&&(l=r.reduce(((e,t)=>e[t]),e),!l||!l.set)){const[n,...i]=r.reverse();o=i.reverse().reduce(((e,t)=>e[t]),e),t=n}if(n===Gd+"remove")if(o.constructor){let e=Vd.get(o.constructor);e||(e=new o.constructor,Vd.set(o.constructor,e)),n=e[t]}else n=0;if(i)n?s.handlers[t]=n:delete s.handlers[t],s.eventCount=Object.keys(s.handlers).length;else if(l&&l.set&&(l.copy||l instanceof li)){if(Array.isArray(n))l.fromArray?l.fromArray(n):l.set(...n);else if(l.copy&&n&&n.constructor&&l.constructor===n.constructor)l.copy(n);else if(void 0!==n){const e=l instanceof ln;!e&&l.setScalar?l.setScalar(n):l instanceof li&&n instanceof li?l.mask=n.mask:l.set(n),!$d()&&!a.linear&&e&&l.convertSRGBToLinear()}}else o[t]=n,!a.linear&&o[t]instanceof fn&&o[t].format===ke&&o[t].type===me&&(o[t].encoding=yt);np(e)}if(s.parent&&a.internal&&e.raycast&&u!==s.eventCount){const t=a.internal.interaction.indexOf(e);t>-1&&a.internal.interaction.splice(t,1),s.eventCount&&a.internal.interaction.push(e)}return!(1===c.length&&"onUpdate"===c[0][0])&&c.length&&null!=(r=e.__r3f)&&r.parent&&ip(e),e}function np(e){var t,n;const i=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();i&&0===i.internal.frames&&i.invalidate()}function ip(e){null==e.onUpdate||e.onUpdate(e)}function rp(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function sp(e,t,n,i){const r=n.get(t);r&&(n.delete(t),0===n.size&&(e.delete(i),r.target.releasePointerCapture(i)))}function op(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const i=e.eventObject.__r3f,r=null==i?void 0:i.handlers;if(n.hovered.delete(rp(e)),null!=i&&i.eventCount){const n={...e,intersections:t};null==r.onPointerOut||r.onPointerOut(n),null==r.onPointerLeave||r.onPointerLeave(n)}}}function i(e,t){for(let n=0;n<t.length;n++){const i=t[n].__r3f;null==i||null==i.handlers.onPointerMissed||i.handlers.onPointerMissed(e)}}return{handlePointer:function(r){switch(r){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:i}=e.getState();"pointerId"in t&&i.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{i.capturedMap.has(t.pointerId)&&(i.capturedMap.delete(t.pointerId),n([]))}))}}return function(s){const{onPointerMissed:o,internal:a}=e.getState();a.lastEvent.current=s;const l="onPointerMove"===r,c="onClick"===r||"onContextMenu"===r||"onDoubleClick"===r,u=function(t,n){const i=e.getState(),r=new Set,s=[],o=n?n(i.internal.interaction):i.internal.interaction;for(let e=0;e<o.length;e++){const t=Xd(o[e]);t&&(t.raycaster.camera=void 0)}i.previousRoot||null==i.events.compute||i.events.compute(t,i);let a=o.flatMap((function(e){const n=Xd(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(i=n.previousRoot)?void 0:i.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var i})).sort(((e,t)=>{const n=Xd(e.object),i=Xd(t.object);return n&&i&&i.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=rp(e);return!r.has(t)&&(r.add(t),!0)}));i.events.filter&&(a=i.events.filter(a,i));for(const e of a){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&i.internal.capturedMap.has(t.pointerId))for(let e of i.internal.capturedMap.get(t.pointerId).values())r.has(rp(e.intersection))||s.push(e.intersection);return s}(s,l?t:void 0),h=c?function(t){const{internal:n}=e.getState(),i=t.offsetX-n.initialClick[0],r=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(i*i+r*r))}(s):0;"onPointerDown"===r&&(a.initialClick=[s.offsetX,s.offsetY],a.initialHits=u.map((e=>e.eventObject))),c&&!u.length&&h<=2&&(i(s,a.interaction),o&&o(s)),l&&n(u),function(t,i,r,s){const o=e.getState();if(t.length){const e={stopped:!1};for(const a of t){const l=Xd(a.object)||o,{raycaster:c,pointer:u,camera:h,internal:d}=l,p=new yn(u.x,u.y,0).unproject(h),f=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(a.eventObject))&&t},g=e=>{const t={intersection:a,target:i.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(a.eventObject,t):d.capturedMap.set(e,new Map([[a.eventObject,t]])),i.target.setPointerCapture(e)},m=e=>{const t=d.capturedMap.get(e);t&&sp(d.capturedMap,a.eventObject,t,e)};let v={};for(let e in i){let t=i[e];"function"!=typeof t&&(v[e]=t)}let _={...a,...v,pointer:u,intersections:t,stopped:e.stopped,delta:r,unprojectedPoint:p,ray:c.ray,camera:h,stopPropagation(){const r="pointerId"in i&&d.capturedMap.get(i.pointerId);(!r||r.has(a.eventObject))&&(_.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find((e=>e.eventObject===a.eventObject)))&&n([...t.slice(0,t.indexOf(a)),a])},target:{hasPointerCapture:f,setPointerCapture:g,releasePointerCapture:m},currentTarget:{hasPointerCapture:f,setPointerCapture:g,releasePointerCapture:m},nativeEvent:i};if(s(_),!0===e.stopped)break}}}(u,s,h,(function(e){const t=e.eventObject,n=t.__r3f,o=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(o.onPointerOver||o.onPointerEnter||o.onPointerOut||o.onPointerLeave){const t=rp(e),n=a.hovered.get(t);n?n.stopped&&e.stopPropagation():(a.hovered.set(t,e),null==o.onPointerOver||o.onPointerOver(e),null==o.onPointerEnter||o.onPointerEnter(e))}null==o.onPointerMove||o.onPointerMove(e)}else{const n=o[r];n?(!c||a.initialHits.includes(t))&&(i(s,a.interaction.filter((e=>!a.initialHits.includes(e)))),n(e)):c&&a.initialHits.includes(t)&&i(s,a.interaction.filter((e=>!a.initialHits.includes(e))))}}))}}}}const ap=e=>!(null==e||!e.render),lp=e.createContext(null),cp=(t,n)=>{const i=function(t){const n="function"==typeof t?gd(t):t,i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,e.useReducer)((e=>e+1),0),s=n.getState(),o=(0,e.useRef)(s),a=(0,e.useRef)(t),l=(0,e.useRef)(i),c=(0,e.useRef)(!1),u=(0,e.useRef)();void 0===u.current&&(u.current=t(s));let h,d=!1;(o.current!==s||a.current!==t||l.current!==i||c.current)&&(h=t(s),d=!i(u.current,h)),md((()=>{d&&(u.current=h),o.current=s,a.current=t,l.current=i,c.current=!1}));const p=(0,e.useRef)(s);md((()=>{const e=()=>{try{const e=n.getState(),t=a.current(e);l.current(u.current,t)||(o.current=e,u.current=t,r())}catch{c.current=!0,r()}},t=n.subscribe(e);return n.getState()!==p.current&&e(),t}),[]);const f=d?h:u.current;return(0,e.useDebugValue)(f),f};return Object.assign(i,n),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[i,n];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},i}(((i,r)=>{const s=new yn,o=new yn,a=new yn;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:u}=n,h=i/l;t instanceof yn?a.copy(t):a.set(...t);const d=e.getWorldPosition(s).distanceTo(a);if(Bd(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,r=n*(i/l);return{width:r,height:n,top:c,left:u,factor:i/r,distance:d,aspect:h}}}let c;const u=e=>i((t=>({performance:{...t.performance,current:e}}))),h=new Wt;return{set:i,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,invalidate:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t(r(),e)},advance:(e,t)=>n(e,t,r()),legacy:!1,linear:!1,flat:!1,scene:Kd(new ya),controls:null,clock:new uh,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout((()=>u(r().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>i((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,n,s,a)=>{const c=r().camera,u={width:e,height:t,top:s||0,left:a||0,updateStyle:n};i((e=>({size:u,viewport:{...e.viewport,...l(c,o,u)}})))},setDpr:e=>i((t=>{const n=jd(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),i((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:e.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}}})),r=i.getState();let s=r.size,o=r.viewport.dpr,a=r.camera;return i.subscribe((()=>{const{camera:e,size:t,viewport:n,gl:r,set:l}=i.getState();if(t!==s||n.dpr!==o){var c;s=t,o=n.dpr,function(e,t){e.manual||(Bd(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}(e,t),r.setPixelRatio(n.dpr);const i=null!=(c=t.updateStyle)?c:typeof HTMLCanvasElement<"u"&&r.domElement instanceof HTMLCanvasElement;r.setSize(t.width,t.height,i)}e!==a&&(a=e,l((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),i.subscribe((e=>t(e))),i};let up,hp,dp,pp=new Set,fp=new Set,gp=new Set;function mp(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function vp(e,t){switch(e){case"before":return mp(pp,t);case"after":return mp(fp,t);case"tail":return mp(gp,t)}}function _p(e,t,n){let i=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),hp=t.internal.subscribers,up=0;up<hp.length;up++)dp=hp[up],dp.ref.current(dp.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function bp(){const t=e.useContext(lp);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function yp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return bp()(e,t)}function Tp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=bp(),i=n.getState().internal.subscribe,r=Ud(e);return Fd((()=>i(r,t,n)),[t,i,n]),null}const Ep=new Map,{invalidate:Sp,advance:wp}=function(e){let t,n,i,r=!1;function s(o){n=requestAnimationFrame(s),r=!0,t=0,vp("before",o);for(const n of e.values()){var a;i=n.store.getState(),i.internal.active&&("always"===i.frameloop||i.internal.frames>0)&&(null==(a=i.gl.xr)||!a.isPresenting)&&(t+=_p(o,i))}if(vp("after",o),0===t)return vp("tail",o),r=!1,cancelAnimationFrame(n)}return{loop:s,invalidate:function t(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var o;if(!n)return e.forEach((e=>t(e.store.getState())),i);null!=(o=n.gl.xr)&&o.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+i),r||(r=!0,requestAnimationFrame(s)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(n&&vp("before",t),i)_p(t,i,r);else for(const s of e.values())_p(t,s.store.getState());n&&vp("after",t)}}}(Ep),{reconciler:xp,applyProps:Mp}=function(e,t){function n(e,t,n){let i,{args:r=[],attach:s,...o}=t,a="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===o.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=Kd(o.object,{type:e,root:n,attach:s,primitive:!0})}else{const t=Nd[a];if(!t)throw new Error("R3F: ".concat(a," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");i=Kd(new t(...r),{type:e,root:n,attach:s,memoizedProps:{args:r}})}return void 0===i.__r3f.attach&&(i instanceof qi?i.__r3f.attach="geometry":i instanceof Di&&(i.__r3f.attach="material")),"inject"!==a&&tp(i,o),i}function i(e,t){let n=!1;var i,r;t&&(null!=(i=t.__r3f)&&i.attach?Zd(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(r=e.__r3f)||r.objects.push(t),t.__r3f||Kd(t,{}),t.__r3f.parent=e,ip(t),np(t))}function r(e,t,n){let i=!1;if(t){var r,s;if(null!=(r=t.__r3f)&&r.attach)Zd(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});const r=e.children.filter((e=>e!==t)),s=r.indexOf(n);e.children=[...r.slice(0,s),t,...r.slice(s)],i=!0}i||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||Kd(t,{}),t.__r3f.parent=e,ip(t),np(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach((e=>o(t,e,n)))}function o(e,t,n){if(t){var i,r,o;if(t.__r3f&&(t.__r3f.parent=null),null!=(i=e.__r3f)&&i.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(r=t.__r3f)&&r.attach)Qd(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,i)=>{(e.eventObject===t||e.object===t)&&n.hovered.delete(i)})),n.capturedMap.forEach(((e,i)=>{sp(n.capturedMap,t,e,i)}))}(t.__r3f.root,t)}const c=null==(o=t.__r3f)?void 0:o.primitive,u=void 0===n?null!==t.dispose&&!c:n;var l;if(!c)s(null==(l=t.__r3f)?void 0:l.objects,t,u),s(t.children,t,u);t.__r3f&&(delete t.__r3f.root,delete t.__r3f.objects,delete t.__r3f.handlers,delete t.__r3f.memoizedProps,c||delete t.__r3f),u&&t.dispose&&"Scene"!==t.type&&bd.exports.unstable_scheduleCallback(bd.exports.unstable_IdlePriority,(()=>{try{t.dispose()}catch{}})),np(e)}}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:wd({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;!n.__r3f||(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{!t||o(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const i=e.getState().scene;!i.__r3f||r(i,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,i){if(e.__r3f.primitive&&i.object&&i.object!==e)return[!0];{const{args:t=[],children:r,...s}=i,{args:o=[],children:a,...l}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==o[t])))return[!0];const c=ep(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,r,s,a,l){let[c,u]=t;c?function(e,t,r,s){var a;const l=null==(a=e.__r3f)?void 0:a.parent;if(!l)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&i(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>i(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),i(l,c),c.raycast&&c.__r3f.eventCount&&c.__r3f.root.getState().internal.interaction.push(c),[s,s.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,r,a,l):tp(e,u)},commitMount(e,t,n,i){var r;const s=null!=(r=e.__r3f)?r:{};e.raycast&&s.handlers&&s.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>Kd(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:i}=null!=(t=e.__r3f)?t:{};n&&i&&Qd(i,e,n),e.isObject3D&&(e.visible=!1),np(e)},unhideInstance(e,t){var n;const{attach:i,parent:r}=null!=(n=e.__r3f)?n:{};i&&r&&Zd(r,e,i),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),np(e)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():pd.exports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Yd.fun(performance.now)?performance.now:Yd.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Yd.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Yd.fun(clearTimeout)?clearTimeout:void 0}),applyProps:tp}}(0,(function(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return pd.exports.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return pd.exports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return pd.exports.ContinuousEventPriority;default:return pd.exports.DefaultEventPriority}})),Ip={objects:"shallow",strict:!1},Cp=(e,t)=>{const n="function"==typeof e?e(t):e;return ap(n)?n:new ma({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function kp(e){const t=Ep.get(e),n=null==t?void 0:t.fiber,i=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const r="function"==typeof reportError?reportError:console.error,s=i||cp(Sp,wp),o=n||xp.createContainer(s,pd.exports.ConcurrentRoot,null,!1,null,"",r,null);t||Ep.set(e,{fiber:o,store:s});let a,l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:i,events:r,onCreated:o,shadows:p=!1,linear:f=!1,flat:g=!1,legacy:m=!1,orthographic:v=!1,frameloop:_="always",dpr:b=[1,2],performance:y,raycaster:T,camera:E,onPointerMissed:S}=t,w=s.getState(),x=w.gl;w.gl||w.set({gl:x=Cp(n,e)});let M=w.raycaster;M||w.set({raycaster:M=new Nh});const{params:I,...C}=T||{};if(Yd.equ(C,M,Ip)||Mp(M,{...C}),Yd.equ(I,M.params,Ip)||Mp(M,{params:{...M.params,...I}}),!w.camera||w.camera===l&&!Yd.equ(l,E,Ip)){l=E;const e=E instanceof Tr,t=e?E:v?new jr(0,0,0,0,.1,1e3):new Er(75,0,.1,1e3);e||(t.position.z=5,E&&Mp(t,E),!w.camera&&!(null!=E&&E.rotation)&&t.lookAt(0,0,0)),w.set({camera:t})}if(!w.xr){const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&wp(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||Sp(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};x.xr&&n.connect(),w.set({xr:n})}if(x.shadowMap){const e=x.shadowMap.enabled,t=x.shadowMap.type;if(x.shadowMap.enabled=!!p,Yd.boo(p))x.shadowMap.type=h;else if(Yd.str(p)){var k;const e={basic:0,percentage:u,soft:h,variance:d};x.shadowMap.type=null!=(k=e[p])?k:h}else Yd.obj(p)&&Object.assign(x.shadowMap,p);(e!==x.shadowMap.enabled||t!==x.shadowMap.type)&&(x.shadowMap.needsUpdate=!0)}const R=$d();R&&("enabled"in R?R.enabled=!m:"legacyMode"in R&&(R.legacyMode=m));const A=f?bt:yt,L=g?K:Q;x.outputEncoding!==A&&(x.outputEncoding=A),x.toneMapping!==L&&(x.toneMapping=L),w.legacy!==m&&w.set((()=>({legacy:m}))),w.linear!==f&&w.set((()=>({linear:f}))),w.flat!==g&&w.set((()=>({flat:g}))),n&&!Yd.fun(n)&&!ap(n)&&!Yd.equ(n,x,Ip)&&Mp(x,n),r&&!w.events.handlers&&w.set({events:r(s)});const O=function(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:i,left:r}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:r}}return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,i);return Yd.equ(O,w.size,Ip)||w.setSize(O.width,O.height,O.updateStyle,O.top,O.left),b&&w.viewport.dpr!==jd(b)&&w.setDpr(b),w.frameloop!==_&&w.setFrameloop(_),w.onPointerMissed||w.set({onPointerMissed:S}),y&&!Yd.equ(y,w.performance,Ip)&&w.set((e=>({performance:{...e.performance,...y}}))),a=o,c=!0,this},render(t){return c||this.configure(),xp.updateContainer(Ld(Rp,{store:s,children:t,onCreated:a,rootElement:e}),o,null,(()=>{})),s},unmount(){Ap(e)}}}function Rp(t){let{store:n,children:i,onCreated:r,rootElement:s}=t;return Fd((()=>{const e=n.getState();e.set((e=>({internal:{...e.internal,active:!0}}))),r&&r(e),n.getState().events.connected||null==e.events.connect||e.events.connect(s)}),[]),e.createElement(lp.Provider,{value:n},i)}function Ap(e,t){const n=Ep.get(e),i=null==n?void 0:n.fiber;if(i){const r=null==n?void 0:n.store.getState();r&&(r.internal.active=!1),xp.updateContainer(null,i,null,(()=>{r&&setTimeout((()=>{try{var n,i,s,o;null==r.events.disconnect||r.events.disconnect(),null==(n=r.gl)||null==(i=n.renderLists)||null==i.dispose||i.dispose(),null==(s=r.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(o=r.gl)&&o.xr&&r.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(r),Ep.delete(e),t&&t(e)}catch{}}),500)}))}}function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Lp.apply(this,arguments)}function Op(e,t,n){var i,r,s,o,a;function l(){var c=Date.now()-o;c<t&&c>=0?i=setTimeout(l,t-c):(i=null,n||(a=e.apply(s,r),s=r=null))}null==t&&(t=100);var c=function(){s=this,r=arguments,o=Date.now();var c=n&&!i;return i||(i=setTimeout(l,t)),c&&(a=e.apply(s,r),s=r=null),a};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(a=e.apply(s,r),s=r=null,clearTimeout(i),i=null)},c}xp.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:e.version}),Op.debounce=Op;var Np=Op;function Dp(t){let{debounce:n,scroll:i,polyfill:r,offsetSize:s}=void 0===t?{debounce:0,scroll:!1,offsetSize:!1}:t;const o=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,l]=(0,e.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,e.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),u=n?"number"==typeof n?n:n.scroll:null,h=n?"number"==typeof n?n:n.resize:null,d=(0,e.useRef)(!1);(0,e.useEffect)((()=>(d.current=!0,()=>{d.current=!1})));const[p,f,g]=(0,e.useMemo)((()=>{const e=()=>{if(!c.current.element)return;const{left:e,top:t,width:n,height:i,bottom:r,right:o,x:a,y:u}=c.current.element.getBoundingClientRect(),h={left:e,top:t,width:n,height:i,bottom:r,right:o,x:a,y:u};c.current.element instanceof HTMLElement&&s&&(h.height=c.current.element.offsetHeight,h.width=c.current.element.offsetWidth),Object.freeze(h),d.current&&!Bp(c.current.lastBounds,h)&&l(c.current.lastBounds=h)};return[e,h?Np(e,h):e,u?Np(e,u):e]}),[l,s,u,h]);function m(){c.current.scrollContainers&&(c.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",g,!0))),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null)}function v(){!c.current.element||(c.current.resizeObserver=new o(g),c.current.resizeObserver.observe(c.current.element),i&&c.current.scrollContainers&&c.current.scrollContainers.forEach((e=>e.addEventListener("scroll",g,{capture:!0,passive:!0}))))}return function(t,n){(0,e.useEffect)((()=>{if(n){const e=t;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",e,!0)}}}),[t,n])}(g,Boolean(i)),function(t){(0,e.useEffect)((()=>{const e=t;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[t])}(f),(0,e.useEffect)((()=>{m(),v()}),[i,g,f]),(0,e.useEffect)((()=>m),[]),[e=>{!e||e===c.current.element||(m(),c.current.element=e,c.current.scrollContainers=Pp(e),v())},a,p]}function Pp(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(e);return[n,i,r].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...Pp(e.parentElement)]}const $p=["x","y","top","bottom","left","right","width","height"],Bp=(e,t)=>$p.every((n=>e[n]===t[n]));var Fp,Up=Object.defineProperty,zp=Object.defineProperties,Hp=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,Vp=Object.prototype.hasOwnProperty,Wp=Object.prototype.propertyIsEnumerable,jp=(e,t,n)=>t in e?Up(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xp=(e,t)=>{for(var n in t||(t={}))Vp.call(t,n)&&jp(e,n,t[n]);if(Gp)for(var n of Gp(t))Wp.call(t,n)&&jp(e,n,t[n]);return e};function Yp(e,t,n){if(!e)return;if(!0===n(e))return e;let i=t?e.return:e.child;for(;i;){const e=Yp(i,t,n);if(e)return e;i=t?null:i.sibling}}function Kp(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch{return e}}const qp=Kp(e.createContext(null));class Jp extends e.Component{render(){return Ld(qp.Provider,{value:this._reactInternals,children:this.props.children})}}const{ReactCurrentOwner:Zp,ReactCurrentDispatcher:Qp}=null!=(Fp=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)?Fp:{};function ef(){const t=e.useContext(qp),n=e.useId();return e.useMemo((()=>{var e;return null!=(e=null==Zp?void 0:Zp.current)?e:Yp(t,!1,(e=>{let t=e.memoizedState;for(;t;){if(t.memoizedState===n)return!0;t=t.next}}))}),[t,n])}function tf(){var t,n;const i=ef(),[r]=e.useState((()=>new Map));r.clear();let s=i;for(;s;){const e=null==(t=s.type)?void 0:t._context;e&&e!==qp&&!r.has(e)&&r.set(e,null==(n=null==Qp?void 0:Qp.current)?void 0:n.readContext(Kp(e))),s=s.return}return e.useMemo((()=>Array.from(r.keys()).reduce(((t,n)=>i=>e.createElement(t,null,e.createElement(n.Provider,((e,t)=>zp(e,Hp(t)))(Xp({},i),{value:r.get(n)})))),(e=>Ld(Jp,{...Xp({},e)})))),[r])}const nf={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function rf(e){const{handlePointer:t}=op(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(nf).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:i}=e.getState();null!=(t=i.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:r}=e.getState();null==r.disconnect||r.disconnect(),i((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=r.handlers)?n:[]).forEach((e=>{let[n,i]=e;const[r,s]=nf[n];t.addEventListener(r,i,{passive:s})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var i;n.connected&&(Object.entries(null!=(i=n.handlers)?i:[]).forEach((e=>{let[t,i]=e;if(n&&n.connected instanceof HTMLElement){const[e]=nf[t];n.connected.removeEventListener(e,i)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}const sf=e.forwardRef((function(t,n){let{children:i,fallback:r,resize:s,style:o,gl:a,events:l=rf,eventSource:c,eventPrefix:u,shadows:h,linear:d,flat:p,legacy:f,orthographic:g,frameloop:m,dpr:v,performance:_,raycaster:b,camera:y,onPointerMissed:T,onCreated:E,...S}=t;e.useMemo((()=>(e=>{Object.assign(Nd,e)})(cd)),[]);const w=tf(),[x,M]=Dp({scroll:!0,debounce:{scroll:50,resize:0},...s}),I=e.useRef(null),C=e.useRef(null);e.useImperativeHandle(n,(()=>I.current));const k=Ud(T),[R,A]=e.useState(!1),[L,O]=e.useState(!1);if(R)throw R;if(L)throw L;const N=e.useRef(null);return Fd((()=>{const t=I.current;M.width>0&&M.height>0&&t&&(N.current||(N.current=kp(t)),N.current.configure({gl:a,events:l,shadows:h,linear:d,flat:p,legacy:f,orthographic:g,frameloop:m,dpr:v,performance:_,raycaster:b,camera:y,size:M,onPointerMissed:function(){return null==k.current?void 0:k.current(...arguments)},onCreated:e=>{null==e.events.connect||e.events.connect(c?(e=>e&&e.hasOwnProperty("current"))(c)?c.current:c:C.current),u&&e.setEvents({compute:(e,t)=>{const n=e[u+"X"],i=e[u+"Y"];t.pointer.set(n/t.size.width*2-1,-i/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==E||E(e)}}),N.current.render(Ld(w,{children:Ld(Hd,{set:O,children:Ld(e.Suspense,{fallback:Ld(zd,{set:A}),children:i})})})))})),e.useEffect((()=>{const e=I.current;if(e)return()=>Ap(e)}),[]),Ld("div",{ref:C,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:c?"none":"auto",...o},...S,children:Ld("div",{ref:x,style:{width:"100%",height:"100%"},children:Ld("canvas",{ref:I,style:{display:"block"},children:r})})})})),of=e.forwardRef((function(e,t){return Ld(Jp,{children:Ld(sf,{...e,ref:t})})}));var af,lf={exports:{}},cf={},uf={exports:{}},hf={};var df,pf;function ff(){return df||(df=1,function(e){e.exports=(af||(af=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,s=e[i];if(!(0<r(s,t)))break e;e[i]=t,e[n]=s,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,s=e.length,o=s>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<s&&0>r(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<s&&0>r(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,g=!1,m="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var r=n(c);null!==r;){if(null===r.callback)i(c);else{if(!(r.startTime<=e))break;i(c),r.sortIndex=r.expirationTime,t(l,r)}r=n(c)}}function y(e){if(g=!1,b(e),!f)if(null!==n(l))f=!0,L(T);else{var t=n(c);null!==t&&O(y,t.startTime-e)}}function T(t,r){f=!1,g&&(g=!1,v(x),x=-1),p=!0;var s=d;try{for(b(r),h=n(l);null!==h&&(!(h.expirationTime>r)||t&&!C());){var o=h.callback;if("function"==typeof o){h.callback=null,d=h.priorityLevel;var a=o(h.expirationTime<=r);r=e.unstable_now(),"function"==typeof a?h.callback=a:h===n(l)&&i(l),b(r)}else i(l);h=n(l)}if(null!==h)var u=!0;else{var m=n(c);null!==m&&O(y,m.startTime-r),u=!1}return u}finally{h=null,d=s,p=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,w=null,x=-1,M=5,I=-1;function C(){return!(e.unstable_now()-I<M)}function k(){if(null!==w){var t=e.unstable_now();I=t;var n=!0;try{n=w(!0,t)}finally{n?E():(S=!1,w=null)}}else S=!1}if("function"==typeof _)E=function(){_(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,A=R.port2;R.port1.onmessage=k,E=function(){A.postMessage(null)}}else E=function(){m(k,0)};function L(e){w=e,S||(S=!0,E())}function O(t,n){x=m((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,L(T))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_scheduleCallback=function(i,r,s){var o=e.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?o+s:o,i){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return i={id:u++,callback:r,priorityLevel:i,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(i.sortIndex=s,t(c,i),null===n(l)&&i===n(c)&&(g?(v(x),x=-1):g=!0,O(y,s-o))):(i.sortIndex=a,t(l,i),f||p||(f=!0,L(T))),i},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}}(hf)),hf)}(uf)),uf.exports}function gf(){if(pf)return cf;pf=1;var t=e,n=ff();function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function o(e,t){a(e,t),a(e+"Capture",t)}function a(e,t){for(s[e]=t,e=0;e<t.length;e++)r.add(t[e])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function p(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){f[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];f[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){f[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){f[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){f[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){f[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){f[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){f[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){f[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function m(e){return e[1].toUpperCase()}function v(e,t,n,i){var r=f.hasOwnProperty(t)?f[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||typeof t>"u"||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!c.call(d,e)||!c.call(h,e)&&(u.test(e)?d[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,m);f[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,m);f[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,m);f[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),f.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),y=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),x=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),L=Symbol.iterator;function O(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,D=Object.assign;function P(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var $=!1;function B(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"==typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{$=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function F(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case y:return"Portal";case S:return"Profiler";case E:return"StrictMode";case I:return"Suspense";case C:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case w:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return U(e(t))}catch{}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=G(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function j(e){if(typeof(e=e||(typeof document<"u"?document:void 0))>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function X(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function q(e,t){K(e,t);var n=H(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?Z(e,t.type,n):t.hasOwnProperty("defaultValue")&&Z(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Z(e,t,n){("number"!==t||j(e.ownerDocument)!==e)&&(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Q=Array.isArray;function ee(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function te(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(Q(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),i=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ae,le,ce=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ae=ae||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ae.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=pe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(he).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ge=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function me(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(i(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ye=null,Te=null,Ee=null;function Se(e){if(e=vr(e)){if("function"!=typeof ye)throw Error(i(280));var t=e.stateNode;t&&(t=br(t),ye(e.stateNode,e.type,t))}}function we(e){Te?Ee?Ee.push(e):Ee=[e]:Te=e}function xe(){if(Te){var e=Te,t=Ee;if(Ee=Te=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Me(e,t){return e(t)}function Ie(){}var Ce=!1;function ke(e,t,n){if(Ce)return e(t,n);Ce=!0;try{return Me(e,t,n)}finally{Ce=!1,(null!==Te||null!==Ee)&&(Ie(),xe())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=br(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(i(231,t,typeof n));return n}var Ae=!1;if(l)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch{Ae=!1}function Oe(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ne=!1,De=null,Pe=!1,$e=null,Be={onError:function(e){Ne=!0,De=e}};function Fe(e,t,n,i,r,s,o,a,l){Ne=!1,De=null,Oe.apply(Be,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(r=s.return)){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return He(s),e;if(o===r)return He(s),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=o;break}if(l===r){a=!0,r=s,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=s;break}if(l===r){a=!0,r=o,n=s;break}l=l.sibling}if(!a)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var We=n.unstable_scheduleCallback,je=n.unstable_cancelCallback,Xe=n.unstable_shouldYield,Ye=n.unstable_requestPaint,Ke=n.unstable_now,qe=n.unstable_getCurrentPriorityLevel,Je=n.unstable_ImmediatePriority,Ze=n.unstable_UserBlockingPriority,Qe=n.unstable_NormalPriority,et=n.unstable_LowPriority,tt=n.unstable_IdlePriority,nt=null,it=null;var rt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ot|0)|0},st=Math.log,ot=Math.LN2;var at=64,lt=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ct(a):0!==(s&=o)&&(i=ct(s))}else 0!==(o=n&~r)?i=ct(o):0!==s&&(i=ct(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-rt(t)),i|=e[n],t&=~r;return i}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=at;return 0===(4194240&(at<<=1))&&(at=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-rt(t)]=n}function mt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-rt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var vt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,yt,Tt,Et,St,wt=!1,xt=[],Mt=null,It=null,Ct=null,kt=new Map,Rt=new Map,At=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Ct=null;break;case"pointerover":case"pointerout":kt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=vr(t))&&yt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Dt(e){var t=mr(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void St(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vr(n))&&yt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);_e=i,n.target.dispatchEvent(i),_e=null,t.shift()}return!0}function $t(e,t,n){Pt(e)&&n.delete(t)}function Bt(){wt=!1,null!==Mt&&Pt(Mt)&&(Mt=null),null!==It&&Pt(It)&&(It=null),null!==Ct&&Pt(Ct)&&(Ct=null),kt.forEach($t),Rt.forEach($t)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,wt||(wt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return Ft(t,e)}if(0<xt.length){Ft(xt[0],e);for(var n=1;n<xt.length;n++){var i=xt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Mt&&Ft(Mt,e),null!==It&&Ft(It,e),null!==Ct&&Ft(Ct,e),kt.forEach(t),Rt.forEach(t),n=0;n<At.length;n++)(i=At[n]).blockedOn===e&&(i.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Dt(n),null===n.blockedOn&&At.shift()}var zt=_.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,i){var r=vt,s=zt.transition;zt.transition=null;try{vt=1,Wt(e,t,n,i)}finally{vt=r,zt.transition=s}}function Vt(e,t,n,i){var r=vt,s=zt.transition;zt.transition=null;try{vt=4,Wt(e,t,n,i)}finally{vt=r,zt.transition=s}}function Wt(e,t,n,i){if(Ht){var r=Xt(e,t,n,i);if(null===r)Hi(e,t,i,jt,n),Ot(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Mt=Nt(Mt,e,t,n,i,r),!0;case"dragenter":return It=Nt(It,e,t,n,i,r),!0;case"mouseover":return Ct=Nt(Ct,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return kt.set(s,Nt(kt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Rt.set(s,Nt(Rt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Ot(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var s=vr(r);if(null!==s&&bt(s),null===(s=Xt(e,t,n,i))&&Hi(e,t,i,jt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Hi(e,t,i,null,n)}}var jt=null;function Xt(e,t,n,i){if(jt=null,null!==(e=mr(e=be(i))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case Je:return 1;case Ze:return 4;case Qe:case et:return 16;case tt:return 536870912;default:return 16}default:return 16}}var Kt=null,qt=null,Jt=null;function Zt(){if(Jt)return Jt;var e,t,n=qt,i=n.length,r="value"in Kt?Kt.value:Kt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Jt=r.slice(e,1<t?1-t:void 0)}function Qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function en(){return!0}function tn(){return!1}function nn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?en:tn,this.isPropagationStopped=tn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=en)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=en)},persist:function(){},isPersistent:en}),t}var rn,sn,on,an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=nn(an),cn=D({},an,{view:0,detail:0}),un=nn(cn),hn=D({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(rn=e.screenX-on.screenX,sn=e.screenY-on.screenY):sn=rn=0,on=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),dn=nn(hn),pn=nn(D({},hn,{dataTransfer:0})),fn=nn(D({},cn,{relatedTarget:0})),gn=nn(D({},an,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=D({},an,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=nn(mn),_n=nn(D({},an,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function Sn(){return En}var wn=D({},cn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?yn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?Qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=nn(wn),Mn=nn(D({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=nn(D({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Cn=nn(D({},an,{propertyName:0,elapsedTime:0,pseudoElement:0})),kn=D({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=nn(kn),An=[9,13,27,32],Ln=l&&"CompositionEvent"in window,On=null;l&&"documentMode"in document&&(On=document.documentMode);var Nn=l&&"TextEvent"in window&&!On,Dn=l&&(!Ln||On&&8<On&&11>=On),Pn=String.fromCharCode(32),$n=!1;function Bn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Gn(e,t,n,i){we(i),0<(t=Vi(t,"onChange")).length&&(n=new ln("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Vn=null,Wn=null;function jn(e){Pi(e,0)}function Xn(e){if(W(_r(e)))return e}function Yn(e,t){if("change"===e)return t}var Kn=!1;if(l){var qn;if(l){var Jn="oninput"in document;if(!Jn){var Zn=document.createElement("div");Zn.setAttribute("oninput","return;"),Jn="function"==typeof Zn.oninput}qn=Jn}else qn=!1;Kn=qn&&(!document.documentMode||9<document.documentMode)}function Qn(){Vn&&(Vn.detachEvent("onpropertychange",ei),Wn=Vn=null)}function ei(e){if("value"===e.propertyName&&Xn(Wn)){var t=[];Gn(t,Wn,e,be(e)),ke(jn,t)}}function ti(e,t,n){"focusin"===e?(Qn(),Wn=n,(Vn=t).attachEvent("onpropertychange",ei)):"focusout"===e&&Qn()}function ni(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Wn)}function ii(e,t){if("click"===e)return Xn(t)}function ri(e,t){if("input"===e||"change"===e)return Xn(t)}var si="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function oi(e,t){if(si(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!c.call(t,r)||!si(e[r],t[r]))return!1}return!0}function ai(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function li(e,t){var n,i=ai(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ai(i)}}function ci(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ci(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ui(){for(var e=window,t=j();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch{n=!1}if(!n)break;t=j((e=t.contentWindow).document)}return t}function hi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function di(e){var t=ui(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ci(n.ownerDocument.documentElement,n)){if(null!==i&&hi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=li(n,s);var o=li(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pi=l&&"documentMode"in document&&11>=document.documentMode,fi=null,gi=null,mi=null,vi=!1;function _i(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vi||null==fi||fi!==j(i)||("selectionStart"in(i=fi)&&hi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},mi&&oi(mi,i)||(mi=i,0<(i=Vi(gi,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=fi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var yi={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},Ti={},Ei={};function Si(e){if(Ti[e])return Ti[e];if(!yi[e])return e;var t,n=yi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ei)return Ti[e]=n[t];return e}l&&(Ei=document.createElement("div").style,"AnimationEvent"in window||(delete yi.animationend.animation,delete yi.animationiteration.animation,delete yi.animationstart.animation),"TransitionEvent"in window||delete yi.transitionend.transition);var wi=Si("animationend"),xi=Si("animationiteration"),Mi=Si("animationstart"),Ii=Si("transitionend"),Ci=new Map,ki="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(e,t){Ci.set(e,t),o(t,[e])}for(var Ai=0;Ai<ki.length;Ai++){var Li=ki[Ai];Ri(Li.toLowerCase(),"on"+(Li[0].toUpperCase()+Li.slice(1)))}Ri(wi,"onAnimationEnd"),Ri(xi,"onAnimationIteration"),Ri(Mi,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Ii,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ni=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function Di(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,o,a,l,c){if(Fe.apply(this,arguments),Ne){if(!Ne)throw Error(i(198));var u=De;Ne=!1,De=null,Pe||(Pe=!0,$e=u)}}(r,t,void 0,e),e.currentTarget=null}function Pi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Di(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Di(r,a,c),s=l}}}if(Pe)throw e=$e,Pe=!1,$e=null,e}function $i(e,t){var n=t[pr];void 0===n&&(n=t[pr]=new Set);var i=e+"__bubble";n.has(i)||(zi(t,e,2,!1),n.add(i))}function Bi(e,t,n){var i=0;t&&(i|=4),zi(n,e,i,t)}var Fi="_reactListening"+Math.random().toString(36).slice(2);function Ui(e){if(!e[Fi]){e[Fi]=!0,r.forEach((function(t){"selectionchange"!==t&&(Ni.has(t)||Bi(t,!1,e),Bi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fi]||(t[Fi]=!0,Bi("selectionchange",!1,t))}}function zi(e,t,n,i){switch(Yt(t)){case 1:var r=Gt;break;case 4:r=Vt;break;default:r=Wt}n=r.bind(null,t,n,e),r=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Hi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=mr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}ke((function(){var i=s,r=be(n),o=[];e:{var a=Ci.get(e);if(void 0!==a){var l=ln,c=e;switch(e){case"keypress":if(0===Qt(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":c="focus",l=fn;break;case"focusout":c="blur",l=fn;break;case"beforeblur":case"afterblur":l=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case wi:case xi:case Mi:l=gn;break;case Ii:l=Cn;break;case"scroll":l=un;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==d&&(null!=(g=Re(f,d))&&u.push(Gi(f,g,p)))),h)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!mr(c)&&!c[dr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?mr(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=dn,g="onMouseLeave",d="onMouseEnter",f="mouse",("pointerout"===e||"pointerover"===e)&&(u=Mn,g="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:_r(l),p=null==c?a:_r(c),(a=new u(g,f+"leave",l,n,r)).target=h,a.relatedTarget=p,g=null,mr(r)===i&&((u=new u(d,f+"enter",c,n,r)).target=p,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Wi(p))f++;for(p=0,g=d;g;g=Wi(g))p++;for(;0<f-p;)u=Wi(u),f--;for(;0<p-f;)d=Wi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wi(u),d=Wi(d)}u=null}else u=null;null!==l&&ji(o,a,l,u,!1),null!==c&&null!==h&&ji(o,h,c,u,!0)}if("select"===(l=(a=i?_r(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Yn;else if(Hn(a))if(Kn)m=ri;else{m=ni;var v=ti}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ii);switch(m&&(m=m(e,i))?Gn(o,m,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&Z(a,"number",a.value)),v=i?_r(i):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(fi=v,gi=i,mi=null);break;case"focusout":mi=gi=fi=null;break;case"mousedown":vi=!0;break;case"contextmenu":case"mouseup":case"dragend":vi=!1,_i(o,n,r);break;case"selectionchange":if(pi)break;case"keydown":case"keyup":_i(o,n,r)}var _;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Dn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(_=Zt()):(qt="value"in(Kt=r)?Kt.value:Kt.textContent,Un=!0)),0<(v=Vi(i,b)).length&&(b=new _n(b,e,null,n,r),o.push({event:b,listeners:v}),_?b.data=_:null!==(_=Fn(n))&&(b.data=_))),(_=Nn?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:($n=!0,Pn);case"textInput":return(e=t.data)===Pn&&$n?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Ln&&Bn(e,t)?(e=Zt(),Jt=qt=Kt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Vi(i,"onBeforeInput")).length&&(r=new _n("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=_))}Pi(o,t)}))}function Gi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Re(e,n))&&i.unshift(Gi(e,s,r)),null!=(s=Re(e,t))&&i.push(Gi(e,s,r))),e=e.return}return i}function Wi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function ji(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Re(n,s))&&o.unshift(Gi(n,l,a)):r||null!=(l=Re(n,s))&&o.push(Gi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Xi=/\r\n?/g,Yi=/\u0000|\uFFFD/g;function Ki(e){return("string"==typeof e?e:""+e).replace(Xi,"\n").replace(Yi,"")}function qi(e,t,n){if(t=Ki(t),Ki(e)!==t&&n)throw Error(i(425))}function Ji(){}var Zi=null,Qi=null;function er(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var tr="function"==typeof setTimeout?setTimeout:void 0,nr="function"==typeof clearTimeout?clearTimeout:void 0,ir="function"==typeof Promise?Promise:void 0,rr="function"==typeof queueMicrotask?queueMicrotask:typeof ir<"u"?function(e){return ir.resolve(null).then(e).catch(sr)}:tr;function sr(e){setTimeout((function(){throw e}))}function or(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Ut(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ut(t)}function ar(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function lr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var cr=Math.random().toString(36).slice(2),ur="__reactFiber$"+cr,hr="__reactProps$"+cr,dr="__reactContainer$"+cr,pr="__reactEvents$"+cr,fr="__reactListeners$"+cr,gr="__reactHandles$"+cr;function mr(e){var t=e[ur];if(t)return t;for(var n=e.parentNode;n;){if(t=n[dr]||n[ur]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=lr(e);null!==e;){if(n=e[ur])return n;e=lr(e)}return t}n=(e=n).parentNode}return null}function vr(e){return!(e=e[ur]||e[dr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _r(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function br(e){return e[hr]||null}var yr=[],Tr=-1;function Er(e){return{current:e}}function Sr(e){0>Tr||(e.current=yr[Tr],yr[Tr]=null,Tr--)}function wr(e,t){Tr++,yr[Tr]=e.current,e.current=t}var xr={},Mr=Er(xr),Ir=Er(!1),Cr=xr;function kr(e,t){var n=e.type.contextTypes;if(!n)return xr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Rr(e){return null!=(e=e.childContextTypes)}function Ar(){Sr(Ir),Sr(Mr)}function Lr(e,t,n){if(Mr.current!==xr)throw Error(i(168));wr(Mr,t),wr(Ir,n)}function Or(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(i(108,z(e)||"Unknown",s));return D({},n,r)}function Nr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xr,Cr=Mr.current,wr(Mr,e),wr(Ir,Ir.current),!0}function Dr(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Or(e,t,Cr),r.__reactInternalMemoizedMergedChildContext=e,Sr(Ir),Sr(Mr),wr(Mr,e)):Sr(Ir),wr(Ir,n)}var Pr=null,$r=!1,Br=!1;function Fr(e){null===Pr?Pr=[e]:Pr.push(e)}function Ur(){if(!Br&&null!==Pr){Br=!0;var e=0,t=vt;try{var n=Pr;for(vt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Pr=null,$r=!1}catch(r){throw null!==Pr&&(Pr=Pr.slice(e+1)),We(Je,Ur),r}finally{vt=t,Br=!1}}return null}var zr=[],Hr=0,Gr=null,Vr=0,Wr=[],jr=0,Xr=null,Yr=1,Kr="";function qr(e,t){zr[Hr++]=Vr,zr[Hr++]=Gr,Gr=e,Vr=t}function Jr(e,t,n){Wr[jr++]=Yr,Wr[jr++]=Kr,Wr[jr++]=Xr,Xr=e;var i=Yr;e=Kr;var r=32-rt(i)-1;i&=~(1<<r),n+=1;var s=32-rt(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Yr=1<<32-rt(t)+r|n<<r|i,Kr=s+e}else Yr=1<<s|n<<r|i,Kr=e}function Zr(e){null!==e.return&&(qr(e,1),Jr(e,1,0))}function Qr(e){for(;e===Gr;)Gr=zr[--Hr],zr[Hr]=null,Vr=zr[--Hr],zr[Hr]=null;for(;e===Xr;)Xr=Wr[--jr],Wr[jr]=null,Kr=Wr[--jr],Wr[jr]=null,Yr=Wr[--jr],Wr[jr]=null}var es=null,ts=null,ns=!1,is=null;function rs(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ss(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,es=e,ts=ar(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,es=e,ts=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xr?{id:Yr,overflow:Kr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,es=e,ts=null,!0);default:return!1}}function os(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function as(e){if(ns){var t=ts;if(t){var n=t;if(!ss(e,t)){if(os(e))throw Error(i(418));t=ar(n.nextSibling);var r=es;t&&ss(e,t)?rs(r,n):(e.flags=-4097&e.flags|2,ns=!1,es=e)}}else{if(os(e))throw Error(i(418));e.flags=-4097&e.flags|2,ns=!1,es=e}}}function ls(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;es=e}function cs(e){if(e!==es)return!1;if(!ns)return ls(e),ns=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!er(e.type,e.memoizedProps)),t&&(t=ts)){if(os(e))throw us(),Error(i(418));for(;t;)rs(e,t),t=ar(t.nextSibling)}if(ls(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ts=ar(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ts=null}}else ts=es?ar(e.stateNode.nextSibling):null;return!0}function us(){for(var e=ts;e;)e=ar(e.nextSibling)}function hs(){ts=es=null,ns=!1}function ds(e){null===is?is=[e]:is.push(e)}var ps=_.ReactCurrentBatchConfig;function fs(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gs=Er(null),ms=null,vs=null,_s=null;function bs(){_s=vs=ms=null}function ys(e){var t=gs.current;Sr(gs),e._currentValue=t}function Ts(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Es(e,t){ms=e,_s=vs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_a=!0),e.firstContext=null)}function Ss(e){var t=e._currentValue;if(_s!==e)if(e={context:e,memoizedValue:t,next:null},null===vs){if(null===ms)throw Error(i(308));vs=e,ms.dependencies={lanes:0,firstContext:e}}else vs=vs.next=e;return t}var ws=null;function xs(e){null===ws?ws=[e]:ws.push(e)}function Ms(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,xs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Is(e,i)}function Is(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Cs=!1;function ks(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function As(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ls(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Il)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Is(e,n)}return null===(r=i.interleaved)?(t.next=t,xs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Is(e,n)}function Os(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,mt(e,n)}}function Ns(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ds(e,t,n,i){var r=e.updateQueue;Cs=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(d=t,p=n,g.tag){case 1:if("function"==typeof(f=g.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=g.payload)?f.call(p,h,d):f))break e;h=D({},h,d);break e;case 2:Cs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Dl|=o,e.lanes=o,e.memoizedState=h}}function Ps(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!=typeof s)throw Error(i(191,s));s.call(r)}}}var $s=(new t.Component).refs;function Bs(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Fs={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Ql(),r=ec(e),s=As(i,r);s.payload=t,null!=n&&(s.callback=n),null!==(t=Ls(e,s,r))&&(tc(t,e,r,i),Os(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Ql(),r=ec(e),s=As(i,r);s.tag=1,s.payload=t,null!=n&&(s.callback=n),null!==(t=Ls(e,s,r))&&(tc(t,e,r,i),Os(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),i=ec(e),r=As(n,i);r.tag=2,null!=t&&(r.callback=t),null!==(t=Ls(e,r,i))&&(tc(t,e,i,n),Os(t,e,i))}};function Us(e,t,n,i,r,s,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!oi(n,i)||!oi(r,s))}function zs(e,t,n){var i=!1,r=xr,s=t.contextType;return"object"==typeof s&&null!==s?s=Ss(s):(r=Rr(t)?Cr:Mr.current,s=(i=null!=(i=t.contextTypes))?kr(e,r):xr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Fs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Hs(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Fs.enqueueReplaceState(t,t.state,null)}function Gs(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=$s,ks(e);var s=t.contextType;"object"==typeof s&&null!==s?r.context=Ss(s):(s=Rr(t)?Cr:Mr.current,r.context=kr(e,s)),r.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(Bs(e,t,s,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Fs.enqueueReplaceState(r,r.state,null),Ds(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function Vs(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var s=r,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=s.refs;t===$s&&(t=s.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ws(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function js(e){return(0,e._init)(e._payload)}function Xs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Pc(n,e.mode,i)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,i){var r=n.type;return r===T?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===R&&js(r)===t.type)?((i=s(t,n.props)).ref=Vs(e,t,n),i.return=e,i):((i=Oc(n.type,n.key,n.props,null,e.mode,i)).ref=Vs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=$c(n,e.mode,i)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function h(e,t,n,i,r){return null===t||7!==t.tag?((t=Nc(n,e.mode,i,r)).return=e,t):((t=s(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Pc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=Vs(e,null,t),n.return=e,n;case y:return(t=$c(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(Q(t)||O(t))return(t=Nc(t,e.mode,n,null)).return=e,t;Ws(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?c(e,t,n,i):null;case y:return n.key===r?u(e,t,n,i):null;case R:return p(e,t,(r=n._init)(n._payload),i)}if(Q(n)||O(n))return null!==r?null:h(e,t,n,i,null);Ws(e,n)}return null}function f(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case y:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case R:return f(e,t,n,(0,i._init)(i._payload),r)}if(Q(i)||O(i))return h(t,e=e.get(n)||null,i,r,null);Ws(t,i)}return null}return function l(c,u,h,g){if("object"==typeof h&&null!==h&&h.type===T&&null===h.key&&(h=h.props.children),"object"==typeof h&&null!==h){switch(h.$$typeof){case b:e:{for(var m=h.key,v=u;null!==v;){if(v.key===m){if((m=h.type)===T){if(7===v.tag){n(c,v.sibling),(u=s(v,h.props.children)).return=c,c=u;break e}}else if(v.elementType===m||"object"==typeof m&&null!==m&&m.$$typeof===R&&js(m)===v.type){n(c,v.sibling),(u=s(v,h.props)).ref=Vs(c,v,h),u.return=c,c=u;break e}n(c,v);break}t(c,v),v=v.sibling}h.type===T?((u=Nc(h.props.children,c.mode,g,h.key)).return=c,c=u):((g=Oc(h.type,h.key,h.props,null,c.mode,g)).ref=Vs(c,u,h),g.return=c,c=g)}return a(c);case y:e:{for(v=h.key;null!==u;){if(u.key===v){if(4===u.tag&&u.stateNode.containerInfo===h.containerInfo&&u.stateNode.implementation===h.implementation){n(c,u.sibling),(u=s(u,h.children||[])).return=c,c=u;break e}n(c,u);break}t(c,u),u=u.sibling}(u=$c(h,c.mode,g)).return=c,c=u}return a(c);case R:return l(c,u,(v=h._init)(h._payload),g)}if(Q(h))return function(i,s,a,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=p(i,h,a[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(i,h),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(i,h),ns&&qr(i,g),c;if(null===h){for(;g<a.length;g++)null!==(h=d(i,a[g],l))&&(s=o(h,s,g),null===u?c=h:u.sibling=h,u=h);return ns&&qr(i,g),c}for(h=r(i,h);g<a.length;g++)null!==(m=f(h,i,g,a[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),ns&&qr(i,g),c}(c,u,h,g);if(O(h))return function(s,a,l,c){var u=O(l);if("function"!=typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var h=u=null,g=a,m=a=0,v=null,_=l.next();null!==g&&!_.done;m++,_=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=p(s,g,_.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(s,g),a=o(b,a,m),null===h?u=b:h.sibling=b,h=b,g=v}if(_.done)return n(s,g),ns&&qr(s,m),u;if(null===g){for(;!_.done;m++,_=l.next())null!==(_=d(s,_.value,c))&&(a=o(_,a,m),null===h?u=_:h.sibling=_,h=_);return ns&&qr(s,m),u}for(g=r(s,g);!_.done;m++,_=l.next())null!==(_=f(g,s,m,_.value,c))&&(e&&null!==_.alternate&&g.delete(null===_.key?m:_.key),a=o(_,a,m),null===h?u=_:h.sibling=_,h=_);return e&&g.forEach((function(e){return t(s,e)})),ns&&qr(s,m),u}(c,u,h,g);Ws(c,h)}return"string"==typeof h&&""!==h||"number"==typeof h?(h=""+h,null!==u&&6===u.tag?(n(c,u.sibling),(u=s(u,h)).return=c,c=u):(n(c,u),(u=Pc(h,c.mode,g)).return=c,c=u),a(c)):n(c,u)}}var Ys=Xs(!0),Ks=Xs(!1),qs={},Js=Er(qs),Zs=Er(qs),Qs=Er(qs);function eo(e){if(e===qs)throw Error(i(174));return e}function to(e,t){switch(wr(Qs,t),wr(Zs,e),wr(Js,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sr(Js),wr(Js,t)}function no(){Sr(Js),Sr(Zs),Sr(Qs)}function io(e){eo(Qs.current);var t=eo(Js.current),n=oe(t,e.type);t!==n&&(wr(Zs,e),wr(Js,n))}function ro(e){Zs.current===e&&(Sr(Js),Sr(Zs))}var so=Er(0);function oo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ao=[];function lo(){for(var e=0;e<ao.length;e++)ao[e]._workInProgressVersionPrimary=null;ao.length=0}var co=_.ReactCurrentDispatcher,uo=_.ReactCurrentBatchConfig,ho=0,po=null,fo=null,go=null,mo=!1,vo=!1,_o=0,bo=0;function yo(){throw Error(i(321))}function To(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!si(e[n],t[n]))return!1;return!0}function Eo(e,t,n,r,s,o){if(ho=o,po=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,co.current=null===e||null===e.memoizedState?sa:oa,e=n(r,s),vo){o=0;do{if(vo=!1,_o=0,25<=o)throw Error(i(301));o+=1,go=fo=null,t.updateQueue=null,co.current=aa,e=n(r,s)}while(vo)}if(co.current=ra,t=null!==fo&&null!==fo.next,ho=0,go=fo=po=null,mo=!1,t)throw Error(i(300));return e}function So(){var e=0!==_o;return _o=0,e}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?po.memoizedState=go=e:go=go.next=e,go}function xo(){if(null===fo){var e=po.alternate;e=null!==e?e.memoizedState:null}else e=fo.next;var t=null===go?po.memoizedState:go.next;if(null!==t)go=t,fo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(fo=e).memoizedState,baseState:fo.baseState,baseQueue:fo.baseQueue,queue:fo.queue,next:null},null===go?po.memoizedState=go=e:go=go.next=e}return go}function Mo(e,t){return"function"==typeof t?t(e):t}function Io(e){var t=xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=fo,s=r.baseQueue,o=n.pending;if(null!==o){if(null!==s){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(null!==s){o=s.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((ho&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,po.lanes|=h,Dl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,si(r,t.memoizedState)||(_a=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{o=s.lane,po.lanes|=o,Dl|=o,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Co(e){var t=xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(null!==s){n.pending=null;var a=s=s.next;do{o=e(o,a.action),a=a.next}while(a!==s);si(o,t.memoizedState)||(_a=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ko(){}function Ro(e,t){var n=po,r=xo(),s=t(),o=!si(r.memoizedState,s);if(o&&(r.memoizedState=s,_a=!0),r=r.queue,Ho(Oo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,$o(9,Lo.bind(null,n,r,s,t),void 0,null),null===Cl)throw Error(i(349));0!==(30&ho)||Ao(n,t,s)}return s}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=po.updateQueue)?(t={lastEffect:null,stores:null},po.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Lo(e,t,n,i){t.value=n,t.getSnapshot=i,No(t)&&Do(e)}function Oo(e,t,n){return n((function(){No(t)&&Do(e)}))}function No(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!si(e,n)}catch{return!0}}function Do(e){var t=Is(e,1);null!==t&&tc(t,e,1,-1)}function Po(e){var t=wo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=ea.bind(null,po,e),[t.memoizedState,e]}function $o(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=po.updateQueue)?(t={lastEffect:null,stores:null},po.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Bo(){return xo().memoizedState}function Fo(e,t,n,i){var r=wo();po.flags|=e,r.memoizedState=$o(1|t,n,void 0,void 0===i?null:i)}function Uo(e,t,n,i){var r=xo();i=void 0===i?null:i;var s=void 0;if(null!==fo){var o=fo.memoizedState;if(s=o.destroy,null!==i&&To(i,o.deps))return void(r.memoizedState=$o(t,n,s,i))}po.flags|=e,r.memoizedState=$o(1|t,n,s,i)}function zo(e,t){return Fo(8390656,8,e,t)}function Ho(e,t){return Uo(2048,8,e,t)}function Go(e,t){return Uo(4,2,e,t)}function Vo(e,t){return Uo(4,4,e,t)}function Wo(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function jo(e,t,n){return n=null!=n?n.concat([e]):null,Uo(4,4,Wo.bind(null,t,e),n)}function Xo(){}function Yo(e,t){var n=xo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&To(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ko(e,t){var n=xo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&To(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&ho)?(e.baseState&&(e.baseState=!1,_a=!0),e.memoizedState=n):(si(n,t)||(n=pt(),po.lanes|=n,Dl|=n,e.baseState=!0),t)}function Jo(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var i=uo.transition;uo.transition={};try{e(!1),t()}finally{vt=n,uo.transition=i}}function Zo(){return xo().memoizedState}function Qo(e,t,n){var i=ec(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ta(e))na(t,n);else if(null!==(n=Ms(e,t,n,i))){tc(n,e,i,Ql()),ia(n,t,i)}}function ea(e,t,n){var i=ec(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ta(e))na(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,si(a,o)){var l=t.interleaved;return null===l?(r.next=r,xs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch{}null!==(n=Ms(e,t,r,i))&&(tc(n,e,i,r=Ql()),ia(n,t,i))}}function ta(e){var t=e.alternate;return e===po||null!==t&&t===po}function na(e,t){vo=mo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ia(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,mt(e,n)}}var ra={readContext:Ss,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},sa={readContext:Ss,useCallback:function(e,t){return wo().memoizedState=[e,void 0===t?null:t],e},useContext:Ss,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Fo(4194308,4,Wo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=wo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=wo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Qo.bind(null,po,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},wo().memoizedState=e},useState:Po,useDebugValue:Xo,useDeferredValue:function(e){return wo().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=Jo.bind(null,e[1]),wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=po,s=wo();if(ns){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Cl)throw Error(i(349));0!==(30&ho)||Ao(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,zo(Oo.bind(null,r,o,e),[e]),r.flags|=2048,$o(9,Lo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=wo(),t=Cl.identifierPrefix;if(ns){var n=Kr;t=":"+t+"R"+(n=(Yr&~(1<<32-rt(Yr)-1)).toString(32)+n),0<(n=_o++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=bo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oa={readContext:Ss,useCallback:Yo,useContext:Ss,useEffect:Ho,useImperativeHandle:jo,useInsertionEffect:Go,useLayoutEffect:Vo,useMemo:Ko,useReducer:Io,useRef:Bo,useState:function(){return Io(Mo)},useDebugValue:Xo,useDeferredValue:function(e){return qo(xo(),fo.memoizedState,e)},useTransition:function(){return[Io(Mo)[0],xo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Ro,useId:Zo,unstable_isNewReconciler:!1},aa={readContext:Ss,useCallback:Yo,useContext:Ss,useEffect:Ho,useImperativeHandle:jo,useInsertionEffect:Go,useLayoutEffect:Vo,useMemo:Ko,useReducer:Co,useRef:Bo,useState:function(){return Co(Mo)},useDebugValue:Xo,useDeferredValue:function(e){var t=xo();return null===fo?t.memoizedState=e:qo(t,fo.memoizedState,e)},useTransition:function(){return[Co(Mo)[0],xo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Ro,useId:Zo,unstable_isNewReconciler:!1};function la(e,t){try{var n="",i=t;do{n+=F(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ca(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ua(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function da(e,t,n){(n=As(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Gl||(Gl=!0,Vl=i),ua(0,t)},n}function pa(e,t,n){(n=As(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ua(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(n.callback=function(){ua(0,t),"function"!=typeof i&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fa(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ha;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=wc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ma(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=As(-1,1)).tag=2,Ls(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var va=_.ReactCurrentOwner,_a=!1;function ba(e,t,n,i){t.child=null===e?Ks(t,null,n,i):Ys(t,e.child,n,i)}function ya(e,t,n,i,r){n=n.render;var s=t.ref;return Es(t,r),i=Eo(e,t,n,i,s,r),n=So(),null===e||_a?(ns&&n&&Zr(t),t.flags|=1,ba(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ga(e,t,r))}function Ta(e,t,n,i,r){if(null===e){var s=n.type;return"function"!=typeof s||Ac(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ea(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:oi)(o,i)&&e.ref===t.ref)return Ga(e,t,r)}return t.flags|=1,(e=Lc(s,i)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(oi(s,i)&&e.ref===t.ref){if(_a=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Ga(e,t,r);0!==(131072&e.flags)&&(_a=!0)}}return xa(e,t,n,i,r)}function Sa(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wr(Ll,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wr(Ll,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,wr(Ll,Al),Al|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,wr(Ll,Al),Al|=i;return ba(e,t,r,n),t.child}function wa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xa(e,t,n,i,r){var s=Rr(n)?Cr:Mr.current;return s=kr(t,s),Es(t,r),n=Eo(e,t,n,i,s,r),i=So(),null===e||_a?(ns&&i&&Zr(t),t.flags|=1,ba(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ga(e,t,r))}function Ma(e,t,n,i,r){if(Rr(n)){var s=!0;Nr(t)}else s=!1;if(Es(t,r),null===t.stateNode)Ha(e,t),zs(t,n,i),Gs(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"==typeof c&&null!==c?c=Ss(c):c=kr(t,c=Rr(n)?Cr:Mr.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==i||l!==c)&&Hs(t,o,i,c),Cs=!1;var d=t.memoizedState;o.state=d,Ds(t,i,o,r),l=t.memoizedState,a!==i||d!==l||Ir.current||Cs?("function"==typeof u&&(Bs(t,n,u,i),l=t.memoizedState),(a=Cs||Us(t,n,a,i,d,l,c))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Rs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:fs(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"==typeof(l=n.contextType)&&null!==l?l=Ss(l):l=kr(t,l=Rr(n)?Cr:Mr.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Hs(t,o,i,l),Cs=!1,d=t.memoizedState,o.state=d,Ds(t,i,o,r);var f=t.memoizedState;a!==h||d!==f||Ir.current||Cs?("function"==typeof p&&(Bs(t,n,p,i),f=t.memoizedState),(c=Cs||Us(t,n,c,i,d,f,l)||!1)?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Ia(e,t,n,i,s,r)}function Ia(e,t,n,i,r,s){wa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Dr(t,n,!1),Ga(e,t,s);i=t.stateNode,va.current=t;var a=o&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=Ys(t,e.child,null,s),t.child=Ys(t,null,a,s)):ba(e,t,a,s),t.memoizedState=i.state,r&&Dr(t,n,!0),t.child}function Ca(e){var t=e.stateNode;t.pendingContext?Lr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lr(0,t.context,!1),to(e,t.containerInfo)}function ka(e,t,n,i,r){return hs(),ds(r),t.flags|=256,ba(e,t,n,i),t.child}var Ra,Aa,La,Oa,Na={dehydrated:null,treeContext:null,retryLane:0};function Da(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pa(e,t,n){var r,s=t.pendingProps,o=so.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(o|=1),wr(so,1&o),null===e)return as(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Dc(l,s,0,null),e=Nc(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Da(n),t.memoizedState=Na,e):$a(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,s,o,a){if(n)return 256&t.flags?(t.flags&=-257,r=ca(Error(i(422))),Ba(e,t,a,r)):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=Dc({mode:"visible",children:r.children},s,0,null),o=Nc(o,s,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ys(t,e.child,null,a),t.child.memoizedState=Da(a),t.memoizedState=Na,o);if(0===(1&t.mode))return Ba(e,t,a,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Ba(e,t,a,r=ca(o=Error(i(419)),r,void 0))}if(l=0!==(a&e.childLanes),_a||l){if(null!==(r=Cl)){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|a))?0:s)&&s!==o.retryLane&&(o.retryLane=s,Is(e,s),tc(r,e,s,-1))}return fc(),Ba(e,t,a,r=ca(Error(i(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,ts=ar(s.nextSibling),es=t,ns=!0,is=null,null!==e&&(Wr[jr++]=Yr,Wr[jr++]=Kr,Wr[jr++]=Xr,Yr=e.id,Kr=e.overflow,Xr=t),t=$a(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,o,n);if(a){a=s.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==o?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Lc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Lc(r,a):(a=Nc(a,l,n,null)).flags|=2,a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=null===(l=e.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Na,s}return e=(a=e.child).sibling,s=Lc(a,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function $a(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ba(e,t,n,i){return null!==i&&ds(i),Ys(t,e.child,null,n),(e=$a(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fa(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ts(e.return,t,n)}function Ua(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function za(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(ba(e,t,i.children,n),0!==(2&(i=so.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fa(e,n,t);else if(19===e.tag)Fa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(wr(so,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===oo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ua(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===oo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ua(t,!0,n,null,s);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Va(e,t){if(!ns)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Wa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function ja(e,t,n){var r=t.pendingProps;switch(Qr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(t),null;case 1:case 17:return Rr(t.type)&&Ar(),Wa(t),null;case 3:return r=t.stateNode,no(),Sr(Ir),Sr(Mr),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(null===e||null===e.child)&&(cs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==is&&(sc(is),is=null))),Aa(e,t),Wa(t),null;case 5:ro(t);var o=eo(Qs.current);if(n=t.type,null!==e&&null!=t.stateNode)La(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Wa(t),null}if(e=eo(Js.current),cs(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[ur]=t,r[hr]=a,e=0!==(1&t.mode),n){case"dialog":$i("cancel",r),$i("close",r);break;case"iframe":case"object":case"embed":$i("load",r);break;case"video":case"audio":for(o=0;o<Oi.length;o++)$i(Oi[o],r);break;case"source":$i("error",r);break;case"img":case"image":case"link":$i("error",r),$i("load",r);break;case"details":$i("toggle",r);break;case"input":Y(r,a),$i("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},$i("invalid",r);break;case"textarea":ne(r,a),$i("invalid",r)}for(var l in me(n,a),o=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&qi(r.textContent,c,e),o=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&qi(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&$i("scroll",r)}switch(n){case"input":V(r),J(r,a,!0);break;case"textarea":V(r),re(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=Ji)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ur]=t,e[hr]=r,Ra(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":$i("cancel",e),$i("close",e),o=r;break;case"iframe":case"object":case"embed":$i("load",e),o=r;break;case"video":case"audio":for(o=0;o<Oi.length;o++)$i(Oi[o],e);o=r;break;case"source":$i("error",e),o=r;break;case"img":case"image":case"link":$i("error",e),$i("load",e),o=r;break;case"details":$i("toggle",e),o=r;break;case"input":Y(e,r),o=X(e,r),$i("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=D({},r,{value:void 0}),$i("invalid",e);break;case"textarea":ne(e,r),o=te(e,r),$i("invalid",e)}for(a in me(n,o),c=o)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?fe(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ce(e,u):"children"===a?"string"==typeof u?("textarea"!==n||""!==u)&&ue(e,u):"number"==typeof u&&ue(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&$i("scroll",e):null!=u&&v(e,a,u,l))}switch(n){case"input":V(e),J(e,r,!1);break;case"textarea":V(e),re(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ee(e,!!r.multiple,a,!1):null!=r.defaultValue&&ee(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wa(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(i(166));if(n=eo(Qs.current),eo(Js.current),cs(t)){if(r=t.stateNode,n=t.memoizedProps,r[ur]=t,(a=r.nodeValue!==n)&&null!==(e=es))switch(e.tag){case 3:qi(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qi(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ur]=t,t.stateNode=r}return Wa(t),null;case 13:if(Sr(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ns&&null!==ts&&0!==(1&t.mode)&&0===(128&t.flags))us(),hs(),t.flags|=98560,a=!1;else if(a=cs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[ur]=t}else hs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wa(t),a=!1}else null!==is&&(sc(is),is=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Ol&&(Ol=3):fc())),null!==t.updateQueue&&(t.flags|=4),Wa(t),null);case 4:return no(),Aa(e,t),null===e&&Ui(t.stateNode.containerInfo),Wa(t),null;case 10:return ys(t.type._context),Wa(t),null;case 19:if(Sr(so),null===(a=t.memoizedState))return Wa(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Va(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=oo(e))){for(t.flags|=128,Va(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return wr(so,1&so.current|2),t.child}e=e.sibling}null!==a.tail&&Ke()>zl&&(t.flags|=128,r=!0,Va(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=oo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Va(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ns)return Wa(t),null}else 2*Ke()-a.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,r=!0,Va(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ke(),t.sibling=null,n=so.current,wr(so,r?1&n|2:1&n),t):(Wa(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Wa(t),6&t.subtreeFlags&&(t.flags|=8192)):Wa(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xa(e,t){switch(Qr(t),t.tag){case 1:return Rr(t.type)&&Ar(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return no(),Sr(Ir),Sr(Mr),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ro(t),null;case 13:if(Sr(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sr(so),null;case 4:return no(),null;case 10:return ys(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ra=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Aa=function(){},La=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,eo(Js.current);var o,a=null;switch(n){case"input":r=X(e,r),i=X(e,i),a=[];break;case"select":r=D({},r,{value:void 0}),i=D({},i,{value:void 0}),a=[];break;case"textarea":r=te(e,r),i=te(e,i),a=[];break;default:"function"!=typeof r.onClick&&"function"==typeof i.onClick&&(e.onclick=Ji)}for(u in me(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&$i("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oa=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ya=!1,Ka=!1,qa="function"==typeof WeakSet?WeakSet:Set,Ja=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(i){Sc(e,t,i)}else n.current=null}function Qa(e,t,n){try{n()}catch(i){Sc(e,t,i)}}var el=!1;function tl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&Qa(t,n,s)}r=r.next}while(r!==i)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ur],delete t[hr],delete t[pr],delete t[fr],delete t[gr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function al(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Ji));else if(4!==i&&null!==(e=e.child))for(al(e,t,n),e=e.sibling;null!==e;)al(e,t,n),e=e.sibling}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)dl(e,t,n),n=n.sibling}function dl(e,t,n){if(it&&"function"==typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(nt,n)}catch{}switch(n.tag){case 5:Ka||Za(n,t);case 6:var i=cl,r=ul;cl=null,hl(e,t,n),ul=r,null!==(cl=i)&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?or(e.parentNode,n):1===e.nodeType&&or(e,n),Ut(e)):or(cl,n.stateNode));break;case 4:i=cl,r=ul,cl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),cl=i,ul=r;break;case 0:case 11:case 14:case 15:if(!Ka&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&Qa(n,t,o),r=r.next}while(r!==i)}hl(e,t,n);break;case 1:if(!Ka&&(Za(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Sc(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ka=(i=Ka)||null!==n.memoizedState,hl(e,t,n),Ka=i):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new qa),t.forEach((function(t){var i=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===cl)throw Error(i(160));dl(o,a,s),cl=null,ul=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){Sc(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),ml(e),4&r){try{tl(3,e,e.return),nl(3,e)}catch(m){Sc(e,e.return,m)}try{tl(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:fl(t,e),ml(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(fl(t,e),ml(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var s=e.stateNode;try{ue(s,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(s=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&K(s,o),ve(l,a);var u=ve(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?fe(s,d):"dangerouslySetInnerHTML"===h?ce(s,d):"children"===h?ue(s,d):v(s,h,d,u)}switch(l){case"input":q(s,o);break;case"textarea":ie(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ee(s,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ee(s,!!o.multiple,o.defaultValue,!0):ee(s,!!o.multiple,o.multiple?[]:"",!1))}s[hr]=o}catch(m){Sc(e,e.return,m)}}break;case 6:if(fl(t,e),ml(e),4&r){if(null===e.stateNode)throw Error(i(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(m){Sc(e,e.return,m)}}break;case 3:if(fl(t,e),ml(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:fl(t,e),ml(e);break;case 13:fl(t,e),ml(e),8192&(s=e.child).flags&&(o=null!==s.memoizedState,s.stateNode.isHidden=o,!o||null!==s.alternate&&null!==s.alternate.memoizedState||(Ul=Ke())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ka=(u=Ka)||h,fl(t,e),Ka=u):fl(t,e),ml(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Ja=e,h=e.child;null!==h;){for(d=Ja=h;null!==Ja;){switch(f=(p=Ja).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Za(p,p.return);var g=p.stateNode;if("function"==typeof g.componentWillUnmount){r=p,n=p.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){yl(d);continue}}null!==f?(f.return=p,Ja=f):yl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{s=d.stateNode,u?"function"==typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",a))}catch(m){Sc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:fl(t,e),ml(e),4&r&&pl(e);case 21:}}function ml(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(ue(s,""),r.flags&=-33),ll(e,ol(e),s);break;case 3:case 4:var o=r.stateNode.containerInfo;al(e,ol(e),o);break;default:throw Error(i(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Ja=e,_l(e)}function _l(e,t,n){for(var i=0!==(1&e.mode);null!==Ja;){var r=Ja,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Ya;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ka;a=Ya;var c=Ka;if(Ya=o,(Ka=l)&&!c)for(Ja=r;null!==Ja;)l=(o=Ja).child,22===o.tag&&null!==o.memoizedState?Tl(r):null!==l?(l.return=o,Ja=l):Tl(r);for(;null!==s;)Ja=s,_l(s),s=s.sibling;Ja=r,Ya=a,Ka=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Ja=s):bl(e)}}function bl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ka||nl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ka)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:fs(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ps(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ps(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(i(163))}Ka||512&t.flags&&il(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function yl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function Tl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Sc(t,r,l)}}var s=t.return;try{il(t)}catch(l){Sc(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Sc(t,o,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var El,Sl=Math.ceil,wl=_.ReactCurrentDispatcher,xl=_.ReactCurrentOwner,Ml=_.ReactCurrentBatchConfig,Il=0,Cl=null,kl=null,Rl=0,Al=0,Ll=Er(0),Ol=0,Nl=null,Dl=0,Pl=0,$l=0,Bl=null,Fl=null,Ul=0,zl=1/0,Hl=null,Gl=!1,Vl=null,Wl=null,jl=!1,Xl=null,Yl=0,Kl=0,ql=null,Jl=-1,Zl=0;function Ql(){return 0!==(6&Il)?Ke():-1!==Jl?Jl:Jl=Ke()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Rl?Rl&-Rl:null!==ps.transition?(0===Zl&&(Zl=pt()),Zl):(0!==(e=vt)||(e=void 0===(e=window.event)?16:Yt(e.type)),e)}function tc(e,t,n,r){if(50<Kl)throw Kl=0,ql=null,Error(i(185));gt(e,n,r),(0===(2&Il)||e!==Cl)&&(e===Cl&&(0===(2&Il)&&(Pl|=n),4===Ol&&oc(e,Rl)),nc(e,r),1===n&&0===Il&&0===(1&t.mode)&&(zl=Ke()+500,$r&&Ur()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-rt(s),a=1<<o,l=r[o];-1===l?(0===(a&n)||0!==(a&i))&&(r[o]=ht(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=ut(e,e===Cl?Rl:0);if(0===i)null!==n&&je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&je(n),1===t)0===e.tag?function(e){$r=!0,Fr(e)}(ac.bind(null,e)):Fr(ac.bind(null,e)),rr((function(){0===(6&Il)&&Ur()})),n=null;else{switch(_t(i)){case 1:n=Je;break;case 4:n=Ze;break;case 16:default:n=Qe;break;case 536870912:n=tt}n=Cc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Jl=-1,Zl=0,0!==(6&Il))throw Error(i(327));var n=e.callbackNode;if(Tc()&&e.callbackNode!==n)return null;var r=ut(e,e===Cl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var s=Il;Il|=2;var o=pc();for((Cl!==e||Rl!==t)&&(Hl=null,zl=Ke()+500,hc(e,t));;)try{vc();break}catch(l){dc(e,l)}bs(),wl.current=o,Il=s,null!==kl?t=0:(Cl=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(s=dt(e))&&(r=s,t=rc(e,s))),1===t)throw n=Nl,hc(e,0),oc(e,r),nc(e,Ke()),n;if(6===t)oc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!si(s(),r))return!1}catch{return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,r))&&(0!==(o=dt(e))&&(r=o,t=rc(e,o))),1===t))throw n=Nl,hc(e,0),oc(e,r),nc(e,Ke()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:yc(e,Fl,Hl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Ul+500-Ke())){if(0!==ut(e,0))break;if(((s=e.suspendedLanes)&r)!==r){Ql(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=tr(yc.bind(null,e,Fl,Hl),t);break}yc(e,Fl,Hl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-rt(r);o=1<<a,(a=t[a])>s&&(s=a),r&=~o}if(r=s,10<(r=(120>(r=Ke()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=tr(yc.bind(null,e,Fl,Hl),r);break}yc(e,Fl,Hl);break;default:throw Error(i(329))}}}return nc(e,Ke()),e.callbackNode===n?ic.bind(null,e):null}function rc(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Fl,Fl=n,null!==t&&sc(t)),e}function sc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function oc(e,t){for(t&=~$l,t&=~Pl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rt(t),i=1<<n;e[n]=-1,t&=~i}}function ac(e){if(0!==(6&Il))throw Error(i(327));Tc();var t=ut(e,0);if(0===(1&t))return nc(e,Ke()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=rc(e,r))}if(1===n)throw n=Nl,hc(e,0),oc(e,t),nc(e,Ke()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yc(e,Fl,Hl),nc(e,Ke()),null}function lc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(zl=Ke()+500,$r&&Ur())}}function cc(e){null!==Xl&&0===Xl.tag&&0===(6&Il)&&Tc();var t=Il;Il|=1;var n=Ml.transition,i=vt;try{if(Ml.transition=null,vt=1,e)return e()}finally{vt=i,Ml.transition=n,0===(6&(Il=t))&&Ur()}}function uc(){Al=Ll.current,Sr(Ll)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,nr(n)),null!==kl)for(n=kl.return;null!==n;){var i=n;switch(Qr(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Ar();break;case 3:no(),Sr(Ir),Sr(Mr),lo();break;case 5:ro(i);break;case 4:no();break;case 13:case 19:Sr(so);break;case 10:ys(i.type._context);break;case 22:case 23:uc()}n=n.return}if(Cl=e,kl=e=Lc(e.current,null),Rl=Al=t,Ol=0,Nl=null,$l=Pl=Dl=0,Fl=Bl=null,null!==ws){for(t=0;t<ws.length;t++)if(null!==(i=(n=ws[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}ws=null}return e}function dc(e,t){for(;;){var n=kl;try{if(bs(),co.current=ra,mo){for(var r=po.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}mo=!1}if(ho=0,go=fo=po=null,vo=!1,_o=0,xl.current=null,null===n||null===n.return){Ol=1,Nl=t,kl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,ma(f,a,l,0,t),1&f.mode&&fa(o,u,t),c=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){fa(o,u,t),fc();break e}c=Error(i(426))}else if(ns&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ma(v,a,l,0,t),ds(la(c,l));break e}}o=c=la(c,l),4!==Ol&&(Ol=2),null===Bl?Bl=[o]:Bl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ns(o,da(0,c,t));break e;case 1:l=c;var _=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"==typeof _.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Ns(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}bc(n)}catch(y){t=y,kl===n&&null!==n&&(kl=n=n.return);continue}break}}function pc(){var e=wl.current;return wl.current=ra,null===e?ra:e}function fc(){(0===Ol||3===Ol||2===Ol)&&(Ol=4),null===Cl||0===(268435455&Dl)&&0===(268435455&Pl)||oc(Cl,Rl)}function gc(e,t){var n=Il;Il|=2;var r=pc();for((Cl!==e||Rl!==t)&&(Hl=null,hc(e,t));;)try{mc();break}catch(s){dc(e,s)}if(bs(),Il=n,wl.current=r,null!==kl)throw Error(i(261));return Cl=null,Rl=0,Ol}function mc(){for(;null!==kl;)_c(kl)}function vc(){for(;null!==kl&&!Xe();)_c(kl)}function _c(e){var t=El(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?bc(e):kl=t,xl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=ja(n,t,Al)))return void(kl=n)}else{if(null!==(n=Xa(n,t)))return n.flags&=32767,void(kl=n);if(null===e)return Ol=6,void(kl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(kl=t);kl=t=e}while(null!==t);0===Ol&&(Ol=5)}function yc(e,t,n){var r=vt,s=Ml.transition;try{Ml.transition=null,vt=1,function(e,t,n,r){do{Tc()}while(null!==Xl);if(0!==(6&Il))throw Error(i(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-rt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Cl&&(kl=Cl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||jl||(jl=!0,Cc(Qe,(function(){return Tc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Ml.transition,Ml.transition=null;var a=vt;vt=1;var l=Il;Il|=4,xl.current=null,function(e,t){if(Zi=Ht,hi(e=ui())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==s&&3!==d.nodeType||(l=a+s),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===s&&(l=a),p===o&&++h===r&&(c=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qi={focusedElem:e,selectionRange:n},Ht=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?m:fs(t.type,m),v);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(i(163))}}catch(T){Sc(t,t.return,T)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}g=el,el=!1}(e,n),gl(n,e),di(Qi),Ht=!!Zi,Qi=Zi=null,e.current=n,vl(n),Ye(),Il=l,vt=a,Ml.transition=o}else e.current=n;if(jl&&(jl=!1,Xl=e,Yl=s),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(it&&"function"==typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch{}}(n.stateNode),nc(e,Ke()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Gl)throw Gl=!1,e=Vl,Vl=null,e;0!==(1&Yl)&&0!==e.tag&&Tc(),o=e.pendingLanes,0!==(1&o)?e===ql?Kl++:(Kl=0,ql=e):Kl=0,Ur()}(e,t,n,r)}finally{Ml.transition=s,vt=r}return null}function Tc(){if(null!==Xl){var e=_t(Yl),t=Ml.transition,n=vt;try{if(Ml.transition=null,vt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&Il))throw Error(i(331));var s=Il;for(Il|=4,Ja=e.current;null!==Ja;){var o=Ja,a=o.child;if(0!==(16&Ja.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ja=u;null!==Ja;){var h=Ja;switch(h.tag){case 0:case 11:case 15:tl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Ja=d;else for(;null!==Ja;){var p=(h=Ja).sibling,f=h.return;if(rl(h),h===u){Ja=null;break}if(null!==p){p.return=f,Ja=p;break}Ja=f}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Ja=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(o=Ja).flags))switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var _=o.sibling;if(null!==_){_.return=o.return,Ja=_;break e}Ja=o.return}}var b=e.current;for(Ja=b;null!==Ja;){var y=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,Ja=y;else e:for(a=b;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(E){Sc(l,l.return,E)}if(l===a){Ja=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,Ja=T;break e}Ja=l.return}}if(Il=s,Ur(),it&&"function"==typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(nt,e)}catch{}r=!0}return r}finally{vt=n,Ml.transition=t}}return!1}function Ec(e,t,n){e=Ls(e,t=da(0,t=la(n,t),1),1),t=Ql(),null!==e&&(gt(e,1,t),nc(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Wl||!Wl.has(i))){t=Ls(t,e=pa(t,e=la(n,e),1),1),e=Ql(),null!==t&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function wc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=Ql(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Ke()-Ul?hc(e,0):$l|=n),nc(e,t)}function xc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=Ql();null!==(e=Is(e,t))&&(gt(e,t,n),nc(e,n))}function Mc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),xc(e,n)}function Cc(e,t){return We(e,t)}function kc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,i){return new kc(e,t,n,i)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,s,o){var a=2;if(r=e,"function"==typeof e)Ac(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case T:return Nc(n.children,s,o,t);case E:a=8,s|=8;break;case S:return(e=Rc(12,n,t,2|s)).elementType=S,e.lanes=o,e;case I:return(e=Rc(13,n,t,s)).elementType=I,e.lanes=o,e;case C:return(e=Rc(19,n,t,s)).elementType=C,e.lanes=o,e;case A:return Dc(n,s,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case w:a=10;break e;case x:a=9;break e;case M:a=11;break e;case k:a=14;break e;case R:a=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,s)).elementType=e,t.type=r,t.lanes=o,t}function Nc(e,t,n,i){return(e=Rc(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=Rc(22,e,i,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Pc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function $c(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,i,r,s,o,a,l){return e=new Bc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ks(s),e}function Uc(e){if(!e)return xr;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Rr(n))return Or(e,n,t)}return t}function zc(e,t,n,i,r,s,o,a,l){return(e=Fc(n,i,!0,e,0,s,0,a,l)).context=Uc(null),n=e.current,(s=As(i=Ql(),r=ec(n))).callback=null!=t?t:null,Ls(n,s,r),e.current.lanes=r,gt(e,r,i),nc(e,i),e}function Hc(e,t,n,i){var r=t.current,s=Ql(),o=ec(r);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=As(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ls(r,t,o))&&(tc(e,r,o,s),Os(e,r,o)),o}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ir.current)_a=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _a=!1,function(e,t,n){switch(t.tag){case 3:Ca(t),hs();break;case 5:io(t);break;case 1:Rr(t.type)&&Nr(t);break;case 4:to(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;wr(gs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(wr(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Pa(e,t,n):(wr(so,1&so.current),null!==(e=Ga(e,t,n))?e.sibling:null);wr(so,1&so.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return za(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),wr(so,so.current),i)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ga(e,t,n)}(e,t,n);_a=0!==(131072&e.flags)}else _a=!1,ns&&0!==(1048576&t.flags)&&Jr(t,Vr,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var s=kr(t,Mr.current);Es(t,n),s=Eo(null,t,r,e,s,n);var o=So();return t.flags|=1,"object"==typeof s&&null!==s&&"function"==typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rr(r)?(o=!0,Nr(t)):o=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,ks(t),s.updater=Fs,t.stateNode=s,s._reactInternals=t,Gs(t,r,e,n),t=Ia(null,t,r,!0,o,n)):(t.tag=0,ns&&o&&Zr(t),ba(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"==typeof e)return Ac(e)?1:0;if(null!=e){if((e=e.$$typeof)===M)return 11;if(e===k)return 14}return 2}(r),e=fs(r,e),s){case 0:t=xa(null,t,r,e,n);break e;case 1:t=Ma(null,t,r,e,n);break e;case 11:t=ya(null,t,r,e,n);break e;case 14:t=Ta(null,t,r,fs(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,xa(e,t,r,s=t.elementType===r?s:fs(r,s),n);case 1:return r=t.type,s=t.pendingProps,Ma(e,t,r,s=t.elementType===r?s:fs(r,s),n);case 3:e:{if(Ca(t),null===e)throw Error(i(387));r=t.pendingProps,s=(o=t.memoizedState).element,Rs(e,t),Ds(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=ka(e,t,r,n,s=la(Error(i(423)),t));break e}if(r!==s){t=ka(e,t,r,n,s=la(Error(i(424)),t));break e}for(ts=ar(t.stateNode.containerInfo.firstChild),es=t,ns=!0,is=null,n=Ks(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hs(),r===s){t=Ga(e,t,n);break e}ba(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&as(t),r=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,a=s.children,er(r,s)?a=null:null!==o&&er(r,o)&&(t.flags|=32),wa(e,t),ba(e,t,a,n),t.child;case 6:return null===e&&as(t),null;case 13:return Pa(e,t,n);case 4:return to(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ys(t,null,r,n):ba(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,ya(e,t,r,s=t.elementType===r?s:fs(r,s),n);case 7:return ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,wr(gs,r._currentValue),r._currentValue=a,null!==o)if(si(o.value,a)){if(o.children===s.children&&!Ir.current){t=Ga(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=As(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ts(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(i(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ts(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ba(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Es(t,n),r=r(s=Ss(s)),t.flags|=1,ba(e,t,r,n),t.child;case 14:return s=fs(r=t.type,t.pendingProps),Ta(e,t,r,s=fs(r.type,s),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:fs(r,s),Ha(e,t),t.tag=1,Rr(r)?(e=!0,Nr(t)):e=!1,Es(t,n),zs(t,r,s),Gs(t,r,s,n),Ia(null,t,r,!0,e,n);case 19:return za(e,t,n);case 22:return Sa(e,t,n)}throw Error(i(156,t.tag))};var jc="function"==typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"==typeof r){var a=r;r=function(){var e=Gc(o);a.call(e)}}Hc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"==typeof i){var s=i;i=function(){var e=Gc(o);s.call(e)}}var o=zc(t,i,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[dr]=o.current,Ui(8===e.nodeType?e.parentNode:e),cc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof i){var a=i;i=function(){var e=Gc(l);a.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[dr]=l.current,Ui(8===e.nodeType?e.parentNode:e),cc((function(){Hc(t,l,n,i)})),l}(n,t,e,r,i);return Gc(o)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){Hc(null,e,null,null)})),t[dr]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Dt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ct(t.pendingLanes);0!==n&&(mt(t,1|n),nc(t,Ke()),0===(6&Il)&&(zl=Ke()+500,Ur()))}break;case 13:cc((function(){var t=Is(e,1);if(null!==t){var n=Ql();tc(t,e,1,n)}})),Wc(e,1)}},yt=function(e){if(13===e.tag){var t=Is(e,134217728);if(null!==t)tc(t,e,134217728,Ql());Wc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=ec(e),n=Is(e,t);if(null!==n)tc(n,e,t,Ql());Wc(e,t)}},Et=function(){return vt},St=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},ye=function(e,t,n){switch(t){case"input":if(q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=br(r);if(!s)throw Error(i(90));W(r),q(r,s)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ee(e,!!n.multiple,t,!1)}},Me=lc,Ie=cc;var Qc={usingClientEntryPoint:!1,Events:[vr,_r,br,we,xe,lc]},eu={findFiberByHostInstance:mr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{nt=nu.inject(tu),it=nu}catch{}}return cf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qc,cf.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(i(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:y,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},cf.createRoot=function(e,t){if(!Kc(e))throw Error(i(299));var n=!1,r="",s=jc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,s),e[dr]=t.current,Ui(8===e.nodeType?e.parentNode:e),new Xc(t)},cf.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=null===(e=Ge(t))?null:e.stateNode},cf.flushSync=function(e){return cc(e)},cf.hydrate=function(e,t,n){if(!qc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},cf.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,s=!1,o="",a=jc;if(null!=n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,s,0,o,a),e[dr]=t.current,Ui(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Yc(t)},cf.render=function(e,t,n){if(!qc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},cf.unmountComponentAtNode=function(e){if(!qc(e))throw Error(i(40));return!!e._reactRootContainer&&(cc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[dr]=null}))})),!0)},cf.unstable_batchedUpdates=lc,cf.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!qc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},cf.version="18.2.0-next-9e3b772b8-20220608",cf}!function(e){(function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||"function"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}})(),e.exports=gf()}(lf);var mf,vf=lf.exports;mf=vf.createRoot,vf.hydrateRoot;const _f=new yn,bf=new yn,yf=new yn;function Tf(e,t,n){const i=_f.setFromMatrixPosition(e.matrixWorld);i.project(t);const r=n.width/2,s=n.height/2;return[i.x*r+r,-i.y*s+s]}const Ef=e=>Math.abs(e)<1e-10?0:e;function Sf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i="matrix3d(";for(let r=0;16!==r;r++)i+=Ef(t[r]*e.elements[r])+(15!==r?",":")");return n+i}const wf=(e=>t=>Sf(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),xf=(e,t)=>Sf(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)");const Mf=e.forwardRef(((t,n)=>{let{children:i,eps:r=.001,style:s,className:o,prepend:a,center:l,fullscreen:c,portal:u,distanceFactor:h,sprite:d=!1,transform:p=!1,occlude:f,onOcclude:m,castShadow:v,receiveShadow:_,material:b,geometry:y,zIndexRange:T=[16777271,0],calculatePosition:E=Tf,as:S="div",wrapperClass:w,pointerEvents:x="auto",...M}=t;const{gl:I,camera:C,scene:k,size:R,raycaster:A,events:L,viewport:O}=yp(),[N]=e.useState((()=>document.createElement(S))),D=e.useRef(),P=e.useRef(null),$=e.useRef(0),B=e.useRef([0,0]),F=e.useRef(null),U=e.useRef(null),z=(null==u?void 0:u.current)||L.connected||I.domElement.parentNode,H=e.useRef(null),G=e.useRef(!1),V=e.useMemo((()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"==typeof e&&"current"in e}(f[0])),[f]);e.useLayoutEffect((()=>{const e=I.domElement;f&&"blending"===f?(e.style.zIndex="".concat(Math.floor(T[0]/2)),e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[f]),e.useLayoutEffect((()=>{if(P.current){const e=D.current=mf(N);if(k.updateMatrixWorld(),p)N.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=E(P.current,C,R);N.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return z&&(a?z.prepend(N):z.appendChild(N)),()=>{z&&z.removeChild(N),e.unmount()}}}),[z,p]),e.useLayoutEffect((()=>{w&&(N.className=w)}),[w]);const W=e.useMemo((()=>p?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:l?"translate3d(-50%,-50%,0)":"none",...c&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...s}),[s,l,c,R,p]),j=e.useMemo((()=>({position:"absolute",pointerEvents:x})),[x]);e.useLayoutEffect((()=>{var e,t;(G.current=!1,p)?null==(e=D.current)||e.render(Ld("div",{ref:F,style:W,children:Ld("div",{ref:U,style:j,children:Ld("div",{ref:n,className:o,style:s,children:i})})})):null==(t=D.current)||t.render(Ld("div",{ref:n,style:W,className:o,children:i}))}));const X=e.useRef(!0);Tp((e=>{if(P.current){C.updateMatrixWorld(),P.current.updateWorldMatrix(!0,!1);const e=p?B.current:E(P.current,C,R);if(p||Math.abs($.current-C.zoom)>r||Math.abs(B.current[0]-e[0])>r||Math.abs(B.current[1]-e[1])>r){const t=function(e,t){const n=_f.setFromMatrixPosition(e.matrixWorld),i=bf.setFromMatrixPosition(t.matrixWorld),r=n.sub(i),s=t.getWorldDirection(yf);return r.angleTo(s)>Math.PI/2}(P.current,C);let n=!1;V&&("blending"!==f?n=[k]:Array.isArray(f)&&(n=f.map((e=>e.current))));const i=X.current;if(n){const e=function(e,t,n,i){const r=_f.setFromMatrixPosition(e.matrixWorld),s=r.clone();s.project(t),n.setFromCamera(s,t);const o=n.intersectObjects(i,!0);if(o.length){const e=o[0].distance;return r.distanceTo(n.ray.origin)<e}return!0}(P.current,C,A,n);X.current=e&&!t}else X.current=!t;i!==X.current&&(m?m(!X.current):N.style.display=X.current?"block":"none");const r=Math.floor(T[0]/2),s=f?V?[T[0],r]:[r-1,0]:T;if(N.style.zIndex="".concat(function(e,t,n){if(t instanceof Er||t instanceof jr){const i=_f.setFromMatrixPosition(e.matrixWorld),r=bf.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(t.far-t.near),a=n[1]-o*t.far;return Math.round(o*s+a)}}(P.current,C,s)),p){const[e,t]=[R.width/2,R.height/2],n=C.projectionMatrix.elements[5]*t,{isOrthographicCamera:i,top:r,left:s,bottom:o,right:a}=C,l=wf(C.matrixWorldInverse),c=i?"scale(".concat(n,")translate(").concat(Ef(-(a+s)/2),"px,").concat(Ef((r+o)/2),"px)"):"translateZ(".concat(n,"px)");let u=P.current.matrixWorld;d&&(u=C.matrixWorldInverse.clone().transpose().copyPosition(u).scale(P.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),N.style.width=R.width+"px",N.style.height=R.height+"px",N.style.perspective=i?"":"".concat(n,"px"),F.current&&U.current&&(F.current.style.transform="".concat(c).concat(l,"translate(").concat(e,"px,").concat(t,"px)"),U.current.style.transform=xf(u,1/((h||10)/400)))}else{const t=void 0===h?1:function(e,t){if(t instanceof jr)return t.zoom;if(t instanceof Er){const n=_f.setFromMatrixPosition(e.matrixWorld),i=bf.setFromMatrixPosition(t.matrixWorld),r=t.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}return 1}(P.current,C)*h;N.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}B.current=e,$.current=C.zoom}}if(!V&&H.current&&!G.current)if(p){if(F.current){const e=F.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=C;if(t||y)M.scale&&(Array.isArray(M.scale)?M.scale instanceof yn?H.current.scale.copy(M.scale.clone().divideScalar(1)):H.current.scale.set(1/M.scale[0],1/M.scale[1],1/M.scale[2]):H.current.scale.setScalar(1/M.scale));else{const t=(h||10)/400,n=e.clientWidth*t,i=e.clientHeight*t;H.current.scale.set(n,i,1)}G.current=!0}}}else{const t=N.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/O.factor,n=t.clientWidth*e,i=t.clientHeight*e;H.current.scale.set(n,i,1),G.current=!0}H.current.lookAt(e.camera.position)}}));const Y=e.useMemo((()=>({vertexShader:p?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom" \n            is false. \n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n            \n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[p]);return Ld("group",{...M,ref:P,children:f&&!V&&Od("mesh",{castShadow:v,receiveShadow:_,ref:H,children:[y||Ld("planeGeometry",{}),b||Ld("shaderMaterial",{side:g,vertexShader:Y.vertexShader,fragmentShader:Y.fragmentShader})]})})}));function If(e){return function(t){e.forEach((function(e){"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const Cf=new yn,kf=new zh,Rf=new Rr,Af=new yn,Lf=new Oi;class Of{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new $f,this.unassigned=new $f,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.vertices.push(new Pf(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse((function(e){const n=e.geometry;if(void 0!==n){if(n.isGeometry)return void console.error("THREE.ConvexHull no longer supports Geometry. Use THREE.BufferGeometry instead.");if(n.isBufferGeometry){const i=n.attributes.position;if(void 0!==i)for(let n=0,r=i.count;n<r;n++){const r=new yn;r.fromBufferAttribute(i,n).applyMatrix4(e.matrixWorld),t.push(r)}}}})),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let n=0,i=t.length;n<i;n++)if(t[n].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const n=this.faces;let i=-1/0,r=1/0;for(let s=0,o=n.length;s<o;s++){const t=n[s],o=t.distanceToPoint(e.origin),a=t.normal.dot(e.direction);if(o>0&&a>=0)return null;const l=0!==a?-o/a:0;if(!(l<=0)&&(a>0?r=Math.min(l,r):i=Math.max(l,i),i>r))return null}return i!==-1/0?e.at(i,t):e.at(r,t),t}intersectsRay(e){return null!==this.intersectRay(e,Cf)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let n=e.outside;for(;null!==n.next&&n.next.face===e;)n=n.next;return this.assigned.removeSubList(t,n),t.prev=n.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const n=this.removeAllVerticesFromFace(e);if(void 0!==n)if(void 0===t)this.unassigned.appendChain(n);else{let e=n;do{const n=e.next;t.distanceToPoint(e.point)>this.tolerance?this.addVertexToFace(e,t):this.unassigned.append(e),e=n}while(null!==e)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const n=t.next;let i=this.tolerance,r=null;for(let s=0;s<e.length;s++){const n=e[s];if(0===n.mark){const e=n.distanceToPoint(t.point);if(e>i&&(i=e,r=n),i>1e3*this.tolerance)break}}null!==r&&this.addVertexToFace(t,r),t=n}while(null!==t)}return this}computeExtremes(){const e=new yn,t=new yn,n=[],i=[];for(let r=0;r<3;r++)n[r]=i[r]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let r=0,s=this.vertices.length;r<s;r++){const s=this.vertices[r],o=s.point;for(let t=0;t<3;t++)o.getComponent(t)<e.getComponent(t)&&(e.setComponent(t,o.getComponent(t)),n[t]=s);for(let e=0;e<3;e++)o.getComponent(e)>t.getComponent(e)&&(t.setComponent(e,o.getComponent(e)),i[e]=s)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:n,max:i}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),n=t.min,i=t.max;let r=0,s=0;for(let h=0;h<3;h++){const e=i[h].point.getComponent(h)-n[h].point.getComponent(h);e>r&&(r=e,s=h)}const o=n[s],a=i[s];let l,c;r=0,kf.set(o.point,a.point);for(let h=0,d=this.vertices.length;h<d;h++){const t=e[h];if(t!==o&&t!==a){kf.closestPointToPoint(t.point,!0,Af);const e=Af.distanceToSquared(t.point);e>r&&(r=e,l=t)}}r=-1,Rf.setFromCoplanarPoints(o.point,a.point,l.point);for(let h=0,d=this.vertices.length;h<d;h++){const t=e[h];if(t!==o&&t!==a&&t!==l){const e=Math.abs(Rf.distanceToPoint(t.point));e>r&&(r=e,c=t)}}const u=[];if(Rf.distanceToPoint(c.point)<0){u.push(Nf.create(o,a,l),Nf.create(c,a,o),Nf.create(c,l,a),Nf.create(c,o,l));for(let e=0;e<3;e++){const t=(e+1)%3;u[e+1].getEdge(2).setTwin(u[0].getEdge(t)),u[e+1].getEdge(1).setTwin(u[t+1].getEdge(0))}}else{u.push(Nf.create(o,l,a),Nf.create(c,o,a),Nf.create(c,a,l),Nf.create(c,l,o));for(let e=0;e<3;e++){const t=(e+1)%3;u[e+1].getEdge(2).setTwin(u[0].getEdge((3-e)%3)),u[e+1].getEdge(0).setTwin(u[t+1].getEdge(1))}}for(let h=0;h<4;h++)this.faces.push(u[h]);for(let h=0,d=e.length;h<d;h++){const t=e[h];if(t!==o&&t!==a&&t!==l&&t!==c){r=this.tolerance;let e=null;for(let n=0;n<4;n++){const i=this.faces[n].distanceToPoint(t.point);i>r&&(r=i,e=this.faces[n])}null!==e&&this.addVertexToFace(t,e)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const n=this.faces[t];0===n.mark&&e.push(n)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const n=this.assigned.first().face;let i=n.outside;do{const r=n.distanceToPoint(i.point);r>t&&(t=r,e=i),i=i.next}while(null!==i&&i.face===n);return e}}computeHorizon(e,t,n,i){let r;this.deleteFaceVertices(n),n.mark=1,r=null===t?t=n.getEdge(0):t.next;do{const t=r.twin,n=t.face;0===n.mark&&(n.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,t,n,i):i.push(r)),r=r.next}while(r!==t);return this}addAdjoiningFace(e,t){const n=Nf.create(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setTwin(t.twin),n.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let n=null,i=null;for(let r=0;r<t.length;r++){const s=t[r],o=this.addAdjoiningFace(e,s);null===n?n=o:o.next.setTwin(i),this.newFaces.push(o.face),i=o}return n.next.setTwin(i),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class Nf{constructor(){this.normal=new yn,this.midpoint=new yn,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,n){const i=new Nf,r=new Df(e,i),s=new Df(t,i),o=new Df(n,i);return r.next=o.prev=s,s.next=r.prev=o,o.next=s.prev=r,i.edge=r,i.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),n=this.edge.next.head();return Lf.set(e.point,t.point,n.point),Lf.getNormal(this.normal),Lf.getMidpoint(this.midpoint),this.area=Lf.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class Df{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class Pf{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class $f{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class Bf extends qi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super();const t=[],n=[];void 0===Of&&console.error("THREE.ConvexGeometry: ConvexGeometry relies on ConvexHull");const i=(new Of).setFromPoints(e).faces;for(let r=0;r<i.length;r++){const e=i[r];let s=e.edge;do{const i=s.head().point;t.push(i.x,i.y,i.z),n.push(e.normal.x,e.normal.y,e.normal.z),s=s.next}while(s!==e.edge)}this.setAttribute("position",new Hi(t,3)),this.setAttribute("normal",new Hi(n,3))}}function Ff(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Uf=(e,t)=>{const n=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},o={},a=e[0].morphTargetsRelative,l=new qi;let c=0;if(e.forEach(((e,u)=>{let h=0;if(n!==(null!==e.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let t in e.attributes){if(!i.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[t]&&(s[t]=[]),s[t].push(e.attributes[t]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==e.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let t in e.morphAttributes){if(!r.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[t]&&(o[t]=[]),o[t].push(e.morphAttributes[t])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(e.userData),t){let t;if(e.index)t=e.index.count;else{if(void 0===e.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;t=e.attributes.position.count}l.addGroup(c,t,u),c+=t}})),n){let t=0;const n=[];e.forEach((e=>{const i=e.index;for(let r=0;r<i.count;++r)n.push(i.getX(r)+t);t+=e.attributes.position.count})),l.setIndex(n)}for(let u in s){const e=zf(s[u]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,e)}for(let u in o){const e=o[u][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let t=0;t<e;++t){const e=[];for(let i=0;i<o[u].length;++i)e.push(o[u][i][t]);const n=zf(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(n)}}return l},zf=e=>{let t,n,i,r=0;if(e.forEach((e=>(void 0===t&&(t=e.array.constructor),t!==e.array.constructor?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null):(void 0===n&&(n=e.itemSize),n!==e.itemSize?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null):(void 0===i&&(i=e.normalized),i!==e.normalized?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null):void(r+=e.array.length)))))),t&&n){const s=new t(r);let o=0;return e.forEach((e=>{s.set(e.array,o),o+=e.array.length})),new Fi(s,n,i)}},Hf=(e,t)=>(e%t+t)%t;class Gf extends Lt{constructor(e,t){super(),Ff(this,"object",void 0),Ff(this,"domElement",void 0),Ff(this,"enabled",!0),Ff(this,"target",new yn),Ff(this,"minDistance",0),Ff(this,"maxDistance",1/0),Ff(this,"minZoom",0),Ff(this,"maxZoom",1/0),Ff(this,"minPolarAngle",0),Ff(this,"maxPolarAngle",Math.PI),Ff(this,"minAzimuthAngle",-1/0),Ff(this,"maxAzimuthAngle",1/0),Ff(this,"enableDamping",!1),Ff(this,"dampingFactor",.05),Ff(this,"enableZoom",!0),Ff(this,"zoomSpeed",1),Ff(this,"enableRotate",!0),Ff(this,"rotateSpeed",1),Ff(this,"enablePan",!0),Ff(this,"panSpeed",1),Ff(this,"screenSpacePanning",!0),Ff(this,"keyPanSpeed",7),Ff(this,"autoRotate",!1),Ff(this,"autoRotateSpeed",2),Ff(this,"reverseOrbit",!1),Ff(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ff(this,"mouseButtons",{LEFT:s.ROTATE,MIDDLE:s.DOLLY,RIGHT:s.PAN}),Ff(this,"touches",{ONE:o.ROTATE,TWO:o.DOLLY_PAN}),Ff(this,"target0",void 0),Ff(this,"position0",void 0),Ff(this,"zoom0",void 0),Ff(this,"_domElementKeyEvents",null),Ff(this,"getPolarAngle",void 0),Ff(this,"getAzimuthalAngle",void 0),Ff(this,"setPolarAngle",void 0),Ff(this,"setAzimuthalAngle",void 0),Ff(this,"getDistance",void 0),Ff(this,"listenToKeyEvents",void 0),Ff(this,"saveState",void 0),Ff(this,"reset",void 0),Ff(this,"update",void 0),Ff(this,"connect",void 0),Ff(this,"dispose",void 0),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof Er?this.object.zoom:1,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=e=>{let t=Hf(e,2*Math.PI),i=h.phi;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),d.phi=t-i,n.update()},this.setAzimuthalAngle=e=>{let t=Hf(e,2*Math.PI),i=h.theta;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),d.theta=t-i,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",Y),this._domElementKeyEvents=e},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object instanceof Er?n.object.zoom:1},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object instanceof Er&&(n.object.zoom=n.zoom0,n.object.updateProjectionMatrix()),n.dispatchEvent(i),n.update(),c=l.NONE},this.update=(()=>{const t=new yn,r=(new bn).setFromUnitVectors(e.up,new yn(0,1,0)),s=r.clone().invert(),o=new yn,a=new bn,m=2*Math.PI;return function(){const e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(r),h.setFromVector3(t),n.autoRotate&&c===l.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(h.theta+=d.theta*n.dampingFactor,h.phi+=d.phi*n.dampingFactor):(h.theta+=d.theta,h.phi+=d.phi);let v=n.minAzimuthAngle,_=n.maxAzimuthAngle;return isFinite(v)&&isFinite(_)&&(v<-Math.PI?v+=m:v>Math.PI&&(v-=m),_<-Math.PI?_+=m:_>Math.PI&&(_-=m),h.theta=v<=_?Math.max(v,Math.min(_,h.theta)):h.theta>(v+_)/2?Math.max(v,h.theta):Math.min(_,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=p,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),!0===n.enableDamping?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),t.setFromSpherical(h),t.applyQuaternion(s),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),f.set(0,0,0)),p=1,!!(g||o.distanceToSquared(n.object.position)>u||8*(1-a.dot(n.object.quaternion))>u)&&(n.dispatchEvent(i),o.copy(n.object.position),a.copy(n.object.quaternion),g=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",K),n.domElement.addEventListener("pointerdown",G),n.domElement.addEventListener("pointercancel",j),n.domElement.addEventListener("wheel",X)},this.dispose=()=>{var e,t,i,r,s,o;null===(e=n.domElement)||void 0===e||e.removeEventListener("contextmenu",K),null===(t=n.domElement)||void 0===t||t.removeEventListener("pointerdown",G),null===(i=n.domElement)||void 0===i||i.removeEventListener("pointercancel",j),null===(r=n.domElement)||void 0===r||r.removeEventListener("wheel",X),null===(s=n.domElement)||void 0===s||s.ownerDocument.removeEventListener("pointermove",V),null===(o=n.domElement)||void 0===o||o.ownerDocument.removeEventListener("pointerup",W),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Y)};const n=this,i={type:"change"},r={type:"start"},a={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=l.NONE;const u=1e-6,h=new $h,d=new $h;let p=1;const f=new yn;let g=!1;const m=new Wt,v=new Wt,_=new Wt,b=new Wt,y=new Wt,T=new Wt,E=new Wt,S=new Wt,w=new Wt,x=[],M={};function I(){return Math.pow(.95,n.zoomSpeed)}function C(e){n.reverseOrbit?d.theta+=e:d.theta-=e}function k(e){n.reverseOrbit?d.phi+=e:d.phi-=e}const R=(()=>{const e=new yn;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),f.add(e)}})(),A=(()=>{const e=new yn;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),f.add(e)}})(),L=(()=>{const e=new yn;return function(t,i){const r=n.domElement;if(r&&n.object instanceof Er&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let o=e.length();o*=Math.tan(n.object.fov/2*Math.PI/180),R(2*t*o/r.clientHeight,n.object.matrix),A(2*i*o/r.clientHeight,n.object.matrix)}else r&&n.object instanceof jr&&n.object.isOrthographicCamera?(R(t*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),A(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function O(e){n.object instanceof Er&&n.object.isPerspectiveCamera?p/=e:n.object instanceof jr&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(e){n.object instanceof Er&&n.object.isPerspectiveCamera?p*=e:n.object instanceof jr&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function D(e){m.set(e.clientX,e.clientY)}function P(e){b.set(e.clientX,e.clientY)}function $(){if(1==x.length)m.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);m.set(e,t)}}function B(){if(1==x.length)b.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);b.set(e,t)}}function F(){const e=x[0].pageX-x[1].pageX,t=x[0].pageY-x[1].pageY,n=Math.sqrt(e*e+t*t);E.set(0,n)}function U(e){if(1==x.length)v.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);v.set(n,i)}_.subVectors(v,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*_.x/t.clientHeight),k(2*Math.PI*_.y/t.clientHeight)),m.copy(v)}function z(e){if(1==x.length)y.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);y.set(n,i)}T.subVectors(y,b).multiplyScalar(n.panSpeed),L(T.x,T.y),b.copy(y)}function H(e){const t=Z(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);S.set(0,s),w.set(0,Math.pow(S.y/E.y,n.zoomSpeed)),O(w.y),E.copy(S)}function G(e){if(!1!==n.enabled){var t,i;if(0===x.length)null===(t=n.domElement)||void 0===t||t.ownerDocument.addEventListener("pointermove",V),null===(i=n.domElement)||void 0===i||i.ownerDocument.addEventListener("pointerup",W);(function(e){x.push(e)})(e),"touch"===e.pointerType?function(e){switch(J(e),x.length){case 1:switch(n.touches.ONE){case o.ROTATE:if(!1===n.enableRotate)return;$(),c=l.TOUCH_ROTATE;break;case o.PAN:if(!1===n.enablePan)return;B(),c=l.TOUCH_PAN;break;default:c=l.NONE}break;case 2:switch(n.touches.TWO){case o.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&F(),n.enablePan&&B(),c=l.TOUCH_DOLLY_PAN;break;case o.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&F(),n.enableRotate&&$(),c=l.TOUCH_DOLLY_ROTATE;break;default:c=l.NONE}break;default:c=l.NONE}c!==l.NONE&&n.dispatchEvent(r)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case s.DOLLY:if(!1===n.enableZoom)return;(function(e){E.set(e.clientX,e.clientY)})(e),c=l.DOLLY;break;case s.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;P(e),c=l.PAN}else{if(!1===n.enableRotate)return;D(e),c=l.ROTATE}break;case s.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;D(e),c=l.ROTATE}else{if(!1===n.enablePan)return;P(e),c=l.PAN}break;default:c=l.NONE}c!==l.NONE&&n.dispatchEvent(r)}(e)}}function V(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(J(e),c){case l.TOUCH_ROTATE:if(!1===n.enableRotate)return;U(e),n.update();break;case l.TOUCH_PAN:if(!1===n.enablePan)return;z(e),n.update();break;case l.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(e){n.enableZoom&&H(e),n.enablePan&&z(e)})(e),n.update();break;case l.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(e){n.enableZoom&&H(e),n.enableRotate&&U(e)})(e),n.update();break;default:c=l.NONE}}(e):function(e){if(!1!==n.enabled)switch(c){case l.ROTATE:if(!1===n.enableRotate)return;!function(e){v.set(e.clientX,e.clientY),_.subVectors(v,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*_.x/t.clientHeight),k(2*Math.PI*_.y/t.clientHeight)),m.copy(v),n.update()}(e);break;case l.DOLLY:if(!1===n.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),w.subVectors(S,E),w.y>0?O(I()):w.y<0&&N(I()),E.copy(S),n.update()}(e);break;case l.PAN:if(!1===n.enablePan)return;!function(e){y.set(e.clientX,e.clientY),T.subVectors(y,b).multiplyScalar(n.panSpeed),L(T.x,T.y),b.copy(y),n.update()}(e)}}(e))}function W(e){var t,i,r;(q(e),0===x.length)&&(null===(t=n.domElement)||void 0===t||t.releasePointerCapture(e.pointerId),null===(i=n.domElement)||void 0===i||i.ownerDocument.removeEventListener("pointermove",V),null===(r=n.domElement)||void 0===r||r.ownerDocument.removeEventListener("pointerup",W));n.dispatchEvent(a),c=l.NONE}function j(e){q(e)}function X(e){!1===n.enabled||!1===n.enableZoom||c!==l.NONE&&c!==l.ROTATE||(e.preventDefault(),n.dispatchEvent(r),function(e){e.deltaY<0?N(I()):e.deltaY>0&&O(I()),n.update()}(e),n.dispatchEvent(a))}function Y(e){!1===n.enabled||!1===n.enablePan||function(e){let t=!1;switch(e.code){case n.keys.UP:L(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:L(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:L(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:L(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function K(e){!1!==n.enabled&&e.preventDefault()}function q(e){delete M[e.pointerId];for(let t=0;t<x.length;t++)if(x[t].pointerId==e.pointerId)return void x.splice(t,1)}function J(e){let t=M[e.pointerId];void 0===t&&(t=new Wt,M[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){const t=e.pointerId===x[0].pointerId?x[1]:x[0];return M[t.pointerId]}void 0!==t&&this.connect(t),this.update()}}const Vf=new yn;function Wf(e,t,n,i,r,s){const o=2*Math.PI*r/4,a=Math.max(s-2*r,0),l=Math.PI/4;Vf.copy(t),Vf[i]=0,Vf.normalize();const c=.5*o/(o+a),u=1-Vf.angleTo(e)/l;return 1===Math.sign(Vf[n])?u*c:a/(o+a)+c+c*(1-u)}class jf extends mr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1;if(i=2*i+1,r=Math.min(e/2,t/2,n/2,r),super(1,1,1,i,i,i),1===i)return;const s=this.toNonIndexed();this.index=null,this.attributes.position=s.attributes.position,this.attributes.normal=s.attributes.normal,this.attributes.uv=s.attributes.uv;const o=new yn,a=new yn,l=new yn(e,t,n).divideScalar(2).subScalar(r),c=this.attributes.position.array,u=this.attributes.normal.array,h=this.attributes.uv.array,d=c.length/6,p=new yn,f=.5/i;for(let g=0,m=0;g<c.length;g+=3,m+=2)switch(o.fromArray(c,g),a.copy(o),a.x-=Math.sign(a.x)*f,a.y-=Math.sign(a.y)*f,a.z-=Math.sign(a.z)*f,a.normalize(),c[g+0]=l.x*Math.sign(o.x)+a.x*r,c[g+1]=l.y*Math.sign(o.y)+a.y*r,c[g+2]=l.z*Math.sign(o.z)+a.z*r,u[g+0]=a.x,u[g+1]=a.y,u[g+2]=a.z,Math.floor(g/d)){case 0:p.set(1,0,0),h[m+0]=Wf(p,a,"z","y",r,n),h[m+1]=1-Wf(p,a,"y","z",r,t);break;case 1:p.set(-1,0,0),h[m+0]=1-Wf(p,a,"z","y",r,n),h[m+1]=1-Wf(p,a,"y","z",r,t);break;case 2:p.set(0,1,0),h[m+0]=1-Wf(p,a,"x","z",r,e),h[m+1]=Wf(p,a,"z","x",r,n);break;case 3:p.set(0,-1,0),h[m+0]=1-Wf(p,a,"x","z",r,e),h[m+1]=1-Wf(p,a,"z","x",r,n);break;case 4:p.set(0,0,1),h[m+0]=1-Wf(p,a,"x","y",r,e),h[m+1]=1-Wf(p,a,"y","x",r,t);break;case 5:p.set(0,0,-1),h[m+0]=Wf(p,a,"x","y",r,e),h[m+1]=1-Wf(p,a,"y","x",r,t)}}}const Xf=new Sn,Yf=new yn;class Kf extends eh{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new Hi([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new Hi([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Oh(t,6,1);return this.setAttribute("instanceStart",new Sa(n,3,0)),this.setAttribute("instanceEnd",new Sa(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Oh(t,6,1);return this.setAttribute("instanceColorStart",new Sa(n,3,0)),this.setAttribute("instanceColorEnd",new Sa(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Wc(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Sn);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Xf.setFromBufferAttribute(t),this.boundingBox.union(Xf))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Hn),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let r=0,s=e.count;r<s;r++)Yf.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(Yf)),Yf.fromBufferAttribute(t,r),i=Math.max(i,n.distanceToSquared(Yf));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class qf extends Kf{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setColors(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}Br.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Wt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},Fr.line={uniforms:br.merge([Br.common,Br.fog,Br.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 offset;\n\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t}\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t#endif\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t// set the world position\n\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class Jf extends yr{constructor(e){super({type:"LineMaterial",uniforms:br.clone(Fr.line.uniforms),vertexShader:Fr.line.vertexShader,fragmentShader:Fr.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(e){Boolean(e)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)},set:function(e){Boolean(e)!==Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const Zf=new yn,Qf=new yn,eg=new gn,tg=new gn,ng=new gn,ig=new yn,rg=new Jn,sg=new zh,og=new yn,ag=new Sn,lg=new Hn,cg=new gn;let ug,hg,dg,pg;function fg(e,t,n){return cg.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),cg.multiplyScalar(1/cg.w),cg.x=pg/n.width,cg.y=pg/n.height,cg.applyMatrix4(e.projectionMatrixInverse),cg.multiplyScalar(1/cg.w),Math.abs(Math.max(cg.x,cg.y))}class gg extends fr{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kf,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Jf({color:16777215*Math.random()})),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let s=0,o=0,a=t.count;s<a;s++,o+=2)Zf.fromBufferAttribute(t,s),Qf.fromBufferAttribute(n,s),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+Zf.distanceTo(Qf);const r=new Oh(i,2,1);return e.setAttribute("instanceDistanceStart",new Sa(r,1,0)),e.setAttribute("instanceDistanceEnd",new Sa(r,1,1)),this}raycast(e,t){const n=this.material.worldUnits,i=e.camera;null===i&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const r=void 0!==e.params.Line2&&e.params.Line2.threshold||0;ug=e.ray;const s=this.matrixWorld,o=this.geometry,a=this.material;let l,c;if(pg=a.linewidth+r,hg=o.attributes.instanceStart,dg=o.attributes.instanceEnd,null===o.boundingSphere&&o.computeBoundingSphere(),lg.copy(o.boundingSphere).applyMatrix4(s),n)l=.5*pg;else{l=fg(i,Math.max(i.near,lg.distanceToPoint(ug.origin)),a.resolution)}if(lg.radius+=l,!1!==ug.intersectsSphere(lg)){if(null===o.boundingBox&&o.computeBoundingBox(),ag.copy(o.boundingBox).applyMatrix4(s),n)c=.5*pg;else{c=fg(i,Math.max(i.near,ag.distanceToPoint(ug.origin)),a.resolution)}ag.expandByScalar(c),!1!==ug.intersectsBox(ag)&&(n?function(e,t){for(let n=0,i=hg.count;n<i;n++){sg.start.fromBufferAttribute(hg,n),sg.end.fromBufferAttribute(dg,n);const i=new yn,r=new yn;ug.distanceSqToSegment(sg.start,sg.end,r,i),r.distanceTo(i)<.5*pg&&t.push({point:r,pointOnLine:i,distance:ug.origin.distanceTo(r),object:e,face:null,faceIndex:n,uv:null,uv2:null})}}(this,t):function(e,t,n){const i=t.projectionMatrix,r=e.material.resolution,s=e.matrixWorld,o=e.geometry,a=o.attributes.instanceStart,l=o.attributes.instanceEnd,c=-t.near;ug.at(1,ng),ng.w=1,ng.applyMatrix4(t.matrixWorldInverse),ng.applyMatrix4(i),ng.multiplyScalar(1/ng.w),ng.x*=r.x/2,ng.y*=r.y/2,ng.z=0,ig.copy(ng),rg.multiplyMatrices(t.matrixWorldInverse,s);for(let u=0,h=a.count;u<h;u++){if(eg.fromBufferAttribute(a,u),tg.fromBufferAttribute(l,u),eg.w=1,tg.w=1,eg.applyMatrix4(rg),tg.applyMatrix4(rg),eg.z>c&&tg.z>c)continue;if(eg.z>c){const e=eg.z-tg.z,t=(eg.z-c)/e;eg.lerp(tg,t)}else if(tg.z>c){const e=tg.z-eg.z,t=(tg.z-c)/e;tg.lerp(eg,t)}eg.applyMatrix4(i),tg.applyMatrix4(i),eg.multiplyScalar(1/eg.w),tg.multiplyScalar(1/tg.w),eg.x*=r.x/2,eg.y*=r.y/2,tg.x*=r.x/2,tg.y*=r.y/2,sg.start.copy(eg),sg.start.z=0,sg.end.copy(tg),sg.end.z=0;const t=sg.closestPointToPointParameter(ig,!0);sg.at(t,og);const o=Vt.lerp(eg.z,tg.z,t),h=o>=-1&&o<=1,d=ig.distanceTo(og)<.5*pg;if(h&&d){sg.start.fromBufferAttribute(a,u),sg.end.fromBufferAttribute(l,u),sg.start.applyMatrix4(s),sg.end.applyMatrix4(s);const t=new yn,i=new yn;ug.distanceSqToSegment(sg.start,sg.end,i,t),n.push({point:i,pointOnLine:t,distance:ug.origin.distanceTo(i),object:e,face:null,faceIndex:u,uv:null,uv2:null})}}}(this,i,t))}}}class mg extends gg{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qf,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Jf({color:16777215*Math.random()})),this.isLine2=!0,this.type="Line2"}}const vg=e.forwardRef((function(t,n){let{follow:i=!0,lockX:r=!1,lockY:s=!1,lockZ:o=!1,...a}=t;const l=e.useRef();return Tp((e=>{let{camera:t}=e;if(!i||!l.current)return;const n=l.current.rotation.clone();t.getWorldQuaternion(l.current.quaternion),r&&(l.current.rotation.x=n.x),s&&(l.current.rotation.y=n.y),o&&(l.current.rotation.z=n.z)})),Ld("group",{ref:If([l,n]),...a})})),_g=e.forwardRef((function(t,n){let{points:i,color:r="black",vertexColors:s,linewidth:o,lineWidth:a,segments:l,dashed:c,...u}=t;const h=yp((e=>e.size)),d=e.useMemo((()=>l?new gg:new mg),[l]),[p]=e.useState((()=>new Jf)),f=e.useMemo((()=>{const e=l?new Kf:new qf,t=i.map((e=>{const t=Array.isArray(e);return e instanceof yn?[e.x,e.y,e.z]:e instanceof Wt?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(e.setPositions(t.flat()),s){const t=s.map((e=>e instanceof ln?e.toArray():e));e.setColors(t.flat())}return e}),[i,l,s]);return e.useLayoutEffect((()=>{d.computeLineDistances()}),[i,d]),e.useLayoutEffect((()=>{c?p.defines.USE_DASH="":delete p.defines.USE_DASH,p.needsUpdate=!0}),[c,p]),e.useEffect((()=>()=>f.dispose()),[f]),Od("primitive",{object:d,ref:n,...u,children:[Ld("primitive",{object:f,attach:"geometry"}),Ld("primitive",{object:p,attach:"material",color:r,vertexColors:Boolean(s),resolution:[h.width,h.height],linewidth:null!=o?o:a,dashed:c,...u})]})}));function bg(){var e=Object.create(null);function t(i,r){var s=i.id,o=i.name,a=i.dependencies;void 0===a&&(a=[]);var l=i.init;void 0===l&&(l=function(){});var c=i.getTransferables;if(void 0===c&&(c=null),!e[s])try{a=a.map((function(n){return n&&n.isWorkerModule&&(t(n,(function(e){if(e instanceof Error)throw e})),n=e[n.id].value),n})),l=n("<"+o+">.init",l),c&&(c=n("<"+o+">.getTransferables",c));var u=null;"function"==typeof l?u=l.apply(void 0,a):console.error("worker module init function failed to rehydrate"),e[s]={id:s,value:u,getTransferables:c},r(u)}catch(h){h&&h.noLog||console.error(h),r(h)}}function n(e,t){var n=void 0;self.troikaDefine=function(e){return n=e};var i=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(i)}catch(r){console.error(r)}return URL.revokeObjectURL(i),delete self.troikaDefine,n}self.addEventListener("message",(function(n){var i=n.data,r=i.messageId,s=i.action,o=i.data;try{"registerModule"===s&&t(o,(function(e){e instanceof Error?postMessage({messageId:r,success:!1,error:e.message}):postMessage({messageId:r,success:!0,result:{isCallable:"function"==typeof e}})})),"callModule"===s&&function(t,n){var i,r=t.id,s=t.args;(!e[r]||"function"!=typeof e[r].value)&&n(new Error("Worker module "+r+": not found or its 'init' did not return a function"));try{var o=(i=e[r]).value.apply(i,s);o&&"function"==typeof o.then?o.then(a,(function(e){return n(e instanceof Error?e:new Error(""+e))})):a(o)}catch(l){n(l)}function a(t){try{var i=e[r].getTransferables&&e[r].getTransferables(t);(!i||!Array.isArray(i)||!i.length)&&(i=void 0),n(t,i)}catch(s){console.error(s),n(s)}}}(o,(function(e,t){e instanceof Error?postMessage({messageId:r,success:!1,error:e.message}):postMessage({messageId:r,success:!0,result:e},t||void 0)}))}catch(a){postMessage({messageId:r,success:!1,error:a.stack})}}))}var yg=function(){var e=!1;if(typeof window<"u"&&typeof window.document<"u")try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return yg=function(){return e},e},Tg=0,Eg=0,Sg=!1,wg=Object.create(null),xg=Object.create(null),Mg=Object.create(null);function Ig(e){if((!e||"function"!=typeof e.init)&&!Sg)throw new Error("requires `options.init` function");var t=e.dependencies,n=e.init,i=e.getTransferables,r=e.workerId;if(!yg())return function(e){var t=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return t._getInitResult().then((function(t){if("function"==typeof t)return t.apply(void 0,e);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return t._getInitResult=function(){var n=e.dependencies,i=e.init;n=Array.isArray(n)?n.map((function(e){return e&&e._getInitResult?e._getInitResult():e})):[];var r=Promise.all(n).then((function(e){return i.apply(null,e)}));return t._getInitResult=function(){return r},r},t}(e);null==r&&(r="#default");var s="workerModule"+ ++Tg,o=e.name||s,a=null;function l(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!a){a=kg(r,"registerModule",l.workerModuleData);var n=function(){a=null,xg[r].delete(n)};(xg[r]||(xg[r]=new Set)).add(n)}return a.then((function(t){if(t.isCallable)return kg(r,"callModule",{id:s,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return t=t&&t.map((function(e){return"function"==typeof e&&!e.workerModuleData&&(Sg=!0,e=Ig({workerId:r,name:"<"+o+"> function dependency: "+e.name,init:"function(){return (\n"+Cg(e)+"\n)}"}),Sg=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e})),l.workerModuleData={isWorkerModule:!0,id:s,name:o,dependencies:t,init:Cg(n),getTransferables:i&&Cg(i)},l}function Cg(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function kg(e,t,n){return new Promise((function(i,r){var s=++Eg;Mg[s]=function(e){e.success?i(e.result):r(new Error("Error in worker "+t+" call: "+e.error))},function(e){var t=wg[e];if(!t){var n=Cg(bg);(t=wg[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+n+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,n=t.messageId,i=Mg[n];if(!i)throw new Error("WorkerModule response with empty or unknown messageId");delete Mg[n],i(t)}}return t}(e).postMessage({messageId:s,action:t,data:n})}))}function Rg(){var e=function(e){function t(e,t,n,i,r,s,o,a){var l=1-o;a.x=l*l*e+2*l*o*n+o*o*r,a.y=l*l*t+2*l*o*i+o*o*s}function n(e,t,n,i,r,s,o,a,l,c){var u=1-l;c.x=u*u*u*e+3*u*u*l*n+3*u*l*l*r+l*l*l*o,c.y=u*u*u*t+3*u*u*l*i+3*u*l*l*s+l*l*l*a}function i(e,t){for(var n,i,r,s,o,a=/([MLQCZ])([^MLQCZ]*)/g;n=a.exec(e);){var l=n[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map((function(e){return parseFloat(e)}));switch(n[1]){case"M":s=i=l[0],o=r=l[1];break;case"L":(l[0]!==s||l[1]!==o)&&t("L",s,o,s=l[0],o=l[1]);break;case"Q":t("Q",s,o,s=l[2],o=l[3],l[0],l[1]);break;case"C":t("C",s,o,s=l[4],o=l[5],l[0],l[1],l[2],l[3]);break;case"Z":(s!==i||o!==r)&&t("L",s,o,i,r)}}}function r(e,r,s){void 0===s&&(s=16);var o={x:0,y:0};i(e,(function(e,i,a,l,c,u,h,d,p){switch(e){case"L":r(i,a,l,c);break;case"Q":for(var f=i,g=a,m=1;m<s;m++)t(i,a,u,h,l,c,m/(s-1),o),r(f,g,o.x,o.y),f=o.x,g=o.y;break;case"C":for(var v=i,_=a,b=1;b<s;b++)n(i,a,u,h,d,p,l,c,b/(s-1),o),r(v,_,o.x,o.y),v=o.x,_=o.y}}))}var s="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",a=new WeakMap,l={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function c(e,t){var n=e.getContext?e.getContext("webgl",l):e,i=a.get(n);if(!i){let e=function(e){var t=s[e];if(!t&&!(t=s[e]=n.getExtension(e)))throw new Error(e+" not supported");return t},t=function(e,t){var i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),i},l=function(i,s,a,l){if(!o[i]){var c={},u={},h=n.createProgram();n.attachShader(h,t(s,n.VERTEX_SHADER)),n.attachShader(h,t(a,n.FRAGMENT_SHADER)),n.linkProgram(h),o[i]={program:h,transaction:function(t){n.useProgram(h),t({setUniform:function(e,t){for(var i=[],r=arguments.length-2;r-- >0;)i[r]=arguments[r+2];var s=u[t]||(u[t]=n.getUniformLocation(h,t));n["uniform"+e].apply(n,[s].concat(i))},setAttribute:function(t,i,s,o,a){var l=c[t];l||(l=c[t]={buf:n.createBuffer(),loc:n.getAttribLocation(h,t),data:null}),n.bindBuffer(n.ARRAY_BUFFER,l.buf),n.vertexAttribPointer(l.loc,i,n.FLOAT,!1,0,0),n.enableVertexAttribArray(l.loc),r?n.vertexAttribDivisor(l.loc,o):e("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(l.loc,o),a!==l.data&&(n.bufferData(n.ARRAY_BUFFER,a,s),l.data=a)}})}}}o[i].transaction(l)},d=function(e,t){u++;try{n.activeTexture(n.TEXTURE0+u);var i=c[e];i||(i=c[e]=n.createTexture(),n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)),n.bindTexture(n.TEXTURE_2D,i),t(i,u)}finally{u--}},p=function(e,t,i){var r=n.createFramebuffer();h.push(r),n.bindFramebuffer(n.FRAMEBUFFER,r),n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,e),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);try{i(r)}finally{n.deleteFramebuffer(r),n.bindFramebuffer(n.FRAMEBUFFER,h[--h.length-1]||null)}},f=function(){s={},o={},c={},u=-1,h.length=0};var r=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext,s={},o={},c={},u=-1,h=[];n.canvas.addEventListener("webglcontextlost",(function(e){f(),e.preventDefault()}),!1),a.set(n,i={gl:n,isWebGL2:r,getExtension:e,withProgram:l,withTexture:d,withTextureFramebuffer:p,handleContextLoss:f})}t(i)}function u(e,t,n,i,r,a,l,u){void 0===l&&(l=15),void 0===u&&(u=null),c(e,(function(e){var c=e.gl,h=e.withProgram;(0,e.withTexture)("copy",(function(e,d){c.texImage2D(c.TEXTURE_2D,0,c.RGBA,r,a,0,c.RGBA,c.UNSIGNED_BYTE,t),h("copy",s,o,(function(e){var t=e.setUniform;(0,e.setAttribute)("aUV",2,c.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t("1i","image",d),c.bindFramebuffer(c.FRAMEBUFFER,u||null),c.disable(c.BLEND),c.colorMask(8&l,4&l,2&l,1&l),c.viewport(n,i,r,a),c.scissor(n,i,r,a),c.drawArrays(c.TRIANGLES,0,3)}))}))}))}var h=Object.freeze({__proto__:null,withWebGLContext:c,renderImageData:u,resizeWebGLCanvasWithoutClearing:function(e,t,n){var i=e.width,r=e.height;c(e,(function(s){var o=s.gl,a=new Uint8Array(i*r*4);o.readPixels(0,0,i,r,o.RGBA,o.UNSIGNED_BYTE,a),e.width=t,e.height=n,u(o,a,0,0,i,r)}))}});function d(e,t,n,i,s,o){void 0===o&&(o=1);var a=new Uint8Array(e*t),l=i[2]-i[0],c=i[3]-i[1],u=[];r(n,(function(e,t,n,i){u.push({x1:e,y1:t,x2:n,y2:i,minX:Math.min(e,n),minY:Math.min(t,i),maxX:Math.max(e,n),maxY:Math.max(t,i)})})),u.sort((function(e,t){return e.maxX-t.maxX}));for(var h=0;h<e;h++)for(var d=0;d<t;d++){var p=m(i[0]+l*(h+.5)/e,i[1]+c*(d+.5)/t),f=Math.pow(1-Math.abs(p)/s,o)/2;p<0&&(f=1-f),f=Math.max(0,Math.min(255,Math.round(255*f))),a[d*e+h]=f}return a;function m(e,t){for(var n=1/0,i=1/0,r=u.length;r--;){var s=u[r];if(s.maxX+i<=e)break;if(e+i>s.minX&&t-i<s.maxY&&t+i>s.minY){var o=g(e,t,s.x1,s.y1,s.x2,s.y2);o<n&&(n=o,i=Math.sqrt(n))}}return function(e,t){for(var n=0,i=u.length;i--;){var r=u[i];if(r.maxX<=e)break;r.y1>t!=r.y2>t&&e<(r.x2-r.x1)*(t-r.y1)/(r.y2-r.y1)+r.x1&&(n+=r.y1<r.y2?1:-1)}return 0!==n}(e,t)&&(i=-i),i}}function p(e,t,n,i,r,s,o,a,l,c){void 0===s&&(s=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0),f(e,t,n,i,r,s,o,null,a,l,c)}function f(e,t,n,i,r,s,o,a,l,c,h){void 0===s&&(s=1),void 0===l&&(l=0),void 0===c&&(c=0),void 0===h&&(h=0);for(var p=d(e,t,n,i,r,s),f=new Uint8Array(4*p.length),g=0;g<p.length;g++)f[4*g+h]=p[g];u(o,f,l,c,e,t,1<<3-h,a)}function g(e,t,n,i,r,s){var o=r-n,a=s-i,l=o*o+a*a,c=l?Math.max(0,Math.min(1,((e-n)*o+(t-i)*a)/l)):0,u=e-(n+c*o),h=t-(i+c*a);return u*u+h*h}var m=Object.freeze({__proto__:null,generate:d,generateIntoCanvas:p,generateIntoFramebuffer:f}),v="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",_="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",b="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",y=new Float32Array([0,0,2,0,0,2]),T=null,E=!1,S={},w=new WeakMap;function x(e){if(!E&&!k(e))throw new Error("WebGL generation not supported")}function M(e,t,n,i,r,s,o){if(void 0===s&&(s=1),void 0===o&&(o=null),!o&&!(o=T)){var a="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!a)throw new Error("OffscreenCanvas or DOM canvas not supported");o=T=a.getContext("webgl",{depth:!1})}x(o);var l=new Uint8Array(e*t*4);c(o,(function(o){var a=o.gl,c=o.withTexture,u=o.withTextureFramebuffer;c("readable",(function(o,c){a.texImage2D(a.TEXTURE_2D,0,a.RGBA,e,t,0,a.RGBA,a.UNSIGNED_BYTE,null),u(o,c,(function(o){C(e,t,n,i,r,s,a,o,0,0,0),a.readPixels(0,0,e,t,a.RGBA,a.UNSIGNED_BYTE,l)}))}))}));for(var u=new Uint8Array(e*t),h=0,d=0;h<l.length;h+=4)u[d++]=l[h];return u}function I(e,t,n,i,r,s,o,a,l,c){void 0===s&&(s=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0),C(e,t,n,i,r,s,o,null,a,l,c)}function C(e,t,n,i,o,a,l,u,h,d,p){void 0===a&&(a=1),void 0===h&&(h=0),void 0===d&&(d=0),void 0===p&&(p=0),x(l);var f=[];r(n,(function(e,t,n,i){f.push(e,t,n,i)})),f=new Float32Array(f),c(l,(function(n){var r=n.gl,l=n.isWebGL2,c=n.getExtension,g=n.withProgram,m=n.withTexture,T=n.withTextureFramebuffer,E=n.handleContextLoss;if(m("rawDistances",(function(n,m){(e!==n._lastWidth||t!==n._lastHeight)&&r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n._lastWidth=e,n._lastHeight=t,0,r.RGBA,r.UNSIGNED_BYTE,null),g("main",v,_,(function(s){var u=s.setAttribute,h=s.setUniform,d=!l&&c("ANGLE_instanced_arrays"),p=!l&&c("EXT_blend_minmax");u("aUV",2,r.STATIC_DRAW,0,y),u("aLineSegment",4,r.DYNAMIC_DRAW,1,f),h.apply(void 0,["4f","uGlyphBounds"].concat(i)),h("1f","uMaxDistance",o),h("1f","uExponent",a),T(n,m,(function(n){r.enable(r.BLEND),r.colorMask(!0,!0,!0,!0),r.viewport(0,0,e,t),r.scissor(0,0,e,t),r.blendFunc(r.ONE,r.ONE),r.blendEquationSeparate(r.FUNC_ADD,l?r.MAX:p.MAX_EXT),r.clear(r.COLOR_BUFFER_BIT),l?r.drawArraysInstanced(r.TRIANGLES,0,3,f.length/4):d.drawArraysInstancedANGLE(r.TRIANGLES,0,3,f.length/4)}))})),g("post",s,b,(function(n){n.setAttribute("aUV",2,r.STATIC_DRAW,0,y),n.setUniform("1i","tex",m),r.bindFramebuffer(r.FRAMEBUFFER,u),r.disable(r.BLEND),r.colorMask(0===p,1===p,2===p,3===p),r.viewport(h,d,e,t),r.scissor(h,d,e,t),r.drawArrays(r.TRIANGLES,0,3)}))})),r.isContextLost())throw E(),new Error("webgl context lost")}))}function k(e){var t=e&&e!==T?e.canvas||e:S,n=w.get(t);if(void 0===n){E=!0;var i=null;try{var r=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],s=M(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,e);(n=s&&r.length===s.length&&s.every((function(e,t){return e===r[t]})))||(i="bad trial run results",console.info(r,s))}catch(o){n=!1,i=o.message}i&&console.warn("WebGL SDF generation not supported:",i),E=!1,w.set(t,n)}return n}var R=Object.freeze({__proto__:null,generate:M,generateIntoCanvas:I,generateIntoFramebuffer:C,isSupported:k});return e.forEachPathCommand=i,e.generate=function(e,t,n,i,r,s){void 0===r&&(r=Math.max(i[2]-i[0],i[3]-i[1])/2),void 0===s&&(s=1);try{return M.apply(R,arguments)}catch(o){return console.info("WebGL SDF generation failed, falling back to JS",o),d.apply(m,arguments)}},e.generateIntoCanvas=function(e,t,n,i,r,s,o,a,l,c){void 0===r&&(r=Math.max(i[2]-i[0],i[3]-i[1])/2),void 0===s&&(s=1),void 0===a&&(a=0),void 0===l&&(l=0),void 0===c&&(c=0);try{return I.apply(R,arguments)}catch(u){return console.info("WebGL SDF generation failed, falling back to JS",u),p.apply(m,arguments)}},e.javascript=m,e.pathToLineSegments=r,e.webgl=R,e.webglUtils=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e}const Ag=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Lg(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){let n=$r[t];return n?Lg(n):e}))}const Og=[];for(let mM=0;mM<256;mM++)Og[mM]=(mM<16?"0":"")+mM.toString(16);const Ng=Object.assign||function(){let e=arguments[0];for(let t=1,n=arguments.length;t<n;t++){let n=arguments[t];if(n)for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e},Dg=Date.now(),Pg=new WeakMap,$g=new Map;let Bg=1e10;function Fg(e,t){const n=function(e){const t=JSON.stringify(e,zg);let n=Gg.get(t);return null==n&&Gg.set(t,n=++Hg),n}(t);let i=Pg.get(e);if(i||Pg.set(e,i=Object.create(null)),i[n])return new i[n];const r="_onBeforeCompile".concat(n),s=function(i){e.onBeforeCompile.call(this,i);const s=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let o=$g[s];if(!o){const e=function(e,t,n){let{vertexShader:i,fragmentShader:r}=e,{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:p,timeUniform:f}=t;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",h=h||"",(l||p)&&(i=Lg(i)),(d||p)&&(r=r.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"),r=Lg(r)),p){let e=p({vertexShader:i,fragmentShader:r});i=e.vertexShader,r=e.fragmentShader}if(d){let e=[];r=r.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(t=>(e.push(t),""))),h="".concat(d,"\n").concat(e.join("\n"),"\n").concat(h)}if(f){const e="\nuniform float ".concat(f,";\n");s=e+s,c=e+c}return l&&(i="vec3 troika_position_".concat(n,";\nvec3 troika_normal_").concat(n,";\nvec2 troika_uv_").concat(n,";\n").concat(i,"\n"),s="".concat(s,"\nvoid troikaVertexTransform").concat(n,"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ").concat(l,"\n}\n"),o="\ntroika_position_".concat(n," = vec3(position);\ntroika_normal_").concat(n," = vec3(normal);\ntroika_uv_").concat(n," = vec2(uv);\ntroikaVertexTransform").concat(n,"(troika_position_").concat(n,", troika_normal_").concat(n,", troika_uv_").concat(n,");\n").concat(o,"\n"),i=i.replace(/\b(position|normal|uv)\b/g,((e,t,i,r)=>/\battribute\s+vec[23]\s+$/.test(r.substr(0,i))?t:"troika_".concat(t,"_").concat(n)))),i=Ug(i,n,s,o,a),r=Ug(r,n,c,u,h),{vertexShader:i,fragmentShader:r}}(i,t,n);o=$g[s]=e}i.vertexShader=o.vertexShader,i.fragmentShader=o.fragmentShader,Ng(i.uniforms,this.uniforms),t.timeUniform&&(i.uniforms[t.timeUniform]={get value(){return Date.now()-Dg}}),this[r]&&this[r](i)},o=function(){return a(t.chained?e:e.clone())},a=function(i){const r=Object.create(i,l);return Object.defineProperty(r,"baseMaterial",{value:e}),Object.defineProperty(r,"id",{value:Bg++}),r.uuid=function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Og[255&e]+Og[e>>8&255]+Og[e>>16&255]+Og[e>>24&255]+"-"+Og[255&t]+Og[t>>8&255]+"-"+Og[t>>16&15|64]+Og[t>>24&255]+"-"+Og[63&n|128]+Og[n>>8&255]+"-"+Og[n>>16&255]+Og[n>>24&255]+Og[255&i]+Og[i>>8&255]+Og[i>>16&255]+Og[i>>24&255]).toUpperCase()}(),r.uniforms=Ng({},i.uniforms,t.uniforms),r.defines=Ng({},i.defines,t.defines),r.defines["TROIKA_DERIVED_MATERIAL_".concat(n)]="",r.extensions=Ng({},i.extensions,t.extensions),r._listeners=void 0,r},l={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return e.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get:()=>s,set(e){this[r]=e}},copy:{writable:!0,configurable:!0,value:function(t){return e.copy.call(this,t),!e.isShaderMaterial&&!e.isDerivedMaterial&&(Ng(this.extensions,t.extensions),Ng(this.defines,t.defines),Ng(this.uniforms,br.clone(t.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const t=new e.constructor;return a(t).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||(n=this._depthMaterial=Fg(e.isDerivedMaterial?e.getDepthMaterial():new ea({depthPacking:Et}),t),n.defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||(n=this._distanceMaterial=Fg(e.isDerivedMaterial?e.getDistanceMaterial():new ta,t),n.defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:t,_distanceMaterial:n}=this;t&&t.dispose(),n&&n.dispose(),e.dispose.call(this)}}};return i[n]=o,new o}function Ug(e,t,n,i,r){return(i||r||n)&&(e=e.replace(Ag,"\n".concat(n,"\nvoid troikaOrigMain").concat(t,"() {")),e+="\nvoid main() {\n  ".concat(i,"\n  troikaOrigMain").concat(t,"();\n  ").concat(r,"\n}")),e}function zg(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let Hg=0;const Gg=new Map;const Vg=()=>(self.performance||Date).now(),Wg=Rg();let jg;const Xg=[];let Yg=0;function Kg(){const e=Vg();for(;Xg.length&&Vg()-e<5;)Xg.shift()();Yg=Xg.length?setTimeout(Kg,0):0}const qg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise(((e,n)=>{Xg.push((()=>{const i=Vg();try{Wg.webgl.generateIntoCanvas(...t),e({timing:Vg()-i})}catch(r){n(r)}})),Yg||(Yg=setTimeout(Kg,0))}))},Jg=4,Zg=2e3,Qg={};let em=0;function tm(e,t,n,i,r,s,o,a,l,c){const u="TroikaTextSDFGenerator_JS_"+em++%Jg;let h=Qg[u];return h||(h=Qg[u]={workerModule:Ig({name:u,workerId:u,dependencies:[Rg,Vg],init(e,t){const n=e().javascript.generate;return function(){const e=t();return{textureData:n(...arguments),timing:t()-e}}},getTransferables:e=>[e.textureData.buffer]}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(e,t,n,i,r,s).then((n=>{let{textureData:i,timing:r}=n;const s=Vg(),d=new Uint8Array(4*i.length);for(let e=0;e<i.length;e++)d[4*e+c]=i[e];return Wg.webglUtils.renderImageData(o,d,a,l,e,t,1<<3-c),r+=Vg()-s,0===--h.requests&&(h.idleTimer=setTimeout((()=>{!function(e){xg[e]&&xg[e].forEach((function(e){e()})),wg[e]&&(wg[e].terminate(),delete wg[e])}(u)}),Zg)),{timing:r}}))}const nm=Wg.webglUtils.resizeWebGLCanvasWithoutClearing;const im=Ig({name:"Typr Font Parser",dependencies:[function(){return typeof window>"u"&&(self.window=self),function(e){var t={parse:function(e){var n=t._bin,i=new Uint8Array(e);if("ttcf"==n.readASCII(i,0,4)){var r=4;n.readUshort(i,r),r+=2,n.readUshort(i,r),r+=2;var s=n.readUint(i,r);r+=4;for(var o=[],a=0;a<s;a++){var l=n.readUint(i,r);r+=4,o.push(t._readFont(i,l))}return o}return[t._readFont(i,0)]},_readFont:function(e,n){var i=t._bin,r=n;i.readFixed(e,n),n+=4;var s=i.readUshort(e,n);n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],a={_data:e,_offset:r},l={},c=0;c<s;c++){var u=i.readASCII(e,n,4);n+=4,i.readUint(e,n),n+=4;var h=i.readUint(e,n);n+=4;var d=i.readUint(e,n);n+=4,l[u]={offset:h,length:d}}for(c=0;c<o.length;c++){var p=o[c];l[p]&&(a[p.trim()]=t[p.trim()].parse(e,l[p].offset,l[p].length,a))}return a},_tabOffset:function(e,n,i){for(var r=t._bin,s=r.readUshort(e,i+4),o=i+12,a=0;a<s;a++){var l=r.readASCII(e,o,4);o+=4,r.readUint(e,o),o+=4;var c=r.readUint(e,o);if(o+=4,r.readUint(e,o),o+=4,l==n)return c}return 0}};t._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,n){return t._bin.readShort(e,n)/16384},readInt:function(e,n){return t._bin._view(e).getInt32(n)},readInt8:function(e,n){return t._bin._view(e).getInt8(n)},readShort:function(e,n){return t._bin._view(e).getInt16(n)},readUshort:function(e,n){return t._bin._view(e).getUint16(n)},readUshorts:function(e,n,i){for(var r=[],s=0;s<i;s++)r.push(t._bin.readUshort(e,n+2*s));return r},readUint:function(e,n){return t._bin._view(e).getUint32(n)},readUint64:function(e,n){return 4294967296*t._bin.readUint(e,n)+t._bin.readUint(e,n+4)},readASCII:function(e,t,n){for(var i="",r=0;r<n;r++)i+=String.fromCharCode(e[t+r]);return i},readUnicode:function(e,t,n){for(var i="",r=0;r<n;r++){var s=e[t++]<<8|e[t++];i+=String.fromCharCode(s)}return i},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,n,i){var r=t._bin._tdec;return r&&0==n&&i==e.length?r.decode(e):t._bin.readASCII(e,n,i)},readBytes:function(e,t,n){for(var i=[],r=0;r<n;r++)i.push(e[t+r]);return i},readASCIIArray:function(e,t,n){for(var i=[],r=0;r<n;r++)i.push(String.fromCharCode(e[t+r]));return i},_view:function(e){return e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))}},t._lctf={},t._lctf.parse=function(e,n,i,r,s){var o=t._bin,a={},l=n;o.readFixed(e,n),n+=4;var c=o.readUshort(e,n);n+=2;var u=o.readUshort(e,n);n+=2;var h=o.readUshort(e,n);return n+=2,a.scriptList=t._lctf.readScriptList(e,l+c),a.featureList=t._lctf.readFeatureList(e,l+u),a.lookupList=t._lctf.readLookupList(e,l+h,s),a},t._lctf.readLookupList=function(e,n,i){var r=t._bin,s=n,o=[],a=r.readUshort(e,n);n+=2;for(var l=0;l<a;l++){var c=r.readUshort(e,n);n+=2;var u=t._lctf.readLookupTable(e,s+c,i);o.push(u)}return o},t._lctf.readLookupTable=function(e,n,i){var r=t._bin,s=n,o={tabs:[]};o.ltype=r.readUshort(e,n),n+=2,o.flag=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);n+=2;for(var l=o.ltype,c=0;c<a;c++){var u=r.readUshort(e,n);n+=2;var h=i(e,l,s+u,o);o.tabs.push(h)}return o},t._lctf.numOfOnes=function(e){for(var t=0,n=0;n<32;n++)0!=(e>>>n&1)&&t++;return t},t._lctf.readClassDef=function(e,n){var i=t._bin,r=[],s=i.readUshort(e,n);if(n+=2,1==s){var o=i.readUshort(e,n);n+=2;var a=i.readUshort(e,n);n+=2;for(var l=0;l<a;l++)r.push(o+l),r.push(o+l),r.push(i.readUshort(e,n)),n+=2}if(2==s){var c=i.readUshort(e,n);for(n+=2,l=0;l<c;l++)r.push(i.readUshort(e,n)),n+=2,r.push(i.readUshort(e,n)),n+=2,r.push(i.readUshort(e,n)),n+=2}return r},t._lctf.getInterval=function(e,t){for(var n=0;n<e.length;n+=3){var i=e[n],r=e[n+1];if(e[n+2],i<=t&&t<=r)return n}return-1},t._lctf.readCoverage=function(e,n){var i=t._bin,r={};r.fmt=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);return n+=2,1==r.fmt&&(r.tab=i.readUshorts(e,n,s)),2==r.fmt&&(r.tab=i.readUshorts(e,n,3*s)),r},t._lctf.coverageIndex=function(e,n){var i=e.tab;if(1==e.fmt)return i.indexOf(n);if(2==e.fmt){var r=t._lctf.getInterval(i,n);if(-1!=r)return i[r+2]+(n-i[r])}return-1},t._lctf.readFeatureList=function(e,n){var i=t._bin,r=n,s=[],o=i.readUshort(e,n);n+=2;for(var a=0;a<o;a++){var l=i.readASCII(e,n,4);n+=4;var c=i.readUshort(e,n);n+=2;var u=t._lctf.readFeatureTable(e,r+c);u.tag=l.trim(),s.push(u)}return s},t._lctf.readFeatureTable=function(e,n){var i=t._bin,r=n,s={},o=i.readUshort(e,n);n+=2,o>0&&(s.featureParams=r+o);var a=i.readUshort(e,n);n+=2,s.tab=[];for(var l=0;l<a;l++)s.tab.push(i.readUshort(e,n+2*l));return s},t._lctf.readScriptList=function(e,n){var i=t._bin,r=n,s={},o=i.readUshort(e,n);n+=2;for(var a=0;a<o;a++){var l=i.readASCII(e,n,4);n+=4;var c=i.readUshort(e,n);n+=2,s[l.trim()]=t._lctf.readScriptTable(e,r+c)}return s},t._lctf.readScriptTable=function(e,n){var i=t._bin,r=n,s={},o=i.readUshort(e,n);n+=2,s.default=t._lctf.readLangSysTable(e,r+o);var a=i.readUshort(e,n);n+=2;for(var l=0;l<a;l++){var c=i.readASCII(e,n,4);n+=4;var u=i.readUshort(e,n);n+=2,s[c.trim()]=t._lctf.readLangSysTable(e,r+u)}return s},t._lctf.readLangSysTable=function(e,n){var i=t._bin,r={};i.readUshort(e,n),n+=2,r.reqFeature=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);return n+=2,r.features=i.readUshorts(e,n,s),r},t.CFF={},t.CFF.parse=function(e,n,i){var r=t._bin;(e=new Uint8Array(e.buffer,n,i))[n=0],e[++n],e[++n],e[++n],n++;var s=[];n=t.CFF.readIndex(e,n,s);for(var o=[],a=0;a<s.length-1;a++)o.push(r.readASCII(e,n+s[a],s[a+1]-s[a]));n+=s[s.length-1];var l=[];n=t.CFF.readIndex(e,n,l);var c=[];for(a=0;a<l.length-1;a++)c.push(t.CFF.readDict(e,n+l[a],n+l[a+1]));n+=l[l.length-1];var u=c[0],h=[];n=t.CFF.readIndex(e,n,h);var d=[];for(a=0;a<h.length-1;a++)d.push(r.readASCII(e,n+h[a],h[a+1]-h[a]));if(n+=h[h.length-1],t.CFF.readSubrs(e,n,u),u.CharStrings){n=u.CharStrings,h=[],n=t.CFF.readIndex(e,n,h);var p=[];for(a=0;a<h.length-1;a++)p.push(r.readBytes(e,n+h[a],h[a+1]-h[a]));u.CharStrings=p}if(u.ROS){n=u.FDArray;var f=[];for(n=t.CFF.readIndex(e,n,f),u.FDArray=[],a=0;a<f.length-1;a++){var g=t.CFF.readDict(e,n+f[a],n+f[a+1]);t.CFF._readFDict(e,g,d),u.FDArray.push(g)}n+=f[f.length-1],n=u.FDSelect,u.FDSelect=[];var m=e[n];if(n++,3!=m)throw m;var v=r.readUshort(e,n);for(n+=2,a=0;a<v+1;a++)u.FDSelect.push(r.readUshort(e,n),e[n+2]),n+=3}return u.Encoding&&(u.Encoding=t.CFF.readEncoding(e,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=t.CFF.readCharset(e,u.charset,u.CharStrings.length)),t.CFF._readFDict(e,u,d),u},t.CFF._readFDict=function(e,n,i){var r;for(var s in n.Private&&(r=n.Private[1],n.Private=t.CFF.readDict(e,r,r+n.Private[0]),n.Private.Subrs&&t.CFF.readSubrs(e,r+n.Private.Subrs,n.Private)),n)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(s)&&(n[s]=i[n[s]-426+35])},t.CFF.readSubrs=function(e,n,i){var r=t._bin,s=[];n=t.CFF.readIndex(e,n,s);var o,a=s.length;o=a<1240?107:a<33900?1131:32768,i.Bias=o,i.Subrs=[];for(var l=0;l<s.length-1;l++)i.Subrs.push(r.readBytes(e,n+s[l],s[l+1]-s[l]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(e,t){for(var n=0;n<e.charset.length;n++)if(e.charset[n]==t)return n;return-1},t.CFF.glyphBySE=function(e,n){return n<0||n>255?-1:t.CFF.glyphByUnicode(e,t.CFF.tableSE[n])},t.CFF.readEncoding=function(e,n,i){t._bin;var r=[".notdef"],s=e[n];if(n++,0!=s)throw"error: unknown encoding format: "+s;var o=e[n];n++;for(var a=0;a<o;a++)r.push(e[n+a]);return r},t.CFF.readCharset=function(e,n,i){var r=t._bin,s=[".notdef"],o=e[n];if(n++,0==o)for(var a=0;a<i;a++){var l=r.readUshort(e,n);n+=2,s.push(l)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;s.length<i;){l=r.readUshort(e,n),n+=2;var c=0;for(1==o?(c=e[n],n++):(c=r.readUshort(e,n),n+=2),a=0;a<=c;a++)s.push(l),l++}}return s},t.CFF.readIndex=function(e,n,i){var r=t._bin,s=r.readUshort(e,n)+1,o=e[n+=2];if(n++,1==o)for(var a=0;a<s;a++)i.push(e[n+a]);else if(2==o)for(a=0;a<s;a++)i.push(r.readUshort(e,n+2*a));else if(3==o)for(a=0;a<s;a++)i.push(16777215&r.readUint(e,n+3*a-1));else if(1!=s)throw"unsupported offset size: "+o+", count: "+s;return(n+=s*o)-1},t.CFF.getCharString=function(e,n,i){var r=t._bin,s=e[n],o=e[n+1];e[n+2],e[n+3],e[n+4];var a=1,l=null,c=null;s<=20&&(l=s,a=1),12==s&&(l=100*s+o,a=2),21<=s&&s<=27&&(l=s,a=1),28==s&&(c=r.readShort(e,n+1),a=3),29<=s&&s<=31&&(l=s,a=1),32<=s&&s<=246&&(c=s-139,a=1),247<=s&&s<=250&&(c=256*(s-247)+o+108,a=2),251<=s&&s<=254&&(c=256*-(s-251)-o-108,a=2),255==s&&(c=r.readInt(e,n+1)/65535,a=5),i.val=null!=c?c:"o"+l,i.size=a},t.CFF.readCharString=function(e,n,i){for(var r=n+i,s=t._bin,o=[];n<r;){var a=e[n],l=e[n+1];e[n+2],e[n+3],e[n+4];var c=1,u=null,h=null;a<=20&&(u=a,c=1),12==a&&(u=100*a+l,c=2),19!=a&&20!=a||(u=a,c=2),21<=a&&a<=27&&(u=a,c=1),28==a&&(h=s.readShort(e,n+1),c=3),29<=a&&a<=31&&(u=a,c=1),32<=a&&a<=246&&(h=a-139,c=1),247<=a&&a<=250&&(h=256*(a-247)+l+108,c=2),251<=a&&a<=254&&(h=256*-(a-251)-l-108,c=2),255==a&&(h=s.readInt(e,n+1)/65535,c=5),o.push(null!=h?h:"o"+u),n+=c}return o},t.CFF.readDict=function(e,n,i){for(var r=t._bin,s={},o=[];n<i;){var a=e[n],l=e[n+1];e[n+2],e[n+3],e[n+4];var c=1,u=null,h=null;if(28==a&&(h=r.readShort(e,n+1),c=3),29==a&&(h=r.readInt(e,n+1),c=5),32<=a&&a<=246&&(h=a-139,c=1),247<=a&&a<=250&&(h=256*(a-247)+l+108,c=2),251<=a&&a<=254&&(h=256*-(a-251)-l-108,c=2),255==a)throw h=r.readInt(e,n+1)/65535,c=5,"unknown number";if(30==a){var d=[];for(c=1;;){var p=e[n+c];c++;var f=p>>4,g=15&p;if(15!=f&&d.push(f),15!=g&&d.push(g),15==g)break}for(var m="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],_=0;_<d.length;_++)m+=v[d[_]];h=parseFloat(m)}a<=21&&(u=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][a],c=1,12==a&&(u=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],c=2)),null!=u?(s[u]=1==o.length?o[0]:o,o=[]):o.push(h),n+=c}return s},t.cmap={},t.cmap.parse=function(e,n,i){e=new Uint8Array(e.buffer,n,i),n=0;var r=t._bin,s={};r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2;var a=[];s.tables=[];for(var l=0;l<o;l++){var c=r.readUshort(e,n);n+=2;var u=r.readUshort(e,n);n+=2;var h=r.readUint(e,n);n+=4;var d="p"+c+"e"+u,p=a.indexOf(h);if(-1==p){var f;p=s.tables.length,a.push(h);var g=r.readUshort(e,h);0==g?f=t.cmap.parse0(e,h):4==g?f=t.cmap.parse4(e,h):6==g?f=t.cmap.parse6(e,h):12==g?f=t.cmap.parse12(e,h):console.debug("unknown format: "+g,c,u,h),s.tables.push(f)}if(null!=s[d])throw"multiple tables for one platform+encoding";s[d]=p}return s},t.cmap.parse0=function(e,n){var i=t._bin,r={};r.format=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2,i.readUshort(e,n),n+=2,r.map=[];for(var o=0;o<s-6;o++)r.map.push(e[n+o]);return r},t.cmap.parse4=function(e,n){var i=t._bin,r=n,s={};s.format=i.readUshort(e,n),n+=2;var o=i.readUshort(e,n);n+=2,i.readUshort(e,n),n+=2;var a=i.readUshort(e,n);n+=2;var l=a/2;s.searchRange=i.readUshort(e,n),n+=2,s.entrySelector=i.readUshort(e,n),n+=2,s.rangeShift=i.readUshort(e,n),n+=2,s.endCount=i.readUshorts(e,n,l),n+=2*l,n+=2,s.startCount=i.readUshorts(e,n,l),n+=2*l,s.idDelta=[];for(var c=0;c<l;c++)s.idDelta.push(i.readShort(e,n)),n+=2;for(s.idRangeOffset=i.readUshorts(e,n,l),n+=2*l,s.glyphIdArray=[];n<r+o;)s.glyphIdArray.push(i.readUshort(e,n)),n+=2;return s},t.cmap.parse6=function(e,n){var i=t._bin,r={};r.format=i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2,r.firstCode=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2,r.glyphIdArray=[];for(var o=0;o<s;o++)r.glyphIdArray.push(i.readUshort(e,n)),n+=2;return r},t.cmap.parse12=function(e,n){var i=t._bin,r={};r.format=i.readUshort(e,n),n+=2,n+=2,i.readUint(e,n),n+=4,i.readUint(e,n),n+=4;var s=i.readUint(e,n);n+=4,r.groups=[];for(var o=0;o<s;o++){var a=n+12*o,l=i.readUint(e,a+0),c=i.readUint(e,a+4),u=i.readUint(e,a+8);r.groups.push([l,c,u])}return r},t.glyf={},t.glyf.parse=function(e,t,n,i){for(var r=[],s=0;s<i.maxp.numGlyphs;s++)r.push(null);return r},t.glyf._parseGlyf=function(e,n){var i=t._bin,r=e._data,s=t._tabOffset(r,"glyf",e._offset)+e.loca[n];if(e.loca[n]==e.loca[n+1])return null;var o={};if(o.noc=i.readShort(r,s),s+=2,o.xMin=i.readShort(r,s),s+=2,o.yMin=i.readShort(r,s),s+=2,o.xMax=i.readShort(r,s),s+=2,o.yMax=i.readShort(r,s),s+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var a=0;a<o.noc;a++)o.endPts.push(i.readUshort(r,s)),s+=2;var l=i.readUshort(r,s);if(s+=2,r.length-s<l)return null;o.instructions=i.readBytes(r,s,l),s+=l;var c=o.endPts[o.noc-1]+1;for(o.flags=[],a=0;a<c;a++){var u=r[s];if(s++,o.flags.push(u),0!=(8&u)){var h=r[s];s++;for(var d=0;d<h;d++)o.flags.push(u),a++}}for(o.xs=[],a=0;a<c;a++){var p=0!=(2&o.flags[a]),f=0!=(16&o.flags[a]);p?(o.xs.push(f?r[s]:-r[s]),s++):f?o.xs.push(0):(o.xs.push(i.readShort(r,s)),s+=2)}for(o.ys=[],a=0;a<c;a++)p=0!=(4&o.flags[a]),f=0!=(32&o.flags[a]),p?(o.ys.push(f?r[s]:-r[s]),s++):f?o.ys.push(0):(o.ys.push(i.readShort(r,s)),s+=2);var g=0,m=0;for(a=0;a<c;a++)g+=o.xs[a],m+=o.ys[a],o.xs[a]=g,o.ys[a]=m}else{var v;o.parts=[];do{v=i.readUshort(r,s),s+=2;var _={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(_),_.glyphIndex=i.readUshort(r,s),s+=2,1&v){var b=i.readShort(r,s);s+=2;var y=i.readShort(r,s);s+=2}else b=i.readInt8(r,s),s++,y=i.readInt8(r,s),s++;2&v?(_.m.tx=b,_.m.ty=y):(_.p1=b,_.p2=y),8&v?(_.m.a=_.m.d=i.readF2dot14(r,s),s+=2):64&v?(_.m.a=i.readF2dot14(r,s),s+=2,_.m.d=i.readF2dot14(r,s),s+=2):128&v&&(_.m.a=i.readF2dot14(r,s),s+=2,_.m.b=i.readF2dot14(r,s),s+=2,_.m.c=i.readF2dot14(r,s),s+=2,_.m.d=i.readF2dot14(r,s),s+=2)}while(32&v);if(256&v){var T=i.readUshort(r,s);for(s+=2,o.instr=[],a=0;a<T;a++)o.instr.push(r[s]),s++}}return o},t.GPOS={},t.GPOS.parse=function(e,n,i,r){return t._lctf.parse(e,n,i,r,t.GPOS.subt)},t.GPOS.subt=function(e,n,i,r){var s=t._bin,o=i,a={};if(a.fmt=s.readUshort(e,i),i+=2,1==n||2==n||3==n||7==n||8==n&&a.fmt<=2){var l=s.readUshort(e,i);i+=2,a.coverage=t._lctf.readCoverage(e,l+o)}if(1==n&&1==a.fmt){var c=s.readUshort(e,i);i+=2;var u=t._lctf.numOfOnes(c);0!=c&&(a.pos=t.GPOS.readValueRecord(e,i,c))}else if(2==n&&a.fmt>=1&&a.fmt<=2){c=s.readUshort(e,i),i+=2;var h=s.readUshort(e,i);i+=2,u=t._lctf.numOfOnes(c);var d=t._lctf.numOfOnes(h);if(1==a.fmt){a.pairsets=[];var p=s.readUshort(e,i);i+=2;for(var f=0;f<p;f++){var g=o+s.readUshort(e,i);i+=2;var m=s.readUshort(e,g);g+=2;for(var v=[],_=0;_<m;_++){var b=s.readUshort(e,g);g+=2,0!=c&&(x=t.GPOS.readValueRecord(e,g,c),g+=2*u),0!=h&&(M=t.GPOS.readValueRecord(e,g,h),g+=2*d),v.push({gid2:b,val1:x,val2:M})}a.pairsets.push(v)}}if(2==a.fmt){var y=s.readUshort(e,i);i+=2;var T=s.readUshort(e,i);i+=2;var E=s.readUshort(e,i);i+=2;var S=s.readUshort(e,i);for(i+=2,a.classDef1=t._lctf.readClassDef(e,o+y),a.classDef2=t._lctf.readClassDef(e,o+T),a.matrix=[],f=0;f<E;f++){var w=[];for(_=0;_<S;_++){var x=null,M=null;0!=c&&(x=t.GPOS.readValueRecord(e,i,c),i+=2*u),0!=h&&(M=t.GPOS.readValueRecord(e,i,h),i+=2*d),w.push({val1:x,val2:M})}a.matrix.push(w)}}}else{if(9==n&&1==a.fmt){var I=s.readUshort(e,i);i+=2;var C=s.readUint(e,i);if(i+=4,9==r.ltype)r.ltype=I;else if(r.ltype!=I)throw"invalid extension substitution";return t.GPOS.subt(e,r.ltype,o+C)}console.debug("unsupported GPOS table LookupType",n,"format",a.fmt)}return a},t.GPOS.readValueRecord=function(e,n,i){var r=t._bin,s=[];return s.push(1&i?r.readShort(e,n):0),n+=1&i?2:0,s.push(2&i?r.readShort(e,n):0),n+=2&i?2:0,s.push(4&i?r.readShort(e,n):0),n+=4&i?2:0,s.push(8&i?r.readShort(e,n):0),n+=8&i?2:0,s},t.GSUB={},t.GSUB.parse=function(e,n,i,r){return t._lctf.parse(e,n,i,r,t.GSUB.subt)},t.GSUB.subt=function(e,n,i,r){var s=t._bin,o=i,a={};if(a.fmt=s.readUshort(e,i),i+=2,1!=n&&4!=n&&5!=n&&6!=n)return null;if(1==n||4==n||5==n&&a.fmt<=2||6==n&&a.fmt<=2){var l=s.readUshort(e,i);i+=2,a.coverage=t._lctf.readCoverage(e,o+l)}if(1==n&&a.fmt>=1&&a.fmt<=2){if(1==a.fmt)a.delta=s.readShort(e,i),i+=2;else if(2==a.fmt){var c=s.readUshort(e,i);i+=2,a.newg=s.readUshorts(e,i,c),i+=2*a.newg.length}}else if(4==n){a.vals=[],c=s.readUshort(e,i),i+=2;for(var u=0;u<c;u++){var h=s.readUshort(e,i);i+=2,a.vals.push(t.GSUB.readLigatureSet(e,o+h))}}else if(5==n&&2==a.fmt){if(2==a.fmt){var d=s.readUshort(e,i);i+=2,a.cDef=t._lctf.readClassDef(e,o+d),a.scset=[];var p=s.readUshort(e,i);for(i+=2,u=0;u<p;u++){var f=s.readUshort(e,i);i+=2,a.scset.push(0==f?null:t.GSUB.readSubClassSet(e,o+f))}}}else if(6==n&&3==a.fmt){if(3==a.fmt){for(u=0;u<3;u++){c=s.readUshort(e,i),i+=2;for(var g=[],m=0;m<c;m++)g.push(t._lctf.readCoverage(e,o+s.readUshort(e,i+2*m)));i+=2*c,0==u&&(a.backCvg=g),1==u&&(a.inptCvg=g),2==u&&(a.ahedCvg=g)}c=s.readUshort(e,i),i+=2,a.lookupRec=t.GSUB.readSubstLookupRecords(e,i,c)}}else{if(7==n&&1==a.fmt){var v=s.readUshort(e,i);i+=2;var _=s.readUint(e,i);if(i+=4,9==r.ltype)r.ltype=v;else if(r.ltype!=v)throw"invalid extension substitution";return t.GSUB.subt(e,r.ltype,o+_)}console.debug("unsupported GSUB table LookupType",n,"format",a.fmt)}return a},t.GSUB.readSubClassSet=function(e,n){var i=t._bin.readUshort,r=n,s=[],o=i(e,n);n+=2;for(var a=0;a<o;a++){var l=i(e,n);n+=2,s.push(t.GSUB.readSubClassRule(e,r+l))}return s},t.GSUB.readSubClassRule=function(e,n){var i=t._bin.readUshort,r={},s=i(e,n),o=i(e,n+=2);n+=2,r.input=[];for(var a=0;a<s-1;a++)r.input.push(i(e,n)),n+=2;return r.substLookupRecords=t.GSUB.readSubstLookupRecords(e,n,o),r},t.GSUB.readSubstLookupRecords=function(e,n,i){for(var r=t._bin.readUshort,s=[],o=0;o<i;o++)s.push(r(e,n),r(e,n+2)),n+=4;return s},t.GSUB.readChainSubClassSet=function(e,n){var i=t._bin,r=n,s=[],o=i.readUshort(e,n);n+=2;for(var a=0;a<o;a++){var l=i.readUshort(e,n);n+=2,s.push(t.GSUB.readChainSubClassRule(e,r+l))}return s},t.GSUB.readChainSubClassRule=function(e,n){for(var i=t._bin,r={},s=["backtrack","input","lookahead"],o=0;o<s.length;o++){var a=i.readUshort(e,n);n+=2,1==o&&a--,r[s[o]]=i.readUshorts(e,n,a),n+=2*r[s[o]].length}return a=i.readUshort(e,n),n+=2,r.subst=i.readUshorts(e,n,2*a),n+=2*r.subst.length,r},t.GSUB.readLigatureSet=function(e,n){var i=t._bin,r=n,s=[],o=i.readUshort(e,n);n+=2;for(var a=0;a<o;a++){var l=i.readUshort(e,n);n+=2,s.push(t.GSUB.readLigature(e,r+l))}return s},t.GSUB.readLigature=function(e,n){var i=t._bin,r={chain:[]};r.nglyph=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2;for(var o=0;o<s-1;o++)r.chain.push(i.readUshort(e,n)),n+=2;return r},t.head={},t.head.parse=function(e,n,i){var r=t._bin,s={};return r.readFixed(e,n),n+=4,s.fontRevision=r.readFixed(e,n),n+=4,r.readUint(e,n),n+=4,r.readUint(e,n),n+=4,s.flags=r.readUshort(e,n),n+=2,s.unitsPerEm=r.readUshort(e,n),n+=2,s.created=r.readUint64(e,n),n+=8,s.modified=r.readUint64(e,n),n+=8,s.xMin=r.readShort(e,n),n+=2,s.yMin=r.readShort(e,n),n+=2,s.xMax=r.readShort(e,n),n+=2,s.yMax=r.readShort(e,n),n+=2,s.macStyle=r.readUshort(e,n),n+=2,s.lowestRecPPEM=r.readUshort(e,n),n+=2,s.fontDirectionHint=r.readShort(e,n),n+=2,s.indexToLocFormat=r.readShort(e,n),n+=2,s.glyphDataFormat=r.readShort(e,n),n+=2,s},t.hhea={},t.hhea.parse=function(e,n,i){var r=t._bin,s={};return r.readFixed(e,n),n+=4,s.ascender=r.readShort(e,n),n+=2,s.descender=r.readShort(e,n),n+=2,s.lineGap=r.readShort(e,n),n+=2,s.advanceWidthMax=r.readUshort(e,n),n+=2,s.minLeftSideBearing=r.readShort(e,n),n+=2,s.minRightSideBearing=r.readShort(e,n),n+=2,s.xMaxExtent=r.readShort(e,n),n+=2,s.caretSlopeRise=r.readShort(e,n),n+=2,s.caretSlopeRun=r.readShort(e,n),n+=2,s.caretOffset=r.readShort(e,n),n+=2,n+=8,s.metricDataFormat=r.readShort(e,n),n+=2,s.numberOfHMetrics=r.readUshort(e,n),n+=2,s},t.hmtx={},t.hmtx.parse=function(e,n,i,r){for(var s=t._bin,o={aWidth:[],lsBearing:[]},a=0,l=0,c=0;c<r.maxp.numGlyphs;c++)c<r.hhea.numberOfHMetrics&&(a=s.readUshort(e,n),n+=2,l=s.readShort(e,n),n+=2),o.aWidth.push(a),o.lsBearing.push(l);return o},t.kern={},t.kern.parse=function(e,n,i,r){var s=t._bin,o=s.readUshort(e,n);if(n+=2,1==o)return t.kern.parseV1(e,n-2,i,r);var a=s.readUshort(e,n);n+=2;for(var l={glyph1:[],rval:[]},c=0;c<a;c++){n+=2,i=s.readUshort(e,n),n+=2;var u=s.readUshort(e,n);n+=2;var h=u>>>8;if(0!=(h&=15))throw"unknown kern table format: "+h;n=t.kern.readFormat0(e,n,l)}return l},t.kern.parseV1=function(e,n,i,r){var s=t._bin;s.readFixed(e,n),n+=4;var o=s.readUint(e,n);n+=4;for(var a={glyph1:[],rval:[]},l=0;l<o;l++){s.readUint(e,n),n+=4;var c=s.readUshort(e,n);n+=2,s.readUshort(e,n),n+=2;var u=c>>>8;if(0!=(u&=15))throw"unknown kern table format: "+u;n=t.kern.readFormat0(e,n,a)}return a},t.kern.readFormat0=function(e,n,i){var r=t._bin,s=-1,o=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2;for(var a=0;a<o;a++){var l=r.readUshort(e,n);n+=2;var c=r.readUshort(e,n);n+=2;var u=r.readShort(e,n);n+=2,l!=s&&(i.glyph1.push(l),i.rval.push({glyph2:[],vals:[]}));var h=i.rval[i.rval.length-1];h.glyph2.push(c),h.vals.push(u),s=l}return n},t.loca={},t.loca.parse=function(e,n,i,r){var s=t._bin,o=[],a=r.head.indexToLocFormat,l=r.maxp.numGlyphs+1;if(0==a)for(var c=0;c<l;c++)o.push(s.readUshort(e,n+(c<<1))<<1);if(1==a)for(c=0;c<l;c++)o.push(s.readUint(e,n+(c<<2)));return o},t.maxp={},t.maxp.parse=function(e,n,i){var r=t._bin,s={},o=r.readUint(e,n);return n+=4,s.numGlyphs=r.readUshort(e,n),n+=2,65536==o&&(s.maxPoints=r.readUshort(e,n),n+=2,s.maxContours=r.readUshort(e,n),n+=2,s.maxCompositePoints=r.readUshort(e,n),n+=2,s.maxCompositeContours=r.readUshort(e,n),n+=2,s.maxZones=r.readUshort(e,n),n+=2,s.maxTwilightPoints=r.readUshort(e,n),n+=2,s.maxStorage=r.readUshort(e,n),n+=2,s.maxFunctionDefs=r.readUshort(e,n),n+=2,s.maxInstructionDefs=r.readUshort(e,n),n+=2,s.maxStackElements=r.readUshort(e,n),n+=2,s.maxSizeOfInstructions=r.readUshort(e,n),n+=2,s.maxComponentElements=r.readUshort(e,n),n+=2,s.maxComponentDepth=r.readUshort(e,n),n+=2),s},t.name={},t.name.parse=function(e,n,i){var r=t._bin,s={};r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2,r.readUshort(e,n);for(var a,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=n+=2,u=0;u<o;u++){var h=r.readUshort(e,n);n+=2;var d=r.readUshort(e,n);n+=2;var p=r.readUshort(e,n);n+=2;var f=r.readUshort(e,n);n+=2;var g=r.readUshort(e,n);n+=2;var m=r.readUshort(e,n);n+=2;var v,_=l[f],b=c+12*o+m;if(0==h)v=r.readUnicode(e,b,g/2);else if(3==h&&0==d)v=r.readUnicode(e,b,g/2);else if(0==d)v=r.readASCII(e,b,g);else if(1==d)v=r.readUnicode(e,b,g/2);else if(3==d)v=r.readUnicode(e,b,g/2);else{if(1!=h)throw"unknown encoding "+d+", platformID: "+h;v=r.readASCII(e,b,g),console.debug("reading unknown MAC encoding "+d+" as ASCII")}var y="p"+h+","+p.toString(16);null==s[y]&&(s[y]={}),s[y][void 0!==_?_:f]=v,s[y]._lang=p}for(var T in s)if(null!=s[T].postScriptName&&1033==s[T]._lang)return s[T];for(var T in s)if(null!=s[T].postScriptName&&0==s[T]._lang)return s[T];for(var T in s)if(null!=s[T].postScriptName&&3084==s[T]._lang)return s[T];for(var T in s)if(null!=s[T].postScriptName)return s[T];for(var T in s){a=T;break}return console.debug("returning name table with languageID "+s[a]._lang),s[a]},t["OS/2"]={},t["OS/2"].parse=function(e,n,i){var r=t._bin.readUshort(e,n);n+=2;var s={};if(0==r)t["OS/2"].version0(e,n,s);else if(1==r)t["OS/2"].version1(e,n,s);else if(2==r||3==r||4==r)t["OS/2"].version2(e,n,s);else{if(5!=r)throw"unknown OS/2 table version: "+r;t["OS/2"].version5(e,n,s)}return s},t["OS/2"].version0=function(e,n,i){var r=t._bin;return i.xAvgCharWidth=r.readShort(e,n),n+=2,i.usWeightClass=r.readUshort(e,n),n+=2,i.usWidthClass=r.readUshort(e,n),n+=2,i.fsType=r.readUshort(e,n),n+=2,i.ySubscriptXSize=r.readShort(e,n),n+=2,i.ySubscriptYSize=r.readShort(e,n),n+=2,i.ySubscriptXOffset=r.readShort(e,n),n+=2,i.ySubscriptYOffset=r.readShort(e,n),n+=2,i.ySuperscriptXSize=r.readShort(e,n),n+=2,i.ySuperscriptYSize=r.readShort(e,n),n+=2,i.ySuperscriptXOffset=r.readShort(e,n),n+=2,i.ySuperscriptYOffset=r.readShort(e,n),n+=2,i.yStrikeoutSize=r.readShort(e,n),n+=2,i.yStrikeoutPosition=r.readShort(e,n),n+=2,i.sFamilyClass=r.readShort(e,n),n+=2,i.panose=r.readBytes(e,n,10),n+=10,i.ulUnicodeRange1=r.readUint(e,n),n+=4,i.ulUnicodeRange2=r.readUint(e,n),n+=4,i.ulUnicodeRange3=r.readUint(e,n),n+=4,i.ulUnicodeRange4=r.readUint(e,n),n+=4,i.achVendID=[r.readInt8(e,n),r.readInt8(e,n+1),r.readInt8(e,n+2),r.readInt8(e,n+3)],n+=4,i.fsSelection=r.readUshort(e,n),n+=2,i.usFirstCharIndex=r.readUshort(e,n),n+=2,i.usLastCharIndex=r.readUshort(e,n),n+=2,i.sTypoAscender=r.readShort(e,n),n+=2,i.sTypoDescender=r.readShort(e,n),n+=2,i.sTypoLineGap=r.readShort(e,n),n+=2,i.usWinAscent=r.readUshort(e,n),n+=2,i.usWinDescent=r.readUshort(e,n),n+2},t["OS/2"].version1=function(e,n,i){var r=t._bin;return n=t["OS/2"].version0(e,n,i),i.ulCodePageRange1=r.readUint(e,n),n+=4,i.ulCodePageRange2=r.readUint(e,n),n+4},t["OS/2"].version2=function(e,n,i){var r=t._bin;return n=t["OS/2"].version1(e,n,i),i.sxHeight=r.readShort(e,n),n+=2,i.sCapHeight=r.readShort(e,n),n+=2,i.usDefault=r.readUshort(e,n),n+=2,i.usBreak=r.readUshort(e,n),n+=2,i.usMaxContext=r.readUshort(e,n),n+2},t["OS/2"].version5=function(e,n,i){var r=t._bin;return n=t["OS/2"].version2(e,n,i),i.usLowerOpticalPointSize=r.readUshort(e,n),n+=2,i.usUpperOpticalPointSize=r.readUshort(e,n),n+2},t.post={},t.post.parse=function(e,n,i){var r=t._bin,s={};return s.version=r.readFixed(e,n),n+=4,s.italicAngle=r.readFixed(e,n),n+=4,s.underlinePosition=r.readShort(e,n),n+=2,s.underlineThickness=r.readShort(e,n),n+=2,s},null==t&&(t={}),null==t.U&&(t.U={}),t.U.codeToGlyph=function(e,t){var n=e.cmap,i=-1;if(null!=n.p0e4?i=n.p0e4:null!=n.p3e1?i=n.p3e1:null!=n.p1e0?i=n.p1e0:null!=n.p0e3&&(i=n.p0e3),-1==i)throw"no familiar platform and encoding!";var r=n.tables[i];if(0==r.format)return t>=r.map.length?0:r.map[t];if(4==r.format){for(var s=-1,o=0;o<r.endCount.length;o++)if(t<=r.endCount[o]){s=o;break}return-1==s||r.startCount[s]>t?0:65535&(0!=r.idRangeOffset[s]?r.glyphIdArray[t-r.startCount[s]+(r.idRangeOffset[s]>>1)-(r.idRangeOffset.length-s)]:t+r.idDelta[s])}if(12==r.format){if(t>r.groups[r.groups.length-1][1])return 0;for(o=0;o<r.groups.length;o++){var a=r.groups[o];if(a[0]<=t&&t<=a[1])return a[2]+(t-a[0])}return 0}throw"unknown cmap table format "+r.format},t.U.glyphToPath=function(e,n){var i={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[n]){var r=e.SVG.entries[n];return null==r?i:("string"==typeof r&&(r=t.SVG.toPath(r),e.SVG.entries[n]=r),r)}if(e.CFF){var s={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},o=e.CFF,a=e.CFF.Private;if(o.ROS){for(var l=0;o.FDSelect[l+2]<=n;)l+=2;a=o.FDArray[o.FDSelect[l+1]].Private}t.U._drawCFF(e.CFF.CharStrings[n],s,o,a,i)}else e.glyf&&t.U._drawGlyf(n,e,i);return i},t.U._drawGlyf=function(e,n,i){var r=n.glyf[e];null==r&&(r=n.glyf[e]=t.glyf._parseGlyf(n,e)),null!=r&&(r.noc>-1?t.U._simpleGlyph(r,i):t.U._compoGlyph(r,n,i))},t.U._simpleGlyph=function(e,n){for(var i=0;i<e.noc;i++){for(var r=0==i?0:e.endPts[i-1]+1,s=e.endPts[i],o=r;o<=s;o++){var a=o==r?s:o-1,l=o==s?r:o+1,c=1&e.flags[o],u=1&e.flags[a],h=1&e.flags[l],d=e.xs[o],p=e.ys[o];if(o==r)if(c){if(!u){t.U.P.moveTo(n,d,p);continue}t.U.P.moveTo(n,e.xs[a],e.ys[a])}else u?t.U.P.moveTo(n,e.xs[a],e.ys[a]):t.U.P.moveTo(n,(e.xs[a]+d)/2,(e.ys[a]+p)/2);c?u&&t.U.P.lineTo(n,d,p):h?t.U.P.qcurveTo(n,d,p,e.xs[l],e.ys[l]):t.U.P.qcurveTo(n,d,p,(d+e.xs[l])/2,(p+e.ys[l])/2)}t.U.P.closePath(n)}},t.U._compoGlyph=function(e,n,i){for(var r=0;r<e.parts.length;r++){var s={cmds:[],crds:[]},o=e.parts[r];t.U._drawGlyf(o.glyphIndex,n,s);for(var a=o.m,l=0;l<s.crds.length;l+=2){var c=s.crds[l],u=s.crds[l+1];i.crds.push(c*a.a+u*a.b+a.tx),i.crds.push(c*a.c+u*a.d+a.ty)}for(l=0;l<s.cmds.length;l++)i.cmds.push(s.cmds[l])}},t.U._getGlyphClass=function(e,n){var i=t._lctf.getInterval(n,e);return-1==i?0:n[i+2]},t.U.getPairAdjustment=function(e,n,i){var r=!1;if(e.GPOS)for(var s=e.GPOS,o=s.lookupList,a=s.featureList,l=[],c=0;c<a.length;c++){var u=a[c];if("kern"==u.tag){r=!0;for(var h=0;h<u.tab.length;h++)if(!l[u.tab[h]]){l[u.tab[h]]=!0;for(var d=o[u.tab[h]],p=0;p<d.tabs.length;p++)if(null!=d.tabs[p]){var f,g=d.tabs[p];if((!g.coverage||-1!=(f=t._lctf.coverageIndex(g.coverage,n)))&&1!=d.ltype&&2==d.ltype){var m=null;if(1==g.fmt){var v=g.pairsets[f];for(c=0;c<v.length;c++)v[c].gid2==i&&(m=v[c])}else if(2==g.fmt){var _=t.U._getGlyphClass(n,g.classDef1),b=t.U._getGlyphClass(i,g.classDef2);m=g.matrix[_][b]}if(m){var y=0;return m.val1&&m.val1[2]&&(y+=m.val1[2]),m.val2&&m.val2[0]&&(y+=m.val2[0]),y}}}}}}if(e.kern&&!r){var T=e.kern.glyph1.indexOf(n);if(-1!=T){var E=e.kern.rval[T].glyph2.indexOf(i);if(-1!=E)return e.kern.rval[T].vals[E]}}return 0},t.U._applySubs=function(e,n,i,r){for(var s=e.length-n-1,o=0;o<i.tabs.length;o++)if(null!=i.tabs[o]){var a,l=i.tabs[o];if(!l.coverage||-1!=(a=t._lctf.coverageIndex(l.coverage,e[n])))if(1==i.ltype)e[n],1==l.fmt?e[n]=e[n]+l.delta:e[n]=l.newg[a];else if(4==i.ltype)for(var c=l.vals[a],u=0;u<c.length;u++){var h=c[u],d=h.chain.length;if(!(d>s)){for(var p=!0,f=0,g=0;g<d;g++){for(;-1==e[n+f+(1+g)];)f++;h.chain[g]!=e[n+f+(1+g)]&&(p=!1)}if(p){for(e[n]=h.nglyph,g=0;g<d+f;g++)e[n+g+1]=-1;break}}}else if(5==i.ltype&&2==l.fmt)for(var m=t._lctf.getInterval(l.cDef,e[n]),v=l.cDef[m+2],_=l.scset[v],b=0;b<_.length;b++){var y=_[b],T=y.input;if(!(T.length>s)){for(p=!0,g=0;g<T.length;g++){var E=t._lctf.getInterval(l.cDef,e[n+1+g]);if(-1==m&&l.cDef[E+2]!=T[g]){p=!1;break}}if(p){var S=y.substLookupRecords;for(u=0;u<S.length;u+=2)S[u],S[u+1]}}}else if(6==i.ltype&&3==l.fmt){if(!t.U._glsCovered(e,l.backCvg,n-l.backCvg.length)||!t.U._glsCovered(e,l.inptCvg,n)||!t.U._glsCovered(e,l.ahedCvg,n+l.inptCvg.length))continue;var w=l.lookupRec;for(b=0;b<w.length;b+=2){m=w[b];var x=r[w[b+1]];t.U._applySubs(e,n+m,x,r)}}}},t.U._glsCovered=function(e,n,i){for(var r=0;r<n.length;r++)if(-1==t._lctf.coverageIndex(n[r],e[i+r]))return!1;return!0},t.U.glyphsToPath=function(e,n,i){for(var r={cmds:[],crds:[]},s=0,o=0;o<n.length;o++){var a=n[o];if(-1!=a){for(var l=o<n.length-1&&-1!=n[o+1]?n[o+1]:0,c=t.U.glyphToPath(e,a),u=0;u<c.crds.length;u+=2)r.crds.push(c.crds[u]+s),r.crds.push(c.crds[u+1]);for(i&&r.cmds.push(i),u=0;u<c.cmds.length;u++)r.cmds.push(c.cmds[u]);i&&r.cmds.push("X"),s+=e.hmtx.aWidth[a],o<n.length-1&&(s+=t.U.getPairAdjustment(e,a,l))}}return r},t.U.P={},t.U.P.moveTo=function(e,t,n){e.cmds.push("M"),e.crds.push(t,n)},t.U.P.lineTo=function(e,t,n){e.cmds.push("L"),e.crds.push(t,n)},t.U.P.curveTo=function(e,t,n,i,r,s,o){e.cmds.push("C"),e.crds.push(t,n,i,r,s,o)},t.U.P.qcurveTo=function(e,t,n,i,r){e.cmds.push("Q"),e.crds.push(t,n,i,r)},t.U.P.closePath=function(e){e.cmds.push("Z")},t.U._drawCFF=function(e,n,i,r,s){for(var o=n.stack,a=n.nStems,l=n.haveWidth,c=n.width,u=n.open,h=0,d=n.x,p=n.y,f=0,g=0,m=0,v=0,_=0,b=0,y=0,T=0,E=0,S=0,w={val:0,size:0};h<e.length;){t.CFF.getCharString(e,h,w);var x=w.val;if(h+=w.size,"o1"==x||"o18"==x)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),a+=o.length>>1,o.length=0,l=!0;else if("o3"==x||"o23"==x)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),a+=o.length>>1,o.length=0,l=!0;else if("o4"==x)o.length>1&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),u&&t.U.P.closePath(s),p+=o.pop(),t.U.P.moveTo(s,d,p),u=!0;else if("o5"==x)for(;o.length>0;)d+=o.shift(),p+=o.shift(),t.U.P.lineTo(s,d,p);else if("o6"==x||"o7"==x)for(var M=o.length,I="o6"==x,C=0;C<M;C++){var k=o.shift();I?d+=k:p+=k,I=!I,t.U.P.lineTo(s,d,p)}else if("o8"==x||"o24"==x){M=o.length;for(var R=0;R+6<=M;)f=d+o.shift(),g=p+o.shift(),m=f+o.shift(),v=g+o.shift(),d=m+o.shift(),p=v+o.shift(),t.U.P.curveTo(s,f,g,m,v,d,p),R+=6;"o24"==x&&(d+=o.shift(),p+=o.shift(),t.U.P.lineTo(s,d,p))}else{if("o11"==x)break;if("o1234"==x||"o1235"==x||"o1236"==x||"o1237"==x)"o1234"==x&&(g=p,m=(f=d+o.shift())+o.shift(),S=v=g+o.shift(),b=v,T=p,d=(y=(_=(E=m+o.shift())+o.shift())+o.shift())+o.shift(),t.U.P.curveTo(s,f,g,m,v,E,S),t.U.P.curveTo(s,_,b,y,T,d,p)),"o1235"==x&&(f=d+o.shift(),g=p+o.shift(),m=f+o.shift(),v=g+o.shift(),E=m+o.shift(),S=v+o.shift(),_=E+o.shift(),b=S+o.shift(),y=_+o.shift(),T=b+o.shift(),d=y+o.shift(),p=T+o.shift(),o.shift(),t.U.P.curveTo(s,f,g,m,v,E,S),t.U.P.curveTo(s,_,b,y,T,d,p)),"o1236"==x&&(f=d+o.shift(),g=p+o.shift(),m=f+o.shift(),S=v=g+o.shift(),b=v,y=(_=(E=m+o.shift())+o.shift())+o.shift(),T=b+o.shift(),d=y+o.shift(),t.U.P.curveTo(s,f,g,m,v,E,S),t.U.P.curveTo(s,_,b,y,T,d,p)),"o1237"==x&&(f=d+o.shift(),g=p+o.shift(),m=f+o.shift(),v=g+o.shift(),E=m+o.shift(),S=v+o.shift(),_=E+o.shift(),b=S+o.shift(),y=_+o.shift(),T=b+o.shift(),Math.abs(y-d)>Math.abs(T-p)?d=y+o.shift():p=T+o.shift(),t.U.P.curveTo(s,f,g,m,v,E,S),t.U.P.curveTo(s,_,b,y,T,d,p));else if("o14"==x){if(o.length>0&&!l&&(c=o.shift()+i.nominalWidthX,l=!0),4==o.length){var A=o.shift(),L=o.shift(),O=o.shift(),N=o.shift(),D=t.CFF.glyphBySE(i,O),P=t.CFF.glyphBySE(i,N);t.U._drawCFF(i.CharStrings[D],n,i,r,s),n.x=A,n.y=L,t.U._drawCFF(i.CharStrings[P],n,i,r,s)}u&&(t.U.P.closePath(s),u=!1)}else if("o19"==x||"o20"==x)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),a+=o.length>>1,o.length=0,l=!0,h+=a+7>>3;else if("o21"==x)o.length>2&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),p+=o.pop(),d+=o.pop(),u&&t.U.P.closePath(s),t.U.P.moveTo(s,d,p),u=!0;else if("o22"==x)o.length>1&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),d+=o.pop(),u&&t.U.P.closePath(s),t.U.P.moveTo(s,d,p),u=!0;else if("o25"==x){for(;o.length>6;)d+=o.shift(),p+=o.shift(),t.U.P.lineTo(s,d,p);f=d+o.shift(),g=p+o.shift(),m=f+o.shift(),v=g+o.shift(),d=m+o.shift(),p=v+o.shift(),t.U.P.curveTo(s,f,g,m,v,d,p)}else if("o26"==x)for(o.length%2&&(d+=o.shift());o.length>0;)f=d,g=p+o.shift(),d=m=f+o.shift(),p=(v=g+o.shift())+o.shift(),t.U.P.curveTo(s,f,g,m,v,d,p);else if("o27"==x)for(o.length%2&&(p+=o.shift());o.length>0;)g=p,m=(f=d+o.shift())+o.shift(),v=g+o.shift(),d=m+o.shift(),p=v,t.U.P.curveTo(s,f,g,m,v,d,p);else if("o10"==x||"o29"==x){var $="o10"==x?r:i;if(0==o.length)console.debug("error: empty stack");else{var B=o.pop(),F=$.Subrs[B+$.Bias];n.x=d,n.y=p,n.nStems=a,n.haveWidth=l,n.width=c,n.open=u,t.U._drawCFF(F,n,i,r,s),d=n.x,p=n.y,a=n.nStems,l=n.haveWidth,c=n.width,u=n.open}}else if("o30"==x||"o31"==x){var U=o.length,z=(R=0,"o31"==x);for(R+=U-(M=-3&U);R<M;)z?(g=p,m=(f=d+o.shift())+o.shift(),p=(v=g+o.shift())+o.shift(),M-R==5?(d=m+o.shift(),R++):d=m,z=!1):(f=d,g=p+o.shift(),m=f+o.shift(),v=g+o.shift(),d=m+o.shift(),M-R==5?(p=v+o.shift(),R++):p=v,z=!0),t.U.P.curveTo(s,f,g,m,v,d,p),R+=4}else{if("o"==(x+"").charAt(0))throw console.debug("Unknown operation: "+x,e),x;o.push(x)}}}n.x=d,n.y=p,n.nStems=a,n.haveWidth=l,n.width=c,n.open=u};var n=t,i={Typr:n};return e.Typr=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0}),e}({}).Typr},function(){return function(e){var t=Uint8Array,n=Uint16Array,i=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(e,t){for(var r=new n(31),s=0;s<31;++s)r[s]=t+=1<<e[s-1];var o=new i(r[30]);for(s=1;s<30;++s)for(var a=r[s];a<r[s+1];++a)o[a]=a-r[s]<<5|s;return[r,o]},l=a(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var h=a(s,0)[0],d=new n(32768),p=0;p<32768;++p){var f=(43690&p)>>>1|(21845&p)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[p]=((65280&f)>>>8|(255&f)<<8)>>>1}var g=function(e,t,i){for(var r=e.length,s=0,o=new n(t);s<r;++s)++o[e[s]-1];var a,l=new n(t);for(s=0;s<t;++s)l[s]=l[s-1]+o[s-1]<<1;if(i){a=new n(1<<t);var c=15-t;for(s=0;s<r;++s)if(e[s])for(var u=s<<4|e[s],h=t-e[s],p=l[e[s]-1]++<<h,f=p|(1<<h)-1;p<=f;++p)a[d[p]>>>c]=u}else for(a=new n(r),s=0;s<r;++s)e[s]&&(a[s]=d[l[e[s]-1]++]>>>15-e[s]);return a},m=new t(288);for(p=0;p<144;++p)m[p]=8;for(p=144;p<256;++p)m[p]=9;for(p=256;p<280;++p)m[p]=7;for(p=280;p<288;++p)m[p]=8;var v=new t(32);for(p=0;p<32;++p)v[p]=5;var _=g(m,9,1),b=g(v,5,1),y=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},T=function(e,t,n){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&n},E=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],w=function(e,t,n){var i=new Error(t||S[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,w),!n)throw i;return i},x=new t(0),M=typeof TextDecoder<"u"&&new TextDecoder;try{M.decode(x,{stream:!0})}catch{}return e.convert_streams=function(e){var a=new DataView(e),l=0;function u(){var e=a.getUint16(l);return l+=2,e}function d(){var e=a.getUint32(l);return l+=4,e}function p(e){L.setUint16(O,e),O+=2}function f(e){L.setUint32(O,e),O+=4}for(var m={signature:d(),flavor:d(),length:d(),numTables:u(),reserved:u(),totalSfntSize:d(),majorVersion:u(),minorVersion:u(),metaOffset:d(),metaLength:d(),metaOrigLength:d(),privOffset:d(),privLength:d()},v=0;Math.pow(2,v)<=m.numTables;)v++;v--;for(var S=16*Math.pow(2,v),x=16*m.numTables-S,M=12,I=[],C=0;C<m.numTables;C++)I.push({tag:d(),offset:d(),compLength:d(),origLength:d(),origChecksum:d()}),M+=16;var k,R=new Uint8Array(12+16*I.length+I.reduce((function(e,t){return e+t.origLength+4}),0)),A=R.buffer,L=new DataView(A),O=0;return f(m.flavor),p(m.numTables),p(S),p(v),p(x),I.forEach((function(e){f(e.tag),f(e.origChecksum),f(M),f(e.origLength),e.outOffset=M,(M+=e.origLength)%4!=0&&(M+=4-M%4)})),I.forEach((function(a){var l=e.slice(a.offset,a.offset+a.compLength);if(a.compLength!=a.origLength){var u=new Uint8Array(a.origLength);(function(e,a,l){var u=e.length;if(!u||l&&!l.l&&u<5)return a||new t(0);var d=!a||l,p=!l||l.i;l||(l={}),a||(a=new t(3*u));var f,m=function(e){var n=a.length;if(e>n){var i=new t(Math.max(2*n,e));i.set(a),a=i}},v=l.f||0,S=l.p||0,x=l.b||0,M=l.l,I=l.d,C=l.m,k=l.n,R=8*u;do{if(!M){l.f=v=T(e,S,1);var A=T(e,S+1,3);if(S+=3,!A){var L=e[(G=((f=S)/8|0)+(7&f&&1)+4)-4]|e[G-3]<<8,O=G+L;if(O>u){p&&w(0);break}d&&m(x+L),a.set(e.subarray(G,O),x),l.b=x+=L,l.p=S=8*O;continue}if(1==A)M=_,I=b,C=9,k=5;else if(2==A){var N=T(e,S,31)+257,D=T(e,S+10,15)+4,P=N+T(e,S+5,31)+1;S+=14;for(var $=new t(P),B=new t(19),F=0;F<D;++F)B[o[F]]=T(e,S+3*F,7);S+=3*D;var U=y(B),z=(1<<U)-1,H=g(B,U,1);for(F=0;F<P;){var G,V=H[T(e,S,z)];if(S+=15&V,(G=V>>>4)<16)$[F++]=G;else{var W=0,j=0;for(16==G?(j=3+T(e,S,3),S+=2,W=$[F-1]):17==G?(j=3+T(e,S,7),S+=3):18==G&&(j=11+T(e,S,127),S+=7);j--;)$[F++]=W}}var X=$.subarray(0,N),Y=$.subarray(N);C=y(X),k=y(Y),M=g(X,C,1),I=g(Y,k,1)}else w(1);if(S>R){p&&w(0);break}}d&&m(x+131072);for(var K=(1<<C)-1,q=(1<<k)-1,J=S;;J=S){var Z=(W=M[E(e,S)&K])>>>4;if((S+=15&W)>R){p&&w(0);break}if(W||w(2),Z<256)a[x++]=Z;else{if(256==Z){J=S,M=null;break}var Q=Z-254;if(Z>264){var ee=r[F=Z-257];Q=T(e,S,(1<<ee)-1)+c[F],S+=ee}var te=I[E(e,S)&q],ne=te>>>4;if(te||w(3),S+=15&te,Y=h[ne],ne>3&&(ee=s[ne],Y+=E(e,S)&(1<<ee)-1,S+=ee),S>R){p&&w(0);break}d&&m(x+131072);for(var ie=x+Q;x<ie;x+=4)a[x]=a[x-Y],a[x+1]=a[x+1-Y],a[x+2]=a[x+2-Y],a[x+3]=a[x+3-Y];x=ie}}l.l=M,l.p=J,l.b=x,M&&(v=1,l.m=C,l.d=I,l.n=k)}while(!v);x==a.length||function(e,r,s){(null==r||r<0)&&(r=0),(null==s||s>e.length)&&(s=e.length);var o=new(e instanceof n?n:e instanceof i?i:t)(s-r);o.set(e.subarray(r,s))}(a,0,x)})(new Uint8Array(l,2),u)}else u=new Uint8Array(l);R.set(u,a.outOffset);var d=0;(M=a.outOffset+a.origLength)%4!=0&&(d=4-M%4),R.set(new Uint8Array(d).buffer,a.outOffset+a.origLength),k=M+d})),A.slice(0,k)},Object.defineProperty(e,"__esModule",{value:!0}),e}({}).convert_streams},function(e,t){const n={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,o=4,a=8,l=16,c=32;let u;function h(e){if(!u){const e={R:s,L:r,D:o,C:l,U:c,T:a};u=new Map;for(let t in i){let n=0;i[t].split(",").forEach((i=>{let[r,s]=i.split("+");r=parseInt(r,36),s=s?parseInt(s,36):0,u.set(n+=r,e[t]);for(let o=s;o--;)u.set(++n,e[t])}))}}return u.get(e)||c}const d=1,p=2,f=3,g=4,m=[null,"isol","init","fina","medi"];function v(e){const t=new Uint8Array(e.length);let n=c,i=d,u=-1;for(let m=0;m<e.length;m++){const v=e.codePointAt(m);let _=0|h(v),b=d;_&a||(n&(r|o|l)?_&(s|o|l)?(b=f,(i===d||i===f)&&t[u]++):_&(r|c)&&(i===p||i===g)&&t[u]--:n&(s|c)&&(i===p||i===g)&&t[u]--,i=t[m]=b,n=_,u=m,v>65535&&m++)}return t}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;i++)if("number"==typeof t[i])return t[i]}function b(t){const i=Object.create(null),r=t["OS/2"],s=t.hhea,o=t.head.unitsPerEm,a=_(r&&r.sTypoAscender,s&&s.ascender,o),l={unitsPerEm:o,ascender:a,descender:_(r&&r.sTypoDescender,s&&s.descender,0),capHeight:_(r&&r.sCapHeight,a),xHeight:_(r&&r.sxHeight,a),lineGap:_(r&&r.sTypoLineGap,s&&s.lineGap),forEachGlyph(r,s,o,a){let c=0;const u=1/l.unitsPerEm*s,h=function(t,n){const i=[];for(let s=0;s<n.length;s++){const r=n.codePointAt(s);r>65535&&s++,i.push(e.U.codeToGlyph(t,r))}const r=t.GSUB;if(r){const{lookupList:t,featureList:s}=r;let o;const a=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,l=[];s.forEach((r=>{if(a.test(r.tag))for(let s=0;s<r.tab.length;s++){if(l[r.tab[s]])continue;l[r.tab[s]]=!0;const a=t[r.tab[s]],c=/^(isol|init|fina|medi)$/.test(r.tag);c&&!o&&(o=v(n));for(let n=0;n<i.length;n++)(!o||!c||m[o[n]]===r.tag)&&e.U._applySubs(i,n,a,t)}}))}return i}(t,r);let d=0,p=-1;return h.forEach(((l,h)=>{if(-1!==l){let r=i[l];if(!r){const{cmds:s,crds:o}=e.U.glyphToPath(t,l);let a,c,u,h,d="",p=0;for(let e=0,t=s.length;e<t;e++){const t=n[s[e]];d+=s[e];for(let e=1;e<=t;e++)d+=(e>1?",":"")+o[p++]}if(o.length){a=c=1/0,u=h=-1/0;for(let e=0,t=o.length;e<t;e+=2){let t=o[e],n=o[e+1];t<a&&(a=t),n<c&&(c=n),t>u&&(u=t),n>h&&(h=n)}}else a=u=c=h=0;r=i[l]={index:l,advanceWidth:t.hmtx.aWidth[l],xMin:a,yMin:c,xMax:u,yMax:h,path:d,pathCommandCount:s.length}}-1!==p&&(c+=e.U.getPairAdjustment(t,p,l)*u),a.call(null,r,c,d),r.advanceWidth&&(c+=r.advanceWidth*u),o&&(c+=o*s),p=l}d+=r.codePointAt(d)>65535?2:1})),c}};return l}return function(n){const i=new Uint8Array(n,0,4),r=e._bin.readASCII(i,0,4);if("wOFF"===r)n=t(n);else if("wOF2"===r)throw new Error("woff2 fonts not supported");return b(e.parse(n)[0])}}],init:(e,t,n)=>n(e(),t())}),rm={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},sm=new ln;function om(){return(self.performance||Date).now()}const am=Object.create(null);function lm(e,t){e=function(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}({},e);const n=om();if(e.font=function(e){return um||(um=typeof document>"u"?{}:document.createElement("a")),um.href=e,um.href}(e.font||rm.defaultFontURL),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||rm.sdfGlyphSize,null!=e.colorRanges){let t={};for(let n in e.colorRanges)if(e.colorRanges.hasOwnProperty(n)){let i=e.colorRanges[n];"number"!=typeof i&&(i=sm.set(i).getHex()),t[n]=i}e.colorRanges=t}Object.freeze(e);const{textureWidth:i,sdfExponent:r}=rm,{sdfGlyphSize:s}=e,o=i/s*4;let a=am[s];if(!a){const e=document.createElement("canvas");e.width=i,e.height=256*s/o,a=am[s]={glyphCount:0,sdfGlyphSize:s,sdfCanvas:e,sdfTexture:new fn(e,void 0,void 0,void 0,pe,pe),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,function(e){const t=e.sdfCanvas;t.addEventListener("webglcontextlost",(t=>{console.log("Context Lost",t),t.preventDefault(),e.contextLost=!0})),t.addEventListener("webglcontextrestored",(t=>{console.log("Context Restored",t),e.contextLost=!1;const n=[];e.glyphsByFont.forEach((t=>{t.forEach((t=>{n.push(cm(t,e,!0))}))})),Promise.all(n).then((()=>{hm(e),e.sdfTexture.needsUpdate=!0}))}))}(a)}const{sdfTexture:l,sdfCanvas:c}=a;let u=a.glyphsByFont.get(e.font);u||a.glyphsByFont.set(e.font,u=new Map),pm(e).then((h=>{const{glyphIds:d,glyphPositions:p,fontSize:f,unitsPerEm:g,timings:m}=h,v=[],_=new Float32Array(4*d.length),b=f/g;let y=0,T=0;const E=om();d.forEach(((e,t)=>{let n=u.get(e);if(!n){const{path:t,pathBounds:i}=h.glyphData[e],r=Math.max(i[2]-i[0],i[3]-i[1])/s*(rm.sdfMargin*s+.5),o=a.glyphCount++,l=[i[0]-r,i[1]-r,i[2]+r,i[3]+r];u.set(e,n={path:t,atlasIndex:o,sdfViewBox:l}),v.push(n)}const{sdfViewBox:i}=n,r=p[T++],o=p[T++];_[y++]=r+i[0]*b,_[y++]=o+i[1]*b,_[y++]=r+i[2]*b,_[y++]=o+i[3]*b,d[t]=n.atlasIndex})),m.quads=(m.quads||0)+(om()-E);const S=om();m.sdf={};const w=c.height,x=Math.ceil(a.glyphCount/o),M=Math.pow(2,Math.ceil(Math.log2(x*s)));M>w&&(console.info("Increasing SDF texture size ".concat(w,"->").concat(M)),nm(c,i,M),l.dispose()),Promise.all(v.map((t=>cm(t,a,e.gpuAccelerateSDF).then((e=>{let{timing:n}=e;m.sdf[t.atlasIndex]=n}))))).then((()=>{v.length&&!a.contextLost&&(hm(a),l.needsUpdate=!0),m.sdfTotal=om()-S,m.total=om()-n,t(Object.freeze({parameters:e,sdfTexture:l,sdfGlyphSize:s,sdfExponent:r,glyphBounds:_,glyphAtlasIndices:d,glyphColors:h.glyphColors,caretPositions:h.caretPositions,caretHeight:h.caretHeight,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))}))})),Promise.resolve().then((()=>{a.contextLost||function(e){e._warm||(Wg.webgl.isSupported(e),e._warm=!0)}(c)}))}function cm(e,t,n){let{path:i,atlasIndex:r,sdfViewBox:s}=e,{sdfGlyphSize:o,sdfCanvas:a,contextLost:l}=t;if(l)return Promise.resolve({timing:-1});const{textureWidth:c,sdfExponent:u}=rm,h=Math.max(s[2]-s[0],s[3]-s[1]),d=Math.floor(r/4);return function(e,t,n,i,r,s,o,a,l,c){return arguments.length>10&&void 0!==arguments[10]&&!arguments[10]?tm(e,t,n,i,r,s,o,a,l,c):qg(e,t,n,i,r,s,o,a,l,c).then(null,(u=>(jg||(console.warn("WebGL SDF generation failed, falling back to JS",u),jg=!0),tm(e,t,n,i,r,s,o,a,l,c))))}(o,o,i,s,h,u,a,d%(c/o)*o,Math.floor(d/(c/o))*o,r%4,n)}let um;function hm(e){if("function"!=typeof createImageBitmap){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:n}=e,{width:i,height:r}=t,s=e.sdfCanvas.getContext("webgl");let o=n.image.data;(!o||o.length!==i*r*4)&&(o=new Uint8Array(i*r*4),n.image={width:i,height:r,data:o},n.flipY=!1,n.isDataTexture=!0),s.readPixels(0,0,i,r,s.RGBA,s.UNSIGNED_BYTE,o)}}const dm=Ig({name:"Typesetter",dependencies:[rm,im,function(e,t,n){const{defaultFontURL:i}=n,r=Object.create(null),s=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",l=new RegExp("".concat(a,"|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]"));function c(t,n){t||(t=i);let s=r[t];s?s.pending?s.pending.push(n):n(s):(r[t]={pending:[n]},function(t,n){!function r(){const s=e=>{console.error("Failure loading font ".concat(t).concat(t===i?"":"; trying fallback"),e),t!==i&&(t=i,r())};try{const i=new XMLHttpRequest;i.open("get",t,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status>=400)s(new Error(i.statusText));else if(i.status>0)try{const t=e(i.response);n(t)}catch(t){s(t)}},i.onerror=s,i.send()}catch(o){s(o)}}()}(t,(e=>{let n=r[t].pending;r[t]=e,n.forEach((t=>t(e)))})))}function u(e,n){let{text:r="",font:u=i,sdfGlyphSize:g=64,fontSize:m=1,letterSpacing:v=0,lineHeight:_="normal",maxWidth:b=s,direction:y,textAlign:T="left",textIndent:E=0,whiteSpace:S="normal",overflowWrap:w="normal",anchorX:x=0,anchorY:M=0,includeCaretPositions:I=!1,chunkedBoundsSize:C=8192,colorRanges:k=null}=e,R=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const A=p(),L={fontLoad:0,typesetting:0};r.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),r=r.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),m=+m,v=+v,b=+b,_=_||"normal",E=+E,c(u,(e=>{const i=isFinite(b);let c=null,u=null,g=null,O=null,N=null,D=null,P=null,$=0,B=0,F="nowrap"!==S;const{ascender:U,descender:z,unitsPerEm:H,lineGap:G,capHeight:V,xHeight:W}=e;L.fontLoad=p()-A;const j=p(),X=m/H;"normal"===_&&(_=(U-z+G)/H),_*=m;const Y=(_-(U-z)*X)/2,K=-(U*X+Y),q=Math.min(_,(U-z)*X),J=(U+z)/2*X-q/2;let Z=E,Q=new f;const ee=[Q];e.forEachGlyph(r,m,v,((e,t,n)=>{const s=r.charAt(n),c=e.advanceWidth*X,u=Q.count;let h;if("isEmpty"in e||(e.isWhitespace=!!s&&new RegExp(a).test(s),e.canBreakAfter=!!s&&l.test(s),e.isEmpty=e.xMin===e.xMax||e.yMin===e.yMax||o.test(s)),!e.isWhitespace&&!e.isEmpty&&B++,F&&i&&!e.isWhitespace&&t+c+Z>b&&u){if(Q.glyphAt(u-1).glyphObj.canBreakAfter)h=new f,Z=-t;else for(let e=u;e--;){if(0===e&&"break-word"===w){h=new f,Z=-t;break}if(Q.glyphAt(e).glyphObj.canBreakAfter){h=Q.splitAt(e+1);const t=h.glyphAt(0).x;Z-=t;for(let e=h.count;e--;)h.glyphAt(e).x-=t;break}}h&&(Q.isSoftWrapped=!0,Q=h,ee.push(Q),$=b)}let d=Q.glyphAt(Q.count);d.glyphObj=e,d.x=t+Z,d.width=c,d.charIndex=n,"\n"===s&&(Q=new f,ee.push(Q),Z=-(t+c+v*m)+E)})),ee.forEach((e=>{for(let t=e.count;t--;){let{glyphObj:n,x:i,width:r}=e.glyphAt(t);if(!n.isWhitespace)return e.width=i+r,void(e.width>$&&($=e.width))}}));let te=0,ne=0;if(x&&("number"==typeof x?te=-x:"string"==typeof x&&(te=-$*("left"===x?0:"center"===x?.5:"right"===x?1:h(x)))),M)if("number"==typeof M)ne=-M;else if("string"==typeof M){let e=ee.length*_;ne="top"===M?0:"top-baseline"===M?-K:"top-cap"===M?-K-V*X:"top-ex"===M?-K-W*X:"middle"===M?e/2:"bottom"===M?e:"bottom-baseline"===M?e-Y+z*X:h(M)*e}if(!R){const n=t.getEmbeddingLevels(r,y);c=new Uint16Array(B),u=new Float32Array(2*B),g={},D=[s,s,-s,-s],P=[];let i=K;I&&(N=new Float32Array(3*r.length)),k&&(O=new Uint8Array(3*B));let o,a,l=0,h=-1,p=-1;if(ee.forEach(((f,m)=>{let{count:v,width:b}=f;if(v>0){let m=0;for(let e=v;e--&&f.glyphAt(e).glyphObj.isWhitespace;)m++;let _=0,y=0;if("center"===T)_=($-b)/2;else if("right"===T)_=$-b;else if("justify"===T&&f.isSoftWrapped){let e=0;for(let t=v-m;t--;)f.glyphAt(t).glyphObj.isWhitespace&&e++;y=($-b)/e}if(y||_){let e=0;for(let t=0;t<v;t++){let n=f.glyphAt(t);const i=n.glyphObj;n.x+=_+e,0!==y&&i.isWhitespace&&t<v-m&&(e+=y,n.width+=y)}}const E=t.getReorderSegments(r,n,f.glyphAt(0).charIndex,f.glyphAt(f.count-1).charIndex);for(let e=0;e<E.length;e++){const[t,n]=E[e];let i=1/0,r=-1/0;for(let e=0;e<v;e++)if(f.glyphAt(e).charIndex>=t){let t=e,s=e;for(;s<v;s++){let e=f.glyphAt(s);if(e.charIndex>n)break;s<v-m&&(i=Math.min(i,e.x),r=Math.max(r,e.x+e.width))}for(let e=t;e<s;e++){const t=f.glyphAt(e);t.x=r-(t.x+t.width-i)}break}}let S;const w=e=>S=e;for(let b=0;b<v;b++){let m=f.glyphAt(b);S=m.glyphObj;const v=S.index,_=1&n.levels[m.charIndex];if(_){const n=t.getMirroredCharacter(r[m.charIndex]);n&&e.forEachGlyph(n,0,0,w)}if(I){const{charIndex:e}=m,t=m.x+te,n=m.x+m.width+te;N[3*e]=_?n:t,N[3*e+1]=_?t:n,N[3*e+2]=i+J+ne;const r=e-h;r>1&&d(N,h,r),h=e}if(k){const{charIndex:e}=m;for(;e>p;)p++,k.hasOwnProperty(p)&&(a=k[p])}if(!S.isWhitespace&&!S.isEmpty){const e=l++;g[v]||(g[v]={path:S.path,pathBounds:[S.xMin,S.yMin,S.xMax,S.yMax]});const t=m.x+te,n=i+ne;u[2*e]=t,u[2*e+1]=n;const r=t+S.xMin*X,h=n+S.yMin*X,d=t+S.xMax*X,p=n+S.yMax*X;r<D[0]&&(D[0]=r),h<D[1]&&(D[1]=h),d>D[2]&&(D[2]=d),p>D[3]&&(D[3]=p),e%C===0&&(o={start:e,end:e,rect:[s,s,-s,-s]},P.push(o)),o.end++;const f=o.rect;if(r<f[0]&&(f[0]=r),h<f[1]&&(f[1]=h),d>f[2]&&(f[2]=d),p>f[3]&&(f[3]=p),c[e]=v,k){const t=3*e;O[t]=a>>16&255,O[t+1]=a>>8&255,O[t+2]=255&a}}}}i-=_})),N){const e=r.length-h;e>1&&d(N,h,e)}}L.typesetting=p()-j,n({glyphIds:c,glyphPositions:u,glyphData:g,caretPositions:N,caretHeight:q,glyphColors:O,chunkedBounds:P,fontSize:m,unitsPerEm:H,ascender:U*X,descender:z*X,capHeight:V*X,xHeight:W*X,lineHeight:_,topBaseline:K,blockBounds:[te,ne-ee.length*_,te+$,ne],visibleBounds:D,timings:L})}))}function h(e){let t=e.match(/^([\d.]+)%$/),n=t?parseFloat(t[1]):NaN;return isNaN(n)?0:n/100}function d(e,t,n){const i=e[3*t],r=e[3*t+1],s=e[3*t+2],o=(r-i)/n;for(let a=0;a<n;a++){const n=3*(t+a);e[n]=i+o*a,e[n+1]=i+o*(a+1),e[n+2]=s}}function p(){return(self.performance||Date).now()}function f(){this.data=[]}const g=["glyphObj","x","width","charIndex"];return f.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/g.length)},glyphAt(e){let t=f.flyweight;return t.data=this.data,t.index=e,t},splitAt(e){let t=new f;return t.data=this.data.splice(e*g.length),t}},f.flyweight=g.reduce(((e,t,n,i)=>(Object.defineProperty(e,t,{get(){return this.data[this.index*g.length+n]},set(e){this.data[this.index*g.length+n]=e}}),e)),{data:null,index:0}),{typeset:u,measure:function(e,t){u(e,(e=>{const[n,i,r,s]=e.blockBounds;t({width:r-n,height:s-i})}),{metricsOnly:!0})},loadFont:c}},function(){var e=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},i={};n.L=1,i[1]="L",Object.keys(t).forEach((function(e,t){n[e]=1<<t+1,i[n[e]]=e})),Object.freeze(n);var r=n.LRI|n.RLI|n.FSI,s=n.L|n.R|n.AL,o=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,a=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,l=n.S|n.WS|n.B|r|n.PDI|a,c=null;function u(e){return function(){if(!c){c=new Map;var e=function(e){if(t.hasOwnProperty(e)){var i=0;t[e].split(",").forEach((function(t){var r=t.split("+"),s=r[0],o=r[1];s=parseInt(s,36),o=o?parseInt(o,36):0,c.set(i+=s,n[e]);for(var a=0;a<o;a++)c.set(++i,n[e])}))}};for(var i in t)e(i)}}(),c.get(e.codePointAt(0))||n.L}var h,d,p,f={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(e,t){var n,i=0,r=new Map,s=t&&new Map;return e.split(",").forEach((function e(o){if(-1!==o.indexOf("+"))for(var a=+o;a--;)e(n);else{n=o;var l=o.split(">"),c=l[0],u=l[1];c=String.fromCodePoint(i+=parseInt(c,36)),u=String.fromCodePoint(i+=parseInt(u,36)),r.set(c,u),t&&s.set(u,c)}})),{map:r,reverseMap:s}}function m(){if(!h){var e=g(f.pairs,!0),t=e.map,n=e.reverseMap;h=t,d=n,p=g(f.canonical,!1).map}}function v(e){return m(),h.get(e)||null}function _(e){return m(),d.get(e)||null}function b(e){return m(),p.get(e)||null}var y=n.L,T=n.R,E=n.EN,S=n.ES,w=n.ET,x=n.AN,M=n.CS,I=n.B,C=n.S,k=n.ON,R=n.BN,A=n.NSM,L=n.AL,O=n.LRO,N=n.RLO,D=n.LRE,P=n.RLE,$=n.PDF,B=n.LRI,F=n.RLI,U=n.FSI,z=n.PDI;var H,G="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1";function V(e){return function(){if(!H){var e=g(G,!0),t=e.map;e.reverseMap.forEach((function(e,n){t.set(n,e)})),H=t}}(),H.get(e)||null}function W(e,t,n,i){var r=e.length;n=Math.max(0,null==n?0:+n),i=Math.min(r-1,null==i?r-1:+i);var s=[];return t.paragraphs.forEach((function(r){var o=Math.max(n,r.start),a=Math.min(i,r.end);if(o<a){for(var c=t.levels.slice(o,a+1),h=a;h>=o&&u(e[h])&l;h--)c[h]=r.level;for(var d=r.level,p=1/0,f=0;f<c.length;f++){var g=c[f];g>d&&(d=g),g<p&&(p=1|g)}for(var m=d;m>=p;m--)for(var v=0;v<c.length;v++)if(c[v]>=m){for(var _=v;v+1<c.length&&c[v+1]>=m;)v++;v>_&&s.push([_+n,v+n])}}})),s}function j(e,t,n,i){for(var r=W(e,t,n,i),s=[],o=0;o<e.length;o++)s[o]=o;return r.forEach((function(e){for(var t=e[0],n=e[1],i=s.slice(t,n+1),r=i.length;r--;)s[n-r]=i[r]})),s}return e.closingToOpeningBracket=_,e.getBidiCharType=u,e.getBidiCharTypeName=function(e){return i[u(e)]},e.getCanonicalBracket=b,e.getEmbeddingLevels=function(e,t){for(var n=new Uint32Array(e.length),i=0;i<e.length;i++)n[i]=u(e[i]);var c=new Map;function h(e,t){var i=n[e];n[e]=t,c.set(i,c.get(i)-1),i&o&&c.set(o,c.get(o)-1),c.set(t,(c.get(t)||0)+1),t&o&&c.set(o,(c.get(o)||0)+1)}for(var d=new Uint8Array(e.length),p=new Map,f=[],g=null,m=0;m<e.length;m++)g||f.push(g={start:m,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:zt(m,!1)}),n[m]&I&&(g.end=m,g=null);for(var H=P|D|N|O|r|z|$|I,G=function(e){return e+(1&e?1:2)},V=function(e){return e+(1&e?2:1)},W=0;W<f.length;W++){var j=[{_level:(g=f[W]).level,_override:0,_isolate:0}],X=void 0,Y=0,K=0,q=0;c.clear();for(var J=g.start;J<=g.end;J++){var Z=n[J];if(X=j[j.length-1],c.set(Z,(c.get(Z)||0)+1),Z&o&&c.set(o,(c.get(o)||0)+1),Z&H)if(Z&(P|D)){d[J]=X._level;var Q=(Z===P?V:G)(X._level);Q<=125&&!Y&&!K?j.push({_level:Q,_override:0,_isolate:0}):Y||K++}else if(Z&(N|O)){d[J]=X._level;var ee=(Z===N?V:G)(X._level);ee<=125&&!Y&&!K?j.push({_level:ee,_override:Z&N?T:y,_isolate:0}):Y||K++}else if(Z&r){Z&U&&(Z=1===zt(J+1,!0)?F:B),d[J]=X._level,X._override&&h(J,X._override);var te=(Z===F?V:G)(X._level);te<=125&&0===Y&&0===K?(q++,j.push({_level:te,_override:0,_isolate:1,_isolInitIndex:J})):Y++}else if(Z&z){if(Y>0)Y--;else if(q>0){for(K=0;!j[j.length-1]._isolate;)j.pop();var ne=j[j.length-1]._isolInitIndex;null!=ne&&(p.set(ne,J),p.set(J,ne)),j.pop(),q--}X=j[j.length-1],d[J]=X._level,X._override&&h(J,X._override)}else Z&$?(0===Y&&(K>0?K--:!X._isolate&&j.length>1&&(j.pop(),X=j[j.length-1])),d[J]=X._level):Z&I&&(d[J]=g.level);else d[J]=X._level,X._override&&Z!==R&&h(J,X._override)}for(var ie=[],re=null,se=g.start;se<=g.end;se++){var oe=n[se];if(!(oe&a)){var ae=d[se],le=oe&r,ce=oe===z;re&&ae===re._level?(re._end=se,re._endsWithIsolInit=le):ie.push(re={_start:se,_end:se,_level:ae,_startsWithPDI:ce,_endsWithIsolInit:le})}}for(var ue=[],he=0;he<ie.length;he++){var de=ie[he];if(!de._startsWithPDI||de._startsWithPDI&&!p.has(de._start)){for(var pe=[re=de],fe=void 0;re&&re._endsWithIsolInit&&null!=(fe=p.get(re._end));)for(var ge=he+1;ge<ie.length;ge++)if(ie[ge]._start===fe){pe.push(re=ie[ge]);break}for(var me=[],ve=0;ve<pe.length;ve++)for(var _e=pe[ve],be=_e._start;be<=_e._end;be++)me.push(be);for(var ye=d[me[0]],Te=g.level,Ee=me[0]-1;Ee>=0;Ee--)if(!(n[Ee]&a)){Te=d[Ee];break}var Se=me[me.length-1],we=d[Se],xe=g.level;if(!(n[Se]&r))for(var Me=Se+1;Me<=g.end;Me++)if(!(n[Me]&a)){xe=d[Me];break}ue.push({_seqIndices:me,_sosType:Math.max(Te,ye)%2?T:y,_eosType:Math.max(xe,we)%2?T:y})}}for(var Ie=0;Ie<ue.length;Ie++){var Ce=ue[Ie],ke=Ce._seqIndices,Re=Ce._sosType,Ae=Ce._eosType;if(c.get(A))for(var Le=0;Le<ke.length;Le++){var Oe=ke[Le];if(n[Oe]&A){for(var Ne=Re,De=Le-1;De>=0;De--)if(!(n[ke[De]]&a)){Ne=n[ke[De]];break}h(Oe,Ne&(r|z)?k:Ne)}}if(c.get(E))for(var Pe=0;Pe<ke.length;Pe++){var $e=ke[Pe];if(n[$e]&E)for(var Be=Pe-1;Be>=-1;Be--){var Fe=-1===Be?Re:n[ke[Be]];if(Fe&s){Fe===L&&h($e,x);break}}}if(c.get(L))for(var Ue=0;Ue<ke.length;Ue++){var ze=ke[Ue];n[ze]&L&&h(ze,T)}if(c.get(S)||c.get(M))for(var He=1;He<ke.length-1;He++){var Ge=ke[He];if(n[Ge]&(S|M)){for(var Ve=0,We=0,je=He-1;je>=0&&(Ve=n[ke[je]])&a;je--);for(var Xe=He+1;Xe<ke.length&&(We=n[ke[Xe]])&a;Xe++);Ve===We&&(n[Ge]===S?Ve===E:Ve&(E|x))&&h(Ge,Ve)}}if(c.get(E))for(var Ye=0;Ye<ke.length;Ye++){var Ke=ke[Ye];if(n[Ke]&E){for(var qe=Ye-1;qe>=0&&n[ke[qe]]&(w|a);qe--)h(ke[qe],E);for(var Je=Ye+1;Je<ke.length&&n[ke[Je]]&(w|a);Je++)h(ke[Je],E)}}if(c.get(w)||c.get(S)||c.get(M))for(var Ze=0;Ze<ke.length;Ze++){var Qe=ke[Ze];if(n[Qe]&(w|S|M)){h(Qe,k);for(var et=Ze-1;et>=0&&n[ke[et]]&a;et--)h(ke[et],k);for(var tt=Ze+1;tt<ke.length&&n[ke[tt]]&a;tt++)h(ke[tt],k)}}if(c.get(E))for(var nt=0,it=Re;nt<ke.length;nt++){var rt=ke[nt],st=n[rt];st&E?it===y&&h(rt,y):st&s&&(it=st)}if(c.get(o)){for(var ot=T|E|x,at=ot|y,lt=[],ct=[],ut=0;ut<ke.length;ut++)if(n[ke[ut]]&o){var ht=e[ke[ut]],dt=void 0;if(null!==v(ht)){if(!(ct.length<63))break;ct.push({char:ht,seqIndex:ut})}else if(null!==(dt=_(ht)))for(var pt=ct.length-1;pt>=0;pt--){var ft=ct[pt].char;if(ft===dt||ft===_(b(ht))||v(b(ft))===ht){lt.push([ct[pt].seqIndex,ut]),ct.length=pt;break}}}lt.sort((function(e,t){return e[0]-t[0]}));for(var gt=0;gt<lt.length;gt++){for(var mt=lt[gt],vt=mt[0],_t=mt[1],bt=!1,yt=0,Tt=vt+1;Tt<_t;Tt++){var Et=ke[Tt];if(n[Et]&at){bt=!0;var St=n[Et]&ot?T:y;if(St===Gt(Et)){yt=St;break}}}if(bt&&!yt){yt=Re;for(var wt=vt-1;wt>=0;wt--){var xt=ke[wt];if(n[xt]&at){var Mt=n[xt]&ot?T:y;yt=Mt!==Gt(xt)?Mt:Gt(xt);break}}}if(yt){if(n[ke[vt]]=n[ke[_t]]=yt,yt!==Gt(ke[vt]))for(var It=vt+1;It<ke.length;It++)if(!(n[ke[It]]&a)){u(e[ke[It]])&A&&(n[ke[It]]=yt);break}if(yt!==Gt(ke[_t]))for(var Ct=_t+1;Ct<ke.length;Ct++)if(!(n[ke[Ct]]&a)){u(e[ke[Ct]])&A&&(n[ke[Ct]]=yt);break}}}for(var kt=0;kt<ke.length;kt++)if(n[ke[kt]]&o){for(var Rt=kt,At=kt,Lt=Re,Ot=kt-1;Ot>=0;Ot--){if(!(n[ke[Ot]]&a)){Lt=n[ke[Ot]]&ot?T:y;break}Rt=Ot}for(var Nt=Ae,Dt=kt+1;Dt<ke.length;Dt++){if(!(n[ke[Dt]]&(o|a))){Nt=n[ke[Dt]]&ot?T:y;break}At=Dt}for(var Pt=Rt;Pt<=At;Pt++)n[ke[Pt]]=Lt===Nt?Lt:Gt(ke[Pt]);kt=At}}}for(var $t=g.start;$t<=g.end;$t++){var Bt=d[$t],Ft=n[$t];if(1&Bt?Ft&(y|E|x)&&d[$t]++:Ft&T?d[$t]++:Ft&(x|E)&&(d[$t]+=2),Ft&a&&(d[$t]=0===$t?g.level:d[$t-1]),$t===g.end||u(e[$t])&(C|I))for(var Ut=$t;Ut>=0&&u(e[Ut])&l;Ut--)d[Ut]=g.level}}return{levels:d,paragraphs:f};function zt(t,i){for(var s=t;s<e.length;s++){var o=n[s];if(o&(T|L))return 1;if(o&(I|y)||i&&o===z)return 0;if(o&r){var a=Ht(s);s=-1===a?e.length:a}}return 0}function Ht(t){for(var i=1,s=t+1;s<e.length;s++){var o=n[s];if(o&I)break;if(o&z){if(0===--i)return s}else o&r&&i++}return-1}function Gt(e){return 1&d[e]?T:y}},e.getMirroredCharacter=V,e.getMirroredCharactersMap=function(e,t,n,i){var r=e.length;n=Math.max(0,null==n?0:+n),i=Math.min(r-1,null==i?r-1:+i);for(var s=new Map,o=n;o<=i;o++)if(1&t[o]){var a=V(e[o]);null!==a&&s.set(o,a)}return s},e.getReorderSegments=W,e.getReorderedIndices=j,e.getReorderedString=function(e,t,n,i){var r=j(e,t,n,i),s=[].concat(e);return r.forEach((function(n,i){s[i]=(1&t.levels[n]?V(e[n]):null)||e[n]})),s.join("")},e.openingToClosingBracket=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e}],init(e,t,n,i){const{defaultFontURL:r}=e;return n(t,i(),{defaultFontURL:r})}}),pm=Ig({name:"Typesetter",dependencies:[dm],init:e=>function(t){return new Promise((n=>{e.typeset(t,n)}))},getTransferables(e){const t=[e.glyphPositions.buffer,e.glyphIds.buffer];return e.caretPositions&&t.push(e.caretPositions.buffer),e.glyphColors&&t.push(e.glyphColors.buffer),t}}),fm={};const gm="aTroikaGlyphIndex";class mm extends eh{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Hn,this.boundingBox=new Sn}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const t=this.getIndex().count;this.setDrawRange(e===f?t/2:0,e===g?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,("number"!=typeof e||e<1)&&(e=1);let t=function(e){let t=fm[e];if(!t){const n=new Pr(1,1,e,e),i=n.clone(),r=n.attributes,s=i.attributes,o=new qi,a=r.uv.count;for(let e=0;e<a;e++)s.position.array[3*e]*=-1,s.normal.array[3*e+2]*=-1;["position","normal","uv"].forEach((e=>{o.setAttribute(e,new Hi([...r[e].array,...s[e].array],r[e].itemSize))})),o.setIndex([...n.index.array,...i.index.array.map((e=>e+a))]),o.translate(.5,.5,0),t=fm[e]=o}return t}(e);["position","normal","uv"].forEach((e=>{this.attributes[e]=t.attributes[e].clone()})),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,i,r){vm(this,"aTroikaGlyphBounds",e,4),vm(this,gm,t,1),vm(this,"aTroikaGlyphColor",r,3),this._blockBounds=n,this._chunkedBounds=i,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:i,floor:r,min:s,max:o,sin:a,cos:l}=Math,c=i/2,u=2*i,h=Math.abs(t),d=e[0]/h,p=e[2]/h,f=r((d+c)/u)!==r((p+c)/u)?-h:s(a(d)*h,a(p)*h),g=r((d-c)/u)!==r((p-c)/u)?h:o(a(d)*h,a(p)*h),m=r((d+i)/u)!==r((p+i)/u)?2*h:o(h-l(d)*h,h-l(p)*h);n.min.set(f,e[1],t<0?-m:0),n.max.set(g,e[3],t<0?0:m)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(gm).count,n=this._chunkedBounds;if(n)for(let i=n.length;i--;){t=n[i].end;let r=n[i].rect;if(r[1]<e.w&&r[3]>e.y&&r[0]<e.z&&r[2]>e.x)break}this.instanceCount=t}}function vm(e,t,n,i){const r=e.getAttribute(t);n?r&&r.array.length===n.length?(r.array.set(n),r.needsUpdate=!0):(e.setAttribute(t,new el(n,i)),delete e._maxInstanceCount,e.dispose()):r&&e.deleteAttribute(t)}const _m=new Pi({color:16777215,side:g,transparent:!0}),bm=8421504,ym=new Jn,Tm=new yn,Em=new yn,Sm=[],wm=new yn,xm="+x+y";function Mm(e){return Array.isArray(e)?e[0]:e}let Im=()=>{const e=new fr(new Pr(1,1),_m);return Im=()=>e,e},Cm=()=>{const e=new fr(new Pr(1,1,32,1),_m);return Cm=()=>e,e};const km={type:"syncstart"},Rm={type:"synccomplete"},Am=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Lm=Am.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class Om extends fr{constructor(){super(new mm,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=bm,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=xm,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(km),lm({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},(t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync((()=>{n.forEach((e=>e&&e()))}))),this.dispatchEvent(Rm),e&&e()}))))}onBeforeRender(e,t,n,i,r,s){this.sync(),r.isTroikaTextMaterial&&this._prepareForRender(r),r._hadOwnSide=r.hasOwnProperty("side"),this.geometry.setSide(r._actualSide=r.side),r.side=p}onAfterRender(e,t,n,i,r,s){r._hadOwnSide?r.side=r._actualSide:delete r.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=_m.clone());if((!e||e.baseMaterial!==t)&&(e=this._derivedMaterial=function(e){const t=Fg(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Wt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new gn(0,0,0,0)},uTroikaClipRect:{value:new gn(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Wt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new ln},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new jt},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of exponential encoding in webgl-sdf-generator\n  \n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  \n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n",fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat fragDistance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  fragDistance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter(e){let{vertexShader:t,fragmentShader:n}=e,i=/\buniform\s+vec3\s+diffuse\b/;return i.test(n)&&(n=n.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(Ag,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:t,fragmentShader:n}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}(t),t.addEventListener("dispose",(function n(){t.removeEventListener("dispose",n),e.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let t=e._outlineMtl;return t||(t=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),t.isTextOutlineMaterial=!0,t.depthWrite=!1,t.map=null,e.addEventListener("dispose",(function n(){e.removeEventListener("dispose",n),t.dispose()}))),[t,e]}return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Mm(this.material).getDepthMaterial()}get customDistanceMaterial(){return Mm(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:e,blockBounds:r}=i;n.uTroikaSDFTexture.value=e,n.uTroikaSDFTextureSize.value.set(e.image.width,e.image.height),n.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,n.uTroikaSDFExponent.value=i.sdfExponent,n.uTroikaTotalBounds.value.fromArray(r),n.uTroikaUseGlyphColors.value=!t&&!!i.glyphColors;let s,o,a,l=0,c=0,u=0,h=0,d=0;if(t){let{outlineWidth:e,outlineOffsetX:t,outlineOffsetY:n,outlineBlur:i,outlineOpacity:r}=this;l=this._parsePercent(e)||0,c=Math.max(0,this._parsePercent(i)||0),s=r,h=this._parsePercent(t)||0,d=this._parsePercent(n)||0}else u=Math.max(0,this._parsePercent(this.strokeWidth)||0),u&&(a=this.strokeColor,n.uTroikaStrokeColor.value.set(null==a?bm:a),o=this.strokeOpacity,null==o&&(o=1)),s=this.fillOpacity;n.uTroikaDistanceOffset.value=l,n.uTroikaPositionOffset.value.set(h,d),n.uTroikaBlurRadius.value=c,n.uTroikaStrokeWidth.value=u,n.uTroikaStrokeOpacity.value=o,n.uTroikaFillOpacity.value=null==s?1:s,n.uTroikaCurveRadius.value=this.curveRadius||0;let p=this.clipRect;if(p&&Array.isArray(p)&&4===p.length)n.uTroikaClipRect.value.fromArray(p);else{const e=100*(this.fontSize||.1);n.uTroikaClipRect.value.set(r[0]-e,r[1]-e,r[2]+e,r[3]+e)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const r=t?this.outlineColor||0:this.color;if(null==r)delete e.color;else{const t=e.hasOwnProperty("color")?e.color:e.color=new ln;(r!==t._input||"object"==typeof r)&&t.set(t._input=r)}let s=this.orientation||xm;if(s!==e._orientation){let t=n.uTroikaOrient.value;s=s.replace(/[^-+xyz]/g,"");let i=s!==xm&&s.match(/^([-+])([xyz])([-+])([xyz])$/);if(i){let[,e,n,r,s]=i;Tm.set(0,0,0)[n]="-"===e?1:-1,Em.set(0,0,0)[s]="-"===r?-1:1,ym.lookAt(wm,Tm.cross(Em),Em),t.setFromMatrix4(ym)}else t.identity();e._orientation=s}}_parsePercent(e){if("string"==typeof e){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wt;return Tm.copy(e),this.localPositionToTextCoords(this.worldToLocal(Tm),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:i}=this;if(n){const r=n.blockBounds,s=i?Cm():Im(),o=s.geometry,{position:a,uv:l}=o.attributes;for(let e=0;e<l.count;e++){let t=r[0]+l.getX(e)*(r[2]-r[0]);const n=r[1]+l.getY(e)*(r[3]-r[1]);let s=0;i&&(s=i-Math.cos(t/i)*i,t=Math.sin(t/i)*i),a.setXYZ(e,t,n,s)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,s.matrixWorld=this.matrixWorld,s.material.side=this.material.side,Sm.length=0,s.raycast(e,Sm);for(let e=0;e<Sm.length;e++)Sm[e].object=this,t.push(Sm[e])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Lm.forEach((t=>{this[t]=e[t]})),this}clone(){return(new this.constructor).copy(this)}}Am.forEach((e=>{const t="_private_"+e;Object.defineProperty(Om.prototype,e,{get(){return this[t]},set(e){e!==this[t]&&(this[t]=e,this._needsSync=!0)}})}));const Nm=e.forwardRef(((t,n)=>{let{anchorX:i="center",anchorY:r="middle",font:s,fontSize:o=1,children:a,characters:l,onSync:c,...u}=t;const h=yp((e=>{let{invalidate:t}=e;return t})),[d]=e.useState((()=>new Om)),[p,f]=e.useMemo((()=>{const t=[];let n="";return e.Children.forEach(a,(e=>{"string"==typeof e||"number"==typeof e?n+=e:t.push(e)})),[t,n]}),[a]);return Id((()=>new Promise((e=>function(e,t){let{font:n,characters:i,sdfGlyphSize:r}=e;lm({font:n,sdfGlyphSize:r,text:Array.isArray(i)?i.join("\n"):""+i},t)}({font:s,characters:l},e)))),["troika-text",s,l]),e.useLayoutEffect((()=>{d.sync((()=>{h(),c&&c(d)}))})),e.useEffect((()=>()=>d.dispose()),[d]),Ld("primitive",{object:d,ref:n,font:s,text:f,anchorX:i,anchorY:r,fontSize:o,...u,children:p})}));var Dm=9007199254740991,Pm="[object Arguments]",$m="[object Function]",Bm="[object GeneratorFunction]",Fm="[object Symbol]",Um="object"==typeof ud&&ud&&ud.Object===Object&&ud,zm="object"==typeof self&&self&&self.Object===Object&&self,Hm=Um||zm||Function("return this")();function Gm(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}var Vm=Object.prototype,Wm=Vm.hasOwnProperty,jm=Vm.toString,Xm=Hm.Symbol,Ym=Vm.propertyIsEnumerable,Km=Xm?Xm.isConcatSpreadable:void 0,qm=Math.max;function Jm(e,t,n,i,r){var s=-1,o=e.length;for(n||(n=Zm),r||(r=[]);++s<o;){var a=e[s];t>0&&n(a)?t>1?Jm(a,t-1,n,i,r):Gm(r,a):i||(r[r.length]=a)}return r}function Zm(e){return ev(e)||function(e){return function(e){return tv(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Dm}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?jm.call(e):"";return t==$m||t==Bm}(e)}(e)}(e)&&Wm.call(e,"callee")&&(!Ym.call(e,"callee")||jm.call(e)==Pm)}(e)||!!(Km&&e&&e[Km])}function Qm(e){if("string"==typeof e||function(e){return"symbol"==typeof e||tv(e)&&jm.call(e)==Fm}(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}var ev=Array.isArray;function tv(e){return!!e&&"object"==typeof e}var nv=function(e,t){return t=qm(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,r=qm(n.length-t,0),s=Array(r);++i<r;)s[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=s,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}((function(e,t){return null==e?{}:function(e,t){return function(e,t,n){for(var i=-1,r=t.length,s={};++i<r;){var o=t[i],a=e[o];n(a,o)&&(s[o]=a)}return s}(e=Object(e),t,(function(t,n){return n in e}))}(e,function(e,t){for(var n=-1,i=e?e.length:0,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}(Jm(t,1),Qm))})),iv=nv;const rv=e.forwardRef(((t,n)=>{let{makeDefault:i,camera:r,regress:s,domElement:o,enableDamping:a=!0,onChange:l,onStart:c,onEnd:u,...h}=t;const d=yp((e=>e.invalidate)),p=yp((e=>e.camera)),f=yp((e=>e.gl)),g=yp((e=>e.events)),m=yp((e=>e.setEvents)),v=yp((e=>e.set)),_=yp((e=>e.get)),b=yp((e=>e.performance)),y=r||p,T=o||g.connected||f.domElement,E=e.useMemo((()=>new Gf(y)),[y]);return Tp((()=>{E.enabled&&E.update()}),-1),e.useEffect((()=>(E.connect(T),()=>{E.dispose()})),[T,s,E,d]),e.useEffect((()=>{const e=e=>{d(),s&&b.regress(),l&&l(e)},t=e=>{c&&c(e)},n=e=>{u&&u(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}}),[l,c,u,E,d,m]),e.useEffect((()=>{if(i){const e=_().controls;return v({controls:E}),()=>v({controls:e})}}),[i,E]),Ld("primitive",{ref:n,object:E,enableDamping:a,...h})}));class sv extends vl{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:n}=t.capabilities;e.fragmentShader=e.fragmentShader.replace("#include <output_fragment>","\n        ".concat(n?"#include <output_fragment>":"#extension GL_OES_standard_derivatives : enable\n#include <output_fragment>","\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <encodings_fragment>\n      "))}}}const ov=e.forwardRef(((t,n)=>{const[i]=e.useState((()=>new sv(null)));return Ld("primitive",{...t,object:i,ref:n,attach:"material"})}));const av=function(t){const n=t+"Geometry";return e.forwardRef(((e,t)=>{let{args:i,children:r,...s}=e;return Od("mesh",{ref:t,...s,children:[Ld(n,{attach:"geometry",args:i}),r]})}))}("circle");let lv,cv;const uv=e.createContext(null),hv=new Jn,dv=new yn,pv=e.forwardRef(((t,n)=>{let{children:i,range:r,limit:s=1e3,...o}=t;const a=e.useRef(null),[l,c]=e.useState([]),[[u,h,d]]=e.useState((()=>[new Float32Array(3*s),Float32Array.from({length:3*s},(()=>1)),Float32Array.from({length:s},(()=>1))]));e.useEffect((()=>{a.current.geometry.attributes.position.needsUpdate=!0})),Tp((()=>{for(a.current.updateMatrix(),a.current.updateMatrixWorld(),hv.copy(a.current.matrixWorld).invert(),a.current.geometry.drawRange.count=Math.min(s,void 0!==r?r:s,l.length),lv=0;lv<l.length;lv++)cv=l[lv].current,cv.getWorldPosition(dv).applyMatrix4(hv),dv.toArray(u,3*lv),a.current.geometry.attributes.position.needsUpdate=!0,cv.matrixWorldNeedsUpdate=!0,cv.color.toArray(h,3*lv),a.current.geometry.attributes.color.needsUpdate=!0,d.set([cv.size],lv),a.current.geometry.attributes.size.needsUpdate=!0}));const p=e.useMemo((()=>({getParent:()=>a,subscribe:e=>(c((t=>[...t,e])),()=>c((t=>t.filter((t=>t.current!==e.current)))))})),[]);return e.createElement("points",Lp({userData:{instances:l},matrixAutoUpdate:!1,ref:If([n,a]),raycast:()=>null},o),Od("bufferGeometry",{children:[Ld("bufferAttribute",{attach:"attributes-position",count:u.length/3,array:u,itemSize:3,usage:kt}),Ld("bufferAttribute",{attach:"attributes-color",count:h.length/3,array:h,itemSize:3,usage:kt}),Ld("bufferAttribute",{attach:"attributes-size",count:d.length,array:d,itemSize:1,usage:kt})]}),e.createElement(uv.Provider,{value:p},i))})),fv=e.forwardRef(((t,n)=>{let{children:i,positions:r,colors:s,sizes:o,stride:a=3,...l}=t;const c=e.useRef(null);return Tp((()=>{const e=c.current.geometry.attributes;e.position.needsUpdate=!0,s&&(e.color.needsUpdate=!0),o&&(e.size.needsUpdate=!0)})),Od("points",{ref:If([n,c]),...l,children:[Od("bufferGeometry",{children:[Ld("bufferAttribute",{attach:"attributes-position",count:r.length/a,array:r,itemSize:a,usage:kt}),s&&Ld("bufferAttribute",{attach:"attributes-color",count:s.length/a,array:s,itemSize:3,usage:kt}),o&&Ld("bufferAttribute",{attach:"attributes-size",count:o.length/a,array:o,itemSize:1,usage:kt})]}),i]})})),gv=e.forwardRef(((e,t)=>e.positions instanceof Float32Array?Ld(fv,{...e,ref:t}):Ld(pv,{...e,ref:t}))),mv=e=>{let t;const n=new Set,i=(e,i)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=i?i:"object"!=typeof r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!==({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(i,r,s),s};var vv,_v={exports:{}},bv={},yv={exports:{}},Tv={};var Ev,Sv;function wv(){return Ev||(Ev=1,function(t){t.exports=function(){if(vv)return Tv;vv=1;var t=e,n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=t.useState,r=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!n(e,i)}catch{return!0}}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?function(e,t){return t()}:function(e,t){var n=t(),l=i({inst:{value:n,getSnapshot:t}}),c=l[0].inst,u=l[1];return s((function(){c.value=n,c.getSnapshot=t,a(c)&&u({inst:c})}),[e,n,t]),r((function(){return a(c)&&u({inst:c}),e((function(){a(c)&&u({inst:c})}))}),[e]),o(n),n};return Tv.useSyncExternalStore=void 0!==t.useSyncExternalStore?t.useSyncExternalStore:l,Tv}()}(yv)),yv.exports}!function(t){t.exports=function(){if(Sv)return bv;Sv=1;var t=e,n=wv(),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=n.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return bv.useSyncExternalStoreWithSelector=function(e,t,n,c,u){var h=s(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=a((function(){function e(e){if(!o){if(o=!0,r=e,e=c(e),void 0!==u&&d.hasValue){var t=d.value;if(u(t,e))return s=t}return s=e}if(t=s,i(r,e))return t;var n=c(e);return void 0!==u&&u(t,n)?t:(r=e,s=n)}var r,s,o=!1,a=void 0===n?null:n;return[function(){return e(t())},null===a?void 0:function(){return e(a())}]}),[t,n,c,u]);var p=r(e,h[0],h[1]);return o((function(){d.hasValue=!0,d.value=p}),[p]),l(p),p},bv}()}(_v);const xv=hd(_v.exports),{useSyncExternalStoreWithSelector:Mv}=xv;function Iv(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getState,i=arguments.length>2?arguments[2]:void 0;const r=Mv(t.subscribe,t.getState,t.getServerState||t.getState,n,i);return(0,e.useDebugValue)(r),r}const Cv=e=>{"production"!==({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?mv(e):mv)(e):e,n=(e,n)=>Iv(t,e,n);return Object.assign(n,t),n},kv=e=>(t,n,i)=>{const r=i.subscribe;return i.subscribe=(e,t,n)=>{let s=e;if(t){const r=(null==n?void 0:n.equalityFn)||Object.is;let o=e(i.getState());s=n=>{const i=e(n);if(!r(o,i)){const e=o;t(o=i,e)}},null!=n&&n.fireImmediately&&t(o,o)}return r(s)},e(t,n,i)};function Rv(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Av(e){return!!e&&!!e[m_]}function Lv(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===v_}(e)||Array.isArray(e)||!!e[g_]||!!e.constructor[g_]||$v(e)||Bv(e))}function Ov(e,t,n){void 0===n&&(n=!1),0===Nv(e)?(n?Object.keys:__)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function Nv(e){var t=e[m_];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:$v(e)?2:Bv(e)?3:0}function Dv(e,t){return 2===Nv(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Pv(e,t,n){var i=Nv(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function $v(e){return h_&&e instanceof Map}function Bv(e){return d_&&e instanceof Set}function Fv(e){return e.o||e.t}function Uv(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=b_(e);delete t[m_];for(var n=__(t),i=0;i<n.length;i++){var r=n[i],s=t[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function zv(e,t){return void 0===t&&(t=!1),Gv(e)||Av(e)||!Lv(e)||(Nv(e)>1&&(e.set=e.add=e.clear=e.delete=Hv),Object.freeze(e),t&&Ov(e,(function(e,t){return zv(t,!0)}),!0)),e}function Hv(){Rv(2)}function Gv(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Vv(e){var t=y_[e];return t||Rv(18,e),t}function Wv(){return c_}function jv(e,t){t&&(Vv("Patches"),e.u=[],e.s=[],e.v=t)}function Xv(e){Yv(e),e.p.forEach(qv),e.p=null}function Yv(e){e===c_&&(c_=e.l)}function Kv(e){return c_={p:[],l:c_,h:e,m:!0,_:0}}function qv(e){var t=e[m_];0===t.i||1===t.i?t.j():t.O=!0}function Jv(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.g||Vv("ES5").S(t,e,i),i?(n[m_].P&&(Xv(t),Rv(4)),Lv(e)&&(e=Zv(t,e),t.l||e_(t,e)),t.u&&Vv("Patches").M(n[m_].t,e,t.u,t.s)):e=Zv(t,n,[]),Xv(t),t.u&&t.v(t.u,t.s),e!==f_?e:void 0}function Zv(e,t,n){if(Gv(t))return t;var i=t[m_];if(!i)return Ov(t,(function(r,s){return Qv(e,i,t,r,s,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return e_(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=Uv(i.k):i.o;Ov(3===i.i?new Set(r):r,(function(t,s){return Qv(e,i,r,t,s,n)})),e_(e,r,!1),n&&e.u&&Vv("Patches").R(i,n,e.u,e.s)}return i.o}function Qv(e,t,n,i,r,s){if(Av(r)){var o=Zv(e,r,s&&t&&3!==t.i&&!Dv(t.D,i)?s.concat(i):void 0);if(Pv(n,i,o),!Av(o))return;e.m=!1}if(Lv(r)&&!Gv(r)){if(!e.h.F&&e._<1)return;Zv(e,r),t&&t.A.l||e_(e,r)}}function e_(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&zv(t,n)}function t_(e,t){var n=e[m_];return(n?Fv(n):e)[t]}function n_(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function i_(e){e.P||(e.P=!0,e.l&&i_(e.l))}function r_(e){e.o||(e.o=Uv(e.t))}function s_(e,t,n){var i=$v(t)?Vv("MapSet").N(t,n):Bv(t)?Vv("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:Wv(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=i,s=T_;n&&(r=[i],s=E_);var o=Proxy.revocable(r,s),a=o.revoke,l=o.proxy;return i.k=l,i.j=a,l}(t,n):Vv("ES5").J(t,n);return(n?n.A:Wv()).p.push(i),i}function o_(e){return Av(e)||Rv(22,e),function e(t){if(!Lv(t))return t;var n,i=t[m_],r=Nv(t);if(i){if(!i.P&&(i.i<4||!Vv("ES5").K(i)))return i.t;i.I=!0,n=a_(t,r),i.I=!1}else n=a_(t,r);return Ov(n,(function(t,r){i&&function(e,t){return 2===Nv(e)?e.get(t):e[t]}(i.t,t)===r||Pv(n,t,e(r))})),3===r?new Set(n):n}(e)}function a_(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Uv(e)}var l_,c_,u_=typeof Symbol<"u"&&"symbol"==typeof Symbol("x"),h_=typeof Map<"u",d_=typeof Set<"u",p_=typeof Proxy<"u"&&void 0!==Proxy.revocable&&typeof Reflect<"u",f_=u_?Symbol.for("immer-nothing"):((l_={})["immer-nothing"]=!0,l_),g_=u_?Symbol.for("immer-draftable"):"__$immer_draftable",m_=u_?Symbol.for("immer-state"):"__$immer_state",v_=""+Object.prototype.constructor,__=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,b_=Object.getOwnPropertyDescriptors||function(e){var t={};return __(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},y_={},T_={get:function(e,t){if(t===m_)return e;var n=Fv(e);if(!Dv(n,t))return function(e,t,n){var i,r=n_(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!Lv(i)?i:i===t_(e.t,t)?(r_(e),e.o[t]=s_(e.A.h,i,e)):i},has:function(e,t){return t in Fv(e)},ownKeys:function(e){return Reflect.ownKeys(Fv(e))},set:function(e,t,n){var i=n_(Fv(e),t);if(null!=i&&i.set)return i.set.call(e.k,n),!0;if(!e.P){var r=t_(Fv(e),t),s=null==r?void 0:r[m_];if(s&&s.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,r)&&(void 0!==n||Dv(e.t,t)))return!0;r_(e),i_(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==t_(e.t,t)||t in e.t?(e.D[t]=!1,r_(e),i_(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Fv(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i&&{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}},defineProperty:function(){Rv(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Rv(12)}},E_={};Ov(T_,(function(e,t){E_[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),E_.deleteProperty=function(e,t){return E_.set.call(this,e,t,void 0)},E_.set=function(e,t,n){return T_.set.call(this,e[0],t,n,e[0])};var S_=function(){function e(e){var t=this;this.g=p_,this.F=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var r=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return s.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&Rv(6),void 0!==i&&"function"!=typeof i&&Rv(7),Lv(e)){var a=Kv(t),l=s_(t,e,void 0),c=!0;try{o=n(l),c=!1}finally{c?Xv(a):Yv(a)}return typeof Promise<"u"&&o instanceof Promise?o.then((function(e){return jv(a,i),Jv(e,a)}),(function(e){throw Xv(a),e})):(jv(a,i),Jv(o,a))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===f_&&(o=void 0),t.F&&zv(o,!0),i){var u=[],h=[];Vv("Patches").M(e,o,u,h),i(u,h)}return o}Rv(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(r))}))};var i,r,s=t.produce(e,n,(function(e,t){i=e,r=t}));return typeof Promise<"u"&&s instanceof Promise?s.then((function(e){return[e,i,r]})):[s,i,r]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Lv(e)||Rv(8),Av(e)&&(e=o_(e));var t=Kv(this),n=s_(this,e,void 0);return n[m_].C=!0,Yv(t),n},t.finishDraft=function(e,t){var n=(e&&e[m_]).A;return jv(n,t),Jv(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!p_&&Rv(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=Vv("Patches").$;return Av(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}(),w_=new S_,x_=w_.produce;w_.produceWithPatches.bind(w_),w_.setAutoFreeze.bind(w_),w_.setUseProxies.bind(w_),w_.applyPatches.bind(w_),w_.createDraft.bind(w_),w_.finishDraft.bind(w_);const M_=e=>(t,n,i)=>(i.setState=function(e,n){const i="function"==typeof e?x_(e):e;for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];return t(i,n,...s)},e(i.setState,n,i));class I_{constructor(){this._previousTime=0,this._currentTime=0,this._delta=0,this._elapsed=0,this._timescale=1,this._useFixedDelta=!1,this._fixedDelta=16.67,this._usePageVisibilityAPI=typeof document<"u"&&void 0!==document.hidden,!0===this._usePageVisibilityAPI&&(this._pageVisibilityHandler=C_.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disableFixedDelta(){return this._useFixedDelta=!1,this}dispose(){return!0===this._usePageVisibilityAPI&&document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this}enableFixedDelta(){return this._useFixedDelta=!0,this}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getFixedDelta(){return this._fixedDelta/1e3}getTimescale(){return this._timescale}reset(){return this._currentTime=this._now(),this}setFixedDelta(e){return this._fixedDelta=1e3*e,this}setTimescale(e){return this._timescale=e,this}update(){return!0===this._useFixedDelta?this._delta=this._fixedDelta:(this._previousTime=this._currentTime,this._currentTime=this._now(),this._delta=this._currentTime-this._previousTime),this._delta*=this._timescale,this._elapsed+=this._delta,this}_now(){return(typeof performance>"u"?Date:performance).now()}}function C_(){!1===document.hidden&&this.reset()}var k_={exports:{}};!function(e,t){(function(){var n,i="Expected a function",r="__lodash_hash_undefined__",s="__lodash_placeholder__",o=16,a=32,l=64,c=128,u=256,h=1/0,d=9007199254740991,p=NaN,f=4294967295,g=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",o],["flip",512],["partial",a],["partialRight",l],["rearg",u]],m="[object Arguments]",v="[object Array]",_="[object Boolean]",b="[object Date]",y="[object Error]",T="[object Function]",E="[object GeneratorFunction]",S="[object Map]",w="[object Number]",x="[object Object]",M="[object Promise]",I="[object RegExp]",C="[object Set]",k="[object String]",R="[object Symbol]",A="[object WeakMap]",L="[object ArrayBuffer]",O="[object DataView]",N="[object Float32Array]",D="[object Float64Array]",P="[object Int8Array]",$="[object Int16Array]",B="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",G=/\b__p \+= '';/g,V=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,X=/[&<>"']/g,Y=RegExp(j.source),K=RegExp(X.source),q=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(ne.source),re=/^\s+/,se=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,he=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ye=/($^)/,Te=/['\n\r\u2028\u2029\\]/g,Ee="\\ud800-\\udfff",Se="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",xe="a-z\\xdf-\\xf6\\xf8-\\xff",Me="A-Z\\xc0-\\xd6\\xd8-\\xde",Ie="\\ufe0e\\ufe0f",Ce="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ke="['\u2019]",Re="["+Ee+"]",Ae="["+Ce+"]",Le="["+Se+"]",Oe="\\d+",Ne="["+we+"]",De="["+xe+"]",Pe="[^"+Ee+Ce+Oe+we+xe+Me+"]",$e="\\ud83c[\\udffb-\\udfff]",Be="[^"+Ee+"]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ue="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+Me+"]",He="\\u200d",Ge="(?:"+De+"|"+Pe+")",Ve="(?:"+ze+"|"+Pe+")",We="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",je="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Xe="(?:"+Le+"|"+$e+")"+"?",Ye="["+Ie+"]?",Ke=Ye+Xe+("(?:"+He+"(?:"+[Be,Fe,Ue].join("|")+")"+Ye+Xe+")*"),qe="(?:"+[Ne,Fe,Ue].join("|")+")"+Ke,Je="(?:"+[Be+Le+"?",Le,Fe,Ue,Re].join("|")+")",Ze=RegExp(ke,"g"),Qe=RegExp(Le,"g"),et=RegExp($e+"(?="+$e+")|"+Je+Ke,"g"),tt=RegExp([ze+"?"+De+"+"+We+"(?="+[Ae,ze,"$"].join("|")+")",Ve+"+"+je+"(?="+[Ae,ze+Ge,"$"].join("|")+")",ze+"?"+Ge+"+"+We,ze+"+"+je,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oe,qe].join("|"),"g"),nt=RegExp("["+He+Ee+Se+Ie+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],st=-1,ot={};ot[N]=ot[D]=ot[P]=ot[$]=ot[B]=ot[F]=ot[U]=ot[z]=ot[H]=!0,ot[m]=ot[v]=ot[L]=ot[_]=ot[O]=ot[b]=ot[y]=ot[T]=ot[S]=ot[w]=ot[x]=ot[I]=ot[C]=ot[k]=ot[A]=!1;var at={};at[m]=at[v]=at[L]=at[O]=at[_]=at[b]=at[N]=at[D]=at[P]=at[$]=at[B]=at[S]=at[w]=at[x]=at[I]=at[C]=at[k]=at[R]=at[F]=at[U]=at[z]=at[H]=!0,at[y]=at[T]=at[A]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,ut=parseInt,ht="object"==typeof ud&&ud&&ud.Object===Object&&ud,dt="object"==typeof self&&self&&self.Object===Object&&self,pt=ht||dt||Function("return this")(),ft=t&&!t.nodeType&&t,gt=ft&&e&&!e.nodeType&&e,mt=gt&&gt.exports===ft,vt=mt&&ht.process,_t=function(){try{return gt&&gt.require&&gt.require("util").types||vt&&vt.binding&&vt.binding("util")}catch{}}(),bt=_t&&_t.isArrayBuffer,yt=_t&&_t.isDate,Tt=_t&&_t.isMap,Et=_t&&_t.isRegExp,St=_t&&_t.isSet,wt=_t&&_t.isTypedArray;function xt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Mt(e,t,n,i){for(var r=-1,s=null==e?0:e.length;++r<s;){var o=e[r];t(i,o,n(o),e)}return i}function It(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function Ct(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Rt(e,t){for(var n=-1,i=null==e?0:e.length,r=0,s=[];++n<i;){var o=e[n];t(o,n,e)&&(s[r++]=o)}return s}function At(e,t){return!!(null==e?0:e.length)&&zt(e,t,0)>-1}function Lt(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function Ot(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function Nt(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function Dt(e,t,n,i){var r=-1,s=null==e?0:e.length;for(i&&s&&(n=e[++r]);++r<s;)n=t(n,e[r],r,e);return n}function Pt(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function $t(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Bt=Wt("length");function Ft(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}function Ut(e,t,n,i){for(var r=e.length,s=n+(i?1:-1);i?s--:++s<r;)if(t(e[s],s,e))return s;return-1}function zt(e,t,n){return t===t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):Ut(e,Gt,n)}function Ht(e,t,n,i){for(var r=n-1,s=e.length;++r<s;)if(i(e[r],t))return r;return-1}function Gt(e){return e!==e}function Vt(e,t){var n=null==e?0:e.length;return n?Yt(e,t)/n:p}function Wt(e){return function(t){return null==t?n:t[e]}}function jt(e){return function(t){return null==e?n:e[t]}}function Xt(e,t,n,i,r){return r(e,(function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)})),n}function Yt(e,t){for(var i,r=-1,s=e.length;++r<s;){var o=t(e[r]);o!==n&&(i=i===n?o:i+o)}return i}function Kt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function qt(e){return e&&e.slice(0,pn(e)+1).replace(re,"")}function Jt(e){return function(t){return e(t)}}function Zt(e,t){return Ot(t,(function(t){return e[t]}))}function Qt(e,t){return e.has(t)}function en(e,t){for(var n=-1,i=e.length;++n<i&&zt(t,e[n],0)>-1;);return n}function tn(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}var nn=jt({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),rn=jt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(e){return"\\"+lt[e]}function on(e){return nt.test(e)}function an(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n];(a===t||a===s)&&(e[n]=s,o[r++]=n)}return o}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function hn(e){return on(e)?function(e){for(var t=et.lastIndex=0;et.test(e);)++t;return t}(e):Bt(e)}function dn(e){return on(e)?function(e){return e.match(et)||[]}(e):function(e){return e.split("")}(e)}function pn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var fn=jt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gn=function e(t){var se=(t=null==t?pt:gn.defaults(pt.Object(),t,gn.pick(pt,rt))).Array,Ee=t.Date,Se=t.Error,we=t.Function,xe=t.Math,Me=t.Object,Ie=t.RegExp,Ce=t.String,ke=t.TypeError,Re=se.prototype,Ae=we.prototype,Le=Me.prototype,Oe=t["__core-js_shared__"],Ne=Ae.toString,De=Le.hasOwnProperty,Pe=0,$e=function(){var e=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Be=Le.toString,Fe=Ne.call(Me),Ue=pt._,ze=Ie("^"+Ne.call(De).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=mt?t.Buffer:n,Ge=t.Symbol,Ve=t.Uint8Array,We=He?He.allocUnsafe:n,je=ln(Me.getPrototypeOf,Me),Xe=Me.create,Ye=Le.propertyIsEnumerable,Ke=Re.splice,qe=Ge?Ge.isConcatSpreadable:n,Je=Ge?Ge.iterator:n,et=Ge?Ge.toStringTag:n,nt=function(){try{var e=us(Me,"defineProperty");return e({},"",{}),e}catch{}}(),lt=t.clearTimeout!==pt.clearTimeout&&t.clearTimeout,ht=Ee&&Ee.now!==pt.Date.now&&Ee.now,dt=t.setTimeout!==pt.setTimeout&&t.setTimeout,ft=xe.ceil,gt=xe.floor,vt=Me.getOwnPropertySymbols,_t=He?He.isBuffer:n,Bt=t.isFinite,jt=Re.join,mn=ln(Me.keys,Me),vn=xe.max,_n=xe.min,bn=Ee.now,yn=t.parseInt,Tn=xe.random,En=Re.reverse,Sn=us(t,"DataView"),wn=us(t,"Map"),xn=us(t,"Promise"),Mn=us(t,"Set"),In=us(t,"WeakMap"),Cn=us(Me,"create"),kn=In&&new In,Rn={},An=Ps(Sn),Ln=Ps(wn),On=Ps(xn),Nn=Ps(Mn),Dn=Ps(In),Pn=Ge?Ge.prototype:n,$n=Pn?Pn.valueOf:n,Bn=Pn?Pn.toString:n;function Fn(e){if(ea(e)&&!Go(e)&&!(e instanceof Gn)){if(e instanceof Hn)return e;if(De.call(e,"__wrapped__"))return $s(e)}return new Hn(e)}var Un=function(){function e(){}return function(t){if(!Qo(t))return{};if(Xe)return Xe(t);e.prototype=t;var i=new e;return e.prototype=n,i}}();function zn(){}function Hn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function Gn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new jn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Wn(e);this.size=t.size}function Kn(e,t){var n=Go(e),i=!n&&Ho(e),r=!n&&!i&&Xo(e),s=!n&&!i&&!r&&la(e),o=n||i||r||s,a=o?Kt(e.length,Ce):[],l=a.length;for(var c in e)(t||De.call(e,c))&&(!o||!("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||vs(c,l)))&&a.push(c);return a}function qn(e){var t=e.length;return t?e[Xi(0,t-1)]:n}function Jn(e,t){return Os(Cr(e),oi(t,0,e.length))}function Zn(e){return Os(Cr(e))}function Qn(e,t,i){(i!==n&&!Fo(e[t],i)||i===n&&!(t in e))&&ri(e,t,i)}function ei(e,t,i){var r=e[t];(!De.call(e,t)||!Fo(r,i)||i===n&&!(t in e))&&ri(e,t,i)}function ti(e,t){for(var n=e.length;n--;)if(Fo(e[n][0],t))return n;return-1}function ni(e,t,n,i){return hi(e,(function(e,r,s){t(i,e,n(e),s)})),i}function ii(e,t){return e&&kr(t,Ra(t),e)}function ri(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function si(e,t){for(var i=-1,r=t.length,s=se(r),o=null==e;++i<r;)s[i]=o?n:xa(e,t[i]);return s}function oi(e,t,i){return e===e&&(i!==n&&(e=e<=i?e:i),t!==n&&(e=e>=t?e:t)),e}function ai(e,t,i,r,s,o){var a,l=1&t,c=2&t,u=4&t;if(i&&(a=s?i(e,r,s,o):i(e)),a!==n)return a;if(!Qo(e))return e;var h=Go(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&De.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Cr(e,a)}else{var d=ps(e),p=d==T||d==E;if(Xo(e))return Er(e,l);if(d==x||d==m||p&&!s){if(a=c||p?{}:gs(e),!l)return c?function(e,t){return kr(e,ds(e),t)}(e,function(e,t){return e&&kr(t,Aa(t),e)}(a,e)):function(e,t){return kr(e,hs(e),t)}(e,ii(a,e))}else{if(!at[d])return s?e:{};a=function(e,t,n){var i=e.constructor;switch(t){case L:return Sr(e);case _:case b:return new i(+e);case O:return function(e,t){var n=t?Sr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case N:case D:case P:case $:case B:case F:case U:case z:case H:return wr(e,n);case S:return new i;case w:case k:return new i(e);case I:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case C:return new i;case R:return function(e){return $n?Me($n.call(e)):{}}(e)}}(e,d,l)}}o||(o=new Yn);var f=o.get(e);if(f)return f;o.set(e,a),sa(e)?e.forEach((function(n){a.add(ai(n,t,i,n,e,o))})):ta(e)&&e.forEach((function(n,r){a.set(r,ai(n,t,i,r,e,o))}));var g=h?n:(u?c?is:ns:c?Aa:Ra)(e);return It(g||e,(function(n,r){g&&(n=e[r=n]),ei(a,r,ai(n,t,i,r,e,o))})),a}function li(e,t,i){var r=i.length;if(null==e)return!r;for(e=Me(e);r--;){var s=i[r],o=t[s],a=e[s];if(a===n&&!(s in e)||!o(a))return!1}return!0}function ci(e,t,r){if("function"!=typeof e)throw new ke(i);return ks((function(){e.apply(n,r)}),t)}function ui(e,t,n,i){var r=-1,s=At,o=!0,a=e.length,l=[],c=t.length;if(!a)return l;n&&(t=Ot(t,Jt(n))),i?(s=Lt,o=!1):t.length>=200&&(s=Qt,o=!1,t=new Xn(t));e:for(;++r<a;){var u=e[r],h=null==n?u:n(u);if(u=i||0!==u?u:0,o&&h===h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else s(t,h,i)||l.push(u)}return l}Fn.templateSettings={escape:q,evaluate:J,interpolate:Z,variable:"",imports:{_:Fn}},Fn.prototype=zn.prototype,Fn.prototype.constructor=Fn,Hn.prototype=Un(zn.prototype),Hn.prototype.constructor=Hn,Gn.prototype=Un(zn.prototype),Gn.prototype.constructor=Gn,Vn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},Vn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vn.prototype.get=function(e){var t=this.__data__;if(Cn){var i=t[e];return i===r?n:i}return De.call(t,e)?t[e]:n},Vn.prototype.has=function(e){var t=this.__data__;return Cn?t[e]!==n:De.call(t,e)},Vn.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Cn&&t===n?r:t,this},Wn.prototype.clear=function(){this.__data__=[],this.size=0},Wn.prototype.delete=function(e){var t=this.__data__,n=ti(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ke.call(t,n,1),--this.size,!0)},Wn.prototype.get=function(e){var t=this.__data__,i=ti(t,e);return i<0?n:t[i][1]},Wn.prototype.has=function(e){return ti(this.__data__,e)>-1},Wn.prototype.set=function(e,t){var n=this.__data__,i=ti(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},jn.prototype.clear=function(){this.size=0,this.__data__={hash:new Vn,map:new(wn||Wn),string:new Vn}},jn.prototype.delete=function(e){var t=ls(this,e).delete(e);return this.size-=t?1:0,t},jn.prototype.get=function(e){return ls(this,e).get(e)},jn.prototype.has=function(e){return ls(this,e).has(e)},jn.prototype.set=function(e,t){var n=ls(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Xn.prototype.add=Xn.prototype.push=function(e){return this.__data__.set(e,r),this},Xn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Wn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Wn){var i=n.__data__;if(!wn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new jn(i)}return n.set(e,t),this.size=n.size,this};var hi=Lr(bi),di=Lr(yi,!0);function pi(e,t){var n=!0;return hi(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function fi(e,t,i){for(var r=-1,s=e.length;++r<s;){var o=e[r],a=t(o);if(null!=a&&(l===n?a===a&&!aa(a):i(a,l)))var l=a,c=o}return c}function gi(e,t){var n=[];return hi(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function mi(e,t,n,i,r){var s=-1,o=e.length;for(n||(n=ms),r||(r=[]);++s<o;){var a=e[s];t>0&&n(a)?t>1?mi(a,t-1,n,i,r):Nt(r,a):i||(r[r.length]=a)}return r}var vi=Or(),_i=Or(!0);function bi(e,t){return e&&vi(e,t,Ra)}function yi(e,t){return e&&_i(e,t,Ra)}function Ti(e,t){return Rt(t,(function(t){return qo(e[t])}))}function Ei(e,t){for(var i=0,r=(t=_r(t,e)).length;null!=e&&i<r;)e=e[Ds(t[i++])];return i&&i==r?e:n}function Si(e,t,n){var i=t(e);return Go(e)?i:Nt(i,n(e))}function wi(e){return null==e?e===n?"[object Undefined]":"[object Null]":et&&et in Me(e)?function(e){var t=De.call(e,et),i=e[et];try{e[et]=n;var r=!0}catch{}var s=Be.call(e);return r&&(t?e[et]=i:delete e[et]),s}(e):function(e){return Be.call(e)}(e)}function xi(e,t){return e>t}function Mi(e,t){return null!=e&&De.call(e,t)}function Ii(e,t){return null!=e&&t in Me(e)}function Ci(e,t,i){for(var r=i?Lt:At,s=e[0].length,o=e.length,a=o,l=se(o),c=1/0,u=[];a--;){var h=e[a];a&&t&&(h=Ot(h,Jt(t))),c=_n(h.length,c),l[a]=!i&&(t||s>=120&&h.length>=120)?new Xn(a&&h):n}h=e[0];var d=-1,p=l[0];e:for(;++d<s&&u.length<c;){var f=h[d],g=t?t(f):f;if(f=i||0!==f?f:0,!(p?Qt(p,g):r(u,g,i))){for(a=o;--a;){var m=l[a];if(!(m?Qt(m,g):r(e[a],g,i)))continue e}p&&p.push(g),u.push(f)}}return u}function ki(e,t,i){var r=null==(e=Ms(e,t=_r(t,e)))?e:e[Ds(Ys(t))];return null==r?n:xt(r,e,i)}function Ri(e){return ea(e)&&wi(e)==m}function Ai(e,t,i,r,s){return e===t||(null==e||null==t||!ea(e)&&!ea(t)?e!==e&&t!==t:function(e,t,i,r,s,o){var a=Go(e),l=Go(t),c=a?v:ps(e),u=l?v:ps(t),h=(c=c==m?x:c)==x,d=(u=u==m?x:u)==x,p=c==u;if(p&&Xo(e)){if(!Xo(t))return!1;a=!0,h=!1}if(p&&!h)return o||(o=new Yn),a||la(e)?es(e,t,i,r,s,o):function(e,t,n,i,r,s,o){switch(n){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case L:return!(e.byteLength!=t.byteLength||!s(new Ve(e),new Ve(t)));case _:case b:case w:return Fo(+e,+t);case y:return e.name==t.name&&e.message==t.message;case I:case k:return e==t+"";case S:var a=an;case C:var l=1&i;if(a||(a=un),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=2,o.set(e,t);var u=es(a(e),a(t),i,r,s,o);return o.delete(e),u;case R:if($n)return $n.call(e)==$n.call(t)}return!1}(e,t,c,i,r,s,o);if(!(1&i)){var f=h&&De.call(e,"__wrapped__"),g=d&&De.call(t,"__wrapped__");if(f||g){var T=f?e.value():e,E=g?t.value():t;return o||(o=new Yn),s(T,E,i,r,o)}}return!!p&&(o||(o=new Yn),function(e,t,i,r,s,o){var a=1&i,l=ns(e),c=l.length,u=ns(t),h=u.length;if(c!=h&&!a)return!1;for(var d=c;d--;){var p=l[d];if(!(a?p in t:De.call(t,p)))return!1}var f=o.get(e),g=o.get(t);if(f&&g)return f==t&&g==e;var m=!0;o.set(e,t),o.set(t,e);for(var v=a;++d<c;){var _=e[p=l[d]],b=t[p];if(r)var y=a?r(b,_,p,t,e,o):r(_,b,p,e,t,o);if(!(y===n?_===b||s(_,b,i,r,o):y)){m=!1;break}v||(v="constructor"==p)}if(m&&!v){var T=e.constructor,E=t.constructor;T!=E&&"constructor"in e&&"constructor"in t&&!("function"==typeof T&&T instanceof T&&"function"==typeof E&&E instanceof E)&&(m=!1)}return o.delete(e),o.delete(t),m}(e,t,i,r,s,o))}(e,t,i,r,Ai,s))}function Li(e,t,i,r){var s=i.length,o=s,a=!r;if(null==e)return!o;for(e=Me(e);s--;){var l=i[s];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<o;){var c=(l=i[s])[0],u=e[c],h=l[1];if(a&&l[2]){if(u===n&&!(c in e))return!1}else{var d=new Yn;if(r)var p=r(u,h,c,e,t,d);if(!(p===n?Ai(h,u,3,r,d):p))return!1}}return!0}function Oi(e){return!(!Qo(e)||function(e){return!!$e&&$e in e}(e))&&(qo(e)?ze:me).test(Ps(e))}function Ni(e){return"function"==typeof e?e:null==e?nl:"object"==typeof e?Go(e)?Ui(e[0],e[1]):Fi(e):hl(e)}function Di(e){if(!Es(e))return mn(e);var t=[];for(var n in Me(e))De.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Pi(e){if(!Qo(e))return function(e){var t=[];if(null!=e)for(var n in Me(e))t.push(n);return t}(e);var t=Es(e),n=[];for(var i in e)"constructor"==i&&(t||!De.call(e,i))||n.push(i);return n}function $i(e,t){return e<t}function Bi(e,t){var n=-1,i=Wo(e)?se(e.length):[];return hi(e,(function(e,r,s){i[++n]=t(e,r,s)})),i}function Fi(e){var t=cs(e);return 1==t.length&&t[0][2]?ws(t[0][0],t[0][1]):function(n){return n===e||Li(n,e,t)}}function Ui(e,t){return bs(e)&&Ss(t)?ws(Ds(e),t):function(i){var r=xa(i,e);return r===n&&r===t?Ma(i,e):Ai(t,r,3)}}function zi(e,t,i,r,s){e!==t&&vi(t,(function(o,a){if(s||(s=new Yn),Qo(o))!function(e,t,i,r,s,o,a){var l=Is(e,i),c=Is(t,i),u=a.get(c);if(u)return void Qn(e,i,u);var h=o?o(l,c,i+"",e,t,a):n,d=h===n;if(d){var p=Go(c),f=!p&&Xo(c),g=!p&&!f&&la(c);h=c,p||f||g?Go(l)?h=l:jo(l)?h=Cr(l):f?(d=!1,h=Er(c,!0)):g?(d=!1,h=wr(c,!0)):h=[]:ia(c)||Ho(c)?(h=l,Ho(l)?h=ma(l):(!Qo(l)||qo(l))&&(h=gs(c))):d=!1}d&&(a.set(c,h),s(h,c,r,o,a),a.delete(c)),Qn(e,i,h)}(e,t,a,i,zi,r,s);else{var l=r?r(Is(e,a),o,a+"",e,t,s):n;l===n&&(l=o),Qn(e,a,l)}}),Aa)}function Hi(e,t){var i=e.length;if(i)return vs(t+=t<0?i:0,i)?e[t]:n}function Gi(e,t,n){t=t.length?Ot(t,(function(e){return Go(e)?function(t){return Ei(t,1===e.length?e[0]:e)}:e})):[nl];var i=-1;return t=Ot(t,Jt(as())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Bi(e,(function(e,n,r){return{criteria:Ot(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,s=t.criteria,o=r.length,a=n.length;++i<o;){var l=xr(r[i],s[i]);if(l)return i>=a?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function Vi(e,t,n){for(var i=-1,r=t.length,s={};++i<r;){var o=t[i],a=Ei(e,o);n(a,o)&&Zi(s,_r(o,e),a)}return s}function Wi(e,t,n,i){var r=i?Ht:zt,s=-1,o=t.length,a=e;for(e===t&&(t=Cr(t)),n&&(a=Ot(e,Jt(n)));++s<o;)for(var l=0,c=t[s],u=n?n(c):c;(l=r(a,u,l,i))>-1;)a!==e&&Ke.call(a,l,1),Ke.call(e,l,1);return e}function ji(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==s){var s=r;vs(r)?Ke.call(e,r,1):ur(e,r)}}return e}function Xi(e,t){return e+gt(Tn()*(t-e+1))}function Yi(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=gt(t/2))&&(e+=e)}while(t);return n}function Ki(e,t){return Rs(xs(e,t,nl),e+"")}function qi(e){return qn(Fa(e))}function Ji(e,t){var n=Fa(e);return Os(n,oi(t,0,n.length))}function Zi(e,t,i,r){if(!Qo(e))return e;for(var s=-1,o=(t=_r(t,e)).length,a=o-1,l=e;null!=l&&++s<o;){var c=Ds(t[s]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(s!=a){var h=l[c];(u=r?r(h,c,l):n)===n&&(u=Qo(h)?h:vs(t[s+1])?[]:{})}ei(l,c,u),l=l[c]}return e}var Qi=kn?function(e,t){return kn.set(e,t),e}:nl,er=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:Qa(t),writable:!0})}:nl;function tr(e){return Os(Fa(e))}function nr(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var s=se(r);++i<r;)s[i]=e[i+t];return s}function ir(e,t){var n;return hi(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}function rr(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t===t&&r<=2147483647){for(;i<r;){var s=i+r>>>1,o=e[s];null!==o&&!aa(o)&&(n?o<=t:o<t)?i=s+1:r=s}return r}return sr(e,t,nl,n)}function sr(e,t,i,r){var s=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=i(t))!==t,l=null===t,c=aa(t),u=t===n;s<o;){var h=gt((s+o)/2),d=i(e[h]),p=d!==n,f=null===d,g=d===d,m=aa(d);if(a)var v=r||g;else v=u?g&&(r||p):l?g&&p&&(r||!f):c?g&&p&&!f&&(r||!m):!f&&!m&&(r?d<=t:d<t);v?s=h+1:o=h}return _n(o,4294967294)}function or(e,t){for(var n=-1,i=e.length,r=0,s=[];++n<i;){var o=e[n],a=t?t(o):o;if(!n||!Fo(a,l)){var l=a;s[r++]=0===o?0:o}}return s}function ar(e){return"number"==typeof e?e:aa(e)?p:+e}function lr(e){if("string"==typeof e)return e;if(Go(e))return Ot(e,lr)+"";if(aa(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-h?"-0":t}function cr(e,t,n){var i=-1,r=At,s=e.length,o=!0,a=[],l=a;if(n)o=!1,r=Lt;else if(s>=200){var c=t?null:Yr(e);if(c)return un(c);o=!1,r=Qt,l=new Xn}else l=t?[]:a;e:for(;++i<s;){var u=e[i],h=t?t(u):u;if(u=n||0!==u?u:0,o&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else r(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}function ur(e,t){return null==(e=Ms(e,t=_r(t,e)))||delete e[Ds(Ys(t))]}function hr(e,t,n,i){return Zi(e,t,n(Ei(e,t)),i)}function dr(e,t,n,i){for(var r=e.length,s=i?r:-1;(i?s--:++s<r)&&t(e[s],s,e););return n?nr(e,i?0:s,i?s+1:r):nr(e,i?s+1:0,i?r:s)}function pr(e,t){var n=e;return n instanceof Gn&&(n=n.value()),Dt(t,(function(e,t){return t.func.apply(t.thisArg,Nt([e],t.args))}),n)}function fr(e,t,n){var i=e.length;if(i<2)return i?cr(e[0]):[];for(var r=-1,s=se(i);++r<i;)for(var o=e[r],a=-1;++a<i;)a!=r&&(s[r]=ui(s[r]||o,e[a],t,n));return cr(mi(s,1),t,n)}function gr(e,t,i){for(var r=-1,s=e.length,o=t.length,a={};++r<s;){var l=r<o?t[r]:n;i(a,e[r],l)}return a}function mr(e){return jo(e)?e:[]}function vr(e){return"function"==typeof e?e:nl}function _r(e,t){return Go(e)?e:bs(e,t)?[e]:Ns(va(e))}var br=Ki;function yr(e,t,i){var r=e.length;return i=i===n?r:i,!t&&i>=r?e:nr(e,t,i)}var Tr=lt||function(e){return pt.clearTimeout(e)};function Er(e,t){if(t)return e.slice();var n=e.length,i=We?We(n):new e.constructor(n);return e.copy(i),i}function Sr(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function wr(e,t){var n=t?Sr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function xr(e,t){if(e!==t){var i=e!==n,r=null===e,s=e===e,o=aa(e),a=t!==n,l=null===t,c=t===t,u=aa(t);if(!l&&!u&&!o&&e>t||o&&a&&c&&!l&&!u||r&&a&&c||!i&&c||!s)return 1;if(!r&&!o&&!u&&e<t||u&&i&&s&&!r&&!o||l&&i&&s||!a&&s||!c)return-1}return 0}function Mr(e,t,n,i){for(var r=-1,s=e.length,o=n.length,a=-1,l=t.length,c=vn(s-o,0),u=se(l+c),h=!i;++a<l;)u[a]=t[a];for(;++r<o;)(h||r<s)&&(u[n[r]]=e[r]);for(;c--;)u[a++]=e[r++];return u}function Ir(e,t,n,i){for(var r=-1,s=e.length,o=-1,a=n.length,l=-1,c=t.length,u=vn(s-a,0),h=se(u+c),d=!i;++r<u;)h[r]=e[r];for(var p=r;++l<c;)h[p+l]=t[l];for(;++o<a;)(d||r<s)&&(h[p+n[o]]=e[r++]);return h}function Cr(e,t){var n=-1,i=e.length;for(t||(t=se(i));++n<i;)t[n]=e[n];return t}function kr(e,t,i,r){var s=!i;i||(i={});for(var o=-1,a=t.length;++o<a;){var l=t[o],c=r?r(i[l],e[l],l,i,e):n;c===n&&(c=e[l]),s?ri(i,l,c):ei(i,l,c)}return i}function Rr(e,t){return function(n,i){var r=Go(n)?Mt:ni,s=t?t():{};return r(n,e,as(i,2),s)}}function Ar(e){return Ki((function(t,i){var r=-1,s=i.length,o=s>1?i[s-1]:n,a=s>2?i[2]:n;for(o=e.length>3&&"function"==typeof o?(s--,o):n,a&&_s(i[0],i[1],a)&&(o=s<3?n:o,s=1),t=Me(t);++r<s;){var l=i[r];l&&e(t,l,r,o)}return t}))}function Lr(e,t){return function(n,i){if(null==n)return n;if(!Wo(n))return e(n,i);for(var r=n.length,s=t?r:-1,o=Me(n);(t?s--:++s<r)&&!1!==i(o[s],s,o););return n}}function Or(e){return function(t,n,i){for(var r=-1,s=Me(t),o=i(t),a=o.length;a--;){var l=o[e?a:++r];if(!1===n(s[l],l,s))break}return t}}function Nr(e){return function(t){var i=on(t=va(t))?dn(t):n,r=i?i[0]:t.charAt(0),s=i?yr(i,1).join(""):t.slice(1);return r[e]()+s}}function Dr(e){return function(t){return Dt(qa(Ha(t).replace(Ze,"")),e,"")}}function Pr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Un(e.prototype),i=e.apply(n,t);return Qo(i)?i:n}}function $r(e){return function(t,i,r){var s=Me(t);if(!Wo(t)){var o=as(i,3);t=Ra(t),i=function(e){return o(s[e],e,s)}}var a=e(t,i,r);return a>-1?s[o?t[a]:a]:n}}function Br(e){return ts((function(t){var r=t.length,s=r,o=Hn.prototype.thru;for(e&&t.reverse();s--;){var a=t[s];if("function"!=typeof a)throw new ke(i);if(o&&!l&&"wrapper"==ss(a))var l=new Hn([],!0)}for(s=l?s:r;++s<r;){var c=ss(a=t[s]),u="wrapper"==c?rs(a):n;l=u&&ys(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ss(u[0])].apply(l,u[3]):1==a.length&&ys(a)?l[c]():l.thru(a)}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&Go(n))return l.plant(n).value();for(var i=0,s=r?t[i].apply(this,e):n;++i<r;)s=t[i].call(this,s);return s}}))}function Fr(e,t,i,r,s,o,a,l,u,h){var d=t&c,p=1&t,f=2&t,g=24&t,m=512&t,v=f?n:Pr(e);return function c(){for(var _=arguments.length,b=se(_),y=_;y--;)b[y]=arguments[y];if(g)var T=os(c),E=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(b,T);if(r&&(b=Mr(b,r,s,g)),o&&(b=Ir(b,o,a,g)),_-=E,g&&_<h){var S=cn(b,T);return jr(e,t,Fr,c.placeholder,i,b,S,l,u,h-_)}var w=p?i:this,x=f?w[e]:e;return _=b.length,l?b=function(e,t){for(var i=e.length,r=_n(t.length,i),s=Cr(e);r--;){var o=t[r];e[r]=vs(o,i)?s[o]:n}return e}(b,l):m&&_>1&&b.reverse(),d&&u<_&&(b.length=u),this&&this!==pt&&this instanceof c&&(x=v||Pr(x)),x.apply(w,b)}}function Ur(e,t){return function(n,i){return function(e,t,n,i){return bi(e,(function(e,r,s){t(i,n(e),r,s)})),i}(n,e,t(i),{})}}function zr(e,t){return function(i,r){var s;if(i===n&&r===n)return t;if(i!==n&&(s=i),r!==n){if(s===n)return r;"string"==typeof i||"string"==typeof r?(i=lr(i),r=lr(r)):(i=ar(i),r=ar(r)),s=e(i,r)}return s}}function Hr(e){return ts((function(t){return t=Ot(t,Jt(as())),Ki((function(n){var i=this;return e(t,(function(e){return xt(e,i,n)}))}))}))}function Gr(e,t){var i=(t=t===n?" ":lr(t)).length;if(i<2)return i?Yi(t,e):t;var r=Yi(t,ft(e/hn(t)));return on(t)?yr(dn(r),0,e).join(""):r.slice(0,e)}function Vr(e){return function(t,i,r){return r&&"number"!=typeof r&&_s(t,i,r)&&(i=r=n),t=da(t),i===n?(i=t,t=0):i=da(i),function(e,t,n,i){for(var r=-1,s=vn(ft((t-e)/(n||1)),0),o=se(s);s--;)o[i?s:++r]=e,e+=n;return o}(t,i,r=r===n?t<i?1:-1:da(r),e)}}function Wr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ga(t),n=ga(n)),e(t,n)}}function jr(e,t,i,r,s,o,c,u,h,d){var p=8&t;t|=p?a:l,4&(t&=~(p?l:a))||(t&=-4);var f=[e,t,s,p?o:n,p?c:n,p?n:o,p?n:c,u,h,d],g=i.apply(n,f);return ys(e)&&Cs(g,f),g.placeholder=r,As(g,e,t)}function Xr(e){var t=xe[e];return function(e,n){if(e=ga(e),(n=null==n?0:_n(pa(n),292))&&Bt(e)){var i=(va(e)+"e").split("e");return+((i=(va(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var Yr=Mn&&1/un(new Mn([,-0]))[1]==h?function(e){return new Mn(e)}:al;function Kr(e){return function(t){var n=ps(t);return n==S?an(t):n==C?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Ot(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function qr(e,t,r,h,d,p,f,g){var m=2&t;if(!m&&"function"!=typeof e)throw new ke(i);var v=h?h.length:0;if(v||(t&=-97,h=d=n),f=f===n?f:vn(pa(f),0),g=g===n?g:pa(g),v-=d?d.length:0,t&l){var _=h,b=d;h=d=n}var y=m?n:rs(e),T=[e,t,r,h,d,_,b,p,f,g];if(y&&function(e,t){var n=e[1],i=t[1],r=n|i,o=r<131,a=i==c&&8==n||i==c&&n==u&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&i&&(e[2]=t[2],r|=1&n?0:4);var l=t[3];if(l){var h=e[3];e[3]=h?Mr(h,l,t[4]):l,e[4]=h?cn(e[3],s):t[4]}l=t[5],l&&(h=e[5],e[5]=h?Ir(h,l,t[6]):l,e[6]=h?cn(e[5],s):t[6]),l=t[7],l&&(e[7]=l),i&c&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(T,y),e=T[0],t=T[1],r=T[2],h=T[3],d=T[4],!(g=T[9]=T[9]===n?m?0:e.length:vn(T[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)E=8==t||t==o?function(e,t,i){var r=Pr(e);return function s(){for(var o=arguments.length,a=se(o),l=o,c=os(s);l--;)a[l]=arguments[l];var u=o<3&&a[0]!==c&&a[o-1]!==c?[]:cn(a,c);return(o-=u.length)<i?jr(e,t,Fr,s.placeholder,n,a,u,n,n,i-o):xt(this&&this!==pt&&this instanceof s?r:e,this,a)}}(e,t,g):t!=a&&33!=t||d.length?Fr.apply(n,T):function(e,t,n,i){var r=1&t,s=Pr(e);return function t(){for(var o=-1,a=arguments.length,l=-1,c=i.length,u=se(c+a),h=this&&this!==pt&&this instanceof t?s:e;++l<c;)u[l]=i[l];for(;a--;)u[l++]=arguments[++o];return xt(h,r?n:this,u)}}(e,t,r,h);else var E=function(e,t,n){var i=1&t,r=Pr(e);return function t(){return(this&&this!==pt&&this instanceof t?r:e).apply(i?n:this,arguments)}}(e,t,r);return As((y?Qi:Cs)(E,T),e,t)}function Jr(e,t,i,r){return e===n||Fo(e,Le[i])&&!De.call(r,i)?t:e}function Zr(e,t,i,r,s,o){return Qo(e)&&Qo(t)&&(o.set(t,e),zi(e,t,n,Zr,o),o.delete(t)),e}function Qr(e){return ia(e)?n:e}function es(e,t,i,r,s,o){var a=1&i,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var u=o.get(e),h=o.get(t);if(u&&h)return u==t&&h==e;var d=-1,p=!0,f=2&i?new Xn:n;for(o.set(e,t),o.set(t,e);++d<l;){var g=e[d],m=t[d];if(r)var v=a?r(m,g,d,t,e,o):r(g,m,d,e,t,o);if(v!==n){if(v)continue;p=!1;break}if(f){if(!$t(t,(function(e,t){if(!Qt(f,t)&&(g===e||s(g,e,i,r,o)))return f.push(t)}))){p=!1;break}}else if(g!==m&&!s(g,m,i,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p}function ts(e){return Rs(xs(e,n,Gs),e+"")}function ns(e){return Si(e,Ra,hs)}function is(e){return Si(e,Aa,ds)}var rs=kn?function(e){return kn.get(e)}:al;function ss(e){for(var t=e.name+"",n=Rn[t],i=De.call(Rn,t)?n.length:0;i--;){var r=n[i],s=r.func;if(null==s||s==e)return r.name}return t}function os(e){return(De.call(Fn,"placeholder")?Fn:e).placeholder}function as(){var e=Fn.iteratee||il;return e=e===il?Ni:e,arguments.length?e(arguments[0],arguments[1]):e}function ls(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function cs(e){for(var t=Ra(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,Ss(r)]}return t}function us(e,t){var i=function(e,t){return null==e?n:e[t]}(e,t);return Oi(i)?i:n}var hs=vt?function(e){return null==e?[]:(e=Me(e),Rt(vt(e),(function(t){return Ye.call(e,t)})))}:fl,ds=vt?function(e){for(var t=[];e;)Nt(t,hs(e)),e=je(e);return t}:fl,ps=wi;function fs(e,t,n){for(var i=-1,r=(t=_r(t,e)).length,s=!1;++i<r;){var o=Ds(t[i]);if(!(s=null!=e&&n(e,o)))break;e=e[o]}return s||++i!=r?s:!!(r=null==e?0:e.length)&&Zo(r)&&vs(o,r)&&(Go(e)||Ho(e))}function gs(e){return"function"!=typeof e.constructor||Es(e)?{}:Un(je(e))}function ms(e){return Go(e)||Ho(e)||!!(qe&&e&&e[qe])}function vs(e,t){var n=typeof e;return!!(t=null==t?d:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function _s(e,t,n){if(!Qo(n))return!1;var i=typeof t;return!!("number"==i?Wo(n)&&vs(t,n.length):"string"==i&&t in n)&&Fo(n[t],e)}function bs(e,t){if(Go(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!aa(e))||(ee.test(e)||!Q.test(e)||null!=t&&e in Me(t))}function ys(e){var t=ss(e),n=Fn[t];if("function"!=typeof n||!(t in Gn.prototype))return!1;if(e===n)return!0;var i=rs(n);return!!i&&e===i[0]}(Sn&&ps(new Sn(new ArrayBuffer(1)))!=O||wn&&ps(new wn)!=S||xn&&ps(xn.resolve())!=M||Mn&&ps(new Mn)!=C||In&&ps(new In)!=A)&&(ps=function(e){var t=wi(e),i=t==x?e.constructor:n,r=i?Ps(i):"";if(r)switch(r){case An:return O;case Ln:return S;case On:return M;case Nn:return C;case Dn:return A}return t});var Ts=Oe?qo:gl;function Es(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Le)}function Ss(e){return e===e&&!Qo(e)}function ws(e,t){return function(i){return null!=i&&(i[e]===t&&(t!==n||e in Me(i)))}}function xs(e,t,i){return t=vn(t===n?e.length-1:t,0),function(){for(var n=arguments,r=-1,s=vn(n.length-t,0),o=se(s);++r<s;)o[r]=n[t+r];r=-1;for(var a=se(t+1);++r<t;)a[r]=n[r];return a[t]=i(o),xt(e,this,a)}}function Ms(e,t){return t.length<2?e:Ei(e,nr(t,0,-1))}function Is(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Cs=Ls(Qi),ks=dt||function(e,t){return pt.setTimeout(e,t)},Rs=Ls(er);function As(e,t,n){var i=t+"";return Rs(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return It(g,(function(n){var i="_."+n[0];t&n[1]&&!At(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(le):[]}(i),n)))}function Ls(e){var t=0,i=0;return function(){var r=bn(),s=16-(r-i);if(i=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Os(e,t){var i=-1,r=e.length,s=r-1;for(t=t===n?r:t;++i<t;){var o=Xi(i,s),a=e[o];e[o]=e[i],e[i]=a}return e.length=t,e}var Ns=function(e){var t=Oo(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,i,r){t.push(i?r.replace(he,"$1"):n||e)})),t}));function Ds(e){if("string"==typeof e||aa(e))return e;var t=e+"";return"0"==t&&1/e==-h?"-0":t}function Ps(e){if(null!=e){try{return Ne.call(e)}catch{}try{return e+""}catch{}}return""}function $s(e){if(e instanceof Gn)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=Cr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Bs=Ki((function(e,t){return jo(e)?ui(e,mi(t,1,jo,!0)):[]})),Fs=Ki((function(e,t){var i=Ys(t);return jo(i)&&(i=n),jo(e)?ui(e,mi(t,1,jo,!0),as(i,2)):[]})),Us=Ki((function(e,t){var i=Ys(t);return jo(i)&&(i=n),jo(e)?ui(e,mi(t,1,jo,!0),n,i):[]}));function zs(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:pa(n);return r<0&&(r=vn(i+r,0)),Ut(e,as(t,3),r)}function Hs(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var s=r-1;return i!==n&&(s=pa(i),s=i<0?vn(r+s,0):_n(s,r-1)),Ut(e,as(t,3),s,!0)}function Gs(e){return(null==e?0:e.length)?mi(e,1):[]}function Vs(e){return e&&e.length?e[0]:n}var Ws=Ki((function(e){var t=Ot(e,mr);return t.length&&t[0]===e[0]?Ci(t):[]})),js=Ki((function(e){var t=Ys(e),i=Ot(e,mr);return t===Ys(i)?t=n:i.pop(),i.length&&i[0]===e[0]?Ci(i,as(t,2)):[]})),Xs=Ki((function(e){var t=Ys(e),i=Ot(e,mr);return(t="function"==typeof t?t:n)&&i.pop(),i.length&&i[0]===e[0]?Ci(i,n,t):[]}));function Ys(e){var t=null==e?0:e.length;return t?e[t-1]:n}var Ks=Ki(qs);function qs(e,t){return e&&e.length&&t&&t.length?Wi(e,t):e}var Js=ts((function(e,t){var n=null==e?0:e.length,i=si(e,t);return ji(e,Ot(t,(function(e){return vs(e,n)?+e:e})).sort(xr)),i}));function Zs(e){return null==e?e:En.call(e)}var Qs=Ki((function(e){return cr(mi(e,1,jo,!0))})),eo=Ki((function(e){var t=Ys(e);return jo(t)&&(t=n),cr(mi(e,1,jo,!0),as(t,2))})),to=Ki((function(e){var t=Ys(e);return t="function"==typeof t?t:n,cr(mi(e,1,jo,!0),n,t)}));function no(e){if(!e||!e.length)return[];var t=0;return e=Rt(e,(function(e){if(jo(e))return t=vn(e.length,t),!0})),Kt(t,(function(t){return Ot(e,Wt(t))}))}function io(e,t){if(!e||!e.length)return[];var i=no(e);return null==t?i:Ot(i,(function(e){return xt(t,n,e)}))}var ro=Ki((function(e,t){return jo(e)?ui(e,t):[]})),so=Ki((function(e){return fr(Rt(e,jo))})),oo=Ki((function(e){var t=Ys(e);return jo(t)&&(t=n),fr(Rt(e,jo),as(t,2))})),ao=Ki((function(e){var t=Ys(e);return t="function"==typeof t?t:n,fr(Rt(e,jo),n,t)})),lo=Ki(no);var co=Ki((function(e){var t=e.length,i=t>1?e[t-1]:n;return i="function"==typeof i?(e.pop(),i):n,io(e,i)}));function uo(e){var t=Fn(e);return t.__chain__=!0,t}function ho(e,t){return t(e)}var po=ts((function(e){var t=e.length,i=t?e[0]:0,r=this.__wrapped__,s=function(t){return si(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Gn&&vs(i)?((r=r.slice(i,+i+(t?1:0))).__actions__.push({func:ho,args:[s],thisArg:n}),new Hn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(s)}));var fo=Rr((function(e,t,n){De.call(e,n)?++e[n]:ri(e,n,1)}));var go=$r(zs),mo=$r(Hs);function vo(e,t){return(Go(e)?It:hi)(e,as(t,3))}function _o(e,t){return(Go(e)?Ct:di)(e,as(t,3))}var bo=Rr((function(e,t,n){De.call(e,n)?e[n].push(t):ri(e,n,[t])}));var yo=Ki((function(e,t,n){var i=-1,r="function"==typeof t,s=Wo(e)?se(e.length):[];return hi(e,(function(e){s[++i]=r?xt(t,e,n):ki(e,t,n)})),s})),To=Rr((function(e,t,n){ri(e,n,t)}));function Eo(e,t){return(Go(e)?Ot:Bi)(e,as(t,3))}var So=Rr((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var wo=Ki((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_s(e,t[0],t[1])?t=[]:n>2&&_s(t[0],t[1],t[2])&&(t=[t[0]]),Gi(e,mi(t,1),[])})),xo=ht||function(){return pt.Date.now()};function Mo(e,t,i){return t=i?n:t,t=e&&null==t?e.length:t,qr(e,c,n,n,n,n,t)}function Io(e,t){var r;if("function"!=typeof t)throw new ke(i);return e=pa(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r}}var Co=Ki((function(e,t,n){var i=1;if(n.length){var r=cn(n,os(Co));i|=a}return qr(e,i,t,n,r)})),ko=Ki((function(e,t,n){var i=3;if(n.length){var r=cn(n,os(ko));i|=a}return qr(t,i,e,n,r)}));function Ro(e,t,r){var s,o,a,l,c,u,h=0,d=!1,p=!1,f=!0;if("function"!=typeof e)throw new ke(i);function g(t){var i=s,r=o;return s=o=n,h=t,l=e.apply(r,i)}function m(e){var i=e-u;return u===n||i>=t||i<0||p&&e-h>=a}function v(){var e=xo();if(m(e))return _(e);c=ks(v,function(e){var n=t-(e-u);return p?_n(n,a-(e-h)):n}(e))}function _(e){return c=n,f&&s?g(e):(s=o=n,l)}function b(){var e=xo(),i=m(e);if(s=arguments,o=this,u=e,i){if(c===n)return function(e){return h=e,c=ks(v,t),d?g(e):l}(u);if(p)return Tr(c),c=ks(v,t),g(u)}return c===n&&(c=ks(v,t)),l}return t=ga(t)||0,Qo(r)&&(d=!!r.leading,a=(p="maxWait"in r)?vn(ga(r.maxWait)||0,t):a,f="trailing"in r?!!r.trailing:f),b.cancel=function(){c!==n&&Tr(c),h=0,s=u=o=c=n},b.flush=function(){return c===n?l:_(xo())},b}var Ao=Ki((function(e,t){return ci(e,1,t)})),Lo=Ki((function(e,t,n){return ci(e,ga(t)||0,n)}));function Oo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ke(i);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=e.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(Oo.Cache||jn),n}function No(e){if("function"!=typeof e)throw new ke(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Oo.Cache=jn;var Do=br((function(e,t){var n=(t=1==t.length&&Go(t[0])?Ot(t[0],Jt(as())):Ot(mi(t,1),Jt(as()))).length;return Ki((function(i){for(var r=-1,s=_n(i.length,n);++r<s;)i[r]=t[r].call(this,i[r]);return xt(e,this,i)}))})),Po=Ki((function(e,t){var i=cn(t,os(Po));return qr(e,a,n,t,i)})),$o=Ki((function(e,t){var i=cn(t,os($o));return qr(e,l,n,t,i)})),Bo=ts((function(e,t){return qr(e,u,n,n,n,t)}));function Fo(e,t){return e===t||e!==e&&t!==t}var Uo=Wr(xi),zo=Wr((function(e,t){return e>=t})),Ho=Ri(function(){return arguments}())?Ri:function(e){return ea(e)&&De.call(e,"callee")&&!Ye.call(e,"callee")},Go=se.isArray,Vo=bt?Jt(bt):function(e){return ea(e)&&wi(e)==L};function Wo(e){return null!=e&&Zo(e.length)&&!qo(e)}function jo(e){return ea(e)&&Wo(e)}var Xo=_t||gl,Yo=yt?Jt(yt):function(e){return ea(e)&&wi(e)==b};function Ko(e){if(!ea(e))return!1;var t=wi(e);return t==y||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ia(e)}function qo(e){if(!Qo(e))return!1;var t=wi(e);return t==T||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Jo(e){return"number"==typeof e&&e==pa(e)}function Zo(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function Qo(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ea(e){return null!=e&&"object"==typeof e}var ta=Tt?Jt(Tt):function(e){return ea(e)&&ps(e)==S};function na(e){return"number"==typeof e||ea(e)&&wi(e)==w}function ia(e){if(!ea(e)||wi(e)!=x)return!1;var t=je(e);if(null===t)return!0;var n=De.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ne.call(n)==Fe}var ra=Et?Jt(Et):function(e){return ea(e)&&wi(e)==I};var sa=St?Jt(St):function(e){return ea(e)&&ps(e)==C};function oa(e){return"string"==typeof e||!Go(e)&&ea(e)&&wi(e)==k}function aa(e){return"symbol"==typeof e||ea(e)&&wi(e)==R}var la=wt?Jt(wt):function(e){return ea(e)&&Zo(e.length)&&!!ot[wi(e)]};var ca=Wr($i),ua=Wr((function(e,t){return e<=t}));function ha(e){if(!e)return[];if(Wo(e))return oa(e)?dn(e):Cr(e);if(Je&&e[Je])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Je]());var t=ps(e);return(t==S?an:t==C?un:Fa)(e)}function da(e){return e?(e=ga(e))===h||e===-h?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}function pa(e){var t=da(e),n=t%1;return t===t?n?t-n:t:0}function fa(e){return e?oi(pa(e),0,f):0}function ga(e){if("number"==typeof e)return e;if(aa(e))return p;if(Qo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Qo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=qt(e);var n=ge.test(e);return n||ve.test(e)?ut(e.slice(2),n?2:8):fe.test(e)?p:+e}function ma(e){return kr(e,Aa(e))}function va(e){return null==e?"":lr(e)}var _a=Ar((function(e,t){if(Es(t)||Wo(t))kr(t,Ra(t),e);else for(var n in t)De.call(t,n)&&ei(e,n,t[n])})),ba=Ar((function(e,t){kr(t,Aa(t),e)})),ya=Ar((function(e,t,n,i){kr(t,Aa(t),e,i)})),Ta=Ar((function(e,t,n,i){kr(t,Ra(t),e,i)})),Ea=ts(si);var Sa=Ki((function(e,t){e=Me(e);var i=-1,r=t.length,s=r>2?t[2]:n;for(s&&_s(t[0],t[1],s)&&(r=1);++i<r;)for(var o=t[i],a=Aa(o),l=-1,c=a.length;++l<c;){var u=a[l],h=e[u];(h===n||Fo(h,Le[u])&&!De.call(e,u))&&(e[u]=o[u])}return e})),wa=Ki((function(e){return e.push(n,Zr),xt(Oa,n,e)}));function xa(e,t,i){var r=null==e?n:Ei(e,t);return r===n?i:r}function Ma(e,t){return null!=e&&fs(e,t,Ii)}var Ia=Ur((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),e[t]=n}),Qa(nl)),Ca=Ur((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Be.call(t)),De.call(e,t)?e[t].push(n):e[t]=[n]}),as),ka=Ki(ki);function Ra(e){return Wo(e)?Kn(e):Di(e)}function Aa(e){return Wo(e)?Kn(e,!0):Pi(e)}var La=Ar((function(e,t,n){zi(e,t,n)})),Oa=Ar((function(e,t,n,i){zi(e,t,n,i)})),Na=ts((function(e,t){var n={};if(null==e)return n;var i=!1;t=Ot(t,(function(t){return t=_r(t,e),i||(i=t.length>1),t})),kr(e,is(e),n),i&&(n=ai(n,7,Qr));for(var r=t.length;r--;)ur(n,t[r]);return n}));var Da=ts((function(e,t){return null==e?{}:function(e,t){return Vi(e,t,(function(t,n){return Ma(e,n)}))}(e,t)}));function Pa(e,t){if(null==e)return{};var n=Ot(is(e),(function(e){return[e]}));return t=as(t),Vi(e,n,(function(e,n){return t(e,n[0])}))}var $a=Kr(Ra),Ba=Kr(Aa);function Fa(e){return null==e?[]:Zt(e,Ra(e))}var Ua=Dr((function(e,t,n){return t=t.toLowerCase(),e+(n?za(t):t)}));function za(e){return Ka(va(e).toLowerCase())}function Ha(e){return(e=va(e))&&e.replace(be,nn).replace(Qe,"")}var Ga=Dr((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Va=Dr((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Wa=Nr("toLowerCase");var ja=Dr((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Xa=Dr((function(e,t,n){return e+(n?" ":"")+Ka(t)}));var Ya=Dr((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Nr("toUpperCase");function qa(e,t,i){return e=va(e),(t=i?n:t)===n?function(e){return it.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Ja=Ki((function(e,t){try{return xt(e,n,t)}catch(i){return Ko(i)?i:new Se(i)}})),Za=ts((function(e,t){return It(t,(function(t){t=Ds(t),ri(e,t,Co(e[t],e))})),e}));function Qa(e){return function(){return e}}var el=Br(),tl=Br(!0);function nl(e){return e}function il(e){return Ni("function"==typeof e?e:ai(e,1))}var rl=Ki((function(e,t){return function(n){return ki(n,e,t)}})),sl=Ki((function(e,t){return function(n){return ki(e,n,t)}}));function ol(e,t,n){var i=Ra(t),r=Ti(t,i);null==n&&(!Qo(t)||!r.length&&i.length)&&(n=t,t=e,e=this,r=Ti(t,Ra(t)));var s=!(Qo(n)&&"chain"in n)||!!n.chain,o=qo(e);return It(r,(function(n){var i=t[n];e[n]=i,o&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__);return(n.__actions__=Cr(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,Nt([this.value()],arguments))})})),e}function al(){}var ll=Hr(Ot),cl=Hr(kt),ul=Hr($t);function hl(e){return bs(e)?Wt(Ds(e)):function(e){return function(t){return Ei(t,e)}}(e)}var dl=Vr(),pl=Vr(!0);function fl(){return[]}function gl(){return!1}var ml=zr((function(e,t){return e+t}),0),vl=Xr("ceil"),_l=zr((function(e,t){return e/t}),1),bl=Xr("floor");var yl=zr((function(e,t){return e*t}),1),Tl=Xr("round"),El=zr((function(e,t){return e-t}),0);return Fn.after=function(e,t){if("function"!=typeof t)throw new ke(i);return e=pa(e),function(){if(--e<1)return t.apply(this,arguments)}},Fn.ary=Mo,Fn.assign=_a,Fn.assignIn=ba,Fn.assignInWith=ya,Fn.assignWith=Ta,Fn.at=Ea,Fn.before=Io,Fn.bind=Co,Fn.bindAll=Za,Fn.bindKey=ko,Fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Go(e)?e:[e]},Fn.chain=uo,Fn.chunk=function(e,t,i){t=(i?_s(e,t,i):t===n)?1:vn(pa(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var s=0,o=0,a=se(ft(r/t));s<r;)a[o++]=nr(e,s,s+=t);return a},Fn.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var s=e[t];s&&(r[i++]=s)}return r},Fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=se(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Nt(Go(n)?Cr(n):[n],mi(t,1))},Fn.cond=function(e){var t=null==e?0:e.length,n=as();return e=t?Ot(e,(function(e){if("function"!=typeof e[1])throw new ke(i);return[n(e[0]),e[1]]})):[],Ki((function(n){for(var i=-1;++i<t;){var r=e[i];if(xt(r[0],this,n))return xt(r[1],this,n)}}))},Fn.conforms=function(e){return function(e){var t=Ra(e);return function(n){return li(n,e,t)}}(ai(e,1))},Fn.constant=Qa,Fn.countBy=fo,Fn.create=function(e,t){var n=Un(e);return null==t?n:ii(n,t)},Fn.curry=function e(t,i,r){var s=qr(t,8,n,n,n,n,n,i=r?n:i);return s.placeholder=e.placeholder,s},Fn.curryRight=function e(t,i,r){var s=qr(t,o,n,n,n,n,n,i=r?n:i);return s.placeholder=e.placeholder,s},Fn.debounce=Ro,Fn.defaults=Sa,Fn.defaultsDeep=wa,Fn.defer=Ao,Fn.delay=Lo,Fn.difference=Bs,Fn.differenceBy=Fs,Fn.differenceWith=Us,Fn.drop=function(e,t,i){var r=null==e?0:e.length;return r?nr(e,(t=i||t===n?1:pa(t))<0?0:t,r):[]},Fn.dropRight=function(e,t,i){var r=null==e?0:e.length;return r?nr(e,0,(t=r-(t=i||t===n?1:pa(t)))<0?0:t):[]},Fn.dropRightWhile=function(e,t){return e&&e.length?dr(e,as(t,3),!0,!0):[]},Fn.dropWhile=function(e,t){return e&&e.length?dr(e,as(t,3),!0):[]},Fn.fill=function(e,t,i,r){var s=null==e?0:e.length;return s?(i&&"number"!=typeof i&&_s(e,t,i)&&(i=0,r=s),function(e,t,i,r){var s=e.length;for((i=pa(i))<0&&(i=-i>s?0:s+i),(r=r===n||r>s?s:pa(r))<0&&(r+=s),r=i>r?0:fa(r);i<r;)e[i++]=t;return e}(e,t,i,r)):[]},Fn.filter=function(e,t){return(Go(e)?Rt:gi)(e,as(t,3))},Fn.flatMap=function(e,t){return mi(Eo(e,t),1)},Fn.flatMapDeep=function(e,t){return mi(Eo(e,t),h)},Fn.flatMapDepth=function(e,t,i){return i=i===n?1:pa(i),mi(Eo(e,t),i)},Fn.flatten=Gs,Fn.flattenDeep=function(e){return(null==e?0:e.length)?mi(e,h):[]},Fn.flattenDepth=function(e,t){return(null==e?0:e.length)?mi(e,t=t===n?1:pa(t)):[]},Fn.flip=function(e){return qr(e,512)},Fn.flow=el,Fn.flowRight=tl,Fn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i},Fn.functions=function(e){return null==e?[]:Ti(e,Ra(e))},Fn.functionsIn=function(e){return null==e?[]:Ti(e,Aa(e))},Fn.groupBy=bo,Fn.initial=function(e){return(null==e?0:e.length)?nr(e,0,-1):[]},Fn.intersection=Ws,Fn.intersectionBy=js,Fn.intersectionWith=Xs,Fn.invert=Ia,Fn.invertBy=Ca,Fn.invokeMap=yo,Fn.iteratee=il,Fn.keyBy=To,Fn.keys=Ra,Fn.keysIn=Aa,Fn.map=Eo,Fn.mapKeys=function(e,t){var n={};return t=as(t,3),bi(e,(function(e,i,r){ri(n,t(e,i,r),e)})),n},Fn.mapValues=function(e,t){var n={};return t=as(t,3),bi(e,(function(e,i,r){ri(n,i,t(e,i,r))})),n},Fn.matches=function(e){return Fi(ai(e,1))},Fn.matchesProperty=function(e,t){return Ui(e,ai(t,1))},Fn.memoize=Oo,Fn.merge=La,Fn.mergeWith=Oa,Fn.method=rl,Fn.methodOf=sl,Fn.mixin=ol,Fn.negate=No,Fn.nthArg=function(e){return e=pa(e),Ki((function(t){return Hi(t,e)}))},Fn.omit=Na,Fn.omitBy=function(e,t){return Pa(e,No(as(t)))},Fn.once=function(e){return Io(2,e)},Fn.orderBy=function(e,t,i,r){return null==e?[]:(Go(t)||(t=null==t?[]:[t]),Go(i=r?n:i)||(i=null==i?[]:[i]),Gi(e,t,i))},Fn.over=ll,Fn.overArgs=Do,Fn.overEvery=cl,Fn.overSome=ul,Fn.partial=Po,Fn.partialRight=$o,Fn.partition=So,Fn.pick=Da,Fn.pickBy=Pa,Fn.property=hl,Fn.propertyOf=function(e){return function(t){return null==e?n:Ei(e,t)}},Fn.pull=Ks,Fn.pullAll=qs,Fn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Wi(e,t,as(n,2)):e},Fn.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?Wi(e,t,n,i):e},Fn.pullAt=Js,Fn.range=dl,Fn.rangeRight=pl,Fn.rearg=Bo,Fn.reject=function(e,t){return(Go(e)?Rt:gi)(e,No(as(t,3)))},Fn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],s=e.length;for(t=as(t,3);++i<s;){var o=e[i];t(o,i,e)&&(n.push(o),r.push(i))}return ji(e,r),n},Fn.rest=function(e,t){if("function"!=typeof e)throw new ke(i);return Ki(e,t=t===n?t:pa(t))},Fn.reverse=Zs,Fn.sampleSize=function(e,t,i){return t=(i?_s(e,t,i):t===n)?1:pa(t),(Go(e)?Jn:Ji)(e,t)},Fn.set=function(e,t,n){return null==e?e:Zi(e,t,n)},Fn.setWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:Zi(e,t,i,r)},Fn.shuffle=function(e){return(Go(e)?Zn:tr)(e)},Fn.slice=function(e,t,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&_s(e,t,i)?(t=0,i=r):(t=null==t?0:pa(t),i=i===n?r:pa(i)),nr(e,t,i)):[]},Fn.sortBy=wo,Fn.sortedUniq=function(e){return e&&e.length?or(e):[]},Fn.sortedUniqBy=function(e,t){return e&&e.length?or(e,as(t,2)):[]},Fn.split=function(e,t,i){return i&&"number"!=typeof i&&_s(e,t,i)&&(t=i=n),(i=i===n?f:i>>>0)?(e=va(e))&&("string"==typeof t||null!=t&&!ra(t))&&(!(t=lr(t))&&on(e))?yr(dn(e),0,i):e.split(t,i):[]},Fn.spread=function(e,t){if("function"!=typeof e)throw new ke(i);return t=null==t?0:vn(pa(t),0),Ki((function(n){var i=n[t],r=yr(n,0,t);return i&&Nt(r,i),xt(e,this,r)}))},Fn.tail=function(e){var t=null==e?0:e.length;return t?nr(e,1,t):[]},Fn.take=function(e,t,i){return e&&e.length?nr(e,0,(t=i||t===n?1:pa(t))<0?0:t):[]},Fn.takeRight=function(e,t,i){var r=null==e?0:e.length;return r?nr(e,(t=r-(t=i||t===n?1:pa(t)))<0?0:t,r):[]},Fn.takeRightWhile=function(e,t){return e&&e.length?dr(e,as(t,3),!1,!0):[]},Fn.takeWhile=function(e,t){return e&&e.length?dr(e,as(t,3)):[]},Fn.tap=function(e,t){return t(e),e},Fn.throttle=function(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new ke(i);return Qo(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),Ro(e,t,{leading:r,maxWait:t,trailing:s})},Fn.thru=ho,Fn.toArray=ha,Fn.toPairs=$a,Fn.toPairsIn=Ba,Fn.toPath=function(e){return Go(e)?Ot(e,Ds):aa(e)?[e]:Cr(Ns(va(e)))},Fn.toPlainObject=ma,Fn.transform=function(e,t,n){var i=Go(e),r=i||Xo(e)||la(e);if(t=as(t,4),null==n){var s=e&&e.constructor;n=r?i?new s:[]:Qo(e)&&qo(s)?Un(je(e)):{}}return(r?It:bi)(e,(function(e,i,r){return t(n,e,i,r)})),n},Fn.unary=function(e){return Mo(e,1)},Fn.union=Qs,Fn.unionBy=eo,Fn.unionWith=to,Fn.uniq=function(e){return e&&e.length?cr(e):[]},Fn.uniqBy=function(e,t){return e&&e.length?cr(e,as(t,2)):[]},Fn.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?cr(e,n,t):[]},Fn.unset=function(e,t){return null==e||ur(e,t)},Fn.unzip=no,Fn.unzipWith=io,Fn.update=function(e,t,n){return null==e?e:hr(e,t,vr(n))},Fn.updateWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:hr(e,t,vr(i),r)},Fn.values=Fa,Fn.valuesIn=function(e){return null==e?[]:Zt(e,Aa(e))},Fn.without=ro,Fn.words=qa,Fn.wrap=function(e,t){return Po(vr(t),e)},Fn.xor=so,Fn.xorBy=oo,Fn.xorWith=ao,Fn.zip=lo,Fn.zipObject=function(e,t){return gr(e||[],t||[],ei)},Fn.zipObjectDeep=function(e,t){return gr(e||[],t||[],Zi)},Fn.zipWith=co,Fn.entries=$a,Fn.entriesIn=Ba,Fn.extend=ba,Fn.extendWith=ya,ol(Fn,Fn),Fn.add=ml,Fn.attempt=Ja,Fn.camelCase=Ua,Fn.capitalize=za,Fn.ceil=vl,Fn.clamp=function(e,t,i){return i===n&&(i=t,t=n),i!==n&&(i=(i=ga(i))===i?i:0),t!==n&&(t=(t=ga(t))===t?t:0),oi(ga(e),t,i)},Fn.clone=function(e){return ai(e,4)},Fn.cloneDeep=function(e){return ai(e,5)},Fn.cloneDeepWith=function(e,t){return ai(e,5,t="function"==typeof t?t:n)},Fn.cloneWith=function(e,t){return ai(e,4,t="function"==typeof t?t:n)},Fn.conformsTo=function(e,t){return null==t||li(e,t,Ra(t))},Fn.deburr=Ha,Fn.defaultTo=function(e,t){return null==e||e!==e?t:e},Fn.divide=_l,Fn.endsWith=function(e,t,i){e=va(e),t=lr(t);var r=e.length,s=i=i===n?r:oi(pa(i),0,r);return(i-=t.length)>=0&&e.slice(i,s)==t},Fn.eq=Fo,Fn.escape=function(e){return(e=va(e))&&K.test(e)?e.replace(X,rn):e},Fn.escapeRegExp=function(e){return(e=va(e))&&ie.test(e)?e.replace(ne,"\\$&"):e},Fn.every=function(e,t,i){var r=Go(e)?kt:pi;return i&&_s(e,t,i)&&(t=n),r(e,as(t,3))},Fn.find=go,Fn.findIndex=zs,Fn.findKey=function(e,t){return Ft(e,as(t,3),bi)},Fn.findLast=mo,Fn.findLastIndex=Hs,Fn.findLastKey=function(e,t){return Ft(e,as(t,3),yi)},Fn.floor=bl,Fn.forEach=vo,Fn.forEachRight=_o,Fn.forIn=function(e,t){return null==e?e:vi(e,as(t,3),Aa)},Fn.forInRight=function(e,t){return null==e?e:_i(e,as(t,3),Aa)},Fn.forOwn=function(e,t){return e&&bi(e,as(t,3))},Fn.forOwnRight=function(e,t){return e&&yi(e,as(t,3))},Fn.get=xa,Fn.gt=Uo,Fn.gte=zo,Fn.has=function(e,t){return null!=e&&fs(e,t,Mi)},Fn.hasIn=Ma,Fn.head=Vs,Fn.identity=nl,Fn.includes=function(e,t,n,i){e=Wo(e)?e:Fa(e),n=n&&!i?pa(n):0;var r=e.length;return n<0&&(n=vn(r+n,0)),oa(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&zt(e,t,n)>-1},Fn.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:pa(n);return r<0&&(r=vn(i+r,0)),zt(e,t,r)},Fn.inRange=function(e,t,i){return t=da(t),i===n?(i=t,t=0):i=da(i),function(e,t,n){return e>=_n(t,n)&&e<vn(t,n)}(e=ga(e),t,i)},Fn.invoke=ka,Fn.isArguments=Ho,Fn.isArray=Go,Fn.isArrayBuffer=Vo,Fn.isArrayLike=Wo,Fn.isArrayLikeObject=jo,Fn.isBoolean=function(e){return!0===e||!1===e||ea(e)&&wi(e)==_},Fn.isBuffer=Xo,Fn.isDate=Yo,Fn.isElement=function(e){return ea(e)&&1===e.nodeType&&!ia(e)},Fn.isEmpty=function(e){if(null==e)return!0;if(Wo(e)&&(Go(e)||"string"==typeof e||"function"==typeof e.splice||Xo(e)||la(e)||Ho(e)))return!e.length;var t=ps(e);if(t==S||t==C)return!e.size;if(Es(e))return!Di(e).length;for(var n in e)if(De.call(e,n))return!1;return!0},Fn.isEqual=function(e,t){return Ai(e,t)},Fn.isEqualWith=function(e,t,i){var r=(i="function"==typeof i?i:n)?i(e,t):n;return r===n?Ai(e,t,n,i):!!r},Fn.isError=Ko,Fn.isFinite=function(e){return"number"==typeof e&&Bt(e)},Fn.isFunction=qo,Fn.isInteger=Jo,Fn.isLength=Zo,Fn.isMap=ta,Fn.isMatch=function(e,t){return e===t||Li(e,t,cs(t))},Fn.isMatchWith=function(e,t,i){return i="function"==typeof i?i:n,Li(e,t,cs(t),i)},Fn.isNaN=function(e){return na(e)&&e!=+e},Fn.isNative=function(e){if(Ts(e))throw new Se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Oi(e)},Fn.isNil=function(e){return null==e},Fn.isNull=function(e){return null===e},Fn.isNumber=na,Fn.isObject=Qo,Fn.isObjectLike=ea,Fn.isPlainObject=ia,Fn.isRegExp=ra,Fn.isSafeInteger=function(e){return Jo(e)&&e>=-d&&e<=d},Fn.isSet=sa,Fn.isString=oa,Fn.isSymbol=aa,Fn.isTypedArray=la,Fn.isUndefined=function(e){return e===n},Fn.isWeakMap=function(e){return ea(e)&&ps(e)==A},Fn.isWeakSet=function(e){return ea(e)&&"[object WeakSet]"==wi(e)},Fn.join=function(e,t){return null==e?"":jt.call(e,t)},Fn.kebabCase=Ga,Fn.last=Ys,Fn.lastIndexOf=function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var s=r;return i!==n&&(s=(s=pa(i))<0?vn(r+s,0):_n(s,r-1)),t===t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,s):Ut(e,Gt,s,!0)},Fn.lowerCase=Va,Fn.lowerFirst=Wa,Fn.lt=ca,Fn.lte=ua,Fn.max=function(e){return e&&e.length?fi(e,nl,xi):n},Fn.maxBy=function(e,t){return e&&e.length?fi(e,as(t,2),xi):n},Fn.mean=function(e){return Vt(e,nl)},Fn.meanBy=function(e,t){return Vt(e,as(t,2))},Fn.min=function(e){return e&&e.length?fi(e,nl,$i):n},Fn.minBy=function(e,t){return e&&e.length?fi(e,as(t,2),$i):n},Fn.stubArray=fl,Fn.stubFalse=gl,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=yl,Fn.nth=function(e,t){return e&&e.length?Hi(e,pa(t)):n},Fn.noConflict=function(){return pt._===this&&(pt._=Ue),this},Fn.noop=al,Fn.now=xo,Fn.pad=function(e,t,n){e=va(e);var i=(t=pa(t))?hn(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Gr(gt(r),n)+e+Gr(ft(r),n)},Fn.padEnd=function(e,t,n){e=va(e);var i=(t=pa(t))?hn(e):0;return t&&i<t?e+Gr(t-i,n):e},Fn.padStart=function(e,t,n){e=va(e);var i=(t=pa(t))?hn(e):0;return t&&i<t?Gr(t-i,n)+e:e},Fn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(va(e).replace(re,""),t||0)},Fn.random=function(e,t,i){if(i&&"boolean"!=typeof i&&_s(e,t,i)&&(t=i=n),i===n&&("boolean"==typeof t?(i=t,t=n):"boolean"==typeof e&&(i=e,e=n)),e===n&&t===n?(e=0,t=1):(e=da(e),t===n?(t=e,e=0):t=da(t)),e>t){var r=e;e=t,t=r}if(i||e%1||t%1){var s=Tn();return _n(e+s*(t-e+ct("1e-"+((s+"").length-1))),t)}return Xi(e,t)},Fn.reduce=function(e,t,n){var i=Go(e)?Dt:Xt,r=arguments.length<3;return i(e,as(t,4),n,r,hi)},Fn.reduceRight=function(e,t,n){var i=Go(e)?Pt:Xt,r=arguments.length<3;return i(e,as(t,4),n,r,di)},Fn.repeat=function(e,t,i){return t=(i?_s(e,t,i):t===n)?1:pa(t),Yi(va(e),t)},Fn.replace=function(){var e=arguments,t=va(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Fn.result=function(e,t,i){var r=-1,s=(t=_r(t,e)).length;for(s||(s=1,e=n);++r<s;){var o=null==e?n:e[Ds(t[r])];o===n&&(r=s,o=i),e=qo(o)?o.call(e):o}return e},Fn.round=Tl,Fn.runInContext=e,Fn.sample=function(e){return(Go(e)?qn:qi)(e)},Fn.size=function(e){if(null==e)return 0;if(Wo(e))return oa(e)?hn(e):e.length;var t=ps(e);return t==S||t==C?e.size:Di(e).length},Fn.snakeCase=ja,Fn.some=function(e,t,i){var r=Go(e)?$t:ir;return i&&_s(e,t,i)&&(t=n),r(e,as(t,3))},Fn.sortedIndex=function(e,t){return rr(e,t)},Fn.sortedIndexBy=function(e,t,n){return sr(e,t,as(n,2))},Fn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=rr(e,t);if(i<n&&Fo(e[i],t))return i}return-1},Fn.sortedLastIndex=function(e,t){return rr(e,t,!0)},Fn.sortedLastIndexBy=function(e,t,n){return sr(e,t,as(n,2),!0)},Fn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=rr(e,t,!0)-1;if(Fo(e[n],t))return n}return-1},Fn.startCase=Xa,Fn.startsWith=function(e,t,n){return e=va(e),n=null==n?0:oi(pa(n),0,e.length),t=lr(t),e.slice(n,n+t.length)==t},Fn.subtract=El,Fn.sum=function(e){return e&&e.length?Yt(e,nl):0},Fn.sumBy=function(e,t){return e&&e.length?Yt(e,as(t,2)):0},Fn.template=function(e,t,i){var r=Fn.templateSettings;i&&_s(e,t,i)&&(t=n),e=va(e),t=ya({},t,r,Jr);var s,o,a=ya({},t.imports,r.imports,Jr),l=Ra(a),c=Zt(a,l),u=0,h=t.interpolate||ye,d="__p += '",p=Ie((t.escape||ye).source+"|"+h.source+"|"+(h===Z?de:ye).source+"|"+(t.evaluate||ye).source+"|$","g"),f="//# sourceURL="+(De.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++st+"]")+"\n";e.replace(p,(function(t,n,i,r,a,l){return i||(i=r),d+=e.slice(u,l).replace(Te,sn),n&&(s=!0,d+="' +\n__e("+n+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var g=De.call(t,"variable")&&t.variable;if(g){if(ue.test(g))throw new Se("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(G,""):d).replace(V,"$1").replace(W,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Ja((function(){return we(l,f+"return "+d).apply(n,c)}));if(m.source=d,Ko(m))throw m;return m},Fn.times=function(e,t){if((e=pa(e))<1||e>d)return[];var n=f,i=_n(e,f);t=as(t),e-=f;for(var r=Kt(i,t);++n<e;)t(n);return r},Fn.toFinite=da,Fn.toInteger=pa,Fn.toLength=fa,Fn.toLower=function(e){return va(e).toLowerCase()},Fn.toNumber=ga,Fn.toSafeInteger=function(e){return e?oi(pa(e),-d,d):0===e?e:0},Fn.toString=va,Fn.toUpper=function(e){return va(e).toUpperCase()},Fn.trim=function(e,t,i){if((e=va(e))&&(i||t===n))return qt(e);if(!e||!(t=lr(t)))return e;var r=dn(e),s=dn(t);return yr(r,en(r,s),tn(r,s)+1).join("")},Fn.trimEnd=function(e,t,i){if((e=va(e))&&(i||t===n))return e.slice(0,pn(e)+1);if(!e||!(t=lr(t)))return e;var r=dn(e);return yr(r,0,tn(r,dn(t))+1).join("")},Fn.trimStart=function(e,t,i){if((e=va(e))&&(i||t===n))return e.replace(re,"");if(!e||!(t=lr(t)))return e;var r=dn(e);return yr(r,en(r,dn(t))).join("")},Fn.truncate=function(e,t){var i=30,r="...";if(Qo(t)){var s="separator"in t?t.separator:s;i="length"in t?pa(t.length):i,r="omission"in t?lr(t.omission):r}var o=(e=va(e)).length;if(on(e)){var a=dn(e);o=a.length}if(i>=o)return e;var l=i-hn(r);if(l<1)return r;var c=a?yr(a,0,l).join(""):e.slice(0,l);if(s===n)return c+r;if(a&&(l+=c.length-l),ra(s)){if(e.slice(l).search(s)){var u,h=c;for(s.global||(s=Ie(s.source,va(pe.exec(s))+"g")),s.lastIndex=0;u=s.exec(h);)var d=u.index;c=c.slice(0,d===n?l:d)}}else if(e.indexOf(lr(s),l)!=l){var p=c.lastIndexOf(s);p>-1&&(c=c.slice(0,p))}return c+r},Fn.unescape=function(e){return(e=va(e))&&Y.test(e)?e.replace(j,fn):e},Fn.uniqueId=function(e){var t=++Pe;return va(e)+t},Fn.upperCase=Ya,Fn.upperFirst=Ka,Fn.each=vo,Fn.eachRight=_o,Fn.first=Vs,ol(Fn,function(){var e={};return bi(Fn,(function(t,n){De.call(Fn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Fn.VERSION="4.17.21",It(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Fn[e].placeholder=Fn})),It(["drop","take"],(function(e,t){Gn.prototype[e]=function(i){i=i===n?1:vn(pa(i),0);var r=this.__filtered__&&!t?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=_n(i,r.__takeCount__):r.__views__.push({size:_n(i,f),type:e+(r.__dir__<0?"Right":"")}),r},Gn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),It(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;Gn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:as(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),It(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Gn.prototype[e]=function(){return this[n](1).value()[0]}})),It(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Gn.prototype[e]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(nl)},Gn.prototype.find=function(e){return this.filter(e).head()},Gn.prototype.findLast=function(e){return this.reverse().find(e)},Gn.prototype.invokeMap=Ki((function(e,t){return"function"==typeof e?new Gn(this):this.map((function(n){return ki(n,e,t)}))})),Gn.prototype.reject=function(e){return this.filter(No(as(e)))},Gn.prototype.slice=function(e,t){e=pa(e);var i=this;return i.__filtered__&&(e>0||t<0)?new Gn(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==n&&(i=(t=pa(t))<0?i.dropRight(-t):i.take(t-e)),i)},Gn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gn.prototype.toArray=function(){return this.take(f)},bi(Gn.prototype,(function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),s=Fn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);!s||(Fn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,l=t instanceof Gn,c=a[0],u=l||Go(t),h=function(e){var t=s.apply(Fn,Nt([e],a));return r&&d?t[0]:t};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,f=o&&!d,g=l&&!p;if(!o&&u){t=g?t:new Gn(this);var m=e.apply(t,a);return m.__actions__.push({func:ho,args:[h],thisArg:n}),new Hn(m,d)}return f&&g?e.apply(this,a):(m=this.thru(h),f?r?m.value()[0]:m.value():m)})})),It(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);Fn.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Go(r)?r:[],e)}return this[n]((function(n){return t.apply(Go(n)?n:[],e)}))}})),bi(Gn.prototype,(function(e,t){var n=Fn[t];if(n){var i=n.name+"";De.call(Rn,i)||(Rn[i]=[]),Rn[i].push({name:t,func:n})}})),Rn[Fr(n,2).name]=[{name:"wrapper",func:n}],Gn.prototype.clone=function(){var e=new Gn(this.__wrapped__);return e.__actions__=Cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Cr(this.__views__),e},Gn.prototype.reverse=function(){if(this.__filtered__){var e=new Gn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Gn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Go(e),i=t<0,r=n?e.length:0,s=function(e,t,n){for(var i=-1,r=n.length;++i<r;){var s=n[i],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=_n(t,e+o);break;case"takeRight":e=vn(e,t-o)}}return{start:e,end:t}}(0,r,this.__views__),o=s.start,a=s.end,l=a-o,c=i?a:o-1,u=this.__iteratees__,h=u.length,d=0,p=_n(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return pr(e,this.__actions__);var f=[];e:for(;l--&&d<p;){for(var g=-1,m=e[c+=t];++g<h;){var v=u[g],_=v.iteratee,b=v.type,y=_(m);if(2==b)m=y;else if(!y){if(1==b)continue e;break e}}f[d++]=m}return f},Fn.prototype.at=po,Fn.prototype.chain=function(){return uo(this)},Fn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===n&&(this.__values__=ha(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Fn.prototype.plant=function(e){for(var t,i=this;i instanceof zn;){var r=$s(i);r.__index__=0,r.__values__=n,t?s.__wrapped__=r:t=r;var s=r;i=i.__wrapped__}return s.__wrapped__=e,t},Fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Gn){var t=e;return this.__actions__.length&&(t=new Gn(this)),(t=t.reverse()).__actions__.push({func:ho,args:[Zs],thisArg:n}),new Hn(t,this.__chain__)}return this.thru(Zs)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return pr(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,Je&&(Fn.prototype[Je]=function(){return this}),Fn}();gt?((gt.exports=gn)._=gn,ft._=gn):pt._=gn}).call(ud)}(k_,k_.exports);const R_=k_.exports,A_=M_(kv(((e,t)=>({clock:new I_,items:{},tfs:{},hulls:{},lines:{},texts:{},points:{},widgets:{},onMove:(t,n,i,r)=>e((e=>{console.log(r),e[n][t].position={...r.position},e[n][t].rotation=r.quaternion,e[n][t].rotation.x=r.quaternion.x,e[n][t].rotation.y=r.quaternion.y,e[n][t].rotation.z=r.quaternion.z,e[n][t].rotation.w=r.quaternion.w,e[n][t].scale={...r.scale}})),onClick:(e,n,i,r)=>{n||console.log("id: ".concat(e," clicked!"),i),t().items[e]&&!n&&r.stopPropagation()},onPointerOver:(e,t,n)=>{},onPointerOut:(e,t,n)=>{},pause:()=>e((e=>{e.clock.setTimescale(0)})),play:t=>e((e=>{e.clock.setTimescale(t||1)})),reset:t=>e((e=>{console.log("setting time to ".concat(t)),e.clock._elapsed=t?1e3*t:0})),clearItems:()=>e((e=>({items:{}}))),clearLines:()=>e((e=>({lines:{}}))),clearTfs:()=>e((e=>({tfs:{}}))),clearHulls:()=>e((e=>({hulls:{}}))),clearTexts:()=>e((e=>({texts:{}}))),clearPoints:()=>e((e=>({points:{}}))),setItems:t=>e((e=>({items:t}))),setLines:t=>e((e=>({lines:t}))),setTfs:t=>e((e=>({tfs:t}))),setHulls:t=>e((e=>({hulls:t}))),setTexts:t=>e((e=>({texts:t}))),setPoints:t=>e((e=>({points:t}))),removeItem:t=>e((e=>{delete e.items[t]})),removeLine:t=>e((e=>{delete e.lines[t]})),removeTf:t=>e((e=>{delete e.tfs[t]})),removeHull:t=>e((e=>{delete e.hulls[t]})),removeText:t=>e((e=>{delete e.texts[t]})),removePoint:t=>e((e=>{delete e.points[t]})),setItem:(t,n)=>e((e=>{e.items[t]=n})),setLine:(t,n)=>e((e=>{e.lines[t]=n})),setTf:(t,n)=>e((e=>{e.tfs[t]=n})),setHull:(t,n)=>e((e=>{e.hulls[t]=n})),setText:(t,n)=>e((e=>{e.texts[t]=n})),setPoint:(t,n)=>e((e=>{e.points[t]=n})),setProperty:(t,n)=>e((e=>{R_.set(e,t,n)}))})))),L_=(e=>e?Cv(e):Cv)(A_),O_=(0,e.createContext)(),N_=(t,n)=>Iv((0,e.useContext)(O_),t,n),D_=e=>{let{store:t,children:n,debug:i=!1}=e;return i&&console.log("SceneProvider regenerated"),Ld(O_.Provider,{value:t||L_,children:n})},P_=e.forwardRef(((e,t)=>Ld("ambientLight",{ref:t,...e})));e.forwardRef(((e,t)=>Ld("pointLight",{ref:t,...e})));const $_=e.forwardRef(((e,t)=>Ld("directionalLight",{ref:t,...e}))),B_=(e,t,n,i)=>{var r=new ln;return r.setRGB(e/255,t/255,n/255),new qc(i<=.99?{color:r.getHex(),opacity:i+.1,transparent:!0,depthWrite:!0,blendSrc:A,blendDst:L,blendEquation:w,blending:v}:{color:r.getHex(),opacity:i,blending:v})},F_=k_.exports.memoize((e=>{var t=new ln(e);return new yr({uniforms:{coeficient:{type:"f",value:1.2},power:{type:"f",value:4},glowColor:{type:"c",value:t}},vertexShader:"\n\t\tvarying vec3\tvVertexWorldPosition;\n\t\tvarying vec3\tvVertexNormal;\n\n\t\t// varying vec4\tvFragColor;\n\n\t\tvoid main(){\n\t\t\tvVertexNormal\t= normalize(normalMatrix * normal);\n\n\t\t\tvVertexWorldPosition\t= (modelMatrix * vec4(position, 1.0)).xyz;\n\n\t\t\t// set gl_Position\n\t\t\tgl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t}",fragmentShader:"\n\t\tuniform vec3\tglowColor;\n\t\tuniform float\tcoeficient;\n\t\tuniform float\tpower;\n\n\t\tvarying vec3\tvVertexNormal;\n\t\tvarying vec3\tvVertexWorldPosition;\n\n\t\t// varying vec4\tvFragColor;\n\n\t\tvoid main(){\n\t\t\tvec3 worldCameraToVertex= vVertexWorldPosition - cameraPosition;\n\t\t\tvec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n\t\t\tviewCameraToVertex\t= normalize(viewCameraToVertex);\n\t\t\tfloat intensity\t\t= pow(coeficient + dot(vVertexNormal, viewCameraToVertex), power);\n\t\t\tgl_FragColor\t\t= vec4(glowColor, intensity);\n\t\t}",blending:_,transparent:!0,depthWrite:!1,depthTest:!1})}));const U_=new Nh,z_=new yn,H_=new yn,G_=new bn,V_={X:new yn(1,0,0),Y:new yn(0,1,0),Z:new yn(0,0,1)},W_={type:"change"},j_={type:"mouseDown"},X_={type:"mouseUp",mode:null},Y_={type:"objectChange"};class K_ extends Ei{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new mb;this._gizmo=n,this.add(n);const i=new vb;this._plane=i,this.add(i);const r=this;function s(e,t){let s=t;Object.defineProperty(r,e,{get:function(){return void 0!==s?s:t},set:function(t){s!==t&&(s=t,i[e]=t,n[e]=t,r.dispatchEvent({type:e+"-changed",value:t}),r.dispatchEvent(W_))}}),r[e]=t,i[e]=t,n[e]=t}s("camera",e),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);const o=new yn,a=new yn,l=new bn,c=new bn,u=new yn,h=new bn,d=new yn,p=new yn,f=new yn,g=new yn;s("worldPosition",o),s("worldPositionStart",a),s("worldQuaternion",l),s("worldQuaternionStart",c),s("cameraPosition",u),s("cameraQuaternion",h),s("pointStart",d),s("pointEnd",p),s("rotationAxis",f),s("rotationAngle",0),s("eye",g),this._offset=new yn,this._startNorm=new yn,this._endNorm=new yn,this._cameraScale=new yn,this._parentPosition=new yn,this._parentQuaternion=new bn,this._parentQuaternionInv=new bn,this._parentScale=new yn,this._worldScaleStart=new yn,this._worldQuaternionInv=new bn,this._worldScale=new yn,this._positionStart=new yn,this._quaternionStart=new bn,this._scaleStart=new yn,this._getPointer=q_.bind(this),this._onPointerDown=Z_.bind(this),this._onPointerHover=J_.bind(this),this._onPointerMove=Q_.bind(this),this._onPointerUp=eb.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye):this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;U_.setFromCamera(e,this.camera);const t=tb(this._gizmo.picker[this.mode],U_);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){U_.setFromCamera(e,this.camera);const t=tb(this._plane,U_,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,j_.mode=this.mode,this.dispatchEvent(j_)}}pointerMove(e){const t=this.axis,n=this.mode,i=this.object;let r=this.space;if("scale"===n?r="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(r="world"),void 0===i||null===t||!1===this.dragging||-1!==e.button)return;U_.setFromCamera(e,this.camera);const s=tb(this._plane,U_,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===r&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===r&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===r&&(i.position.applyQuaternion(G_.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),"world"===r&&(i.parent&&i.position.add(z_.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(z_.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),H_.set(e,e,e)}else z_.copy(this.pointStart),H_.copy(this.pointEnd),z_.applyQuaternion(this._worldQuaternionInv),H_.applyQuaternion(this._worldQuaternionInv),H_.divide(z_),-1===t.search("X")&&(H_.x=1),-1===t.search("Y")&&(H_.y=1),-1===t.search("Z")&&(H_.z=1);i.scale.copy(this._scaleStart).multiply(H_),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(z_.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(z_.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(V_[t]),z_.copy(V_[t]),"local"===r&&z_.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(z_.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===r&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(G_.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(G_.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(W_),this.dispatchEvent(Y_)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(X_.mode=this.mode,this.dispatchEvent(X_)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(W_),this.dispatchEvent(Y_),this.pointStart.copy(this.pointEnd))}getRaycaster(){return U_}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function q_(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function J_(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function Z_(e){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function Q_(e){!this.enabled||this.pointerMove(this._getPointer(e))}function eb(e){!this.enabled||(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function tb(e,t,n){const i=t.intersectObject(e,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||n)return i[r];return!1}const nb=new ai,ib=new yn(0,1,0),rb=new yn(0,0,0),sb=new Jn,ob=new bn,ab=new bn,lb=new yn,cb=new Jn,ub=new yn(1,0,0),hb=new yn(0,1,0),db=new yn(0,0,1),pb=new yn,fb=new yn,gb=new yn;class mb extends Ei{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Pi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new ol({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const i=t.clone();i.opacity=.5;const r=e.clone();r.color.setHex(16711680);const s=e.clone();s.color.setHex(65280);const o=e.clone();o.color.setHex(255);const a=e.clone();a.color.setHex(16711680),a.opacity=.5;const l=e.clone();l.color.setHex(65280),l.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const u=e.clone();u.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const d=e.clone();d.color.setHex(7895160);const p=new ql(0,.04,.1,12);p.translate(0,.05,0);const f=new mr(.08,.08,.08);f.translate(0,.04,0);const g=new qi;g.setAttribute("position",new Hi([0,0,0,1,0,0],3));const m=new ql(.0075,.0075,.5,3);function v(e,t){const n=new Hc(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}m.translate(0,.25,0);const _={X:[[new fr(p,r),[.5,0,0],[0,0,-Math.PI/2]],[new fr(p,r),[-.5,0,0],[0,0,Math.PI/2]],[new fr(m,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new fr(p,s),[0,.5,0]],[new fr(p,s),[0,-.5,0],[Math.PI,0,0]],[new fr(m,s)]],Z:[[new fr(p,o),[0,0,.5],[Math.PI/2,0,0]],[new fr(p,o),[0,0,-.5],[-Math.PI/2,0,0]],[new fr(m,o),null,[Math.PI/2,0,0]]],XYZ:[[new fr(new $c(.1,0),u.clone()),[0,0,0]]],XY:[[new fr(new mr(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new fr(new mr(.15,.15,.01),a.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fr(new mr(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},b={X:[[new fr(new ql(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fr(new ql(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fr(new ql(.2,0,.6,4),n),[0,.3,0]],[new fr(new ql(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fr(new ql(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fr(new ql(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new fr(new $c(.2,0),n)]],XY:[[new fr(new mr(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fr(new mr(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fr(new mr(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},y={START:[[new fr(new $c(.01,2),i),null,null,null,"helper"]],END:[[new fr(new $c(.01,2),i),null,null,null,"helper"]],DELTA:[[new dl(function(){const e=new qi;return e.setAttribute("position",new Hi([0,0,0,1,1,1],3)),e}(),i),null,null,null,"helper"]],X:[[new dl(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new dl(g,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new dl(g,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},T={XYZE:[[new fr(v(.5,1),d),null,[0,Math.PI/2,0]]],X:[[new fr(v(.5,.5),r)]],Y:[[new fr(v(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new fr(v(.5,.5),o),null,[0,Math.PI/2,0]]],E:[[new fr(v(.75,1),h),null,[0,Math.PI/2,0]]]},E={AXIS:[[new dl(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},S={XYZE:[[new fr(new Uc(.25,10,8),n)]],X:[[new fr(new Hc(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new fr(new Hc(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new fr(new Hc(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new fr(new Hc(.75,.1,2,24),n)]]},w={X:[[new fr(f,r),[.5,0,0],[0,0,-Math.PI/2]],[new fr(m,r),[0,0,0],[0,0,-Math.PI/2]],[new fr(f,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new fr(f,s),[0,.5,0]],[new fr(m,s)],[new fr(f,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new fr(f,o),[0,0,.5],[Math.PI/2,0,0]],[new fr(m,o),[0,0,0],[Math.PI/2,0,0]],[new fr(f,o),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new fr(new mr(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new fr(new mr(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fr(new mr(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fr(new mr(.1,.1,.1),u.clone())]]},x={X:[[new fr(new ql(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fr(new ql(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fr(new ql(.2,0,.6,4),n),[0,.3,0]],[new fr(new ql(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fr(new ql(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fr(new ql(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new fr(new mr(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fr(new mr(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fr(new mr(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fr(new mr(.2,.2,.2),n),[0,0,0]]]},M={X:[[new dl(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new dl(g,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new dl(g,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function I(e){const t=new Ei;for(const n in e)for(let i=e[n].length;i--;){const r=e[n][i][0].clone(),s=e[n][i][1],o=e[n][i][2],a=e[n][i][3],l=e[n][i][4];r.name=n,r.tag=l,s&&r.position.set(s[0],s[1],s[2]),o&&r.rotation.set(o[0],o[1],o[2]),a&&r.scale.set(a[0],a[1],a[2]),r.updateMatrix();const c=r.geometry.clone();c.applyMatrix4(r.matrix),r.geometry=c,r.renderOrder=1/0,r.position.set(0,0,0),r.rotation.set(0,0,0),r.scale.set(1,1,1),t.add(r)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=I(_)),this.add(this.gizmo.rotate=I(T)),this.add(this.gizmo.scale=I(w)),this.add(this.picker.translate=I(b)),this.add(this.picker.rotate=I(S)),this.add(this.picker.scale=I(x)),this.add(this.helper.translate=I(y)),this.add(this.helper.rotate=I(E)),this.add(this.helper.scale=I(M)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:ab;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let i=0;i<n.length;i++){const e=n[i];let r;e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),(r=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(r*this.size/4),"helper"!==e.tag)?(e.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===e.name&&Math.abs(ib.copy(ub).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Y"===e.name&&Math.abs(ib.copy(hb).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Z"===e.name&&Math.abs(ib.copy(db).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(ib.copy(db).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(ib.copy(ub).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(ib.copy(hb).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1)):"rotate"===this.mode&&(ob.copy(t),ib.copy(this.eye).applyQuaternion(G_.copy(t).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(sb.lookAt(this.eye,rb,hb)),"X"===e.name&&(G_.setFromAxisAngle(ub,Math.atan2(-ib.y,ib.z)),G_.multiplyQuaternions(ob,G_),e.quaternion.copy(G_)),"Y"===e.name&&(G_.setFromAxisAngle(hb,Math.atan2(ib.x,ib.z)),G_.multiplyQuaternions(ob,G_),e.quaternion.copy(G_)),"Z"===e.name&&(G_.setFromAxisAngle(db,Math.atan2(ib.y,ib.x)),G_.multiplyQuaternions(ob,G_),e.quaternion.copy(G_))),e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material._color=e.material._color||e.material.color.clone(),e.material._opacity=e.material._opacity||e.material.opacity,e.material.color.copy(e.material._color),e.material.opacity=e.material._opacity,this.enabled&&this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t})))&&(e.material.color.setHex(16776960),e.material.opacity=1)):(e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(G_.setFromEuler(nb.set(0,0,0)),e.quaternion.copy(t).multiply(G_),Math.abs(ib.copy(ub).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(G_.setFromEuler(nb.set(0,0,Math.PI/2)),e.quaternion.copy(t).multiply(G_),Math.abs(ib.copy(hb).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(G_.setFromEuler(nb.set(0,Math.PI/2,0)),e.quaternion.copy(t).multiply(G_),Math.abs(ib.copy(db).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(G_.setFromEuler(nb.set(0,Math.PI/2,0)),ib.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(sb.lookAt(rb,ib,hb)),e.quaternion.multiply(G_),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),z_.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),z_.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(z_),e.visible=this.dragging):(e.quaternion.copy(t),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name))))}super.updateMatrixWorld(e)}}class vb extends fr{constructor(){super(new Pr(1e5,1e5,2,2),new Pi({visible:!1,wireframe:!0,side:g,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),pb.copy(ub).applyQuaternion("local"===t?this.worldQuaternion:ab),fb.copy(hb).applyQuaternion("local"===t?this.worldQuaternion:ab),gb.copy(db).applyQuaternion("local"===t?this.worldQuaternion:ab),ib.copy(fb),this.mode){case"translate":case"scale":switch(this.axis){case"X":ib.copy(this.eye).cross(pb),lb.copy(pb).cross(ib);break;case"Y":ib.copy(this.eye).cross(fb),lb.copy(fb).cross(ib);break;case"Z":ib.copy(this.eye).cross(gb),lb.copy(gb).cross(ib);break;case"XY":lb.copy(gb);break;case"YZ":lb.copy(pb);break;case"XZ":ib.copy(gb),lb.copy(fb);break;case"XYZ":case"E":lb.set(0,0,0)}break;default:lb.set(0,0,0)}0===lb.length()?this.quaternion.copy(this.cameraQuaternion):(cb.lookAt(z_.set(0,0,0),lb,ib),this.quaternion.setFromRotationMatrix(cb)),super.updateMatrixWorld(e)}}const _b=e=>{let{length:t,radius:n}=void 0===e?{}:e;t=void 0===t?1:t,n=void 0===n?1:n;const i=.4*t,r=new ql(0,.1*n,i,32,1),s=.6*t,o=.025*n,a=new ql(o,o,s,32,1);var l=new Jn;return l.setPosition(new yn(0,.5*s,0)),a.applyMatrix4(l),l.setPosition(new yn(0,s+.5*i,0)),r.applyMatrix4(l),Uf([r,a])},bb=(e,t,n)=>{if(e.current&&t){const i="function"==typeof t.r?t.r(n)/255:t.r/255,r="function"==typeof t.g?t.g(n)/255:t.g/255,s="function"==typeof t.b?t.b(n)/255:t.b/255,o="function"==typeof t.a?t.a(n):t.a;e.current.material.color.setRGB(i,r,s),e.current.material.opacity=o,e.current.material.transparent=1!==o}},yb=e=>{let t=null;return e.shape?("cube"===e.shape?t=(e=>{let{x:t,y:n,z:i}=void 0===e?{}:e;return t=void 0===t?1:t,n=void 0===n?1:n,i=void 0===i?1:i,new jf(t,n,i,2,.05)})(e.shapeParams):"cylinder"===e.shape?t=(e=>{let{radius:t,height:n}=void 0===e?{}:e;return t=void 0===t?.5:t,n=void 0===n?1:n,new ql(t,t,n,32,1,!1)})(e.shapeParams):"sphere"===e.shape?t=(e=>{let{radius:t}=void 0===e?{}:e;return t=void 0===t?.5:t,new Uc(t,32,32)})(e.shapeParams):"capsule"===e.shape?t=(e=>{let{radius:t,height:n}=void 0===e?{}:e;t=void 0===t?.5:t,n=void 0===n?1:n;const i=new ql(t,t,n,32,1,!0),r=new Uc(t,32,32,Math.PI,Math.PI),s=new Uc(t,32,32,Math.PI,Math.PI);var o=new Jn;o.makeRotationX(Math.PI/2),o.setPosition(0,n/2,0);var a=new Jn;return a.makeRotationX(-Math.PI/2),a.setPosition(0,-n/2,0),r.applyMatrix4(o),s.applyMatrix4(a),Uf([i,r,s])})(e.shapeParams):"arrow"===e.shape&&(t=_b(e.shapeParams)),[{geometry:t,type:"part"}]):[]};function Tb(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const r=(0,e.useRef)();return(0,e.useEffect)((()=>{n.forEach((e=>{!e||("function"==typeof e?e(r.current):e.current=r.current)}))}),[n]),r}function Eb(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!Object.is(e[n[i]],t[n[i]]))return!1;return!0}const Sb=(0,e.forwardRef)(((t,n)=>{let{objectKey:i,displayTfs:r,position:s,rotation:o,scale:a,ghost:l,highlightColor:c,children:u}=t;const h=Tb(n,(0,e.useRef)(null)),d=N_((0,e.useCallback)((e=>e.tfs[i]),[i]),Eb),p=N_((e=>e.clock));Tp((0,e.useCallback)((()=>{const e=1e3*p.getElapsed();h.current&&(h.current.position.set(s?s.x:"function"==typeof d.position.x?d.position.x(e):d.position.x,s?s.y:"function"==typeof d.position.y?d.position.y(e):d.position.y,s?s.z:"function"==typeof d.position.z?d.position.z(e):d.position.z),h.current.quaternion.set(o?o.x:"function"==typeof d.rotation.x?d.rotation.x(e):d.rotation.x,o?o.y:"function"==typeof d.rotation.y?d.rotation.y(e):d.rotation.y,o?o.z:"function"==typeof d.rotation.z?d.rotation.z(e):d.rotation.z,o?o.w:"function"==typeof d.rotation.w?d.rotation.w(e):d.rotation.w),h.current.scale.set(a?a.x:d.scale?"function"==typeof d.scale.x?d.scale.x(e):d.scale.x:0,a?a.y:d.scale?"function"==typeof d.scale.y?d.scale.y(e):d.scale.y:0,a?a.z:d.scale?"function"==typeof d.scale.z?d.scale.z(e):d.scale.z:0))}),[d,s,o,a,h,p]));const f=_b();return Od("group",{ref:h,dispose:null,up:[0,0,1],children:[r&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:f,material:l?F_(c):B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"".concat(i,"ArrowX")),Ld("mesh",{geometry:f,material:l?F_(c):B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"".concat(i,"ArrowY")),Ld("mesh",{geometry:f,material:l?F_(c):B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"".concat(i,"ArrowZ"))]}),u]})}));function wb(e){let{displayTfs:t,children:n}=e;const i=_b();return Od("group",{dispose:null,up:[0,0,1],children:[t&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:i,material:B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"$WorldArrowX"),Ld("mesh",{geometry:i,material:B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"$WorldArrowY"),Ld("mesh",{geometry:i,material:B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"$WorldArrowZ")]}),n]})}function xb(e){let{displayTfs:t,children:n}=e;const i=_b();return Od("group",{dispose:null,up:[0,0,1],children:[t&&Od(Ad,{children:[Ld("axesHelper",{size:1}),Ld("mesh",{geometry:i,material:B_(255,0,0,1),scale:[.2,.5,.2],rotation:[0,0,-Math.PI/2]},"$WorldArrowX"),Ld("mesh",{geometry:i,material:B_(0,255,0,1),scale:[.2,.5,.2],rotation:[0,Math.PI/2,0]},"$WorldArrowY"),Ld("mesh",{geometry:i,material:B_(0,0,255,1),scale:[.2,.5,.2],rotation:[Math.PI/2,0,0]},"$WorldArrowZ")]}),n]})}var Mb="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Ib=class extends yr{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{THREE_REVISION:r.replace(/\D+/g,""),MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new Ah(null),luminanceBuffer1:new Ah(null),minLuminance:new Ah(.01),deltaTime:new Ah(0),tau:new Ah(1)},extensions:{shaderTextureLOD:!0},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\nuniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));\n#if __VERSION__ < 300\nfloat l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;\n#else\nfloat l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;\n#endif\nl0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}",vertexShader:Mb}),this.toneMapped=!1}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}};function Cb(e,t){let n="texel";if(null!==e){const i=Number.parseInt(r);if(!(t&&i>=133&&135!==i&&e.format===ke&&e.type===me&&e.encoding===yt))switch(e.encoding){case yt:n="sRGBToLinear(texel)";break;case bt:n="texel";break;default:throw new Error("Unsupported encoding: ".concat(e.encoding))}}return n}var kb={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Rb={NONE:0,DEPTH:1,CONVOLUTION:2},Ab={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Lb={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Ob={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},Nb={DEFAULT:0,ESKIL:1},Db=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Pb=class extends yr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gn;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new gn),scale:new Ah(1),kernel:new Ah(0)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n}",vertexShader:"uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernelSize=Lb.MEDIUM}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return Db[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,.5*e,.5*t)}setSize(e,t){const n=1/e,i=1/t;this.uniforms.texelSize.value.set(n,i,.5*n,.5*i)}},$b=class extends yr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ah(null),opacity:new Ah(1)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:Mb}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},Bb=class extends yr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;super({name:"DepthComparisonMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ah(null),cameraNear:new Ah(.3),cameraFar:new Ah(1e3)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#include <clipping_planes_pars_fragment>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float cameraNear;uniform float cameraFar;varying float vViewZ;varying vec4 vProjTexCoord;void main(){\n#include <clipping_planes_fragment>\nvec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);\n#if DEPTH_PACKING == 3201\nfloat fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));\n#else\nfloat fragCoordZ=texture2D(depthBuffer,projTexCoord).r;\n#endif\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\n#else\nfloat viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\n#endif\nfloat depthTest=(-vViewZ>-viewZ)?1.0:0.0;gl_FragColor.rg=vec2(0.0,depthTest);}",vertexShader:"#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying float vViewZ;varying vec4 vProjTexCoord;void main(){\n#include <skinbase_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\nvViewZ=mvPosition.z;vProjTexCoord=gl_Position;\n#include <clipping_planes_vertex>\n}"}),this.toneMapped=!1,this.depthBuffer=e,this.depthPacking=Et,this.copyCameraSettings(t)}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et;this.depthBuffer=e,this.depthPacking=t}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Er?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Fb=class extends yr{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ah(null),normalBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\n#ifdef DOWNSAMPLE_NORMALS\nuniform lowp sampler2D normalBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[]=float[4](abs(c-samples[0]),abs(c-samples[1]),abs(c-samples[2]),abs(c-samples[3]));float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[]=float[4](readDepth(vUv0),readDepth(vUv1),readDepth(vUv2),readDepth(vUv3));int index=findBestDepth(d);\n#ifdef DOWNSAMPLE_NORMALS\nvec3 n[]=vec3[4](texture2D(normalBuffer,vUv0).rgb,texture2D(normalBuffer,vUv1).rgb,texture2D(normalBuffer,vUv2).rgb,texture2D(normalBuffer,vUv3).rgb);\n#else\nvec3 n[]=vec3[4](vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));\n#endif\ngl_FragColor=vec4(n[index],d[index]);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.depthBuffer=e,this.depthPacking=t}set normalBuffer(e){this.uniforms.normalBuffer.value=e,null!==e?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(e){this.normalBuffer=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Ub=class extends yr{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#define WEIGHT_INNER 0.125\n#define WEIGHT_OUTER 0.0555555\nvarying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;\n#include <encodings_fragment>\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},zb=class extends yr{constructor(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:r.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ah(null),depthBuffer:new Ah(null),resolution:new Ah(new Wt),texelSize:new Ah(new Wt),cameraNear:new Ah(.3),cameraFar:new Ah(1e3),aspect:new Ah(1),time:new Ah(0)},blending:m,depthWrite:!1,depthTest:!1,dithering:s}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){var t,n,i,r,s;return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#if DEPTH_PACKING == 3201\nuniform lowp sampler2D depthBuffer;\n#elif defined(GL_FRAGMENT_PRECISION_HIGH)\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(Ab.FRAGMENT_HEAD,null!=(t=e.get(Ab.FRAGMENT_HEAD))?t:"").replace(Ab.FRAGMENT_MAIN_UV,null!=(n=e.get(Ab.FRAGMENT_MAIN_UV))?n:"").replace(Ab.FRAGMENT_MAIN_IMAGE,null!=(i=e.get(Ab.FRAGMENT_MAIN_IMAGE))?i:""),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(Ab.VERTEX_HEAD,null!=(r=e.get(Ab.VERTEX_HEAD))?r:"").replace(Ab.VERTEX_MAIN_SUPPORT,null!=(s=e.get(Ab.VERTEX_MAIN_SUPPORT))?s:""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Er?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return Ab}},Hb=class extends yr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:r.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ah(null),threshold:new Ah(0),smoothing:new Ah(1),range:new Ah(null)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:Mb}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},Gb=class extends yr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wt;super({name:"OutlineMaterial",uniforms:{inputBuffer:new Ah(null),texelSize:new Ah(new Wt)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"uniform lowp sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)?vec2(d,0.0):vec2(0.0,d);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.uniforms.texelSize.value.set(e.x,e.y),this.uniforms.maskTexture=this.uniforms.inputBuffer}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Vb=class extends Pb{constructor(){let{kernelSize:e=Lb.MEDIUM,offset:t=0,rotation:n=0,focusArea:i=.4,feather:r=.3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.fragmentShader="#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform vec4 maskParams;varying vec2 vUv;varying vec2 vUv2;varying vec2 vOffset;float linearGradientMask(const in float x){return smoothstep(maskParams.x,maskParams.y,x)-smoothstep(maskParams.w,maskParams.z,x);}void main(){vec2 dUv=vOffset*(1.0-linearGradientMask(vUv2.y));vec4 sum=texture2D(inputBuffer,vec2(vUv.x-dUv.x,vUv.y+dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x+dUv.x,vUv.y+dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x+dUv.x,vUv.y-dUv.y));sum+=texture2D(inputBuffer,vec2(vUv.x-dUv.x,vUv.y-dUv.y));gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n}",this.vertexShader="uniform vec4 texelSize;uniform float kernel;uniform float scale;uniform float aspect;uniform vec2 rotation;varying vec2 vUv;varying vec2 vUv2;varying vec2 vOffset;void main(){vec2 uv=position.xy*0.5+0.5;vUv=uv;vUv2=(uv-0.5)*2.0*vec2(aspect,1.0);vUv2=vec2(dot(rotation,vUv2),dot(rotation,vec2(vUv2.y,-vUv2.x)));vOffset=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;gl_Position=vec4(position.xy,1.0,1.0);}",this.kernelSize=e,this.uniforms.aspect=new Ah(1),this.uniforms.rotation=new Ah(new Wt),this.uniforms.maskParams=new Ah(new gn),this._offset=t,this._focusArea=i,this._feather=r,this.rotation=n,this.updateParams()}updateParams(){const e=this.uniforms.maskParams.value,t=Math.max(this.focusArea,0),n=Math.max(t-this.feather,0);e.set(this.offset-t,this.offset-n,this.offset+t,this.offset+n)}get rotation(){return Math.acos(this.uniforms.rotation.value.x)}set rotation(e){this.uniforms.rotation.value.set(Math.cos(e),Math.sin(e))}get offset(){return this._offset}set offset(e){this._offset=e,this.updateParams()}get focusArea(){return this._focusArea}set focusArea(e){this._focusArea=e,this.updateParams()}get feather(){return this._feather}set feather(e){this._feather=e,this.updateParams()}setSize(e,t){super.setSize(e,t),this.uniforms.aspect.value=e/t}},Wb=class extends yr{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Ah(null),supportBuffer:new Ah(null),texelSize:new Ah(new Wt),radius:new Ah(.85)},blending:m,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;\n#else\nuniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;\n#endif\nuniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);\n#include <encodings_fragment>\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},jb=new Tr,Xb=null;var Yb=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ya,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jb;this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;null!==t&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new fr(function(){if(null===Xb){const e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Xb=new qi).setAttribute?(Xb.setAttribute("position",new Fi(e,3)),Xb.setAttribute("uv",new Fi(t,2))):(Xb.addAttribute("position",new Fi(e,3)),Xb.addAttribute("uv",new Fi(t,2)))}return Xb}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new ya),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,n,i,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof mn||t instanceof Di||t instanceof fn||t instanceof Yb)&&this[e].dispose()}}},Kb=class extends Yb{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new $b,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new mn(1,1,{minFilter:pe,magFilter:pe,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTarget.texture.type=n,n!==me?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},qb=class extends Yb{constructor(e){let{minLuminance:t=.01,adaptationRate:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("AdaptiveLuminancePass"),this.fullscreenMaterial=new Ib,this.needsSwap=!1,this.renderTargetPrevious=new mn(1,1,{minFilter:ue,magFilter:ue,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const i=this.fullscreenMaterial;i.luminanceBuffer0=this.renderTargetPrevious.texture,i.luminanceBuffer1=e,i.minLuminance=t,i.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new Kb(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,i,r){this.fullscreenMaterial.deltaTime=i,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}},Jb=class extends Yb{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,r){const s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Zb=new ln,Qb=class extends Yb{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,r){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=e.getClearAlpha(),l=null!==s,c=o>=0;l?(e.getClearColor(Zb),e.setClearColor(s,c?o:a)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Zb,a):c&&e.setClearAlpha(a)}},ey=-1,ty=class extends Lt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ey,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ey,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.baseSize=new Wt(1,1),this.preferredSize=new Wt(t,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new Wt,this.addEventListener("change",(()=>this.updateEffectiveSize())),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,i=this.scale;t.width!==ey?n.width=t.width:t.height!==ey?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*i),t.height!==ey?n.height=t.height:t.width!==ey?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*i)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(ey),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.baseSize.width!==e||this.baseSize.height!==t)&&(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferredSize.width!==e||this.preferredSize.height!==t)&&(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ey}},ny=!1,iy=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case g:t=this.materialsFlatShadedDoubleSide;break;case f:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case g:t=this.materialsDoubleSide;break;case f:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){const t=this.materials=[e.clone(),e.clone(),e.clone()];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=p;t[2].skinning=!0,this.materialsBackSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=f,n})),this.materialsDoubleSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=g,n})),this.materialsFlatShaded=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n})),this.materialsFlatShadedBackSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=f,n})),this.materialsFlatShadedDoubleSide=t.map((t=>{const n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=g,n}))}}render(e,t,n){const i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,ny){const i=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const e of i)e[0].material=e[1];this.meshCount!==i.size&&i.clear()}else{const i=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=i}e.shadowMap.enabled=i}disposeMaterials(){if(null!==this.material){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return ny}static set workaroundEnabled(e){ny=e}},ry=class extends Yb{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Qb,this.overrideMaterialManager=null===n?null:new iy(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new iy(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,r){const s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;null!==a&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,s,o):e.render(s,o),o.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},sy=class extends Yb{constructor(e,t){let{renderTarget:n,resolutionScale:i=1,width:r=ty.AUTO_SIZE,height:s=ty.AUTO_SIZE,resolutionX:o=r,resolutionY:a=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new ry(e,t,new ea({depthPacking:Et}));const l=this.renderPass;l.skipShadowMapUpdate=!0,l.ignoreBackground=!0;const c=l.getClearPass();c.overrideClearColor=new ln(16777215),c.overrideClearAlpha=1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new mn(1,1,{minFilter:ue,magFilter:ue}),this.renderTarget.texture.name="DepthPass.Target");const u=this.resolution=new ty(this,o,a,i);u.addEventListener("change",(e=>this.setSize(u.baseWidth,u.baseHeight)))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},oy=class extends Yb{constructor(){let{normalBuffer:e=null,resolutionScale:t=.5,width:n=ty.AUTO_SIZE,height:i=ty.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DepthDownsamplingPass");const o=new Fb;o.normalBuffer=e,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new mn(1,1,{minFilter:ue,magFilter:ue,depthBuffer:!1,type:Ee}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const a=this.resolution=new ty(this,r,s,t);a.addEventListener("change",(e=>this.setSize(a.baseWidth,a.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t}render(e,t,n,i,r){e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){const i=e.getContext();if(!i.getExtension("EXT_color_buffer_float")&&!i.getExtension("EXT_color_buffer_half_float"))throw new Error("Rendering to float texture is not supported.")}};function ay(e,t,n){for(const i of t){const t="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),r=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const e of n.entries())null!==e[1]&&n.set(e[0],e[1].replace(r,t))}}function ly(e,t,n){var i,r,s,o,a;let l=t.getFragmentShader(),c=t.getVertexShader();const u=void 0!==l&&/mainImage/.test(l),h=void 0!==l&&/mainUv/.test(l);if(n.attributes|=t.getAttributes(),void 0===l)throw new Error("Missing fragment shader (".concat(t.name,")"));if(h&&0!==(n.attributes&Rb.CONVOLUTION))throw new Error("Effects that transform UVs are incompatible with convolution effects (".concat(t.name,")"));if(!u&&!h)throw new Error("Could not find mainImage or mainUv function (".concat(t.name,")"));{const d=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,p=n.shaderParts;let f=null!=(i=p.get(Ab.FRAGMENT_HEAD))?i:"",g=null!=(r=p.get(Ab.FRAGMENT_MAIN_UV))?r:"",m=null!=(s=p.get(Ab.FRAGMENT_MAIN_IMAGE))?s:"",v=null!=(o=p.get(Ab.VERTEX_HEAD))?o:"",_=null!=(a=p.get(Ab.VERTEX_MAIN_SUPPORT))?a:"";const b=new Set,y=new Set;if(h&&(g+="\t".concat(e,"MainUv(UV);\n"),n.uvTransformation=!0),null!==c&&/mainSupport/.test(c)){const t=/mainSupport *\([\w\s]*?uv\s*?\)/.test(c);_+="\t".concat(e,"MainSupport("),_+=t?"vUv);\n":");\n";for(const e of c.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const t of e[1].split(/\s*,\s*/))n.varyings.add(t),b.add(t),y.add(t);for(const e of c.matchAll(d))y.add(e[1])}for(const e of l.matchAll(d))y.add(e[1]);for(const e of t.defines.keys())y.add(e.replace(/\([\w\s,]*\)/g,""));for(const e of t.uniforms.keys())y.add(e);y.delete("while"),y.delete("for"),y.delete("if"),t.uniforms.forEach(((t,i)=>n.uniforms.set(e+i.charAt(0).toUpperCase()+i.slice(1),t))),t.defines.forEach(((t,i)=>n.defines.set(e+i.charAt(0).toUpperCase()+i.slice(1),t)));const T=new Map([["fragment",l],["vertex",c]]);ay(e,y,n.defines),ay(e,y,T),l=T.get("fragment"),c=T.get("vertex");const E=t.blendMode;if(n.blendModes.set(E.blendFunction,E),u){null!==t.inputColorSpace&&t.inputColorSpace!==n.colorSpace&&(m+=t.inputColorSpace===yt?"color0 = LinearTosRGB(color0);\n\t":"color0 = sRGBToLinear(color0);\n\t"),null!==t.outputColorSpace?n.colorSpace=t.outputColorSpace:null!==t.inputColorSpace&&(n.colorSpace=t.inputColorSpace);const i=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;m+="".concat(e,"MainImage(color0, UV, "),0!==(n.attributes&Rb.DEPTH)&&i.test(l)&&(m+="depth, ",n.readDepth=!0),m+="color1);\n\t";const r=e+"BlendOpacity";n.uniforms.set(r,E.opacity),m+="color0 = blend".concat(E.blendFunction,"(color0, color1, ").concat(r,");\n\n\t"),f+="uniform float ".concat(r,";\n\n")}if(f+=l+"\n",null!==c&&(v+=c+"\n"),p.set(Ab.FRAGMENT_HEAD,f),p.set(Ab.FRAGMENT_MAIN_UV,g),p.set(Ab.FRAGMENT_MAIN_IMAGE,m),p.set(Ab.VERTEX_HEAD,v),p.set(Ab.VERTEX_MAIN_SUPPORT,_),null!==t.extensions)for(const e of t.extensions)n.extensions.add(e)}}var cy=class extends Yb{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];super("EffectPass"),this.fullscreenMaterial=new zb(null,null,null,e),this.listener=e=>this.handleEvent(e),this.effects=[],this.setEffects(n),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort(((e,t)=>t.attributes-e.attributes));for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new yy;let t=0;for(const o of this.effects)if(o.blendMode.blendFunction===kb.DST)e.attributes|=o.getAttributes()&Rb.DEPTH;else{if(0!==(e.attributes&o.getAttributes()&Rb.CONVOLUTION))throw new Error("Convolution effects cannot be merged (".concat(o.name,")"));ly("e"+t++,o,e)}let n=e.shaderParts.get(Ab.FRAGMENT_HEAD),i=e.shaderParts.get(Ab.FRAGMENT_MAIN_IMAGE),r=e.shaderParts.get(Ab.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const o of e.blendModes.values())n+=o.getShaderCode().replace(s,"blend".concat(o.blendFunction))+"\n";0!==(e.attributes&Rb.DEPTH)?(e.readDepth&&(i="float depth = readDepth(UV);\n\n\t"+i),this.needsDepthTexture=null===this.getDepthTexture()):this.needsDepthTexture=!1,e.colorSpace===yt&&(i+="color0 = sRGBToLinear(color0);\n\t"),e.uvTransformation?(r="vec2 transformedUv = vUv;\n"+r,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(Ab.FRAGMENT_HEAD,n),e.shaderParts.set(Ab.FRAGMENT_MAIN_IMAGE,i),e.shaderParts.set(Ab.FRAGMENT_MAIN_UV,r),e.shaderParts.forEach(((e,t,n)=>n.set(t,null==e?void 0:e.trim().replace(/^#/,"\n#")))),this.skipRendering=0===t,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,r){for(const s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=t.texture,r.time+=i*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const i of this.effects)i.initialize(e,t,n);this.updateMaterial(),void 0!==n&&n!==me&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},uy=class extends Yb{constructor(){let{kernelSize:e=Lb.MEDIUM,resolutionScale:t=.5,width:n=ty.AUTO_SIZE,height:i=ty.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new mn(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new ty(this,r,s,t);o.addEventListener("change",(e=>this.setSize(o.baseWidth,o.baseHeight))),this._blurMaterial=new Pb,this._blurMaterial.kernelSize=e,this.copyMaterial=new $b}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){const s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,u=c.kernelSequence;let h=t;this.fullscreenMaterial=c;for(let d=0,p=u.length;d<p;++d){const t=0===(1&d)?a:l;c.kernel=u[d],c.inputBuffer=h.texture,e.setRenderTarget(t),e.render(s,o),h=t}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(s,o)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==me?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===yt&&(this.renderTargetA.texture.encoding=yt,this.renderTargetB.texture.encoding=yt))}static get AUTO_SIZE(){return ty.AUTO_SIZE}},hy=class extends Yb{constructor(){let{renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:i=1,width:r=ty.AUTO_SIZE,height:s=ty.AUTO_SIZE,resolutionX:o=r,resolutionY:a=s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new Hb(n,t),this.needsSwap=!1,this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new mn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new ty(this,o,a,i);l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){void 0!==n&&n!==me&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},dy=class extends Yb{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Qb(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,r){const s=e.getContext(),o=e.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,u,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(a,l)):(e.setRenderTarget(t),e.render(a,l),e.setRenderTarget(n),e.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},py=class extends Yb{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new mn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Ub,this.upsamplingMaterial=new Wb,this.resolution=new Wt}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<e;++n){const e=t.clone();e.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(e)}this.upsamplingMipmaps.push(t);for(let n=1,i=e-1;n<i;++n){const e=t.clone();e.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(e)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,n,i,r){const{scene:s,camera:o}=this,{downsamplingMaterial:a,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:u}=this;let h=t;this.fullscreenMaterial=a;for(let d=0,p=c.length;d<p;++d){const t=c[d];a.setSize(h.width,h.height),a.inputBuffer=h.texture,e.setRenderTarget(t),e.render(s,o),h=t}this.fullscreenMaterial=l;for(let d=u.length-1;d>=0;--d){const t=u[d];l.setSize(h.width,h.height),l.inputBuffer=h.texture,l.supportBuffer=c[d].texture,e.setRenderTarget(t),e.render(s,o),h=t}}setSize(e,t){const n=this.resolution;n.set(e,t);let i=n.width,r=n.height;for(let s=0,o=this.downsamplingMipmaps.length;s<o;++s)i=Math.round(.5*i),r=Math.round(.5*r),this.downsamplingMipmaps[s].setSize(i,r),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(i,r)}initialize(e,t,n){if(void 0!==n){const t=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const e of t)e.texture.type=n;if(n!==me)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(e.outputEncoding===yt)for(const e of t)e.texture.encoding=yt}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}},fy=class extends Yb{constructor(e,t){let{renderTarget:n,resolutionScale:i=1,width:r=ty.AUTO_SIZE,height:s=ty.AUTO_SIZE,resolutionX:o=r,resolutionY:a=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("NormalPass"),this.needsSwap=!1,this.renderPass=new ry(e,t,new eu);const l=this.renderPass;l.ignoreBackground=!0,l.skipShadowMapUpdate=!0;const c=l.getClearPass();c.overrideClearColor=new ln(7829503),c.overrideClearAlpha=1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new mn(1,1,{minFilter:ue,magFilter:ue}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new ty(this,o,a,i);u.addEventListener("change",(e=>this.setSize(u.baseWidth,u.baseHeight)))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s,s)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},gy=class extends Yb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.input=t}setInput(e){this.input=e}render(e,t,n,i,r){const s=this.fullscreenMaterial.uniforms;null!==t&&void 0!==s&&void 0!==s[this.input]&&(s[this.input].value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){void 0!==n&&n!==me&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},my=class extends uy{constructor(){let{offset:e=0,rotation:t=0,focusArea:n=.4,feather:i=.3,kernelSize:r=Lb.MEDIUM,resolutionScale:s=.5,resolutionX:o=ty.AUTO_SIZE,resolutionY:a=ty.AUTO_SIZE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({kernelSize:r,resolutionScale:s,resolutionX:o,resolutionY:a}),this.blurMaterial=new Vb({kernelSize:r,offset:e,rotation:t,focusArea:n,feather:i})}},vy=.001,_y=class{constructor(){this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*vy}get fixedDelta(){return this._fixedDelta*vy}set fixedDelta(e){this._fixedDelta=1e3*e}get elapsed(){return this._elapsed*vy}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.autoReset=!1}},by=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=null,this.inputBuffer=this.createBuffer(t,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Kb,this.depthTexture=null,this.passes=[],this.timer=new _y,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){const t=e.getSize(new Wt),n=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===me&&e.outputEncoding===yt&&(this.inputBuffer.texture.encoding=yt,this.outputBuffer.texture.encoding=yt,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const r of this.passes)r.initialize(e,n,i)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&null!==i&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new da;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Oe,e.type=Me):e.type=Te,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i){const r=this.renderer,s=null===r?new Wt:r.getDrawingBufferSize(new Wt),o={minFilter:pe,magFilter:pe,stencilBuffer:t,depthBuffer:e,type:n},a=new mn(s.width,s.height,o);return i>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=i),n===me&&null!==r&&r.outputEncoding===yt&&(a.texture.encoding=yt),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new Wt),s=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(r.width,r.height),e.initialize(i,s,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){const t=this.createDepthTexture();for(e of n)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(-1!==n&&t.splice(n,1).length>0){if(null!==this.depthTexture){const n=(e,t)=>e||t.needsDepthTexture;t.reduce(n,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let i,r,s,o=this.inputBuffer,a=this.outputBuffer,l=!1;void 0===e&&(this.timer.update(),e=this.timer.delta);for(const c of this.passes)c.enabled&&(c.render(t,o,a,e,l),c.needsSwap&&(l&&(n.renderToScreen=c.renderToScreen,i=t.getContext(),r=t.state.buffers.stencil,r.setFunc(i.NOTEQUAL,1,4294967295),n.render(t,o,a,e,l),r.setFunc(i.EQUAL,1,4294967295)),s=o,o=a,a=s),c instanceof dy?l=!0:c instanceof Jb&&(l=!1))}setSize(e,t,n){const i=this.renderer,r=i.getSize(new Wt);(void 0===e||void 0===t)&&(e=r.width,t=r.height),(r.width!==e||r.height!==t)&&i.setSize(e,t,n);const s=i.getDrawingBufferSize(new Wt);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const o of this.passes)o.setSize(s.width,s.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},yy=class{constructor(){this.shaderParts=new Map([[Ab.FRAGMENT_HEAD,null],[Ab.FRAGMENT_MAIN_UV,null],[Ab.FRAGMENT_MAIN_IMAGE,null],[Ab.VERTEX_HEAD,null],[Ab.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Rb.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=bt}},Ty=class extends Set{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;super(),this.l=t,this.exclusive=!1,void 0!==e&&this.set(e)}get layer(){return this.l}set layer(e){const t=this.l;for(const n of this)n.layers.disable(t),n.layers.enable(e);this.l=e}getLayer(){return this.layer}setLayer(e){this.layer=e}isExclusive(){return this.exclusive}setExclusive(e){this.exclusive=e}clear(){const e=this.layer;for(const t of this)t.layers.disable(e);return super.clear()}set(e){this.clear();for(const t of e)this.add(t);return this}indexOf(e){return this.has(e)?0:-1}add(e){return this.exclusive?e.layers.set(this.layer):e.layers.enable(this.layer),super.add(e)}delete(e){return this.has(e)&&e.layers.disable(this.layer),super.delete(e)}toggle(e){let t;return this.has(e)?(this.delete(e),t=!1):(this.add(e),t=!0),t}setVisible(e){for(const t of this)e?t.layers.enable(0):t.layers.disable(0);return this}},Ey=new Map([[kb.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}"],[kb.ALPHA,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}"],[kb.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}"],[kb.COLOR,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.COLOR_BURN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}"],[kb.COLOR_DODGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}"],[kb.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}"],[kb.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}"],[kb.DIVIDE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}"],[kb.DST,null],[kb.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}"],[kb.HARD_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}"],[kb.HARD_MIX,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}"],[kb.HUE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.INVERT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}"],[kb.INVERT_RGB,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}"],[kb.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}"],[kb.LINEAR_BURN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}"],[kb.LINEAR_DODGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}"],[kb.LINEAR_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}"],[kb.LUMINOSITY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}"],[kb.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}"],[kb.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}"],[kb.OVERLAY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}"],[kb.PIN_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}"],[kb.REFLECT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}"],[kb.SATURATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}"],[kb.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}"],[kb.SOFT_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}"],[kb.SRC,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}"],[kb.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}"],[kb.VIVID_LIGHT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}"]]),Sy=class extends Lt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this._blendFunction=e,this.opacity=new Ah(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Ey.get(this.blendFunction)}},wy=class extends Lt{constructor(e,t){let{attributes:n=Rb.NONE,blendFunction:i=kb.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new Sy(i),this.blendMode.addEventListener("change",(e=>this.setChanged())),this._inputColorSpace=bt,this._outputColorSpace=null}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof mn||t instanceof Di||t instanceof fn||t instanceof Yb)&&this[e].dispose()}}};new yn,new Jn;new ln;var xy=class extends wy{constructor(e,t){let{blendFunction:n=kb.SCREEN,patternTexture:i=null,patternScale:r=1,edgeStrength:s=1,pulseSpeed:o=0,visibleEdgeColor:a=16777215,hiddenEdgeColor:l=2230538,kernelSize:c=Lb.VERY_SMALL,blur:u=!1,xRay:h=!0,multisampling:d=0,resolutionScale:p=.5,width:f=ty.AUTO_SIZE,height:g=ty.AUTO_SIZE,resolutionX:m=f,resolutionY:v=g}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("OutlineEffect","uniform lowp sampler2D edgeTexture;uniform lowp sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;\n#ifdef USE_PATTERN\nuniform lowp sampler2D patternTexture;varying vec2 vUvPattern;\n#endif\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;\n#ifndef X_RAY\nedge.y=0.0;\n#endif\nedge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;\n#ifdef USE_PATTERN\nvec4 patternColor=texelToLinear(texture2D(patternTexture,vUvPattern));\n#ifdef X_RAY\nfloat hiddenFactor=0.5;\n#else\nfloat hiddenFactor=0.0;\n#endif\nvisibilityFactor=(1.0-mask.y>0.0)?1.0:hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;\n#endif\nfloat alpha=max(max(edge.x,edge.y),visibilityFactor);\n#ifdef ALPHA\noutputColor=vec4(color,alpha);\n#else\noutputColor=vec4(color,max(alpha,inputColor.a));\n#endif\n}",{uniforms:new Map([["maskTexture",new Ah(null)],["edgeTexture",new Ah(null)],["edgeStrength",new Ah(s)],["visibleEdgeColor",new Ah(new ln(a))],["hiddenEdgeColor",new Ah(new ln(l))],["pulse",new Ah(1)],["patternScale",new Ah(r)],["patternTexture",new Ah(null)]])}),this.blendMode.addEventListener("change",(e=>{this.blendMode.getBlendFunction()===kb.ALPHA?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA"),this.setChanged()})),this.blendMode.setBlendFunction(n),this.patternTexture=i,this.xRay=h,this.scene=e,this.camera=t,this.renderTargetMask=new mn(1,1),this.renderTargetMask.samples=d,this.renderTargetMask.texture.name="Outline.Mask",this.uniforms.get("maskTexture").value=this.renderTargetMask.texture,this.renderTargetOutline=new mn(1,1,{depthBuffer:!1}),this.renderTargetOutline.texture.name="Outline.Edges",this.uniforms.get("edgeTexture").value=this.renderTargetOutline.texture,this.clearPass=new Qb,this.clearPass.overrideClearColor=new ln(0),this.clearPass.overrideClearAlpha=1,this.depthPass=new sy(e,t),this.maskPass=new ry(e,t,new Bb(this.depthPass.texture,t));const _=this.maskPass.clearPass;_.overrideClearColor=new ln(16777215),_.overrideClearAlpha=1,this.blurPass=new uy({resolutionScale:p,resolutionX:m,resolutionY:v,kernelSize:c}),this.blurPass.enabled=u;const b=this.blurPass.resolution;b.addEventListener("change",(e=>this.setSize(b.baseWidth,b.baseHeight))),this.outlinePass=new gy(new Gb);this.outlinePass.fullscreenMaterial.inputBuffer=this.renderTargetMask.texture,this.time=0,this.active=!1,this.selection=new Ty,this.selection.layer=10,this.pulseSpeed=o}set mainScene(e){this.scene=e,this.depthPass.mainScene=e,this.maskPass.mainScene=e}set mainCamera(e){this.camera=e,this.depthPass.mainCamera=e,this.maskPass.mainCamera=e,this.maskPass.overrideMaterial.copyCameraSettings(e)}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.getResolution()}get multisampling(){return this.renderTargetMask.samples}set multisampling(e){this.renderTargetMask.samples=e,this.renderTargetMask.dispose()}get patternScale(){return this.uniforms.get("patternScale").value}set patternScale(e){this.uniforms.get("patternScale").value=e}get edgeStrength(){return this.uniforms.get("edgeStrength").value}set edgeStrength(e){this.uniforms.get("edgeStrength").value=e}get visibleEdgeColor(){return this.uniforms.get("visibleEdgeColor").value}set visibleEdgeColor(e){this.uniforms.get("visibleEdgeColor").value=e}get hiddenEdgeColor(){return this.uniforms.get("hiddenEdgeColor").value}set hiddenEdgeColor(e){this.uniforms.get("hiddenEdgeColor").value=e}getBlurPass(){return this.blurPass}getSelection(){return this.selection}getPulseSpeed(){return this.pulseSpeed}setPulseSpeed(e){this.pulseSpeed=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get selectionLayer(){return this.selection.layer}set selectionLayer(e){this.selection.layer=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get blur(){return this.blurPass.enabled}set blur(e){this.blurPass.enabled=e}get xRay(){return this.defines.has("X_RAY")}set xRay(e){this.xRay!==e&&(e?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY"),this.setChanged())}isXRayEnabled(){return this.xRay}setXRayEnabled(e){this.xRay=e}get patternTexture(){return this.uniforms.get("patternTexture").value}set patternTexture(e){if(null!==e?(e.wrapS=e.wrapT=ae,this.defines.set("USE_PATTERN","1"),this.setVertexShader("uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}")):(this.defines.delete("USE_PATTERN"),this.setVertexShader(null)),null!==this.renderer){const t=Cb(e,this.renderer.capabilities.isWebGL2);this.defines.set("texelToLinear(texel)",t)}this.uniforms.get("patternTexture").value=e,this.setChanged()}setPatternTexture(e){this.patternTexture=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}setSelection(e){return this.selection.set(e),this}clearSelection(){return this.selection.clear(),this}selectObject(e){return this.selection.add(e),this}deselectObject(e){return this.selection.delete(e),this}update(e,t,n){const i=this.scene,r=this.camera,s=this.selection,o=this.uniforms.get("pulse"),a=i.background,l=r.layers.mask;s.size>0?(i.background=null,o.value=1,this.pulseSpeed>0&&(o.value=.375*Math.cos(this.time*this.pulseSpeed*10)+.625),this.active=!0,this.time+=n,s.setVisible(!1),this.depthPass.render(e),s.setVisible(!0),r.layers.set(s.layer),this.maskPass.render(e,this.renderTargetMask),r.layers.mask=l,i.background=a,this.outlinePass.render(e,null,this.renderTargetOutline),this.blurPass.enabled&&this.blurPass.render(e,this.renderTargetOutline,this.renderTargetOutline)):this.active&&(this.clearPass.render(e,this.renderTargetOutline),this.active=!1)}setSize(e,t){this.blurPass.setSize(e,t),this.renderTargetMask.setSize(e,t);const n=this.resolution;n.setBaseSize(e,t);const i=n.width,r=n.height;this.depthPass.setSize(i,r),this.renderTargetOutline.setSize(i,r),this.outlinePass.fullscreenMaterial.setSize(i,r)}initialize(e,t,n){const i=Cb(this.patternTexture,e.capabilities.isWebGL2);this.defines.set("texelToLinear(texel)",i),this.blurPass.initialize(e,t,me),void 0!==n&&(this.depthPass.initialize(e,t,n),this.maskPass.initialize(e,t,n),this.outlinePass.initialize(e,t,n))}},My=.5*Math.PI,Iy=new yn,Cy=new yn;let ky;const Ry=e=>(e=>!!e.current)(e)?e.current:e,Ay=function(t,n){return void 0===n&&(n=kb.NORMAL),(0,e.forwardRef)((function(i,r){let{blendFunction:s,opacity:o,...a}=i;const l=yp((e=>e.invalidate)),c=(0,e.useMemo)((()=>new t(a)),[a]);return(0,e.useLayoutEffect)((()=>{c.blendMode.blendFunction=s||0===s?s:n,void 0!==o&&(c.blendMode.opacity.value=o),l()}),[s,c.blendMode,o]),Ld("primitive",{ref:r,object:c,dispose:null})}))};Ay(class extends wy{constructor(){let{blendFunction:e=kb.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,mipmapBlur:i=!1,intensity:r=1,radius:s=.85,levels:o=8,kernelSize:a=Lb.LARGE,resolutionScale:l=.5,width:c=ty.AUTO_SIZE,height:u=ty.AUTO_SIZE,resolutionX:h=c,resolutionY:d=u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}",{blendFunction:e,uniforms:new Map([["map",new Ah(null)],["intensity",new Ah(r)]])}),this.renderTarget=new mn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new uy({kernelSize:a}),this.luminancePass=new hy({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new py,this.mipmapBlurPass.enabled=i,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=i?this.mipmapBlurPass.texture:this.renderTarget.texture;const p=this.resolution=new ty(this,h,d,l);p.addEventListener("change",(e=>this.setSize(p.baseWidth,p.baseHeight)))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const i=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,r.renderTarget):this.blurPass.render(e,r.renderTarget,i)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,i)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,n){this.blurPass.initialize(e,t,n),this.luminancePass.initialize(e,t,n),this.mipmapBlurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},kb.ADD),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,brightness:t=0,contrast:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(color+vec3(0.5),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new Ah(t)],["contrast",new Ah(n)]])}),this.inputColorSpace=yt}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}}),Ay(class extends wy{constructor(){let{blendFunction:e,bits:t=16}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ColorDepthEffect","uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}",{blendFunction:e,uniforms:new Map([["factor",new Ah(1)]])}),this.bits=0,this.bitDepth=t}get bitDepth(){return this.bits}set bitDepth(e){this.bits=e,this.uniforms.get("factor").value=Math.pow(2,e/3)}getBitDepth(){return this.bitDepth}setBitDepth(e){this.bitDepth=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,inverted:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DepthEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\n#ifdef INVERTED\nvec3 color=vec3(1.0-depth);\n#else\nvec3 color=vec3(depth);\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,attributes:Rb.DEPTH}),this.inverted=t}get inverted(){return this.defines.has("INVERTED")}set inverted(e){this.inverted!==e&&(e?this.defines.set("INVERTED","1"):this.defines.delete("INVERTED"),this.setChanged())}isInverted(){return this.inverted}setInverted(e){this.inverted=e}});const Ly=(0,e.createContext)(null),Oy=e.memo((0,e.forwardRef)(((t,n)=>{let{children:i,camera:r,scene:s,resolutionScale:o,enabled:a=!0,renderPriority:l=1,autoClear:c=!0,depthBuffer:u,disableNormalPass:h,stencilBuffer:d,multisampling:p=8,frameBufferType:f=Se}=t;const{gl:g,scene:m,camera:v,size:_}=yp();s=s||m,r=r||v;const[b,y,T]=(0,e.useMemo)((()=>{const e=function(){if(void 0!==ky)return ky;try{var e;let t;const n=document.createElement("canvas");return ky=!(!window.WebGL2RenderingContext||!(t=n.getContext("webgl2"))),t&&(null===(e=t.getExtension("WEBGL_lose_context"))||void 0===e||e.loseContext()),ky}catch{return ky=!1}}(),t=new by(g,{depthBuffer:u,stencilBuffer:d,multisampling:p>0&&e?p:0,frameBufferType:f});t.addPass(new ry(s,r));let n=null,i=null;return h||(i=new fy(s,r),i.enabled=!1,t.addPass(i),void 0!==o&&e&&(n=new oy({normalBuffer:i.texture,resolutionScale:o}),n.enabled=!1,t.addPass(n))),[t,i,n]}),[r,g,u,d,p,f,s,h,o]);(0,e.useEffect)((()=>null==b?void 0:b.setSize(_.width,_.height)),[b,_]),Tp(((e,t)=>{a&&(g.autoClear=c,b.render(t))}),a?l:0);const E=(0,e.useRef)(null);(0,e.useLayoutEffect)((()=>{let e;return E.current&&E.current.__r3f&&b&&(e=new cy(r,...E.current.__r3f.objects),e.renderToScreen=!0,b.addPass(e),y&&(y.enabled=!0),T&&(T.enabled=!0)),()=>{e&&(null==b||b.removePass(e)),y&&(y.enabled=!1),T&&(T.enabled=!1)}}),[b,i,r,y,T]);const S=(0,e.useMemo)((()=>({composer:b,normalPass:y,downSamplingPass:T,resolutionScale:o,camera:r,scene:s})),[b,y,T,o,r,s]);return(0,e.useImperativeHandle)(n,(()=>b),[b]),Ld(Ly.Provider,{value:S,children:Ld("group",{ref:E,children:i})})})));Ay(class extends wy{constructor(){let{blendFunction:e,angle:t=.5*Math.PI,scale:n=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("DotScreenEffect","uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}",{blendFunction:e,uniforms:new Map([["angle",new Ah(new Wt)],["scale",new Ah(n)]])}),this.angle=t}get angle(){return Math.acos(this.uniforms.get("angle").value.y)}set angle(e){this.uniforms.get("angle").value.set(Math.sin(e),Math.cos(e))}getAngle(){return this.angle}setAngle(e){this.angle=e}get scale(){return this.uniforms.get("scale").value}set scale(e){this.uniforms.get("scale").value=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,hue:t=0,saturation:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new Ah(new yn)],["saturation",new Ah(n)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){const e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){const t=Math.sin(e),n=Math.cos(e);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},kb.COLOR_DODGE);const Ny=(0,e.createContext)(null);function Dy(t){let{children:n,enabled:i=!0}=t;const[r,s]=(0,e.useState)([]),o=(0,e.useMemo)((()=>({selected:r,select:s,enabled:i})),[r,s,i]);return e.createElement(Ny.Provider,{value:o},n)}function Py(t){let{enabled:n=!1,children:i,...r}=t;const s=(0,e.useRef)(null),o=(0,e.useContext)(Ny);return(0,e.useEffect)((()=>{if(o&&n){let e=!1;const t=[];if(s.current.traverse((n=>{"Mesh"===n.type&&t.push(n),-1===o.selected.indexOf(n)&&(e=!0)})),e)return o.select((e=>[...e,...t])),()=>{o.select((e=>e.filter((e=>!t.includes(e)))))}}}),[n,i]),Ld("group",{ref:s,...r,children:i})}const $y=(0,e.forwardRef)((function(t,n){let{selection:i=[],selectionLayer:r=10,blendFunction:s,patternTexture:o,edgeStrength:a,pulseSpeed:l,visibleEdgeColor:c,hiddenEdgeColor:u,width:h,height:d,kernelSize:p,blur:f,xRay:g,...m}=t;const v=yp((e=>e.invalidate)),{scene:_,camera:b}=(0,e.useContext)(Ly),y=(0,e.useMemo)((()=>new xy(_,b,{blendFunction:s,patternTexture:o,edgeStrength:a,pulseSpeed:l,visibleEdgeColor:c,hiddenEdgeColor:u,width:h,height:d,kernelSize:p,blur:f,xRay:g,...m})),[s,f,b,a,d,u,p,o,l,_,c,h,g]),T=(0,e.useContext)(Ny);return(0,e.useEffect)((()=>{if(!T&&i)return y.selection.set(Array.isArray(i)?i.map(Ry):[Ry(i)]),v(),()=>{y.selection.clear(),v()}}),[y,i,T]),(0,e.useEffect)((()=>{y.selectionLayer=r,v()}),[y,r]),(0,e.useRef)(),(0,e.useEffect)((()=>{var e;if(T&&T.enabled&&(null!=(e=T.selected)&&e.length))return y.selection.set(T.selected),v(),()=>{y.selection.clear(),v()}}),[T]),Ld("primitive",{ref:n,object:y})}));Ay(class extends wy{constructor(){let{blendFunction:e=kb.OVERLAY,density:t=1.25,scrollSpeed:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ScanlineEffect","uniform float count;\n#ifdef SCROLL\nuniform float scrollSpeed;\n#endif\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float y=uv.y;\n#ifdef SCROLL\ny+=time*scrollSpeed;\n#endif\nvec2 sl=vec2(sin(y*count),cos(y*count));outputColor=vec4(sl.xyx,inputColor.a);}",{blendFunction:e,uniforms:new Map([["count",new Ah(0)],["scrollSpeed",new Ah(0)]])}),this.resolution=new Wt,this.d=t,this.scrollSpeed=n}get density(){return this.d}set density(e){this.d=e,this.setSize(this.resolution.width,this.resolution.height)}getDensity(){return this.density}setDensity(e){this.density=e}get scrollSpeed(){return this.uniforms.get("scrollSpeed").value}set scrollSpeed(e){this.uniforms.get("scrollSpeed").value=e,0===e?this.defines.delete("SCROLL")&&this.setChanged():this.defines.has("SCROLL")||(this.defines.set("SCROLL","1"),this.setChanged())}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("count").value=Math.round(t*this.density)}},kb.OVERLAY),Ay(class extends wy{constructor(){let{blendFunction:e,intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SepiaEffect","uniform vec3 weightsR;uniform vec3 weightsG;uniform vec3 weightsB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,weightsR),dot(inputColor.rgb,weightsG),dot(inputColor.rgb,weightsB));outputColor=vec4(color,inputColor.a);}",{blendFunction:e,uniforms:new Map([["weightsR",new Ah(new yn(.393,.769,.189))],["weightsG",new Ah(new yn(.349,.686,.168))],["weightsB",new Ah(new yn(.272,.534,.131))]])})}get intensity(){return this.blendMode.opacity.value}set intensity(e){this.blendMode.opacity.value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}get weightsR(){return this.uniforms.get("weightsR").value}get weightsG(){return this.uniforms.get("weightsG").value}get weightsB(){return this.uniforms.get("weightsB").value}}),Ay(class extends wy{constructor(){let{blendFunction:e=kb.SRC,adaptive:t=!0,mode:n=(t?Ob.REINHARD2_ADAPTIVE:Ob.REINHARD2),resolution:i=256,maxLuminance:r=16,whitePoint:s=r,middleGrey:o=.6,minLuminance:a=.01,averageLuminance:l=1,adaptationRate:c=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ToneMappingEffect","#include <tonemapping_pars_fragment>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\nuniform lowp sampler2D luminanceBuffer;uniform float whitePoint;uniform float middleGrey;\n#if TONE_MAPPING_MODE != 2\nuniform float averageLuminance;\n#endif\nvec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=luminance(color);\n#if TONE_MAPPING_MODE == 2\nfloat lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));\n#else\nfloat lumAvg=averageLuminance;\n#endif\nfloat lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){\n#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2\noutputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);\n#else\noutputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);\n#endif\n}",{blendFunction:e,uniforms:new Map([["luminanceBuffer",new Ah(null)],["maxLuminance",new Ah(r)],["whitePoint",new Ah(s)],["middleGrey",new Ah(o)],["averageLuminance",new Ah(l)]])}),this.renderTargetLuminance=new mn(1,1,{minFilter:ge,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new hy({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new qb(this.luminancePass.texture,{minLuminance:a,adaptationRate:c}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=i,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case Ob.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case Ob.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case Ob.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel")}this.adaptiveLuminancePass.enabled=e===Ob.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===Ob.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?Ob.REINHARD2_ADAPTIVE:Ob.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}}),Ay(class extends wy{constructor(){let{blendFunction:e,technique:t=Nb.DEFAULT,eskil:n=!1,offset:i=.5,darkness:r=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ah(i)],["darkness",new Ah(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Nb.ESKIL}set eskil(e){this.technique=e?Nb.ESKIL:Nb.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}}),Ay(class extends wy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yn,{speed:n=2,maxRadius:i=1,waveSize:r=.2,amplitude:s=.05}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("ShockWaveEffect","uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}",{vertexShader:"uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}",uniforms:new Map([["active",new Ah(!1)],["center",new Ah(new Wt(.5,.5))],["cameraDistance",new Ah(1)],["size",new Ah(1)],["radius",new Ah(-r)],["maxRadius",new Ah(i)],["waveSize",new Ah(r)],["amplitude",new Ah(s)]])}),this.position=t,this.speed=n,this.camera=e,this.screenPosition=this.uniforms.get("center").value,this.time=0,this.active=!1}set mainCamera(e){this.camera=e}get amplitude(){return this.uniforms.get("amplitude").value}set amplitude(e){this.uniforms.get("amplitude").value=e}get waveSize(){return this.uniforms.get("waveSize").value}set waveSize(e){this.uniforms.get("waveSize").value=e}get maxRadius(){return this.uniforms.get("maxRadius").value}set maxRadius(e){this.uniforms.get("maxRadius").value=e}get epicenter(){return this.position}set epicenter(e){this.position=e}getPosition(){return this.position}setPosition(e){this.position=e}getSpeed(){return this.speed}setSpeed(e){this.speed=e}explode(){this.time=0,this.active=!0,this.uniforms.get("active").value=!0}update(e,t,n){const i=this.position,r=this.camera,s=this.uniforms,o=s.get("active");if(this.active){const e=s.get("waveSize").value;r.getWorldDirection(Iy),Cy.copy(r.position).sub(i),o.value=Iy.angleTo(Cy)>My,o.value&&(s.get("cameraDistance").value=r.position.distanceTo(i),Iy.copy(i).project(r),this.screenPosition.set(.5*(Iy.x+1),.5*(Iy.y+1))),this.time+=n*this.speed;const t=this.time-e;s.get("radius").value=t,t>=2*(s.get("maxRadius").value+e)&&(this.active=!1,o.value=!1)}}}),Ay(class extends wy{constructor(){let{blendFunction:e,offset:t=0,rotation:n=0,focusArea:i=.4,feather:r=.3,kernelSize:s=Lb.MEDIUM,resolutionScale:o=.5,resolutionX:a=ty.AUTO_SIZE,resolutionY:l=ty.AUTO_SIZE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("TiltShiftEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform vec2 maskParams;varying vec2 vUv2;float linearGradientMask(const in float x){return step(maskParams.x,x)-step(maskParams.y,x);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float mask=linearGradientMask(vUv2.y);vec4 texel=texture2D(map,uv);outputColor=mix(texel,inputColor,mask);}",{vertexShader:"uniform vec2 rotation;varying vec2 vUv2;void mainSupport(const in vec2 uv){vUv2=(uv-0.5)*2.0*vec2(aspect,1.0);vUv2=vec2(dot(rotation,vUv2),dot(rotation,vec2(vUv2.y,-vUv2.x)));}",blendFunction:e,uniforms:new Map([["rotation",new Ah(new Wt)],["maskParams",new Ah(new Wt)],["map",new Ah(null)]])}),this._offset=t,this._focusArea=i,this._feather=r,this.renderTarget=new mn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="TiltShift.Target",this.uniforms.get("map").value=this.renderTarget.texture,this.blurPass=new my({kernelSize:s,resolutionScale:o,resolutionX:a,resolutionY:l,offset:t,rotation:n,focusArea:i,feather:r});const c=this.resolution=new ty(this,a,l,o);c.addEventListener("change",(e=>this.setSize(c.baseWidth,c.baseHeight))),this.rotation=n,this.updateParams()}updateParams(){const e=this.uniforms.get("maskParams").value,t=Math.max(this.focusArea-this.feather,0);e.set(this.offset-t,this.offset+t)}get rotation(){return Math.acos(this.uniforms.get("rotation").value.x)}set rotation(e){this.uniforms.get("rotation").value.set(Math.cos(e),Math.sin(e)),this.blurPass.blurMaterial.rotation=e}get offset(){return this._offset}set offset(e){this._offset=e,this.blurPass.blurMaterial.offset=e,this.updateParams()}get focusArea(){return this._focusArea}set focusArea(e){this._focusArea=e,this.blurPass.blurMaterial.focusArea=e,this.updateParams()}get feather(){return this._feather}set feather(e){this._feather=e,this.blurPass.blurMaterial.feather=e,this.updateParams()}get bias(){return 0}set bias(e){}update(e,t,n){this.blurPass.render(e,t,this.renderTarget)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n)}initialize(e,t,n){this.blurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===yt&&(this.renderTarget.texture.encoding=yt))}},kb.ADD);const By=["cube","cylinder","sphere","capsule","arrow"],Fy=(0,e.createContext)(),Uy=e=>{let{meshes:t,children:n}=e;return Ld(Fy.Provider,{value:t,children:n})},zy=(0,e.memo)((0,e.forwardRef)(((t,n)=>{let{objectKey:i,highlightColor:r,position:s,rotation:o,scale:a,ghost:l}=t;const c=Tb(n,(0,e.useRef)(null)),u=N_((e=>e.onClick),Eb),h=N_((e=>e.onPointerOver),Eb),d=N_((e=>e.onPointerOut),Eb),p=N_((e=>e.clock)),f=N_((0,e.useCallback)((e=>e.items[i]),[i]),Eb),g=(t=>{const n=(0,e.useContext)(Fy)[t.shape];return By.includes(t.shape)?yb(t):n&&"function"==typeof n?n():(console.warn("Shape not loaded: ".concat(t.shape," (reading property 'shape' of item)"),t),[])})(f);return Tp((0,e.useCallback)((()=>{const e=1e3*p.getElapsed();c.current&&(c.current.position.set(s?s.x:"function"==typeof f.position.x?f.position.x(e):f.position.x,s?s.y:"function"==typeof f.position.y?f.position.y(e):f.position.y,s?s.z:"function"==typeof f.position.z?f.position.z(e):f.position.z),c.current.quaternion.set(o?o.x:"function"==typeof f.rotation.x?f.rotation.x(e):f.rotation.x,o?o.y:"function"==typeof f.rotation.y?f.rotation.y(e):f.rotation.y,o?o.z:"function"==typeof f.rotation.z?f.rotation.z(e):f.rotation.z,o?o.w:"function"==typeof f.rotation.w?f.rotation.w(e):f.rotation.w),c.current.scale.set(a?a.x:"function"==typeof f.scale.x?f.scale.x(e):f.scale.x,a?a.y:"function"==typeof f.scale.y?f.scale.y(e):f.scale.y,a?a.z:"function"==typeof f.scale.z?f.scale.z(e):f.scale.z),c.current.visible="function"==typeof f.hidden?!f.hidden(e):!f.hidden)}),[f,s,o,a,c,p])),Ld(Py,{enabled:f.highlighted,children:Od("group",{ref:c,up:[0,0,1],children:[Ld("group",{up:[0,0,1],rotation:[Math.PI/2,0,0],onPointerDown:e=>{u(i,!c.current.visible,{local:{position:c.current.position,rotation:c.current.quaternion},world:{position:c.current.getWorldPosition(new yn),rotation:c.current.getWorldQuaternion(new bn)}},e)},onPointerOver:e=>{h(i,!c.current.visible,e)},onPointerOut:e=>{d(i,!c.current.visible,e)},children:g.map(((e,t)=>Ld(Gy,{idx:t,groupOrPart:e,objectKey:i,ghost:l,highlightColor:r},t)))}),f.showName&&Ld(Mf,{distanceFactor:3,position:[0,0,.2],children:Ld("div",{style:{opacity:.75,borderRadius:2,backgroundColor:"lightgrey",padding:5,userSelect:"none"},children:f.name})})]})})}))),Hy=(0,e.memo)((t=>{let{part:n,objectKey:i,ghost:r,highlightColor:s}=t;const o=N_((0,e.useCallback)((e=>e.items[i].wireframe),[i])),a=N_((0,e.useCallback)((e=>e.items[i].color),[i])),l=void 0!==a,c=(0,e.useRef)(),u=(0,e.useRef)(),h=N_((e=>e.clock));return Tp((0,e.useCallback)((()=>{const e=1e3*h.getElapsed();r||(bb(u,a,e),bb(c,a,e))}),[r,c,u,h,a])),r?Ld("mesh",{ref:u,geometry:n.geometry,material:F_(s),scale:n.scale,castShadow:!1,receiveShadow:!1},"B"):l?Od("group",{up:[0,0,1],children:[Ld("mesh",{ref:u,geometry:n.geometry,scale:n.scale,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,wireframe:o,attach:"material",opacity:1,side:f})},"B"),Ld("mesh",{ref:c,geometry:n.geometry,scale:n.scale,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,attach:"material",wireframe:o,opacity:1,side:p})},"F")]}):Ld(Ad,{children:Ld("mesh",{ref:c,geometry:n.geometry,material:n.material,scale:n.scale,castShadow:!0,receiveShadow:!0,wireframe:o},"I")})})),Gy=(0,e.memo)((e=>{let{idx:t,groupOrPart:n,ghost:i,objectKey:r,highlightColor:s}=e;return"group"===n.type?Ld("group",{up:[0,0,1],position:n.position,rotation:n.rotation,scale:n.scale,children:n.children.map(((e,t)=>Ld(Gy,{idx:t,groupOrPart:e,objectKey:r,ghost:i,highlightColor:s},t)))},t):Ld(Hy,{part:n,objectKey:r,highlightColor:s,ghost:i},t)})),Vy=(0,e.forwardRef)(((t,n)=>{let{objectKey:i}=t;const r=Tb(n,(0,e.useRef)(null)),{vertices:s,width:o,hidden:a}=N_((0,e.useCallback)((e=>({vertices:e.lines[i].vertices,width:e.lines[i].width,hidden:e.lines[i].hidden})),[i]),Eb);return s.length<=1?null:Ld(_g,{ref:r,visible:!a,points:s.map((e=>[e.position.x,e.position.y,e.position.z])),color:"white",vertexColors:s.map((e=>[e.color.r/255,e.color.g/255,e.color.b/255])),lineWidth:o})})),Wy=(0,e.forwardRef)(((t,n)=>{let{objectKey:i}=t;const r=Tb(n,(0,e.useRef)(null)),s=N_((e=>e.onClick),Eb),o=N_((e=>e.onPointerOver),Eb),a=N_((e=>e.onPointerOut),Eb),l=N_((0,e.useCallback)((e=>e.hulls[i]),[i]),Eb),c=N_((0,e.useCallback)((e=>e.hulls[i].vertices),[i]),Eb),u=N_((e=>e.clock)),h=(0,e.useRef)(),d=(0,e.useRef)(),g="function"==typeof c?c(0):c,m=new Bf(g.map((e=>new yn(e.x,e.y,e.z))));return Tp((0,e.useCallback)((()=>{const e=1e3*u.getElapsed();bb(d,l.color,e),bb(h,l.color,e);const t="function"==typeof c?c(e):c;if(t!==g){const e=new Bf(t.map((e=>new yn(e.x,e.y,e.z))));h.current.geometry=e,d.current.geometry=e}const n="function"==typeof l.hidden?!l.hidden(e):!l.hidden;h.current.visible=n,d.current.visible=n}),[h,d,g,l,u,c])),Ld(Py,{enabled:l.highlighted,children:Od("group",{ref:r,up:[0,0,1],children:[Od("group",{up:[0,0,1],onPointerDown:e=>{s(i,h.current.visible,e)},onPointerOver:e=>{o(i,h.current.visible,e)},onPointerOut:e=>{a(i,h.current.visible,e)},children:[Ld("mesh",{ref:d,geometry:m,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,wireframe:l.wireframe,attach:"material",side:f})},"".concat(i,"B")),Ld("mesh",{ref:h,geometry:m,castShadow:!1,receiveShadow:!1,children:Ld("meshLambertMaterial",{transparent:!0,attach:"material",wireframe:l.wireframe,side:p})},"".concat(i,"F"))]}),l.showName&&Ld(Mf,{distanceFactor:2,position:[0,0,.5],children:Ld("div",{style:{opacity:.75,borderRadius:2,backgroundColor:"lightgrey"},className:"disable-text-selection",children:l.name})})]})})})),jy=(0,e.forwardRef)(((t,n)=>{let{objectKey:i}=t;const r=Tb(n,(0,e.useRef)(null)),s=(0,e.useRef)(),o=N_((e=>e.clock)),a=N_((0,e.useCallback)((e=>e.texts[i]),[i]));return Tp((0,e.useCallback)((()=>{const e=1e3*o.getElapsed();r.current&&(r.current.position.set("function"==typeof a.position.x?a.position.x(e):a.position.x,"function"==typeof a.position.y?a.position.y(e):a.position.y,"function"==typeof a.position.z?a.position.z(e):a.position.z),r.current.visible="function"==typeof a.hidden?!a.hidden(e):!a.hidden),s.current&&bb(s,a.color,e)}),[a,r,o])),Ld("group",{ref:r,children:Ld(vg,{follow:!0,children:Ld(Nm,{ref:s,depthOffset:2,scale:[.2,.2,.2],children:a.value})})})})),Xy=(0,e.forwardRef)(((t,n)=>{let{objectKey:i}=t;const r=Tb(n,(0,e.useRef)(null)),s=N_((e=>e.clock)),{points:o,scale:a,hidden:l}=N_((0,e.useCallback)((e=>({points:e.points[i].points,scale:e.points[i].scale,hidden:e.points[i].hidden})),[i]),Eb),[{positions:c,colors:u}]=(0,e.useState)((()=>({positions:new Float32Array(3*o.length),colors:new Float32Array(3*o.length)})));return Tp((()=>{const e=1e3*s.getElapsed();if(r.current)for(let t=0;t<o.length;t++){let n=3*t;c[n]="function"==typeof o[t].position.x?o[t].position.x(e):o[t].position.x,c[n+1]="function"==typeof o[t].position.y?o[t].position.y(e):o[t].position.y,c[n+2]="function"==typeof o[t].position.z?o[t].position.z(e):o[t].position.z,u[n]="function"==typeof o[t].color.r?o[t].color.r(e)/255:o[t].color.r/255,u[n+1]="function"==typeof o[t].color.g?o[t].color.g(e)/255:o[t].color.g/255,u[n+2]="function"==typeof o[t].color.b?o[t].color.b(e)/255:o[t].color.b/255}})),o.length<=1?null:Ld(gv,{ref:r,hidden:l,positions:c,colors:u,children:Ld(ov,{transparent:!0,vertexColors:!0,sizeAttenuation:!0,depthWrite:!0,size:.1*a})})})),Yy=(0,e.memo)((e=>{let{activeTf:t,displayTfs:n,allTfs:i,allItems:r,allLines:s,allHulls:o,allTexts:a,allPoints:l,highlightColor:c,ghosts:u,targetRef:h,targetId:d,targetSource:p,filterActive:f,tfFilter:g,customProps:m}=e;const v="world"===t?wb:"gizmo"===t?xb:Sb,_=t===d?m:{},b=f?i.filter((e=>g.includes(e.key))):i,y=f&&t!==h;return Od(v,{objectKey:t,displayTfs:n,ref:d===t?h:null,..._,ghost:u,highlightColor:c,children:[b.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>Ld(Yy,{activeTf:e.key,displayTfs:n,allTfs:i,allItems:r,allLines:s,allHulls:o,allTexts:a,allPoints:l,highlightColor:c,ghosts:u,targetRef:h,targetSource:p,targetId:d,filterActive:y,tfFilter:g,customProps:m},e.key))),r.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"items"===p?m:{};return f&&e.key!==d&&t!==d?null:Ld(zy,{objectKey:e.key,highlightColor:c,ghost:u,ref:e.key===d?h:null,...n},e.key)})),s.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"lines"===p?m:{};return f&&e.key!==d&&t!==d?null:Ld(Vy,{objectKey:e.key,ref:e.lineKey===d?h:null,...n},e.key)})),o.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"hulls"===p?m:{};return f&&e.key!==d&&t!==d?null:Ld(Wy,{objectKey:e.key,highlightColor:c,ghost:u,ref:e.key===d?h:null,...n},e.key)})),a.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"texts"===p?m:{};return f&&e.key!==d&&t!==d?null:Ld(jy,{objectKey:e.key,highlightColor:c,ref:e.key===d?h:null,...n},e.key)})),l.filter((e=>e.frame===t||"world"===t&&!e.frame)).map((e=>{const n=e.key===d&&"points"===p?m:{};return f&&e.key!==d&&t!==d?null:Ld(Xy,{objectKey:e.key,highlightColor:c,ref:e.key===d?h:null,...n},e.key)}))]})})),Ky=["enabled","axis","translationSnap","rotationSnap","scaleSnap","space","size"],qy=["displayTfs","allTfs","allItems","allLines","allHulls","allTexts","allPoints","highlightColor"],Jy=(0,e.memo)((t=>{let{camera:n,objectInfo:i,highlightColor:r,translateSnap:s,rotateSnap:o,scaleSnap:a,onDragStart:l,onDragEnd:c,mode:u,...h}=t;const d=iv(h,Ky),p=iv(h,qy),f=N_((0,e.useCallback)((e=>{let t=[];"tfs"===i.source&&t.push(i.key);let n=e[i.source][i.key].frame;for(;n&&"world"!==n&&"gizmo"!==n;){let i=e.tfs[n];t.push(n),n=i.frame}return t}),[i]),Eb),g=(0,e.useRef)(),m=(0,e.useRef)(),v=N_((e=>iv(e[i.source][i.key],["position","rotation","scale"])),Eb),_=yp((e=>{let{gl:t}=e;return t})),b=yp((e=>{let{camera:t}=e;return t})),y=yp((e=>{let{invalidate:t}=e;return t})),T=n||b,[E]=(0,e.useState)((()=>new K_(T,_.domElement)));E.translationSnap=s,E.rotationSnap=o,E.scaleSnap=a,null!=u&&u.includes("translate")?E.mode="translate":null!=u&&u.includes("rotate")?E.mode="rotate":null!=u&&u.includes("scale")&&(E.mode="scale"),null!=u&&u.includes("-x")?(E.showY=!1,E.showZ=!1):null!=u&&u.includes("-y")?(E.showX=!1,E.showZ=!1):null!=u&&u.includes("-z")&&(E.showX=!1,E.showY=!1);const[S,w]=(0,e.useState)(!1),[x,M]=(0,e.useState)(v),[I,C]=(0,e.useState)(!1);(0,e.useEffect)((()=>{console.log("refreshing transform"),M(v)}),[v,I]);const k=N_((e=>e.onMove),Eb);return(0,e.useEffect)((()=>{const e=e=>{var t,n,r;const s=null==(t=null==m?void 0:m.current)?void 0:t.position,o=null==(n=null==m?void 0:m.current)?void 0:n.quaternion,a=null==(r=null==m?void 0:m.current)?void 0:r.scale;e.value&&!S?(console.log("starting transform"),w(!0),M({position:s,rotation:o,scale:a}),l&&l()):!e.value&&S&&(console.log("stopping transform"),w(!1),c&&c(),k(i.key,i.source,{position:E.worldPosition,quaternion:E.worldQuaternion,scale:E._worldScale},{position:s?{x:s.x,y:s.y,z:s.z}:null,quaternion:o?{x:o.x,y:o.y,z:o.z,w:o.w}:null,scale:a?{x:a.x,y:a.y,z:a.z}:null}),C(!I))};return E&&E.addEventListener("dragging-changed",e),()=>{E.removeEventListener("dragging-changed",e)}}),[v,S,i]),(0,e.useEffect)((()=>{null==E||E.attach(m.current)}),[m,E]),(0,e.useEffect)((()=>(E&&E.addEventListener("change",y),()=>{var e;return null==(e=null==E?void 0:E.removeEventListener)?void 0:e.call(E,"change",y)})),[E,y]),E?Od(Ad,{children:[Ld("primitive",{ref:g,object:E,...d}),Ld(Yy,{...p,activeTf:"world",tfFilter:f,ghosts:!0,targetRef:m,targetSource:i.source,targetId:i.key,filterActive:!0,customProps:{...x}})]}):null})),Zy=(e,t)=>e.length===t.length&&!e.some(((e,n)=>!k_.exports.isEqual(t[n],e)));function Qy(t){let{displayTfs:n=!1,displayGrid:i=!0,isPolar:r=!1,backgroundColor:s="#d0d0d0",planeColor:o="#a8a8a8",highlightColor:a="#00ffff",plane:l=0,translateSnap:c=0,rotateSnap:u=0,scaleSnap:h=0,debug:d=!1}=t;d&&console.log("content rerender");const p=yp((e=>e.camera)),f=N_((e=>e.clock),Eb);Tp((()=>{f.update()}));const g=N_((e=>k_.exports.sortBy(Object.entries(e.tfs).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,transformMode:n.transformMode,source:"tfs"}})),(e=>e.key))),Zy),m=N_((e=>k_.exports.sortBy(Object.entries(e.items).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,transformMode:n.transformMode,source:"items"}})),(e=>e.key))),Zy),v=N_((e=>k_.exports.sortBy(Object.entries(e.lines).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"lines"}})),(e=>e.key))),Zy),_=N_((e=>k_.exports.sortBy(Object.entries(e.hulls).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"hulls"}})),(e=>e.key))),Zy),b=N_((e=>k_.exports.sortBy(Object.entries(e.texts).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"texts"}})),(e=>e.key))),Zy),y=N_((e=>k_.exports.sortBy(Object.entries(e.points).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"points"}})),(e=>e.key))),Zy),T=N_((e=>k_.exports.sortBy(Object.entries(e.widgets).map((e=>{let[t,n]=e;return{key:t,frame:n.frame,source:"widgets"}})),(e=>e.key))),Zy),E=[...m,...g].filter((e=>["translate","rotate","scale","translate-x","translate-y","translate-z","rotate-x","rotate-y","rotate-z","scale-x","scale-y","scale-z"].includes(e.transformMode))),S=(0,e.useRef)(),w=(0,e.useRef)(),x=(0,e.useRef)(),M=(0,e.useRef)(),I=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return t+t+n+n+i+i}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(o),C=[I.r,I.g,I.b,.5];return Od(e.Fragment,{children:[Ld(rv,{ref:M,makeDefault:!0,camera:p}),Ld("pointLight",{ref:w,intensity:.5,position:[-1,-3,3],color:"#FFFAEE"}),Ld(P_,{ref:S,intensity:.7,color:"white"}),Ld($_,{ref:x,castShadow:!0,position:[5,15,15],intensity:.6,color:"#FFFAEE"}),Ld("spotLight",{penumbra:1,position:[-1,-1,4],intensity:.3,castShadow:!0,color:"#FFFAEE"}),Ld("color",{attach:"background",args:[s]}),Ld("fogExp2",{attach:"fog",args:[s,.01]}),Ld(av,{receiveShadow:!0,scale:1e3,position:[0,0,l-.01],material:B_(...C)}),Od(Dy,{children:[Ld(Oy,{autoClear:!1,children:Ld($y,{visibleEdgeColor:a,hiddenEdgeColor:a,blur:!0,kernelSize:1,edgeStrength:50,pulseSpeed:.25,xRay:!0})}),Ld(Yy,{activeTf:"world",displayTfs:n,allTfs:g,allItems:m,allLines:v,allHulls:_,allTexts:b,allPoints:y,allWidgets:T,highlightColor:a})]}),Ld("group",{position:[0,0,l],rotation:[Math.PI/2,0,0],up:[0,0,1],children:i&&(r?Ld("polarGridHelper",{args:[10,16,8,64,"white","gray"]}):Ld("gridHelper",{args:[20,20,"white","gray"]}))}),E.map((e=>Ld(Jy,{objectInfo:e,mode:e.transformMode,displayTfs:n,allTfs:g,allItems:m,allLines:v,allHulls:_,allTexts:b,allPoints:y,allWidgets:T,translateSnap:c,rotateSnap:u,scaleSnap:h,highlightColor:a,onDragEnd:()=>{M.current&&(M.current.enabled=!0)},onDragStart:()=>{M.current&&(M.current.enabled=!1)}},"movableObjectTransform-".concat(e.key))))]})}Ei.DefaultUp.set(0,0,1);function eT(t){let{backgroundColor:n="#d0d0d0",store:i,fov:r=60,onPointerMissed:s=(()=>{}),meshLookup:o={},debug:a=!1,...l}=t;return a&&console.log("Scene rerender"),Ld(of,{camera:{up:[0,0,1],fov:r,position:[0,-3,3]},shadows:!0,style:{background:n||"#d0d0d0"},onPointerMissed:s||(()=>{}),children:Ld(D_,{store:i,debug:a,children:Ld(Uy,{meshes:o,children:Ld(e.Suspense,{children:Ld(Qy,{...l,backgroundColor:n,debug:a})})})})})}var tT=__webpack_require__(222),nT=__webpack_require__(691),iT=__webpack_require__(505),rT=__webpack_require__(418),sT=__webpack_require__.n(rT),oT=__webpack_require__(184);const aT=["xxl","xl","lg","md","sm","xs"],lT="xs",cT=e.createContext({prefixes:{},breakpoints:aT,minBreakpoint:lT}),{Consumer:uT,Provider:hT}=cT;function dT(t,n){const{prefixes:i}=(0,e.useContext)(cT);return t||i[n]||n}const pT=e.forwardRef(((e,t)=>{let{bsPrefix:n,fluid:i=!1,as:r="div",className:s,...o}=e;const a=dT(n,"container"),l="string"===typeof i?"-".concat(i):"-fluid";return(0,oT.jsx)(r,{ref:t,...o,className:sT()(s,i?"".concat(a).concat(l):a)})}));pT.displayName="Container";const fT=pT;var gT=__webpack_require__(7),mT=__webpack_require__.n(gT);const vT={type:mT().string,tooltip:mT().bool,as:mT().elementType},_T=e.forwardRef(((e,t)=>{let{as:n="div",className:i,type:r="valid",tooltip:s=!1,...o}=e;return(0,oT.jsx)(n,{...o,ref:t,className:sT()(i,"".concat(r,"-").concat(s?"tooltip":"feedback"))})}));_T.displayName="Feedback",_T.propTypes=vT;const bT=_T,yT=e.createContext({}),TT=e.forwardRef(((t,n)=>{let{id:i,bsPrefix:r,className:s,type:o="checkbox",isValid:a=!1,isInvalid:l=!1,as:c="input",...u}=t;const{controlId:h}=(0,e.useContext)(yT);return r=dT(r,"form-check-input"),(0,oT.jsx)(c,{...u,ref:n,type:o,id:i||h,className:sT()(s,r,a&&"is-valid",l&&"is-invalid")})}));TT.displayName="FormCheckInput";const ET=TT,ST=e.forwardRef(((t,n)=>{let{bsPrefix:i,className:r,htmlFor:s,...o}=t;const{controlId:a}=(0,e.useContext)(yT);return i=dT(i,"form-check-label"),(0,oT.jsx)("label",{...o,ref:n,htmlFor:s||a,className:sT()(r,i)})}));ST.displayName="FormCheckLabel";const wT=ST;const xT=e.forwardRef(((t,n)=>{let{id:i,bsPrefix:r,bsSwitchPrefix:s,inline:o=!1,reverse:a=!1,disabled:l=!1,isValid:c=!1,isInvalid:u=!1,feedbackTooltip:h=!1,feedback:d,feedbackType:p,className:f,style:g,title:m="",type:v="checkbox",label:_,children:b,as:y="input",...T}=t;r=dT(r,"form-check"),s=dT(s,"form-switch");const{controlId:E}=(0,e.useContext)(yT),S=(0,e.useMemo)((()=>({controlId:i||E})),[E,i]),w=!b&&null!=_&&!1!==_||function(t,n){return e.Children.toArray(t).some((t=>e.isValidElement(t)&&t.type===n))}(b,wT),x=(0,oT.jsx)(ET,{...T,type:"switch"===v?"checkbox":v,ref:n,isValid:c,isInvalid:u,disabled:l,as:y});return(0,oT.jsx)(yT.Provider,{value:S,children:(0,oT.jsx)("div",{style:g,className:sT()(f,w&&r,o&&"".concat(r,"-inline"),a&&"".concat(r,"-reverse"),"switch"===v&&s),children:b||(0,oT.jsxs)(oT.Fragment,{children:[x,w&&(0,oT.jsx)(wT,{title:m,children:_}),d&&(0,oT.jsx)(bT,{type:p,tooltip:h,children:d})]})})})}));xT.displayName="FormCheck";const MT=Object.assign(xT,{Input:ET,Label:wT});__webpack_require__(391);const IT=e.forwardRef(((t,n)=>{let{bsPrefix:i,type:r,size:s,htmlSize:o,id:a,className:l,isValid:c=!1,isInvalid:u=!1,plaintext:h,readOnly:d,as:p="input",...f}=t;const{controlId:g}=(0,e.useContext)(yT);return i=dT(i,"form-control"),(0,oT.jsx)(p,{...f,type:r,size:o,ref:n,readOnly:d,id:a||g,className:sT()(l,h?"".concat(i,"-plaintext"):i,s&&"".concat(i,"-").concat(s),"color"===r&&"".concat(i,"-color"),c&&"is-valid",u&&"is-invalid")})}));IT.displayName="FormControl";const CT=Object.assign(IT,{Feedback:bT}),kT=e.forwardRef(((e,t)=>{let{className:n,bsPrefix:i,as:r="div",...s}=e;return i=dT(i,"form-floating"),(0,oT.jsx)(r,{ref:t,className:sT()(n,i),...s})}));kT.displayName="FormFloating";const RT=kT,AT=e.forwardRef(((t,n)=>{let{controlId:i,as:r="div",...s}=t;const o=(0,e.useMemo)((()=>({controlId:i})),[i]);return(0,oT.jsx)(yT.Provider,{value:o,children:(0,oT.jsx)(r,{...s,ref:n})})}));AT.displayName="FormGroup";const LT=AT;function OT(t){let{as:n,bsPrefix:i,className:r,...s}=t;i=dT(i,"col");const o=function(){const{breakpoints:t}=(0,e.useContext)(cT);return t}(),a=function(){const{minBreakpoint:t}=(0,e.useContext)(cT);return t}(),l=[],c=[];return o.forEach((e=>{const t=s[e];let n,r,o;delete s[e],"object"===typeof t&&null!=t?({span:n,offset:r,order:o}=t):n=t;const u=e!==a?"-".concat(e):"";n&&l.push(!0===n?"".concat(i).concat(u):"".concat(i).concat(u,"-").concat(n)),null!=o&&c.push("order".concat(u,"-").concat(o)),null!=r&&c.push("offset".concat(u,"-").concat(r))})),[{...s,className:sT()(r,...l,...c)},{as:n,bsPrefix:i,spans:l}]}const NT=e.forwardRef(((e,t)=>{const[{className:n,...i},{as:r="div",bsPrefix:s,spans:o}]=OT(e);return(0,oT.jsx)(r,{...i,ref:t,className:sT()(n,!o.length&&s)})}));NT.displayName="Col";const DT=NT,PT=e.forwardRef(((t,n)=>{let{as:i="label",bsPrefix:r,column:s=!1,visuallyHidden:o=!1,className:a,htmlFor:l,...c}=t;const{controlId:u}=(0,e.useContext)(yT);r=dT(r,"form-label");let h="col-form-label";"string"===typeof s&&(h="".concat(h," ").concat(h,"-").concat(s));const d=sT()(a,r,o&&"visually-hidden",s&&h);return l=l||u,s?(0,oT.jsx)(DT,{ref:n,as:"label",className:d,htmlFor:l,...c}):(0,oT.jsx)(i,{ref:n,className:d,htmlFor:l,...c})}));PT.displayName="FormLabel";const $T=PT,BT=e.forwardRef(((t,n)=>{let{bsPrefix:i,className:r,id:s,...o}=t;const{controlId:a}=(0,e.useContext)(yT);return i=dT(i,"form-range"),(0,oT.jsx)("input",{...o,type:"range",ref:n,className:sT()(r,i),id:s||a})}));BT.displayName="FormRange";const FT=BT,UT=e.forwardRef(((t,n)=>{let{bsPrefix:i,size:r,htmlSize:s,className:o,isValid:a=!1,isInvalid:l=!1,id:c,...u}=t;const{controlId:h}=(0,e.useContext)(yT);return i=dT(i,"form-select"),(0,oT.jsx)("select",{...u,size:s,ref:n,className:sT()(o,i,r&&"".concat(i,"-").concat(r),a&&"is-valid",l&&"is-invalid"),id:c||h})}));UT.displayName="FormSelect";const zT=UT,HT=e.forwardRef(((e,t)=>{let{bsPrefix:n,className:i,as:r="small",muted:s,...o}=e;return n=dT(n,"form-text"),(0,oT.jsx)(r,{...o,ref:t,className:sT()(i,n,s&&"text-muted")})}));HT.displayName="FormText";const GT=HT,VT=e.forwardRef(((e,t)=>(0,oT.jsx)(MT,{...e,ref:t,type:"switch"})));VT.displayName="Switch";const WT=Object.assign(VT,{Input:MT.Input,Label:MT.Label}),jT=e.forwardRef(((e,t)=>{let{bsPrefix:n,className:i,children:r,controlId:s,label:o,...a}=e;return n=dT(n,"form-floating"),(0,oT.jsxs)(LT,{ref:t,className:sT()(i,n),controlId:s,...a,children:[r,(0,oT.jsx)("label",{htmlFor:s,children:o})]})}));jT.displayName="FloatingLabel";const XT=jT,YT={_ref:mT().any,validated:mT().bool,as:mT().elementType},KT=e.forwardRef(((e,t)=>{let{className:n,validated:i,as:r="form",...s}=e;return(0,oT.jsx)(r,{...s,ref:t,className:sT()(n,i&&"was-validated")})}));KT.displayName="Form",KT.propTypes=YT;const qT=Object.assign(KT,{Group:LT,Control:CT,Floating:RT,Check:MT,Switch:WT,Label:$T,Text:GT,Range:FT,Select:zT,FloatingLabel:XT}),JT=["as","disabled"];function ZT(e){let{tagName:t,disabled:n,href:i,target:r,rel:s,role:o,onClick:a,tabIndex:l=0,type:c}=e;t||(t=null!=i||null!=r||null!=s?"a":"button");const u={tagName:t};if("button"===t)return[{type:c||"button",disabled:n},u];const h=e=>{(n||"a"===t&&function(e){return!e||"#"===e.trim()}(i))&&e.preventDefault(),n?e.stopPropagation():null==a||a(e)};return"a"===t&&(i||(i="#"),n&&(i=void 0)),[{role:null!=o?o:"button",disabled:void 0,tabIndex:n?void 0:l,href:i,target:"a"===t?r:void 0,"aria-disabled":n||void 0,rel:"a"===t?s:void 0,onClick:h,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),h(e))}},u]}const QT=e.forwardRef(((e,t)=>{let{as:n,disabled:i}=e,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,JT);const[s,{tagName:o}]=ZT(Object.assign({tagName:n,disabled:i},r));return(0,oT.jsx)(o,Object.assign({},r,s,{ref:t}))}));QT.displayName="Button";const eE=e.forwardRef(((e,t)=>{let{as:n,bsPrefix:i,variant:r="primary",size:s,active:o=!1,disabled:a=!1,className:l,...c}=e;const u=dT(i,"btn"),[h,{tagName:d}]=ZT({tagName:n,disabled:a,...c}),p=d;return(0,oT.jsx)(p,{...h,...c,ref:t,disabled:a,className:sT()(l,u,o&&"active",r&&"".concat(u,"-").concat(r),s&&"".concat(u,"-").concat(s),c.href&&a&&"disabled")})}));eE.displayName="Button";const tE=eE;var nE=__webpack_require__(464);function iE(t){const[n,i]=(0,e.useState)(""),r=(0,nE.Z)((e=>e.setIp)),s=(0,nE.Z)((e=>e.ip));return(0,oT.jsxs)("div",{style:{backgroundColor:"#333",color:"#fff",padding:"15px",textAlign:"center",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,oT.jsx)("h2",{children:"Top Bar"}),(0,oT.jsxs)(fT,{children:[(0,oT.jsx)("p",{className:"ipDisplay",children:s}),(0,oT.jsxs)(qT,{children:[(0,oT.jsx)(qT.Label,{htmlFor:"robotIpAddress",children:"IP: "}),(0,oT.jsx)(qT.Control,{id:"robotIpAddress",value:n,onChange:e=>i(e.target.value)})]}),(0,oT.jsx)(tE,{variant:"neutral",onClick:()=>{r(n),alert("Confirmed IP Address: "+n)},children:"Confirm"}),(0,oT.jsx)("button",{id:"runButton",children:"Run"})]})]})}var rE=__webpack_require__(494);function sE(){return sE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},sE.apply(this,arguments)}function oE(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}function aE(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var lE=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,cE=aE((function(e){return lE.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));var uE=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(i){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),hE=Math.abs,dE=String.fromCharCode,pE=Object.assign;function fE(e){return e.trim()}function gE(e,t,n){return e.replace(t,n)}function mE(e,t){return e.indexOf(t)}function vE(e,t){return 0|e.charCodeAt(t)}function _E(e,t,n){return e.slice(t,n)}function bE(e){return e.length}function yE(e){return e.length}function TE(e,t){return t.push(e),e}var EE=1,SE=1,wE=0,xE=0,ME=0,IE="";function CE(e,t,n,i,r,s,o){return{value:e,root:t,parent:n,type:i,props:r,children:s,line:EE,column:SE,length:o,return:""}}function kE(e,t){return pE(CE("",null,null,"",null,null,0),e,{length:-e.length},t)}function RE(){return ME=xE>0?vE(IE,--xE):0,SE--,10===ME&&(SE=1,EE--),ME}function AE(){return ME=xE<wE?vE(IE,xE++):0,SE++,10===ME&&(SE=1,EE++),ME}function LE(){return vE(IE,xE)}function OE(){return xE}function NE(e,t){return _E(IE,e,t)}function DE(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function PE(e){return EE=SE=1,wE=bE(IE=e),xE=0,[]}function $E(e){return IE="",e}function BE(e){return fE(NE(xE-1,zE(91===e?e+2:40===e?e+1:e)))}function FE(e){for(;(ME=LE())&&ME<33;)AE();return DE(e)>2||DE(ME)>3?"":" "}function UE(e,t){for(;--t&&AE()&&!(ME<48||ME>102||ME>57&&ME<65||ME>70&&ME<97););return NE(e,OE()+(t<6&&32==LE()&&32==AE()))}function zE(e){for(;AE();)switch(ME){case e:return xE;case 34:case 39:34!==e&&39!==e&&zE(ME);break;case 40:41===e&&zE(e);break;case 92:AE()}return xE}function HE(e,t){for(;AE()&&e+ME!==57&&(e+ME!==84||47!==LE()););return"/*"+NE(t,xE-1)+"*"+dE(47===e?e:AE())}function GE(e){for(;!DE(LE());)AE();return NE(e,xE)}var VE="-ms-",WE="-moz-",jE="-webkit-",XE="comm",YE="rule",KE="decl",qE="@keyframes";function JE(e,t){for(var n="",i=yE(e),r=0;r<i;r++)n+=t(e[r],r,e,t)||"";return n}function ZE(e,t,n,i){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case KE:return e.return=e.return||e.value;case XE:return"";case qE:return e.return=e.value+"{"+JE(e.children,i)+"}";case YE:e.value=e.props.join(",")}return bE(n=JE(e.children,i))?e.return=e.value+"{"+n+"}":""}function QE(e){return $E(eS("",null,null,null,[""],e=PE(e),0,[0],e))}function eS(e,t,n,i,r,s,o,a,l){for(var c=0,u=0,h=o,d=0,p=0,f=0,g=1,m=1,v=1,_=0,b="",y=r,T=s,E=i,S=b;m;)switch(f=_,_=AE()){case 40:if(108!=f&&58==vE(S,h-1)){-1!=mE(S+=gE(BE(_),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:S+=BE(_);break;case 9:case 10:case 13:case 32:S+=FE(f);break;case 92:S+=UE(OE()-1,7);continue;case 47:switch(LE()){case 42:case 47:TE(nS(HE(AE(),OE()),t,n),l);break;default:S+="/"}break;case 123*g:a[c++]=bE(S)*v;case 125*g:case 59:case 0:switch(_){case 0:case 125:m=0;case 59+u:-1==v&&(S=gE(S,/\f/g,"")),p>0&&bE(S)-h&&TE(p>32?iS(S+";",i,n,h-1):iS(gE(S," ","")+";",i,n,h-2),l);break;case 59:S+=";";default:if(TE(E=tS(S,t,n,c,u,r,a,b,y=[],T=[],h),s),123===_)if(0===u)eS(S,t,E,E,y,s,h,a,T);else switch(99===d&&110===vE(S,3)?100:d){case 100:case 108:case 109:case 115:eS(e,E,E,i&&TE(tS(e,E,E,0,0,r,a,b,r,y=[],h),T),r,T,h,a,i?y:T);break;default:eS(S,E,E,E,[""],T,0,a,T)}}c=u=p=0,g=v=1,b=S="",h=o;break;case 58:h=1+bE(S),p=f;default:if(g<1)if(123==_)--g;else if(125==_&&0==g++&&125==RE())continue;switch(S+=dE(_),_*g){case 38:v=u>0?1:(S+="\f",-1);break;case 44:a[c++]=(bE(S)-1)*v,v=1;break;case 64:45===LE()&&(S+=BE(AE())),d=LE(),u=h=bE(b=S+=GE(OE())),_++;break;case 45:45===f&&2==bE(S)&&(g=0)}}return s}function tS(e,t,n,i,r,s,o,a,l,c,u){for(var h=r-1,d=0===r?s:[""],p=yE(d),f=0,g=0,m=0;f<i;++f)for(var v=0,_=_E(e,h+1,h=hE(g=o[f])),b=e;v<p;++v)(b=fE(g>0?d[v]+" "+_:gE(_,/&\f/g,d[v])))&&(l[m++]=b);return CE(e,t,n,0===r?YE:a,l,c,u)}function nS(e,t,n){return CE(e,t,n,XE,dE(ME),_E(e,2,-2),0)}function iS(e,t,n,i){return CE(e,t,n,KE,_E(e,0,i),_E(e,i+1,-1),i)}var rS=function(e,t,n){for(var i=0,r=0;i=r,r=LE(),38===i&&12===r&&(t[n]=1),!DE(r);)AE();return NE(e,xE)},sS=function(e,t){return $E(function(e,t){var n=-1,i=44;do{switch(DE(i)){case 0:38===i&&12===LE()&&(t[n]=1),e[n]+=rS(xE-1,t,n);break;case 2:e[n]+=BE(i);break;case 4:if(44===i){e[++n]=58===LE()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=dE(i)}}while(i=AE());return e}(PE(e),t))},oS=new WeakMap,aS=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||oS.get(n))&&!i){oS.set(e,!0);for(var r=[],s=sS(t,r),o=n.props,a=0,l=0;a<s.length;a++)for(var c=0;c<o.length;c++,l++)e.props[l]=r[a]?s[a].replace(/&\f/g,o[c]):o[c]+" "+s[a]}}},lS=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function cS(e,t){switch(function(e,t){return 45^vE(e,0)?(((t<<2^vE(e,0))<<2^vE(e,1))<<2^vE(e,2))<<2^vE(e,3):0}(e,t)){case 5103:return jE+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return jE+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return jE+e+WE+e+VE+e+e;case 6828:case 4268:return jE+e+VE+e+e;case 6165:return jE+e+VE+"flex-"+e+e;case 5187:return jE+e+gE(e,/(\w+).+(:[^]+)/,jE+"box-$1$2"+VE+"flex-$1$2")+e;case 5443:return jE+e+VE+"flex-item-"+gE(e,/flex-|-self/,"")+e;case 4675:return jE+e+VE+"flex-line-pack"+gE(e,/align-content|flex-|-self/,"")+e;case 5548:return jE+e+VE+gE(e,"shrink","negative")+e;case 5292:return jE+e+VE+gE(e,"basis","preferred-size")+e;case 6060:return jE+"box-"+gE(e,"-grow","")+jE+e+VE+gE(e,"grow","positive")+e;case 4554:return jE+gE(e,/([^-])(transform)/g,"$1"+jE+"$2")+e;case 6187:return gE(gE(gE(e,/(zoom-|grab)/,jE+"$1"),/(image-set)/,jE+"$1"),e,"")+e;case 5495:case 3959:return gE(e,/(image-set\([^]*)/,jE+"$1$`$1");case 4968:return gE(gE(e,/(.+:)(flex-)?(.*)/,jE+"box-pack:$3"+VE+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+jE+e+e;case 4095:case 3583:case 4068:case 2532:return gE(e,/(.+)-inline(.+)/,jE+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(bE(e)-1-t>6)switch(vE(e,t+1)){case 109:if(45!==vE(e,t+4))break;case 102:return gE(e,/(.+:)(.+)-([^]+)/,"$1"+jE+"$2-$3$1"+WE+(108==vE(e,t+3)?"$3":"$2-$3"))+e;case 115:return~mE(e,"stretch")?cS(gE(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==vE(e,t+1))break;case 6444:switch(vE(e,bE(e)-3-(~mE(e,"!important")&&10))){case 107:return gE(e,":",":"+jE)+e;case 101:return gE(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+jE+(45===vE(e,14)?"inline-":"")+"box$3$1"+jE+"$2$3$1"+VE+"$2box$3")+e}break;case 5936:switch(vE(e,t+11)){case 114:return jE+e+VE+gE(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return jE+e+VE+gE(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return jE+e+VE+gE(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return jE+e+VE+e+e}return e}var uS=[function(e,t,n,i){if(e.length>-1&&!e.return)switch(e.type){case KE:e.return=cS(e.value,e.length);break;case qE:return JE([kE(e,{value:gE(e.value,"@","@"+jE)})],i);case YE:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return JE([kE(e,{props:[gE(t,/:(read-\w+)/,":-moz-$1")]})],i);case"::placeholder":return JE([kE(e,{props:[gE(t,/:(plac\w+)/,":"+jE+"input-$1")]}),kE(e,{props:[gE(t,/:(plac\w+)/,":-moz-$1")]}),kE(e,{props:[gE(t,/:(plac\w+)/,VE+"input-$1")]})],i)}return""}))}}],hS=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var i=e.stylisPlugins||uS;var r,s,o={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;a.push(e)}));var l,c,u=[ZE,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=yE(e);return function(n,i,r,s){for(var o="",a=0;a<t;a++)o+=e[a](n,i,r,s)||"";return o}}([aS,lS].concat(i,u));s=function(e,t,n,i){l=n,JE(QE(e?e+"{"+t.styles+"}":t.styles),h),i&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new uE({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:s};return d.sheet.hydrate(a),d};var dS={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pS=/[A-Z]|^ms/g,fS=/_EMO_([^_]+?)_([^]*?)_EMO_/g,gS=function(e){return 45===e.charCodeAt(1)},mS=function(e){return null!=e&&"boolean"!==typeof e},vS=aE((function(e){return gS(e)?e:e.replace(pS,"-$&").toLowerCase()})),_S=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(fS,(function(e,t,n){return yS={name:t,styles:n,next:yS},t}))}return 1===dS[e]||gS(e)||"number"!==typeof t||0===t?t:t+"px"};function bS(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return yS={name:n.name,styles:n.styles,next:yS},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)yS={name:i.name,styles:i.styles,next:yS},i=i.next;return n.styles+";"}return function(e,t,n){var i="";if(Array.isArray(n))for(var r=0;r<n.length;r++)i+=bS(e,t,n[r])+";";else for(var s in n){var o=n[s];if("object"!==typeof o)null!=t&&void 0!==t[o]?i+=s+"{"+t[o]+"}":mS(o)&&(i+=vS(s)+":"+_S(s,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var a=bS(e,t,o);switch(s){case"animation":case"animationName":i+=vS(s)+":"+a+";";break;default:i+=s+"{"+a+"}"}}else for(var l=0;l<o.length;l++)mS(o[l])&&(i+=vS(s)+":"+_S(s,o[l])+";")}return i}(e,t,n);case"function":if(void 0!==e){var r=yS,s=n(e);return yS=r,bS(e,t,s)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var yS,TS=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var ES=!!t.useInsertionEffect&&t.useInsertionEffect,SS=ES||function(e){return e()},wS=(ES||e.useLayoutEffect,e.createContext("undefined"!==typeof HTMLElement?hS({key:"css"}):null));wS.Provider;var xS=function(t){return(0,e.forwardRef)((function(n,i){var r=(0,e.useContext)(wS);return t(n,r,i)}))};var MS=e.createContext({});var IS=function(e,t,n){var i=e.key+"-"+t.name;!1===n&&void 0===e.registered[i]&&(e.registered[i]=t.styles)},CS=cE,kS=function(e){return"theme"!==e},RS=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?CS:kS},AS=function(e,t,n){var i;if(t){var r=t.shouldForwardProp;i=e.__emotion_forwardProp&&r?function(t){return e.__emotion_forwardProp(t)&&r(t)}:r}return"function"!==typeof i&&n&&(i=e.__emotion_forwardProp),i},LS=function(e){var t=e.cache,n=e.serialized,i=e.isStringTag;return IS(t,n,i),SS((function(){return function(e,t,n){IS(e,t,n);var i=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+i:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}}(t,n,i)})),null},OS=function t(n,i){var r,s,o=n.__emotion_real===n,a=o&&n.__emotion_base||n;void 0!==i&&(r=i.label,s=i.target);var l=AS(n,i,o),c=l||RS(a),u=!c("as");return function(){var h=arguments,d=o&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==r&&d.push("label:"+r+";"),null==h[0]||void 0===h[0].raw)d.push.apply(d,h);else{0,d.push(h[0][0]);for(var p=h.length,f=1;f<p;f++)d.push(h[f],h[0][f])}var g=xS((function(t,n,i){var r=u&&t.as||a,o="",h=[],p=t;if(null==t.theme){for(var f in p={},t)p[f]=t[f];p.theme=e.useContext(MS)}"string"===typeof t.className?o=function(e,t,n){var i="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):i+=n+" "})),i}(n.registered,h,t.className):null!=t.className&&(o=t.className+" ");var g=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var i=!0,r="";yS=void 0;var s=e[0];null==s||void 0===s.raw?(i=!1,r+=bS(n,t,s)):r+=s[0];for(var o=1;o<e.length;o++)r+=bS(n,t,e[o]),i&&(r+=s[o]);TS.lastIndex=0;for(var a,l="";null!==(a=TS.exec(r));)l+="-"+a[1];var c=function(e){for(var t,n=0,i=0,r=e.length;r>=4;++i,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&e.charCodeAt(i+2))<<16;case 2:n^=(255&e.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(r)+l;return{name:c,styles:r,next:yS}}(d.concat(h),n.registered,p);o+=n.key+"-"+g.name,void 0!==s&&(o+=" "+s);var m=u&&void 0===l?RS(r):c,v={};for(var _ in t)u&&"as"===_||m(_)&&(v[_]=t[_]);return v.className=o,v.ref=i,e.createElement(e.Fragment,null,e.createElement(LS,{cache:n,serialized:g,isStringTag:"string"===typeof r}),e.createElement(r,v))}));return g.displayName=void 0!==r?r:"Styled("+("string"===typeof a?a:a.displayName||a.name||"Component")+")",g.defaultProps=n.defaultProps,g.__emotion_real=g,g.__emotion_base=a,g.__emotion_styles=d,g.__emotion_forwardProp=l,Object.defineProperty(g,"toString",{value:function(){return"."+s}}),g.withComponent=function(e,n){return t(e,sE({},i,n,{shouldForwardProp:AS(g,n,!0)})).apply(void 0,d)},g}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){OS[e]=OS(e)}));function NS(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function DS(e){if(!NS(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=DS(e[n])})),t}function PS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const i=n.clone?sE({},e):e;return NS(e)&&NS(t)&&Object.keys(t).forEach((r=>{"__proto__"!==r&&(NS(t[r])&&r in e&&NS(e[r])?i[r]=PS(e[r],t[r],n):n.clone?i[r]=NS(t[r])?DS(t[r]):t[r]:i[r]=t[r])})),i}const $S=["values","unit","step"],BS=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>sE({},e,{[t.key]:t.val})),{})};const FS={borderRadius:4},US={xs:0,sm:600,md:900,lg:1200,xl:1536},zS={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(US[e],"px)")};function HS(e,t,n){const i=e.theme||{};if(Array.isArray(t)){const e=i.breakpoints||zS;return t.reduce(((i,r,s)=>(i[e.up(e.keys[s])]=n(t[s]),i)),{})}if("object"===typeof t){const e=i.breakpoints||zS;return Object.keys(t).reduce(((i,r)=>{if(-1!==Object.keys(e.values||US).indexOf(r)){i[e.up(r)]=n(t[r],r)}else{const e=r;i[e]=t[e]}return i}),{})}return n(t)}function GS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,n)=>(t[e.up(n)]={},t)),{}))||{}}function VS(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function WS(e){let{values:t,breakpoints:n,base:i}=e;const r=i||function(e,t){if("object"!==typeof e)return{};const n={},i=Object.keys(t);return Array.isArray(e)?i.forEach(((t,i)=>{i<e.length&&(n[t]=!0)})):i.forEach((t=>{null!=e[t]&&(n[t]=!0)})),n}(t,n),s=Object.keys(r);if(0===s.length)return t;let o;return s.reduce(((e,n,i)=>(Array.isArray(t)?(e[n]=null!=t[i]?t[i]:t[o],o=i):"object"===typeof t?(e[n]=null!=t[n]?t[n]:t[o],o=n):e[n]=t,e)),{})}function jS(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function XS(e){if("string"!==typeof e)throw new Error(jS(7));return e.charAt(0).toUpperCase()+e.slice(1)}function YS(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n="vars.".concat(t).split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function KS(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return i="function"===typeof e?e(n):Array.isArray(e)?e[n]||r:YS(e,n)||r,t&&(i=t(i,r,e)),i}const qS=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:i,transform:r}=e,s=e=>{if(null==e[t])return null;const s=e[t],o=YS(e.theme,i)||{};return HS(e,s,(e=>{let i=KS(o,r,e);return e===i&&"string"===typeof e&&(i=KS(o,r,"".concat(t).concat("default"===e?"":XS(e)),e)),!1===n?i:{[n]:i}}))};return s.propTypes={},s.filterProps=[t],s};const JS=function(e,t){return t?PS(e,t,{clone:!1}):e};const ZS={m:"margin",p:"padding"},QS={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},ew={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},tw=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!ew[e])return[e];e=ew[e]}const[t,n]=e.split(""),i=ZS[t],r=QS[n]||"";return Array.isArray(r)?r.map((e=>i+e)):[i+r]})),nw=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],iw=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],rw=[...nw,...iw];function sw(e,t,n,i){var r;const s=null!=(r=YS(e,t,!1))?r:n;return"number"===typeof s?e=>"string"===typeof e?e:s*e:Array.isArray(s)?e=>"string"===typeof e?e:s[e]:"function"===typeof s?s:()=>{}}function ow(e){return sw(e,"spacing",8)}function aw(e,t){if("string"===typeof t||null==t)return t;const n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function lw(e,t,n,i){if(-1===t.indexOf(n))return null;const r=function(e,t){return n=>e.reduce(((e,i)=>(e[i]=aw(t,n),e)),{})}(tw(n),i);return HS(e,e[n],r)}function cw(e,t){const n=ow(e.theme);return Object.keys(e).map((i=>lw(e,t,i,n))).reduce(JS,{})}function uw(e){return cw(e,nw)}function hw(e){return cw(e,iw)}function dw(e){return cw(e,rw)}uw.propTypes={},uw.filterProps=nw,hw.propTypes={},hw.filterProps=iw,dw.propTypes={},dw.filterProps=rw;const pw=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),r=e=>Object.keys(e).reduce(((t,n)=>i[n]?JS(t,i[n](e)):t),{});return r.propTypes={},r.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),r};function fw(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function gw(e,t){return qS({prop:e,themeKey:"borders",transform:t})}const mw=gw("border",fw),vw=gw("borderTop",fw),_w=gw("borderRight",fw),bw=gw("borderBottom",fw),yw=gw("borderLeft",fw),Tw=gw("borderColor"),Ew=gw("borderTopColor"),Sw=gw("borderRightColor"),ww=gw("borderBottomColor"),xw=gw("borderLeftColor"),Mw=gw("outline",fw),Iw=gw("outlineColor"),Cw=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=sw(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:aw(t,e)});return HS(e,e.borderRadius,n)}return null};Cw.propTypes={},Cw.filterProps=["borderRadius"];pw(mw,vw,_w,bw,yw,Tw,Ew,Sw,ww,xw,Cw,Mw,Iw);const kw=e=>{if(void 0!==e.gap&&null!==e.gap){const t=sw(e.theme,"spacing",8),n=e=>({gap:aw(t,e)});return HS(e,e.gap,n)}return null};kw.propTypes={},kw.filterProps=["gap"];const Rw=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=sw(e.theme,"spacing",8),n=e=>({columnGap:aw(t,e)});return HS(e,e.columnGap,n)}return null};Rw.propTypes={},Rw.filterProps=["columnGap"];const Aw=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=sw(e.theme,"spacing",8),n=e=>({rowGap:aw(t,e)});return HS(e,e.rowGap,n)}return null};Aw.propTypes={},Aw.filterProps=["rowGap"];pw(kw,Rw,Aw,qS({prop:"gridColumn"}),qS({prop:"gridRow"}),qS({prop:"gridAutoFlow"}),qS({prop:"gridAutoColumns"}),qS({prop:"gridAutoRows"}),qS({prop:"gridTemplateColumns"}),qS({prop:"gridTemplateRows"}),qS({prop:"gridTemplateAreas"}),qS({prop:"gridArea"}));function Lw(e,t){return"grey"===t?t:e}pw(qS({prop:"color",themeKey:"palette",transform:Lw}),qS({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Lw}),qS({prop:"backgroundColor",themeKey:"palette",transform:Lw}));function Ow(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const Nw=qS({prop:"width",transform:Ow}),Dw=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,i;const r=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||US[t];return r?"px"!==(null==(i=e.theme)||null==(i=i.breakpoints)?void 0:i.unit)?{maxWidth:"".concat(r).concat(e.theme.breakpoints.unit)}:{maxWidth:r}:{maxWidth:Ow(t)}};return HS(e,e.maxWidth,t)}return null};Dw.filterProps=["maxWidth"];const Pw=qS({prop:"minWidth",transform:Ow}),$w=qS({prop:"height",transform:Ow}),Bw=qS({prop:"maxHeight",transform:Ow}),Fw=qS({prop:"minHeight",transform:Ow}),Uw=(qS({prop:"size",cssProperty:"width",transform:Ow}),qS({prop:"size",cssProperty:"height",transform:Ow}),pw(Nw,Dw,Pw,$w,Bw,Fw,qS({prop:"boxSizing"})),{border:{themeKey:"borders",transform:fw},borderTop:{themeKey:"borders",transform:fw},borderRight:{themeKey:"borders",transform:fw},borderBottom:{themeKey:"borders",transform:fw},borderLeft:{themeKey:"borders",transform:fw},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:fw},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Cw},color:{themeKey:"palette",transform:Lw},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Lw},backgroundColor:{themeKey:"palette",transform:Lw},p:{style:hw},pt:{style:hw},pr:{style:hw},pb:{style:hw},pl:{style:hw},px:{style:hw},py:{style:hw},padding:{style:hw},paddingTop:{style:hw},paddingRight:{style:hw},paddingBottom:{style:hw},paddingLeft:{style:hw},paddingX:{style:hw},paddingY:{style:hw},paddingInline:{style:hw},paddingInlineStart:{style:hw},paddingInlineEnd:{style:hw},paddingBlock:{style:hw},paddingBlockStart:{style:hw},paddingBlockEnd:{style:hw},m:{style:uw},mt:{style:uw},mr:{style:uw},mb:{style:uw},ml:{style:uw},mx:{style:uw},my:{style:uw},margin:{style:uw},marginTop:{style:uw},marginRight:{style:uw},marginBottom:{style:uw},marginLeft:{style:uw},marginX:{style:uw},marginY:{style:uw},marginInline:{style:uw},marginInlineStart:{style:uw},marginInlineEnd:{style:uw},marginBlock:{style:uw},marginBlockStart:{style:uw},marginBlockEnd:{style:uw},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:kw},rowGap:{style:Aw},columnGap:{style:Rw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ow},maxWidth:{style:Dw},minWidth:{transform:Ow},height:{transform:Ow},maxHeight:{transform:Ow},minHeight:{transform:Ow},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const zw=function(){function e(e,t,n,i){const r={[e]:t,theme:n},s=i[e];if(!s)return{[e]:t};const{cssProperty:o=e,themeKey:a,transform:l,style:c}=s;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=YS(n,a)||{};if(c)return c(r);return HS(r,t,(t=>{let n=KS(u,l,t);return t===n&&"string"===typeof t&&(n=KS(u,l,"".concat(e).concat("default"===t?"":XS(t)),t)),!1===o?n:{[o]:n}}))}return function t(n){var i;const{sx:r,theme:s={}}=n||{};if(!r)return null;const o=null!=(i=s.unstable_sxConfig)?i:Uw;function a(n){let i=n;if("function"===typeof n)i=n(s);else if("object"!==typeof n)return n;if(!i)return null;const r=GS(s.breakpoints),a=Object.keys(r);let l=r;return Object.keys(i).forEach((n=>{const r=(a=i[n],c=s,"function"===typeof a?a(c):a);var a,c;if(null!==r&&void 0!==r)if("object"===typeof r)if(o[n])l=JS(l,e(n,r,s,o));else{const e=HS({theme:s},r,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),r=new Set(i);return t.every((e=>r.size===Object.keys(e).length))}(e,r)?l=JS(l,e):l[n]=t({sx:r,theme:s})}else l=JS(l,e(n,r,s,o))})),VS(a,l)}return Array.isArray(r)?r.map(a):a(r)}}();zw.filterProps=["sx"];const Hw=zw;function Gw(e,t){const n=this;if(n.vars&&"function"===typeof n.getColorSchemeSelector){return{[n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}}return n.palette.mode===e?t:{}}const Vw=["breakpoints","palette","spacing","shape"];const Ww=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:i,shape:r={}}=e,s=oE(e,Vw),o=function(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:i=5}=e,r=oE(e,$S),s=BS(t),o=Object.keys(s);function a(e){const i="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(i).concat(n,")")}function l(e){const r="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(r-i/100).concat(n,")")}function c(e,r){const s=o.indexOf(r);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(n,") and ")+"(max-width:".concat((-1!==s&&"number"===typeof t[o[s]]?t[o[s]]:r)-i/100).concat(n,")")}return sE({keys:o,values:s,up:a,down:l,between:c,only:function(e){return o.indexOf(e)+1<o.length?c(e,o[o.indexOf(e)+1]):a(e)},not:function(e){const t=o.indexOf(e);return 0===t?a(o[1]):t===o.length-1?l(o[t]):c(e,o[o.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},r)}(t),a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=ow({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}(i);let l=PS({breakpoints:o,direction:"ltr",components:{},palette:sE({mode:"light"},n),spacing:a,shape:sE({},FS,r)},s);l.applyStyles=Gw;for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return l=u.reduce(((e,t)=>PS(e,t)),l),l.unstable_sxConfig=sE({},Uw,null==s?void 0:s.unstable_sxConfig),l.unstable_sx=function(e){return Hw({sx:e,theme:this})},l},jw=["ownerState"],Xw=["variants"],Yw=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Kw(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const qw=Ww(),Jw=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function Zw(e){let{defaultTheme:t,theme:n,themeId:i}=e;return r=n,0===Object.keys(r).length?t:n[i]||n;var r}function Qw(e){return e?(t,n)=>n[e]:null}function ex(e,t){let{ownerState:n}=t,i=oE(t,jw);const r="function"===typeof e?e(sE({ownerState:n},i)):e;if(Array.isArray(r))return r.flatMap((e=>ex(e,sE({ownerState:n},i))));if(r&&"object"===typeof r&&Array.isArray(r.variants)){const{variants:e=[]}=r;let t=oE(r,Xw);return e.forEach((e=>{let r=!0;"function"===typeof e.props?r=e.props(sE({ownerState:n},i)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&i[t]!==e.props[t]&&(r=!1)})),r&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style(sE({ownerState:n},i)):e.style))})),t}return r}function tx(e,t){return sE({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const nx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))};function ix(e){return nx(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function rx(e){if(e.type)return e;if("#"===e.charAt(0))return rx(function(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", "),")"):""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(jS(9,e));let i,r=e.substring(t+1,e.length-1);if("color"===n){if(r=r.split(" "),i=r.shift(),4===r.length&&"/"===r[3].charAt(0)&&(r[3]=r[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i))throw new Error(jS(10,i))}else r=r.split(",");return r=r.map((e=>parseFloat(e))),{type:n,values:r,colorSpace:i}}function sx(e){const{type:t,colorSpace:n}=e;let{values:i}=e;return-1!==t.indexOf("rgb")?i=i.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(i[1]="".concat(i[1],"%"),i[2]="".concat(i[2],"%")),i=-1!==t.indexOf("color")?"".concat(n," ").concat(i.join(" ")):"".concat(i.join(", ")),"".concat(t,"(").concat(i,")")}function ox(e){let t="hsl"===(e=rx(e)).type||"hsla"===e.type?rx(function(e){e=rx(e);const{values:t}=e,n=t[0],i=t[1]/100,r=t[2]/100,s=i*Math.min(r,1-r),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return r-s*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const l=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),sx({type:a,values:l})}(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function ax(e,t){if(e=rx(e),t=ix(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return sx(e)}function lx(e,t){if(e=rx(e),t=ix(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return sx(e)}const cx={black:"#000",white:"#fff"},ux={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},hx={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},dx={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},px={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},fx={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},gx={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},mx={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},vx=["mode","contrastThreshold","tonalOffset"],_x={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:cx.white,default:cx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},bx={text:{primary:cx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:cx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function yx(e,t,n,i){const r=i.light||i,s=i.dark||1.5*i;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=lx(e.main,r):"dark"===t&&(e.dark=ax(e.main,s)))}function Tx(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:i=.2}=e,r=oE(e,vx),s=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:fx[200],light:fx[50],dark:fx[400]}:{main:fx[700],light:fx[400],dark:fx[800]}}(t),o=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:hx[200],light:hx[50],dark:hx[400]}:{main:hx[500],light:hx[300],dark:hx[700]}}(t),a=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:dx[500],light:dx[300],dark:dx[700]}:{main:dx[700],light:dx[400],dark:dx[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:gx[400],light:gx[300],dark:gx[700]}:{main:gx[700],light:gx[500],dark:gx[900]}}(t),c=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:mx[400],light:mx[300],dark:mx[700]}:{main:mx[800],light:mx[500],dark:mx[900]}}(t),u=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:px[400],light:px[300],dark:px[700]}:{main:"#ed6c02",light:px[500],dark:px[900]}}(t);function h(e){const t=function(e,t){const n=ox(e),i=ox(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}(e,bx.text.primary)>=n?bx.text.primary:_x.text.primary;return t}const d=e=>{let{color:t,name:n,mainShade:r=500,lightShade:s=300,darkShade:o=700}=e;if(t=sE({},t),!t.main&&t[r]&&(t.main=t[r]),!t.hasOwnProperty("main"))throw new Error(jS(11,n?" (".concat(n,")"):"",r));if("string"!==typeof t.main)throw new Error(jS(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return yx(t,"light",s,i),yx(t,"dark",o,i),t.contrastText||(t.contrastText=h(t.main)),t},p={dark:bx,light:_x};return PS(sE({common:sE({},cx),mode:t,primary:d({color:s,name:"primary"}),secondary:d({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:a,name:"error"}),warning:d({color:u,name:"warning"}),info:d({color:l,name:"info"}),success:d({color:c,name:"success"}),grey:ux,contrastThreshold:n,getContrastText:h,augmentColor:d,tonalOffset:i},p[t]),r)}const Ex=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const Sx={textTransform:"uppercase"},wx='"Roboto", "Helvetica", "Arial", sans-serif';function xx(e,t){const n="function"===typeof t?t(e):t,{fontFamily:i=wx,fontSize:r=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:h}=n,d=oE(n,Ex);const p=r/14,f=h||(e=>"".concat(e/c*p,"rem")),g=(e,t,n,r,s)=>{return sE({fontFamily:i,fontWeight:e,fontSize:f(t),lineHeight:n},i===wx?{letterSpacing:"".concat((o=r/t,Math.round(1e5*o)/1e5),"em")}:{},s,u);var o},m={h1:g(s,96,1.167,-1.5),h2:g(s,60,1.2,-.5),h3:g(o,48,1.167,0),h4:g(o,34,1.235,.25),h5:g(o,24,1.334,0),h6:g(a,20,1.6,.15),subtitle1:g(o,16,1.75,.15),subtitle2:g(a,14,1.57,.1),body1:g(o,16,1.5,.15),body2:g(o,14,1.43,.15),button:g(a,14,1.75,.4,Sx),caption:g(o,12,1.66,.4),overline:g(o,12,2.66,1,Sx),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return PS(sE({htmlFontSize:c,pxToRem:f,fontFamily:i,fontSize:r,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l},m),d,{clone:!1})}function Mx(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const Ix=["none",Mx(0,2,1,-1,0,1,1,0,0,1,3,0),Mx(0,3,1,-2,0,2,2,0,0,1,5,0),Mx(0,3,3,-2,0,3,4,0,0,1,8,0),Mx(0,2,4,-1,0,4,5,0,0,1,10,0),Mx(0,3,5,-1,0,5,8,0,0,1,14,0),Mx(0,3,5,-1,0,6,10,0,0,1,18,0),Mx(0,4,5,-2,0,7,10,1,0,2,16,1),Mx(0,5,5,-3,0,8,10,1,0,3,14,2),Mx(0,5,6,-3,0,9,12,1,0,3,16,2),Mx(0,6,6,-3,0,10,14,1,0,4,18,3),Mx(0,6,7,-4,0,11,15,1,0,4,20,3),Mx(0,7,8,-4,0,12,17,2,0,5,22,4),Mx(0,7,8,-4,0,13,19,2,0,5,24,4),Mx(0,7,9,-4,0,14,21,2,0,5,26,4),Mx(0,8,9,-5,0,15,22,2,0,6,28,5),Mx(0,8,10,-5,0,16,24,2,0,6,30,5),Mx(0,8,11,-5,0,17,26,2,0,6,32,5),Mx(0,9,11,-5,0,18,28,2,0,7,34,6),Mx(0,9,12,-6,0,19,29,2,0,7,36,6),Mx(0,10,13,-6,0,20,31,3,0,8,38,7),Mx(0,10,13,-6,0,21,33,3,0,8,40,7),Mx(0,10,14,-6,0,22,35,3,0,8,42,7),Mx(0,11,14,-7,0,23,36,3,0,9,44,8),Mx(0,11,15,-7,0,24,38,3,0,9,46,8)],Cx=["duration","easing","delay"],kx={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Rx={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Ax(e){return"".concat(Math.round(e),"ms")}function Lx(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function Ox(e){const t=sE({},kx,e.easing),n=sE({},Rx,e.duration);return sE({getAutoHeightDuration:Lx,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:r=n.standard,easing:s=t.easeInOut,delay:o=0}=i;oE(i,Cx);return(Array.isArray(e)?e:[e]).map((e=>"".concat(e," ").concat("string"===typeof r?r:Ax(r)," ").concat(s," ").concat("string"===typeof o?o:Ax(o)))).join(",")}},e,{easing:t,duration:n})}const Nx={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Dx=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Px(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:n={},transitions:i={},typography:r={}}=e,s=oE(e,Dx);if(e.vars)throw new Error(jS(18));const o=Tx(n),a=Ww(e);let l=PS(a,{mixins:tx(a.breakpoints,t),palette:o,shadows:Ix.slice(),typography:xx(o,r),transitions:Ox(i),zIndex:sE({},Nx)});l=PS(l,s);for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return l=u.reduce(((e,t)=>PS(e,t)),l),l.unstable_sxConfig=sE({},Uw,null==s?void 0:s.unstable_sxConfig),l.unstable_sx=function(e){return Hw({sx:e,theme:this})},l}const $x=Px(),Bx="$$material",Fx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=qw,rootShouldForwardProp:i=Kw,slotShouldForwardProp:r=Kw}=e,s=e=>Hw(sE({},e,{theme:Zw(sE({},e,{defaultTheme:n,themeId:t}))}));return s.__mui_systemSx=!0,function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};((e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))})(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:a,slot:l,skipVariantsResolver:c,skipSx:u,overridesResolver:h=Qw(Jw(l))}=o,d=oE(o,Yw),p=void 0!==c?c:l&&"Root"!==l&&"root"!==l||!1,f=u||!1;let g=Kw;"Root"===l||"root"===l?g=i:l?g=r:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(g=void 0);const m=function(e,t){return OS(e,t)}(e,sE({shouldForwardProp:g,label:undefined},d)),v=e=>"function"===typeof e&&e.__emotion_real!==e||NS(e)?i=>ex(e,sE({},i,{theme:Zw({theme:i.theme,defaultTheme:n,themeId:t})})):e,_=function(i){let r=v(i);for(var o=arguments.length,l=new Array(o>1?o-1:0),c=1;c<o;c++)l[c-1]=arguments[c];const u=l?l.map(v):[];a&&h&&u.push((e=>{const i=Zw(sE({},e,{defaultTheme:n,themeId:t}));if(!i.components||!i.components[a]||!i.components[a].styleOverrides)return null;const r=i.components[a].styleOverrides,s={};return Object.entries(r).forEach((t=>{let[n,r]=t;s[n]=ex(r,sE({},e,{theme:i}))})),h(e,s)})),a&&!p&&u.push((e=>{var i;const r=Zw(sE({},e,{defaultTheme:n,themeId:t}));return ex({variants:null==r||null==(i=r.components)||null==(i=i[a])?void 0:i.variants},sE({},e,{theme:r}))})),f||u.push(s);const d=u.length-l.length;if(Array.isArray(i)&&d>0){const e=new Array(d).fill("");r=[...i,...e],r.raw=[...i.raw,...e]}const g=m(r,...u);return e.muiName&&(g.muiName=e.muiName),g};return m.withConfig&&(_.withConfig=m.withConfig),_}}({themeId:Bx,defaultTheme:$x,rootShouldForwardProp:e=>Kw(e)&&"classes"!==e}),Ux=Fx;function zx(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=zx(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const Hx=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=zx(e))&&(i&&(i+=" "),i+=t);return i},Gx=["sx"];function Vx(e){const{sx:t}=e,n=oE(e,Gx),{systemProps:i,otherProps:r}=(e=>{var t,n;const i={systemProps:{},otherProps:{}},r=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:Uw;return Object.keys(e).forEach((t=>{r[t]?i.systemProps[t]=e[t]:i.otherProps[t]=e[t]})),i})(n);let s;return s=Array.isArray(t)?[i,...t]:"function"===typeof t?function(){const e=t(...arguments);return NS(e)?sE({},i,e):i}:sE({},i,t),sE({},r,{sx:s})}function Wx(e,t){const n=sE({},t);return Object.keys(e).forEach((i=>{if(i.toString().match(/^(components|slots)$/))n[i]=sE({},e[i],n[i]);else if(i.toString().match(/^(componentsProps|slotProps)$/)){const r=e[i]||{},s=t[i];n[i]={},s&&Object.keys(s)?r&&Object.keys(r)?(n[i]=sE({},s),Object.keys(r).forEach((e=>{n[i][e]=Wx(r[e],s[e])}))):n[i]=s:n[i]=r}else void 0===n[i]&&(n[i]=e[i])})),n}function jx(e){const{theme:t,name:n,props:i}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?Wx(t.components[n].defaultProps,i):i}const Xx=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const n=e.useContext(MS);return n&&(i=n,0!==Object.keys(i).length)?n:t;var i},Yx=Ww();const Kx=function(){return Xx(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yx)};function qx(e){let{props:t,name:n}=e;return function(e){let{props:t,name:n,defaultTheme:i,themeId:r}=e,s=Kx(i);return r&&(s=s[r]||s),jx({theme:s,name:n,props:t})}({props:t,name:n,defaultTheme:$x,themeId:Bx})}const Jx=e.createContext(),Zx=e=>e,Qx=(()=>{let e=Zx;return{configure(t){e=t},generate:t=>e(t),reset(){e=Zx}}})(),eM={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function tM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const i=eM[t];return i?"".concat(n,"-").concat(i):"".concat(Qx.generate(e),"-").concat(t)}function nM(e){return tM("MuiGrid",e)}const iM=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],rM=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const i={};return t.forEach((t=>{i[t]=tM(e,t,n)})),i}("MuiGrid",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map((e=>"spacing-xs-".concat(e))),...["column-reverse","column","row-reverse","row"].map((e=>"direction-xs-".concat(e))),...["nowrap","wrap-reverse","wrap"].map((e=>"wrap-xs-".concat(e))),...iM.map((e=>"grid-xs-".concat(e))),...iM.map((e=>"grid-sm-".concat(e))),...iM.map((e=>"grid-md-".concat(e))),...iM.map((e=>"grid-lg-".concat(e))),...iM.map((e=>"grid-xl-".concat(e)))]),sM=rM,oM=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function aM(e){const t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}function lM(e){let{breakpoints:t,values:n}=e,i="";Object.keys(n).forEach((e=>{""===i&&0!==n[e]&&(i=e)}));const r=Object.keys(t).sort(((e,n)=>t[e]-t[n]));return r.slice(0,r.indexOf(i))}const cM=Ux("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{container:i,direction:r,item:s,spacing:o,wrap:a,zeroMinWidth:l,breakpoints:c}=n;let u=[];i&&(u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n["spacing-xs-".concat(String(e))]];const i=[];return t.forEach((t=>{const r=e[t];Number(r)>0&&i.push(n["spacing-".concat(t,"-").concat(String(r))])})),i}(o,c,t));const h=[];return c.forEach((e=>{const i=n[e];i&&h.push(t["grid-".concat(e,"-").concat(String(i))])})),[t.root,i&&t.container,s&&t.item,l&&t.zeroMinWidth,...u,"row"!==r&&t["direction-xs-".concat(String(r))],"wrap"!==a&&t["wrap-xs-".concat(String(a))],...h]}})((e=>{let{ownerState:t}=e;return sE({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){let{theme:t,ownerState:n}=e;return HS({theme:t},WS({values:n.direction,breakpoints:t.breakpoints.values}),(e=>{const t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(sM.item)]={maxWidth:"none"}),t}))}),(function(e){let{theme:t,ownerState:n}=e;const{container:i,rowSpacing:r}=n;let s={};if(i&&0!==r){const e=WS({values:r,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=lM({breakpoints:t.breakpoints.values,values:e})),s=HS({theme:t},e,((e,i)=>{var r;const s=t.spacing(e);return"0px"!==s?{marginTop:"-".concat(aM(s)),["& > .".concat(sM.item)]:{paddingTop:aM(s)}}:null!=(r=n)&&r.includes(i)?{}:{marginTop:0,["& > .".concat(sM.item)]:{paddingTop:0}}}))}return s}),(function(e){let{theme:t,ownerState:n}=e;const{container:i,columnSpacing:r}=n;let s={};if(i&&0!==r){const e=WS({values:r,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=lM({breakpoints:t.breakpoints.values,values:e})),s=HS({theme:t},e,((e,i)=>{var r;const s=t.spacing(e);return"0px"!==s?{width:"calc(100% + ".concat(aM(s),")"),marginLeft:"-".concat(aM(s)),["& > .".concat(sM.item)]:{paddingLeft:aM(s)}}:null!=(r=n)&&r.includes(i)?{}:{width:"100%",marginLeft:0,["& > .".concat(sM.item)]:{paddingLeft:0}}}))}return s}),(function(e){let t,{theme:n,ownerState:i}=e;return n.breakpoints.keys.reduce(((e,r)=>{let s={};if(i[r]&&(t=i[r]),!t)return e;if(!0===t)s={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)s={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const o=WS({values:i.columns,breakpoints:n.breakpoints.values}),a="object"===typeof o?o[r]:o;if(void 0===a||null===a)return e;const l="".concat(Math.round(t/a*1e8)/1e6,"%");let c={};if(i.container&&i.item&&0!==i.columnSpacing){const e=n.spacing(i.columnSpacing);if("0px"!==e){const t="calc(".concat(l," + ").concat(aM(e),")");c={flexBasis:t,maxWidth:t}}}s=sE({flexBasis:l,flexGrow:0,maxWidth:l},c)}return 0===n.breakpoints.values[r]?Object.assign(e,s):e[n.breakpoints.up(r)]=s,e}),{})}));const uM=e=>{const{classes:t,container:n,direction:i,item:r,spacing:s,wrap:o,zeroMinWidth:a,breakpoints:l}=e;let c=[];n&&(c=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return["spacing-xs-".concat(String(e))];const n=[];return t.forEach((t=>{const i=e[t];if(Number(i)>0){const e="spacing-".concat(t,"-").concat(String(i));n.push(e)}})),n}(s,l));const u=[];l.forEach((t=>{const n=e[t];n&&u.push("grid-".concat(t,"-").concat(String(n)))}));return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const i={};return Object.keys(e).forEach((r=>{i[r]=e[r].reduce(((e,i)=>{if(i){const r=t(i);""!==r&&e.push(r),n&&n[i]&&e.push(n[i])}return e}),[]).join(" ")})),i}({root:["root",n&&"container",r&&"item",a&&"zeroMinWidth",...c,"row"!==i&&"direction-xs-".concat(String(i)),"wrap"!==o&&"wrap-xs-".concat(String(o)),...u]},nM,t)},hM=e.forwardRef((function(t,n){const i=qx({props:t,name:"MuiGrid"}),{breakpoints:r}=function(){const e=Kx($x);return e[Bx]||e}(),s=Vx(i),{className:o,columns:a,columnSpacing:l,component:c="div",container:u=!1,direction:h="row",item:d=!1,rowSpacing:p,spacing:f=0,wrap:g="wrap",zeroMinWidth:m=!1}=s,v=oE(s,oM),_=p||f,b=l||f,y=e.useContext(Jx),T=u?a||12:y,E={},S=sE({},v);r.keys.forEach((e=>{null!=v[e]&&(E[e]=v[e],delete S[e])}));const w=sE({},s,{columns:T,container:u,direction:h,item:d,rowSpacing:_,columnSpacing:b,wrap:g,zeroMinWidth:m,spacing:f},E,{breakpoints:r.keys}),x=uM(w);return(0,oT.jsx)(Jx.Provider,{value:T,children:(0,oT.jsx)(cM,sE({ownerState:w,className:Hx(x.root,o),as:c,ref:n},S))})}));const dM=hM,pM=Ux("div")((e=>{let{theme:t}=e;return{textAlign:"center"}}));i.common.defineBlocks(tT.K),Object.assign(iT.javascriptGenerator.forBlock,nT.Z);const fM=function(){return(0,oT.jsxs)("div",{children:[(0,oT.jsx)(iE,{}),(0,oT.jsxs)(dM,{display:"flex",container:!0,spacing:2,children:[(0,oT.jsx)(dM,{item:!0,xs:12,sm:12,md:12,lg:9,children:(0,oT.jsx)(pM,{style:{width:"100%"},children:(0,oT.jsx)(rE.Z,{})})}),(0,oT.jsx)(dM,{item:!0,xs:12,sm:12,md:12,lg:3,children:(0,oT.jsx)(pM,{children:(0,oT.jsx)(eT,{})})})]})]})},gM=e=>{e&&e instanceof Function&&__webpack_require__.e(787).then(__webpack_require__.bind(__webpack_require__,787)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:o}=t;n(e),i(e),r(e),s(e),o(e)}))};n.createRoot(document.getElementById("root")).render((0,oT.jsx)(e.StrictMode,{children:(0,oT.jsx)(fM,{})})),gM()})()})();
//# sourceMappingURL=main.8f71773f.js.map